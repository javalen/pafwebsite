function K2(s,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in s)){const n=Object.getOwnPropertyDescriptor(i,r);n&&Object.defineProperty(s,r,n.get?n:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $M(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Z2(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(i){var r=Object.getOwnPropertyDescriptor(s,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return s[i]}})}),t}var HL={exports:{}},U0={},VL={exports:{}},ni={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv=Symbol.for("react.element"),J2=Symbol.for("react.portal"),ej=Symbol.for("react.fragment"),tj=Symbol.for("react.strict_mode"),ij=Symbol.for("react.profiler"),rj=Symbol.for("react.provider"),nj=Symbol.for("react.context"),sj=Symbol.for("react.forward_ref"),aj=Symbol.for("react.suspense"),oj=Symbol.for("react.memo"),lj=Symbol.for("react.lazy"),eT=Symbol.iterator;function hj(s){return s===null||typeof s!="object"?null:(s=eT&&s[eT]||s["@@iterator"],typeof s=="function"?s:null)}var UL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_L=Object.assign,WL={};function Rd(s,e,t){this.props=s,this.context=e,this.refs=WL,this.updater=t||UL}Rd.prototype.isReactComponent={};Rd.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};Rd.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function qL(){}qL.prototype=Rd.prototype;function XM(s,e,t){this.props=s,this.context=e,this.refs=WL,this.updater=t||UL}var KM=XM.prototype=new qL;KM.constructor=XM;_L(KM,Rd.prototype);KM.isPureReactComponent=!0;var tT=Array.isArray,YL=Object.prototype.hasOwnProperty,ZM={current:null},QL={key:!0,ref:!0,__self:!0,__source:!0};function GL(s,e,t){var i,r={},n=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(n=""+e.key),e)YL.call(e,i)&&!QL.hasOwnProperty(i)&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),h=0;h<o;h++)l[h]=arguments[h+2];r.children=l}if(s&&s.defaultProps)for(i in o=s.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return{$$typeof:pv,type:s,key:n,ref:a,props:r,_owner:ZM.current}}function uj(s,e){return{$$typeof:pv,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function JM(s){return typeof s=="object"&&s!==null&&s.$$typeof===pv}function cj(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(t){return e[t]})}var iT=/\/+/g;function zb(s,e){return typeof s=="object"&&s!==null&&s.key!=null?cj(""+s.key):e.toString(36)}function hg(s,e,t,i,r){var n=typeof s;(n==="undefined"||n==="boolean")&&(s=null);var a=!1;if(s===null)a=!0;else switch(n){case"string":case"number":a=!0;break;case"object":switch(s.$$typeof){case pv:case J2:a=!0}}if(a)return a=s,r=r(a),s=i===""?"."+zb(a,0):i,tT(r)?(t="",s!=null&&(t=s.replace(iT,"$&/")+"/"),hg(r,e,t,"",function(h){return h})):r!=null&&(JM(r)&&(r=uj(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(iT,"$&/")+"/")+s)),e.push(r)),1;if(a=0,i=i===""?".":i+":",tT(s))for(var o=0;o<s.length;o++){n=s[o];var l=i+zb(n,o);a+=hg(n,e,t,l,r)}else if(l=hj(s),typeof l=="function")for(s=l.call(s),o=0;!(n=s.next()).done;)n=n.value,l=i+zb(n,o++),a+=hg(n,e,t,l,r);else if(n==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Lv(s,e,t){if(s==null)return s;var i=[],r=0;return hg(s,i,"","",function(n){return e.call(t,n,r++)}),i}function dj(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(t){(s._status===0||s._status===-1)&&(s._status=1,s._result=t)},function(t){(s._status===0||s._status===-1)&&(s._status=2,s._result=t)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var Kn={current:null},ug={transition:null},pj={ReactCurrentDispatcher:Kn,ReactCurrentBatchConfig:ug,ReactCurrentOwner:ZM};ni.Children={map:Lv,forEach:function(s,e,t){Lv(s,function(){e.apply(this,arguments)},t)},count:function(s){var e=0;return Lv(s,function(){e++}),e},toArray:function(s){return Lv(s,function(e){return e})||[]},only:function(s){if(!JM(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};ni.Component=Rd;ni.Fragment=ej;ni.Profiler=ij;ni.PureComponent=XM;ni.StrictMode=tj;ni.Suspense=aj;ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pj;ni.cloneElement=function(s,e,t){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var i=_L({},s.props),r=s.key,n=s.ref,a=s._owner;if(e!=null){if(e.ref!==void 0&&(n=e.ref,a=ZM.current),e.key!==void 0&&(r=""+e.key),s.type&&s.type.defaultProps)var o=s.type.defaultProps;for(l in e)YL.call(e,l)&&!QL.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){o=Array(l);for(var h=0;h<l;h++)o[h]=arguments[h+2];i.children=o}return{$$typeof:pv,type:s.type,key:r,ref:n,props:i,_owner:a}};ni.createContext=function(s){return s={$$typeof:nj,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:rj,_context:s},s.Consumer=s};ni.createElement=GL;ni.createFactory=function(s){var e=GL.bind(null,s);return e.type=s,e};ni.createRef=function(){return{current:null}};ni.forwardRef=function(s){return{$$typeof:sj,render:s}};ni.isValidElement=JM;ni.lazy=function(s){return{$$typeof:lj,_payload:{_status:-1,_result:s},_init:dj}};ni.memo=function(s,e){return{$$typeof:oj,type:s,compare:e===void 0?null:e}};ni.startTransition=function(s){var e=ug.transition;ug.transition={};try{s()}finally{ug.transition=e}};ni.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ni.useCallback=function(s,e){return Kn.current.useCallback(s,e)};ni.useContext=function(s){return Kn.current.useContext(s)};ni.useDebugValue=function(){};ni.useDeferredValue=function(s){return Kn.current.useDeferredValue(s)};ni.useEffect=function(s,e){return Kn.current.useEffect(s,e)};ni.useId=function(){return Kn.current.useId()};ni.useImperativeHandle=function(s,e,t){return Kn.current.useImperativeHandle(s,e,t)};ni.useInsertionEffect=function(s,e){return Kn.current.useInsertionEffect(s,e)};ni.useLayoutEffect=function(s,e){return Kn.current.useLayoutEffect(s,e)};ni.useMemo=function(s,e){return Kn.current.useMemo(s,e)};ni.useReducer=function(s,e,t){return Kn.current.useReducer(s,e,t)};ni.useRef=function(s){return Kn.current.useRef(s)};ni.useState=function(s){return Kn.current.useState(s)};ni.useSyncExternalStore=function(s,e,t){return Kn.current.useSyncExternalStore(s,e,t)};ni.useTransition=function(){return Kn.current.useTransition()};ni.version="18.2.0";VL.exports=ni;var le=VL.exports;const Lt=$M(le),Nx=K2({__proto__:null,default:Lt},[le]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fj=le,vj=Symbol.for("react.element"),mj=Symbol.for("react.fragment"),gj=Object.prototype.hasOwnProperty,yj=fj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bj={key:!0,ref:!0,__self:!0,__source:!0};function $L(s,e,t){var i,r={},n=null,a=null;t!==void 0&&(n=""+t),e.key!==void 0&&(n=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)gj.call(e,i)&&!bj.hasOwnProperty(i)&&(r[i]=e[i]);if(s&&s.defaultProps)for(i in e=s.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:vj,type:s,key:n,ref:a,props:r,_owner:yj.current}}U0.Fragment=mj;U0.jsx=$L;U0.jsxs=$L;HL.exports=U0;var J=HL.exports,kx={},XL={exports:{}},Os={},KL={exports:{}},ZL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(F,z){var q=F.length;F.push(z);e:for(;0<q;){var X=q-1>>>1,G=F[X];if(0<r(G,z))F[X]=z,F[q]=G,q=X;else break e}}function t(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var z=F[0],q=F.pop();if(q!==z){F[0]=q;e:for(var X=0,G=F.length,Z=G>>>1;X<Z;){var se=2*(X+1)-1,oe=F[se],fe=se+1,be=F[fe];if(0>r(oe,q))fe<G&&0>r(be,oe)?(F[X]=be,F[fe]=q,X=fe):(F[X]=oe,F[se]=q,X=se);else if(fe<G&&0>r(be,q))F[X]=be,F[fe]=q,X=fe;else break e}}return z}function r(F,z){var q=F.sortIndex-z.sortIndex;return q!==0?q:F.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;s.unstable_now=function(){return n.now()}}else{var a=Date,o=a.now();s.unstable_now=function(){return a.now()-o}}var l=[],h=[],u=1,c=null,d=3,p=!1,f=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(F){for(var z=t(h);z!==null;){if(z.callback===null)i(h);else if(z.startTime<=F)i(h),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(h)}}function x(F){if(v=!1,C(F),!f)if(t(l)!==null)f=!0,j(w);else{var z=t(h);z!==null&&P(x,z.startTime-F)}}function w(F,z){f=!1,v&&(v=!1,b(T),T=-1),p=!0;var q=d;try{for(C(z),c=t(l);c!==null&&(!(c.expirationTime>z)||F&&!A());){var X=c.callback;if(typeof X=="function"){c.callback=null,d=c.priorityLevel;var G=X(c.expirationTime<=z);z=s.unstable_now(),typeof G=="function"?c.callback=G:c===t(l)&&i(l),C(z)}else i(l);c=t(l)}if(c!==null)var Z=!0;else{var se=t(h);se!==null&&P(x,se.startTime-z),Z=!1}return Z}finally{c=null,d=q,p=!1}}var M=!1,E=null,T=-1,D=5,N=-1;function A(){return!(s.unstable_now()-N<D)}function L(){if(E!==null){var F=s.unstable_now();N=F;var z=!0;try{z=E(!0,F)}finally{z?k():(M=!1,E=null)}}else M=!1}var k;if(typeof y=="function")k=function(){y(L)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,R=O.port2;O.port1.onmessage=L,k=function(){R.postMessage(null)}}else k=function(){g(L,0)};function j(F){E=F,M||(M=!0,k())}function P(F,z){T=g(function(){F(s.unstable_now())},z)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(F){F.callback=null},s.unstable_continueExecution=function(){f||p||(f=!0,j(w))},s.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<F?Math.floor(1e3/F):5},s.unstable_getCurrentPriorityLevel=function(){return d},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(F){switch(d){case 1:case 2:case 3:var z=3;break;default:z=d}var q=d;d=z;try{return F()}finally{d=q}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(F,z){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var q=d;d=F;try{return z()}finally{d=q}},s.unstable_scheduleCallback=function(F,z,q){var X=s.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?X+q:X):q=X,F){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=q+G,F={id:u++,callback:z,priorityLevel:F,startTime:q,expirationTime:G,sortIndex:-1},q>X?(F.sortIndex=q,e(h,F),t(l)===null&&F===t(h)&&(v?(b(T),T=-1):v=!0,P(x,q-X))):(F.sortIndex=G,e(l,F),f||p||(f=!0,j(w))),F},s.unstable_shouldYield=A,s.unstable_wrapCallback=function(F){var z=d;return function(){var q=d;d=z;try{return F.apply(this,arguments)}finally{d=q}}}})(ZL);KL.exports=ZL;var Cj=KL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JL=le,Ls=Cj;function We(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eO=new Set,sf={};function Su(s,e){Xc(s,e),Xc(s+"Capture",e)}function Xc(s,e){for(sf[s]=e,s=0;s<e.length;s++)eO.add(e[s])}var Uo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lx=Object.prototype.hasOwnProperty,Sj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rT={},nT={};function xj(s){return Lx.call(nT,s)?!0:Lx.call(rT,s)?!1:Sj.test(s)?nT[s]=!0:(rT[s]=!0,!1)}function wj(s,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function Mj(s,e,t,i){if(e===null||typeof e>"u"||wj(s,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zn(s,e,t,i,r,n,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=s,this.type=e,this.sanitizeURL=n,this.removeEmptyString=a}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){En[s]=new Zn(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];En[e]=new Zn(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){En[s]=new Zn(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){En[s]=new Zn(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){En[s]=new Zn(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){En[s]=new Zn(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){En[s]=new Zn(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){En[s]=new Zn(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){En[s]=new Zn(s,5,!1,s.toLowerCase(),null,!1,!1)});var eE=/[\-:]([a-z])/g;function tE(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(eE,tE);En[e]=new Zn(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(eE,tE);En[e]=new Zn(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(eE,tE);En[e]=new Zn(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){En[s]=new Zn(s,1,!1,s.toLowerCase(),null,!1,!1)});En.xlinkHref=new Zn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){En[s]=new Zn(s,1,!1,s.toLowerCase(),null,!0,!0)});function iE(s,e,t,i){var r=En.hasOwnProperty(e)?En[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Mj(e,t,r,i)&&(t=null),i||r===null?xj(e)&&(t===null?s.removeAttribute(e):s.setAttribute(e,""+t)):r.mustUseProperty?s[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?s.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?s.setAttributeNS(i,e,t):s.setAttribute(e,t))))}var Go=JL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ov=Symbol.for("react.element"),hc=Symbol.for("react.portal"),uc=Symbol.for("react.fragment"),rE=Symbol.for("react.strict_mode"),Ox=Symbol.for("react.profiler"),tO=Symbol.for("react.provider"),iO=Symbol.for("react.context"),nE=Symbol.for("react.forward_ref"),Rx=Symbol.for("react.suspense"),Fx=Symbol.for("react.suspense_list"),sE=Symbol.for("react.memo"),vl=Symbol.for("react.lazy"),rO=Symbol.for("react.offscreen"),sT=Symbol.iterator;function Hd(s){return s===null||typeof s!="object"?null:(s=sT&&s[sT]||s["@@iterator"],typeof s=="function"?s:null)}var fr=Object.assign,jb;function Tp(s){if(jb===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);jb=e&&e[1]||""}return`
`+jb+s}var Bb=!1;function Hb(s,e){if(!s||Bb)return"";Bb=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var i=h}Reflect.construct(s,[],e)}else{try{e.call()}catch(h){i=h}s.call(e.prototype)}else{try{throw Error()}catch(h){i=h}s()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),n=i.stack.split(`
`),a=r.length-1,o=n.length-1;1<=a&&0<=o&&r[a]!==n[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==n[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==n[o]){var l=`
`+r[a].replace(" at new "," at ");return s.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",s.displayName)),l}while(1<=a&&0<=o);break}}}finally{Bb=!1,Error.prepareStackTrace=t}return(s=s?s.displayName||s.name:"")?Tp(s):""}function Ej(s){switch(s.tag){case 5:return Tp(s.type);case 16:return Tp("Lazy");case 13:return Tp("Suspense");case 19:return Tp("SuspenseList");case 0:case 2:case 15:return s=Hb(s.type,!1),s;case 11:return s=Hb(s.type.render,!1),s;case 1:return s=Hb(s.type,!0),s;default:return""}}function Px(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case uc:return"Fragment";case hc:return"Portal";case Ox:return"Profiler";case rE:return"StrictMode";case Rx:return"Suspense";case Fx:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case iO:return(s.displayName||"Context")+".Consumer";case tO:return(s._context.displayName||"Context")+".Provider";case nE:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case sE:return e=s.displayName||null,e!==null?e:Px(s.type)||"Memo";case vl:e=s._payload,s=s._init;try{return Px(s(e))}catch{}}return null}function Ij(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Px(e);case 8:return e===rE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $l(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function nO(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Tj(s){var e=nO(s)?"checked":"value",t=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),i=""+s[e];if(!s.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,n=t.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,n.call(this,a)}}),Object.defineProperty(s,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Rv(s){s._valueTracker||(s._valueTracker=Tj(s))}function sO(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return s&&(i=nO(s)?s.checked?"true":"false":s.value),s=i,s!==t?(e.setValue(s),!0):!1}function kg(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function zx(s,e){var t=e.checked;return fr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??s._wrapperState.initialChecked})}function aT(s,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=$l(e.value!=null?e.value:t),s._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function aO(s,e){e=e.checked,e!=null&&iE(s,"checked",e,!1)}function jx(s,e){aO(s,e);var t=$l(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+t):s.value!==""+t&&(s.value=""+t);else if(i==="submit"||i==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?Bx(s,e.type,t):e.hasOwnProperty("defaultValue")&&Bx(s,e.type,$l(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function oT(s,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,t||e===s.value||(s.value=e),s.defaultValue=e}t=s.name,t!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,t!==""&&(s.name=t)}function Bx(s,e,t){(e!=="number"||kg(s.ownerDocument)!==s)&&(t==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+t&&(s.defaultValue=""+t))}var Dp=Array.isArray;function kc(s,e,t,i){if(s=s.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<s.length;t++)r=e.hasOwnProperty("$"+s[t].value),s[t].selected!==r&&(s[t].selected=r),r&&i&&(s[t].defaultSelected=!0)}else{for(t=""+$l(t),e=null,r=0;r<s.length;r++){if(s[r].value===t){s[r].selected=!0,i&&(s[r].defaultSelected=!0);return}e!==null||s[r].disabled||(e=s[r])}e!==null&&(e.selected=!0)}}function Hx(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(We(91));return fr({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function lT(s,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(We(92));if(Dp(t)){if(1<t.length)throw Error(We(93));t=t[0]}e=t}e==null&&(e=""),t=e}s._wrapperState={initialValue:$l(t)}}function oO(s,e){var t=$l(e.value),i=$l(e.defaultValue);t!=null&&(t=""+t,t!==s.value&&(s.value=t),e.defaultValue==null&&s.defaultValue!==t&&(s.defaultValue=t)),i!=null&&(s.defaultValue=""+i)}function hT(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function lO(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vx(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?lO(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Fv,hO=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return s(e,t,i,r)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(Fv=Fv||document.createElement("div"),Fv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fv.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function af(s,e){if(e){var t=s.firstChild;if(t&&t===s.lastChild&&t.nodeType===3){t.nodeValue=e;return}}s.textContent=e}var Fp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dj=["Webkit","ms","Moz","O"];Object.keys(Fp).forEach(function(s){Dj.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),Fp[e]=Fp[s]})});function uO(s,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Fp.hasOwnProperty(s)&&Fp[s]?(""+e).trim():e+"px"}function cO(s,e){s=s.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=uO(t,e[t],i);t==="float"&&(t="cssFloat"),i?s.setProperty(t,r):s[t]=r}}var Aj=fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ux(s,e){if(e){if(Aj[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(We(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(We(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(We(61))}if(e.style!=null&&typeof e.style!="object")throw Error(We(62))}}function _x(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wx=null;function aE(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var qx=null,Lc=null,Oc=null;function uT(s){if(s=mv(s)){if(typeof qx!="function")throw Error(We(280));var e=s.stateNode;e&&(e=Q0(e),qx(s.stateNode,s.type,e))}}function dO(s){Lc?Oc?Oc.push(s):Oc=[s]:Lc=s}function pO(){if(Lc){var s=Lc,e=Oc;if(Oc=Lc=null,uT(s),e)for(s=0;s<e.length;s++)uT(e[s])}}function fO(s,e){return s(e)}function vO(){}var Vb=!1;function mO(s,e,t){if(Vb)return s(e,t);Vb=!0;try{return fO(s,e,t)}finally{Vb=!1,(Lc!==null||Oc!==null)&&(vO(),pO())}}function of(s,e){var t=s.stateNode;if(t===null)return null;var i=Q0(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(s=s.type,i=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!i;break e;default:s=!1}if(s)return null;if(t&&typeof t!="function")throw Error(We(231,e,typeof t));return t}var Yx=!1;if(Uo)try{var Vd={};Object.defineProperty(Vd,"passive",{get:function(){Yx=!0}}),window.addEventListener("test",Vd,Vd),window.removeEventListener("test",Vd,Vd)}catch{Yx=!1}function Nj(s,e,t,i,r,n,a,o,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(u){this.onError(u)}}var Pp=!1,Lg=null,Og=!1,Qx=null,kj={onError:function(s){Pp=!0,Lg=s}};function Lj(s,e,t,i,r,n,a,o,l){Pp=!1,Lg=null,Nj.apply(kj,arguments)}function Oj(s,e,t,i,r,n,a,o,l){if(Lj.apply(this,arguments),Pp){if(Pp){var h=Lg;Pp=!1,Lg=null}else throw Error(We(198));Og||(Og=!0,Qx=h)}}function xu(s){var e=s,t=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(t=e.return),s=e.return;while(s)}return e.tag===3?t:null}function gO(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function cT(s){if(xu(s)!==s)throw Error(We(188))}function Rj(s){var e=s.alternate;if(!e){if(e=xu(s),e===null)throw Error(We(188));return e!==s?null:s}for(var t=s,i=e;;){var r=t.return;if(r===null)break;var n=r.alternate;if(n===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===n.child){for(n=r.child;n;){if(n===t)return cT(r),s;if(n===i)return cT(r),e;n=n.sibling}throw Error(We(188))}if(t.return!==i.return)t=r,i=n;else{for(var a=!1,o=r.child;o;){if(o===t){a=!0,t=r,i=n;break}if(o===i){a=!0,i=r,t=n;break}o=o.sibling}if(!a){for(o=n.child;o;){if(o===t){a=!0,t=n,i=r;break}if(o===i){a=!0,i=n,t=r;break}o=o.sibling}if(!a)throw Error(We(189))}}if(t.alternate!==i)throw Error(We(190))}if(t.tag!==3)throw Error(We(188));return t.stateNode.current===t?s:e}function yO(s){return s=Rj(s),s!==null?bO(s):null}function bO(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=bO(s);if(e!==null)return e;s=s.sibling}return null}var CO=Ls.unstable_scheduleCallback,dT=Ls.unstable_cancelCallback,Fj=Ls.unstable_shouldYield,Pj=Ls.unstable_requestPaint,xr=Ls.unstable_now,zj=Ls.unstable_getCurrentPriorityLevel,oE=Ls.unstable_ImmediatePriority,SO=Ls.unstable_UserBlockingPriority,Rg=Ls.unstable_NormalPriority,jj=Ls.unstable_LowPriority,xO=Ls.unstable_IdlePriority,_0=null,io=null;function Bj(s){if(io&&typeof io.onCommitFiberRoot=="function")try{io.onCommitFiberRoot(_0,s,void 0,(s.current.flags&128)===128)}catch{}}var Ma=Math.clz32?Math.clz32:Uj,Hj=Math.log,Vj=Math.LN2;function Uj(s){return s>>>=0,s===0?32:31-(Hj(s)/Vj|0)|0}var Pv=64,zv=4194304;function Ap(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Fg(s,e){var t=s.pendingLanes;if(t===0)return 0;var i=0,r=s.suspendedLanes,n=s.pingedLanes,a=t&268435455;if(a!==0){var o=a&~r;o!==0?i=Ap(o):(n&=a,n!==0&&(i=Ap(n)))}else a=t&~r,a!==0?i=Ap(a):n!==0&&(i=Ap(n));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,n=e&-e,r>=n||r===16&&(n&4194240)!==0))return e;if(i&4&&(i|=t&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=i;0<e;)t=31-Ma(e),r=1<<t,i|=s[t],e&=~r;return i}function _j(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wj(s,e){for(var t=s.suspendedLanes,i=s.pingedLanes,r=s.expirationTimes,n=s.pendingLanes;0<n;){var a=31-Ma(n),o=1<<a,l=r[a];l===-1?(!(o&t)||o&i)&&(r[a]=_j(o,e)):l<=e&&(s.expiredLanes|=o),n&=~o}}function Gx(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function wO(){var s=Pv;return Pv<<=1,!(Pv&4194240)&&(Pv=64),s}function Ub(s){for(var e=[],t=0;31>t;t++)e.push(s);return e}function fv(s,e,t){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-Ma(e),s[e]=t}function qj(s,e){var t=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var i=s.eventTimes;for(s=s.expirationTimes;0<t;){var r=31-Ma(t),n=1<<r;e[r]=0,i[r]=-1,s[r]=-1,t&=~n}}function lE(s,e){var t=s.entangledLanes|=e;for(s=s.entanglements;t;){var i=31-Ma(t),r=1<<i;r&e|s[i]&e&&(s[i]|=e),t&=~r}}var Ai=0;function MO(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var EO,hE,IO,TO,DO,$x=!1,jv=[],Rl=null,Fl=null,Pl=null,lf=new Map,hf=new Map,Cl=[],Yj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pT(s,e){switch(s){case"focusin":case"focusout":Rl=null;break;case"dragenter":case"dragleave":Fl=null;break;case"mouseover":case"mouseout":Pl=null;break;case"pointerover":case"pointerout":lf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":hf.delete(e.pointerId)}}function Ud(s,e,t,i,r,n){return s===null||s.nativeEvent!==n?(s={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:n,targetContainers:[r]},e!==null&&(e=mv(e),e!==null&&hE(e)),s):(s.eventSystemFlags|=i,e=s.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),s)}function Qj(s,e,t,i,r){switch(e){case"focusin":return Rl=Ud(Rl,s,e,t,i,r),!0;case"dragenter":return Fl=Ud(Fl,s,e,t,i,r),!0;case"mouseover":return Pl=Ud(Pl,s,e,t,i,r),!0;case"pointerover":var n=r.pointerId;return lf.set(n,Ud(lf.get(n)||null,s,e,t,i,r)),!0;case"gotpointercapture":return n=r.pointerId,hf.set(n,Ud(hf.get(n)||null,s,e,t,i,r)),!0}return!1}function AO(s){var e=Oh(s.target);if(e!==null){var t=xu(e);if(t!==null){if(e=t.tag,e===13){if(e=gO(t),e!==null){s.blockedOn=e,DO(s.priority,function(){IO(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){s.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}s.blockedOn=null}function cg(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var t=Xx(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(t===null){t=s.nativeEvent;var i=new t.constructor(t.type,t);Wx=i,t.target.dispatchEvent(i),Wx=null}else return e=mv(t),e!==null&&hE(e),s.blockedOn=t,!1;e.shift()}return!0}function fT(s,e,t){cg(s)&&t.delete(e)}function Gj(){$x=!1,Rl!==null&&cg(Rl)&&(Rl=null),Fl!==null&&cg(Fl)&&(Fl=null),Pl!==null&&cg(Pl)&&(Pl=null),lf.forEach(fT),hf.forEach(fT)}function _d(s,e){s.blockedOn===e&&(s.blockedOn=null,$x||($x=!0,Ls.unstable_scheduleCallback(Ls.unstable_NormalPriority,Gj)))}function uf(s){function e(r){return _d(r,s)}if(0<jv.length){_d(jv[0],s);for(var t=1;t<jv.length;t++){var i=jv[t];i.blockedOn===s&&(i.blockedOn=null)}}for(Rl!==null&&_d(Rl,s),Fl!==null&&_d(Fl,s),Pl!==null&&_d(Pl,s),lf.forEach(e),hf.forEach(e),t=0;t<Cl.length;t++)i=Cl[t],i.blockedOn===s&&(i.blockedOn=null);for(;0<Cl.length&&(t=Cl[0],t.blockedOn===null);)AO(t),t.blockedOn===null&&Cl.shift()}var Rc=Go.ReactCurrentBatchConfig,Pg=!0;function $j(s,e,t,i){var r=Ai,n=Rc.transition;Rc.transition=null;try{Ai=1,uE(s,e,t,i)}finally{Ai=r,Rc.transition=n}}function Xj(s,e,t,i){var r=Ai,n=Rc.transition;Rc.transition=null;try{Ai=4,uE(s,e,t,i)}finally{Ai=r,Rc.transition=n}}function uE(s,e,t,i){if(Pg){var r=Xx(s,e,t,i);if(r===null)Zb(s,e,i,zg,t),pT(s,i);else if(Qj(r,s,e,t,i))i.stopPropagation();else if(pT(s,i),e&4&&-1<Yj.indexOf(s)){for(;r!==null;){var n=mv(r);if(n!==null&&EO(n),n=Xx(s,e,t,i),n===null&&Zb(s,e,i,zg,t),n===r)break;r=n}r!==null&&i.stopPropagation()}else Zb(s,e,i,null,t)}}var zg=null;function Xx(s,e,t,i){if(zg=null,s=aE(i),s=Oh(s),s!==null)if(e=xu(s),e===null)s=null;else if(t=e.tag,t===13){if(s=gO(e),s!==null)return s;s=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return zg=s,null}function NO(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zj()){case oE:return 1;case SO:return 4;case Rg:case jj:return 16;case xO:return 536870912;default:return 16}default:return 16}}var El=null,cE=null,dg=null;function kO(){if(dg)return dg;var s,e=cE,t=e.length,i,r="value"in El?El.value:El.textContent,n=r.length;for(s=0;s<t&&e[s]===r[s];s++);var a=t-s;for(i=1;i<=a&&e[t-i]===r[n-i];i++);return dg=r.slice(s,1<i?1-i:void 0)}function pg(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function Bv(){return!0}function vT(){return!1}function Rs(s){function e(t,i,r,n,a){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=n,this.target=a,this.currentTarget=null;for(var o in s)s.hasOwnProperty(o)&&(t=s[o],this[o]=t?t(n):n[o]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?Bv:vT,this.isPropagationStopped=vT,this}return fr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Bv)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Bv)},persist:function(){},isPersistent:Bv}),e}var Fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dE=Rs(Fd),vv=fr({},Fd,{view:0,detail:0}),Kj=Rs(vv),_b,Wb,Wd,W0=fr({},vv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pE,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wd&&(Wd&&s.type==="mousemove"?(_b=s.screenX-Wd.screenX,Wb=s.screenY-Wd.screenY):Wb=_b=0,Wd=s),_b)},movementY:function(s){return"movementY"in s?s.movementY:Wb}}),mT=Rs(W0),Zj=fr({},W0,{dataTransfer:0}),Jj=Rs(Zj),e4=fr({},vv,{relatedTarget:0}),qb=Rs(e4),t4=fr({},Fd,{animationName:0,elapsedTime:0,pseudoElement:0}),i4=Rs(t4),r4=fr({},Fd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),n4=Rs(r4),s4=fr({},Fd,{data:0}),gT=Rs(s4),a4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function h4(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=l4[s])?!!e[s]:!1}function pE(){return h4}var u4=fr({},vv,{key:function(s){if(s.key){var e=a4[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=pg(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?o4[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pE,charCode:function(s){return s.type==="keypress"?pg(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?pg(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),c4=Rs(u4),d4=fr({},W0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yT=Rs(d4),p4=fr({},vv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pE}),f4=Rs(p4),v4=fr({},Fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),m4=Rs(v4),g4=fr({},W0,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),y4=Rs(g4),b4=[9,13,27,32],fE=Uo&&"CompositionEvent"in window,zp=null;Uo&&"documentMode"in document&&(zp=document.documentMode);var C4=Uo&&"TextEvent"in window&&!zp,LO=Uo&&(!fE||zp&&8<zp&&11>=zp),bT=" ",CT=!1;function OO(s,e){switch(s){case"keyup":return b4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RO(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var cc=!1;function S4(s,e){switch(s){case"compositionend":return RO(e);case"keypress":return e.which!==32?null:(CT=!0,bT);case"textInput":return s=e.data,s===bT&&CT?null:s;default:return null}}function x4(s,e){if(cc)return s==="compositionend"||!fE&&OO(s,e)?(s=kO(),dg=cE=El=null,cc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LO&&e.locale!=="ko"?null:e.data;default:return null}}var w4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ST(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!w4[s.type]:e==="textarea"}function FO(s,e,t,i){dO(i),e=jg(e,"onChange"),0<e.length&&(t=new dE("onChange","change",null,t,i),s.push({event:t,listeners:e}))}var jp=null,cf=null;function M4(s){YO(s,0)}function q0(s){var e=fc(s);if(sO(e))return s}function E4(s,e){if(s==="change")return e}var PO=!1;if(Uo){var Yb;if(Uo){var Qb="oninput"in document;if(!Qb){var xT=document.createElement("div");xT.setAttribute("oninput","return;"),Qb=typeof xT.oninput=="function"}Yb=Qb}else Yb=!1;PO=Yb&&(!document.documentMode||9<document.documentMode)}function wT(){jp&&(jp.detachEvent("onpropertychange",zO),cf=jp=null)}function zO(s){if(s.propertyName==="value"&&q0(cf)){var e=[];FO(e,cf,s,aE(s)),mO(M4,e)}}function I4(s,e,t){s==="focusin"?(wT(),jp=e,cf=t,jp.attachEvent("onpropertychange",zO)):s==="focusout"&&wT()}function T4(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return q0(cf)}function D4(s,e){if(s==="click")return q0(e)}function A4(s,e){if(s==="input"||s==="change")return q0(e)}function N4(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var ka=typeof Object.is=="function"?Object.is:N4;function df(s,e){if(ka(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var t=Object.keys(s),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!Lx.call(e,r)||!ka(s[r],e[r]))return!1}return!0}function MT(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ET(s,e){var t=MT(s);s=0;for(var i;t;){if(t.nodeType===3){if(i=s+t.textContent.length,s<=e&&i>=e)return{node:t,offset:e-s};s=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=MT(t)}}function jO(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?jO(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function BO(){for(var s=window,e=kg();e instanceof s.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)s=e.contentWindow;else break;e=kg(s.document)}return e}function vE(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function k4(s){var e=BO(),t=s.focusedElem,i=s.selectionRange;if(e!==t&&t&&t.ownerDocument&&jO(t.ownerDocument.documentElement,t)){if(i!==null&&vE(t)){if(e=i.start,s=i.end,s===void 0&&(s=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(s,t.value.length);else if(s=(e=t.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var r=t.textContent.length,n=Math.min(i.start,r);i=i.end===void 0?n:Math.min(i.end,r),!s.extend&&n>i&&(r=i,i=n,n=r),r=ET(t,n);var a=ET(t,i);r&&a&&(s.rangeCount!==1||s.anchorNode!==r.node||s.anchorOffset!==r.offset||s.focusNode!==a.node||s.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),s.removeAllRanges(),n>i?(s.addRange(e),s.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),s.addRange(e)))}}for(e=[],s=t;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)s=e[t],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var L4=Uo&&"documentMode"in document&&11>=document.documentMode,dc=null,Kx=null,Bp=null,Zx=!1;function IT(s,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Zx||dc==null||dc!==kg(i)||(i=dc,"selectionStart"in i&&vE(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Bp&&df(Bp,i)||(Bp=i,i=jg(Kx,"onSelect"),0<i.length&&(e=new dE("onSelect","select",null,e,t),s.push({event:e,listeners:i}),e.target=dc)))}function Hv(s,e){var t={};return t[s.toLowerCase()]=e.toLowerCase(),t["Webkit"+s]="webkit"+e,t["Moz"+s]="moz"+e,t}var pc={animationend:Hv("Animation","AnimationEnd"),animationiteration:Hv("Animation","AnimationIteration"),animationstart:Hv("Animation","AnimationStart"),transitionend:Hv("Transition","TransitionEnd")},Gb={},HO={};Uo&&(HO=document.createElement("div").style,"AnimationEvent"in window||(delete pc.animationend.animation,delete pc.animationiteration.animation,delete pc.animationstart.animation),"TransitionEvent"in window||delete pc.transitionend.transition);function Y0(s){if(Gb[s])return Gb[s];if(!pc[s])return s;var e=pc[s],t;for(t in e)if(e.hasOwnProperty(t)&&t in HO)return Gb[s]=e[t];return s}var VO=Y0("animationend"),UO=Y0("animationiteration"),_O=Y0("animationstart"),WO=Y0("transitionend"),qO=new Map,TT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ph(s,e){qO.set(s,e),Su(e,[s])}for(var $b=0;$b<TT.length;$b++){var Xb=TT[$b],O4=Xb.toLowerCase(),R4=Xb[0].toUpperCase()+Xb.slice(1);ph(O4,"on"+R4)}ph(VO,"onAnimationEnd");ph(UO,"onAnimationIteration");ph(_O,"onAnimationStart");ph("dblclick","onDoubleClick");ph("focusin","onFocus");ph("focusout","onBlur");ph(WO,"onTransitionEnd");Xc("onMouseEnter",["mouseout","mouseover"]);Xc("onMouseLeave",["mouseout","mouseover"]);Xc("onPointerEnter",["pointerout","pointerover"]);Xc("onPointerLeave",["pointerout","pointerover"]);Su("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Su("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Su("onBeforeInput",["compositionend","keypress","textInput","paste"]);Su("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Su("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Su("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Np="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Np));function DT(s,e,t){var i=s.type||"unknown-event";s.currentTarget=t,Oj(i,e,void 0,s),s.currentTarget=null}function YO(s,e){e=(e&4)!==0;for(var t=0;t<s.length;t++){var i=s[t],r=i.event;i=i.listeners;e:{var n=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,h=o.currentTarget;if(o=o.listener,l!==n&&r.isPropagationStopped())break e;DT(r,o,h),n=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,h=o.currentTarget,o=o.listener,l!==n&&r.isPropagationStopped())break e;DT(r,o,h),n=l}}}if(Og)throw s=Qx,Og=!1,Qx=null,s}function _i(s,e){var t=e[rw];t===void 0&&(t=e[rw]=new Set);var i=s+"__bubble";t.has(i)||(QO(e,s,2,!1),t.add(i))}function Kb(s,e,t){var i=0;e&&(i|=4),QO(t,s,i,e)}var Vv="_reactListening"+Math.random().toString(36).slice(2);function pf(s){if(!s[Vv]){s[Vv]=!0,eO.forEach(function(t){t!=="selectionchange"&&(F4.has(t)||Kb(t,!1,s),Kb(t,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[Vv]||(e[Vv]=!0,Kb("selectionchange",!1,e))}}function QO(s,e,t,i){switch(NO(e)){case 1:var r=$j;break;case 4:r=Xj;break;default:r=uE}t=r.bind(null,e,t,s),r=void 0,!Yx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?s.addEventListener(e,t,{capture:!0,passive:r}):s.addEventListener(e,t,!0):r!==void 0?s.addEventListener(e,t,{passive:r}):s.addEventListener(e,t,!1)}function Zb(s,e,t,i,r){var n=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=Oh(o),a===null)return;if(l=a.tag,l===5||l===6){i=n=a;continue e}o=o.parentNode}}i=i.return}mO(function(){var h=n,u=aE(t),c=[];e:{var d=qO.get(s);if(d!==void 0){var p=dE,f=s;switch(s){case"keypress":if(pg(t)===0)break e;case"keydown":case"keyup":p=c4;break;case"focusin":f="focus",p=qb;break;case"focusout":f="blur",p=qb;break;case"beforeblur":case"afterblur":p=qb;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=mT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Jj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=f4;break;case VO:case UO:case _O:p=i4;break;case WO:p=m4;break;case"scroll":p=Kj;break;case"wheel":p=y4;break;case"copy":case"cut":case"paste":p=n4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=yT}var v=(e&4)!==0,g=!v&&s==="scroll",b=v?d!==null?d+"Capture":null:d;v=[];for(var y=h,C;y!==null;){C=y;var x=C.stateNode;if(C.tag===5&&x!==null&&(C=x,b!==null&&(x=of(y,b),x!=null&&v.push(ff(y,x,C)))),g)break;y=y.return}0<v.length&&(d=new p(d,f,null,t,u),c.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=s==="mouseover"||s==="pointerover",p=s==="mouseout"||s==="pointerout",d&&t!==Wx&&(f=t.relatedTarget||t.fromElement)&&(Oh(f)||f[_o]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=t.relatedTarget||t.toElement,p=h,f=f?Oh(f):null,f!==null&&(g=xu(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=h),p!==f)){if(v=mT,x="onMouseLeave",b="onMouseEnter",y="mouse",(s==="pointerout"||s==="pointerover")&&(v=yT,x="onPointerLeave",b="onPointerEnter",y="pointer"),g=p==null?d:fc(p),C=f==null?d:fc(f),d=new v(x,y+"leave",p,t,u),d.target=g,d.relatedTarget=C,x=null,Oh(u)===h&&(v=new v(b,y+"enter",f,t,u),v.target=C,v.relatedTarget=g,x=v),g=x,p&&f)t:{for(v=p,b=f,y=0,C=v;C;C=Ou(C))y++;for(C=0,x=b;x;x=Ou(x))C++;for(;0<y-C;)v=Ou(v),y--;for(;0<C-y;)b=Ou(b),C--;for(;y--;){if(v===b||b!==null&&v===b.alternate)break t;v=Ou(v),b=Ou(b)}v=null}else v=null;p!==null&&AT(c,d,p,v,!1),f!==null&&g!==null&&AT(c,g,f,v,!0)}}e:{if(d=h?fc(h):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var w=E4;else if(ST(d))if(PO)w=A4;else{w=T4;var M=I4}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=D4);if(w&&(w=w(s,h))){FO(c,w,t,u);break e}M&&M(s,d,h),s==="focusout"&&(M=d._wrapperState)&&M.controlled&&d.type==="number"&&Bx(d,"number",d.value)}switch(M=h?fc(h):window,s){case"focusin":(ST(M)||M.contentEditable==="true")&&(dc=M,Kx=h,Bp=null);break;case"focusout":Bp=Kx=dc=null;break;case"mousedown":Zx=!0;break;case"contextmenu":case"mouseup":case"dragend":Zx=!1,IT(c,t,u);break;case"selectionchange":if(L4)break;case"keydown":case"keyup":IT(c,t,u)}var E;if(fE)e:{switch(s){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else cc?OO(s,t)&&(T="onCompositionEnd"):s==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(LO&&t.locale!=="ko"&&(cc||T!=="onCompositionStart"?T==="onCompositionEnd"&&cc&&(E=kO()):(El=u,cE="value"in El?El.value:El.textContent,cc=!0)),M=jg(h,T),0<M.length&&(T=new gT(T,s,null,t,u),c.push({event:T,listeners:M}),E?T.data=E:(E=RO(t),E!==null&&(T.data=E)))),(E=C4?S4(s,t):x4(s,t))&&(h=jg(h,"onBeforeInput"),0<h.length&&(u=new gT("onBeforeInput","beforeinput",null,t,u),c.push({event:u,listeners:h}),u.data=E))}YO(c,e)})}function ff(s,e,t){return{instance:s,listener:e,currentTarget:t}}function jg(s,e){for(var t=e+"Capture",i=[];s!==null;){var r=s,n=r.stateNode;r.tag===5&&n!==null&&(r=n,n=of(s,t),n!=null&&i.unshift(ff(s,n,r)),n=of(s,e),n!=null&&i.push(ff(s,n,r))),s=s.return}return i}function Ou(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function AT(s,e,t,i,r){for(var n=e._reactName,a=[];t!==null&&t!==i;){var o=t,l=o.alternate,h=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&h!==null&&(o=h,r?(l=of(t,n),l!=null&&a.unshift(ff(t,l,o))):r||(l=of(t,n),l!=null&&a.push(ff(t,l,o)))),t=t.return}a.length!==0&&s.push({event:e,listeners:a})}var P4=/\r\n?/g,z4=/\u0000|\uFFFD/g;function NT(s){return(typeof s=="string"?s:""+s).replace(P4,`
`).replace(z4,"")}function Uv(s,e,t){if(e=NT(e),NT(s)!==e&&t)throw Error(We(425))}function Bg(){}var Jx=null,ew=null;function tw(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var iw=typeof setTimeout=="function"?setTimeout:void 0,j4=typeof clearTimeout=="function"?clearTimeout:void 0,kT=typeof Promise=="function"?Promise:void 0,B4=typeof queueMicrotask=="function"?queueMicrotask:typeof kT<"u"?function(s){return kT.resolve(null).then(s).catch(H4)}:iw;function H4(s){setTimeout(function(){throw s})}function Jb(s,e){var t=e,i=0;do{var r=t.nextSibling;if(s.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){s.removeChild(r),uf(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);uf(e)}function zl(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function LT(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return s;e--}else t==="/$"&&e++}s=s.previousSibling}return null}var Pd=Math.random().toString(36).slice(2),Ya="__reactFiber$"+Pd,vf="__reactProps$"+Pd,_o="__reactContainer$"+Pd,rw="__reactEvents$"+Pd,V4="__reactListeners$"+Pd,U4="__reactHandles$"+Pd;function Oh(s){var e=s[Ya];if(e)return e;for(var t=s.parentNode;t;){if(e=t[_o]||t[Ya]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(s=LT(s);s!==null;){if(t=s[Ya])return t;s=LT(s)}return e}s=t,t=s.parentNode}return null}function mv(s){return s=s[Ya]||s[_o],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function fc(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(We(33))}function Q0(s){return s[vf]||null}var nw=[],vc=-1;function fh(s){return{current:s}}function Yi(s){0>vc||(s.current=nw[vc],nw[vc]=null,vc--)}function Hi(s,e){vc++,nw[vc]=s.current,s.current=e}var Xl={},zn=fh(Xl),ls=fh(!1),Jh=Xl;function Kc(s,e){var t=s.type.contextTypes;if(!t)return Xl;var i=s.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},n;for(n in t)r[n]=e[n];return i&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=r),r}function hs(s){return s=s.childContextTypes,s!=null}function Hg(){Yi(ls),Yi(zn)}function OT(s,e,t){if(zn.current!==Xl)throw Error(We(168));Hi(zn,e),Hi(ls,t)}function GO(s,e,t){var i=s.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(We(108,Ij(s)||"Unknown",r));return fr({},t,i)}function Vg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Xl,Jh=zn.current,Hi(zn,s),Hi(ls,ls.current),!0}function RT(s,e,t){var i=s.stateNode;if(!i)throw Error(We(169));t?(s=GO(s,e,Jh),i.__reactInternalMemoizedMergedChildContext=s,Yi(ls),Yi(zn),Hi(zn,s)):Yi(ls),Hi(ls,t)}var No=null,G0=!1,eC=!1;function $O(s){No===null?No=[s]:No.push(s)}function _4(s){G0=!0,$O(s)}function vh(){if(!eC&&No!==null){eC=!0;var s=0,e=Ai;try{var t=No;for(Ai=1;s<t.length;s++){var i=t[s];do i=i(!0);while(i!==null)}No=null,G0=!1}catch(r){throw No!==null&&(No=No.slice(s+1)),CO(oE,vh),r}finally{Ai=e,eC=!1}}return null}var mc=[],gc=0,Ug=null,_g=0,Ws=[],qs=0,eu=null,Ro=1,Fo="";function Eh(s,e){mc[gc++]=_g,mc[gc++]=Ug,Ug=s,_g=e}function XO(s,e,t){Ws[qs++]=Ro,Ws[qs++]=Fo,Ws[qs++]=eu,eu=s;var i=Ro;s=Fo;var r=32-Ma(i)-1;i&=~(1<<r),t+=1;var n=32-Ma(e)+r;if(30<n){var a=r-r%5;n=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Ro=1<<32-Ma(e)+r|t<<r|i,Fo=n+s}else Ro=1<<n|t<<r|i,Fo=s}function mE(s){s.return!==null&&(Eh(s,1),XO(s,1,0))}function gE(s){for(;s===Ug;)Ug=mc[--gc],mc[gc]=null,_g=mc[--gc],mc[gc]=null;for(;s===eu;)eu=Ws[--qs],Ws[qs]=null,Fo=Ws[--qs],Ws[qs]=null,Ro=Ws[--qs],Ws[qs]=null}var Ds=null,Is=null,Ji=!1,ya=null;function KO(s,e){var t=Ys(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=s,e=s.deletions,e===null?(s.deletions=[t],s.flags|=16):e.push(t)}function FT(s,e){switch(s.tag){case 5:var t=s.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,Ds=s,Is=zl(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,Ds=s,Is=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=eu!==null?{id:Ro,overflow:Fo}:null,s.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ys(18,null,null,0),t.stateNode=e,t.return=s,s.child=t,Ds=s,Is=null,!0):!1;default:return!1}}function sw(s){return(s.mode&1)!==0&&(s.flags&128)===0}function aw(s){if(Ji){var e=Is;if(e){var t=e;if(!FT(s,e)){if(sw(s))throw Error(We(418));e=zl(t.nextSibling);var i=Ds;e&&FT(s,e)?KO(i,t):(s.flags=s.flags&-4097|2,Ji=!1,Ds=s)}}else{if(sw(s))throw Error(We(418));s.flags=s.flags&-4097|2,Ji=!1,Ds=s}}}function PT(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ds=s}function _v(s){if(s!==Ds)return!1;if(!Ji)return PT(s),Ji=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!tw(s.type,s.memoizedProps)),e&&(e=Is)){if(sw(s))throw ZO(),Error(We(418));for(;e;)KO(s,e),e=zl(e.nextSibling)}if(PT(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(We(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="/$"){if(e===0){Is=zl(s.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}s=s.nextSibling}Is=null}}else Is=Ds?zl(s.stateNode.nextSibling):null;return!0}function ZO(){for(var s=Is;s;)s=zl(s.nextSibling)}function Zc(){Is=Ds=null,Ji=!1}function yE(s){ya===null?ya=[s]:ya.push(s)}var W4=Go.ReactCurrentBatchConfig;function va(s,e){if(s&&s.defaultProps){e=fr({},e),s=s.defaultProps;for(var t in s)e[t]===void 0&&(e[t]=s[t]);return e}return e}var Wg=fh(null),qg=null,yc=null,bE=null;function CE(){bE=yc=qg=null}function SE(s){var e=Wg.current;Yi(Wg),s._currentValue=e}function ow(s,e,t){for(;s!==null;){var i=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),s===t)break;s=s.return}}function Fc(s,e){qg=s,bE=yc=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(os=!0),s.firstContext=null)}function ia(s){var e=s._currentValue;if(bE!==s)if(s={context:s,memoizedValue:e,next:null},yc===null){if(qg===null)throw Error(We(308));yc=s,qg.dependencies={lanes:0,firstContext:s}}else yc=yc.next=s;return e}var Rh=null;function xE(s){Rh===null?Rh=[s]:Rh.push(s)}function JO(s,e,t,i){var r=e.interleaved;return r===null?(t.next=t,xE(e)):(t.next=r.next,r.next=t),e.interleaved=t,Wo(s,i)}function Wo(s,e){s.lanes|=e;var t=s.alternate;for(t!==null&&(t.lanes|=e),t=s,s=s.return;s!==null;)s.childLanes|=e,t=s.alternate,t!==null&&(t.childLanes|=e),t=s,s=s.return;return t.tag===3?t.stateNode:null}var ml=!1;function wE(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eR(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function jo(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function jl(s,e,t){var i=s.updateQueue;if(i===null)return null;if(i=i.shared,fi&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Wo(s,t)}return r=i.interleaved,r===null?(e.next=e,xE(i)):(e.next=r.next,r.next=e),i.interleaved=e,Wo(s,t)}function fg(s,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=s.pendingLanes,t|=i,e.lanes=t,lE(s,t)}}function zT(s,e){var t=s.updateQueue,i=s.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,n=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};n===null?r=n=a:n=n.next=a,t=t.next}while(t!==null);n===null?r=n=e:n=n.next=e}else r=n=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:i.shared,effects:i.effects},s.updateQueue=t;return}s=t.lastBaseUpdate,s===null?t.firstBaseUpdate=e:s.next=e,t.lastBaseUpdate=e}function Yg(s,e,t,i){var r=s.updateQueue;ml=!1;var n=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,h=l.next;l.next=null,a===null?n=h:a.next=h,a=l;var u=s.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=h:o.next=h,u.lastBaseUpdate=l))}if(n!==null){var c=r.baseState;a=0,u=h=l=null,o=n;do{var d=o.lane,p=o.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=s,v=o;switch(d=e,p=t,v.tag){case 1:if(f=v.payload,typeof f=="function"){c=f.call(p,c,d);break e}c=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=v.payload,d=typeof f=="function"?f.call(p,c,d):f,d==null)break e;c=fr({},c,d);break e;case 2:ml=!0}}o.callback!==null&&o.lane!==0&&(s.flags|=64,d=r.effects,d===null?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(h=u=p,l=c):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;d=o,o=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(u===null&&(l=c),r.baseState=l,r.firstBaseUpdate=h,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else n===null&&(r.shared.lanes=0);iu|=a,s.lanes=a,s.memoizedState=c}}function jT(s,e,t){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var i=s[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(We(191,r));r.call(i)}}}var tR=new JL.Component().refs;function lw(s,e,t,i){e=s.memoizedState,t=t(i,e),t=t==null?e:fr({},e,t),s.memoizedState=t,s.lanes===0&&(s.updateQueue.baseState=t)}var $0={isMounted:function(s){return(s=s._reactInternals)?xu(s)===s:!1},enqueueSetState:function(s,e,t){s=s._reactInternals;var i=Gn(),r=Hl(s),n=jo(i,r);n.payload=e,t!=null&&(n.callback=t),e=jl(s,n,r),e!==null&&(Ea(e,s,r,i),fg(e,s,r))},enqueueReplaceState:function(s,e,t){s=s._reactInternals;var i=Gn(),r=Hl(s),n=jo(i,r);n.tag=1,n.payload=e,t!=null&&(n.callback=t),e=jl(s,n,r),e!==null&&(Ea(e,s,r,i),fg(e,s,r))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var t=Gn(),i=Hl(s),r=jo(t,i);r.tag=2,e!=null&&(r.callback=e),e=jl(s,r,i),e!==null&&(Ea(e,s,i,t),fg(e,s,i))}};function BT(s,e,t,i,r,n,a){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(i,n,a):e.prototype&&e.prototype.isPureReactComponent?!df(t,i)||!df(r,n):!0}function iR(s,e,t){var i=!1,r=Xl,n=e.contextType;return typeof n=="object"&&n!==null?n=ia(n):(r=hs(e)?Jh:zn.current,i=e.contextTypes,n=(i=i!=null)?Kc(s,r):Xl),e=new e(t,n),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$0,s.stateNode=e,e._reactInternals=s,i&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=r,s.__reactInternalMemoizedMaskedChildContext=n),e}function HT(s,e,t,i){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==s&&$0.enqueueReplaceState(e,e.state,null)}function hw(s,e,t,i){var r=s.stateNode;r.props=t,r.state=s.memoizedState,r.refs=tR,wE(s);var n=e.contextType;typeof n=="object"&&n!==null?r.context=ia(n):(n=hs(e)?Jh:zn.current,r.context=Kc(s,n)),r.state=s.memoizedState,n=e.getDerivedStateFromProps,typeof n=="function"&&(lw(s,e,n,t),r.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&$0.enqueueReplaceState(r,r.state,null),Yg(s,t,r,i),r.state=s.memoizedState),typeof r.componentDidMount=="function"&&(s.flags|=4194308)}function qd(s,e,t){if(s=t.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(We(309));var i=t.stateNode}if(!i)throw Error(We(147,s));var r=i,n=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===n?e.ref:(e=function(a){var o=r.refs;o===tR&&(o=r.refs={}),a===null?delete o[n]:o[n]=a},e._stringRef=n,e)}if(typeof s!="string")throw Error(We(284));if(!t._owner)throw Error(We(290,s))}return s}function Wv(s,e){throw s=Object.prototype.toString.call(e),Error(We(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function VT(s){var e=s._init;return e(s._payload)}function rR(s){function e(b,y){if(s){var C=b.deletions;C===null?(b.deletions=[y],b.flags|=16):C.push(y)}}function t(b,y){if(!s)return null;for(;y!==null;)e(b,y),y=y.sibling;return null}function i(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function r(b,y){return b=Vl(b,y),b.index=0,b.sibling=null,b}function n(b,y,C){return b.index=C,s?(C=b.alternate,C!==null?(C=C.index,C<y?(b.flags|=2,y):C):(b.flags|=2,y)):(b.flags|=1048576,y)}function a(b){return s&&b.alternate===null&&(b.flags|=2),b}function o(b,y,C,x){return y===null||y.tag!==6?(y=oC(C,b.mode,x),y.return=b,y):(y=r(y,C),y.return=b,y)}function l(b,y,C,x){var w=C.type;return w===uc?u(b,y,C.props.children,x,C.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===vl&&VT(w)===y.type)?(x=r(y,C.props),x.ref=qd(b,y,C),x.return=b,x):(x=Cg(C.type,C.key,C.props,null,b.mode,x),x.ref=qd(b,y,C),x.return=b,x)}function h(b,y,C,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==C.containerInfo||y.stateNode.implementation!==C.implementation?(y=lC(C,b.mode,x),y.return=b,y):(y=r(y,C.children||[]),y.return=b,y)}function u(b,y,C,x,w){return y===null||y.tag!==7?(y=Hh(C,b.mode,x,w),y.return=b,y):(y=r(y,C),y.return=b,y)}function c(b,y,C){if(typeof y=="string"&&y!==""||typeof y=="number")return y=oC(""+y,b.mode,C),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ov:return C=Cg(y.type,y.key,y.props,null,b.mode,C),C.ref=qd(b,null,y),C.return=b,C;case hc:return y=lC(y,b.mode,C),y.return=b,y;case vl:var x=y._init;return c(b,x(y._payload),C)}if(Dp(y)||Hd(y))return y=Hh(y,b.mode,C,null),y.return=b,y;Wv(b,y)}return null}function d(b,y,C,x){var w=y!==null?y.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return w!==null?null:o(b,y,""+C,x);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Ov:return C.key===w?l(b,y,C,x):null;case hc:return C.key===w?h(b,y,C,x):null;case vl:return w=C._init,d(b,y,w(C._payload),x)}if(Dp(C)||Hd(C))return w!==null?null:u(b,y,C,x,null);Wv(b,C)}return null}function p(b,y,C,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return b=b.get(C)||null,o(y,b,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ov:return b=b.get(x.key===null?C:x.key)||null,l(y,b,x,w);case hc:return b=b.get(x.key===null?C:x.key)||null,h(y,b,x,w);case vl:var M=x._init;return p(b,y,C,M(x._payload),w)}if(Dp(x)||Hd(x))return b=b.get(C)||null,u(y,b,x,w,null);Wv(y,x)}return null}function f(b,y,C,x){for(var w=null,M=null,E=y,T=y=0,D=null;E!==null&&T<C.length;T++){E.index>T?(D=E,E=null):D=E.sibling;var N=d(b,E,C[T],x);if(N===null){E===null&&(E=D);break}s&&E&&N.alternate===null&&e(b,E),y=n(N,y,T),M===null?w=N:M.sibling=N,M=N,E=D}if(T===C.length)return t(b,E),Ji&&Eh(b,T),w;if(E===null){for(;T<C.length;T++)E=c(b,C[T],x),E!==null&&(y=n(E,y,T),M===null?w=E:M.sibling=E,M=E);return Ji&&Eh(b,T),w}for(E=i(b,E);T<C.length;T++)D=p(E,b,T,C[T],x),D!==null&&(s&&D.alternate!==null&&E.delete(D.key===null?T:D.key),y=n(D,y,T),M===null?w=D:M.sibling=D,M=D);return s&&E.forEach(function(A){return e(b,A)}),Ji&&Eh(b,T),w}function v(b,y,C,x){var w=Hd(C);if(typeof w!="function")throw Error(We(150));if(C=w.call(C),C==null)throw Error(We(151));for(var M=w=null,E=y,T=y=0,D=null,N=C.next();E!==null&&!N.done;T++,N=C.next()){E.index>T?(D=E,E=null):D=E.sibling;var A=d(b,E,N.value,x);if(A===null){E===null&&(E=D);break}s&&E&&A.alternate===null&&e(b,E),y=n(A,y,T),M===null?w=A:M.sibling=A,M=A,E=D}if(N.done)return t(b,E),Ji&&Eh(b,T),w;if(E===null){for(;!N.done;T++,N=C.next())N=c(b,N.value,x),N!==null&&(y=n(N,y,T),M===null?w=N:M.sibling=N,M=N);return Ji&&Eh(b,T),w}for(E=i(b,E);!N.done;T++,N=C.next())N=p(E,b,T,N.value,x),N!==null&&(s&&N.alternate!==null&&E.delete(N.key===null?T:N.key),y=n(N,y,T),M===null?w=N:M.sibling=N,M=N);return s&&E.forEach(function(L){return e(b,L)}),Ji&&Eh(b,T),w}function g(b,y,C,x){if(typeof C=="object"&&C!==null&&C.type===uc&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Ov:e:{for(var w=C.key,M=y;M!==null;){if(M.key===w){if(w=C.type,w===uc){if(M.tag===7){t(b,M.sibling),y=r(M,C.props.children),y.return=b,b=y;break e}}else if(M.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===vl&&VT(w)===M.type){t(b,M.sibling),y=r(M,C.props),y.ref=qd(b,M,C),y.return=b,b=y;break e}t(b,M);break}else e(b,M);M=M.sibling}C.type===uc?(y=Hh(C.props.children,b.mode,x,C.key),y.return=b,b=y):(x=Cg(C.type,C.key,C.props,null,b.mode,x),x.ref=qd(b,y,C),x.return=b,b=x)}return a(b);case hc:e:{for(M=C.key;y!==null;){if(y.key===M)if(y.tag===4&&y.stateNode.containerInfo===C.containerInfo&&y.stateNode.implementation===C.implementation){t(b,y.sibling),y=r(y,C.children||[]),y.return=b,b=y;break e}else{t(b,y);break}else e(b,y);y=y.sibling}y=lC(C,b.mode,x),y.return=b,b=y}return a(b);case vl:return M=C._init,g(b,y,M(C._payload),x)}if(Dp(C))return f(b,y,C,x);if(Hd(C))return v(b,y,C,x);Wv(b,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,y!==null&&y.tag===6?(t(b,y.sibling),y=r(y,C),y.return=b,b=y):(t(b,y),y=oC(C,b.mode,x),y.return=b,b=y),a(b)):t(b,y)}return g}var Jc=rR(!0),nR=rR(!1),gv={},ro=fh(gv),mf=fh(gv),gf=fh(gv);function Fh(s){if(s===gv)throw Error(We(174));return s}function ME(s,e){switch(Hi(gf,e),Hi(mf,s),Hi(ro,gv),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vx(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=Vx(e,s)}Yi(ro),Hi(ro,e)}function ed(){Yi(ro),Yi(mf),Yi(gf)}function sR(s){Fh(gf.current);var e=Fh(ro.current),t=Vx(e,s.type);e!==t&&(Hi(mf,s),Hi(ro,t))}function EE(s){mf.current===s&&(Yi(ro),Yi(mf))}var lr=fh(0);function Qg(s){for(var e=s;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tC=[];function IE(){for(var s=0;s<tC.length;s++)tC[s]._workInProgressVersionPrimary=null;tC.length=0}var vg=Go.ReactCurrentDispatcher,iC=Go.ReactCurrentBatchConfig,tu=0,pr=null,Hr=null,Zr=null,Gg=!1,Hp=!1,yf=0,q4=0;function An(){throw Error(We(321))}function TE(s,e){if(e===null)return!1;for(var t=0;t<e.length&&t<s.length;t++)if(!ka(s[t],e[t]))return!1;return!0}function DE(s,e,t,i,r,n){if(tu=n,pr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vg.current=s===null||s.memoizedState===null?$4:X4,s=t(i,r),Hp){n=0;do{if(Hp=!1,yf=0,25<=n)throw Error(We(301));n+=1,Zr=Hr=null,e.updateQueue=null,vg.current=K4,s=t(i,r)}while(Hp)}if(vg.current=$g,e=Hr!==null&&Hr.next!==null,tu=0,Zr=Hr=pr=null,Gg=!1,e)throw Error(We(300));return s}function AE(){var s=yf!==0;return yf=0,s}function _a(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?pr.memoizedState=Zr=s:Zr=Zr.next=s,Zr}function ra(){if(Hr===null){var s=pr.alternate;s=s!==null?s.memoizedState:null}else s=Hr.next;var e=Zr===null?pr.memoizedState:Zr.next;if(e!==null)Zr=e,Hr=s;else{if(s===null)throw Error(We(310));Hr=s,s={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},Zr===null?pr.memoizedState=Zr=s:Zr=Zr.next=s}return Zr}function bf(s,e){return typeof e=="function"?e(s):e}function rC(s){var e=ra(),t=e.queue;if(t===null)throw Error(We(311));t.lastRenderedReducer=s;var i=Hr,r=i.baseQueue,n=t.pending;if(n!==null){if(r!==null){var a=r.next;r.next=n.next,n.next=a}i.baseQueue=r=n,t.pending=null}if(r!==null){n=r.next,i=i.baseState;var o=a=null,l=null,h=n;do{var u=h.lane;if((tu&u)===u)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:s(i,h.action);else{var c={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(o=l=c,a=i):l=l.next=c,pr.lanes|=u,iu|=u}h=h.next}while(h!==null&&h!==n);l===null?a=i:l.next=o,ka(i,e.memoizedState)||(os=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,t.lastRenderedState=i}if(s=t.interleaved,s!==null){r=s;do n=r.lane,pr.lanes|=n,iu|=n,r=r.next;while(r!==s)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function nC(s){var e=ra(),t=e.queue;if(t===null)throw Error(We(311));t.lastRenderedReducer=s;var i=t.dispatch,r=t.pending,n=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do n=s(n,a.action),a=a.next;while(a!==r);ka(n,e.memoizedState)||(os=!0),e.memoizedState=n,e.baseQueue===null&&(e.baseState=n),t.lastRenderedState=n}return[n,i]}function aR(){}function oR(s,e){var t=pr,i=ra(),r=e(),n=!ka(i.memoizedState,r);if(n&&(i.memoizedState=r,os=!0),i=i.queue,NE(uR.bind(null,t,i,s),[s]),i.getSnapshot!==e||n||Zr!==null&&Zr.memoizedState.tag&1){if(t.flags|=2048,Cf(9,hR.bind(null,t,i,r,e),void 0,null),sn===null)throw Error(We(349));tu&30||lR(t,e,r)}return r}function lR(s,e,t){s.flags|=16384,s={getSnapshot:e,value:t},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.stores=[s]):(t=e.stores,t===null?e.stores=[s]:t.push(s))}function hR(s,e,t,i){e.value=t,e.getSnapshot=i,cR(e)&&dR(s)}function uR(s,e,t){return t(function(){cR(e)&&dR(s)})}function cR(s){var e=s.getSnapshot;s=s.value;try{var t=e();return!ka(s,t)}catch{return!0}}function dR(s){var e=Wo(s,1);e!==null&&Ea(e,s,1,-1)}function UT(s){var e=_a();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:s},e.queue=s,s=s.dispatch=G4.bind(null,pr,s),[e.memoizedState,s]}function Cf(s,e,t,i){return s={tag:s,create:e,destroy:t,deps:i,next:null},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.lastEffect=s.next=s):(t=e.lastEffect,t===null?e.lastEffect=s.next=s:(i=t.next,t.next=s,s.next=i,e.lastEffect=s)),s}function pR(){return ra().memoizedState}function mg(s,e,t,i){var r=_a();pr.flags|=s,r.memoizedState=Cf(1|e,t,void 0,i===void 0?null:i)}function X0(s,e,t,i){var r=ra();i=i===void 0?null:i;var n=void 0;if(Hr!==null){var a=Hr.memoizedState;if(n=a.destroy,i!==null&&TE(i,a.deps)){r.memoizedState=Cf(e,t,n,i);return}}pr.flags|=s,r.memoizedState=Cf(1|e,t,n,i)}function _T(s,e){return mg(8390656,8,s,e)}function NE(s,e){return X0(2048,8,s,e)}function fR(s,e){return X0(4,2,s,e)}function vR(s,e){return X0(4,4,s,e)}function mR(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function gR(s,e,t){return t=t!=null?t.concat([s]):null,X0(4,4,mR.bind(null,e,s),t)}function kE(){}function yR(s,e){var t=ra();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&TE(e,i[1])?i[0]:(t.memoizedState=[s,e],s)}function bR(s,e){var t=ra();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&TE(e,i[1])?i[0]:(s=s(),t.memoizedState=[s,e],s)}function CR(s,e,t){return tu&21?(ka(t,e)||(t=wO(),pr.lanes|=t,iu|=t,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,os=!0),s.memoizedState=t)}function Y4(s,e){var t=Ai;Ai=t!==0&&4>t?t:4,s(!0);var i=iC.transition;iC.transition={};try{s(!1),e()}finally{Ai=t,iC.transition=i}}function SR(){return ra().memoizedState}function Q4(s,e,t){var i=Hl(s);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},xR(s))wR(e,t);else if(t=JO(s,e,t,i),t!==null){var r=Gn();Ea(t,s,i,r),MR(t,e,i)}}function G4(s,e,t){var i=Hl(s),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(xR(s))wR(e,r);else{var n=s.alternate;if(s.lanes===0&&(n===null||n.lanes===0)&&(n=e.lastRenderedReducer,n!==null))try{var a=e.lastRenderedState,o=n(a,t);if(r.hasEagerState=!0,r.eagerState=o,ka(o,a)){var l=e.interleaved;l===null?(r.next=r,xE(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=JO(s,e,r,i),t!==null&&(r=Gn(),Ea(t,s,i,r),MR(t,e,i))}}function xR(s){var e=s.alternate;return s===pr||e!==null&&e===pr}function wR(s,e){Hp=Gg=!0;var t=s.pending;t===null?e.next=e:(e.next=t.next,t.next=e),s.pending=e}function MR(s,e,t){if(t&4194240){var i=e.lanes;i&=s.pendingLanes,t|=i,e.lanes=t,lE(s,t)}}var $g={readContext:ia,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},$4={readContext:ia,useCallback:function(s,e){return _a().memoizedState=[s,e===void 0?null:e],s},useContext:ia,useEffect:_T,useImperativeHandle:function(s,e,t){return t=t!=null?t.concat([s]):null,mg(4194308,4,mR.bind(null,e,s),t)},useLayoutEffect:function(s,e){return mg(4194308,4,s,e)},useInsertionEffect:function(s,e){return mg(4,2,s,e)},useMemo:function(s,e){var t=_a();return e=e===void 0?null:e,s=s(),t.memoizedState=[s,e],s},useReducer:function(s,e,t){var i=_a();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},i.queue=s,s=s.dispatch=Q4.bind(null,pr,s),[i.memoizedState,s]},useRef:function(s){var e=_a();return s={current:s},e.memoizedState=s},useState:UT,useDebugValue:kE,useDeferredValue:function(s){return _a().memoizedState=s},useTransition:function(){var s=UT(!1),e=s[0];return s=Y4.bind(null,s[1]),_a().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,t){var i=pr,r=_a();if(Ji){if(t===void 0)throw Error(We(407));t=t()}else{if(t=e(),sn===null)throw Error(We(349));tu&30||lR(i,e,t)}r.memoizedState=t;var n={value:t,getSnapshot:e};return r.queue=n,_T(uR.bind(null,i,n,s),[s]),i.flags|=2048,Cf(9,hR.bind(null,i,n,t,e),void 0,null),t},useId:function(){var s=_a(),e=sn.identifierPrefix;if(Ji){var t=Fo,i=Ro;t=(i&~(1<<32-Ma(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=yf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=q4++,e=":"+e+"r"+t.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},X4={readContext:ia,useCallback:yR,useContext:ia,useEffect:NE,useImperativeHandle:gR,useInsertionEffect:fR,useLayoutEffect:vR,useMemo:bR,useReducer:rC,useRef:pR,useState:function(){return rC(bf)},useDebugValue:kE,useDeferredValue:function(s){var e=ra();return CR(e,Hr.memoizedState,s)},useTransition:function(){var s=rC(bf)[0],e=ra().memoizedState;return[s,e]},useMutableSource:aR,useSyncExternalStore:oR,useId:SR,unstable_isNewReconciler:!1},K4={readContext:ia,useCallback:yR,useContext:ia,useEffect:NE,useImperativeHandle:gR,useInsertionEffect:fR,useLayoutEffect:vR,useMemo:bR,useReducer:nC,useRef:pR,useState:function(){return nC(bf)},useDebugValue:kE,useDeferredValue:function(s){var e=ra();return Hr===null?e.memoizedState=s:CR(e,Hr.memoizedState,s)},useTransition:function(){var s=nC(bf)[0],e=ra().memoizedState;return[s,e]},useMutableSource:aR,useSyncExternalStore:oR,useId:SR,unstable_isNewReconciler:!1};function td(s,e){try{var t="",i=e;do t+=Ej(i),i=i.return;while(i);var r=t}catch(n){r=`
Error generating stack: `+n.message+`
`+n.stack}return{value:s,source:e,stack:r,digest:null}}function sC(s,e,t){return{value:s,source:null,stack:t??null,digest:e??null}}function uw(s,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Z4=typeof WeakMap=="function"?WeakMap:Map;function ER(s,e,t){t=jo(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Kg||(Kg=!0,Cw=i),uw(s,e)},t}function IR(s,e,t){t=jo(-1,t),t.tag=3;var i=s.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){uw(s,e)}}var n=s.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(t.callback=function(){uw(s,e),typeof i!="function"&&(Bl===null?Bl=new Set([this]):Bl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function WT(s,e,t){var i=s.pingCache;if(i===null){i=s.pingCache=new Z4;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),s=d3.bind(null,s,e,t),e.then(s,s))}function qT(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function YT(s,e,t,i,r){return s.mode&1?(s.flags|=65536,s.lanes=r,s):(s===e?s.flags|=65536:(s.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=jo(-1,1),e.tag=2,jl(t,e,1))),t.lanes|=1),s)}var J4=Go.ReactCurrentOwner,os=!1;function _n(s,e,t,i){e.child=s===null?nR(e,null,t,i):Jc(e,s.child,t,i)}function QT(s,e,t,i,r){t=t.render;var n=e.ref;return Fc(e,r),i=DE(s,e,t,i,n,r),t=AE(),s!==null&&!os?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~r,qo(s,e,r)):(Ji&&t&&mE(e),e.flags|=1,_n(s,e,i,r),e.child)}function GT(s,e,t,i,r){if(s===null){var n=t.type;return typeof n=="function"&&!BE(n)&&n.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=n,TR(s,e,n,i,r)):(s=Cg(t.type,null,i,e,e.mode,r),s.ref=e.ref,s.return=e,e.child=s)}if(n=s.child,!(s.lanes&r)){var a=n.memoizedProps;if(t=t.compare,t=t!==null?t:df,t(a,i)&&s.ref===e.ref)return qo(s,e,r)}return e.flags|=1,s=Vl(n,i),s.ref=e.ref,s.return=e,e.child=s}function TR(s,e,t,i,r){if(s!==null){var n=s.memoizedProps;if(df(n,i)&&s.ref===e.ref)if(os=!1,e.pendingProps=i=n,(s.lanes&r)!==0)s.flags&131072&&(os=!0);else return e.lanes=s.lanes,qo(s,e,r)}return cw(s,e,t,i,r)}function DR(s,e,t){var i=e.pendingProps,r=i.children,n=s!==null?s.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hi(Cc,Ss),Ss|=t;else{if(!(t&1073741824))return s=n!==null?n.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,Hi(Cc,Ss),Ss|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=n!==null?n.baseLanes:t,Hi(Cc,Ss),Ss|=i}else n!==null?(i=n.baseLanes|t,e.memoizedState=null):i=t,Hi(Cc,Ss),Ss|=i;return _n(s,e,r,t),e.child}function AR(s,e){var t=e.ref;(s===null&&t!==null||s!==null&&s.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function cw(s,e,t,i,r){var n=hs(t)?Jh:zn.current;return n=Kc(e,n),Fc(e,r),t=DE(s,e,t,i,n,r),i=AE(),s!==null&&!os?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~r,qo(s,e,r)):(Ji&&i&&mE(e),e.flags|=1,_n(s,e,t,r),e.child)}function $T(s,e,t,i,r){if(hs(t)){var n=!0;Vg(e)}else n=!1;if(Fc(e,r),e.stateNode===null)gg(s,e),iR(e,t,i),hw(e,t,i,r),i=!0;else if(s===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,h=t.contextType;typeof h=="object"&&h!==null?h=ia(h):(h=hs(t)?Jh:zn.current,h=Kc(e,h));var u=t.getDerivedStateFromProps,c=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";c||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==h)&&HT(e,a,i,h),ml=!1;var d=e.memoizedState;a.state=d,Yg(e,i,a,r),l=e.memoizedState,o!==i||d!==l||ls.current||ml?(typeof u=="function"&&(lw(e,t,u,i),l=e.memoizedState),(o=ml||BT(e,t,o,i,d,l,h))?(c||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=h,i=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,eR(s,e),o=e.memoizedProps,h=e.type===e.elementType?o:va(e.type,o),a.props=h,c=e.pendingProps,d=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=ia(l):(l=hs(t)?Jh:zn.current,l=Kc(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==c||d!==l)&&HT(e,a,i,l),ml=!1,d=e.memoizedState,a.state=d,Yg(e,i,a,r);var f=e.memoizedState;o!==c||d!==f||ls.current||ml?(typeof p=="function"&&(lw(e,t,p,i),f=e.memoizedState),(h=ml||BT(e,t,h,i,d,f,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,f,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===s.memoizedProps&&d===s.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===s.memoizedProps&&d===s.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),a.props=i,a.state=f,a.context=l,i=h):(typeof a.componentDidUpdate!="function"||o===s.memoizedProps&&d===s.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===s.memoizedProps&&d===s.memoizedState||(e.flags|=1024),i=!1)}return dw(s,e,t,i,n,r)}function dw(s,e,t,i,r,n){AR(s,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&RT(e,t,!1),qo(s,e,n);i=e.stateNode,J4.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,s!==null&&a?(e.child=Jc(e,s.child,null,n),e.child=Jc(e,null,o,n)):_n(s,e,o,n),e.memoizedState=i.state,r&&RT(e,t,!0),e.child}function NR(s){var e=s.stateNode;e.pendingContext?OT(s,e.pendingContext,e.pendingContext!==e.context):e.context&&OT(s,e.context,!1),ME(s,e.containerInfo)}function XT(s,e,t,i,r){return Zc(),yE(r),e.flags|=256,_n(s,e,t,i),e.child}var pw={dehydrated:null,treeContext:null,retryLane:0};function fw(s){return{baseLanes:s,cachePool:null,transitions:null}}function kR(s,e,t){var i=e.pendingProps,r=lr.current,n=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=s!==null&&s.memoizedState===null?!1:(r&2)!==0),o?(n=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(r|=1),Hi(lr,r&1),s===null)return aw(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,s=i.fallback,n?(i=e.mode,n=e.child,a={mode:"hidden",children:a},!(i&1)&&n!==null?(n.childLanes=0,n.pendingProps=a):n=J0(a,i,0,null),s=Hh(s,i,t,null),n.return=e,s.return=e,n.sibling=s,e.child=n,e.child.memoizedState=fw(t),e.memoizedState=pw,s):LE(e,a));if(r=s.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return e3(s,e,a,i,o,r,t);if(n){n=i.fallback,a=e.mode,r=s.child,o=r.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Vl(r,l),i.subtreeFlags=r.subtreeFlags&14680064),o!==null?n=Vl(o,n):(n=Hh(n,a,t,null),n.flags|=2),n.return=e,i.return=e,i.sibling=n,e.child=i,i=n,n=e.child,a=s.child.memoizedState,a=a===null?fw(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},n.memoizedState=a,n.childLanes=s.childLanes&~t,e.memoizedState=pw,i}return n=s.child,s=n.sibling,i=Vl(n,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,s!==null&&(t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)),e.child=i,e.memoizedState=null,i}function LE(s,e){return e=J0({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function qv(s,e,t,i){return i!==null&&yE(i),Jc(e,s.child,null,t),s=LE(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function e3(s,e,t,i,r,n,a){if(t)return e.flags&256?(e.flags&=-257,i=sC(Error(We(422))),qv(s,e,a,i)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(n=i.fallback,r=e.mode,i=J0({mode:"visible",children:i.children},r,0,null),n=Hh(n,r,a,null),n.flags|=2,i.return=e,n.return=e,i.sibling=n,e.child=i,e.mode&1&&Jc(e,s.child,null,a),e.child.memoizedState=fw(a),e.memoizedState=pw,n);if(!(e.mode&1))return qv(s,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var o=i.dgst;return i=o,n=Error(We(419)),i=sC(n,i,void 0),qv(s,e,a,i)}if(o=(a&s.childLanes)!==0,os||o){if(i=sn,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==n.retryLane&&(n.retryLane=r,Wo(s,r),Ea(i,s,r,-1))}return jE(),i=sC(Error(We(421))),qv(s,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=s.child,e=p3.bind(null,s),r._reactRetry=e,null):(s=n.treeContext,Is=zl(r.nextSibling),Ds=e,Ji=!0,ya=null,s!==null&&(Ws[qs++]=Ro,Ws[qs++]=Fo,Ws[qs++]=eu,Ro=s.id,Fo=s.overflow,eu=e),e=LE(e,i.children),e.flags|=4096,e)}function KT(s,e,t){s.lanes|=e;var i=s.alternate;i!==null&&(i.lanes|=e),ow(s.return,e,t)}function aC(s,e,t,i,r){var n=s.memoizedState;n===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(n.isBackwards=e,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=t,n.tailMode=r)}function LR(s,e,t){var i=e.pendingProps,r=i.revealOrder,n=i.tail;if(_n(s,e,i.children,t),i=lr.current,i&2)i=i&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&KT(s,t,e);else if(s.tag===19)KT(s,t,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}i&=1}if(Hi(lr,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)s=t.alternate,s!==null&&Qg(s)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),aC(e,!1,r,t,n);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(s=r.alternate,s!==null&&Qg(s)===null){e.child=r;break}s=r.sibling,r.sibling=t,t=r,r=s}aC(e,!0,t,null,n);break;case"together":aC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gg(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function qo(s,e,t){if(s!==null&&(e.dependencies=s.dependencies),iu|=e.lanes,!(t&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(We(153));if(e.child!==null){for(s=e.child,t=Vl(s,s.pendingProps),e.child=t,t.return=e;s.sibling!==null;)s=s.sibling,t=t.sibling=Vl(s,s.pendingProps),t.return=e;t.sibling=null}return e.child}function t3(s,e,t){switch(e.tag){case 3:NR(e),Zc();break;case 5:sR(e);break;case 1:hs(e.type)&&Vg(e);break;case 4:ME(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Hi(Wg,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Hi(lr,lr.current&1),e.flags|=128,null):t&e.child.childLanes?kR(s,e,t):(Hi(lr,lr.current&1),s=qo(s,e,t),s!==null?s.sibling:null);Hi(lr,lr.current&1);break;case 19:if(i=(t&e.childLanes)!==0,s.flags&128){if(i)return LR(s,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Hi(lr,lr.current),i)break;return null;case 22:case 23:return e.lanes=0,DR(s,e,t)}return qo(s,e,t)}var OR,vw,RR,FR;OR=function(s,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)s.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};vw=function(){};RR=function(s,e,t,i){var r=s.memoizedProps;if(r!==i){s=e.stateNode,Fh(ro.current);var n=null;switch(t){case"input":r=zx(s,r),i=zx(s,i),n=[];break;case"select":r=fr({},r,{value:void 0}),i=fr({},i,{value:void 0}),n=[];break;case"textarea":r=Hx(s,r),i=Hx(s,i),n=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(s.onclick=Bg)}Ux(t,i);var a;t=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var o=r[h];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(sf.hasOwnProperty(h)?n||(n=[]):(n=n||[]).push(h,null));for(h in i){var l=i[h];if(o=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&l!==o&&(l!=null||o!=null))if(h==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(n||(n=[]),n.push(h,t)),t=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(n=n||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(n=n||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(sf.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&_i("scroll",s),n||o===l||(n=[])):(n=n||[]).push(h,l))}t&&(n=n||[]).push("style",t);var h=n;(e.updateQueue=h)&&(e.flags|=4)}};FR=function(s,e,t,i){t!==i&&(e.flags|=4)};function Yd(s,e){if(!Ji)switch(s.tailMode){case"hidden":e=s.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?s.tail=null:t.sibling=null;break;case"collapsed":t=s.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:i.sibling=null}}function Nn(s){var e=s.alternate!==null&&s.alternate.child===s.child,t=0,i=0;if(e)for(var r=s.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=s,r=r.sibling;else for(r=s.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=s,r=r.sibling;return s.subtreeFlags|=i,s.childLanes=t,e}function i3(s,e,t){var i=e.pendingProps;switch(gE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(e),null;case 1:return hs(e.type)&&Hg(),Nn(e),null;case 3:return i=e.stateNode,ed(),Yi(ls),Yi(zn),IE(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(s===null||s.child===null)&&(_v(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ya!==null&&(ww(ya),ya=null))),vw(s,e),Nn(e),null;case 5:EE(e);var r=Fh(gf.current);if(t=e.type,s!==null&&e.stateNode!=null)RR(s,e,t,i,r),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(We(166));return Nn(e),null}if(s=Fh(ro.current),_v(e)){i=e.stateNode,t=e.type;var n=e.memoizedProps;switch(i[Ya]=e,i[vf]=n,s=(e.mode&1)!==0,t){case"dialog":_i("cancel",i),_i("close",i);break;case"iframe":case"object":case"embed":_i("load",i);break;case"video":case"audio":for(r=0;r<Np.length;r++)_i(Np[r],i);break;case"source":_i("error",i);break;case"img":case"image":case"link":_i("error",i),_i("load",i);break;case"details":_i("toggle",i);break;case"input":aT(i,n),_i("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},_i("invalid",i);break;case"textarea":lT(i,n),_i("invalid",i)}Ux(t,n),r=null;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a];a==="children"?typeof o=="string"?i.textContent!==o&&(n.suppressHydrationWarning!==!0&&Uv(i.textContent,o,s),r=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(n.suppressHydrationWarning!==!0&&Uv(i.textContent,o,s),r=["children",""+o]):sf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&_i("scroll",i)}switch(t){case"input":Rv(i),oT(i,n,!0);break;case"textarea":Rv(i),hT(i);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(i.onclick=Bg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=lO(t)),s==="http://www.w3.org/1999/xhtml"?t==="script"?(s=a.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof i.is=="string"?s=a.createElement(t,{is:i.is}):(s=a.createElement(t),t==="select"&&(a=s,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):s=a.createElementNS(s,t),s[Ya]=e,s[vf]=i,OR(s,e,!1,!1),e.stateNode=s;e:{switch(a=_x(t,i),t){case"dialog":_i("cancel",s),_i("close",s),r=i;break;case"iframe":case"object":case"embed":_i("load",s),r=i;break;case"video":case"audio":for(r=0;r<Np.length;r++)_i(Np[r],s);r=i;break;case"source":_i("error",s),r=i;break;case"img":case"image":case"link":_i("error",s),_i("load",s),r=i;break;case"details":_i("toggle",s),r=i;break;case"input":aT(s,i),r=zx(s,i),_i("invalid",s);break;case"option":r=i;break;case"select":s._wrapperState={wasMultiple:!!i.multiple},r=fr({},i,{value:void 0}),_i("invalid",s);break;case"textarea":lT(s,i),r=Hx(s,i),_i("invalid",s);break;default:r=i}Ux(t,r),o=r;for(n in o)if(o.hasOwnProperty(n)){var l=o[n];n==="style"?cO(s,l):n==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hO(s,l)):n==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&af(s,l):typeof l=="number"&&af(s,""+l):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(sf.hasOwnProperty(n)?l!=null&&n==="onScroll"&&_i("scroll",s):l!=null&&iE(s,n,l,a))}switch(t){case"input":Rv(s),oT(s,i,!1);break;case"textarea":Rv(s),hT(s);break;case"option":i.value!=null&&s.setAttribute("value",""+$l(i.value));break;case"select":s.multiple=!!i.multiple,n=i.value,n!=null?kc(s,!!i.multiple,n,!1):i.defaultValue!=null&&kc(s,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(s.onclick=Bg)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nn(e),null;case 6:if(s&&e.stateNode!=null)FR(s,e,s.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(We(166));if(t=Fh(gf.current),Fh(ro.current),_v(e)){if(i=e.stateNode,t=e.memoizedProps,i[Ya]=e,(n=i.nodeValue!==t)&&(s=Ds,s!==null))switch(s.tag){case 3:Uv(i.nodeValue,t,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Uv(i.nodeValue,t,(s.mode&1)!==0)}n&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Ya]=e,e.stateNode=i}return Nn(e),null;case 13:if(Yi(lr),i=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ji&&Is!==null&&e.mode&1&&!(e.flags&128))ZO(),Zc(),e.flags|=98560,n=!1;else if(n=_v(e),i!==null&&i.dehydrated!==null){if(s===null){if(!n)throw Error(We(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(We(317));n[Ya]=e}else Zc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nn(e),n=!1}else ya!==null&&(ww(ya),ya=null),n=!0;if(!n)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(s!==null&&s.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(s===null||lr.current&1?Wr===0&&(Wr=3):jE())),e.updateQueue!==null&&(e.flags|=4),Nn(e),null);case 4:return ed(),vw(s,e),s===null&&pf(e.stateNode.containerInfo),Nn(e),null;case 10:return SE(e.type._context),Nn(e),null;case 17:return hs(e.type)&&Hg(),Nn(e),null;case 19:if(Yi(lr),n=e.memoizedState,n===null)return Nn(e),null;if(i=(e.flags&128)!==0,a=n.rendering,a===null)if(i)Yd(n,!1);else{if(Wr!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(a=Qg(s),a!==null){for(e.flags|=128,Yd(n,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)n=t,s=i,n.flags&=14680066,a=n.alternate,a===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=a.childLanes,n.lanes=a.lanes,n.child=a.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=a.memoizedProps,n.memoizedState=a.memoizedState,n.updateQueue=a.updateQueue,n.type=a.type,s=a.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t=t.sibling;return Hi(lr,lr.current&1|2),e.child}s=s.sibling}n.tail!==null&&xr()>id&&(e.flags|=128,i=!0,Yd(n,!1),e.lanes=4194304)}else{if(!i)if(s=Qg(a),s!==null){if(e.flags|=128,i=!0,t=s.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Yd(n,!0),n.tail===null&&n.tailMode==="hidden"&&!a.alternate&&!Ji)return Nn(e),null}else 2*xr()-n.renderingStartTime>id&&t!==1073741824&&(e.flags|=128,i=!0,Yd(n,!1),e.lanes=4194304);n.isBackwards?(a.sibling=e.child,e.child=a):(t=n.last,t!==null?t.sibling=a:e.child=a,n.last=a)}return n.tail!==null?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=xr(),e.sibling=null,t=lr.current,Hi(lr,i?t&1|2:t&1),e):(Nn(e),null);case 22:case 23:return zE(),i=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ss&1073741824&&(Nn(e),e.subtreeFlags&6&&(e.flags|=8192)):Nn(e),null;case 24:return null;case 25:return null}throw Error(We(156,e.tag))}function r3(s,e){switch(gE(e),e.tag){case 1:return hs(e.type)&&Hg(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return ed(),Yi(ls),Yi(zn),IE(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return EE(e),null;case 13:if(Yi(lr),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(We(340));Zc()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return Yi(lr),null;case 4:return ed(),null;case 10:return SE(e.type._context),null;case 22:case 23:return zE(),null;case 24:return null;default:return null}}var Yv=!1,On=!1,n3=typeof WeakSet=="function"?WeakSet:Set,nt=null;function bc(s,e){var t=s.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){gr(s,e,i)}else t.current=null}function mw(s,e,t){try{t()}catch(i){gr(s,e,i)}}var ZT=!1;function s3(s,e){if(Jx=Pg,s=BO(),vE(s)){if("selectionStart"in s)var t={start:s.selectionStart,end:s.selectionEnd};else e:{t=(t=s.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{t.nodeType,n.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,h=0,u=0,c=s,d=null;t:for(;;){for(var p;c!==t||r!==0&&c.nodeType!==3||(o=a+r),c!==n||i!==0&&c.nodeType!==3||(l=a+i),c.nodeType===3&&(a+=c.nodeValue.length),(p=c.firstChild)!==null;)d=c,c=p;for(;;){if(c===s)break t;if(d===t&&++h===r&&(o=a),d===n&&++u===i&&(l=a),(p=c.nextSibling)!==null)break;c=d,d=c.parentNode}c=p}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(ew={focusedElem:s,selectionRange:t},Pg=!1,nt=e;nt!==null;)if(e=nt,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,nt=s;else for(;nt!==null;){e=nt;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var v=f.memoizedProps,g=f.memoizedState,b=e.stateNode,y=b.getSnapshotBeforeUpdate(e.elementType===e.type?v:va(e.type,v),g);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(We(163))}}catch(x){gr(e,e.return,x)}if(s=e.sibling,s!==null){s.return=e.return,nt=s;break}nt=e.return}return f=ZT,ZT=!1,f}function Vp(s,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&s)===s){var n=r.destroy;r.destroy=void 0,n!==void 0&&mw(e,t,n)}r=r.next}while(r!==i)}}function K0(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&s)===s){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function gw(s){var e=s.ref;if(e!==null){var t=s.stateNode;switch(s.tag){case 5:s=t;break;default:s=t}typeof e=="function"?e(s):e.current=s}}function PR(s){var e=s.alternate;e!==null&&(s.alternate=null,PR(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Ya],delete e[vf],delete e[rw],delete e[V4],delete e[U4])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function zR(s){return s.tag===5||s.tag===3||s.tag===4}function JT(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||zR(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yw(s,e,t){var i=s.tag;if(i===5||i===6)s=s.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(s,e):t.insertBefore(s,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(s,t)):(e=t,e.appendChild(s)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Bg));else if(i!==4&&(s=s.child,s!==null))for(yw(s,e,t),s=s.sibling;s!==null;)yw(s,e,t),s=s.sibling}function bw(s,e,t){var i=s.tag;if(i===5||i===6)s=s.stateNode,e?t.insertBefore(s,e):t.appendChild(s);else if(i!==4&&(s=s.child,s!==null))for(bw(s,e,t),s=s.sibling;s!==null;)bw(s,e,t),s=s.sibling}var vn=null,ma=!1;function tl(s,e,t){for(t=t.child;t!==null;)jR(s,e,t),t=t.sibling}function jR(s,e,t){if(io&&typeof io.onCommitFiberUnmount=="function")try{io.onCommitFiberUnmount(_0,t)}catch{}switch(t.tag){case 5:On||bc(t,e);case 6:var i=vn,r=ma;vn=null,tl(s,e,t),vn=i,ma=r,vn!==null&&(ma?(s=vn,t=t.stateNode,s.nodeType===8?s.parentNode.removeChild(t):s.removeChild(t)):vn.removeChild(t.stateNode));break;case 18:vn!==null&&(ma?(s=vn,t=t.stateNode,s.nodeType===8?Jb(s.parentNode,t):s.nodeType===1&&Jb(s,t),uf(s)):Jb(vn,t.stateNode));break;case 4:i=vn,r=ma,vn=t.stateNode.containerInfo,ma=!0,tl(s,e,t),vn=i,ma=r;break;case 0:case 11:case 14:case 15:if(!On&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var n=r,a=n.destroy;n=n.tag,a!==void 0&&(n&2||n&4)&&mw(t,e,a),r=r.next}while(r!==i)}tl(s,e,t);break;case 1:if(!On&&(bc(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(o){gr(t,e,o)}tl(s,e,t);break;case 21:tl(s,e,t);break;case 22:t.mode&1?(On=(i=On)||t.memoizedState!==null,tl(s,e,t),On=i):tl(s,e,t);break;default:tl(s,e,t)}}function eD(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var t=s.stateNode;t===null&&(t=s.stateNode=new n3),e.forEach(function(i){var r=f3.bind(null,s,i);t.has(i)||(t.add(i),i.then(r,r))})}}function oa(s,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var n=s,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:vn=o.stateNode,ma=!1;break e;case 3:vn=o.stateNode.containerInfo,ma=!0;break e;case 4:vn=o.stateNode.containerInfo,ma=!0;break e}o=o.return}if(vn===null)throw Error(We(160));jR(n,a,r),vn=null,ma=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(h){gr(r,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BR(e,s),e=e.sibling}function BR(s,e){var t=s.alternate,i=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(oa(e,s),ja(s),i&4){try{Vp(3,s,s.return),K0(3,s)}catch(v){gr(s,s.return,v)}try{Vp(5,s,s.return)}catch(v){gr(s,s.return,v)}}break;case 1:oa(e,s),ja(s),i&512&&t!==null&&bc(t,t.return);break;case 5:if(oa(e,s),ja(s),i&512&&t!==null&&bc(t,t.return),s.flags&32){var r=s.stateNode;try{af(r,"")}catch(v){gr(s,s.return,v)}}if(i&4&&(r=s.stateNode,r!=null)){var n=s.memoizedProps,a=t!==null?t.memoizedProps:n,o=s.type,l=s.updateQueue;if(s.updateQueue=null,l!==null)try{o==="input"&&n.type==="radio"&&n.name!=null&&aO(r,n),_x(o,a);var h=_x(o,n);for(a=0;a<l.length;a+=2){var u=l[a],c=l[a+1];u==="style"?cO(r,c):u==="dangerouslySetInnerHTML"?hO(r,c):u==="children"?af(r,c):iE(r,u,c,h)}switch(o){case"input":jx(r,n);break;case"textarea":oO(r,n);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!n.multiple;var p=n.value;p!=null?kc(r,!!n.multiple,p,!1):d!==!!n.multiple&&(n.defaultValue!=null?kc(r,!!n.multiple,n.defaultValue,!0):kc(r,!!n.multiple,n.multiple?[]:"",!1))}r[vf]=n}catch(v){gr(s,s.return,v)}}break;case 6:if(oa(e,s),ja(s),i&4){if(s.stateNode===null)throw Error(We(162));r=s.stateNode,n=s.memoizedProps;try{r.nodeValue=n}catch(v){gr(s,s.return,v)}}break;case 3:if(oa(e,s),ja(s),i&4&&t!==null&&t.memoizedState.isDehydrated)try{uf(e.containerInfo)}catch(v){gr(s,s.return,v)}break;case 4:oa(e,s),ja(s);break;case 13:oa(e,s),ja(s),r=s.child,r.flags&8192&&(n=r.memoizedState!==null,r.stateNode.isHidden=n,!n||r.alternate!==null&&r.alternate.memoizedState!==null||(FE=xr())),i&4&&eD(s);break;case 22:if(u=t!==null&&t.memoizedState!==null,s.mode&1?(On=(h=On)||u,oa(e,s),On=h):oa(e,s),ja(s),i&8192){if(h=s.memoizedState!==null,(s.stateNode.isHidden=h)&&!u&&s.mode&1)for(nt=s,u=s.child;u!==null;){for(c=nt=u;nt!==null;){switch(d=nt,p=d.child,d.tag){case 0:case 11:case 14:case 15:Vp(4,d,d.return);break;case 1:bc(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,t=d.return;try{e=i,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(v){gr(i,t,v)}}break;case 5:bc(d,d.return);break;case 22:if(d.memoizedState!==null){iD(c);continue}}p!==null?(p.return=d,nt=p):iD(c)}u=u.sibling}e:for(u=null,c=s;;){if(c.tag===5){if(u===null){u=c;try{r=c.stateNode,h?(n=r.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(o=c.stateNode,l=c.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=uO("display",a))}catch(v){gr(s,s.return,v)}}}else if(c.tag===6){if(u===null)try{c.stateNode.nodeValue=h?"":c.memoizedProps}catch(v){gr(s,s.return,v)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;u===c&&(u=null),c=c.return}u===c&&(u=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:oa(e,s),ja(s),i&4&&eD(s);break;case 21:break;default:oa(e,s),ja(s)}}function ja(s){var e=s.flags;if(e&2){try{e:{for(var t=s.return;t!==null;){if(zR(t)){var i=t;break e}t=t.return}throw Error(We(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(af(r,""),i.flags&=-33);var n=JT(s);bw(s,n,r);break;case 3:case 4:var a=i.stateNode.containerInfo,o=JT(s);yw(s,o,a);break;default:throw Error(We(161))}}catch(l){gr(s,s.return,l)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function a3(s,e,t){nt=s,HR(s)}function HR(s,e,t){for(var i=(s.mode&1)!==0;nt!==null;){var r=nt,n=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||Yv;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||On;o=Yv;var h=On;if(Yv=a,(On=l)&&!h)for(nt=r;nt!==null;)a=nt,l=a.child,a.tag===22&&a.memoizedState!==null?rD(r):l!==null?(l.return=a,nt=l):rD(r);for(;n!==null;)nt=n,HR(n),n=n.sibling;nt=r,Yv=o,On=h}tD(s)}else r.subtreeFlags&8772&&n!==null?(n.return=r,nt=n):tD(s)}}function tD(s){for(;nt!==null;){var e=nt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:On||K0(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!On)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:va(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=e.updateQueue;n!==null&&jT(e,n,i);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}jT(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var c=u.dehydrated;c!==null&&uf(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(We(163))}On||e.flags&512&&gw(e)}catch(d){gr(e,e.return,d)}}if(e===s){nt=null;break}if(t=e.sibling,t!==null){t.return=e.return,nt=t;break}nt=e.return}}function iD(s){for(;nt!==null;){var e=nt;if(e===s){nt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,nt=t;break}nt=e.return}}function rD(s){for(;nt!==null;){var e=nt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{K0(4,e)}catch(l){gr(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){gr(e,r,l)}}var n=e.return;try{gw(e)}catch(l){gr(e,n,l)}break;case 5:var a=e.return;try{gw(e)}catch(l){gr(e,a,l)}}}catch(l){gr(e,e.return,l)}if(e===s){nt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,nt=o;break}nt=e.return}}var o3=Math.ceil,Xg=Go.ReactCurrentDispatcher,OE=Go.ReactCurrentOwner,Ks=Go.ReactCurrentBatchConfig,fi=0,sn=null,Rr=null,xn=0,Ss=0,Cc=fh(0),Wr=0,Sf=null,iu=0,Z0=0,RE=0,Up=null,as=null,FE=0,id=1/0,Ao=null,Kg=!1,Cw=null,Bl=null,Qv=!1,Il=null,Zg=0,_p=0,Sw=null,yg=-1,bg=0;function Gn(){return fi&6?xr():yg!==-1?yg:yg=xr()}function Hl(s){return s.mode&1?fi&2&&xn!==0?xn&-xn:W4.transition!==null?(bg===0&&(bg=wO()),bg):(s=Ai,s!==0||(s=window.event,s=s===void 0?16:NO(s.type)),s):1}function Ea(s,e,t,i){if(50<_p)throw _p=0,Sw=null,Error(We(185));fv(s,t,i),(!(fi&2)||s!==sn)&&(s===sn&&(!(fi&2)&&(Z0|=t),Wr===4&&Sl(s,xn)),us(s,i),t===1&&fi===0&&!(e.mode&1)&&(id=xr()+500,G0&&vh()))}function us(s,e){var t=s.callbackNode;Wj(s,e);var i=Fg(s,s===sn?xn:0);if(i===0)t!==null&&dT(t),s.callbackNode=null,s.callbackPriority=0;else if(e=i&-i,s.callbackPriority!==e){if(t!=null&&dT(t),e===1)s.tag===0?_4(nD.bind(null,s)):$O(nD.bind(null,s)),B4(function(){!(fi&6)&&vh()}),t=null;else{switch(MO(i)){case 1:t=oE;break;case 4:t=SO;break;case 16:t=Rg;break;case 536870912:t=xO;break;default:t=Rg}t=GR(t,VR.bind(null,s))}s.callbackPriority=e,s.callbackNode=t}}function VR(s,e){if(yg=-1,bg=0,fi&6)throw Error(We(327));var t=s.callbackNode;if(Pc()&&s.callbackNode!==t)return null;var i=Fg(s,s===sn?xn:0);if(i===0)return null;if(i&30||i&s.expiredLanes||e)e=Jg(s,i);else{e=i;var r=fi;fi|=2;var n=_R();(sn!==s||xn!==e)&&(Ao=null,id=xr()+500,Bh(s,e));do try{u3();break}catch(o){UR(s,o)}while(!0);CE(),Xg.current=n,fi=r,Rr!==null?e=0:(sn=null,xn=0,e=Wr)}if(e!==0){if(e===2&&(r=Gx(s),r!==0&&(i=r,e=xw(s,r))),e===1)throw t=Sf,Bh(s,0),Sl(s,i),us(s,xr()),t;if(e===6)Sl(s,i);else{if(r=s.current.alternate,!(i&30)&&!l3(r)&&(e=Jg(s,i),e===2&&(n=Gx(s),n!==0&&(i=n,e=xw(s,n))),e===1))throw t=Sf,Bh(s,0),Sl(s,i),us(s,xr()),t;switch(s.finishedWork=r,s.finishedLanes=i,e){case 0:case 1:throw Error(We(345));case 2:Ih(s,as,Ao);break;case 3:if(Sl(s,i),(i&130023424)===i&&(e=FE+500-xr(),10<e)){if(Fg(s,0)!==0)break;if(r=s.suspendedLanes,(r&i)!==i){Gn(),s.pingedLanes|=s.suspendedLanes&r;break}s.timeoutHandle=iw(Ih.bind(null,s,as,Ao),e);break}Ih(s,as,Ao);break;case 4:if(Sl(s,i),(i&4194240)===i)break;for(e=s.eventTimes,r=-1;0<i;){var a=31-Ma(i);n=1<<a,a=e[a],a>r&&(r=a),i&=~n}if(i=r,i=xr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*o3(i/1960))-i,10<i){s.timeoutHandle=iw(Ih.bind(null,s,as,Ao),i);break}Ih(s,as,Ao);break;case 5:Ih(s,as,Ao);break;default:throw Error(We(329))}}}return us(s,xr()),s.callbackNode===t?VR.bind(null,s):null}function xw(s,e){var t=Up;return s.current.memoizedState.isDehydrated&&(Bh(s,e).flags|=256),s=Jg(s,e),s!==2&&(e=as,as=t,e!==null&&ww(e)),s}function ww(s){as===null?as=s:as.push.apply(as,s)}function l3(s){for(var e=s;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],n=r.getSnapshot;r=r.value;try{if(!ka(n(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sl(s,e){for(e&=~RE,e&=~Z0,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var t=31-Ma(e),i=1<<t;s[t]=-1,e&=~i}}function nD(s){if(fi&6)throw Error(We(327));Pc();var e=Fg(s,0);if(!(e&1))return us(s,xr()),null;var t=Jg(s,e);if(s.tag!==0&&t===2){var i=Gx(s);i!==0&&(e=i,t=xw(s,i))}if(t===1)throw t=Sf,Bh(s,0),Sl(s,e),us(s,xr()),t;if(t===6)throw Error(We(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Ih(s,as,Ao),us(s,xr()),null}function PE(s,e){var t=fi;fi|=1;try{return s(e)}finally{fi=t,fi===0&&(id=xr()+500,G0&&vh())}}function ru(s){Il!==null&&Il.tag===0&&!(fi&6)&&Pc();var e=fi;fi|=1;var t=Ks.transition,i=Ai;try{if(Ks.transition=null,Ai=1,s)return s()}finally{Ai=i,Ks.transition=t,fi=e,!(fi&6)&&vh()}}function zE(){Ss=Cc.current,Yi(Cc)}function Bh(s,e){s.finishedWork=null,s.finishedLanes=0;var t=s.timeoutHandle;if(t!==-1&&(s.timeoutHandle=-1,j4(t)),Rr!==null)for(t=Rr.return;t!==null;){var i=t;switch(gE(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Hg();break;case 3:ed(),Yi(ls),Yi(zn),IE();break;case 5:EE(i);break;case 4:ed();break;case 13:Yi(lr);break;case 19:Yi(lr);break;case 10:SE(i.type._context);break;case 22:case 23:zE()}t=t.return}if(sn=s,Rr=s=Vl(s.current,null),xn=Ss=e,Wr=0,Sf=null,RE=Z0=iu=0,as=Up=null,Rh!==null){for(e=0;e<Rh.length;e++)if(t=Rh[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,n=t.pending;if(n!==null){var a=n.next;n.next=r,i.next=a}t.pending=i}Rh=null}return s}function UR(s,e){do{var t=Rr;try{if(CE(),vg.current=$g,Gg){for(var i=pr.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Gg=!1}if(tu=0,Zr=Hr=pr=null,Hp=!1,yf=0,OE.current=null,t===null||t.return===null){Wr=1,Sf=e,Rr=null;break}e:{var n=s,a=t.return,o=t,l=e;if(e=xn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,u=o,c=u.tag;if(!(u.mode&1)&&(c===0||c===11||c===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=qT(a);if(p!==null){p.flags&=-257,YT(p,a,o,n,e),p.mode&1&&WT(n,h,e),e=p,l=h;var f=e.updateQueue;if(f===null){var v=new Set;v.add(l),e.updateQueue=v}else f.add(l);break e}else{if(!(e&1)){WT(n,h,e),jE();break e}l=Error(We(426))}}else if(Ji&&o.mode&1){var g=qT(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),YT(g,a,o,n,e),yE(td(l,o));break e}}n=l=td(l,o),Wr!==4&&(Wr=2),Up===null?Up=[n]:Up.push(n),n=a;do{switch(n.tag){case 3:n.flags|=65536,e&=-e,n.lanes|=e;var b=ER(n,l,e);zT(n,b);break e;case 1:o=l;var y=n.type,C=n.stateNode;if(!(n.flags&128)&&(typeof y.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Bl===null||!Bl.has(C)))){n.flags|=65536,e&=-e,n.lanes|=e;var x=IR(n,o,e);zT(n,x);break e}}n=n.return}while(n!==null)}qR(t)}catch(w){e=w,Rr===t&&t!==null&&(Rr=t=t.return);continue}break}while(!0)}function _R(){var s=Xg.current;return Xg.current=$g,s===null?$g:s}function jE(){(Wr===0||Wr===3||Wr===2)&&(Wr=4),sn===null||!(iu&268435455)&&!(Z0&268435455)||Sl(sn,xn)}function Jg(s,e){var t=fi;fi|=2;var i=_R();(sn!==s||xn!==e)&&(Ao=null,Bh(s,e));do try{h3();break}catch(r){UR(s,r)}while(!0);if(CE(),fi=t,Xg.current=i,Rr!==null)throw Error(We(261));return sn=null,xn=0,Wr}function h3(){for(;Rr!==null;)WR(Rr)}function u3(){for(;Rr!==null&&!Fj();)WR(Rr)}function WR(s){var e=QR(s.alternate,s,Ss);s.memoizedProps=s.pendingProps,e===null?qR(s):Rr=e,OE.current=null}function qR(s){var e=s;do{var t=e.alternate;if(s=e.return,e.flags&32768){if(t=r3(t,e),t!==null){t.flags&=32767,Rr=t;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Wr=6,Rr=null;return}}else if(t=i3(t,e,Ss),t!==null){Rr=t;return}if(e=e.sibling,e!==null){Rr=e;return}Rr=e=s}while(e!==null);Wr===0&&(Wr=5)}function Ih(s,e,t){var i=Ai,r=Ks.transition;try{Ks.transition=null,Ai=1,c3(s,e,t,i)}finally{Ks.transition=r,Ai=i}return null}function c3(s,e,t,i){do Pc();while(Il!==null);if(fi&6)throw Error(We(327));t=s.finishedWork;var r=s.finishedLanes;if(t===null)return null;if(s.finishedWork=null,s.finishedLanes=0,t===s.current)throw Error(We(177));s.callbackNode=null,s.callbackPriority=0;var n=t.lanes|t.childLanes;if(qj(s,n),s===sn&&(Rr=sn=null,xn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Qv||(Qv=!0,GR(Rg,function(){return Pc(),null})),n=(t.flags&15990)!==0,t.subtreeFlags&15990||n){n=Ks.transition,Ks.transition=null;var a=Ai;Ai=1;var o=fi;fi|=4,OE.current=null,s3(s,t),BR(t,s),k4(ew),Pg=!!Jx,ew=Jx=null,s.current=t,a3(t),Pj(),fi=o,Ai=a,Ks.transition=n}else s.current=t;if(Qv&&(Qv=!1,Il=s,Zg=r),n=s.pendingLanes,n===0&&(Bl=null),Bj(t.stateNode),us(s,xr()),e!==null)for(i=s.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Kg)throw Kg=!1,s=Cw,Cw=null,s;return Zg&1&&s.tag!==0&&Pc(),n=s.pendingLanes,n&1?s===Sw?_p++:(_p=0,Sw=s):_p=0,vh(),null}function Pc(){if(Il!==null){var s=MO(Zg),e=Ks.transition,t=Ai;try{if(Ks.transition=null,Ai=16>s?16:s,Il===null)var i=!1;else{if(s=Il,Il=null,Zg=0,fi&6)throw Error(We(331));var r=fi;for(fi|=4,nt=s.current;nt!==null;){var n=nt,a=n.child;if(nt.flags&16){var o=n.deletions;if(o!==null){for(var l=0;l<o.length;l++){var h=o[l];for(nt=h;nt!==null;){var u=nt;switch(u.tag){case 0:case 11:case 15:Vp(8,u,n)}var c=u.child;if(c!==null)c.return=u,nt=c;else for(;nt!==null;){u=nt;var d=u.sibling,p=u.return;if(PR(u),u===h){nt=null;break}if(d!==null){d.return=p,nt=d;break}nt=p}}}var f=n.alternate;if(f!==null){var v=f.child;if(v!==null){f.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}nt=n}}if(n.subtreeFlags&2064&&a!==null)a.return=n,nt=a;else e:for(;nt!==null;){if(n=nt,n.flags&2048)switch(n.tag){case 0:case 11:case 15:Vp(9,n,n.return)}var b=n.sibling;if(b!==null){b.return=n.return,nt=b;break e}nt=n.return}}var y=s.current;for(nt=y;nt!==null;){a=nt;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,nt=C;else e:for(a=y;nt!==null;){if(o=nt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:K0(9,o)}}catch(w){gr(o,o.return,w)}if(o===a){nt=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,nt=x;break e}nt=o.return}}if(fi=r,vh(),io&&typeof io.onPostCommitFiberRoot=="function")try{io.onPostCommitFiberRoot(_0,s)}catch{}i=!0}return i}finally{Ai=t,Ks.transition=e}}return!1}function sD(s,e,t){e=td(t,e),e=ER(s,e,1),s=jl(s,e,1),e=Gn(),s!==null&&(fv(s,1,e),us(s,e))}function gr(s,e,t){if(s.tag===3)sD(s,s,t);else for(;e!==null;){if(e.tag===3){sD(e,s,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Bl===null||!Bl.has(i))){s=td(t,s),s=IR(e,s,1),e=jl(e,s,1),s=Gn(),e!==null&&(fv(e,1,s),us(e,s));break}}e=e.return}}function d3(s,e,t){var i=s.pingCache;i!==null&&i.delete(e),e=Gn(),s.pingedLanes|=s.suspendedLanes&t,sn===s&&(xn&t)===t&&(Wr===4||Wr===3&&(xn&130023424)===xn&&500>xr()-FE?Bh(s,0):RE|=t),us(s,e)}function YR(s,e){e===0&&(s.mode&1?(e=zv,zv<<=1,!(zv&130023424)&&(zv=4194304)):e=1);var t=Gn();s=Wo(s,e),s!==null&&(fv(s,e,t),us(s,t))}function p3(s){var e=s.memoizedState,t=0;e!==null&&(t=e.retryLane),YR(s,t)}function f3(s,e){var t=0;switch(s.tag){case 13:var i=s.stateNode,r=s.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=s.stateNode;break;default:throw Error(We(314))}i!==null&&i.delete(e),YR(s,t)}var QR;QR=function(s,e,t){if(s!==null)if(s.memoizedProps!==e.pendingProps||ls.current)os=!0;else{if(!(s.lanes&t)&&!(e.flags&128))return os=!1,t3(s,e,t);os=!!(s.flags&131072)}else os=!1,Ji&&e.flags&1048576&&XO(e,_g,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;gg(s,e),s=e.pendingProps;var r=Kc(e,zn.current);Fc(e,t),r=DE(null,e,i,s,r,t);var n=AE();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hs(i)?(n=!0,Vg(e)):n=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,wE(e),r.updater=$0,e.stateNode=r,r._reactInternals=e,hw(e,i,s,t),e=dw(null,e,i,!0,n,t)):(e.tag=0,Ji&&n&&mE(e),_n(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(gg(s,e),s=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=m3(i),s=va(i,s),r){case 0:e=cw(null,e,i,s,t);break e;case 1:e=$T(null,e,i,s,t);break e;case 11:e=QT(null,e,i,s,t);break e;case 14:e=GT(null,e,i,va(i.type,s),t);break e}throw Error(We(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:va(i,r),cw(s,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:va(i,r),$T(s,e,i,r,t);case 3:e:{if(NR(e),s===null)throw Error(We(387));i=e.pendingProps,n=e.memoizedState,r=n.element,eR(s,e),Yg(e,i,null,t);var a=e.memoizedState;if(i=a.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=n,e.memoizedState=n,e.flags&256){r=td(Error(We(423)),e),e=XT(s,e,i,t,r);break e}else if(i!==r){r=td(Error(We(424)),e),e=XT(s,e,i,t,r);break e}else for(Is=zl(e.stateNode.containerInfo.firstChild),Ds=e,Ji=!0,ya=null,t=nR(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Zc(),i===r){e=qo(s,e,t);break e}_n(s,e,i,t)}e=e.child}return e;case 5:return sR(e),s===null&&aw(e),i=e.type,r=e.pendingProps,n=s!==null?s.memoizedProps:null,a=r.children,tw(i,r)?a=null:n!==null&&tw(i,n)&&(e.flags|=32),AR(s,e),_n(s,e,a,t),e.child;case 6:return s===null&&aw(e),null;case 13:return kR(s,e,t);case 4:return ME(e,e.stateNode.containerInfo),i=e.pendingProps,s===null?e.child=Jc(e,null,i,t):_n(s,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:va(i,r),QT(s,e,i,r,t);case 7:return _n(s,e,e.pendingProps,t),e.child;case 8:return _n(s,e,e.pendingProps.children,t),e.child;case 12:return _n(s,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,n=e.memoizedProps,a=r.value,Hi(Wg,i._currentValue),i._currentValue=a,n!==null)if(ka(n.value,a)){if(n.children===r.children&&!ls.current){e=qo(s,e,t);break e}}else for(n=e.child,n!==null&&(n.return=e);n!==null;){var o=n.dependencies;if(o!==null){a=n.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(n.tag===1){l=jo(-1,t&-t),l.tag=2;var h=n.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?l.next=l:(l.next=u.next,u.next=l),h.pending=l}}n.lanes|=t,l=n.alternate,l!==null&&(l.lanes|=t),ow(n.return,t,e),o.lanes|=t;break}l=l.next}}else if(n.tag===10)a=n.type===e.type?null:n.child;else if(n.tag===18){if(a=n.return,a===null)throw Error(We(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),ow(a,t,e),a=n.sibling}else a=n.child;if(a!==null)a.return=n;else for(a=n;a!==null;){if(a===e){a=null;break}if(n=a.sibling,n!==null){n.return=a.return,a=n;break}a=a.return}n=a}_n(s,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Fc(e,t),r=ia(r),i=i(r),e.flags|=1,_n(s,e,i,t),e.child;case 14:return i=e.type,r=va(i,e.pendingProps),r=va(i.type,r),GT(s,e,i,r,t);case 15:return TR(s,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:va(i,r),gg(s,e),e.tag=1,hs(i)?(s=!0,Vg(e)):s=!1,Fc(e,t),iR(e,i,r),hw(e,i,r,t),dw(null,e,i,!0,s,t);case 19:return LR(s,e,t);case 22:return DR(s,e,t)}throw Error(We(156,e.tag))};function GR(s,e){return CO(s,e)}function v3(s,e,t,i){this.tag=s,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ys(s,e,t,i){return new v3(s,e,t,i)}function BE(s){return s=s.prototype,!(!s||!s.isReactComponent)}function m3(s){if(typeof s=="function")return BE(s)?1:0;if(s!=null){if(s=s.$$typeof,s===nE)return 11;if(s===sE)return 14}return 2}function Vl(s,e){var t=s.alternate;return t===null?(t=Ys(s.tag,e,s.key,s.mode),t.elementType=s.elementType,t.type=s.type,t.stateNode=s.stateNode,t.alternate=s,s.alternate=t):(t.pendingProps=e,t.type=s.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=s.flags&14680064,t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,e=s.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=s.sibling,t.index=s.index,t.ref=s.ref,t}function Cg(s,e,t,i,r,n){var a=2;if(i=s,typeof s=="function")BE(s)&&(a=1);else if(typeof s=="string")a=5;else e:switch(s){case uc:return Hh(t.children,r,n,e);case rE:a=8,r|=8;break;case Ox:return s=Ys(12,t,e,r|2),s.elementType=Ox,s.lanes=n,s;case Rx:return s=Ys(13,t,e,r),s.elementType=Rx,s.lanes=n,s;case Fx:return s=Ys(19,t,e,r),s.elementType=Fx,s.lanes=n,s;case rO:return J0(t,r,n,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case tO:a=10;break e;case iO:a=9;break e;case nE:a=11;break e;case sE:a=14;break e;case vl:a=16,i=null;break e}throw Error(We(130,s==null?s:typeof s,""))}return e=Ys(a,t,e,r),e.elementType=s,e.type=i,e.lanes=n,e}function Hh(s,e,t,i){return s=Ys(7,s,i,e),s.lanes=t,s}function J0(s,e,t,i){return s=Ys(22,s,i,e),s.elementType=rO,s.lanes=t,s.stateNode={isHidden:!1},s}function oC(s,e,t){return s=Ys(6,s,null,e),s.lanes=t,s}function lC(s,e,t){return e=Ys(4,s.children!==null?s.children:[],s.key,e),e.lanes=t,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function g3(s,e,t,i,r){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ub(0),this.expirationTimes=Ub(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ub(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function HE(s,e,t,i,r,n,a,o,l){return s=new g3(s,e,t,o,l),e===1?(e=1,n===!0&&(e|=8)):e=0,n=Ys(3,null,null,e),s.current=n,n.stateNode=s,n.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},wE(n),s}function y3(s,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hc,key:i==null?null:""+i,children:s,containerInfo:e,implementation:t}}function $R(s){if(!s)return Xl;s=s._reactInternals;e:{if(xu(s)!==s||s.tag!==1)throw Error(We(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(We(171))}if(s.tag===1){var t=s.type;if(hs(t))return GO(s,t,e)}return e}function XR(s,e,t,i,r,n,a,o,l){return s=HE(t,i,!0,s,r,n,a,o,l),s.context=$R(null),t=s.current,i=Gn(),r=Hl(t),n=jo(i,r),n.callback=e??null,jl(t,n,r),s.current.lanes=r,fv(s,r,i),us(s,i),s}function eb(s,e,t,i){var r=e.current,n=Gn(),a=Hl(r);return t=$R(t),e.context===null?e.context=t:e.pendingContext=t,e=jo(n,a),e.payload={element:s},i=i===void 0?null:i,i!==null&&(e.callback=i),s=jl(r,e,a),s!==null&&(Ea(s,r,a,n),fg(s,r,a)),a}function ey(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function aD(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var t=s.retryLane;s.retryLane=t!==0&&t<e?t:e}}function VE(s,e){aD(s,e),(s=s.alternate)&&aD(s,e)}function b3(){return null}var KR=typeof reportError=="function"?reportError:function(s){console.error(s)};function UE(s){this._internalRoot=s}tb.prototype.render=UE.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(We(409));eb(s,e,null,null)};tb.prototype.unmount=UE.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;ru(function(){eb(null,s,null,null)}),e[_o]=null}};function tb(s){this._internalRoot=s}tb.prototype.unstable_scheduleHydration=function(s){if(s){var e=TO();s={blockedOn:null,target:s,priority:e};for(var t=0;t<Cl.length&&e!==0&&e<Cl[t].priority;t++);Cl.splice(t,0,s),t===0&&AO(s)}};function _E(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ib(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function oD(){}function C3(s,e,t,i,r){if(r){if(typeof i=="function"){var n=i;i=function(){var h=ey(a);n.call(h)}}var a=XR(e,i,s,0,null,!1,!1,"",oD);return s._reactRootContainer=a,s[_o]=a.current,pf(s.nodeType===8?s.parentNode:s),ru(),a}for(;r=s.lastChild;)s.removeChild(r);if(typeof i=="function"){var o=i;i=function(){var h=ey(l);o.call(h)}}var l=HE(s,0,!1,null,null,!1,!1,"",oD);return s._reactRootContainer=l,s[_o]=l.current,pf(s.nodeType===8?s.parentNode:s),ru(function(){eb(e,l,t,i)}),l}function rb(s,e,t,i,r){var n=t._reactRootContainer;if(n){var a=n;if(typeof r=="function"){var o=r;r=function(){var l=ey(a);o.call(l)}}eb(e,a,s,r)}else a=C3(t,e,s,r,i);return ey(a)}EO=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ap(e.pendingLanes);t!==0&&(lE(e,t|1),us(e,xr()),!(fi&6)&&(id=xr()+500,vh()))}break;case 13:ru(function(){var i=Wo(s,1);if(i!==null){var r=Gn();Ea(i,s,1,r)}}),VE(s,1)}};hE=function(s){if(s.tag===13){var e=Wo(s,134217728);if(e!==null){var t=Gn();Ea(e,s,134217728,t)}VE(s,134217728)}};IO=function(s){if(s.tag===13){var e=Hl(s),t=Wo(s,e);if(t!==null){var i=Gn();Ea(t,s,e,i)}VE(s,e)}};TO=function(){return Ai};DO=function(s,e){var t=Ai;try{return Ai=s,e()}finally{Ai=t}};qx=function(s,e,t){switch(e){case"input":if(jx(s,t),e=t.name,t.type==="radio"&&e!=null){for(t=s;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==s&&i.form===s.form){var r=Q0(i);if(!r)throw Error(We(90));sO(i),jx(i,r)}}}break;case"textarea":oO(s,t);break;case"select":e=t.value,e!=null&&kc(s,!!t.multiple,e,!1)}};fO=PE;vO=ru;var S3={usingClientEntryPoint:!1,Events:[mv,fc,Q0,dO,pO,PE]},Qd={findFiberByHostInstance:Oh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},x3={bundleType:Qd.bundleType,version:Qd.version,rendererPackageName:Qd.rendererPackageName,rendererConfig:Qd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Go.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=yO(s),s===null?null:s.stateNode},findFiberByHostInstance:Qd.findFiberByHostInstance||b3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gv.isDisabled&&Gv.supportsFiber)try{_0=Gv.inject(x3),io=Gv}catch{}}Os.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S3;Os.createPortal=function(s,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_E(e))throw Error(We(200));return y3(s,e,null,t)};Os.createRoot=function(s,e){if(!_E(s))throw Error(We(299));var t=!1,i="",r=KR;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=HE(s,1,!1,null,null,t,!1,i,r),s[_o]=e.current,pf(s.nodeType===8?s.parentNode:s),new UE(e)};Os.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(We(188)):(s=Object.keys(s).join(","),Error(We(268,s)));return s=yO(e),s=s===null?null:s.stateNode,s};Os.flushSync=function(s){return ru(s)};Os.hydrate=function(s,e,t){if(!ib(e))throw Error(We(200));return rb(null,s,e,!0,t)};Os.hydrateRoot=function(s,e,t){if(!_E(s))throw Error(We(405));var i=t!=null&&t.hydratedSources||null,r=!1,n="",a=KR;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=XR(e,null,s,1,t??null,r,!1,n,a),s[_o]=e.current,pf(s),i)for(s=0;s<i.length;s++)t=i[s],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new tb(e)};Os.render=function(s,e,t){if(!ib(e))throw Error(We(200));return rb(null,s,e,!1,t)};Os.unmountComponentAtNode=function(s){if(!ib(s))throw Error(We(40));return s._reactRootContainer?(ru(function(){rb(null,null,s,!1,function(){s._reactRootContainer=null,s[_o]=null})}),!0):!1};Os.unstable_batchedUpdates=PE;Os.unstable_renderSubtreeIntoContainer=function(s,e,t,i){if(!ib(t))throw Error(We(200));if(s==null||s._reactInternals===void 0)throw Error(We(38));return rb(s,e,t,!1,i)};Os.version="18.2.0-next-9e3b772b8-20220608";function ZR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZR)}catch(s){console.error(s)}}ZR(),XL.exports=Os;var nb=XL.exports,lD=nb;kx.createRoot=lD.createRoot,kx.hydrateRoot=lD.hydrateRoot;/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xf(){return xf=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},xf.apply(this,arguments)}var Tl;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Tl||(Tl={}));const hD="popstate";function w3(s){s===void 0&&(s={});function e(i,r){let{pathname:n,search:a,hash:o}=i.location;return Mw("",{pathname:n,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:ty(r)}return E3(e,t,null,s)}function Pr(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function WE(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function M3(){return Math.random().toString(36).substr(2,8)}function uD(s,e){return{usr:s.state,key:s.key,idx:e}}function Mw(s,e,t,i){return t===void 0&&(t=null),xf({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?zd(e):e,{state:t,key:e&&e.key||i||M3()})}function ty(s){let{pathname:e="/",search:t="",hash:i=""}=s;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function zd(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substr(t),s=s.substr(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substr(i),s=s.substr(0,i)),s&&(e.pathname=s)}return e}function E3(s,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:n=!1}=i,a=r.history,o=Tl.Pop,l=null,h=u();h==null&&(h=0,a.replaceState(xf({},a.state,{idx:h}),""));function u(){return(a.state||{idx:null}).idx}function c(){o=Tl.Pop;let g=u(),b=g==null?null:g-h;h=g,l&&l({action:o,location:v.location,delta:b})}function d(g,b){o=Tl.Push;let y=Mw(v.location,g,b);t&&t(y,g),h=u()+1;let C=uD(y,h),x=v.createHref(y);try{a.pushState(C,"",x)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(x)}n&&l&&l({action:o,location:v.location,delta:1})}function p(g,b){o=Tl.Replace;let y=Mw(v.location,g,b);t&&t(y,g),h=u();let C=uD(y,h),x=v.createHref(y);a.replaceState(C,"",x),n&&l&&l({action:o,location:v.location,delta:0})}function f(g){let b=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof g=="string"?g:ty(g);return Pr(b,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,b)}let v={get action(){return o},get location(){return s(r,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(hD,c),l=g,()=>{r.removeEventListener(hD,c),l=null}},createHref(g){return e(r,g)},createURL:f,encodeLocation(g){let b=f(g);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:d,replace:p,go(g){return a.go(g)}};return v}var cD;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(cD||(cD={}));function I3(s,e,t){t===void 0&&(t="/");let i=typeof e=="string"?zd(e):e,r=qE(i.pathname||"/",t);if(r==null)return null;let n=JR(s);T3(n);let a=null;for(let o=0;a==null&&o<n.length;++o)a=P3(n[o],B3(r));return a}function JR(s,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(n,a,o)=>{let l={relativePath:o===void 0?n.path||"":o,caseSensitive:n.caseSensitive===!0,childrenIndex:a,route:n};l.relativePath.startsWith("/")&&(Pr(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let h=Ul([i,l.relativePath]),u=t.concat(l);n.children&&n.children.length>0&&(Pr(n.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),JR(n.children,e,u,h)),!(n.path==null&&!n.index)&&e.push({path:h,score:R3(h,n.index),routesMeta:u})};return s.forEach((n,a)=>{var o;if(n.path===""||!((o=n.path)!=null&&o.includes("?")))r(n,a);else for(let l of eF(n.path))r(n,a,l)}),e}function eF(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),n=t.replace(/\?$/,"");if(i.length===0)return r?[n,""]:[n];let a=eF(i.join("/")),o=[];return o.push(...a.map(l=>l===""?n:[n,l].join("/"))),r&&o.push(...a),o.map(l=>s.startsWith("/")&&l===""?"/":l)}function T3(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:F3(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const D3=/^:[\w-]+$/,A3=3,N3=2,k3=1,L3=10,O3=-2,dD=s=>s==="*";function R3(s,e){let t=s.split("/"),i=t.length;return t.some(dD)&&(i+=O3),e&&(i+=N3),t.filter(r=>!dD(r)).reduce((r,n)=>r+(D3.test(n)?A3:n===""?k3:L3),i)}function F3(s,e){return s.length===e.length&&s.slice(0,-1).every((i,r)=>i===e[r])?s[s.length-1]-e[e.length-1]:0}function P3(s,e){let{routesMeta:t}=s,i={},r="/",n=[];for(let a=0;a<t.length;++a){let o=t[a],l=a===t.length-1,h=r==="/"?e:e.slice(r.length)||"/",u=z3({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},h);if(!u)return null;Object.assign(i,u.params);let c=o.route;n.push({params:i,pathname:Ul([r,u.pathname]),pathnameBase:W3(Ul([r,u.pathnameBase])),route:c}),u.pathnameBase!=="/"&&(r=Ul([r,u.pathnameBase]))}return n}function z3(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=j3(s.path,s.caseSensitive,s.end),r=e.match(t);if(!r)return null;let n=r[0],a=n.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:i.reduce((h,u,c)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let v=o[c]||"";a=n.slice(0,n.length-v.length).replace(/(.)\/+$/,"$1")}const f=o[c];return p&&!f?h[d]=void 0:h[d]=H3(f||"",d),h},{}),pathname:n,pathnameBase:a,pattern:s}}function j3(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),WE(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let i=[],r="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(i.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(i.push({paramName:"*"}),r+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":s!==""&&s!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function B3(s){try{return decodeURI(s)}catch(e){return WE(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function H3(s,e){try{return decodeURIComponent(s)}catch(t){return WE(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+s+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),s}}function qE(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}function V3(s,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof s=="string"?zd(s):s;return{pathname:t?t.startsWith("/")?t:U3(t,e):e,search:q3(i),hash:Y3(r)}}function U3(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function hC(s,e,t,i){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _3(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function tF(s,e){let t=_3(s);return e?t.map((i,r)=>r===s.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function iF(s,e,t,i){i===void 0&&(i=!1);let r;typeof s=="string"?r=zd(s):(r=xf({},s),Pr(!r.pathname||!r.pathname.includes("?"),hC("?","pathname","search",r)),Pr(!r.pathname||!r.pathname.includes("#"),hC("#","pathname","hash",r)),Pr(!r.search||!r.search.includes("#"),hC("#","search","hash",r)));let n=s===""||r.pathname==="",a=n?"/":r.pathname,o;if(a==null)o=t;else{let c=e.length-1;if(!i&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),c-=1;r.pathname=d.join("/")}o=c>=0?e[c]:"/"}let l=V3(r,o),h=a&&a!=="/"&&a.endsWith("/"),u=(n||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(h||u)&&(l.pathname+="/"),l}const Ul=s=>s.join("/").replace(/\/\/+/g,"/"),W3=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),q3=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Y3=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function Q3(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const rF=["post","put","patch","delete"];new Set(rF);const G3=["get",...rF];new Set(G3);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wf(){return wf=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},wf.apply(this,arguments)}const YE=le.createContext(null),$3=le.createContext(null),wu=le.createContext(null),sb=le.createContext(null),Mu=le.createContext({outlet:null,matches:[],isDataRoute:!1}),nF=le.createContext(null);function X3(s,e){let{relative:t}=e===void 0?{}:e;yv()||Pr(!1);let{basename:i,navigator:r}=le.useContext(wu),{hash:n,pathname:a,search:o}=aF(s,{relative:t}),l=a;return i!=="/"&&(l=a==="/"?i:Ul([i,a])),r.createHref({pathname:l,search:o,hash:n})}function yv(){return le.useContext(sb)!=null}function ab(){return yv()||Pr(!1),le.useContext(sb).location}function sF(s){le.useContext(wu).static||le.useLayoutEffect(s)}function ob(){let{isDataRoute:s}=le.useContext(Mu);return s?hB():K3()}function K3(){yv()||Pr(!1);let s=le.useContext(YE),{basename:e,future:t,navigator:i}=le.useContext(wu),{matches:r}=le.useContext(Mu),{pathname:n}=ab(),a=JSON.stringify(tF(r,t.v7_relativeSplatPath)),o=le.useRef(!1);return sF(()=>{o.current=!0}),le.useCallback(function(h,u){if(u===void 0&&(u={}),!o.current)return;if(typeof h=="number"){i.go(h);return}let c=iF(h,JSON.parse(a),n,u.relative==="path");s==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Ul([e,c.pathname])),(u.replace?i.replace:i.push)(c,u.state,u)},[e,i,a,n,s])}function aF(s,e){let{relative:t}=e===void 0?{}:e,{future:i}=le.useContext(wu),{matches:r}=le.useContext(Mu),{pathname:n}=ab(),a=JSON.stringify(tF(r,i.v7_relativeSplatPath));return le.useMemo(()=>iF(s,JSON.parse(a),n,t==="path"),[s,a,n,t])}function Z3(s,e){return J3(s,e)}function J3(s,e,t,i){yv()||Pr(!1);let{navigator:r}=le.useContext(wu),{matches:n}=le.useContext(Mu),a=n[n.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let h=ab(),u;if(e){var c;let g=typeof e=="string"?zd(e):e;l==="/"||(c=g.pathname)!=null&&c.startsWith(l)||Pr(!1),u=g}else u=h;let d=u.pathname||"/",p=l==="/"?d:d.slice(l.length)||"/",f=I3(s,{pathname:p}),v=nB(f&&f.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:Ul([l,r.encodeLocation?r.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Ul([l,r.encodeLocation?r.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),n,t,i);return e&&v?le.createElement(sb.Provider,{value:{location:wf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Tl.Pop}},v):v}function eB(){let s=lB(),e=Q3(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},n=null;return le.createElement(le.Fragment,null,le.createElement("h2",null,"Unexpected Application Error!"),le.createElement("h3",{style:{fontStyle:"italic"}},e),t?le.createElement("pre",{style:r},t):null,n)}const tB=le.createElement(eB,null);class iB extends le.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?le.createElement(Mu.Provider,{value:this.props.routeContext},le.createElement(nF.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function rB(s){let{routeContext:e,match:t,children:i}=s,r=le.useContext(YE);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),le.createElement(Mu.Provider,{value:e},i)}function nB(s,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),s==null){var n;if((n=t)!=null&&n.errors)s=t.matches;else return null}let a=s,o=(r=t)==null?void 0:r.errors;if(o!=null){let u=a.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));u>=0||Pr(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,h=-1;if(t&&i&&i.v7_partialHydration)for(let u=0;u<a.length;u++){let c=a[u];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(h=u),c.route.id){let{loaderData:d,errors:p}=t,f=c.route.loader&&d[c.route.id]===void 0&&(!p||p[c.route.id]===void 0);if(c.route.lazy||f){l=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((u,c,d)=>{let p,f=!1,v=null,g=null;t&&(p=o&&c.route.id?o[c.route.id]:void 0,v=c.route.errorElement||tB,l&&(h<0&&d===0?(uB("route-fallback",!1),f=!0,g=null):h===d&&(f=!0,g=c.route.hydrateFallbackElement||null)));let b=e.concat(a.slice(0,d+1)),y=()=>{let C;return p?C=v:f?C=g:c.route.Component?C=le.createElement(c.route.Component,null):c.route.element?C=c.route.element:C=u,le.createElement(rB,{match:c,routeContext:{outlet:u,matches:b,isDataRoute:t!=null},children:C})};return t&&(c.route.ErrorBoundary||c.route.errorElement||d===0)?le.createElement(iB,{location:t.location,revalidation:t.revalidation,component:v,error:p,children:y(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):y()},null)}var oF=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(oF||{}),iy=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(iy||{});function sB(s){let e=le.useContext(YE);return e||Pr(!1),e}function aB(s){let e=le.useContext($3);return e||Pr(!1),e}function oB(s){let e=le.useContext(Mu);return e||Pr(!1),e}function lF(s){let e=oB(),t=e.matches[e.matches.length-1];return t.route.id||Pr(!1),t.route.id}function lB(){var s;let e=le.useContext(nF),t=aB(iy.UseRouteError),i=lF(iy.UseRouteError);return e!==void 0?e:(s=t.errors)==null?void 0:s[i]}function hB(){let{router:s}=sB(oF.UseNavigateStable),e=lF(iy.UseNavigateStable),t=le.useRef(!1);return sF(()=>{t.current=!0}),le.useCallback(function(r,n){n===void 0&&(n={}),t.current&&(typeof r=="number"?s.navigate(r):s.navigate(r,wf({fromRouteId:e},n)))},[s,e])}const pD={};function uB(s,e,t){!e&&!pD[s]&&(pD[s]=!0)}function Th(s){Pr(!1)}function cB(s){let{basename:e="/",children:t=null,location:i,navigationType:r=Tl.Pop,navigator:n,static:a=!1,future:o}=s;yv()&&Pr(!1);let l=e.replace(/^\/*/,"/"),h=le.useMemo(()=>({basename:l,navigator:n,static:a,future:wf({v7_relativeSplatPath:!1},o)}),[l,o,n,a]);typeof i=="string"&&(i=zd(i));let{pathname:u="/",search:c="",hash:d="",state:p=null,key:f="default"}=i,v=le.useMemo(()=>{let g=qE(u,l);return g==null?null:{location:{pathname:g,search:c,hash:d,state:p,key:f},navigationType:r}},[l,u,c,d,p,f,r]);return v==null?null:le.createElement(wu.Provider,{value:h},le.createElement(sb.Provider,{children:t,value:v}))}function dB(s){let{children:e,location:t}=s;return Z3(Ew(e),t)}new Promise(()=>{});function Ew(s,e){e===void 0&&(e=[]);let t=[];return le.Children.forEach(s,(i,r)=>{if(!le.isValidElement(i))return;let n=[...e,r];if(i.type===le.Fragment){t.push.apply(t,Ew(i.props.children,n));return}i.type!==Th&&Pr(!1),!i.props.index||!i.props.children||Pr(!1);let a={id:i.props.id||n.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=Ew(i.props.children,n)),t.push(a)}),t}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iw(){return Iw=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},Iw.apply(this,arguments)}function pB(s,e){if(s==null)return{};var t={},i=Object.keys(s),r,n;for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&(t[r]=s[r]);return t}function fB(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function vB(s,e){return s.button===0&&(!e||e==="_self")&&!fB(s)}const mB=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],gB="startTransition",fD=Nx[gB];function yB(s){let{basename:e,children:t,future:i,window:r}=s,n=le.useRef();n.current==null&&(n.current=w3({window:r,v5Compat:!0}));let a=n.current,[o,l]=le.useState({action:a.action,location:a.location}),{v7_startTransition:h}=i||{},u=le.useCallback(c=>{h&&fD?fD(()=>l(c)):l(c)},[l,h]);return le.useLayoutEffect(()=>a.listen(u),[a,u]),le.createElement(cB,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:i})}const bB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",CB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,SB=le.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:n,replace:a,state:o,target:l,to:h,preventScrollReset:u,unstable_viewTransition:c}=e,d=pB(e,mB),{basename:p}=le.useContext(wu),f,v=!1;if(typeof h=="string"&&CB.test(h)&&(f=h,bB))try{let C=new URL(window.location.href),x=h.startsWith("//")?new URL(C.protocol+h):new URL(h),w=qE(x.pathname,p);x.origin===C.origin&&w!=null?h=w+x.search+x.hash:v=!0}catch{}let g=X3(h,{relative:r}),b=xB(h,{replace:a,state:o,target:l,preventScrollReset:u,relative:r,unstable_viewTransition:c});function y(C){i&&i(C),C.defaultPrevented||b(C)}return le.createElement("a",Iw({},d,{href:f||g,onClick:v||n?i:y,ref:t,target:l}))});var vD;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(vD||(vD={}));var mD;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(mD||(mD={}));function xB(s,e){let{target:t,replace:i,state:r,preventScrollReset:n,relative:a,unstable_viewTransition:o}=e===void 0?{}:e,l=ob(),h=ab(),u=aF(s,{relative:a});return le.useCallback(c=>{if(vB(c,t)){c.preventDefault();let d=i!==void 0?i:ty(h)===ty(u);l(s,{replace:d,state:r,preventScrollReset:n,relative:a,unstable_viewTransition:o})}},[h,l,u,i,r,t,s,n,a,o])}const lb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABSCAYAAAC14+EtAAAABmJLR0QA/wD/AP+gvaeTAAAOo0lEQVR42u2dCXQURRrHR3A34C3iPnT1cawinquyrDcEdF3Q5bnr7Yooug8VAtlFXV19uoOI4gKBzEwSAoRwBEMSrmRCMCQkIDHmJJObkJCQhAAhJ7nv2vp6vu6pdLonx3RPMsmU70+m6+qe+nV9XVXT9anROIP1YDD5aXRpz2u02b92NoYjBb2plYpQ1Wh0pp0aXfp8jW/Kr5wN4zjgWFUJELWxVzobaQiDu0KfRiQAEgqwgv711XiZntQQcoWzwYZA2LDBZ5KrLqLD3XMXeVwXKQ2uu0roM9HTCXEQgoeH4V6dzvvTjRu94zw9vbqoCOgJ3Y99AcfqrABRjeBmnLVo6f6nbxrpsCgcLVUOD0qsAYBjVUhN6hqNV+rdSoJrpupwC58Z52ac6b7Y6Dp+uIPSarWjKIwnN240rNHpvPLlYCkIjlW2Rp+mpb1xqhLgCKMWKuMy48yFyyIeuW64wAoODh5thuXlSf+e7wsslcD1hKjL/J0S4Fg18xCXBLte42iw/P39x9AeNd/T0+BLgZX3F5YdwHWHaDB9qtGfvFUJcKyaeIiLjdOvGqqwfH19rzLD8t5JG7zOFlh2BserkypOo09313hlT1ACHKvaZcZZO6nma4PvHfSlIA+PreNoj1pIgQXTRm5QCtYggWPVIUD0Sf+NEuBYVfMQF6dMt9tS0Lp1vuMBFu1ZRtqwbWrAGgLgekI0mBZrdAnXKQGOVaXQE2NdFV8KMhgME2kjuuMcq1NtWEMMHKtapcGxOrfUOMtzidGVriJoBryKsGGD9xQGVpc9YfUX3Kqki+S9oyXk5q1ZaoNrVhMcq5L+QLRMiA3Z9oDi57eDxMXFk9LSczaBi7/QQCB0dhGSUt5EtIkXybSAXIcGx+qsAFEi0OWm1fbqRQcPGsm5c2WED/X19YqAE4eMymauN04PyqOL1Y4LzqLwWdluRlct1TQLOK919gJXUVHRrYGVBFff1ikJsaS+jWw0VZCH9uQ5MDgJiGt8tX72gLZt284ejaokuOfCCskfgk6T1cnlJKuqWRKisegymbwjx8HBMfo45CXVwR079pP5edTZqQq4eWFnuqXdsTOXfBxX1sOcVrd0kDkHCoYHOLewOaqDKy4uMZuuklK7gGN1Fx2whOTXCnkb2zvJYyH56oH76PA84p3wCfnnoWeGFLi9ew+Q3buD+pzfx2cL6egw97Tjx0/YHRyvD2JLSRfmL7zcSq7ZlKEOuC+jX+FO0tzeQFLLjhL/1JXkk8PPDQq4HTsCSGJiMrl8uY67pvz8gj6Di4iI5MoAvF27fhg0cKAdudVCmRUnytQC92qPB2xHZxvJuZRE9mSsJ19EvWQXcNC7elwHhbB587Y+gTt1Ko8rA+bSz2/7oIKD0SUfMum0wW7g2NDV1UmKanJIaK4v0R59QzVwgYEhkuc/cSK+V2h6vQ9paWnh8sMAZbDBjTKYSEeX2WDCvzduzlQXXGtHM9mc/DlJKDlM6ltre0Kk/0FP/O74u4qD27MnhOlpHcLnmpqaXsHt23dQyO/vv0s1cIuiS/oEDibkrR1dQrl7dp9SHtxXDLiW9iYhfnn4bOIZ705iC0NIVdPFbgA7uzrI/mwvRcEFBe0V6j97tpg0N1vmSQDGWtmTJ01cvsrKKlzu2q7ayskZOuDwSLtEZu7LJ6MN6ZJlpu7K7Vbm94F59gMn1vq4JSSx9EfOdPIhIm+7KuAKCgoFGBDg+WWtbG2t2TokJ6eqDo4NFc3tZFtOFXn5cBH57bZsMtYng+td0aX1FutBTea4LZmDB47X2hMfkJrmS0IZMK1KgAsO3tcNHDsyBNPp67tVslxAQKCQD+pQE9zuvGoSQ6G0d3aRvobI4jp1BidfHX2tX+BA3x5bRO+kdvMqATWj7uFPKwBufzdwEFdWdl6Ig7mZVLmff/6FS29qaiJ0MVtVcH87VMTFQQ9aGFVM9hbUkgaZ9Ut+bfP+H04NHXCghNLDQrktyV/aDC4kpCe4yMgoIY5/fol1/vwFLj0nJ5f5SUddcKzGeKeTvxgLyabMSpJT3cyNIttoj4w730AeDTmt3srJQMHtTFstlIs7G6oKOC8vXzpIaelhCnlt2eJPn7lmsxUefnhQwA3a73H/Pfr6gMBtSvqPZfBQkWozOFjiEoMDpaWlC/HZ2TndykRHxwjPQB+fzSMXHMzTiqqzSWiOL/k6doHVckEZHkI5KGMrOHYuxoJjBx9tbW3cmiSfduZMkTB96P7r9wgAB6shcuFifTE5UrCbrIv7kCyj8zrLwvRcUno537KsczFeNXDm55hlkBITc0wwo+3t5gFSbOzxkQ0OJtYX6ookIcIidH6liRRWZ5HGtrpuaSFZOlXBHTkSLaSVl1/i4sLCDglx8APqiAbHP+O+jlnAmUswgeyEWypUNV4gKyL+bDO4/ftDZcFB7+LXIiEEBgaTrKxs8yS4olLiRaERCo7V50de5H4lgDXKts7WbtDK60vI6mPvKDIBtwYOZDJlWExzJu31jY3c56SkFKvgbH3La+L2HPIv+tMMDO9fCHcgcKzgx9Z1dOUERpTw3FsePkexJa8DB8KsggsI2GMx6cyrCbBUJs67ebMfSUk5yZVxoBdi+wduZczfBzQdUPrXAXitzho4drLNB3a1ZBi8yTx8wUVFHe0GLisrZzi9gj58wcEgpbW1lVRVVZP4+ESydau/TeDm6owZtMG6nOBsABcaGt4rOP7VcuXeDPP+QOOd+QDn30RvancwcG8OCXDsvMwaOGVFwQk7UdImcR4V9KZGhwAHr+dFFfxALjWcGxLgYNEYfkS1A7gY2IjSc/trynhuD7c+rXJIg2O1+tjbgwYOhvXx8Qk9VkEUVidsmtywwfBYr3vB1qZfzW041JtO2xNc1Uh8k9mK2mD/uE636Z7+++Egozj/Xvr0ZNXBgUsM8G9CG+z8CAfXAK401q/3ul2R7bPgUUhvMqoGjg/LIua5gEcF2nB5IwxcBWyipNuU1fGupDM9hCPRDlXAWbzuaEbBHm7agInDHNwF8Nm1du3aq+3ibcA7YwqORJtUAccG2DUKvk2GEzh0AeWu0+lcBsW3B7i94EaipmrVwAkAD7k+CN4UaKO2Oyo4CiwV3GuAa6gh4Unn+1PXcv5L9KZS1cAJPlHCZk6G/dvoZcghwIG3BvA0NHQ9wlFfz7r0hWa/XiqBswxknrrZvHdbpamE7eC4ORjtYTMcx6UfTiUMpp9VAyeYUOqYDacSJUMDnKEV5mB0hDhV48jBMpXoUgUcH8AVFE4lsgYJXB3MwfR6/a2a4RQ80+/DqUSbKuCEQJ3PcFMJzmmp+uDQlaHW29v7xmHtGRW86JlHorXqgGMC3Xo1HUeiHSqAK4QhvYeHx9gR5YMYnK+ZR6KFqp9rSajrHTgSbVYAXDoM6alr3pHt69+/aIzdzkXnghNwJFrTX3D8kJ44XcIPXmAWtct6Adf3n1WcwY7TFupZFkeiuT3Bze4c0M8qzmBHgJZF7V8YeK3OlnGgwCxqtzhbwwHDh6FPPeBsBWdwBmdwBmdwBmdw2EBXVEZT3TDSvnQKaoJM+p2YHieT/iamvy3ToJC2Xabsd1QGmTQ9lr3LyrXfSwX7itv43VTgFI9qpijfDOZ7SulZzLcYj7+xcs71mGcBE7fLSt27Mc9NeKyTqdeHPy/9G9DL9aZomJ1IK2QqXMV7oJVJTwDHdVSpEmlXMvW/KZEOOxAjJeLHg4M+rHeNzHmfgGuiiqd6DY/fwGMAOYfJ+zReA9wMn0robsynxXzg8GusxDmvw5sDwkdMfDJVukzd72CeCUxbzJOoO5qB/A5T/nssE8DWy4M7TXVSorJR4GEC0xsl0u/mofDO32TAgXP/cqpxfQS3HM/7OZYdLUofA95woaxEmgveTBkS4Gb0Yn20eLOAA7JXJdLfxe9RKwEuqJe6JzBtAdd+lRw4UfxkLPeyOAHC11TgT+I+UdpsvHtXyYBbwwMH3zNUG2XArUAQfn0El0r1LV40uAN6TpTOuziaLtNIc8G5ENX1AwAH0HTgXV4iPRa+I3idsgHce3hz/E8JcEupYAvM96I0f6ow7AGNEs+vc1SfMF8a/g8Mv5YA9z7V8wjB1Ro4evwAlrkfj8FzWogojy/ssOrHc7y/4P6IN+zNTNpE2FION4uN4J7H9oCO8qAS4MBtEPhyH4XxV1OBk5JXZMDNxS9yu8hsvigFDo+DsGe6WAG3XmTm4Nzg/+ImJg5MZJSo3KM4uGB1mwgcfJ9qkQrE4BgLsoxJ+wI8TeFnKXCtEnWD3pIAB48gcL+exJt6W8CNpboMXxLjF2CXHiMDLhBN2hRG+ayJkQA3AetcKQUO84OL2Q1MnY9jT2UbEVzlxYiuBxyGnUEV4nmfFYH7DG9EVi/IgANQSUwauHL9zAq4eIm6QZPF4PD4HoS93CZw+HkbP3Snf4+Al0Lmrm9kytwADoRk/NCACbhFChwz5G7FHioGN9+Kf5uTTL5N4BbMilmaKAOuT6YSP09CizINTSdrXWwylUzcSrQCt9kKbjZWNBUvdKYMuPdxKD5N1OMeBgd1VP+2Au4Kqp9QwSJw4LM3UVTnFLQIhH8moLmB8JhMI71lKzg8hjnhNziNiGbilQLngib5oK3gwPYW4ySviH/HQwIcDBj2yFwg9NQcOXDM87AFTXMkM0Ft5a9FlB+et+C82JO5zgQ0X7dILBiUKgTuHzgarmAXGJQCh/Gz8FFQN2BwePwtxq0SDRAa8fM0TP+rzAUuwvRH5cCJJrs8ODccyY2XqTeAHbWieckBF2FUXjgx9UHA27FxxeAS8fko1lwZcNfjIwGcdF3bC7iLMnX7WAOHaVt5V879AbeGNTlomiBuEhP3OA+S/n0Sl6pcZBr4eiz/J+wZ8PkRiXwuaIbeY4AvtXLHPixxXWPQjIZhD4Rn5kuYBvOlO/HzHVhWTjMw3zNUX4rOu5i/RibuK6qnmGM3K3Xzg49r8XiaxHcbh2mvW0m7n43/PwuklCE2c0KxAAAAAElFTkSuQmCC";var hF={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},gD=Lt.createContext&&Lt.createContext(hF),_l=function(){return _l=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},_l.apply(this,arguments)},wB=function(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(s);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(s,i[r])&&(t[i[r]]=s[i[r]]);return t};function uF(s){return s&&s.map(function(e,t){return Lt.createElement(e.tag,_l({key:t},e.attr),uF(e.child))})}function $o(s){return function(e){return Lt.createElement(MB,_l({attr:_l({},s.attr)},e),uF(s.child))}}function MB(s){var e=function(t){var i=s.attr,r=s.size,n=s.title,a=wB(s,["attr","size","title"]),o=r||t.size||"1em",l;return t.className&&(l=t.className),s.className&&(l=(l?l+" ":"")+s.className),Lt.createElement("svg",_l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,a,{className:l,style:_l(_l({color:s.color||t.color},t.style),s.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&Lt.createElement("title",null,n),s.children)};return gD!==void 0?Lt.createElement(gD.Consumer,null,function(t){return e(t)}):e(hF)}function EB(s){return $o({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M337.509 305.372h-17.501l-6.571-5.486c20.791-25.232 33.922-57.054 33.922-93.257C347.358 127.632 283.896 64 205.135 64 127.452 64 64 127.632 64 206.629s63.452 142.628 142.225 142.628c35.011 0 67.831-13.167 92.991-34.008l6.561 5.487v17.551L415.18 448 448 415.086 337.509 305.372zm-131.284 0c-54.702 0-98.463-43.887-98.463-98.743 0-54.858 43.761-98.742 98.463-98.742 54.7 0 98.462 43.884 98.462 98.742 0 54.856-43.762 98.743-98.462 98.743z"}}]})(s)}function IB(s){return $o({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"}}]})(s)}function TB(s){return $o({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"}}]})(s)}function DB(s){return $o({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"}}]})(s)}function AB(s){return $o({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"}}]})(s)}function NB(s){return $o({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M444.52 3.52L28.74 195.42c-47.97 22.39-31.98 92.75 19.19 92.75h175.91v175.91c0 51.17 70.36 67.17 92.75 19.19l191.9-415.78c15.99-38.39-25.59-79.97-63.97-63.97z"}}]})(s)}function kB(s){return $o({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M272 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM160 480c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm112-108c0 6.6-5.4 12-12 12H60c-6.6 0-12-5.4-12-12V60c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v312z"}}]})(s)}function LB(s){return $o({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.5 2h-13a.5.5 0 0 0-.5.5V11h6V8l5 4-5 4v-3H5v8.5a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-19a.5.5 0 0 0-.5-.5z"}}]})(s)}const OB="/assets/light-mode-button-X4OXHFfW.png",RB="/assets/dark-mode-button-85jBkhOs.png",FB=()=>{const[s,e]=Lt.useState(localStorage.getItem("theme")?localStorage.getItem("theme"):"light"),t=document.documentElement;return Lt.useEffect(()=>{s==="dark"?(t.classList.add("dark"),localStorage.setItem("theme","dark")):(t.classList.remove("dark"),localStorage.setItem("theme","light"))},[s]),J.jsxs("div",{className:"relative",children:[J.jsx("img",{src:OB,alt:"",onClick:()=>e(s==="light"?"dark":"light"),className:`w-12 cursor-pointer drop-shadow-[1px_1px_1px_rgba(0,0,0,0.1)] transition-all duration-300 absolute right-0 z-10 ${s==="dark"?"opacity-0":"opacity-100"} `}),J.jsx("img",{src:RB,alt:"",onClick:()=>e(s==="light"?"dark":"light"),className:"w-12 cursor-pointer drop-shadow-[1px_1px_1px_rgba(0,0,0,0.1)] transition-all duration-300"})]})},PB=[{id:1,name:"Home",link:"/home"},{id:2,name:"Users",link:"/users"},{id:3,name:"Properties",link:"/properties"},{id:4,name:"Exports",link:"/exports"},{id:5,name:"Broadcast",link:"/broadcast"}],zB=[{id:1,name:"1. Download Expo Go",link:"https://expo.dev/client ",target:"new-window"},{id:2,name:"2. Scan for IOS",link:"/qr",target:""}],hb=({handleLogoutPopup:s})=>J.jsxs("div",{className:"shadow-md bg-white dark:bg-gray-900 dark:text-white duration-200 relative z-40",children:[J.jsx("div",{className:"bg-primary/40 py-2",children:J.jsxs("div",{className:"container flex justify-between items-center",children:[J.jsx("div",{children:J.jsxs("a",{href:"#",className:"font-bold text-2xl sm:text-3xl flex gap-2",children:[J.jsx("img",{src:lb,alt:"Logo",className:"w-20"}),"Mobile App Manager"]})}),J.jsxs("div",{className:"flex justify-between items-center gap-4",children:[J.jsxs("div",{className:"relative group hidden sm:block",children:[J.jsx("input",{type:"text",placeholder:"search",className:"w-[200px] sm:w-[200px] group-hover:w-[300px] transition-all duration-300 rounded-full border border-gray-300 px-2 py-1 focus:outline-none focus:border-1 focus:border-primary dark:border-gray-500 dark:bg-gray-800  "}),J.jsx(EB,{className:"text-gray-500 group-hover:text-primary absolute top-1/2 -translate-y-1/2 right-3"})]}),J.jsxs("button",{onClick:()=>s(),className:"bg-gradient-to-r from-primary to-secondary transition-all duration-200 text-white  py-1 px-4 rounded-full flex items-center gap-3 group",children:[J.jsx("span",{className:"group-hover:block hidden transition-all duration-200",children:"Logout"}),J.jsx(LB,{className:"text-xl text-white drop-shadow-sm cursor-pointer"})]}),J.jsx("div",{children:J.jsx(FB,{})})]})]})}),J.jsx("div",{"data-aos":"zoom-in",className:"flex justify-center",children:J.jsxs("ul",{className:"sm:flex hidden items-center gap-4",children:[PB.map(e=>J.jsx("li",{children:J.jsx(SB,{to:e.link,className:"inline-block px-4 hover:text-primary duration-200",children:e.name})},e.id)),J.jsxs("li",{className:"group relative cursor-pointer",children:[J.jsxs("a",{href:"#",className:"flex items-center gap-[2px] py-2",children:["Download the Mobile App",J.jsx("span",{children:J.jsx(AB,{className:"transition-all duration-200 group-hover:rotate-180"})})]}),J.jsx("div",{className:"absolute z-[9999] hidden group-hover:block w-[200px] rounded-md bg-white p-2 text-black shadow-md",children:J.jsx("ul",{children:zB.map(e=>J.jsx("li",{children:J.jsx("a",{href:e.link,className:"inline-block w-full rounded-md p-2 hover:bg-primary/20 ",children:e.name})},e.id))})})]})]})})]}),jB="/assets/lbg1-Scvquy-a.jpg",BB="/assets/ot1-09USkySF.jpg",HB="/assets/mcc1-Qta-5-6o.jpg";var cF={},dF={},ub={},pF={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0},t=e;s.default=t})(pF);var VB="Expected a function",yD=NaN,UB="[object Symbol]",_B=/^\s+|\s+$/g,WB=/^[-+]0x[0-9a-f]+$/i,qB=/^0b[01]+$/i,YB=/^0o[0-7]+$/i,QB=parseInt,GB=typeof Ip=="object"&&Ip&&Ip.Object===Object&&Ip,$B=typeof self=="object"&&self&&self.Object===Object&&self,XB=GB||$B||Function("return this")(),KB=Object.prototype,ZB=KB.toString,JB=Math.max,eH=Math.min,uC=function(){return XB.Date.now()};function tH(s,e,t){var i,r,n,a,o,l,h=0,u=!1,c=!1,d=!0;if(typeof s!="function")throw new TypeError(VB);e=bD(e)||0,Tw(t)&&(u=!!t.leading,c="maxWait"in t,n=c?JB(bD(t.maxWait)||0,e):n,d="trailing"in t?!!t.trailing:d);function p(M){var E=i,T=r;return i=r=void 0,h=M,a=s.apply(T,E),a}function f(M){return h=M,o=setTimeout(b,e),u?p(M):a}function v(M){var E=M-l,T=M-h,D=e-E;return c?eH(D,n-T):D}function g(M){var E=M-l,T=M-h;return l===void 0||E>=e||E<0||c&&T>=n}function b(){var M=uC();if(g(M))return y(M);o=setTimeout(b,v(M))}function y(M){return o=void 0,d&&i?p(M):(i=r=void 0,a)}function C(){o!==void 0&&clearTimeout(o),h=0,i=l=r=o=void 0}function x(){return o===void 0?a:y(uC())}function w(){var M=uC(),E=g(M);if(i=arguments,r=this,l=M,E){if(o===void 0)return f(l);if(c)return o=setTimeout(b,e),p(l)}return o===void 0&&(o=setTimeout(b,e)),a}return w.cancel=C,w.flush=x,w}function Tw(s){var e=typeof s;return!!s&&(e=="object"||e=="function")}function iH(s){return!!s&&typeof s=="object"}function rH(s){return typeof s=="symbol"||iH(s)&&ZB.call(s)==UB}function bD(s){if(typeof s=="number")return s;if(rH(s))return yD;if(Tw(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=Tw(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=s.replace(_B,"");var t=qB.test(s);return t||YB.test(s)?QB(s.slice(2),t?2:8):WB.test(s)?yD:+s}var nH=tH,fF={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function t(){for(var n="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(n=r(n,i(o)))}return n}function i(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return t.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var a="";for(var o in n)e.call(n,o)&&n[o]&&(a=r(a,o));return a}function r(n,a){return a?n?n+" "+a:n+a:n}s.exports?(t.default=t,s.exports=t):window.classNames=t})()})(fF);var cb=fF.exports,Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.checkSpecKeys=Ze.checkNavigable=Ze.changeSlide=Ze.canUseDOM=Ze.canGoNext=void 0;Ze.clamp=vF;Ze.swipeStart=Ze.swipeMove=Ze.swipeEnd=Ze.slidesOnRight=Ze.slidesOnLeft=Ze.slideHandler=Ze.siblingDirection=Ze.safePreventDefault=Ze.lazyStartIndex=Ze.lazySlidesOnRight=Ze.lazySlidesOnLeft=Ze.lazyEndIndex=Ze.keyHandler=Ze.initializedState=Ze.getWidth=Ze.getTrackLeft=Ze.getTrackCSS=Ze.getTrackAnimateCSS=Ze.getTotalSlides=Ze.getSwipeDirection=Ze.getSlideCount=Ze.getRequiredLazySlides=Ze.getPreClones=Ze.getPostClones=Ze.getOnDemandLazySlides=Ze.getNavigableIndexes=Ze.getHeight=Ze.extractObject=void 0;var sH=aH(le);function aH(s){return s&&s.__esModule?s:{default:s}}function CD(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,i)}return t}function Zi(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?CD(Object(t),!0).forEach(function(i){oH(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):CD(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function oH(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function vF(s,e,t){return Math.max(e,Math.min(s,t))}var Vh=function(e){var t=["onTouchStart","onTouchMove","onWheel"];t.includes(e._reactName)||e.preventDefault()};Ze.safePreventDefault=Vh;var QE=function(e){for(var t=[],i=GE(e),r=$E(e),n=i;n<r;n++)e.lazyLoadedList.indexOf(n)<0&&t.push(n);return t};Ze.getOnDemandLazySlides=QE;var lH=function(e){for(var t=[],i=GE(e),r=$E(e),n=i;n<r;n++)t.push(n);return t};Ze.getRequiredLazySlides=lH;var GE=function(e){return e.currentSlide-mF(e)};Ze.lazyStartIndex=GE;var $E=function(e){return e.currentSlide+gF(e)};Ze.lazyEndIndex=$E;var mF=function(e){return e.centerMode?Math.floor(e.slidesToShow/2)+(parseInt(e.centerPadding)>0?1:0):0};Ze.lazySlidesOnLeft=mF;var gF=function(e){return e.centerMode?Math.floor((e.slidesToShow-1)/2)+1+(parseInt(e.centerPadding)>0?1:0):e.slidesToShow};Ze.lazySlidesOnRight=gF;var ry=function(e){return e&&e.offsetWidth||0};Ze.getWidth=ry;var XE=function(e){return e&&e.offsetHeight||0};Ze.getHeight=XE;var KE=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i,r,n,a;return i=e.startX-e.curX,r=e.startY-e.curY,n=Math.atan2(r,i),a=Math.round(n*180/Math.PI),a<0&&(a=360-Math.abs(a)),a<=45&&a>=0||a<=360&&a>=315?"left":a>=135&&a<=225?"right":t===!0?a>=35&&a<=135?"up":"down":"vertical"};Ze.getSwipeDirection=KE;var ZE=function(e){var t=!0;return e.infinite||(e.centerMode&&e.currentSlide>=e.slideCount-1||e.slideCount<=e.slidesToShow||e.currentSlide>=e.slideCount-e.slidesToShow)&&(t=!1),t};Ze.canGoNext=ZE;var hH=function(e,t){var i={};return t.forEach(function(r){return i[r]=e[r]}),i};Ze.extractObject=hH;var uH=function(e){var t=sH.default.Children.count(e.children),i=e.listRef,r=Math.ceil(ry(i)),n=e.trackRef&&e.trackRef.node,a=Math.ceil(ry(n)),o;if(e.vertical)o=r;else{var l=e.centerMode&&parseInt(e.centerPadding)*2;typeof e.centerPadding=="string"&&e.centerPadding.slice(-1)==="%"&&(l*=r/100),o=Math.ceil((r-l)/e.slidesToShow)}var h=i&&XE(i.querySelector('[data-index="0"]')),u=h*e.slidesToShow,c=e.currentSlide===void 0?e.initialSlide:e.currentSlide;e.rtl&&e.currentSlide===void 0&&(c=t-1-e.initialSlide);var d=e.lazyLoadedList||[],p=QE(Zi(Zi({},e),{},{currentSlide:c,lazyLoadedList:d}));d=d.concat(p);var f={slideCount:t,slideWidth:o,listWidth:r,trackWidth:a,currentSlide:c,slideHeight:h,listHeight:u,lazyLoadedList:d};return e.autoplaying===null&&e.autoplay&&(f.autoplaying="playing"),f};Ze.initializedState=uH;var cH=function(e){var t=e.waitForAnimate,i=e.animating,r=e.fade,n=e.infinite,a=e.index,o=e.slideCount,l=e.lazyLoad,h=e.currentSlide,u=e.centerMode,c=e.slidesToScroll,d=e.slidesToShow,p=e.useCSS,f=e.lazyLoadedList;if(t&&i)return{};var v=a,g,b,y,C={},x={},w=n?a:vF(a,0,o-1);if(r){if(!n&&(a<0||a>=o))return{};a<0?v=a+o:a>=o&&(v=a-o),l&&f.indexOf(v)<0&&(f=f.concat(v)),C={animating:!0,currentSlide:v,lazyLoadedList:f,targetSlide:v},x={animating:!1,targetSlide:v}}else g=v,v<0?(g=v+o,n?o%c!==0&&(g=o-o%c):g=0):!ZE(e)&&v>h?v=g=h:u&&v>=o?(v=n?o:o-1,g=n?0:o-1):v>=o&&(g=v-o,n?o%c!==0&&(g=0):g=o-d),!n&&v+d>=o&&(g=o-d),b=Ef(Zi(Zi({},e),{},{slideIndex:v})),y=Ef(Zi(Zi({},e),{},{slideIndex:g})),n||(b===y&&(v=g),b=y),l&&(f=f.concat(QE(Zi(Zi({},e),{},{currentSlide:v})))),p?(C={animating:!0,currentSlide:g,trackStyle:JE(Zi(Zi({},e),{},{left:b})),lazyLoadedList:f,targetSlide:w},x={animating:!1,currentSlide:g,trackStyle:Mf(Zi(Zi({},e),{},{left:y})),swipeLeft:null,targetSlide:w}):C={currentSlide:g,trackStyle:Mf(Zi(Zi({},e),{},{left:y})),lazyLoadedList:f,targetSlide:w};return{state:C,nextState:x}};Ze.slideHandler=cH;var dH=function(e,t){var i,r,n,a,o,l=e.slidesToScroll,h=e.slidesToShow,u=e.slideCount,c=e.currentSlide,d=e.targetSlide,p=e.lazyLoad,f=e.infinite;if(a=u%l!==0,i=a?0:(u-c)%l,t.message==="previous")n=i===0?l:h-i,o=c-n,p&&!f&&(r=c-n,o=r===-1?u-1:r),f||(o=d-l);else if(t.message==="next")n=i===0?l:i,o=c+n,p&&!f&&(o=(c+l)%u+i),f||(o=d+l);else if(t.message==="dots")o=t.index*t.slidesToScroll;else if(t.message==="children"){if(o=t.index,f){var v=SF(Zi(Zi({},e),{},{targetSlide:o}));o>t.currentSlide&&v==="left"?o=o-u:o<t.currentSlide&&v==="right"&&(o=o+u)}}else t.message==="index"&&(o=Number(t.index));return o};Ze.changeSlide=dH;var pH=function(e,t,i){return e.target.tagName.match("TEXTAREA|INPUT|SELECT")||!t?"":e.keyCode===37?i?"next":"previous":e.keyCode===39?i?"previous":"next":""};Ze.keyHandler=pH;var fH=function(e,t,i){return e.target.tagName==="IMG"&&Vh(e),!t||!i&&e.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:e.touches?e.touches[0].pageX:e.clientX,startY:e.touches?e.touches[0].pageY:e.clientY,curX:e.touches?e.touches[0].pageX:e.clientX,curY:e.touches?e.touches[0].pageY:e.clientY}}};Ze.swipeStart=fH;var vH=function(e,t){var i=t.scrolling,r=t.animating,n=t.vertical,a=t.swipeToSlide,o=t.verticalSwiping,l=t.rtl,h=t.currentSlide,u=t.edgeFriction,c=t.edgeDragged,d=t.onEdge,p=t.swiped,f=t.swiping,v=t.slideCount,g=t.slidesToScroll,b=t.infinite,y=t.touchObject,C=t.swipeEvent,x=t.listHeight,w=t.listWidth;if(!i){if(r)return Vh(e);n&&a&&o&&Vh(e);var M,E={},T=Ef(t);y.curX=e.touches?e.touches[0].pageX:e.clientX,y.curY=e.touches?e.touches[0].pageY:e.clientY,y.swipeLength=Math.round(Math.sqrt(Math.pow(y.curX-y.startX,2)));var D=Math.round(Math.sqrt(Math.pow(y.curY-y.startY,2)));if(!o&&!f&&D>10)return{scrolling:!0};o&&(y.swipeLength=D);var N=(l?-1:1)*(y.curX>y.startX?1:-1);o&&(N=y.curY>y.startY?1:-1);var A=Math.ceil(v/g),L=KE(t.touchObject,o),k=y.swipeLength;return b||(h===0&&(L==="right"||L==="down")||h+1>=A&&(L==="left"||L==="up")||!ZE(t)&&(L==="left"||L==="up"))&&(k=y.swipeLength*u,c===!1&&d&&(d(L),E.edgeDragged=!0)),!p&&C&&(C(L),E.swiped=!0),n?M=T+k*(x/w)*N:l?M=T-k*N:M=T+k*N,o&&(M=T+k*N),E=Zi(Zi({},E),{},{touchObject:y,swipeLeft:M,trackStyle:Mf(Zi(Zi({},t),{},{left:M}))}),Math.abs(y.curX-y.startX)<Math.abs(y.curY-y.startY)*.8||y.swipeLength>10&&(E.swiping=!0,Vh(e)),E}};Ze.swipeMove=vH;var mH=function(e,t){var i=t.dragging,r=t.swipe,n=t.touchObject,a=t.listWidth,o=t.touchThreshold,l=t.verticalSwiping,h=t.listHeight,u=t.swipeToSlide,c=t.scrolling,d=t.onSwipe,p=t.targetSlide,f=t.currentSlide,v=t.infinite;if(!i)return r&&Vh(e),{};var g=l?h/o:a/o,b=KE(n,l),y={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(c||!n.swipeLength)return y;if(n.swipeLength>g){Vh(e),d&&d(b);var C,x,w=v?f:p;switch(b){case"left":case"up":x=w+Aw(t),C=u?Dw(t,x):x,y.currentDirection=0;break;case"right":case"down":x=w-Aw(t),C=u?Dw(t,x):x,y.currentDirection=1;break;default:C=w}y.triggerSlideHandler=C}else{var M=Ef(t);y.trackStyle=JE(Zi(Zi({},t),{},{left:M}))}return y};Ze.swipeEnd=mH;var yF=function(e){for(var t=e.infinite?e.slideCount*2:e.slideCount,i=e.infinite?e.slidesToShow*-1:0,r=e.infinite?e.slidesToShow*-1:0,n=[];i<t;)n.push(i),i=r+e.slidesToScroll,r+=Math.min(e.slidesToScroll,e.slidesToShow);return n};Ze.getNavigableIndexes=yF;var Dw=function(e,t){var i=yF(e),r=0;if(t>i[i.length-1])t=i[i.length-1];else for(var n in i){if(t<i[n]){t=r;break}r=i[n]}return t};Ze.checkNavigable=Dw;var Aw=function(e){var t=e.centerMode?e.slideWidth*Math.floor(e.slidesToShow/2):0;if(e.swipeToSlide){var i,r=e.listRef,n=r.querySelectorAll&&r.querySelectorAll(".slick-slide")||[];if(Array.from(n).every(function(l){if(e.vertical){if(l.offsetTop+XE(l)/2>e.swipeLeft*-1)return i=l,!1}else if(l.offsetLeft-t+ry(l)/2>e.swipeLeft*-1)return i=l,!1;return!0}),!i)return 0;var a=e.rtl===!0?e.slideCount-e.currentSlide:e.currentSlide,o=Math.abs(i.dataset.index-a)||1;return o}else return e.slidesToScroll};Ze.getSlideCount=Aw;var db=function(e,t){return t.reduce(function(i,r){return i&&e.hasOwnProperty(r)},!0)?null:console.error("Keys Missing:",e)};Ze.checkSpecKeys=db;var Mf=function(e){db(e,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var t,i,r=e.slideCount+2*e.slidesToShow;e.vertical?i=r*e.slideHeight:t=CF(e)*e.slideWidth;var n={opacity:1,transition:"",WebkitTransition:""};if(e.useTransform){var a=e.vertical?"translate3d(0px, "+e.left+"px, 0px)":"translate3d("+e.left+"px, 0px, 0px)",o=e.vertical?"translate3d(0px, "+e.left+"px, 0px)":"translate3d("+e.left+"px, 0px, 0px)",l=e.vertical?"translateY("+e.left+"px)":"translateX("+e.left+"px)";n=Zi(Zi({},n),{},{WebkitTransform:a,transform:o,msTransform:l})}else e.vertical?n.top=e.left:n.left=e.left;return e.fade&&(n={opacity:1}),t&&(n.width=t),i&&(n.height=i),window&&!window.addEventListener&&window.attachEvent&&(e.vertical?n.marginTop=e.left+"px":n.marginLeft=e.left+"px"),n};Ze.getTrackCSS=Mf;var JE=function(e){db(e,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var t=Mf(e);return e.useTransform?(t.WebkitTransition="-webkit-transform "+e.speed+"ms "+e.cssEase,t.transition="transform "+e.speed+"ms "+e.cssEase):e.vertical?t.transition="top "+e.speed+"ms "+e.cssEase:t.transition="left "+e.speed+"ms "+e.cssEase,t};Ze.getTrackAnimateCSS=JE;var Ef=function(e){if(e.unslick)return 0;db(e,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var t=e.slideIndex,i=e.trackRef,r=e.infinite,n=e.centerMode,a=e.slideCount,o=e.slidesToShow,l=e.slidesToScroll,h=e.slideWidth,u=e.listWidth,c=e.variableWidth,d=e.slideHeight,p=e.fade,f=e.vertical,v=0,g,b,y=0;if(p||e.slideCount===1)return 0;var C=0;if(r?(C=-Wp(e),a%l!==0&&t+l>a&&(C=-(t>a?o-(t-a):a%l)),n&&(C+=parseInt(o/2))):(a%l!==0&&t+l>a&&(C=o-a%l),n&&(C=parseInt(o/2))),v=C*h,y=C*d,f?g=t*d*-1+y:g=t*h*-1+v,c===!0){var x,w=i&&i.node;if(x=t+Wp(e),b=w&&w.childNodes[x],g=b?b.offsetLeft*-1:0,n===!0){x=r?t+Wp(e):t,b=w&&w.children[x],g=0;for(var M=0;M<x;M++)g-=w&&w.children[M]&&w.children[M].offsetWidth;g-=parseInt(e.centerPadding),g+=b&&(u-b.offsetWidth)/2}}return g};Ze.getTrackLeft=Ef;var Wp=function(e){return e.unslick||!e.infinite?0:e.variableWidth?e.slideCount:e.slidesToShow+(e.centerMode?1:0)};Ze.getPreClones=Wp;var bF=function(e){return e.unslick||!e.infinite?0:e.slideCount};Ze.getPostClones=bF;var CF=function(e){return e.slideCount===1?1:Wp(e)+e.slideCount+bF(e)};Ze.getTotalSlides=CF;var SF=function(e){return e.targetSlide>e.currentSlide?e.targetSlide>e.currentSlide+xF(e)?"left":"right":e.targetSlide<e.currentSlide-wF(e)?"right":"left"};Ze.siblingDirection=SF;var xF=function(e){var t=e.slidesToShow,i=e.centerMode,r=e.rtl,n=e.centerPadding;if(i){var a=(t-1)/2+1;return parseInt(n)>0&&(a+=1),r&&t%2===0&&(a+=1),a}return r?0:t-1};Ze.slidesOnRight=xF;var wF=function(e){var t=e.slidesToShow,i=e.centerMode,r=e.rtl,n=e.centerPadding;if(i){var a=(t-1)/2+1;return parseInt(n)>0&&(a+=1),!r&&t%2===0&&(a+=1),a}return r?t-1:0};Ze.slidesOnLeft=wF;var gH=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)};Ze.canUseDOM=gH;var pb={};function Nw(s){"@babel/helpers - typeof";return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nw(s)}Object.defineProperty(pb,"__esModule",{value:!0});pb.Track=void 0;var gl=MF(le),cC=MF(cb),dC=Ze;function MF(s){return s&&s.__esModule?s:{default:s}}function kw(){return kw=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},kw.apply(this,arguments)}function yH(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function SD(s,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function bH(s,e,t){return e&&SD(s.prototype,e),t&&SD(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function CH(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Lw(s,e)}function Lw(s,e){return Lw=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Lw(s,e)}function SH(s){var e=wH();return function(){var i=ny(s),r;if(e){var n=ny(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return xH(this,r)}}function xH(s,e){if(e&&(Nw(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ow(s)}function Ow(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function wH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ny(s){return ny=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ny(s)}function xD(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,i)}return t}function Jn(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xD(Object(t),!0).forEach(function(i){Rw(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):xD(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Rw(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var pC=function(e){var t,i,r,n,a;e.rtl?a=e.slideCount-1-e.index:a=e.index,r=a<0||a>=e.slideCount,e.centerMode?(n=Math.floor(e.slidesToShow/2),i=(a-e.currentSlide)%e.slideCount===0,a>e.currentSlide-n-1&&a<=e.currentSlide+n&&(t=!0)):t=e.currentSlide<=a&&a<e.currentSlide+e.slidesToShow;var o;e.targetSlide<0?o=e.targetSlide+e.slideCount:e.targetSlide>=e.slideCount?o=e.targetSlide-e.slideCount:o=e.targetSlide;var l=a===o;return{"slick-slide":!0,"slick-active":t,"slick-center":i,"slick-cloned":r,"slick-current":l}},MH=function(e){var t={};return(e.variableWidth===void 0||e.variableWidth===!1)&&(t.width=e.slideWidth),e.fade&&(t.position="relative",e.vertical?t.top=-e.index*parseInt(e.slideHeight):t.left=-e.index*parseInt(e.slideWidth),t.opacity=e.currentSlide===e.index?1:0,e.useCSS&&(t.transition="opacity "+e.speed+"ms "+e.cssEase+", visibility "+e.speed+"ms "+e.cssEase)),t},fC=function(e,t){return e.key||t},EH=function(e){var t,i=[],r=[],n=[],a=gl.default.Children.count(e.children),o=(0,dC.lazyStartIndex)(e),l=(0,dC.lazyEndIndex)(e);return gl.default.Children.forEach(e.children,function(h,u){var c,d={message:"children",index:u,slidesToScroll:e.slidesToScroll,currentSlide:e.currentSlide};!e.lazyLoad||e.lazyLoad&&e.lazyLoadedList.indexOf(u)>=0?c=h:c=gl.default.createElement("div",null);var p=MH(Jn(Jn({},e),{},{index:u})),f=c.props.className||"",v=pC(Jn(Jn({},e),{},{index:u}));if(i.push(gl.default.cloneElement(c,{key:"original"+fC(c,u),"data-index":u,className:(0,cC.default)(v,f),tabIndex:"-1","aria-hidden":!v["slick-active"],style:Jn(Jn({outline:"none"},c.props.style||{}),p),onClick:function(y){c.props&&c.props.onClick&&c.props.onClick(y),e.focusOnSelect&&e.focusOnSelect(d)}})),e.infinite&&e.fade===!1){var g=a-u;g<=(0,dC.getPreClones)(e)&&a!==e.slidesToShow&&(t=-g,t>=o&&(c=h),v=pC(Jn(Jn({},e),{},{index:t})),r.push(gl.default.cloneElement(c,{key:"precloned"+fC(c,t),"data-index":t,tabIndex:"-1",className:(0,cC.default)(v,f),"aria-hidden":!v["slick-active"],style:Jn(Jn({},c.props.style||{}),p),onClick:function(y){c.props&&c.props.onClick&&c.props.onClick(y),e.focusOnSelect&&e.focusOnSelect(d)}}))),a!==e.slidesToShow&&(t=a+u,t<l&&(c=h),v=pC(Jn(Jn({},e),{},{index:t})),n.push(gl.default.cloneElement(c,{key:"postcloned"+fC(c,t),"data-index":t,tabIndex:"-1",className:(0,cC.default)(v,f),"aria-hidden":!v["slick-active"],style:Jn(Jn({},c.props.style||{}),p),onClick:function(y){c.props&&c.props.onClick&&c.props.onClick(y),e.focusOnSelect&&e.focusOnSelect(d)}})))}}),e.rtl?r.concat(i,n).reverse():r.concat(i,n)},IH=function(s){CH(t,s);var e=SH(t);function t(){var i;yH(this,t);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),Rw(Ow(i),"node",null),Rw(Ow(i),"handleRef",function(o){i.node=o}),i}return bH(t,[{key:"render",value:function(){var r=EH(this.props),n=this.props,a=n.onMouseEnter,o=n.onMouseOver,l=n.onMouseLeave,h={onMouseEnter:a,onMouseOver:o,onMouseLeave:l};return gl.default.createElement("div",kw({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},h),r)}}]),t}(gl.default.PureComponent);pb.Track=IH;var fb={};function Fw(s){"@babel/helpers - typeof";return Fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fw(s)}Object.defineProperty(fb,"__esModule",{value:!0});fb.Dots=void 0;var $v=EF(le),TH=EF(cb),wD=Ze;function EF(s){return s&&s.__esModule?s:{default:s}}function MD(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,i)}return t}function DH(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?MD(Object(t),!0).forEach(function(i){AH(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):MD(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function AH(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function NH(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function ED(s,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function kH(s,e,t){return e&&ED(s.prototype,e),t&&ED(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function LH(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Pw(s,e)}function Pw(s,e){return Pw=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Pw(s,e)}function OH(s){var e=PH();return function(){var i=sy(s),r;if(e){var n=sy(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return RH(this,r)}}function RH(s,e){if(e&&(Fw(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FH(s)}function FH(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function PH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sy(s){return sy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},sy(s)}var zH=function(e){var t;return e.infinite?t=Math.ceil(e.slideCount/e.slidesToScroll):t=Math.ceil((e.slideCount-e.slidesToShow)/e.slidesToScroll)+1,t},jH=function(s){LH(t,s);var e=OH(t);function t(){return NH(this,t),e.apply(this,arguments)}return kH(t,[{key:"clickHandler",value:function(r,n){n.preventDefault(),this.props.clickHandler(r)}},{key:"render",value:function(){for(var r=this.props,n=r.onMouseEnter,a=r.onMouseOver,o=r.onMouseLeave,l=r.infinite,h=r.slidesToScroll,u=r.slidesToShow,c=r.slideCount,d=r.currentSlide,p=zH({slideCount:c,slidesToScroll:h,slidesToShow:u,infinite:l}),f={onMouseEnter:n,onMouseOver:a,onMouseLeave:o},v=[],g=0;g<p;g++){var b=(g+1)*h-1,y=l?b:(0,wD.clamp)(b,0,c-1),C=y-(h-1),x=l?C:(0,wD.clamp)(C,0,c-1),w=(0,TH.default)({"slick-active":l?d>=x&&d<=y:d===x}),M={message:"dots",index:g,slidesToScroll:h,currentSlide:d},E=this.clickHandler.bind(this,M);v=v.concat($v.default.createElement("li",{key:g,className:w},$v.default.cloneElement(this.props.customPaging(g),{onClick:E})))}return $v.default.cloneElement(this.props.appendDots(v),DH({className:this.props.dotsClass},f))}}]),t}($v.default.PureComponent);fb.Dots=jH;var rd={};function zw(s){"@babel/helpers - typeof";return zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zw(s)}Object.defineProperty(rd,"__esModule",{value:!0});rd.PrevArrow=rd.NextArrow=void 0;var zc=TF(le),IF=TF(cb),BH=Ze;function TF(s){return s&&s.__esModule?s:{default:s}}function ay(){return ay=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},ay.apply(this,arguments)}function ID(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,i)}return t}function oy(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ID(Object(t),!0).forEach(function(i){HH(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):ID(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function HH(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function DF(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function TD(s,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function AF(s,e,t){return e&&TD(s.prototype,e),t&&TD(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function NF(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&jw(s,e)}function jw(s,e){return jw=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},jw(s,e)}function kF(s){var e=_H();return function(){var i=ly(s),r;if(e){var n=ly(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return VH(this,r)}}function VH(s,e){if(e&&(zw(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UH(s)}function UH(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function _H(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ly(s){return ly=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ly(s)}var WH=function(s){NF(t,s);var e=kF(t);function t(){return DF(this,t),e.apply(this,arguments)}return AF(t,[{key:"clickHandler",value:function(r,n){n&&n.preventDefault(),this.props.clickHandler(r,n)}},{key:"render",value:function(){var r={"slick-arrow":!0,"slick-prev":!0},n=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(r["slick-disabled"]=!0,n=null);var a={key:"0","data-role":"none",className:(0,IF.default)(r),style:{display:"block"},onClick:n},o={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},l;return this.props.prevArrow?l=zc.default.cloneElement(this.props.prevArrow,oy(oy({},a),o)):l=zc.default.createElement("button",ay({key:"0",type:"button"},a)," ","Previous"),l}}]),t}(zc.default.PureComponent);rd.PrevArrow=WH;var qH=function(s){NF(t,s);var e=kF(t);function t(){return DF(this,t),e.apply(this,arguments)}return AF(t,[{key:"clickHandler",value:function(r,n){n&&n.preventDefault(),this.props.clickHandler(r,n)}},{key:"render",value:function(){var r={"slick-arrow":!0,"slick-next":!0},n=this.clickHandler.bind(this,{message:"next"});(0,BH.canGoNext)(this.props)||(r["slick-disabled"]=!0,n=null);var a={key:"1","data-role":"none",className:(0,IF.default)(r),style:{display:"block"},onClick:n},o={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},l;return this.props.nextArrow?l=zc.default.cloneElement(this.props.nextArrow,oy(oy({},a),o)):l=zc.default.createElement("button",ay({key:"1",type:"button"},a)," ","Next"),l}}]),t}(zc.default.PureComponent);rd.NextArrow=qH;var LF=function(){if(typeof Map<"u")return Map;function s(e,t){var i=-1;return e.some(function(r,n){return r[0]===t?(i=n,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var i=s(this.__entries__,t),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(t,i){var r=s(this.__entries__,t);~r?this.__entries__[r][1]=i:this.__entries__.push([t,i])},e.prototype.delete=function(t){var i=this.__entries__,r=s(i,t);~r&&i.splice(r,1)},e.prototype.has=function(t){return!!~s(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,i){i===void 0&&(i=null);for(var r=0,n=this.__entries__;r<n.length;r++){var a=n[r];t.call(i,a[1],a[0])}},e}()}(),Bw=typeof window<"u"&&typeof document<"u"&&window.document===document,hy=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),YH=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(hy):function(s){return setTimeout(function(){return s(Date.now())},1e3/60)}}(),QH=2;function GH(s,e){var t=!1,i=!1,r=0;function n(){t&&(t=!1,s()),i&&o()}function a(){YH(n)}function o(){var l=Date.now();if(t){if(l-r<QH)return;i=!0}else t=!0,i=!1,setTimeout(a,e);r=l}return o}var $H=20,XH=["top","right","bottom","left","width","height","size","weight"],KH=typeof MutationObserver<"u",ZH=function(){function s(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=GH(this.refresh.bind(this),$H)}return s.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},s.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},s.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},s.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},s.prototype.connect_=function(){!Bw||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),KH?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},s.prototype.disconnect_=function(){!Bw||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},s.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=t===void 0?"":t,r=XH.some(function(n){return!!~i.indexOf(n)});r&&this.refresh()},s.getInstance=function(){return this.instance_||(this.instance_=new s),this.instance_},s.instance_=null,s}(),OF=function(s,e){for(var t=0,i=Object.keys(e);t<i.length;t++){var r=i[t];Object.defineProperty(s,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return s},nd=function(s){var e=s&&s.ownerDocument&&s.ownerDocument.defaultView;return e||hy},RF=vb(0,0,0,0);function uy(s){return parseFloat(s)||0}function DD(s){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(i,r){var n=s["border-"+r+"-width"];return i+uy(n)},0)}function JH(s){for(var e=["top","right","bottom","left"],t={},i=0,r=e;i<r.length;i++){var n=r[i],a=s["padding-"+n];t[n]=uy(a)}return t}function eV(s){var e=s.getBBox();return vb(0,0,e.width,e.height)}function tV(s){var e=s.clientWidth,t=s.clientHeight;if(!e&&!t)return RF;var i=nd(s).getComputedStyle(s),r=JH(i),n=r.left+r.right,a=r.top+r.bottom,o=uy(i.width),l=uy(i.height);if(i.boxSizing==="border-box"&&(Math.round(o+n)!==e&&(o-=DD(i,"left","right")+n),Math.round(l+a)!==t&&(l-=DD(i,"top","bottom")+a)),!rV(s)){var h=Math.round(o+n)-e,u=Math.round(l+a)-t;Math.abs(h)!==1&&(o-=h),Math.abs(u)!==1&&(l-=u)}return vb(r.left,r.top,o,l)}var iV=function(){return typeof SVGGraphicsElement<"u"?function(s){return s instanceof nd(s).SVGGraphicsElement}:function(s){return s instanceof nd(s).SVGElement&&typeof s.getBBox=="function"}}();function rV(s){return s===nd(s).document.documentElement}function nV(s){return Bw?iV(s)?eV(s):tV(s):RF}function sV(s){var e=s.x,t=s.y,i=s.width,r=s.height,n=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(n.prototype);return OF(a,{x:e,y:t,width:i,height:r,top:t,right:e+i,bottom:r+t,left:e}),a}function vb(s,e,t,i){return{x:s,y:e,width:t,height:i}}var aV=function(){function s(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=vb(0,0,0,0),this.target=e}return s.prototype.isActive=function(){var e=nV(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},s.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},s}(),oV=function(){function s(e,t){var i=sV(t);OF(this,{target:e,contentRect:i})}return s}(),lV=function(){function s(e,t,i){if(this.activeObservations_=[],this.observations_=new LF,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return s.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof nd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new aV(e)),this.controller_.addObserver(this),this.controller_.refresh())}},s.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof nd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},s.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},s.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},s.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(i){return new oV(i.target,i.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},s.prototype.clearActive=function(){this.activeObservations_.splice(0)},s.prototype.hasActive=function(){return this.activeObservations_.length>0},s}(),FF=typeof WeakMap<"u"?new WeakMap:new LF,PF=function(){function s(e){if(!(this instanceof s))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=ZH.getInstance(),i=new lV(e,t,this);FF.set(this,i)}return s}();["observe","unobserve","disconnect"].forEach(function(s){PF.prototype[s]=function(){var e;return(e=FF.get(this))[s].apply(e,arguments)}});var hV=function(){return typeof hy.ResizeObserver<"u"?hy.ResizeObserver:PF}();const uV=Object.freeze(Object.defineProperty({__proto__:null,default:hV},Symbol.toStringTag,{value:"Module"})),cV=Z2(uV);Object.defineProperty(ub,"__esModule",{value:!0});ub.InnerSlider=void 0;var Hn=bv(le),dV=bv(pF),pV=bv(nH),fV=bv(cb),rr=Ze,vV=pb,mV=fb,AD=rd,gV=bv(cV);function bv(s){return s&&s.__esModule?s:{default:s}}function cy(s){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cy(s)}function dy(){return dy=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},dy.apply(this,arguments)}function yV(s,e){if(s==null)return{};var t=bV(s,e),i,r;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(r=0;r<n.length;r++)i=n[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(t[i]=s[i])}return t}function bV(s,e){if(s==null)return{};var t={},i=Object.keys(s),r,n;for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&(t[r]=s[r]);return t}function ND(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,i)}return t}function wt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ND(Object(t),!0).forEach(function(i){Zt(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):ND(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function CV(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function kD(s,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function SV(s,e,t){return e&&kD(s.prototype,e),t&&kD(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function xV(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Hw(s,e)}function Hw(s,e){return Hw=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Hw(s,e)}function wV(s){var e=EV();return function(){var i=py(s),r;if(e){var n=py(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return MV(this,r)}}function MV(s,e){if(e&&(cy(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kt(s)}function Kt(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function EV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function py(s){return py=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},py(s)}function Zt(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var IV=function(s){xV(t,s);var e=wV(t);function t(i){var r;CV(this,t),r=e.call(this,i),Zt(Kt(r),"listRefHandler",function(a){return r.list=a}),Zt(Kt(r),"trackRefHandler",function(a){return r.track=a}),Zt(Kt(r),"adaptHeight",function(){if(r.props.adaptiveHeight&&r.list){var a=r.list.querySelector('[data-index="'.concat(r.state.currentSlide,'"]'));r.list.style.height=(0,rr.getHeight)(a)+"px"}}),Zt(Kt(r),"componentDidMount",function(){if(r.props.onInit&&r.props.onInit(),r.props.lazyLoad){var a=(0,rr.getOnDemandLazySlides)(wt(wt({},r.props),r.state));a.length>0&&(r.setState(function(l){return{lazyLoadedList:l.lazyLoadedList.concat(a)}}),r.props.onLazyLoad&&r.props.onLazyLoad(a))}var o=wt({listRef:r.list,trackRef:r.track},r.props);r.updateState(o,!0,function(){r.adaptHeight(),r.props.autoplay&&r.autoPlay("update")}),r.props.lazyLoad==="progressive"&&(r.lazyLoadTimer=setInterval(r.progressiveLazyLoad,1e3)),r.ro=new gV.default(function(){r.state.animating?(r.onWindowResized(!1),r.callbackTimers.push(setTimeout(function(){return r.onWindowResized()},r.props.speed))):r.onWindowResized()}),r.ro.observe(r.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(l){l.onfocus=r.props.pauseOnFocus?r.onSlideFocus:null,l.onblur=r.props.pauseOnFocus?r.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",r.onWindowResized):window.attachEvent("onresize",r.onWindowResized)}),Zt(Kt(r),"componentWillUnmount",function(){r.animationEndCallback&&clearTimeout(r.animationEndCallback),r.lazyLoadTimer&&clearInterval(r.lazyLoadTimer),r.callbackTimers.length&&(r.callbackTimers.forEach(function(a){return clearTimeout(a)}),r.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",r.onWindowResized):window.detachEvent("onresize",r.onWindowResized),r.autoplayTimer&&clearInterval(r.autoplayTimer),r.ro.disconnect()}),Zt(Kt(r),"componentDidUpdate",function(a){if(r.checkImagesLoad(),r.props.onReInit&&r.props.onReInit(),r.props.lazyLoad){var o=(0,rr.getOnDemandLazySlides)(wt(wt({},r.props),r.state));o.length>0&&(r.setState(function(u){return{lazyLoadedList:u.lazyLoadedList.concat(o)}}),r.props.onLazyLoad&&r.props.onLazyLoad(o))}r.adaptHeight();var l=wt(wt({listRef:r.list,trackRef:r.track},r.props),r.state),h=r.didPropsChange(a);h&&r.updateState(l,h,function(){r.state.currentSlide>=Hn.default.Children.count(r.props.children)&&r.changeSlide({message:"index",index:Hn.default.Children.count(r.props.children)-r.props.slidesToShow,currentSlide:r.state.currentSlide}),r.props.autoplay?r.autoPlay("update"):r.pause("paused")})}),Zt(Kt(r),"onWindowResized",function(a){r.debouncedResize&&r.debouncedResize.cancel(),r.debouncedResize=(0,pV.default)(function(){return r.resizeWindow(a)},50),r.debouncedResize()}),Zt(Kt(r),"resizeWindow",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,o=!!(r.track&&r.track.node);if(o){var l=wt(wt({listRef:r.list,trackRef:r.track},r.props),r.state);r.updateState(l,a,function(){r.props.autoplay?r.autoPlay("update"):r.pause("paused")}),r.setState({animating:!1}),clearTimeout(r.animationEndCallback),delete r.animationEndCallback}}),Zt(Kt(r),"updateState",function(a,o,l){var h=(0,rr.initializedState)(a);a=wt(wt(wt({},a),h),{},{slideIndex:h.currentSlide});var u=(0,rr.getTrackLeft)(a);a=wt(wt({},a),{},{left:u});var c=(0,rr.getTrackCSS)(a);(o||Hn.default.Children.count(r.props.children)!==Hn.default.Children.count(a.children))&&(h.trackStyle=c),r.setState(h,l)}),Zt(Kt(r),"ssrInit",function(){if(r.props.variableWidth){var a=0,o=0,l=[],h=(0,rr.getPreClones)(wt(wt(wt({},r.props),r.state),{},{slideCount:r.props.children.length})),u=(0,rr.getPostClones)(wt(wt(wt({},r.props),r.state),{},{slideCount:r.props.children.length}));r.props.children.forEach(function(E){l.push(E.props.style.width),a+=E.props.style.width});for(var c=0;c<h;c++)o+=l[l.length-1-c],a+=l[l.length-1-c];for(var d=0;d<u;d++)a+=l[d];for(var p=0;p<r.state.currentSlide;p++)o+=l[p];var f={width:a+"px",left:-o+"px"};if(r.props.centerMode){var v="".concat(l[r.state.currentSlide],"px");f.left="calc(".concat(f.left," + (100% - ").concat(v,") / 2 ) ")}return{trackStyle:f}}var g=Hn.default.Children.count(r.props.children),b=wt(wt(wt({},r.props),r.state),{},{slideCount:g}),y=(0,rr.getPreClones)(b)+(0,rr.getPostClones)(b)+g,C=100/r.props.slidesToShow*y,x=100/y,w=-x*((0,rr.getPreClones)(b)+r.state.currentSlide)*C/100;r.props.centerMode&&(w+=(100-x*C/100)/2);var M={width:C+"%",left:w+"%"};return{slideWidth:x+"%",trackStyle:M}}),Zt(Kt(r),"checkImagesLoad",function(){var a=r.list&&r.list.querySelectorAll&&r.list.querySelectorAll(".slick-slide img")||[],o=a.length,l=0;Array.prototype.forEach.call(a,function(h){var u=function(){return++l&&l>=o&&r.onWindowResized()};if(!h.onclick)h.onclick=function(){return h.parentNode.focus()};else{var c=h.onclick;h.onclick=function(){c(),h.parentNode.focus()}}h.onload||(r.props.lazyLoad?h.onload=function(){r.adaptHeight(),r.callbackTimers.push(setTimeout(r.onWindowResized,r.props.speed))}:(h.onload=u,h.onerror=function(){u(),r.props.onLazyLoadError&&r.props.onLazyLoadError()}))})}),Zt(Kt(r),"progressiveLazyLoad",function(){for(var a=[],o=wt(wt({},r.props),r.state),l=r.state.currentSlide;l<r.state.slideCount+(0,rr.getPostClones)(o);l++)if(r.state.lazyLoadedList.indexOf(l)<0){a.push(l);break}for(var h=r.state.currentSlide-1;h>=-(0,rr.getPreClones)(o);h--)if(r.state.lazyLoadedList.indexOf(h)<0){a.push(h);break}a.length>0?(r.setState(function(u){return{lazyLoadedList:u.lazyLoadedList.concat(a)}}),r.props.onLazyLoad&&r.props.onLazyLoad(a)):r.lazyLoadTimer&&(clearInterval(r.lazyLoadTimer),delete r.lazyLoadTimer)}),Zt(Kt(r),"slideHandler",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=r.props,h=l.asNavFor,u=l.beforeChange,c=l.onLazyLoad,d=l.speed,p=l.afterChange,f=r.state.currentSlide,v=(0,rr.slideHandler)(wt(wt(wt({index:a},r.props),r.state),{},{trackRef:r.track,useCSS:r.props.useCSS&&!o})),g=v.state,b=v.nextState;if(g){u&&u(f,g.currentSlide);var y=g.lazyLoadedList.filter(function(C){return r.state.lazyLoadedList.indexOf(C)<0});c&&y.length>0&&c(y),!r.props.waitForAnimate&&r.animationEndCallback&&(clearTimeout(r.animationEndCallback),p&&p(f),delete r.animationEndCallback),r.setState(g,function(){h&&r.asNavForIndex!==a&&(r.asNavForIndex=a,h.innerSlider.slideHandler(a)),b&&(r.animationEndCallback=setTimeout(function(){var C=b.animating,x=yV(b,["animating"]);r.setState(x,function(){r.callbackTimers.push(setTimeout(function(){return r.setState({animating:C})},10)),p&&p(g.currentSlide),delete r.animationEndCallback})},d))})}}),Zt(Kt(r),"changeSlide",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=wt(wt({},r.props),r.state),h=(0,rr.changeSlide)(l,a);if(!(h!==0&&!h)&&(o===!0?r.slideHandler(h,o):r.slideHandler(h),r.props.autoplay&&r.autoPlay("update"),r.props.focusOnSelect)){var u=r.list.querySelectorAll(".slick-current");u[0]&&u[0].focus()}}),Zt(Kt(r),"clickHandler",function(a){r.clickable===!1&&(a.stopPropagation(),a.preventDefault()),r.clickable=!0}),Zt(Kt(r),"keyHandler",function(a){var o=(0,rr.keyHandler)(a,r.props.accessibility,r.props.rtl);o!==""&&r.changeSlide({message:o})}),Zt(Kt(r),"selectHandler",function(a){r.changeSlide(a)}),Zt(Kt(r),"disableBodyScroll",function(){var a=function(l){l=l||window.event,l.preventDefault&&l.preventDefault(),l.returnValue=!1};window.ontouchmove=a}),Zt(Kt(r),"enableBodyScroll",function(){window.ontouchmove=null}),Zt(Kt(r),"swipeStart",function(a){r.props.verticalSwiping&&r.disableBodyScroll();var o=(0,rr.swipeStart)(a,r.props.swipe,r.props.draggable);o!==""&&r.setState(o)}),Zt(Kt(r),"swipeMove",function(a){var o=(0,rr.swipeMove)(a,wt(wt(wt({},r.props),r.state),{},{trackRef:r.track,listRef:r.list,slideIndex:r.state.currentSlide}));o&&(o.swiping&&(r.clickable=!1),r.setState(o))}),Zt(Kt(r),"swipeEnd",function(a){var o=(0,rr.swipeEnd)(a,wt(wt(wt({},r.props),r.state),{},{trackRef:r.track,listRef:r.list,slideIndex:r.state.currentSlide}));if(o){var l=o.triggerSlideHandler;delete o.triggerSlideHandler,r.setState(o),l!==void 0&&(r.slideHandler(l),r.props.verticalSwiping&&r.enableBodyScroll())}}),Zt(Kt(r),"touchEnd",function(a){r.swipeEnd(a),r.clickable=!0}),Zt(Kt(r),"slickPrev",function(){r.callbackTimers.push(setTimeout(function(){return r.changeSlide({message:"previous"})},0))}),Zt(Kt(r),"slickNext",function(){r.callbackTimers.push(setTimeout(function(){return r.changeSlide({message:"next"})},0))}),Zt(Kt(r),"slickGoTo",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a=Number(a),isNaN(a))return"";r.callbackTimers.push(setTimeout(function(){return r.changeSlide({message:"index",index:a,currentSlide:r.state.currentSlide},o)},0))}),Zt(Kt(r),"play",function(){var a;if(r.props.rtl)a=r.state.currentSlide-r.props.slidesToScroll;else if((0,rr.canGoNext)(wt(wt({},r.props),r.state)))a=r.state.currentSlide+r.props.slidesToScroll;else return!1;r.slideHandler(a)}),Zt(Kt(r),"autoPlay",function(a){r.autoplayTimer&&clearInterval(r.autoplayTimer);var o=r.state.autoplaying;if(a==="update"){if(o==="hovered"||o==="focused"||o==="paused")return}else if(a==="leave"){if(o==="paused"||o==="focused")return}else if(a==="blur"&&(o==="paused"||o==="hovered"))return;r.autoplayTimer=setInterval(r.play,r.props.autoplaySpeed+50),r.setState({autoplaying:"playing"})}),Zt(Kt(r),"pause",function(a){r.autoplayTimer&&(clearInterval(r.autoplayTimer),r.autoplayTimer=null);var o=r.state.autoplaying;a==="paused"?r.setState({autoplaying:"paused"}):a==="focused"?(o==="hovered"||o==="playing")&&r.setState({autoplaying:"focused"}):o==="playing"&&r.setState({autoplaying:"hovered"})}),Zt(Kt(r),"onDotsOver",function(){return r.props.autoplay&&r.pause("hovered")}),Zt(Kt(r),"onDotsLeave",function(){return r.props.autoplay&&r.state.autoplaying==="hovered"&&r.autoPlay("leave")}),Zt(Kt(r),"onTrackOver",function(){return r.props.autoplay&&r.pause("hovered")}),Zt(Kt(r),"onTrackLeave",function(){return r.props.autoplay&&r.state.autoplaying==="hovered"&&r.autoPlay("leave")}),Zt(Kt(r),"onSlideFocus",function(){return r.props.autoplay&&r.pause("focused")}),Zt(Kt(r),"onSlideBlur",function(){return r.props.autoplay&&r.state.autoplaying==="focused"&&r.autoPlay("blur")}),Zt(Kt(r),"render",function(){var a=(0,fV.default)("slick-slider",r.props.className,{"slick-vertical":r.props.vertical,"slick-initialized":!0}),o=wt(wt({},r.props),r.state),l=(0,rr.extractObject)(o,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),h=r.props.pauseOnHover;l=wt(wt({},l),{},{onMouseEnter:h?r.onTrackOver:null,onMouseLeave:h?r.onTrackLeave:null,onMouseOver:h?r.onTrackOver:null,focusOnSelect:r.props.focusOnSelect&&r.clickable?r.selectHandler:null});var u;if(r.props.dots===!0&&r.state.slideCount>=r.props.slidesToShow){var c=(0,rr.extractObject)(o,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),d=r.props.pauseOnDotsHover;c=wt(wt({},c),{},{clickHandler:r.changeSlide,onMouseEnter:d?r.onDotsLeave:null,onMouseOver:d?r.onDotsOver:null,onMouseLeave:d?r.onDotsLeave:null}),u=Hn.default.createElement(mV.Dots,c)}var p,f,v=(0,rr.extractObject)(o,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);v.clickHandler=r.changeSlide,r.props.arrows&&(p=Hn.default.createElement(AD.PrevArrow,v),f=Hn.default.createElement(AD.NextArrow,v));var g=null;r.props.vertical&&(g={height:r.state.listHeight});var b=null;r.props.vertical===!1?r.props.centerMode===!0&&(b={padding:"0px "+r.props.centerPadding}):r.props.centerMode===!0&&(b={padding:r.props.centerPadding+" 0px"});var y=wt(wt({},g),b),C=r.props.touchMove,x={className:"slick-list",style:y,onClick:r.clickHandler,onMouseDown:C?r.swipeStart:null,onMouseMove:r.state.dragging&&C?r.swipeMove:null,onMouseUp:C?r.swipeEnd:null,onMouseLeave:r.state.dragging&&C?r.swipeEnd:null,onTouchStart:C?r.swipeStart:null,onTouchMove:r.state.dragging&&C?r.swipeMove:null,onTouchEnd:C?r.touchEnd:null,onTouchCancel:r.state.dragging&&C?r.swipeEnd:null,onKeyDown:r.props.accessibility?r.keyHandler:null},w={className:a,dir:"ltr",style:r.props.style};return r.props.unslick&&(x={className:"slick-list"},w={className:a}),Hn.default.createElement("div",w,r.props.unslick?"":p,Hn.default.createElement("div",dy({ref:r.listRefHandler},x),Hn.default.createElement(vV.Track,dy({ref:r.trackRefHandler},l),r.props.children)),r.props.unslick?"":f,r.props.unslick?"":u)}),r.list=null,r.track=null,r.state=wt(wt({},dV.default),{},{currentSlide:r.props.initialSlide,slideCount:Hn.default.Children.count(r.props.children)}),r.callbackTimers=[],r.clickable=!0,r.debouncedResize=null;var n=r.ssrInit();return r.state=wt(wt({},r.state),n),r}return SV(t,[{key:"didPropsChange",value:function(r){for(var n=!1,a=0,o=Object.keys(this.props);a<o.length;a++){var l=o[a];if(!r.hasOwnProperty(l)){n=!0;break}if(!(cy(r[l])==="object"||typeof r[l]=="function")&&r[l]!==this.props[l]){n=!0;break}}return n||Hn.default.Children.count(this.props.children)!==Hn.default.Children.count(r.children)}}]),t}(Hn.default.Component);ub.InnerSlider=IV;var TV=function(s){return s.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}).toLowerCase()},DV=TV,AV=DV,NV=function(s){var e=/[height|width]$/;return e.test(s)},LD=function(s){var e="",t=Object.keys(s);return t.forEach(function(i,r){var n=s[i];i=AV(i),NV(i)&&typeof n=="number"&&(n=n+"px"),n===!0?e+=i:n===!1?e+="not "+i:e+="("+i+": "+n+")",r<t.length-1&&(e+=" and ")}),e},kV=function(s){var e="";return typeof s=="string"?s:s instanceof Array?(s.forEach(function(t,i){e+=LD(t),i<s.length-1&&(e+=", ")}),e):LD(s)},LV=kV,zF={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e=t(le);function t(n){return n&&n.__esModule?n:{default:n}}var i={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(a){return e.default.createElement("ul",{style:{display:"block"}},a)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(a){return e.default.createElement("button",null,a+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0},r=i;s.default=r})(zF);var vC,OD;function OV(){if(OD)return vC;OD=1;function s(e){this.options=e,!e.deferSetup&&this.setup()}return s.prototype={constructor:s,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(e){return this.options===e||this.options.match===e}},vC=s,vC}var mC,RD;function jF(){if(RD)return mC;RD=1;function s(i,r){var n=0,a=i.length,o;for(n;n<a&&(o=r(i[n],n),o!==!1);n++);}function e(i){return Object.prototype.toString.apply(i)==="[object Array]"}function t(i){return typeof i=="function"}return mC={isFunction:t,isArray:e,each:s},mC}var gC,FD;function RV(){if(FD)return gC;FD=1;var s=OV(),e=jF().each;function t(i,r){this.query=i,this.isUnconditional=r,this.handlers=[],this.mql=window.matchMedia(i);var n=this;this.listener=function(a){n.mql=a.currentTarget||a,n.assess()},this.mql.addListener(this.listener)}return t.prototype={constuctor:t,addHandler:function(i){var r=new s(i);this.handlers.push(r),this.matches()&&r.on()},removeHandler:function(i){var r=this.handlers;e(r,function(n,a){if(n.equals(i))return n.destroy(),!r.splice(a,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){e(this.handlers,function(i){i.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var i=this.matches()?"on":"off";e(this.handlers,function(r){r[i]()})}},gC=t,gC}var yC,PD;function FV(){if(PD)return yC;PD=1;var s=RV(),e=jF(),t=e.each,i=e.isFunction,r=e.isArray;function n(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return n.prototype={constructor:n,register:function(a,o,l){var h=this.queries,u=l&&this.browserIsIncapable;return h[a]||(h[a]=new s(a,u)),i(o)&&(o={match:o}),r(o)||(o=[o]),t(o,function(c){i(c)&&(c={match:c}),h[a].addHandler(c)}),this},unregister:function(a,o){var l=this.queries[a];return l&&(o?l.removeHandler(o):(l.clear(),delete this.queries[a])),this}},yC=n,yC}var bC,zD;function PV(){if(zD)return bC;zD=1;var s=FV();return bC=new s,bC}(function(s){function e(T){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},e(T)}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var t=o(le),i=ub,r=o(LV),n=o(zF),a=Ze;function o(T){return T&&T.__esModule?T:{default:T}}function l(){return l=Object.assign||function(T){for(var D=1;D<arguments.length;D++){var N=arguments[D];for(var A in N)Object.prototype.hasOwnProperty.call(N,A)&&(T[A]=N[A])}return T},l.apply(this,arguments)}function h(T,D){var N=Object.keys(T);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(T);D&&(A=A.filter(function(L){return Object.getOwnPropertyDescriptor(T,L).enumerable})),N.push.apply(N,A)}return N}function u(T){for(var D=1;D<arguments.length;D++){var N=arguments[D]!=null?arguments[D]:{};D%2?h(Object(N),!0).forEach(function(A){w(T,A,N[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(N)):h(Object(N)).forEach(function(A){Object.defineProperty(T,A,Object.getOwnPropertyDescriptor(N,A))})}return T}function c(T,D){if(!(T instanceof D))throw new TypeError("Cannot call a class as a function")}function d(T,D){for(var N=0;N<D.length;N++){var A=D[N];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(T,A.key,A)}}function p(T,D,N){return D&&d(T.prototype,D),N&&d(T,N),Object.defineProperty(T,"prototype",{writable:!1}),T}function f(T,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(D&&D.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),D&&v(T,D)}function v(T,D){return v=Object.setPrototypeOf||function(A,L){return A.__proto__=L,A},v(T,D)}function g(T){var D=C();return function(){var A=x(T),L;if(D){var k=x(this).constructor;L=Reflect.construct(A,arguments,k)}else L=A.apply(this,arguments);return b(this,L)}}function b(T,D){if(D&&(e(D)==="object"||typeof D=="function"))return D;if(D!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(T)}function y(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x(T){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(N){return N.__proto__||Object.getPrototypeOf(N)},x(T)}function w(T,D,N){return D in T?Object.defineProperty(T,D,{value:N,enumerable:!0,configurable:!0,writable:!0}):T[D]=N,T}var M=(0,a.canUseDOM)()&&PV(),E=function(T){f(N,T);var D=g(N);function N(A){var L;return c(this,N),L=D.call(this,A),w(y(L),"innerSliderRefHandler",function(k){return L.innerSlider=k}),w(y(L),"slickPrev",function(){return L.innerSlider.slickPrev()}),w(y(L),"slickNext",function(){return L.innerSlider.slickNext()}),w(y(L),"slickGoTo",function(k){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return L.innerSlider.slickGoTo(k,O)}),w(y(L),"slickPause",function(){return L.innerSlider.pause("paused")}),w(y(L),"slickPlay",function(){return L.innerSlider.autoPlay("play")}),L.state={breakpoint:null},L._responsiveMediaHandlers=[],L}return p(N,[{key:"media",value:function(L,k){M.register(L,k),this._responsiveMediaHandlers.push({query:L,handler:k})}},{key:"componentDidMount",value:function(){var L=this;if(this.props.responsive){var k=this.props.responsive.map(function(R){return R.breakpoint});k.sort(function(R,j){return R-j}),k.forEach(function(R,j){var P;j===0?P=(0,r.default)({minWidth:0,maxWidth:R}):P=(0,r.default)({minWidth:k[j-1]+1,maxWidth:R}),(0,a.canUseDOM)()&&L.media(P,function(){L.setState({breakpoint:R})})});var O=(0,r.default)({minWidth:k.slice(-1)[0]});(0,a.canUseDOM)()&&this.media(O,function(){L.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(L){M.unregister(L.query,L.handler)})}},{key:"render",value:function(){var L=this,k,O;this.state.breakpoint?(O=this.props.responsive.filter(function(se){return se.breakpoint===L.state.breakpoint}),k=O[0].settings==="unslick"?"unslick":u(u(u({},n.default),this.props),O[0].settings)):k=u(u({},n.default),this.props),k.centerMode&&(k.slidesToScroll>1,k.slidesToScroll=1),k.fade&&(k.slidesToShow>1,k.slidesToScroll>1,k.slidesToShow=1,k.slidesToScroll=1);var R=t.default.Children.toArray(this.props.children);R=R.filter(function(se){return typeof se=="string"?!!se.trim():!!se}),k.variableWidth&&(k.rows>1||k.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),k.variableWidth=!1);for(var j=[],P=null,F=0;F<R.length;F+=k.rows*k.slidesPerRow){for(var z=[],q=F;q<F+k.rows*k.slidesPerRow;q+=k.slidesPerRow){for(var X=[],G=q;G<q+k.slidesPerRow&&(k.variableWidth&&R[G].props.style&&(P=R[G].props.style.width),!(G>=R.length));G+=1)X.push(t.default.cloneElement(R[G],{key:100*F+10*q+G,tabIndex:-1,style:{width:"".concat(100/k.slidesPerRow,"%"),display:"inline-block"}}));z.push(t.default.createElement("div",{key:10*F+q},X))}k.variableWidth?j.push(t.default.createElement("div",{key:F,style:{width:P}},z)):j.push(t.default.createElement("div",{key:F},z))}if(k==="unslick"){var Z="regular slider "+(this.props.className||"");return t.default.createElement("div",{className:Z},R)}else j.length<=k.slidesToShow&&(k.unslick=!0);return t.default.createElement(i.InnerSlider,l({style:this.props.style,ref:this.innerSliderRefHandler},k),j)}}]),N}(t.default.Component);s.default=E})(dF);(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e=t(dF);function t(r){return r&&r.__esModule?r:{default:r}}var i=e.default;s.default=i})(cF);const zV=$M(cF),jV=[{id:1,img:jB,title:"The Galaxy Long Beach",description:"The Galaxy Towers condos are located 2999 E Ocean Blvd in Long Beach and is one of the most iconic buildings in the Long Beach area.  Originally built in 1967, the building unique design was revolutionary during it's time"},{id:2,img:BB,title:"The Ocean Towers ",description:"Ocean Towers in Santa Monica is undisputedly one of the most sought after oceanfront high rise buildings on the entire west coast. Set on the northern end of Ocean Avenue this premier building can be seen from the shores of Malibu all the way down to Palos Verdes. In 2001 Ocean Towers went through a complete renovation and was remodeled from the ground up."},{id:3,img:HB,title:"Marina City Club",description:"Marina City Club is home to 600 condominiums and wonderful amenities. These amenities included: Racquet Sports such as Tennis, Paddle Tennis and & Racquet Ball; a Fitness Center with Group Classes and beautiful Lockers home to indoor Jacuzzi, Sauna and steam room; two restaurants, various Social Activites and also Private Events."}],BF=({handleLogoutPopup:s})=>{var e={dots:!1,arrows:!1,infinite:!0,speed:800,slidesToScroll:1,autoplay:!0,autoplaySpeed:4e3,cssEase:"ease-in-out",pauseOnHover:!1,pauseOnFocus:!0};return J.jsxs("div",{className:"relative overflow-hidden min-h-[550px] sm:min-h-[650px] bg-gray-100 flex justify-center items-center dark:bg-gray-950 dark:text-white duration-200 ",children:[J.jsx("div",{className:"h-[700px] w-[700px] bg-primary/40 absolute -top-1/2 right-0 rounded-3xl rotate-45 -z[8]"}),J.jsx("div",{className:"container pb-8 sm:pb-0",children:J.jsx(zV,{...e,children:jV.map(t=>J.jsx("div",{children:J.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2",children:[J.jsxs("div",{className:"flex flex-col justify-center gap-4 pt-12 sm:pt-0 text-center sm:text-left order-2 sm:order-1 relative z-10",children:[J.jsx("h1",{"data-aos":"zoom-out","data-aos-duration":"500","data-aos-once":"true",className:"text-5xl sm:text-6xl lg:text-7xl font-bold",children:t.title}),J.jsx("p",{"data-aos":"fade-up","data-aos-duration":"500","data-aos-delay":"100",className:"text-sm",children:t.description}),J.jsx("div",{"data-aos":"fade-up","data-aos-duration":"500","data-aos-delay":"300",children:J.jsx("button",{onClick:s,className:"bg-gradient-to-r from-primary to-secondary hover:scale-105 duration-200 text-white py-2 px-4 rounded-full",children:"Login"})})]}),J.jsx("div",{className:"order-1 sm:order-2",children:J.jsx("div",{"data-aos":"zoom-in","data-aos-once":"true",className:"relative z-10",children:J.jsx("img",{src:t.img,alt:"",className:"rounded-lg w-[300px] h-[300px] sm:h-[450px] sm:w-[450px] mx-auto "})})})]})}))})})]})},BV="/assets/app1-wYJcASUm.jpg",HV="/assets/app2-d6tWfXs5.jpg",VV="/assets/app3-b73J86fL.jpg",UV="/assets/syslist-AzyQe_QQ.jpg",_V="/assets/sysdtl-ksatHDs7.jpg",WV=[{id:1,img:BV,title:"PMP App Login",rating:5,color:"white",aosDelay:"0"},{id:2,img:HV,title:"Users Home Page",rating:4.5,color:"Red",aosDelay:"200"},{id:3,img:VV,title:"List of users properties",rating:4.7,color:"brown",aosDelay:"400"},{id:4,img:UV,title:"Systems View",rating:4.4,color:"Yellow",aosDelay:"200"},{id:5,img:_V,title:"Systems Detail",rating:4.5,color:"Pink",aosDelay:"0"}],HF=()=>J.jsx("div",{className:"mt-14 mb-12",children:J.jsxs("div",{className:"container",children:[J.jsxs("div",{className:"text-center mb-10 max-w-[600px] mx-auto",children:[J.jsx("p",{"data-aos":"fade-up",className:"text-sm text-primary",children:"About the PMP Mobile App...."}),J.jsx("h1",{"data-aos":"fade-up",className:"text-3xl font-bold",children:"PMP Mobile App"}),J.jsx("p",{"data-aos":"fade-up",className:"text-xs text-gray-400",children:"Information about PMP Properties in the palm of your hand. Get the app to see how easy it is to view, edit and audit the informatoin that's important to you."})]}),J.jsxs("div",{children:[J.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 place-items-center gap-5",children:WV.map(s=>J.jsxs("div",{"data-aos":"fade-up","data-aos-delay":s.aosDelay,className:"space-y-3",children:[J.jsx("img",{src:s.img,alt:"",className:"h-[400px] object-cover rounded-md"}),J.jsx("div",{children:J.jsx("h3",{className:"font-semibold",children:s.title})})]},s.id))}),J.jsx("div",{className:"flex justify-center",children:J.jsx("button",{className:"text-center mt-10 cursor-pointer bg-primary text-white py-1 px-5 rounded-md",children:"View All Button"})})]})]})}),qV="/assets/pmp-footer-EgiqRVlV.jpg",YV={backgroundImage:`url(${qV})`,backgroundPosition:"bottom",backgroundRepeat:"no-repeat",backgroundSize:"cover",height:"100%",width:"100%"},jD=[{title:"Home",link:"/#"},{title:"About",link:"/#about"},{title:"Contact",link:"/#contact"},{title:"Blog",link:"/#blog"}],eI=()=>J.jsx("div",{style:YV,className:"text-white",children:J.jsx("div",{className:"container",children:J.jsxs("div",{"data-aos":"zoom-in",className:"grid md:grid-cols-3 pb-44 pt-5",children:[J.jsxs("div",{className:"py-8 px-4",children:[J.jsxs("h1",{className:"sm:text-3xl text-xl font-bold sm:text-left text-justify mb-3 flex items-center gap-3",children:[J.jsx("img",{src:lb,alt:"",className:"max-w-[50px]"}),"Mobile App Manager"]}),J.jsx("p",{children:"Don't have the PMP Mobile App? Talk with your PMP represenative to begin the experience."})]}),J.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 col-span-2 md:pl-10",children:[J.jsx("div",{children:J.jsxs("div",{className:"py-8 px-4",children:[J.jsx("h1",{className:"sm:text-xl text-xl font-bold sm:text-left text-justify mb-3",children:"Important Links"}),J.jsx("ul",{className:"flex flex-col gap-3",children:jD.map(s=>J.jsx("li",{className:"cursor-pointer hover:text-primary hover:translate-x-1 duration-300 text-gray-200",children:J.jsx("span",{children:s.title})},s.title))})]})}),J.jsx("div",{children:J.jsxs("div",{className:"py-8 px-4",children:[J.jsx("h1",{className:"sm:text-xl text-xl font-bold sm:text-left text-justify mb-3",children:"Links"}),J.jsx("ul",{className:"flex flex-col gap-3",children:jD.map(s=>J.jsx("li",{className:"cursor-pointer hover:text-primary hover:translate-x-1 duration-300 text-gray-200",children:J.jsx("span",{children:s.title})},s.title))})]})}),J.jsxs("div",{children:[J.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[J.jsx("a",{href:"#",children:J.jsx(TB,{className:"text-3xl"})}),J.jsx("a",{href:"#",children:J.jsx(IB,{className:"text-3xl"})}),J.jsx("a",{href:"#",children:J.jsx(DB,{className:"text-3xl"})})]}),J.jsxs("div",{className:"mt-6",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx(NB,{}),J.jsx("p",{children:"Noida, Uttar Pradesh"})]}),J.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[J.jsx(kB,{}),J.jsx("p",{children:"(323) 359-8734"})]})]})]})]})]})})});class As extends Error{constructor(e){var t,i,r,n;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,As.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof As||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(n=(r=(i=this.originalError)==null?void 0:i.cause)==null?void 0:r.message)!=null&&n.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const Xv=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function QV(s,e){const t={};if(typeof s!="string")return t;const i=Object.assign({},e||{}).decode||GV;let r=0;for(;r<s.length;){const n=s.indexOf("=",r);if(n===-1)break;let a=s.indexOf(";",r);if(a===-1)a=s.length;else if(a<n){r=s.lastIndexOf(";",n-1)+1;continue}const o=s.slice(r,n).trim();if(t[o]===void 0){let l=s.slice(n+1,a).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1));try{t[o]=i(l)}catch{t[o]=l}}r=a+1}return t}function BD(s,e,t){const i=Object.assign({},t||{}),r=i.encode||$V;if(!Xv.test(s))throw new TypeError("argument name is invalid");const n=r(e);if(n&&!Xv.test(n))throw new TypeError("argument val is invalid");let a=s+"="+n;if(i.maxAge!=null){const o=i.maxAge-0;if(isNaN(o)||!isFinite(o))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(o)}if(i.domain){if(!Xv.test(i.domain))throw new TypeError("option domain is invalid");a+="; Domain="+i.domain}if(i.path){if(!Xv.test(i.path))throw new TypeError("option path is invalid");a+="; Path="+i.path}if(i.expires){if(!function(l){return Object.prototype.toString.call(l)==="[object Date]"||l instanceof Date}(i.expires)||isNaN(i.expires.valueOf()))throw new TypeError("option expires is invalid");a+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(a+="; HttpOnly"),i.secure&&(a+="; Secure"),i.priority)switch(typeof i.priority=="string"?i.priority.toLowerCase():i.priority){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function GV(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function $V(s){return encodeURIComponent(s)}let VF;function Sg(s){if(s)try{const e=decodeURIComponent(VF(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function UF(s,e=0){let t=Sg(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}VF=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,i,r=0,n=0,a="";i=e.charAt(n++);~i&&(t=r%4?64*t+i:i,r++%4)?a+=String.fromCharCode(255&t>>(-2*r&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};const HD="pb_auth";class XV{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!UF(this.token)}get isAdmin(){return Sg(this.token).type==="admin"}get isAuthRecord(){return Sg(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=HD){const i=QV(e||"")[t]||"";let r={};try{r=JSON.parse(i),(typeof r===null||typeof r!="object"||Array.isArray(r))&&(r={})}catch{}this.save(r.token||"",r.model||null)}exportToCookie(e,t=HD){var l,h;const i={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},r=Sg(this.token);i.expires=r!=null&&r.exp?new Date(1e3*r.exp):new Date("1970-01-01"),e=Object.assign({},i,e);const n={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let a=BD(t,JSON.stringify(n),e);const o=typeof Blob<"u"?new Blob([a]).size:a.length;if(n.model&&o>4096){n.model={id:(l=n==null?void 0:n.model)==null?void 0:l.id,email:(h=n==null?void 0:n.model)==null?void 0:h.email};const u=["collectionId","username","verified"];for(const c in this.model)u.includes(c)&&(n.model[c]=this.model[c]);a=BD(t,JSON.stringify(n),e)}return a}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let i=this._onChangeCallbacks.length-1;i>=0;i--)if(this._onChangeCallbacks[i]==e)return delete this._onChangeCallbacks[i],void this._onChangeCallbacks.splice(i,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class KV extends XV{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let i=t;typeof t!="string"&&(i=JSON.stringify(t)),window.localStorage.setItem(e,i)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class Eu{constructor(e){this.client=e}}class ZV extends Eu{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,i){return i=Object.assign({method:"POST",body:{email:e,template:t}},i),this.client.send("/api/settings/test/email",i).then(()=>!0)}async generateAppleClientSecret(e,t,i,r,n,a){return a=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:i,privateKey:r,duration:n}},a),this.client.send("/api/settings/apple/generate-client-secret",a)}}class tI extends Eu{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let i=500;return(t=Object.assign({},e,t)).batch&&(i=t.batch,delete t.batch),this._getFullList(i,t)}async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send(this.baseCrudPath,i).then(r=>{var n;return r.items=((n=r.items)==null?void 0:n.map(a=>this.decode(a)))||[],r})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(i=>{var r;if(!((r=i==null?void 0:i.items)!=null&&r.length))throw new As({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return i.items[0]})}async getOne(e,t){if(!e)throw new As({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(i=>this.decode(i))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(i=>this.decode(i))}async update(e,t,i){return i=Object.assign({method:"PATCH",body:t},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),i).then(r=>this.decode(r))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let i=[],r=async n=>this.getList(n,e||500,t).then(a=>{const o=a.items;return i=i.concat(o),o.length==a.perPage?r(n+1):i});return r(1)}}function ys(s,e,t,i){const r=i!==void 0;return r||t!==void 0?r?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,i),e):Object.assign(e,t):e}function CC(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class JV extends tI{get baseCrudPath(){return"/api/admins"}async update(e,t,i){return super.update(e,t,i).then(r=>{var n,a;return((n=this.client.authStore.model)==null?void 0:n.id)===r.id&&((a=this.client.authStore.model)==null?void 0:a.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,r),r})}async delete(e,t){return super.delete(e,t).then(i=>{var r,n;return i&&((r=this.client.authStore.model)==null?void 0:r.id)===e&&((n=this.client.authStore.model)==null?void 0:n.collectionId)===void 0&&this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,i,r){let n={method:"POST",body:{identity:e,password:t}};n=ys("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",n,i,r);const a=n.autoRefreshThreshold;delete n.autoRefreshThreshold,n.autoRefresh||CC(this.client);let o=await this.client.send(this.baseCrudPath+"/auth-with-password",n);return o=this.authResponse(o),a&&function(h,u,c,d){CC(h);const p=h.beforeSend,f=h.authStore.model,v=h.authStore.onChange((g,b)=>{(!g||(b==null?void 0:b.id)!=(f==null?void 0:f.id)||(b!=null&&b.collectionId||f!=null&&f.collectionId)&&(b==null?void 0:b.collectionId)!=(f==null?void 0:f.collectionId))&&CC(h)});h._resetAutoRefresh=function(){v(),h.beforeSend=p,delete h._resetAutoRefresh},h.beforeSend=async(g,b)=>{var w;const y=h.authStore.token;if((w=b.query)!=null&&w.autoRefresh)return p?p(g,b):{url:g,sendOptions:b};let C=h.authStore.isValid;if(C&&UF(h.authStore.token,u))try{await c()}catch{C=!1}C||await d();const x=b.headers||{};for(let M in x)if(M.toLowerCase()=="authorization"&&y==x[M]&&h.authStore.token){x[M]=h.authStore.token;break}return b.headers=x,p?p(g,b):{url:g,sendOptions:b}}}(this.client,a,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},n))),o}async authRefresh(e,t){let i={method:"POST"};return i=ys("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",i).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,i){let r={method:"POST",body:{email:e}};return r=ys("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",r,t,i),this.client.send(this.baseCrudPath+"/request-password-reset",r).then(()=>!0)}async confirmPasswordReset(e,t,i,r,n){let a={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return a=ys("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",a,r,n),this.client.send(this.baseCrudPath+"/confirm-password-reset",a).then(()=>!0)}}const e5=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function _F(s){if(s){s.query=s.query||{};for(let e in s)e5.includes(e)||(s.query[e]=s[e],delete s[e])}}class WF extends Eu{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,i){var a;if(!e)throw new Error("topic must be set.");let r=e;if(i){_F(i);const o="options="+encodeURIComponent(JSON.stringify({query:i.query,headers:i.headers}));r+=(r.includes("?")?"&":"?")+o}const n=function(o){const l=o;let h;try{h=JSON.parse(l==null?void 0:l.data)}catch{}t(h||{})};return this.subscriptions[r]||(this.subscriptions[r]=[]),this.subscriptions[r].push(n),this.isConnected?this.subscriptions[r].length===1?await this.submitSubscriptions():(a=this.eventSource)==null||a.addEventListener(r,n):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,n)}async unsubscribe(e){var i;let t=!1;if(e){const r=this.getSubscriptionsByTopic(e);for(let n in r)if(this.hasSubscriptionListeners(n)){for(let a of this.subscriptions[n])(i=this.eventSource)==null||i.removeEventListener(n,a);delete this.subscriptions[n],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var i;let t=!1;for(let r in this.subscriptions)if((r+"?").startsWith(e)){t=!0;for(let n of this.subscriptions[r])(i=this.eventSource)==null||i.removeEventListener(r,n);delete this.subscriptions[r]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var n;let i=!1;const r=this.getSubscriptionsByTopic(e);for(let a in r){if(!Array.isArray(this.subscriptions[a])||!this.subscriptions[a].length)continue;let o=!1;for(let l=this.subscriptions[a].length-1;l>=0;l--)this.subscriptions[a][l]===t&&(o=!0,delete this.subscriptions[a][l],this.subscriptions[a].splice(l,1),(n=this.eventSource)==null||n.removeEventListener(a,t));o&&(this.subscriptions[a].length||delete this.subscriptions[a],i||this.hasSubscriptionListeners(a)||(i=!0))}this.hasSubscriptionListeners()?i&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,i;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let r in this.subscriptions)if((i=this.subscriptions[r])!=null&&i.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let i in this.subscriptions)(i+"?").startsWith(e)&&(t[i]=this.subscriptions[i]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let i=3;for(;this.hasUnsentSubscriptions()&&i>0;)i--,await this.submitSubscriptions()}).then(()=>{for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const i=this.getSubscriptionsByTopic("PB_CONNECT");for(let r in i)for(let n of i[r])n(e)}).catch(i=>{this.clientId="",this.connectErrorHandler(i)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let i of this.pendingConnects)i.reject(new As(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[]}}}class t5 extends tI{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,i){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,i)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const i=Object.assign({},e,t);return super.getFullList(i)}async getList(e=1,t=30,i){return super.getList(e,t,i)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,i){return super.update(e,t,i).then(r=>{var n,a,o;return((n=this.client.authStore.model)==null?void 0:n.id)!==(r==null?void 0:r.id)||((a=this.client.authStore.model)==null?void 0:a.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.model)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,r),r})}async delete(e,t){return super.delete(e,t).then(i=>{var r,n,a;return!i||((r=this.client.authStore.model)==null?void 0:r.id)!==e||((n=this.client.authStore.model)==null?void 0:n.collectionId)!==this.collectionIdOrName&&((a=this.client.authStore.model)==null?void 0:a.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,i,r){let n={method:"POST",body:{identity:e,password:t}};return n=ys("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",n,i,r),this.client.send(this.baseCollectionPath+"/auth-with-password",n).then(a=>this.authResponse(a))}async authWithOAuth2Code(e,t,i,r,n,a,o){let l={method:"POST",body:{provider:e,code:t,codeVerifier:i,redirectUrl:r,createData:n}};return l=ys("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",l,a,o),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",l).then(h=>this.authResponse(h))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},i=(await this.listAuthMethods()).authProviders.find(l=>l.name===t.provider);if(!i)throw new As(new Error(`Missing or invalid provider "${t.provider}".`));const r=this.client.buildUrl("/api/oauth2-redirect"),n=new WF(this.client);let a=null;function o(){a==null||a.close(),n.unsubscribe()}return t.urlCallback||(a=VD(void 0)),new Promise(async(l,h)=>{var u;try{await n.subscribe("@oauth2",async f=>{const v=n.clientId;try{if(!f.state||v!==f.state)throw new Error("State parameters don't match.");const g=Object.assign({},t);delete g.provider,delete g.scopes,delete g.createData,delete g.urlCallback;const b=await this.authWithOAuth2Code(i.name,f.code,i.codeVerifier,r,t.createData,g);l(b)}catch(g){h(new As(g))}o()});const c={state:n.clientId};(u=t.scopes)!=null&&u.length&&(c.scope=t.scopes.join(" "));const d=this._replaceQueryParams(i.authUrl+r,c);await(t.urlCallback||function(f){a?a.location.href=f:a=VD(f)})(d)}catch(c){o(),h(new As(c))}})}async authRefresh(e,t){let i={method:"POST"};return i=ys("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",i).then(r=>this.authResponse(r))}async requestPasswordReset(e,t,i){let r={method:"POST",body:{email:e}};return r=ys("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-password-reset",r).then(()=>!0)}async confirmPasswordReset(e,t,i,r,n){let a={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return a=ys("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",a,r,n),this.client.send(this.baseCollectionPath+"/confirm-password-reset",a).then(()=>!0)}async requestVerification(e,t,i){let r={method:"POST",body:{email:e}};return r=ys("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-verification",r).then(()=>!0)}async confirmVerification(e,t,i){let r={method:"POST",body:{token:e}};return r=ys("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/confirm-verification",r).then(()=>!0)}async requestEmailChange(e,t,i){let r={method:"POST",body:{newEmail:e}};return r=ys("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",r,t,i),this.client.send(this.baseCollectionPath+"/request-email-change",r).then(()=>!0)}async confirmEmailChange(e,t,i,r){let n={method:"POST",body:{token:e,password:t}};return n=ys("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",n,i,r),this.client.send(this.baseCollectionPath+"/confirm-email-change",n).then(()=>!0)}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,i){return i=Object.assign({method:"DELETE"},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),i).then(()=>!0)}_replaceQueryParams(e,t={}){let i=e,r="";e.indexOf("?")>=0&&(i=e.substring(0,e.indexOf("?")),r=e.substring(e.indexOf("?")+1));const n={},a=r.split("&");for(const o of a){if(o=="")continue;const l=o.split("=");n[decodeURIComponent(l[0].replace(/\+/g," "))]=decodeURIComponent((l[1]||"").replace(/\+/g," "))}for(let o in t)t.hasOwnProperty(o)&&(t[o]==null?delete n[o]:n[o]=t[o]);r="";for(let o in n)n.hasOwnProperty(o)&&(r!=""&&(r+="&"),r+=encodeURIComponent(o.replace(/%20/g,"+"))+"="+encodeURIComponent(n[o].replace(/%20/g,"+")));return r!=""?i+"?"+r:i}}function VD(s){if(typeof window>"u"||!(window!=null&&window.open))throw new As(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,i=window.innerWidth,r=window.innerHeight;e=e>i?i:e,t=t>r?r:t;let n=i/2-e/2,a=r/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+a+",left="+n+",resizable,menubar=no")}class i5 extends tI{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,i){return i=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},i),this.client.send(this.baseCrudPath+"/import",i).then(()=>!0)}}class r5 extends Eu{async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send("/api/logs",i)}async getOne(e,t){if(!e)throw new As({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class n5 extends Eu{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class s5 extends Eu{getUrl(e,t,i={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const r=[];r.push("api"),r.push("files"),r.push(encodeURIComponent(e.collectionId||e.collectionName)),r.push(encodeURIComponent(e.id)),r.push(encodeURIComponent(t));let n=this.client.buildUrl(r.join("/"));if(Object.keys(i).length){i.download===!1&&delete i.download;const a=new URLSearchParams(i);n+=(n.includes("?")?"&":"?")+a}return n}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class a5 extends Eu{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class o5{constructor(e="/",t,i="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=i,this.authStore=t||new KV,this.admins=new JV(this),this.collections=new i5(this),this.files=new s5(this),this.logs=new r5(this),this.settings=new ZV(this),this.realtime=new WF(this),this.health=new n5(this),this.backups=new a5(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new t5(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let i in t){let r=t[i];switch(typeof r){case"boolean":case"number":r=""+r;break;case"string":r="'"+r.replace(/'/g,"\\'")+"'";break;default:r=r===null?"null":r instanceof Date?"'"+r.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(r).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+i+"}",r)}return e}getFileUrl(e,t,i={}){return this.files.getUrl(e,t,i)}buildUrl(e){var i;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(i=window.location.origin)!=null&&i.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let i=this.buildUrl(e);if(this.beforeSend){const r=Object.assign({},await this.beforeSend(i,t));r.url!==void 0||r.options!==void 0?(i=r.url||i,t=r.options||t):Object.keys(r).length&&(t=r,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const r=this.serializeQueryParams(t.query);r&&(i+=(i.includes("?")?"&":"?")+r),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(i,t).then(async r=>{let n={};try{n=await r.json()}catch{}if(this.afterSend&&(n=await this.afterSend(r,n)),r.status>=400)throw new As({url:r.url,status:r.status,data:n});return n}).catch(r=>{throw new As(r)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),_F(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const i=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(i);const r=new AbortController;this.cancelControllers[i]=r,t.signal=r.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let i in e){const r=this.normalizeFormDataValue(e[i]),n=Array.isArray(r)?r:[r];if(n.length)for(const a of n)t.append(i,a);else t.append(i,"")}return t}normalizeFormDataValue(e){return e===null||typeof e!="object"||e instanceof Date||this.hasBlobField({data:e})||Array.isArray(e)&&!e.filter(t=>typeof t!="string").length?e:JSON.stringify(e)}hasBlobField(e){for(let t in e){const i=Array.isArray(e[t])?e[t]:[e[t]];for(let r of i)if(typeof Blob<"u"&&r instanceof Blob||typeof File<"u"&&r instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let i in e)if(i.toLowerCase()==t)return e[i];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const i in e){if(e[i]===null)continue;const r=e[i],n=encodeURIComponent(i);if(Array.isArray(r))for(const a of r)t.push(n+"="+encodeURIComponent(a));else r instanceof Date?t.push(n+"="+encodeURIComponent(r.toISOString())):typeof r!==null&&typeof r=="object"?t.push(n+"="+encodeURIComponent(JSON.stringify(r))):t.push(n+"="+encodeURIComponent(r))}return t.join("&")}}const qF="https://predictive-af.fly.dev/";console.log("PB1 Host",qF);const Zs=new o5(qF),YF=Lt.createContext(),Iu=()=>{const s=ob(),{user:e,setUser:t}=le.useContext(YF);return{user:e,logOut:()=>{Zs.authStore.clear(),t(null)},logIn:o=>{t(o)},isAuthenticated:()=>Zs.authStore.isValid,checkAuthentication:()=>{Zs.authStore.isValid||s("/auth")},setUser:t}};function l5(s){return $o({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144m224 0L144 368"}}]})(s)}const mb=({logoutPopup:s,setLogoutPopup:e})=>{const t=Iu(),i=ob(),r=async()=>{t.logOut(),e(!1),i("/auth")};return J.jsx(J.Fragment,{children:s&&J.jsx("div",{className:"popup",children:J.jsx("div",{className:"h-screen w-screen fixed top-0 left-0 bg-black/50 z-50 backdrop-blur-sm",children:J.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-4 shadow-md bg-white dark:bg-gray-900 rounded-md duration-200 w-[300px]",children:[J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsx("div",{className:"flex items-center",children:J.jsx("img",{src:lb,alt:"Logo",className:"w-20"})}),J.jsx("div",{children:J.jsx(l5,{className:"text-2xl cursor-pointer ",onClick:()=>e(!1)})})]}),J.jsx("div",{className:"mt-4",children:J.jsx("div",{className:"flex justify-center",children:J.jsx("button",{onClick:r,className:"bg-gradient-to-r from-primary to-secondary hover:scale-105 duration-200 text-white py-1 px-4 rounded-full ",children:"Logout"})})})]})})})})};var QF={exports:{}};(function(s,e){(function(t,i){s.exports=i()})(Ip,function(){return function(t){function i(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var r={};return i.m=t,i.c=r,i.p="dist/",i(0)}([function(t,i,r){function n(O){return O&&O.__esModule?O:{default:O}}var a=Object.assign||function(O){for(var R=1;R<arguments.length;R++){var j=arguments[R];for(var P in j)Object.prototype.hasOwnProperty.call(j,P)&&(O[P]=j[P])}return O},o=r(1),l=(n(o),r(6)),h=n(l),u=r(7),c=n(u),d=r(8),p=n(d),f=r(9),v=n(f),g=r(10),b=n(g),y=r(11),C=n(y),x=r(14),w=n(x),M=[],E=!1,T={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},D=function(){var O=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(O&&(E=!0),E)return M=(0,C.default)(M,T),(0,b.default)(M,T.once),M},N=function(){M=(0,w.default)(),D()},A=function(){M.forEach(function(O,R){O.node.removeAttribute("data-aos"),O.node.removeAttribute("data-aos-easing"),O.node.removeAttribute("data-aos-duration"),O.node.removeAttribute("data-aos-delay")})},L=function(O){return O===!0||O==="mobile"&&v.default.mobile()||O==="phone"&&v.default.phone()||O==="tablet"&&v.default.tablet()||typeof O=="function"&&O()===!0},k=function(O){T=a(T,O),M=(0,w.default)();var R=document.all&&!window.atob;return L(T.disable)||R?A():(T.disableMutationObserver||p.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),T.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",T.easing),document.querySelector("body").setAttribute("data-aos-duration",T.duration),document.querySelector("body").setAttribute("data-aos-delay",T.delay),T.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?D(!0):T.startEvent==="load"?window.addEventListener(T.startEvent,function(){D(!0)}):document.addEventListener(T.startEvent,function(){D(!0)}),window.addEventListener("resize",(0,c.default)(D,T.debounceDelay,!0)),window.addEventListener("orientationchange",(0,c.default)(D,T.debounceDelay,!0)),window.addEventListener("scroll",(0,h.default)(function(){(0,b.default)(M,T.once)},T.throttleDelay)),T.disableMutationObserver||p.default.ready("[data-aos]",N),M)};t.exports={init:k,refresh:D,refreshHard:N}},function(t,i){},,,,,function(t,i){(function(r){function n(L,k,O){function R(Ie){var Te=se,rt=oe;return se=oe=void 0,H=Ie,be=L.apply(rt,Te)}function j(Ie){return H=Ie,Ne=setTimeout(z,k),V?R(Ie):be}function P(Ie){var Te=Ie-we,rt=Ie-H,Tt=k-Te;return re?N(Tt,fe-rt):Tt}function F(Ie){var Te=Ie-we,rt=Ie-H;return we===void 0||Te>=k||Te<0||re&&rt>=fe}function z(){var Ie=A();return F(Ie)?q(Ie):void(Ne=setTimeout(z,P(Ie)))}function q(Ie){return Ne=void 0,he&&se?R(Ie):(se=oe=void 0,be)}function X(){Ne!==void 0&&clearTimeout(Ne),H=0,se=we=oe=Ne=void 0}function G(){return Ne===void 0?be:q(A())}function Z(){var Ie=A(),Te=F(Ie);if(se=arguments,oe=this,we=Ie,Te){if(Ne===void 0)return j(we);if(re)return Ne=setTimeout(z,k),R(we)}return Ne===void 0&&(Ne=setTimeout(z,k)),be}var se,oe,fe,be,Ne,we,H=0,V=!1,re=!1,he=!0;if(typeof L!="function")throw new TypeError(d);return k=u(k)||0,o(O)&&(V=!!O.leading,re="maxWait"in O,fe=re?D(u(O.maxWait)||0,k):fe,he="trailing"in O?!!O.trailing:he),Z.cancel=X,Z.flush=G,Z}function a(L,k,O){var R=!0,j=!0;if(typeof L!="function")throw new TypeError(d);return o(O)&&(R="leading"in O?!!O.leading:R,j="trailing"in O?!!O.trailing:j),n(L,k,{leading:R,maxWait:k,trailing:j})}function o(L){var k=typeof L>"u"?"undefined":c(L);return!!L&&(k=="object"||k=="function")}function l(L){return!!L&&(typeof L>"u"?"undefined":c(L))=="object"}function h(L){return(typeof L>"u"?"undefined":c(L))=="symbol"||l(L)&&T.call(L)==f}function u(L){if(typeof L=="number")return L;if(h(L))return p;if(o(L)){var k=typeof L.valueOf=="function"?L.valueOf():L;L=o(k)?k+"":k}if(typeof L!="string")return L===0?L:+L;L=L.replace(v,"");var O=b.test(L);return O||y.test(L)?C(L.slice(2),O?2:8):g.test(L)?p:+L}var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},d="Expected a function",p=NaN,f="[object Symbol]",v=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,b=/^0b[01]+$/i,y=/^0o[0-7]+$/i,C=parseInt,x=(typeof r>"u"?"undefined":c(r))=="object"&&r&&r.Object===Object&&r,w=(typeof self>"u"?"undefined":c(self))=="object"&&self&&self.Object===Object&&self,M=x||w||Function("return this")(),E=Object.prototype,T=E.toString,D=Math.max,N=Math.min,A=function(){return M.Date.now()};t.exports=a}).call(i,function(){return this}())},function(t,i){(function(r){function n(A,L,k){function O(he){var Ie=Z,Te=se;return Z=se=void 0,we=he,fe=A.apply(Te,Ie)}function R(he){return we=he,be=setTimeout(F,L),H?O(he):fe}function j(he){var Ie=he-Ne,Te=he-we,rt=L-Ie;return V?D(rt,oe-Te):rt}function P(he){var Ie=he-Ne,Te=he-we;return Ne===void 0||Ie>=L||Ie<0||V&&Te>=oe}function F(){var he=N();return P(he)?z(he):void(be=setTimeout(F,j(he)))}function z(he){return be=void 0,re&&Z?O(he):(Z=se=void 0,fe)}function q(){be!==void 0&&clearTimeout(be),we=0,Z=Ne=se=be=void 0}function X(){return be===void 0?fe:z(N())}function G(){var he=N(),Ie=P(he);if(Z=arguments,se=this,Ne=he,Ie){if(be===void 0)return R(Ne);if(V)return be=setTimeout(F,L),O(Ne)}return be===void 0&&(be=setTimeout(F,L)),fe}var Z,se,oe,fe,be,Ne,we=0,H=!1,V=!1,re=!0;if(typeof A!="function")throw new TypeError(c);return L=h(L)||0,a(k)&&(H=!!k.leading,V="maxWait"in k,oe=V?T(h(k.maxWait)||0,L):oe,re="trailing"in k?!!k.trailing:re),G.cancel=q,G.flush=X,G}function a(A){var L=typeof A>"u"?"undefined":u(A);return!!A&&(L=="object"||L=="function")}function o(A){return!!A&&(typeof A>"u"?"undefined":u(A))=="object"}function l(A){return(typeof A>"u"?"undefined":u(A))=="symbol"||o(A)&&E.call(A)==p}function h(A){if(typeof A=="number")return A;if(l(A))return d;if(a(A)){var L=typeof A.valueOf=="function"?A.valueOf():A;A=a(L)?L+"":L}if(typeof A!="string")return A===0?A:+A;A=A.replace(f,"");var k=g.test(A);return k||b.test(A)?y(A.slice(2),k?2:8):v.test(A)?d:+A}var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},c="Expected a function",d=NaN,p="[object Symbol]",f=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,b=/^0o[0-7]+$/i,y=parseInt,C=(typeof r>"u"?"undefined":u(r))=="object"&&r&&r.Object===Object&&r,x=(typeof self>"u"?"undefined":u(self))=="object"&&self&&self.Object===Object&&self,w=C||x||Function("return this")(),M=Object.prototype,E=M.toString,T=Math.max,D=Math.min,N=function(){return w.Date.now()};t.exports=n}).call(i,function(){return this}())},function(t,i){function r(u){var c=void 0,d=void 0;for(c=0;c<u.length;c+=1)if(d=u[c],d.dataset&&d.dataset.aos||d.children&&r(d.children))return!0;return!1}function n(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function a(){return!!n()}function o(u,c){var d=window.document,p=n(),f=new p(l);h=c,f.observe(d.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function l(u){u&&u.forEach(function(c){var d=Array.prototype.slice.call(c.addedNodes),p=Array.prototype.slice.call(c.removedNodes),f=d.concat(p);if(r(f))return h()})}Object.defineProperty(i,"__esModule",{value:!0});var h=function(){};i.default={isSupported:a,ready:o}},function(t,i){function r(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function n(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function d(p,f){for(var v=0;v<f.length;v++){var g=f[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,f,v){return f&&d(p.prototype,f),v&&d(p,v),p}}(),o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,l=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,h=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,u=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,c=function(){function d(){r(this,d)}return a(d,[{key:"phone",value:function(){var p=n();return!(!o.test(p)&&!l.test(p.substr(0,4)))}},{key:"mobile",value:function(){var p=n();return!(!h.test(p)&&!u.test(p.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),d}();i.default=new c},function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=function(a,o,l){var h=a.node.getAttribute("data-aos-once");o>a.position?a.node.classList.add("aos-animate"):typeof h<"u"&&(h==="false"||!l&&h!=="true")&&a.node.classList.remove("aos-animate")},n=function(a,o){var l=window.pageYOffset,h=window.innerHeight;a.forEach(function(u,c){r(u,h+l,o)})};i.default=n},function(t,i,r){function n(h){return h&&h.__esModule?h:{default:h}}Object.defineProperty(i,"__esModule",{value:!0});var a=r(12),o=n(a),l=function(h,u){return h.forEach(function(c,d){c.node.classList.add("aos-init"),c.position=(0,o.default)(c.node,u.offset)}),h};i.default=l},function(t,i,r){function n(h){return h&&h.__esModule?h:{default:h}}Object.defineProperty(i,"__esModule",{value:!0});var a=r(13),o=n(a),l=function(h,u){var c=0,d=0,p=window.innerHeight,f={offset:h.getAttribute("data-aos-offset"),anchor:h.getAttribute("data-aos-anchor"),anchorPlacement:h.getAttribute("data-aos-anchor-placement")};switch(f.offset&&!isNaN(f.offset)&&(d=parseInt(f.offset)),f.anchor&&document.querySelectorAll(f.anchor)&&(h=document.querySelectorAll(f.anchor)[0]),c=(0,o.default)(h).top,f.anchorPlacement){case"top-bottom":break;case"center-bottom":c+=h.offsetHeight/2;break;case"bottom-bottom":c+=h.offsetHeight;break;case"top-center":c+=p/2;break;case"bottom-center":c+=p/2+h.offsetHeight;break;case"center-center":c+=p/2+h.offsetHeight/2;break;case"top-top":c+=p;break;case"bottom-top":c+=h.offsetHeight+p;break;case"center-top":c+=h.offsetHeight/2+p}return f.anchorPlacement||f.offset||isNaN(u)||(d=u),c+d};i.default=l},function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=function(n){for(var a=0,o=0;n&&!isNaN(n.offsetLeft)&&!isNaN(n.offsetTop);)a+=n.offsetLeft-(n.tagName!="BODY"?n.scrollLeft:0),o+=n.offsetTop-(n.tagName!="BODY"?n.scrollTop:0),n=n.offsetParent;return{top:o,left:a}};i.default=r},function(t,i){Object.defineProperty(i,"__esModule",{value:!0});var r=function(n){return n=n||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(n,function(a){return{node:a}})};i.default=r}])})})(QF);var h5=QF.exports;const Kl=$M(h5),u5=()=>{const[s,e]=Lt.useState(!1),t=Iu(),i=()=>{console.log("Logout",!s),e(!s)};return Lt.useEffect(()=>{t.checkAuthentication(),Kl.init({offset:100,duration:800,easing:"ease-in-sine",delay:100}),Kl.refresh()},[]),J.jsxs("div",{className:"bg-white dark:bg-gray-900 dark:text-white duration-200",children:[J.jsx(hb,{handleLogoutPopup:i}),J.jsx(BF,{handleLogoutPopup:i}),J.jsx(HF,{}),J.jsx(eI,{}),J.jsx(mb,{logoutPopup:s,setLogoutPopup:e})]})},c5=()=>{const[s,e]=Lt.useState(!1),t=Iu(),i=()=>{e(!s)};return Lt.useEffect(()=>{t.checkAuthentication(),Kl.init({offset:100,duration:800,easing:"ease-in-sine",delay:100}),Kl.refresh()},[]),J.jsxs("div",{className:"bg-white dark:bg-gray-900 dark:text-white duration-200",children:[J.jsx(hb,{handleLogoutPopup:i}),J.jsx(BF,{handleLogoutPopup:i}),J.jsx(HF,{}),J.jsx(eI,{}),J.jsx(mb,{logoutPopup:s,setLogoutPopup:e})]})};var Cv=s=>s.type==="checkbox",Sc=s=>s instanceof Date,Wn=s=>s==null;const GF=s=>typeof s=="object";var qr=s=>!Wn(s)&&!Array.isArray(s)&&GF(s)&&!Sc(s),d5=s=>qr(s)&&s.target?Cv(s.target)?s.target.checked:s.target.value:s,p5=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,f5=(s,e)=>s.has(p5(e)),v5=s=>{const e=s.constructor&&s.constructor.prototype;return qr(e)&&e.hasOwnProperty("isPrototypeOf")},iI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Vs(s){let e;const t=Array.isArray(s);if(s instanceof Date)e=new Date(s);else if(s instanceof Set)e=new Set(s);else if(!(iI&&(s instanceof Blob||s instanceof FileList))&&(t||qr(s)))if(e=t?[]:{},!t&&!v5(s))e=s;else for(const i in s)s.hasOwnProperty(i)&&(e[i]=Vs(s[i]));else return s;return e}var Sv=s=>Array.isArray(s)?s.filter(Boolean):[],Sr=s=>s===void 0,at=(s,e,t)=>{if(!e||!qr(s))return t;const i=Sv(e.split(/[,[\].]+?/)).reduce((r,n)=>Wn(r)?r:r[n],s);return Sr(i)||i===s?Sr(s[e])?t:s[e]:i},ko=s=>typeof s=="boolean";const UD={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ca={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},po={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};Lt.createContext(null);var m5=(s,e,t,i=!0)=>{const r={defaultValues:e._defaultValues};for(const n in s)Object.defineProperty(r,n,{get:()=>{const a=n;return e._proxyFormState[a]!==Ca.all&&(e._proxyFormState[a]=!i||Ca.all),t&&(t[a]=!0),s[a]}});return r},_s=s=>qr(s)&&!Object.keys(s).length,g5=(s,e,t,i)=>{t(s);const{name:r,...n}=s;return _s(n)||Object.keys(n).length>=Object.keys(e).length||Object.keys(n).find(a=>e[a]===(!i||Ca.all))},SC=s=>Array.isArray(s)?s:[s];function y5(s){const e=Lt.useRef(s);e.current=s,Lt.useEffect(()=>{const t=!s.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{t&&t.unsubscribe()}},[s.disabled])}var Xa=s=>typeof s=="string",b5=(s,e,t,i,r)=>Xa(s)?(i&&e.watch.add(s),at(t,s,r)):Array.isArray(s)?s.map(n=>(i&&e.watch.add(n),at(t,n))):(i&&(e.watchAll=!0),t),rI=s=>/^\w*$/.test(s),$F=s=>Sv(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Xi=(s,e,t)=>{let i=-1;const r=rI(e)?[e]:$F(e),n=r.length,a=n-1;for(;++i<n;){const o=r[i];let l=t;if(i!==a){const h=s[o];l=qr(h)||Array.isArray(h)?h:isNaN(+r[i+1])?{}:[]}s[o]=l,s=s[o]}return s},C5=(s,e,t,i,r)=>e?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[i]:r||!0}}:{},_D=s=>({isOnSubmit:!s||s===Ca.onSubmit,isOnBlur:s===Ca.onBlur,isOnChange:s===Ca.onChange,isOnAll:s===Ca.all,isOnTouch:s===Ca.onTouched}),WD=(s,e,t)=>!t&&(e.watchAll||e.watch.has(s)||[...e.watch].some(i=>s.startsWith(i)&&/^\.\w+/.test(s.slice(i.length))));const qp=(s,e,t,i)=>{for(const r of t||Object.keys(s)){const n=at(s,r);if(n){const{_f:a,...o}=n;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],r)&&!i)break;if(a.ref&&e(a.ref,a.name)&&!i)break;qp(o,e)}else qr(o)&&qp(o,e)}}};var S5=(s,e,t)=>{const i=Sv(at(s,t));return Xi(i,"root",e[t]),Xi(s,t,i),s},nI=s=>s.type==="file",Dl=s=>typeof s=="function",fy=s=>{if(!iI)return!1;const e=s?s.ownerDocument:0;return s instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},xg=s=>Xa(s),sI=s=>s.type==="radio",vy=s=>s instanceof RegExp;const qD={value:!1,isValid:!1},YD={value:!0,isValid:!0};var XF=s=>{if(Array.isArray(s)){if(s.length>1){const e=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Sr(s[0].attributes.value)?Sr(s[0].value)||s[0].value===""?YD:{value:s[0].value,isValid:!0}:YD:qD}return qD};const QD={isValid:!1,value:null};var KF=s=>Array.isArray(s)?s.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,QD):QD;function GD(s,e,t="validate"){if(xg(s)||Array.isArray(s)&&s.every(xg)||ko(s)&&!s)return{type:t,message:xg(s)?s:"",ref:e}}var Ru=s=>qr(s)&&!vy(s)?s:{value:s,message:""},$D=async(s,e,t,i,r)=>{const{ref:n,refs:a,required:o,maxLength:l,minLength:h,min:u,max:c,pattern:d,validate:p,name:f,valueAsNumber:v,mount:g,disabled:b}=s._f,y=at(e,f);if(!g||b)return{};const C=a?a[0]:n,x=L=>{i&&C.reportValidity&&(C.setCustomValidity(ko(L)?"":L||""),C.reportValidity())},w={},M=sI(n),E=Cv(n),T=M||E,D=(v||nI(n))&&Sr(n.value)&&Sr(y)||fy(n)&&n.value===""||y===""||Array.isArray(y)&&!y.length,N=C5.bind(null,f,t,w),A=(L,k,O,R=po.maxLength,j=po.minLength)=>{const P=L?k:O;w[f]={type:L?R:j,message:P,ref:n,...N(L?R:j,P)}};if(r?!Array.isArray(y)||!y.length:o&&(!T&&(D||Wn(y))||ko(y)&&!y||E&&!XF(a).isValid||M&&!KF(a).isValid)){const{value:L,message:k}=xg(o)?{value:!!o,message:o}:Ru(o);if(L&&(w[f]={type:po.required,message:k,ref:C,...N(po.required,k)},!t))return x(k),w}if(!D&&(!Wn(u)||!Wn(c))){let L,k;const O=Ru(c),R=Ru(u);if(!Wn(y)&&!isNaN(y)){const j=n.valueAsNumber||y&&+y;Wn(O.value)||(L=j>O.value),Wn(R.value)||(k=j<R.value)}else{const j=n.valueAsDate||new Date(y),P=q=>new Date(new Date().toDateString()+" "+q),F=n.type=="time",z=n.type=="week";Xa(O.value)&&y&&(L=F?P(y)>P(O.value):z?y>O.value:j>new Date(O.value)),Xa(R.value)&&y&&(k=F?P(y)<P(R.value):z?y<R.value:j<new Date(R.value))}if((L||k)&&(A(!!L,O.message,R.message,po.max,po.min),!t))return x(w[f].message),w}if((l||h)&&!D&&(Xa(y)||r&&Array.isArray(y))){const L=Ru(l),k=Ru(h),O=!Wn(L.value)&&y.length>+L.value,R=!Wn(k.value)&&y.length<+k.value;if((O||R)&&(A(O,L.message,k.message),!t))return x(w[f].message),w}if(d&&!D&&Xa(y)){const{value:L,message:k}=Ru(d);if(vy(L)&&!y.match(L)&&(w[f]={type:po.pattern,message:k,ref:n,...N(po.pattern,k)},!t))return x(k),w}if(p){if(Dl(p)){const L=await p(y,e),k=GD(L,C);if(k&&(w[f]={...k,...N(po.validate,k.message)},!t))return x(k.message),w}else if(qr(p)){let L={};for(const k in p){if(!_s(L)&&!t)break;const O=GD(await p[k](y,e),C,k);O&&(L={...O,...N(k,O.message)},x(O.message),t&&(w[f]=L))}if(!_s(L)&&(w[f]={ref:C,...L},!t))return w}}return x(!0),w};function x5(s,e){const t=e.slice(0,-1).length;let i=0;for(;i<t;)s=Sr(s)?i++:s[e[i++]];return s}function w5(s){for(const e in s)if(s.hasOwnProperty(e)&&!Sr(s[e]))return!1;return!0}function fn(s,e){const t=Array.isArray(e)?e:rI(e)?[e]:$F(e),i=t.length===1?s:x5(s,t),r=t.length-1,n=t[r];return i&&delete i[n],r!==0&&(qr(i)&&_s(i)||Array.isArray(i)&&w5(i))&&fn(s,t.slice(0,-1)),s}var xC=()=>{let s=[];return{get observers(){return s},next:r=>{for(const n of s)n.next&&n.next(r)},subscribe:r=>(s.push(r),{unsubscribe:()=>{s=s.filter(n=>n!==r)}}),unsubscribe:()=>{s=[]}}},my=s=>Wn(s)||!GF(s);function Ph(s,e){if(my(s)||my(e))return s===e;if(Sc(s)&&Sc(e))return s.getTime()===e.getTime();const t=Object.keys(s),i=Object.keys(e);if(t.length!==i.length)return!1;for(const r of t){const n=s[r];if(!i.includes(r))return!1;if(r!=="ref"){const a=e[r];if(Sc(n)&&Sc(a)||qr(n)&&qr(a)||Array.isArray(n)&&Array.isArray(a)?!Ph(n,a):n!==a)return!1}}return!0}var ZF=s=>s.type==="select-multiple",M5=s=>sI(s)||Cv(s),wC=s=>fy(s)&&s.isConnected,JF=s=>{for(const e in s)if(Dl(s[e]))return!0;return!1};function gy(s,e={}){const t=Array.isArray(s);if(qr(s)||t)for(const i in s)Array.isArray(s[i])||qr(s[i])&&!JF(s[i])?(e[i]=Array.isArray(s[i])?[]:{},gy(s[i],e[i])):Wn(s[i])||(e[i]=!0);return e}function eP(s,e,t){const i=Array.isArray(s);if(qr(s)||i)for(const r in s)Array.isArray(s[r])||qr(s[r])&&!JF(s[r])?Sr(e)||my(t[r])?t[r]=Array.isArray(s[r])?gy(s[r],[]):{...gy(s[r])}:eP(s[r],Wn(e)?{}:e[r],t[r]):t[r]=!Ph(s[r],e[r]);return t}var MC=(s,e)=>eP(s,e,gy(e)),tP=(s,{valueAsNumber:e,valueAsDate:t,setValueAs:i})=>Sr(s)?s:e?s===""?NaN:s&&+s:t&&Xa(s)?new Date(s):i?i(s):s;function EC(s){const e=s.ref;if(!(s.refs?s.refs.every(t=>t.disabled):e.disabled))return nI(e)?e.files:sI(e)?KF(s.refs).value:ZF(e)?[...e.selectedOptions].map(({value:t})=>t):Cv(e)?XF(s.refs).value:tP(Sr(e.value)?s.ref.value:e.value,s)}var E5=(s,e,t,i)=>{const r={};for(const n of s){const a=at(e,n);a&&Xi(r,n,a._f)}return{criteriaMode:t,names:[...s],fields:r,shouldUseNativeValidation:i}},Gd=s=>Sr(s)?s:vy(s)?s.source:qr(s)?vy(s.value)?s.value.source:s.value:s,I5=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate);function XD(s,e,t){const i=at(s,t);if(i||rI(t))return{error:i,name:t};const r=t.split(".");for(;r.length;){const n=r.join("."),a=at(e,n),o=at(s,n);if(a&&!Array.isArray(a)&&t!==n)return{name:t};if(o&&o.type)return{name:n,error:o};r.pop()}return{name:t}}var T5=(s,e,t,i,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||s):(t?i.isOnBlur:r.isOnBlur)?!s:(t?i.isOnChange:r.isOnChange)?s:!0,D5=(s,e)=>!Sv(at(s,e)).length&&fn(s,e);const A5={mode:Ca.onSubmit,reValidateMode:Ca.onChange,shouldFocusError:!0};function N5(s={},e){let t={...A5,...s},i={submitCount:0,isDirty:!1,isLoading:Dl(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},n=qr(t.defaultValues)||qr(t.values)?Vs(t.defaultValues||t.values)||{}:{},a=t.shouldUnregister?{}:Vs(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},h,u=0;const c={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={values:xC(),array:xC(),state:xC()},p=_D(t.mode),f=_D(t.reValidateMode),v=t.criteriaMode===Ca.all,g=K=>ue=>{clearTimeout(u),u=setTimeout(K,ue)},b=async K=>{if(c.isValid||K){const ue=t.resolver?_s((await D()).errors):await A(r,!0);ue!==i.isValid&&d.state.next({isValid:ue})}},y=K=>c.isValidating&&d.state.next({isValidating:K}),C=(K,ue=[],Me,Ae,Be=!0,_e=!0)=>{if(Ae&&Me){if(o.action=!0,_e&&Array.isArray(at(r,K))){const it=Me(at(r,K),Ae.argA,Ae.argB);Be&&Xi(r,K,it)}if(_e&&Array.isArray(at(i.errors,K))){const it=Me(at(i.errors,K),Ae.argA,Ae.argB);Be&&Xi(i.errors,K,it),D5(i.errors,K)}if(c.touchedFields&&_e&&Array.isArray(at(i.touchedFields,K))){const it=Me(at(i.touchedFields,K),Ae.argA,Ae.argB);Be&&Xi(i.touchedFields,K,it)}c.dirtyFields&&(i.dirtyFields=MC(n,a)),d.state.next({name:K,isDirty:k(K,ue),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else Xi(a,K,ue)},x=(K,ue)=>{Xi(i.errors,K,ue),d.state.next({errors:i.errors})},w=K=>{i.errors=K,d.state.next({errors:i.errors,isValid:!1})},M=(K,ue,Me,Ae)=>{const Be=at(r,K);if(Be){const _e=at(a,K,Sr(Me)?at(n,K):Me);Sr(_e)||Ae&&Ae.defaultChecked||ue?Xi(a,K,ue?_e:EC(Be._f)):j(K,_e),o.mount&&b()}},E=(K,ue,Me,Ae,Be)=>{let _e=!1,it=!1;const Si={name:K},vr=!!(at(r,K)&&at(r,K)._f.disabled);if(!Me||Ae){c.isDirty&&(it=i.isDirty,i.isDirty=Si.isDirty=k(),_e=it!==Si.isDirty);const ds=vr||Ph(at(n,K),ue);it=!!(!vr&&at(i.dirtyFields,K)),ds||vr?fn(i.dirtyFields,K):Xi(i.dirtyFields,K,!0),Si.dirtyFields=i.dirtyFields,_e=_e||c.dirtyFields&&it!==!ds}if(Me){const ds=at(i.touchedFields,K);ds||(Xi(i.touchedFields,K,Me),Si.touchedFields=i.touchedFields,_e=_e||c.touchedFields&&ds!==Me)}return _e&&Be&&d.state.next(Si),_e?Si:{}},T=(K,ue,Me,Ae)=>{const Be=at(i.errors,K),_e=c.isValid&&ko(ue)&&i.isValid!==ue;if(s.delayError&&Me?(h=g(()=>x(K,Me)),h(s.delayError)):(clearTimeout(u),h=null,Me?Xi(i.errors,K,Me):fn(i.errors,K)),(Me?!Ph(Be,Me):Be)||!_s(Ae)||_e){const it={...Ae,..._e&&ko(ue)?{isValid:ue}:{},errors:i.errors,name:K};i={...i,...it},d.state.next(it)}y(!1)},D=async K=>t.resolver(a,t.context,E5(K||l.mount,r,t.criteriaMode,t.shouldUseNativeValidation)),N=async K=>{const{errors:ue}=await D(K);if(K)for(const Me of K){const Ae=at(ue,Me);Ae?Xi(i.errors,Me,Ae):fn(i.errors,Me)}else i.errors=ue;return ue},A=async(K,ue,Me={valid:!0})=>{for(const Ae in K){const Be=K[Ae];if(Be){const{_f:_e,...it}=Be;if(_e){const Si=l.array.has(_e.name),vr=await $D(Be,a,v,t.shouldUseNativeValidation&&!ue,Si);if(vr[_e.name]&&(Me.valid=!1,ue))break;!ue&&(at(vr,_e.name)?Si?S5(i.errors,vr,_e.name):Xi(i.errors,_e.name,vr[_e.name]):fn(i.errors,_e.name))}it&&await A(it,ue,Me)}}return Me.valid},L=()=>{for(const K of l.unMount){const ue=at(r,K);ue&&(ue._f.refs?ue._f.refs.every(Me=>!wC(Me)):!wC(ue._f.ref))&&be(K)}l.unMount=new Set},k=(K,ue)=>(K&&ue&&Xi(a,K,ue),!Ph(G(),n)),O=(K,ue,Me)=>b5(K,l,{...o.mount?a:Sr(ue)?n:Xa(K)?{[K]:ue}:ue},Me,ue),R=K=>Sv(at(o.mount?a:n,K,s.shouldUnregister?at(n,K,[]):[])),j=(K,ue,Me={})=>{const Ae=at(r,K);let Be=ue;if(Ae){const _e=Ae._f;_e&&(!_e.disabled&&Xi(a,K,tP(ue,_e)),Be=fy(_e.ref)&&Wn(ue)?"":ue,ZF(_e.ref)?[..._e.ref.options].forEach(it=>it.selected=Be.includes(it.value)):_e.refs?Cv(_e.ref)?_e.refs.length>1?_e.refs.forEach(it=>(!it.defaultChecked||!it.disabled)&&(it.checked=Array.isArray(Be)?!!Be.find(Si=>Si===it.value):Be===it.value)):_e.refs[0]&&(_e.refs[0].checked=!!Be):_e.refs.forEach(it=>it.checked=it.value===Be):nI(_e.ref)?_e.ref.value="":(_e.ref.value=Be,_e.ref.type||d.values.next({name:K,values:{...a}})))}(Me.shouldDirty||Me.shouldTouch)&&E(K,Be,Me.shouldTouch,Me.shouldDirty,!0),Me.shouldValidate&&X(K)},P=(K,ue,Me)=>{for(const Ae in ue){const Be=ue[Ae],_e=`${K}.${Ae}`,it=at(r,_e);(l.array.has(K)||!my(Be)||it&&!it._f)&&!Sc(Be)?P(_e,Be,Me):j(_e,Be,Me)}},F=(K,ue,Me={})=>{const Ae=at(r,K),Be=l.array.has(K),_e=Vs(ue);Xi(a,K,_e),Be?(d.array.next({name:K,values:{...a}}),(c.isDirty||c.dirtyFields)&&Me.shouldDirty&&d.state.next({name:K,dirtyFields:MC(n,a),isDirty:k(K,_e)})):Ae&&!Ae._f&&!Wn(_e)?P(K,_e,Me):j(K,_e,Me),WD(K,l)&&d.state.next({...i}),d.values.next({name:K,values:{...a}}),!o.mount&&e()},z=async K=>{const ue=K.target;let Me=ue.name,Ae=!0;const Be=at(r,Me),_e=()=>ue.type?EC(Be._f):d5(K),it=Si=>{Ae=Number.isNaN(Si)||Si===at(a,Me,Si)};if(Be){let Si,vr;const ds=_e(),Fs=K.type===UD.BLUR||K.type===UD.FOCUS_OUT,Bd=!I5(Be._f)&&!t.resolver&&!at(i.errors,Me)&&!Be._f.deps||T5(Fs,at(i.touchedFields,Me),i.isSubmitted,f,p),Lu=WD(Me,l,Fs);Xi(a,Me,ds),Fs?(Be._f.onBlur&&Be._f.onBlur(K),h&&h(0)):Be._f.onChange&&Be._f.onChange(K);const Pb=E(Me,ds,Fs,!1),$2=!_s(Pb)||Lu;if(!Fs&&d.values.next({name:Me,type:K.type,values:{...a}}),Bd)return c.isValid&&b(),$2&&d.state.next({name:Me,...Lu?{}:Pb});if(!Fs&&Lu&&d.state.next({...i}),y(!0),t.resolver){const{errors:ZI}=await D([Me]);if(it(ds),Ae){const X2=XD(i.errors,r,Me),JI=XD(ZI,r,X2.name||Me);Si=JI.error,Me=JI.name,vr=_s(ZI)}}else Si=(await $D(Be,a,v,t.shouldUseNativeValidation))[Me],it(ds),Ae&&(Si?vr=!1:c.isValid&&(vr=await A(r,!0)));Ae&&(Be._f.deps&&X(Be._f.deps),T(Me,vr,Si,Pb))}},q=(K,ue)=>{if(at(i.errors,ue)&&K.focus)return K.focus(),1},X=async(K,ue={})=>{let Me,Ae;const Be=SC(K);if(y(!0),t.resolver){const _e=await N(Sr(K)?K:Be);Me=_s(_e),Ae=K?!Be.some(it=>at(_e,it)):Me}else K?(Ae=(await Promise.all(Be.map(async _e=>{const it=at(r,_e);return await A(it&&it._f?{[_e]:it}:it)}))).every(Boolean),!(!Ae&&!i.isValid)&&b()):Ae=Me=await A(r);return d.state.next({...!Xa(K)||c.isValid&&Me!==i.isValid?{}:{name:K},...t.resolver||!K?{isValid:Me}:{},errors:i.errors,isValidating:!1}),ue.shouldFocus&&!Ae&&qp(r,q,K?Be:l.mount),Ae},G=K=>{const ue={...n,...o.mount?a:{}};return Sr(K)?ue:Xa(K)?at(ue,K):K.map(Me=>at(ue,Me))},Z=(K,ue)=>({invalid:!!at((ue||i).errors,K),isDirty:!!at((ue||i).dirtyFields,K),isTouched:!!at((ue||i).touchedFields,K),error:at((ue||i).errors,K)}),se=K=>{K&&SC(K).forEach(ue=>fn(i.errors,ue)),d.state.next({errors:K?i.errors:{}})},oe=(K,ue,Me)=>{const Ae=(at(r,K,{_f:{}})._f||{}).ref;Xi(i.errors,K,{...ue,ref:Ae}),d.state.next({name:K,errors:i.errors,isValid:!1}),Me&&Me.shouldFocus&&Ae&&Ae.focus&&Ae.focus()},fe=(K,ue)=>Dl(K)?d.values.subscribe({next:Me=>K(O(void 0,ue),Me)}):O(K,ue,!0),be=(K,ue={})=>{for(const Me of K?SC(K):l.mount)l.mount.delete(Me),l.array.delete(Me),ue.keepValue||(fn(r,Me),fn(a,Me)),!ue.keepError&&fn(i.errors,Me),!ue.keepDirty&&fn(i.dirtyFields,Me),!ue.keepTouched&&fn(i.touchedFields,Me),!t.shouldUnregister&&!ue.keepDefaultValue&&fn(n,Me);d.values.next({values:{...a}}),d.state.next({...i,...ue.keepDirty?{isDirty:k()}:{}}),!ue.keepIsValid&&b()},Ne=({disabled:K,name:ue,field:Me,fields:Ae,value:Be})=>{if(ko(K)){const _e=K?void 0:Sr(Be)?EC(Me?Me._f:at(Ae,ue)._f):Be;Xi(a,ue,_e),E(ue,_e,!1,!1,!0)}},we=(K,ue={})=>{let Me=at(r,K);const Ae=ko(ue.disabled);return Xi(r,K,{...Me||{},_f:{...Me&&Me._f?Me._f:{ref:{name:K}},name:K,mount:!0,...ue}}),l.mount.add(K),Me?Ne({field:Me,disabled:ue.disabled,name:K,value:ue.value}):M(K,!0,ue.value),{...Ae?{disabled:ue.disabled}:{},...t.progressive?{required:!!ue.required,min:Gd(ue.min),max:Gd(ue.max),minLength:Gd(ue.minLength),maxLength:Gd(ue.maxLength),pattern:Gd(ue.pattern)}:{},name:K,onChange:z,onBlur:z,ref:Be=>{if(Be){we(K,ue),Me=at(r,K);const _e=Sr(Be.value)&&Be.querySelectorAll&&Be.querySelectorAll("input,select,textarea")[0]||Be,it=M5(_e),Si=Me._f.refs||[];if(it?Si.find(vr=>vr===_e):_e===Me._f.ref)return;Xi(r,K,{_f:{...Me._f,...it?{refs:[...Si.filter(wC),_e,...Array.isArray(at(n,K))?[{}]:[]],ref:{type:_e.type,name:K}}:{ref:_e}}}),M(K,!1,void 0,_e)}else Me=at(r,K,{}),Me._f&&(Me._f.mount=!1),(t.shouldUnregister||ue.shouldUnregister)&&!(f5(l.array,K)&&o.action)&&l.unMount.add(K)}}},H=()=>t.shouldFocusError&&qp(r,q,l.mount),V=K=>{ko(K)&&(d.state.next({disabled:K}),qp(r,(ue,Me)=>{let Ae=K;const Be=at(r,Me);Be&&ko(Be._f.disabled)&&(Ae||(Ae=Be._f.disabled)),ue.disabled=Ae},0,!1))},re=(K,ue)=>async Me=>{Me&&(Me.preventDefault&&Me.preventDefault(),Me.persist&&Me.persist());let Ae=Vs(a);if(d.state.next({isSubmitting:!0}),t.resolver){const{errors:Be,values:_e}=await D();i.errors=Be,Ae=_e}else await A(r);fn(i.errors,"root"),_s(i.errors)?(d.state.next({errors:{}}),await K(Ae,Me)):(ue&&await ue({...i.errors},Me),H(),setTimeout(H)),d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:_s(i.errors),submitCount:i.submitCount+1,errors:i.errors})},he=(K,ue={})=>{at(r,K)&&(Sr(ue.defaultValue)?F(K,Vs(at(n,K))):(F(K,ue.defaultValue),Xi(n,K,Vs(ue.defaultValue))),ue.keepTouched||fn(i.touchedFields,K),ue.keepDirty||(fn(i.dirtyFields,K),i.isDirty=ue.defaultValue?k(K,Vs(at(n,K))):k()),ue.keepError||(fn(i.errors,K),c.isValid&&b()),d.state.next({...i}))},Ie=(K,ue={})=>{const Me=K?Vs(K):n,Ae=Vs(Me),Be=K&&!_s(K)?Ae:n;if(ue.keepDefaultValues||(n=Me),!ue.keepValues){if(ue.keepDirtyValues)for(const _e of l.mount)at(i.dirtyFields,_e)?Xi(Be,_e,at(a,_e)):F(_e,at(Be,_e));else{if(iI&&Sr(K))for(const _e of l.mount){const it=at(r,_e);if(it&&it._f){const Si=Array.isArray(it._f.refs)?it._f.refs[0]:it._f.ref;if(fy(Si)){const vr=Si.closest("form");if(vr){vr.reset();break}}}}r={}}a=s.shouldUnregister?ue.keepDefaultValues?Vs(n):{}:Vs(Be),d.array.next({values:{...Be}}),d.values.next({values:{...Be}})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!o.mount&&e(),o.mount=!c.isValid||!!ue.keepIsValid,o.watch=!!s.shouldUnregister,d.state.next({submitCount:ue.keepSubmitCount?i.submitCount:0,isDirty:ue.keepDirty?i.isDirty:!!(ue.keepDefaultValues&&!Ph(K,n)),isSubmitted:ue.keepIsSubmitted?i.isSubmitted:!1,dirtyFields:ue.keepDirtyValues?i.dirtyFields:ue.keepDefaultValues&&K?MC(n,K):{},touchedFields:ue.keepTouched?i.touchedFields:{},errors:ue.keepErrors?i.errors:{},isSubmitSuccessful:ue.keepIsSubmitSuccessful?i.isSubmitSuccessful:!1,isSubmitting:!1})},Te=(K,ue)=>Ie(Dl(K)?K(a):K,ue);return{control:{register:we,unregister:be,getFieldState:Z,handleSubmit:re,setError:oe,_executeSchema:D,_getWatch:O,_getDirty:k,_updateValid:b,_removeUnmounted:L,_updateFieldArray:C,_updateDisabledField:Ne,_getFieldArray:R,_reset:Ie,_resetDefaultValues:()=>Dl(t.defaultValues)&&t.defaultValues().then(K=>{Te(K,t.resetOptions),d.state.next({isLoading:!1})}),_updateFormState:K=>{i={...i,...K}},_disableForm:V,_subjects:d,_proxyFormState:c,_setErrors:w,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(K){o=K},get _defaultValues(){return n},get _names(){return l},set _names(K){l=K},get _formState(){return i},set _formState(K){i=K},get _options(){return t},set _options(K){t={...t,...K}}},trigger:X,register:we,handleSubmit:re,watch:fe,setValue:F,getValues:G,reset:Te,resetField:he,clearErrors:se,unregister:be,setError:oe,setFocus:(K,ue={})=>{const Me=at(r,K),Ae=Me&&Me._f;if(Ae){const Be=Ae.refs?Ae.refs[0]:Ae.ref;Be.focus&&(Be.focus(),ue.shouldSelect&&Be.select())}},getFieldState:Z}}function k5(s={}){const e=Lt.useRef(),t=Lt.useRef(),[i,r]=Lt.useState({isDirty:!1,isValidating:!1,isLoading:Dl(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:s.errors||{},disabled:s.disabled||!1,defaultValues:Dl(s.defaultValues)?void 0:s.defaultValues});e.current||(e.current={...N5(s,()=>r(a=>({...a}))),formState:i});const n=e.current.control;return n._options=s,y5({subject:n._subjects.state,next:a=>{g5(a,n._proxyFormState,n._updateFormState,!0)&&r({...n._formState})}}),Lt.useEffect(()=>n._disableForm(s.disabled),[n,s.disabled]),Lt.useEffect(()=>{if(n._proxyFormState.isDirty){const a=n._getDirty();a!==i.isDirty&&n._subjects.state.next({isDirty:a})}},[n,i.isDirty]),Lt.useEffect(()=>{s.values&&!Ph(s.values,t.current)?(n._reset(s.values,n._options.resetOptions),t.current=s.values,r(a=>({...a}))):n._resetDefaultValues()},[s.values,n]),Lt.useEffect(()=>{s.errors&&n._setErrors(s.errors)},[s.errors,n]),Lt.useEffect(()=>{n._state.mount||(n._updateValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),e.current.formState=m5(i,n),e.current}const KD=()=>{var l,h;const[s,e]=le.useState(),t=Iu(),i=ob(),{register:r,handleSubmit:n,formState:{errors:a}}=k5(),o=async u=>{e(!0),console.log("email",u.email,"password",u.password);try{const d=(await Zs.collection("users").authWithPassword(u.email,u.password)).record;t.logIn(d),console.log("Login Success"),i("/home",{state:d})}catch(c){e(!1),console.log(" 24 Error logging in ["+c)}e(!1)};return J.jsx("section",{className:"bg-gray-50 dark:bg-gray-900",children:J.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0",children:[J.jsx("a",{href:"#",className:"flex items-center mb-6 text-2xl font-semibold text-gray-900 dark:text-white",children:J.jsx("img",{src:lb,alt:"Logo",className:"w-20"})}),J.jsx("div",{className:"w-full bg-white rounded-lg shadow dark:border md:mt-0 sm:max-w-md xl:p-0 dark:bg-gray-800 dark:border-gray-700",children:J.jsxs("div",{className:"p-6 space-y-4 md:space-y-6 sm:p-8",children:[J.jsx("h1",{className:"text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl dark:text-white",children:"Sign in to Mobile App Manager"}),J.jsxs("form",{onSubmit:n(u=>{console.log(u),o(u)}),className:"space-y-4 md:space-y-6",action:"#",children:[J.jsxs("div",{children:[J.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Your email"}),J.jsx("input",{type:"email",...r("email",{required:"Email is required"}),id:"email",autoComplete:"false",className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"name@some.com",required:""}),J.jsx("p",{className:"text-red-300",children:(l=a.email)==null?void 0:l.message})]}),J.jsxs("div",{children:[J.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Password"}),J.jsx("input",{type:"password",...r("password",{required:"Password is required",minLength:{value:4,message:"Minimum length is 4"}}),autoComplete:"false",id:"password",placeholder:"••••••••",className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""}),J.jsx("p",{className:"text-red-300",children:(h=a.password)==null?void 0:h.message})]}),J.jsx("div",{className:"flex items-center justify-between"}),J.jsx("button",{type:"submit",className:"w-full text-white bg-primary hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800",children:"Sign in"})]})]})})]})})};function L5({title:s,titleId:e,...t},i){return le.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),s?le.createElement("title",{id:e},s):null,le.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z",clipRule:"evenodd"}))}const O5=le.forwardRef(L5),IC=O5;function R5({title:s,titleId:e,...t},i){return le.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),s?le.createElement("title",{id:e},s):null,le.createElement("path",{fillRule:"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z",clipRule:"evenodd"}))}const F5=le.forwardRef(R5),TC=F5;/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yy(){return yy=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},yy.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function by(){return by=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},by.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fu(s,e,t){var i,r=(i=t.initialDeps)!=null?i:[],n;return function(){var a;t.key&&t.debug!=null&&t.debug()&&(a=Date.now());var o=s(),l=o.length!==r.length||o.some(function(f,v){return r[v]!==f});if(!l)return n;r=o;var h;if(t.key&&t.debug!=null&&t.debug()&&(h=Date.now()),n=e.apply(void 0,o),t.key&&t.debug!=null&&t.debug()){var u=Math.round((Date.now()-a)*100)/100,c=Math.round((Date.now()-h)*100)/100,d=c/16,p=function(v,g){for(v=String(v);v.length<g;)v=" "+v;return v};console.info("%c⏱ "+p(c,5)+" /"+p(u,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*d,120))+"deg 100% 31%);",t==null?void 0:t.key)}return t==null||t.onChange==null||t.onChange(n),n}}function DC(s,e){if(s===void 0)throw new Error("Unexpected undefined"+(e?": "+e:""));return s}var P5=function(e,t){return Math.abs(e-t)<1};/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var z5=function(e){return e},j5=function(e){for(var t=Math.max(e.startIndex-e.overscan,0),i=Math.min(e.endIndex+e.overscan,e.count-1),r=[],n=t;n<=i;n++)r.push(n);return r},B5=function(e,t){var i=e.scrollElement;if(i){var r=function(o){var l=o.width,h=o.height;t({width:Math.round(l),height:Math.round(h)})};r(i.getBoundingClientRect());var n=new ResizeObserver(function(a){var o=a[0];if(o!=null&&o.borderBoxSize){var l=o.borderBoxSize[0];if(l){r({width:l.inlineSize,height:l.blockSize});return}}r(i.getBoundingClientRect())});return n.observe(i,{box:"border-box"}),function(){n.unobserve(i)}}},H5=function(e,t){var i=e.scrollElement;if(i){var r=function(){t(i[e.options.horizontal?"scrollLeft":"scrollTop"])};return r(),i.addEventListener("scroll",r,{passive:!0}),function(){i.removeEventListener("scroll",r)}}},V5=function(e,t,i){if(t!=null&&t.borderBoxSize){var r=t.borderBoxSize[0];if(r){var n=Math.round(r[i.options.horizontal?"inlineSize":"blockSize"]);return n}}return Math.round(e.getBoundingClientRect()[i.options.horizontal?"width":"height"])},U5=function(e,t,i){var r,n,a=t.adjustments,o=a===void 0?0:a,l=t.behavior,h=e+o;(r=i.scrollElement)==null||r.scrollTo==null||r.scrollTo((n={},n[i.options.horizontal?"left":"top"]=h,n.behavior=l,n))},_5=function(e){var t=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=function(){var i=null,r=function(){return i||(typeof ResizeObserver<"u"?i=new ResizeObserver(function(a){a.forEach(function(o){t._measureElement(o.target,o)})}):null)};return{disconnect:function(){var a;return(a=r())==null?void 0:a.disconnect()},observe:function(a){var o;return(o=r())==null?void 0:o.observe(a,{box:"border-box"})},unobserve:function(a){var o;return(o=r())==null?void 0:o.unobserve(a)}}}(),this.range=null,this.setOptions=function(i){Object.entries(i).forEach(function(r){var n=r[0],a=r[1];typeof a>"u"&&delete i[n]}),t.options=by({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:z5,rangeExtractor:j5,onChange:function(){},measureElement:V5,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},i)},this.notify=function(i){t.options.onChange==null||t.options.onChange(t,i)},this.maybeNotify=Fu(function(){return t.calculateRange(),[t.isScrolling,t.range?t.range.startIndex:null,t.range?t.range.endIndex:null]},function(i){t.notify(i)},{key:!1,debug:function(){return t.options.debug},initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=function(){t.unsubs.filter(Boolean).forEach(function(i){return i()}),t.unsubs=[],t.scrollElement=null},this._didMount=function(){return t.measureElementCache.forEach(t.observer.observe),function(){t.observer.disconnect(),t.cleanup()}},this._willUpdate=function(){var i=t.options.getScrollElement();t.scrollElement!==i&&(t.cleanup(),t.scrollElement=i,t._scrollToOffset(t.scrollOffset,{adjustments:void 0,behavior:void 0}),t.unsubs.push(t.options.observeElementRect(t,function(r){t.scrollRect=r,t.maybeNotify()})),t.unsubs.push(t.options.observeElementOffset(t,function(r){t.scrollAdjustments=0,t.scrollOffset!==r&&(t.isScrollingTimeoutId!==null&&(clearTimeout(t.isScrollingTimeoutId),t.isScrollingTimeoutId=null),t.isScrolling=!0,t.scrollDirection=t.scrollOffset<r?"forward":"backward",t.scrollOffset=r,t.maybeNotify(),t.isScrollingTimeoutId=setTimeout(function(){t.isScrollingTimeoutId=null,t.isScrolling=!1,t.scrollDirection=null,t.maybeNotify()},t.options.scrollingDelay))})))},this.getSize=function(){return t.scrollRect[t.options.horizontal?"width":"height"]},this.memoOptions=Fu(function(){return[t.options.count,t.options.paddingStart,t.options.scrollMargin,t.options.getItemKey]},function(i,r,n,a){return t.pendingMeasuredCacheIndexes=[],{count:i,paddingStart:r,scrollMargin:n,getItemKey:a}},{key:!1}),this.getFurthestMeasurement=function(i,r){for(var n=new Map,a=new Map,o=r-1;o>=0;o--){var l=i[o];if(!n.has(l.lane)){var h=a.get(l.lane);if(h==null||l.end>h.end?a.set(l.lane,l):l.end<h.end&&n.set(l.lane,!0),n.size===t.options.lanes)break}}return a.size===t.options.lanes?Array.from(a.values()).sort(function(u,c){return u.end-c.end})[0]:void 0},this.getMeasurements=Fu(function(){return[t.memoOptions(),t.itemSizeCache]},function(i,r){var n=i.count,a=i.paddingStart,o=i.scrollMargin,l=i.getItemKey,h=t.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,t.pendingMeasuredCacheIndexes):0;t.pendingMeasuredCacheIndexes=[];for(var u=t.measurementsCache.slice(0,h),c=h;c<n;c++){var d=l(c),p=t.options.lanes===1?u[c-1]:t.getFurthestMeasurement(u,c),f=p?p.end:a+o,v=r.get(d),g=typeof v=="number"?v:t.options.estimateSize(c),b=f+g,y=p?p.lane:c%t.options.lanes;u[c]={index:c,start:f,size:g,end:b,key:d,lane:y}}return t.measurementsCache=u,u},{key:!1,debug:function(){return t.options.debug}}),this.calculateRange=Fu(function(){return[t.getMeasurements(),t.getSize(),t.scrollOffset]},function(i,r,n){return t.range=i.length>0&&r>0?W5({measurements:i,outerSize:r,scrollOffset:n}):null},{key:!1,debug:function(){return t.options.debug}}),this.getIndexes=Fu(function(){return[t.options.rangeExtractor,t.calculateRange(),t.options.overscan,t.options.count]},function(i,r,n,a){return r===null?[]:i(by({},r,{overscan:n,count:a}))},{key:!1,debug:function(){return t.options.debug}}),this.indexFromElement=function(i){var r=t.options.indexAttribute,n=i.getAttribute(r);return n?parseInt(n,10):(console.warn("Missing attribute name '"+r+"={index}' on measured element."),-1)},this._measureElement=function(i,r){var n=t.measurementsCache[t.indexFromElement(i)];if(!n||!i.isConnected){t.measureElementCache.forEach(function(l,h){l===i&&(t.observer.unobserve(i),t.measureElementCache.delete(h))});return}var a=t.measureElementCache.get(n.key);a!==i&&(a&&t.observer.unobserve(a),t.observer.observe(i),t.measureElementCache.set(n.key,i));var o=t.options.measureElement(i,r,t);t.resizeItem(n,o)},this.resizeItem=function(i,r){var n,a=(n=t.itemSizeCache.get(i.key))!=null?n:i.size,o=r-a;o!==0&&(i.start<t.scrollOffset&&t._scrollToOffset(t.scrollOffset,{adjustments:t.scrollAdjustments+=o,behavior:void 0}),t.pendingMeasuredCacheIndexes.push(i.index),t.itemSizeCache=new Map(t.itemSizeCache.set(i.key,r)),t.notify(!1))},this.measureElement=function(i){i&&t._measureElement(i,void 0)},this.getVirtualItems=Fu(function(){return[t.getIndexes(),t.getMeasurements()]},function(i,r){for(var n=[],a=0,o=i.length;a<o;a++){var l=i[a],h=r[l];n.push(h)}return n},{key:!1,debug:function(){return t.options.debug}}),this.getVirtualItemForOffset=function(i){var r=t.getMeasurements();return DC(r[iP(0,r.length-1,function(n){return DC(r[n]).start},i)])},this.getOffsetForAlignment=function(i,r){var n=t.getSize();r==="auto"&&(i<=t.scrollOffset?r="start":i>=t.scrollOffset+n?r="end":r="start"),r==="start"?i=i:r==="end"?i=i-n:r==="center"&&(i=i-n/2);var a=t.options.horizontal?"scrollWidth":"scrollHeight",o=t.scrollElement?"document"in t.scrollElement?t.scrollElement.document.documentElement[a]:t.scrollElement[a]:0,l=o-t.getSize();return Math.max(Math.min(l,i),0)},this.getOffsetForIndex=function(i,r){r===void 0&&(r="auto"),i=Math.max(0,Math.min(i,t.options.count-1));var n=DC(t.getMeasurements()[i]);if(r==="auto")if(n.end>=t.scrollOffset+t.getSize()-t.options.scrollPaddingEnd)r="end";else if(n.start<=t.scrollOffset+t.options.scrollPaddingStart)r="start";else return[t.scrollOffset,r];var a=r==="end"?n.end+t.options.scrollPaddingEnd:n.start-t.options.scrollPaddingStart;return[t.getOffsetForAlignment(a,r),r]},this.isDynamicMode=function(){return t.measureElementCache.size>0},this.cancelScrollToIndex=function(){t.scrollToIndexTimeoutId!==null&&(clearTimeout(t.scrollToIndexTimeoutId),t.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(i,r){var n=r===void 0?{}:r,a=n.align,o=a===void 0?"start":a,l=n.behavior;t.cancelScrollToIndex(),l==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t._scrollToOffset(t.getOffsetForAlignment(i,o),{adjustments:void 0,behavior:l})},this.scrollToIndex=function(i,r){var n=r===void 0?{}:r,a=n.align,o=a===void 0?"auto":a,l=n.behavior;i=Math.max(0,Math.min(i,t.options.count-1)),t.cancelScrollToIndex(),l==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var h=t.getOffsetForIndex(i,o),u=h[0],c=h[1];t._scrollToOffset(u,{adjustments:void 0,behavior:l}),l!=="smooth"&&t.isDynamicMode()&&(t.scrollToIndexTimeoutId=setTimeout(function(){t.scrollToIndexTimeoutId=null;var d=t.measureElementCache.has(t.options.getItemKey(i));if(d){var p=t.getOffsetForIndex(i,c),f=p[0];P5(f,t.scrollOffset)||t.scrollToIndex(i,{align:c,behavior:l})}else t.scrollToIndex(i,{align:c,behavior:l})}))},this.scrollBy=function(i,r){var n=r===void 0?{}:r,a=n.behavior;t.cancelScrollToIndex(),a==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t._scrollToOffset(t.scrollOffset+i,{adjustments:void 0,behavior:a})},this.getTotalSize=function(){var i;return(((i=t.getMeasurements()[t.options.count-1])==null?void 0:i.end)||t.options.paddingStart)-t.options.scrollMargin+t.options.paddingEnd},this._scrollToOffset=function(i,r){var n=r.adjustments,a=r.behavior;t.options.scrollToFn(i,{behavior:a,adjustments:n},t)},this.measure=function(){t.itemSizeCache=new Map,t.notify(!1)},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(function(i){t.itemSizeCache.set(i.key,i.size)}),this.maybeNotify()},iP=function(e,t,i,r){for(;e<=t;){var n=(e+t)/2|0,a=i(n);if(a<r)e=n+1;else if(a>r)t=n-1;else return n}return e>0?e-1:0};function W5(s){for(var e=s.measurements,t=s.outerSize,i=s.scrollOffset,r=e.length-1,n=function(h){return e[h].start},a=iP(0,r,n,i),o=a;o<r&&e[o].end<i+t;)o++;return{startIndex:a,endIndex:o}}/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var q5=typeof document<"u"?le.useLayoutEffect:le.useEffect;function Y5(s){var e=le.useReducer(function(){return{}},{})[1],t=yy({},s,{onChange:function(a,o){o?nb.flushSync(e):e(),s.onChange==null||s.onChange(a,o)}}),i=le.useState(function(){return new _5(t)}),r=i[0];return r.setOptions(t),le.useEffect(function(){return r._didMount()},[]),q5(function(){return r._willUpdate()}),r}function Q5(s){return Y5(yy({observeElementRect:B5,observeElementOffset:H5,scrollToFn:U5},s))}var G5=Object.defineProperty,$5=(s,e,t)=>e in s?G5(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,AC=(s,e,t)=>($5(s,typeof e!="symbol"?e+"":e,t),t);let X5=class{constructor(){AC(this,"current",this.detect()),AC(this,"handoffState","pending"),AC(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Uh=new X5,$n=(s,e)=>{Uh.isServer?le.useEffect(s,e):le.useLayoutEffect(s,e)};function xv(s){let e=le.useRef(s);return $n(()=>{e.current=s},[s]),e}function aI(s,e){let[t,i]=le.useState(s),r=xv(s);return $n(()=>i(r.current),[r,i,...e]),t}let Mi=function(s){let e=xv(s);return Lt.useCallback((...t)=>e.current(...t),[e])};function K5(s,e,t){let[i,r]=le.useState(t),n=s!==void 0,a=le.useRef(n),o=le.useRef(!1),l=le.useRef(!1);return n&&!a.current&&!o.current?(o.current=!0,a.current=n,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!n&&a.current&&!l.current&&(l.current=!0,a.current=n,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[n?s:i,Mi(h=>(n||r(h),e==null?void 0:e(h)))]}function Z5(s){typeof queueMicrotask=="function"?queueMicrotask(s):Promise.resolve().then(s).catch(e=>setTimeout(()=>{throw e}))}function Cy(){let s=[],e={addEventListener(t,i,r,n){return t.addEventListener(i,r,n),e.add(()=>t.removeEventListener(i,r,n))},requestAnimationFrame(...t){let i=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(i))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let i=setTimeout(...t);return e.add(()=>clearTimeout(i))},microTask(...t){let i={current:!0};return Z5(()=>{i.current&&t[0]()}),e.add(()=>{i.current=!1})},style(t,i,r){let n=t.style.getPropertyValue(i);return Object.assign(t.style,{[i]:r}),this.add(()=>{Object.assign(t.style,{[i]:n})})},group(t){let i=Cy();return t(i),this.add(()=>i.dispose())},add(t){return s.push(t),()=>{let i=s.indexOf(t);if(i>=0)for(let r of s.splice(i,1))r()}},dispose(){for(let t of s.splice(0))t()}};return e}function oI(){let[s]=le.useState(Cy);return le.useEffect(()=>()=>s.dispose(),[s]),s}function J5(){let s=typeof document>"u";return"useSyncExternalStore"in Nx?(e=>e.useSyncExternalStore)(Nx)(()=>()=>{},()=>!1,()=>!s):!1}function eU(){let s=J5(),[e,t]=le.useState(Uh.isHandoffComplete);return e&&Uh.isHandoffComplete===!1&&t(!1),le.useEffect(()=>{e!==!0&&t(!0)},[e]),le.useEffect(()=>Uh.handoff(),[]),s?!1:e}var ZD;let wv=(ZD=Lt.useId)!=null?ZD:function(){let s=eU(),[e,t]=Lt.useState(s?()=>Uh.nextId():null);return $n(()=>{e===null&&t(Uh.nextId())},[e]),e!=null?""+e:void 0};function Bo(s,e,...t){if(s in e){let r=e[s];return typeof r=="function"?r(...t):r}let i=new Error(`Tried to handle "${s}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,Bo),i}function lI(s){return Uh.isServer?null:s instanceof Node?s.ownerDocument:s!=null&&s.hasOwnProperty("current")&&s.current instanceof Node?s.current.ownerDocument:document}let JD=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(s=>`${s}:not([tabindex='-1'])`).join(",");var tU=(s=>(s[s.First=1]="First",s[s.Previous=2]="Previous",s[s.Next=4]="Next",s[s.Last=8]="Last",s[s.WrapAround=16]="WrapAround",s[s.NoScroll=32]="NoScroll",s))(tU||{}),iU=(s=>(s[s.Error=0]="Error",s[s.Overflow=1]="Overflow",s[s.Success=2]="Success",s[s.Underflow=3]="Underflow",s))(iU||{}),rU=(s=>(s[s.Previous=-1]="Previous",s[s.Next=1]="Next",s))(rU||{}),rP=(s=>(s[s.Strict=0]="Strict",s[s.Loose=1]="Loose",s))(rP||{});function nU(s,e=0){var t;return s===((t=lI(s))==null?void 0:t.body)?!1:Bo(e,{0(){return s.matches(JD)},1(){let i=s;for(;i!==null;){if(i.matches(JD))return!0;i=i.parentElement}return!1}})}var sU=(s=>(s[s.Keyboard=0]="Keyboard",s[s.Mouse=1]="Mouse",s))(sU||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",s=>{s.metaKey||s.altKey||s.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",s=>{s.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:s.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function aU(s,e=t=>t){return s.slice().sort((t,i)=>{let r=e(t),n=e(i);if(r===null||n===null)return 0;let a=r.compareDocumentPosition(n);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function oU(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function lU(){return/Android/gi.test(window.navigator.userAgent)}function nP(){return oU()||lU()}function Kv(s,e,t){let i=xv(e);le.useEffect(()=>{function r(n){i.current(n)}return document.addEventListener(s,r,t),()=>document.removeEventListener(s,r,t)},[s,t])}function hU(s,e,t){let i=xv(e);le.useEffect(()=>{function r(n){i.current(n)}return window.addEventListener(s,r,t),()=>window.removeEventListener(s,r,t)},[s,t])}function uU(s,e,t=!0){let i=le.useRef(!1);le.useEffect(()=>{requestAnimationFrame(()=>{i.current=t})},[t]);function r(a,o){if(!i.current||a.defaultPrevented)return;let l=o(a);if(l===null||!l.getRootNode().contains(l)||!l.isConnected)return;let h=function u(c){return typeof c=="function"?u(c()):Array.isArray(c)||c instanceof Set?c:[c]}(s);for(let u of h){if(u===null)continue;let c=u instanceof HTMLElement?u:u.current;if(c!=null&&c.contains(l)||a.composed&&a.composedPath().includes(c))return}return!nU(l,rP.Loose)&&l.tabIndex!==-1&&a.preventDefault(),e(a,l)}let n=le.useRef(null);Kv("pointerdown",a=>{var o,l;i.current&&(n.current=((l=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:l[0])||a.target)},!0),Kv("mousedown",a=>{var o,l;i.current&&(n.current=((l=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:l[0])||a.target)},!0),Kv("click",a=>{nP()||n.current&&(r(a,()=>n.current),n.current=null)},!0),Kv("touchend",a=>r(a,()=>a.target instanceof HTMLElement?a.target:null),!0),hU("blur",a=>r(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function cU(...s){return le.useMemo(()=>lI(...s),[...s])}function eA(s){var e;if(s.type)return s.type;let t=(e=s.as)!=null?e:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function dU(s,e){let[t,i]=le.useState(()=>eA(s));return $n(()=>{i(eA(s))},[s.type,s.as]),$n(()=>{t||e.current&&e.current instanceof HTMLButtonElement&&!e.current.hasAttribute("type")&&i("button")},[t,e]),t}let pU=Symbol();function Mv(...s){let e=le.useRef(s);le.useEffect(()=>{e.current=s},[s]);let t=Mi(i=>{for(let r of e.current)r!=null&&(typeof r=="function"?r(i):r.current=i)});return s.every(i=>i==null||(i==null?void 0:i[pU]))?void 0:t}function tA(s){return[s.screenX,s.screenY]}function fU(){let s=le.useRef([-1,-1]);return{wasMoved(e){let t=tA(e);return s.current[0]===t[0]&&s.current[1]===t[1]?!1:(s.current=t,!0)},update(e){s.current=tA(e)}}}function vU({container:s,accept:e,walk:t,enabled:i=!0}){let r=le.useRef(e),n=le.useRef(t);le.useEffect(()=>{r.current=e,n.current=t},[e,t]),$n(()=>{if(!s||!i)return;let a=lI(s);if(!a)return;let o=r.current,l=n.current,h=Object.assign(c=>o(c),{acceptNode:o}),u=a.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,h,!1);for(;u.nextNode();)l(u.currentNode)},[s,i,r,n])}function iA(s,e){let t=le.useRef([]),i=Mi(s);le.useEffect(()=>{let r=[...t.current];for(let[n,a]of e.entries())if(t.current[n]!==a){let o=i(e,r);return t.current=e,o}},[i,...e])}function rA(...s){return Array.from(new Set(s.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}var Vw=(s=>(s[s.None=0]="None",s[s.RenderStrategy=1]="RenderStrategy",s[s.Static=2]="Static",s))(Vw||{}),mU=(s=>(s[s.Unmount=0]="Unmount",s[s.Hidden=1]="Hidden",s))(mU||{});function Tu({ourProps:s,theirProps:e,slot:t,defaultTag:i,features:r,visible:n=!0,name:a,mergeRefs:o}){o=o??gU;let l=sP(e,s);if(n)return Zv(l,t,i,a,o);let h=r??0;if(h&2){let{static:u=!1,...c}=l;if(u)return Zv(c,t,i,a,o)}if(h&1){let{unmount:u=!0,...c}=l;return Bo(u?0:1,{0(){return null},1(){return Zv({...c,hidden:!0,style:{display:"none"}},t,i,a,o)}})}return Zv(l,t,i,a,o)}function Zv(s,e={},t,i,r){let{as:n=t,children:a,refName:o="ref",...l}=NC(s,["unmount","static"]),h=s.ref!==void 0?{[o]:s.ref}:{},u=typeof a=="function"?a(e):a;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e));let c={};if(e){let d=!1,p=[];for(let[f,v]of Object.entries(e))typeof v=="boolean"&&(d=!0),v===!0&&p.push(f);d&&(c["data-headlessui-state"]=p.join(" "))}if(n===le.Fragment&&Object.keys(Uw(l)).length>0){if(!le.isValidElement(u)||Array.isArray(u)&&u.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${i} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(l).map(v=>`  - ${v}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>`  - ${v}`).join(`
`)].join(`
`));let d=u.props,p=typeof(d==null?void 0:d.className)=="function"?(...v)=>rA(d==null?void 0:d.className(...v),l.className):rA(d==null?void 0:d.className,l.className),f=p?{className:p}:{};return le.cloneElement(u,Object.assign({},sP(u.props,Uw(NC(l,["ref"]))),c,h,{ref:r(u.ref,h.ref)},f))}return le.createElement(n,Object.assign({},NC(l,["ref"]),n!==le.Fragment&&h,n!==le.Fragment&&c),u)}function gU(...s){return s.every(e=>e==null)?void 0:e=>{for(let t of s)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function sP(...s){if(s.length===0)return{};if(s.length===1)return s[0];let e={},t={};for(let i of s)for(let r in i)r.startsWith("on")&&typeof i[r]=="function"?(t[r]!=null||(t[r]=[]),t[r].push(i[r])):e[r]=i[r];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(t).map(i=>[i,void 0])));for(let i in t)Object.assign(e,{[i](r,...n){let a=t[i];for(let o of a){if((r instanceof Event||(r==null?void 0:r.nativeEvent)instanceof Event)&&r.defaultPrevented)return;o(r,...n)}}});return e}function Du(s){var e;return Object.assign(le.forwardRef(s),{displayName:(e=s.displayName)!=null?e:s.name})}function Uw(s){let e=Object.assign({},s);for(let t in e)e[t]===void 0&&delete e[t];return e}function NC(s,e=[]){let t=Object.assign({},s);for(let i of e)i in t&&delete t[i];return t}let yU="div";var aP=(s=>(s[s.None=1]="None",s[s.Focusable=2]="Focusable",s[s.Hidden=4]="Hidden",s))(aP||{});function bU(s,e){var t;let{features:i=1,...r}=s,n={ref:e,"aria-hidden":(i&2)===2?!0:(t=r["aria-hidden"])!=null?t:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(i&4)===4&&(i&2)!==2&&{display:"none"}}};return Tu({ourProps:n,theirProps:r,slot:{},defaultTag:yU,name:"Hidden"})}let CU=Du(bU),hI=le.createContext(null);hI.displayName="OpenClosedContext";var If=(s=>(s[s.Open=1]="Open",s[s.Closed=2]="Closed",s[s.Closing=4]="Closing",s[s.Opening=8]="Opening",s))(If||{});function SU(){return le.useContext(hI)}function xU({value:s,children:e}){return Lt.createElement(hI.Provider,{value:s},e)}function wU(s){function e(){document.readyState!=="loading"&&(s(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let Dh=[];wU(()=>{function s(e){e.target instanceof HTMLElement&&e.target!==document.body&&Dh[0]!==e.target&&(Dh.unshift(e.target),Dh=Dh.filter(t=>t!=null&&t.isConnected),Dh.splice(10))}window.addEventListener("click",s,{capture:!0}),window.addEventListener("mousedown",s,{capture:!0}),window.addEventListener("focus",s,{capture:!0}),document.body.addEventListener("click",s,{capture:!0}),document.body.addEventListener("mousedown",s,{capture:!0}),document.body.addEventListener("focus",s,{capture:!0})});function MU(s){let e=s.parentElement,t=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(t=e),e=e.parentElement;let i=(e==null?void 0:e.getAttribute("disabled"))==="";return i&&EU(t)?!1:i}function EU(s){if(!s)return!1;let e=s.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}function IU(s){throw new Error("Unexpected object: "+s)}var Vr=(s=>(s[s.First=0]="First",s[s.Previous=1]="Previous",s[s.Next=2]="Next",s[s.Last=3]="Last",s[s.Specific=4]="Specific",s[s.Nothing=5]="Nothing",s))(Vr||{});function nA(s,e){let t=e.resolveItems();if(t.length<=0)return null;let i=e.resolveActiveIndex(),r=i??-1;switch(s.focus){case 0:{for(let n=0;n<t.length;++n)if(!e.resolveDisabled(t[n],n,t))return n;return i}case 1:{for(let n=r-1;n>=0;--n)if(!e.resolveDisabled(t[n],n,t))return n;return i}case 2:{for(let n=r+1;n<t.length;++n)if(!e.resolveDisabled(t[n],n,t))return n;return i}case 3:{for(let n=t.length-1;n>=0;--n)if(!e.resolveDisabled(t[n],n,t))return n;return i}case 4:{for(let n=0;n<t.length;++n)if(e.resolveId(t[n],n,t)===s.id)return n;return i}case 5:return null;default:IU(s)}}function oP(s={},e=null,t=[]){for(let[i,r]of Object.entries(s))hP(t,lP(e,i),r);return t}function lP(s,e){return s?s+"["+e+"]":e}function hP(s,e,t){if(Array.isArray(t))for(let[i,r]of t.entries())hP(s,lP(e,i.toString()),r);else t instanceof Date?s.push([e,t.toISOString()]):typeof t=="boolean"?s.push([e,t?"1":"0"]):typeof t=="string"?s.push([e,t]):typeof t=="number"?s.push([e,`${t}`]):t==null?s.push([e,""]):oP(t,e,s)}var bs=(s=>(s.Space=" ",s.Enter="Enter",s.Escape="Escape",s.Backspace="Backspace",s.Delete="Delete",s.ArrowLeft="ArrowLeft",s.ArrowUp="ArrowUp",s.ArrowRight="ArrowRight",s.ArrowDown="ArrowDown",s.Home="Home",s.End="End",s.PageUp="PageUp",s.PageDown="PageDown",s.Tab="Tab",s))(bs||{}),TU={},DU=(s=>(s[s.Open=0]="Open",s[s.Closed=1]="Closed",s))(DU||{}),AU=(s=>(s[s.Single=0]="Single",s[s.Multi=1]="Multi",s))(AU||{}),NU=(s=>(s[s.Pointer=0]="Pointer",s[s.Focus=1]="Focus",s[s.Other=2]="Other",s))(NU||{}),kU=(s=>(s[s.OpenCombobox=0]="OpenCombobox",s[s.CloseCombobox=1]="CloseCombobox",s[s.GoToOption=2]="GoToOption",s[s.RegisterOption=3]="RegisterOption",s[s.UnregisterOption=4]="UnregisterOption",s[s.RegisterLabel=5]="RegisterLabel",s[s.SetActivationTrigger=6]="SetActivationTrigger",s[s.UpdateVirtualOptions=7]="UpdateVirtualOptions",s))(kU||{});function kC(s,e=t=>t){let t=s.activeOptionIndex!==null?s.options[s.activeOptionIndex]:null,i=e(s.options.slice()),r=i.length>0&&i[0].dataRef.current.order!==null?i.sort((a,o)=>a.dataRef.current.order-o.dataRef.current.order):aU(i,a=>a.dataRef.current.domRef.current),n=t?r.indexOf(t):null;return n===-1&&(n=null),{options:r,activeOptionIndex:n}}let LU={1(s){var e;return(e=s.dataRef.current)!=null&&e.disabled||s.comboboxState===1?s:{...s,activeOptionIndex:null,comboboxState:1}},0(s){var e,t;if((e=s.dataRef.current)!=null&&e.disabled||s.comboboxState===0)return s;if((t=s.dataRef.current)!=null&&t.value){let i=s.dataRef.current.calculateIndex(s.dataRef.current.value);if(i!==-1)return{...s,activeOptionIndex:i,comboboxState:0}}return{...s,comboboxState:0}},2(s,e){var t,i,r,n,a;if((t=s.dataRef.current)!=null&&t.disabled||(i=s.dataRef.current)!=null&&i.optionsRef.current&&!((r=s.dataRef.current)!=null&&r.optionsPropsRef.current.static)&&s.comboboxState===1)return s;if(s.virtual){let u=e.focus===Vr.Specific?e.idx:nA(e,{resolveItems:()=>s.virtual.options,resolveActiveIndex:()=>{var d,p;return(p=(d=s.activeOptionIndex)!=null?d:s.virtual.options.findIndex(f=>!s.virtual.disabled(f)))!=null?p:null},resolveDisabled:s.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),c=(n=e.trigger)!=null?n:2;return s.activeOptionIndex===u&&s.activationTrigger===c?s:{...s,activeOptionIndex:u,activationTrigger:c}}let o=kC(s);if(o.activeOptionIndex===null){let u=o.options.findIndex(c=>!c.dataRef.current.disabled);u!==-1&&(o.activeOptionIndex=u)}let l=e.focus===Vr.Specific?e.idx:nA(e,{resolveItems:()=>o.options,resolveActiveIndex:()=>o.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled}),h=(a=e.trigger)!=null?a:2;return s.activeOptionIndex===l&&s.activationTrigger===h?s:{...s,...o,activeOptionIndex:l,activationTrigger:h}},3:(s,e)=>{var t,i,r;if((t=s.dataRef.current)!=null&&t.virtual)return{...s,options:[...s.options,e.payload]};let n=e.payload,a=kC(s,l=>(l.push(n),l));s.activeOptionIndex===null&&(i=s.dataRef.current)!=null&&i.isSelected(e.payload.dataRef.current.value)&&(a.activeOptionIndex=a.options.indexOf(n));let o={...s,...a,activationTrigger:2};return(r=s.dataRef.current)!=null&&r.__demoMode&&s.dataRef.current.value===void 0&&(o.activeOptionIndex=0),o},4:(s,e)=>{var t;if((t=s.dataRef.current)!=null&&t.virtual)return{...s,options:s.options.filter(r=>r.id!==e.id)};let i=kC(s,r=>{let n=r.findIndex(a=>a.id===e.id);return n!==-1&&r.splice(n,1),r});return{...s,...i,activationTrigger:2}},5:(s,e)=>s.labelId===e.id?s:{...s,labelId:e.id},6:(s,e)=>s.activationTrigger===e.trigger?s:{...s,activationTrigger:e.trigger},7:(s,e)=>{var t;if(((t=s.virtual)==null?void 0:t.options)===e.options)return s;let i=s.activeOptionIndex;if(s.activeOptionIndex!==null){let r=e.options.indexOf(s.virtual.options[s.activeOptionIndex]);r!==-1?i=r:i=null}return{...s,activeOptionIndex:i,virtual:Object.assign({},s.virtual,{options:e.options})}}},uI=le.createContext(null);uI.displayName="ComboboxActionsContext";function Ev(s){let e=le.useContext(uI);if(e===null){let t=new Error(`<${s} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Ev),t}return e}let uP=le.createContext(null);function OU(s){var e;let t=Au("VirtualProvider"),[i,r]=le.useMemo(()=>{let l=t.optionsRef.current;if(!l)return[0,0];let h=window.getComputedStyle(l);return[parseFloat(h.paddingBlockStart||h.paddingTop),parseFloat(h.paddingBlockEnd||h.paddingBottom)]},[t.optionsRef.current]),n=Q5({scrollPaddingStart:i,scrollPaddingEnd:r,count:t.virtual.options.length,estimateSize(){return 40},getScrollElement(){var l;return(l=t.optionsRef.current)!=null?l:null},overscan:12}),[a,o]=le.useState(0);return $n(()=>{o(l=>l+1)},[(e=t.virtual)==null?void 0:e.options]),Lt.createElement(uP.Provider,{value:n},Lt.createElement("div",{style:{position:"relative",width:"100%",height:`${n.getTotalSize()}px`},ref:l=>{if(l){if(typeof process<"u"&&TU.JEST_WORKER_ID!==void 0||t.activationTrigger===0)return;t.activeOptionIndex!==null&&t.virtual.options.length>t.activeOptionIndex&&n.scrollToIndex(t.activeOptionIndex)}}},n.getVirtualItems().map(l=>{var h;return Lt.createElement(le.Fragment,{key:l.key},Lt.cloneElement((h=s.children)==null?void 0:h.call(s,{option:t.virtual.options[l.index],open:t.comboboxState===0}),{key:`${a}-${l.key}`,"data-index":l.index,"aria-setsize":t.virtual.options.length,"aria-posinset":l.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${l.start}px)`,overflowAnchor:"none"}}))})))}let cI=le.createContext(null);cI.displayName="ComboboxDataContext";function Au(s){let e=le.useContext(cI);if(e===null){let t=new Error(`<${s} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Au),t}return e}function RU(s,e){return Bo(e.type,LU,s,e)}let FU=le.Fragment;function PU(s,e){let{value:t,defaultValue:i,onChange:r,form:n,name:a,by:o=null,disabled:l=!1,__demoMode:h=!1,nullable:u=!1,multiple:c=!1,immediate:d=!1,virtual:p=null,...f}=s,v=!1,g=null,[b=c?[]:void 0,y]=K5(t,r,i),[C,x]=le.useReducer(RU,{dataRef:le.createRef(),comboboxState:h?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),w=le.useRef(!1),M=le.useRef({static:!1,hold:!1}),E=le.useRef(null),T=le.useRef(null),D=le.useRef(null),N=le.useRef(null),A=Mi(typeof o=="string"?(we,H)=>{let V=o;return(we==null?void 0:we[V])===(H==null?void 0:H[V])}:o??((we,H)=>we===H)),L=Mi(we=>C.options.findIndex(H=>A(H.dataRef.current.value,we))),k=le.useCallback(we=>Bo(R.mode,{1:()=>b.some(H=>A(H,we)),0:()=>A(b,we)}),[b]),O=Mi(we=>C.activeOptionIndex===L(we)),R=le.useMemo(()=>({...C,immediate:v,optionsPropsRef:M,labelRef:E,inputRef:T,buttonRef:D,optionsRef:N,value:b,defaultValue:i,disabled:l,mode:c?1:0,virtual:C.virtual,get activeOptionIndex(){if(w.current&&C.activeOptionIndex===null&&C.options.length>0){let we=C.options.findIndex(H=>!H.dataRef.current.disabled);if(we!==-1)return we}return C.activeOptionIndex},calculateIndex:L,compare:A,isSelected:k,isActive:O,nullable:u,__demoMode:h}),[b,i,l,c,u,h,C,g]);$n(()=>{},[g,void 0]),$n(()=>{C.dataRef.current=R},[R]),uU([R.buttonRef,R.inputRef,R.optionsRef],()=>oe.closeCombobox(),R.comboboxState===0);let j=le.useMemo(()=>{var we,H,V;return{open:R.comboboxState===0,disabled:l,activeIndex:R.activeOptionIndex,activeOption:R.activeOptionIndex===null?null:R.virtual?R.virtual.options[(we=R.activeOptionIndex)!=null?we:0]:(V=(H=R.options[R.activeOptionIndex])==null?void 0:H.dataRef.current.value)!=null?V:null,value:b}},[R,l,b]),P=Mi(()=>{if(R.activeOptionIndex!==null){if(R.virtual)Z(R.virtual.options[R.activeOptionIndex]);else{let{dataRef:we}=R.options[R.activeOptionIndex];Z(we.current.value)}oe.goToOption(Vr.Specific,R.activeOptionIndex)}}),F=Mi(()=>{x({type:0}),w.current=!0}),z=Mi(()=>{x({type:1}),w.current=!1}),q=Mi((we,H,V)=>(w.current=!1,we===Vr.Specific?x({type:2,focus:Vr.Specific,idx:H,trigger:V}):x({type:2,focus:we,trigger:V}))),X=Mi((we,H)=>(x({type:3,payload:{id:we,dataRef:H}}),()=>{R.isActive(H.current.value)&&(w.current=!0),x({type:4,id:we})})),G=Mi(we=>(x({type:5,id:we}),()=>x({type:5,id:null}))),Z=Mi(we=>Bo(R.mode,{0(){return y==null?void 0:y(we)},1(){let H=R.value.slice(),V=H.findIndex(re=>A(re,we));return V===-1?H.push(we):H.splice(V,1),y==null?void 0:y(H)}})),se=Mi(we=>{x({type:6,trigger:we})}),oe=le.useMemo(()=>({onChange:Z,registerOption:X,registerLabel:G,goToOption:q,closeCombobox:z,openCombobox:F,setActivationTrigger:se,selectActiveOption:P}),[]),fe=e===null?{}:{ref:e},be=le.useRef(null),Ne=oI();return le.useEffect(()=>{be.current&&i!==void 0&&Ne.addEventListener(be.current,"reset",()=>{y==null||y(i)})},[be,y]),Lt.createElement(uI.Provider,{value:oe},Lt.createElement(cI.Provider,{value:R},Lt.createElement(xU,{value:Bo(R.comboboxState,{0:If.Open,1:If.Closed})},a!=null&&b!=null&&oP({[a]:b}).map(([we,H],V)=>Lt.createElement(CU,{features:aP.Hidden,ref:V===0?re=>{var he;be.current=(he=re==null?void 0:re.closest("form"))!=null?he:null}:void 0,...Uw({key:we,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:n,name:we,value:H})})),Tu({ourProps:fe,theirProps:f,slot:j,defaultTag:FU,name:"Combobox"}))))}let zU="input";function jU(s,e){var t,i,r,n,a;let o=wv(),{id:l=`headlessui-combobox-input-${o}`,onChange:h,displayValue:u,type:c="text",...d}=s,p=Au("Combobox.Input"),f=Ev("Combobox.Input"),v=Mv(p.inputRef,e),g=cU(p.inputRef),b=le.useRef(!1),y=oI(),C=Mi(()=>{f.onChange(null),p.optionsRef.current&&(p.optionsRef.current.scrollTop=0),f.goToOption(Vr.Nothing)}),x=function(){var R;return typeof u=="function"&&p.value!==void 0?(R=u(p.value))!=null?R:"":typeof p.value=="string"?p.value:""}();iA(([R,j],[P,F])=>{if(b.current)return;let z=p.inputRef.current;z&&((F===0&&j===1||R!==P)&&(z.value=R),requestAnimationFrame(()=>{if(b.current||!z||(g==null?void 0:g.activeElement)!==z)return;let{selectionStart:q,selectionEnd:X}=z;Math.abs((X??0)-(q??0))===0&&q===0&&z.setSelectionRange(z.value.length,z.value.length)}))},[x,p.comboboxState,g]),iA(([R],[j])=>{if(R===0&&j===1){if(b.current)return;let P=p.inputRef.current;if(!P)return;let F=P.value,{selectionStart:z,selectionEnd:q,selectionDirection:X}=P;P.value="",P.value=F,X!==null?P.setSelectionRange(z,q,X):P.setSelectionRange(z,q)}},[p.comboboxState]);let w=le.useRef(!1),M=Mi(()=>{w.current=!0}),E=Mi(()=>{y.nextFrame(()=>{w.current=!1})}),T=Mi(R=>{switch(b.current=!0,R.key){case bs.Enter:if(b.current=!1,p.comboboxState!==0||w.current)return;if(R.preventDefault(),R.stopPropagation(),p.activeOptionIndex===null){f.closeCombobox();return}f.selectActiveOption(),p.mode===0&&f.closeCombobox();break;case bs.ArrowDown:return b.current=!1,R.preventDefault(),R.stopPropagation(),Bo(p.comboboxState,{0:()=>f.goToOption(Vr.Next),1:()=>f.openCombobox()});case bs.ArrowUp:return b.current=!1,R.preventDefault(),R.stopPropagation(),Bo(p.comboboxState,{0:()=>f.goToOption(Vr.Previous),1:()=>{f.openCombobox(),y.nextFrame(()=>{p.value||f.goToOption(Vr.Last)})}});case bs.Home:if(R.shiftKey)break;return b.current=!1,R.preventDefault(),R.stopPropagation(),f.goToOption(Vr.First);case bs.PageUp:return b.current=!1,R.preventDefault(),R.stopPropagation(),f.goToOption(Vr.First);case bs.End:if(R.shiftKey)break;return b.current=!1,R.preventDefault(),R.stopPropagation(),f.goToOption(Vr.Last);case bs.PageDown:return b.current=!1,R.preventDefault(),R.stopPropagation(),f.goToOption(Vr.Last);case bs.Escape:return b.current=!1,p.comboboxState!==0?void 0:(R.preventDefault(),p.optionsRef.current&&!p.optionsPropsRef.current.static&&R.stopPropagation(),p.nullable&&p.mode===0&&p.value===null&&C(),f.closeCombobox());case bs.Tab:if(b.current=!1,p.comboboxState!==0)return;p.mode===0&&p.activationTrigger!==1&&f.selectActiveOption(),f.closeCombobox();break}}),D=Mi(R=>{h==null||h(R),p.nullable&&p.mode===0&&R.target.value===""&&C(),f.openCombobox()}),N=Mi(R=>{var j,P,F;let z=(j=R.relatedTarget)!=null?j:Dh.find(q=>q!==R.currentTarget);if(b.current=!1,!((P=p.optionsRef.current)!=null&&P.contains(z))&&!((F=p.buttonRef.current)!=null&&F.contains(z))&&p.comboboxState===0)return R.preventDefault(),p.mode===0&&(p.nullable&&p.value===null?C():p.activationTrigger!==1&&f.selectActiveOption()),f.closeCombobox()}),A=Mi(R=>{var j,P,F;let z=(j=R.relatedTarget)!=null?j:Dh.find(q=>q!==R.currentTarget);(P=p.buttonRef.current)!=null&&P.contains(z)||(F=p.optionsRef.current)!=null&&F.contains(z)||p.disabled||p.immediate&&p.comboboxState!==0&&(f.openCombobox(),y.nextFrame(()=>{f.setActivationTrigger(1)}))}),L=aI(()=>{if(p.labelId)return[p.labelId].join(" ")},[p.labelId]),k=le.useMemo(()=>({open:p.comboboxState===0,disabled:p.disabled}),[p]),O={ref:v,id:l,role:"combobox",type:c,"aria-controls":(t=p.optionsRef.current)==null?void 0:t.id,"aria-expanded":p.comboboxState===0,"aria-activedescendant":p.activeOptionIndex===null?void 0:p.virtual?(i=p.options.find(R=>{var j;return!((j=p.virtual)!=null&&j.disabled(R.dataRef.current.value))&&p.compare(R.dataRef.current.value,p.virtual.options[p.activeOptionIndex])}))==null?void 0:i.id:(r=p.options[p.activeOptionIndex])==null?void 0:r.id,"aria-labelledby":L,"aria-autocomplete":"list",defaultValue:(a=(n=s.defaultValue)!=null?n:p.defaultValue!==void 0?u==null?void 0:u(p.defaultValue):null)!=null?a:p.defaultValue,disabled:p.disabled,onCompositionStart:M,onCompositionEnd:E,onKeyDown:T,onChange:D,onFocus:A,onBlur:N};return Tu({ourProps:O,theirProps:d,slot:k,defaultTag:zU,name:"Combobox.Input"})}let BU="button";function HU(s,e){var t;let i=Au("Combobox.Button"),r=Ev("Combobox.Button"),n=Mv(i.buttonRef,e),a=wv(),{id:o=`headlessui-combobox-button-${a}`,...l}=s,h=oI(),u=Mi(v=>{switch(v.key){case bs.ArrowDown:return v.preventDefault(),v.stopPropagation(),i.comboboxState===1&&r.openCombobox(),h.nextFrame(()=>{var g;return(g=i.inputRef.current)==null?void 0:g.focus({preventScroll:!0})});case bs.ArrowUp:return v.preventDefault(),v.stopPropagation(),i.comboboxState===1&&(r.openCombobox(),h.nextFrame(()=>{i.value||r.goToOption(Vr.Last)})),h.nextFrame(()=>{var g;return(g=i.inputRef.current)==null?void 0:g.focus({preventScroll:!0})});case bs.Escape:return i.comboboxState!==0?void 0:(v.preventDefault(),i.optionsRef.current&&!i.optionsPropsRef.current.static&&v.stopPropagation(),r.closeCombobox(),h.nextFrame(()=>{var g;return(g=i.inputRef.current)==null?void 0:g.focus({preventScroll:!0})}));default:return}}),c=Mi(v=>{if(MU(v.currentTarget))return v.preventDefault();i.comboboxState===0?r.closeCombobox():(v.preventDefault(),r.openCombobox()),h.nextFrame(()=>{var g;return(g=i.inputRef.current)==null?void 0:g.focus({preventScroll:!0})})}),d=aI(()=>{if(i.labelId)return[i.labelId,o].join(" ")},[i.labelId,o]),p=le.useMemo(()=>({open:i.comboboxState===0,disabled:i.disabled,value:i.value}),[i]),f={ref:n,id:o,type:dU(s,i.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(t=i.optionsRef.current)==null?void 0:t.id,"aria-expanded":i.comboboxState===0,"aria-labelledby":d,disabled:i.disabled,onClick:c,onKeyDown:u};return Tu({ourProps:f,theirProps:l,slot:p,defaultTag:BU,name:"Combobox.Button"})}let VU="label";function UU(s,e){let t=wv(),{id:i=`headlessui-combobox-label-${t}`,...r}=s,n=Au("Combobox.Label"),a=Ev("Combobox.Label"),o=Mv(n.labelRef,e);$n(()=>a.registerLabel(i),[i]);let l=Mi(()=>{var u;return(u=n.inputRef.current)==null?void 0:u.focus({preventScroll:!0})}),h=le.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled}),[n]);return Tu({ourProps:{ref:o,id:i,onClick:l},theirProps:r,slot:h,defaultTag:VU,name:"Combobox.Label"})}let _U="ul",WU=Vw.RenderStrategy|Vw.Static;function qU(s,e){let t=wv(),{id:i=`headlessui-combobox-options-${t}`,hold:r=!1,...n}=s,a=Au("Combobox.Options"),o=Mv(a.optionsRef,e),l=SU(),h=l!==null?(l&If.Open)===If.Open:a.comboboxState===0;$n(()=>{var p;a.optionsPropsRef.current.static=(p=s.static)!=null?p:!1},[a.optionsPropsRef,s.static]),$n(()=>{a.optionsPropsRef.current.hold=r},[a.optionsPropsRef,r]),vU({container:a.optionsRef.current,enabled:a.comboboxState===0,accept(p){return p.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:p.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(p){p.setAttribute("role","none")}});let u=aI(()=>{var p,f;return(f=a.labelId)!=null?f:(p=a.buttonRef.current)==null?void 0:p.id},[a.labelId,a.buttonRef.current]),c=le.useMemo(()=>({open:a.comboboxState===0,option:void 0}),[a]),d={"aria-labelledby":u,role:"listbox","aria-multiselectable":a.mode===1?!0:void 0,id:i,ref:o};return a.virtual&&a.comboboxState===0&&Object.assign(n,{children:Lt.createElement(OU,null,n.children)}),Tu({ourProps:d,theirProps:n,slot:c,defaultTag:_U,features:WU,visible:h,name:"Combobox.Options"})}let YU="li";function QU(s,e){var t;let i=wv(),{id:r=`headlessui-combobox-option-${i}`,disabled:n=!1,value:a,order:o=null,...l}=s,h=Au("Combobox.Option"),u=Ev("Combobox.Option"),c=h.virtual?h.activeOptionIndex===h.calculateIndex(a):h.activeOptionIndex===null?!1:((t=h.options[h.activeOptionIndex])==null?void 0:t.id)===r,d=h.isSelected(a),p=le.useRef(null),f=xv({disabled:n,value:a,domRef:p,order:o}),v=le.useContext(uP),g=Mv(e,p,v?v.measureElement:null),b=Mi(()=>u.onChange(a));$n(()=>u.registerOption(r,f),[f,r]);let y=le.useRef(!(h.virtual||h.__demoMode));$n(()=>{if(!h.virtual||!h.__demoMode)return;let N=Cy();return N.requestAnimationFrame(()=>{y.current=!0}),N.dispose},[h.virtual,h.__demoMode]),$n(()=>{if(!y.current||h.comboboxState!==0||!c||h.activationTrigger===0)return;let N=Cy();return N.requestAnimationFrame(()=>{var A,L;(L=(A=p.current)==null?void 0:A.scrollIntoView)==null||L.call(A,{block:"nearest"})}),N.dispose},[p,c,h.comboboxState,h.activationTrigger,h.activeOptionIndex]);let C=Mi(N=>{var A;if(n||(A=h.virtual)!=null&&A.disabled(a))return N.preventDefault();b(),nP()||requestAnimationFrame(()=>{var L;return(L=h.inputRef.current)==null?void 0:L.focus({preventScroll:!0})}),h.mode===0&&requestAnimationFrame(()=>u.closeCombobox())}),x=Mi(()=>{var N;if(n||(N=h.virtual)!=null&&N.disabled(a))return u.goToOption(Vr.Nothing);let A=h.calculateIndex(a);u.goToOption(Vr.Specific,A)}),w=fU(),M=Mi(N=>w.update(N)),E=Mi(N=>{var A;if(!w.wasMoved(N)||n||(A=h.virtual)!=null&&A.disabled(a)||c)return;let L=h.calculateIndex(a);u.goToOption(Vr.Specific,L,0)}),T=Mi(N=>{var A;w.wasMoved(N)&&(n||(A=h.virtual)!=null&&A.disabled(a)||c&&(h.optionsPropsRef.current.hold||u.goToOption(Vr.Nothing)))}),D=le.useMemo(()=>({active:c,selected:d,disabled:n}),[c,d,n]);return Tu({ourProps:{id:r,ref:g,role:"option",tabIndex:n===!0?void 0:-1,"aria-disabled":n===!0?!0:void 0,"aria-selected":d,disabled:void 0,onClick:C,onFocus:x,onPointerEnter:M,onMouseEnter:M,onPointerMove:E,onMouseMove:E,onPointerLeave:T,onMouseLeave:T},theirProps:l,slot:D,defaultTag:YU,name:"Combobox.Option"})}let GU=Du(PU),$U=Du(HU),XU=Du(jU),KU=Du(UU),ZU=Du(qU),JU=Du(QU),Qr=Object.assign(GU,{Input:XU,Button:$U,Label:KU,Options:ZU,Option:JU});var e_={VITE_PB_URL:"https://predictive-af.fly.dev/",VITE_FACILITY_TIMEOUT:"1800",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const cP=()=>{Zs.autoCancellation(!1);const s="lastUpdated",e="facilities",t=e_.VITE,i=async()=>{let c=await JSON.parse(localStorage.getItem(e));return(c===null||(c==null?void 0:c.length)===0)&&await n(),JSON.parse(localStorage.getItem(e))},r=async()=>{const c=await i(),d=new Date(localStorage.getItem(s));d||getFacs();const f=new Date-d;let v=Math.round(f);v/=1e3,(c.length===0||v>t)&&n()};le.useEffect(()=>{r()});const n=async()=>{try{const c=await Zs.collection("facility").getFullList({}),d=JSON.stringify(c);return localStorage.setItem(e,d),localStorage.setItem(s,new Date),c}catch(c){console.log(c)}};return{getFacilityByDivisions:async c=>(await i()).filter(f=>f.division===c),getLocalFacilities:i,getFacility:async c=>(await i()).find(f=>f.id===c),getFacilityUsers:async(c,d)=>{const p=`fac_id ="${c}"`,f=`fac_id ="${c}" && role="${d}"`;let v=d==="all"?p:f;try{return(await Zs.collection("personel").getList(1,50,{filter:v,expand:"user"})).items}catch(g){console.log(g,v)}},getFacilityExceptions:c=>{},getFacilityNameAndId:async()=>{const c=[];return(await i()).forEach(p=>{c.push({name:p.name,value:p.id})}),c}}},t_=()=>{Zs.autoCancellation(!1);const s="subsys";return cP(),{getFacilitySystems:async t=>{try{return(await Zs.collection(s).getList(1,500,{filter:`fac_id="${t}"`})).items}catch(i){console.log(i)}}}};var i_={VITE_PB_URL:"https://predictive-af.fly.dev/",VITE_FACILITY_TIMEOUT:"1800",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const r_=()=>{Zs.autoCancellation(!1);const s="divsLastUpdated",e="divisions",t=i_.VITE,i=async()=>{let h=await JSON.parse(localStorage.getItem(e));return(h===null||(h==null?void 0:h.length)===0)&&await a(),JSON.parse(localStorage.getItem(e))},r=async()=>{const h=await i(),u=new Date(localStorage.getItem(s));u||a();const d=new Date-u;let p=Math.round(d);p/=1e3,(h.length===0||p>t)&&a()},n=()=>{r()};le.useEffect(()=>{r()});const a=async()=>{try{const h=await Zs.collection(e).getFullList({}),u=JSON.stringify(h);return localStorage.setItem(e,u),localStorage.setItem(s,new Date),h}catch(h){console.log(h)}};return{getAllDivisions:n,getDivision:h=>i().find(d=>d.id===h),getDivisionNameAndId:async()=>{const h=[];return(await i()).forEach(c=>{h.push({name:"By Division: "+c.name,value:c.id})}),h}}};var sA="ej2_instances",n_=0,s_=!1;function Sy(s,e){var t=e;return t.unshift(void 0),new(Function.prototype.bind.apply(s,t))}function a_(s){var e,t=new Uint16Array(5),i=window.msCrypto||window.crypto;i.getRandomValues(t);var r="ej2"+h_(t),n=function(a){a.source===window&&typeof a.data=="string"&&a.data.length<=32&&a.data===r&&(s(),e())};return window.addEventListener("message",n,!1),window.postMessage(r,"*"),e=function(){window.removeEventListener("message",n),s=n=r=void 0}}function ie(s,e){for(var t=e,i=s.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<i.length&&!Re(t);r++)t=t[i[parseInt(r.toString(),10)]];return t}function kt(s,e,t){var i=s.replace(/\[/g,".").replace(/\]/g,"").split("."),r=t||{},n=r,a,o=i.length,l;for(a=0;a<o;a++)l=i[parseInt(a.toString(),10)],a+1===o?n[""+l]=e===void 0?{}:e:m(n[""+l])&&(n[""+l]={}),n=n[""+l];return r}function dI(s,e){delete s[""+e]}var Pu=typeof window<"u"?window:{};function na(s){var e={};return!m(s)&&s.constructor===e.constructor}function bt(s,e){if(!m(e))for(var t=s,i=e,r=Object.keys(e),n="deepMerge",a=0,o=r;a<o.length;a++){var l=o[a];!m(t[""+n])&&t[""+n].indexOf(l)!==-1&&(na(i[""+l])||Array.isArray(i[""+l]))?me(t[""+l],t[""+l],i[""+l],!0):t[""+l]=i[""+l]}}function me(s,e,t,i){var r=s&&typeof s=="object"?s:{},n=arguments.length;i&&(n=n-1);for(var a=function(h){if(!o[h])return"continue";var u=o[h];Object.keys(u).forEach(function(c){var d=r[""+c],p=u[""+c],f;Array.isArray(p)&&Array.isArray(d)&&(p.length,d.length);var v=!0;i&&v&&(na(p)||Array.isArray(p))?na(p)?(f=d||{},Array.isArray(f)&&f.hasOwnProperty("isComplexArray")?me(f,{},p,i):r[""+c]=me(f,{},p,i)):(f=d||[],r[""+c]=me([],f,p,f&&f.length||p&&p.length)):r[""+c]=p})},o=arguments,l=1;l<n;l++)a(l);return r}function m(s){return s==null}function Re(s){return typeof s>"u"}function mi(s){return s+"_"+n_++}function dP(s,e){var t;return function(){var i=this,r=arguments,n=function(){return t=null,s.apply(i,r)};clearTimeout(t),t=setTimeout(n,e)}}function pI(s,e){var t=s;return t===e?!0:t===document||!t?!1:pI(t.parentNode,e)}function jc(s){try{throw new Error(s)}catch(e){throw e.message+`
`+e.stack}}function o_(s,e){var t=document.createElement("div"),i=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),r=[].slice.call(document.getElementsByTagName("body")[0].querySelectorAll("link, style"));if(r.length)for(var n=0,a=r.length;n<a;n++)i.push(r[parseInt(n.toString(),10)]);var o="";m(e)&&(e=window.open("","print","height=452,width=1024,tabbar=no")),t.appendChild(s.cloneNode(!0));for(var l=0,a=i.length;l<a;l++)o+=i[parseInt(l.toString(),10)].outerHTML;e.document.write("<!DOCTYPE html> <html><head>"+o+"</head><body>"+t.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),e.document.close(),e.focus();var h=setInterval(function(){e.ready&&(e.print(),e.close(),clearInterval(h))},500);return e}function qe(s){var e=s+"";return e.match(/auto|cm|mm|in|px|pt|pc|%|em|ex|ch|rem|vw|vh|vmin|vmax/)?e:e+"px"}function Qs(){return s_}function aA(s){var e="xPath";return!(s instanceof Node)&&Qs()&&!m(s[""+e])?document.evaluate(s[""+e],document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:s}function Ln(s,e){var t=typeof s=="string"?document.querySelector(s):s;if(t[""+sA])for(var i=0,r=t[""+sA];i<r.length;i++){var n=r[i];if(n instanceof e)return n}return null}function l_(){if(!(typeof window>"u")){var s=new Uint16Array(5),e=window.msCrypto||window.crypto;return e.getRandomValues(s)}}function h_(s){for(var e="",t=0;t<5;t++)e+=(t?",":"")+s[parseInt(t.toString(),10)];return e}var u_={latn:{_digits:"0123456789",_type:"numeric"}},oA={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"∞",nan:"NaN",exponential:"E"},lA=[0,1,2,3,4,5,6,7,8,9],qi=function(){function s(){}return s.getMainObject=function(e,t){var i="main."+t;return ie(i,e)},s.getNumberingSystem=function(e){return ie("supplemental.numberingSystems",e)||this.numberingSystems},s.reverseObject=function(e,t){for(var i=t||Object.keys(e),r={},n=0,a=i;n<a.length;n++){var o=a[n];r.hasOwnProperty(e[o])||(r[e[o]]=o)}return r},s.getSymbolRegex=function(e){var t=e.map(function(r){return r.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join("|"),i=RegExp;return new i(t,"g")},s.getSymbolMatch=function(e){for(var t=Object.keys(oA),i={},r=0,n=t;r<n.length;r++){var a=n[r];i[e[a]]=oA[a]}return i},s.constructRegex=function(e){for(var t=e.length,i="",r=0;r<t;r++)r!==t-1?i+=e[parseInt(r.toString(),10)]+"|":i+=e[parseInt(r.toString(),10)];return i},s.convertValueParts=function(e,t,i){return e.replace(t,function(r){return i[r]})},s.getDefaultNumberingSystem=function(e){var t={};return t.obj=ie("numbers",e),t.nSystem=ie("defaultNumberingSystem",t.obj),t},s.getCurrentNumericOptions=function(e,t,i,r){var n={},a=this.getDefaultNumberingSystem(e);if(!Re(a.nSystem)||r){var o=r?ie("obj.mapperDigits",a):ie(a.nSystem+"._digits",t);if(!Re(o)){n.numericPair=this.reverseObject(o,lA);var l=RegExp;n.numberParseRegex=new l(this.constructRegex(o),"g"),n.numericRegex="["+o[0]+"-"+o[9]+"]",i&&(n.numericRegex=o[0]+"-"+o[9],n.symbolNumberSystem=ie(r?"numberSymbols":"symbols-numberSystem-"+a.nSystem,a.obj),n.symbolMatch=this.getSymbolMatch(n.symbolNumberSystem),n.numberSystem=a.nSystem)}}return n},s.getNumberMapper=function(e,t,i){var r={mapper:{}},n=this.getDefaultNumberingSystem(e);if(!Re(n.nSystem)){r.numberSystem=n.nSystem,r.numberSymbols=ie("symbols-numberSystem-"+n.nSystem,n.obj),r.timeSeparator=ie("timeSeparator",r.numberSymbols);var a=ie(n.nSystem+"._digits",t);if(!Re(a))for(var o=0,l=lA;o<l.length;o++){var h=l[o];r.mapper[h]=a[h]}}return r},s.nPair="numericPair",s.nRegex="numericRegex",s.numberingSystems=u_,s}(),c_={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH₵",XDR:"XDR",AED:"د.إ.",BHD:"د.ب.",DZD:"د.ج.",EGP:"ج.م.",ILS:"₪",IQD:"د.ع.",JOD:"د.ا.",KMF:"CF",KWD:"د.ك.",LBP:"ل.ل.",LYD:"د.ل.",MAD:"د.م.",MRU:"أ.م.",OMR:"ر.ع.",QAR:"ر.ق.",SAR:"ر.س.",SDG:"ج.س.",SOS:"S",SSP:"£",SYP:"ل.س.",TND:"د.ت.",YER:"ر.ي.",CLP:"$",INR:"₹",TZS:"TSh",EUR:"€",AZN:"₼",RUB:"₽",BYN:"Br",ZMW:"K",BGN:"лв.",NGN:"₦",XOF:"CFA",BDT:"৳",CNY:"¥",BAM:"КМ",UGX:"USh",USD:"$",CZK:"Kč",GBP:"£",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"ރ.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"£",GIP:"£",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"₱",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"₡",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"₲",UYU:"$",VES:"Bs.S",IRR:"ريال",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"֏",ISK:"kr",JPY:"¥",GEL:"₾",CVE:"​",KZT:"₸",KHR:"៛",KPW:"₩",KRW:"₩",KGS:"сом",AOA:"Kz",LAK:"₭",MZN:"MTn",MKD:"ден",MNT:"₮",BND:"$",MMK:"K",NOK:"kr",NPR:"रु",AWG:"Afl.",SRD:"$",PLN:"zł",AFN:"؋",STN:"Db",MDL:"L",RON:"lei",UAH:"₴",LKR:"රු.",ALL:"Lekë",RSD:"дин.",TJS:"смн",THB:"฿",TMT:"m.",TRY:"₺",UZS:"сўм",VND:"₫",TWD:"NT$"};function d_(s){return ie(s||"",c_)}var Tf;(function(s){var e=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];function t(r){var n=r.getDate(),a=r.getMonth(),o=r.getFullYear(),l=a+1,h=o;l<3&&(h-=1,l+=12);var u=Math.floor(h/100),c=u-Math.floor(u/4)-2,d=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(l+1))+n-c-1524;u=Math.floor((d-186721625e-2)/36524.25),c=u-Math.floor(u/4)+1;var p=d+c+1524,f=Math.floor((p-122.1)/365.25),v=Math.floor(365.25*f),g=Math.floor((p-v)/30.6001);n=p-v-Math.floor(30.6001*g),a=Math.floor((p-v)/20.6001),a>13&&(f+=1,a-=12),a-=1,o=f-4716;var b=d-24e5,y=10631/30,C=d-1948084,x=Math.floor(C/10631);C=C-10631*x;var w=Math.floor((C-.1335)/y),M=30*x+w;C=C-Math.floor(w*y+.1335);var E=Math.floor((C+28.5001)/29.5);E===13&&(E=12);for(var T=C-Math.floor(29.5001*E-29),D=0;D<e.length&&!(e[parseInt(D.toString(),10)]>b);D++);var N=D+16260,A=Math.floor((N-1)/12),L=A+1,k=N-12*A,O=b-e[D-1]+1;return(O+"").length>2&&(O=T,k=E,L=M),{year:L,month:k,date:O}}s.getHijriDate=t;function i(r,n,a){var o=r,l=n,h=a,u=o-1,c=u*12+1+(l-1),d=c-16260,p=h+e[d-1]-1,f=p+24e5,v=Math.floor(f+.5),g=Math.floor((v-186721625e-2)/36524.25);g=v+1+g-Math.floor(g/4);var b=g+1524,y=Math.floor((b-122.1)/365.25),C=Math.floor(365.25*y),x=Math.floor((b-C)/30.6001),w=b-C-Math.floor(x*30.6001),M=x-(x>13.5?13:1),E=y-(M>2.5?4716:4715);return E<=0&&M--,new Date(E+"/"+M+"/"+w)}s.toGregorian=i})(Tf||(Tf={}));var p_=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,hA="stand-alone",f_=["sun","mon","tue","wed","thu","fri","sat"],uA={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},v_={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},m_="timeSeparator",pP=function(){function s(){}return s.dateFormat=function(e,t,i){var r=this,n=vt.getDependables(i,e,t.calendar);ie("parserObject.numbers",n);var a=n.dateObject,o={isIslamic:vt.islamicRegex.test(t.calendar)},l=t.format||vt.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,"");if(o.dateSeperator=vt.getDateSeparator(n.dateObject),Re(l))jc("Format options or type given must be invalid");else{l=vt.ConvertDateToWeekFormat(l),o.pattern=l,o.numMapper=qi.getNumberMapper(n.parserObject,qi.getNumberingSystem(i));for(var h=l.match(p_)||[],u=0,c=h;u<c.length;u++){var d=c[u],p=d.length,f=d[0];switch(f==="K"&&(f="h"),f){case"E":case"c":o.weekday=n.dateObject[vt.days][hA][vt.monthIndex[p]];break;case"M":case"L":o.month=n.dateObject[vt.month][hA][vt.monthIndex[p]];break;case"a":o.designator=ie("dayPeriods.format.wide",a);break;case"G":var v=p<=3?"eraAbbr":p===4?"eraNames":"eraNarrow";o.era=ie("eras."+v,n.dateObject);break;case"z":o.timeZone=ie("dates.timeZoneNames",n.parserObject);break}}}return function(g){return isNaN(g.getDate())?null:r.intDateFormatter(g,o)}},s.intDateFormatter=function(e,t){for(var i=t.pattern,r="",n=i.match(vt.dateParseRegex),a=this.getCurrentDateValue(e,t.isIslamic),o=0,l=n;o<l.length;o++){var h=l[o],u=h.length,c=h[0];c==="K"&&(c="h");var d=void 0,p="",f=void 0,v=void 0,g="";switch(c){case"M":case"L":d=a.month,u>2?r+=t.month[d]:f=!0;break;case"E":case"c":r+=t.weekday[f_[e.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(f=!0,c==="d")d=a.date;else if(c==="f"){f=!1,v=!0,p=e[uA[c]]().toString(),p=p.substring(0,u);var b=p.length;if(u!==b){if(u>3)continue;for(var y=0;y<u-b;y++)p="0"+p.toString()}g+=p}else d=e[uA[c]]();c==="h"&&(d=d%12||12);break;case"y":v=!0,g+=a.year,u===2&&(g=g.substr(g.length-2));break;case"a":var C=e.getHours()<12?"am":"pm";r+=t.designator[C];break;case"G":var x=e.getFullYear()<0?0:1,w=t.era[x];m(w)&&(w=t.era[x?0:1]),r+=w||"";break;case"'":r+=h==="''"?"'":h.replace(/'/g,"");break;case"z":var M=e.getTimezoneOffset(),E=u<4?"+H;-H":t.timeZone.hourFormat;E=E.replace(/:/g,t.numMapper.timeSeparator),M===0?r+=t.timeZone.gmtZeroFormat:(v=!0,g=this.getTimeZoneValue(M,E)),g=t.timeZone.gmtFormat.replace(/\{0\}/,g);break;case":":r+=t.numMapper.numberSymbols[m_];break;case"/":r+=t.dateSeperator;break;case"W":f=!0,d=vt.getWeekOfYear(e);break;default:r+=h}f&&(v=!0,g=this.checkTwodigitNumber(d,u)),v&&(r+=qi.convertValueParts(g,vt.latnParseRegex,t.numMapper.mapper))}return r},s.getCurrentDateValue=function(e,t){return t?Tf.getHijriDate(e):{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}},s.checkTwodigitNumber=function(e,t){var i=e+"";return t===2&&i.length!==2?"0"+i:i},s.getTimeZoneValue=function(e,t){var i=this,r=t.split(";"),n=r[e>0?1:0],a=Math.abs(e);return n=n.replace(/HH?|mm/g,function(o){var l=o.length,h=o.indexOf("H")!==-1;return i.checkTwodigitNumber(Math.floor(h?a/60:a%60),l)})},s}(),cA={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},g_="percentSign",y_="minusSign",zu=["infinity","nan","group","decimal","exponential"],fP=function(){function s(){}return s.numberFormatter=function(e,t,i){var r=this,n=me({},t),a={},o={},l,h=vt.getDependables(i,e,"",!0);h.numericObject,o.numberMapper=qi.getNumberMapper(h.parserObject,qi.getNumberingSystem(i),!0),o.currencySymbol=vt.getCurrencySymbol(h.numericObject,n.currency||jd,t.altSymbol),o.percentSymbol=o.numberMapper.numberSymbols[""+g_],o.minusSymbol=o.numberMapper.numberSymbols[""+y_];var u=o.numberMapper.numberSymbols;if(t.format&&!vt.formatRegex.test(t.format))a=vt.customFormat(t.format,o,h.numericObject);else{me(n,vt.getProperNumericSkeleton(t.format||"N")),n.isCurrency=n.type==="currency",n.isPercent=n.type==="percent",l=vt.getSymbolPattern(n.type,o.numberMapper.numberSystem,h.numericObject,n.isAccount),n.groupOne=this.checkValueRange(n.maximumSignificantDigits,n.minimumSignificantDigits,!0),this.checkValueRange(n.maximumFractionDigits,n.minimumFractionDigits,!1,!0),Re(n.fractionDigits)||(n.minimumFractionDigits=n.maximumFractionDigits=n.fractionDigits),Re(n.useGrouping)&&(n.useGrouping=!0),n.isCurrency&&!Qs()&&(l=l.replace(/\u00A4/g,vt.defaultCurrency));{var c=l.split(";");a.nData=vt.getFormatData(c[1]||"-"+c[0],!0,o.currencySymbol),a.pData=vt.getFormatData(c[0],!1,o.currencySymbol),n.useGrouping&&(n.groupSeparator=u[zu[2]],n.groupData=this.getGroupingDetails(c[0]))}var d=Re(n.minimumFractionDigits);if(d&&(n.minimumFractionDigits=a.nData.minimumFraction),Re(n.maximumFractionDigits)){var p=a.nData.maximumFraction;n.maximumFractionDigits=Re(p)&&n.isPercent?0:p}var f=n.minimumFractionDigits,v=n.maximumFractionDigits;!Re(f)&&!Re(v)&&f>v&&(n.maximumFractionDigits=f)}return me(a.nData,n),me(a.pData,n),function(g){return isNaN(g)?u[zu[1]]:isFinite(g)?r.intNumberFormatter(g,a,o,t):u[zu[0]]}},s.getGroupingDetails=function(e){var t={},i=e.match(vt.negativeDataRegex);if(i&&i[4]){var r=i[4],n=r.lastIndexOf(",");if(n!==-1){var a=r.split(".")[0];t.primary=a.length-n-1;var o=r.lastIndexOf(",",n-1);o!==-1&&(t.secondary=n-1-o)}}return t},s.checkValueRange=function(e,t,i,r){var n=r?"f":"s",a=0,o=cA["l"+n],l=cA["m"+n];if(Re(e)||(this.checkRange(e,o,r),a++),Re(t)||(this.checkRange(t,l,r),a++),a===2)if(e<t)jc(l+"specified must be less than the"+o);else return!0;else i&&a===1&&jc("Both"+l+"and"+l+"must be present");return!1},s.checkRange=function(e,t,i){var r=i?[0,20]:[1,21];(e<r[0]||e>r[1])&&jc(t+"value must be within the range"+r[0]+"to"+r[1])},s.intNumberFormatter=function(e,t,i,r){var n;if(!Re(t.nData.type)){e<0?(e=e*-1,n=t.nData):e===0?n=t.zeroData||t.pData:n=t.pData;var a="";if(n.isPercent&&(e=e*100),n.groupOne)a=this.processSignificantDigits(e,n.minimumSignificantDigits,n.maximumSignificantDigits);else if(a=this.processFraction(e,n.minimumFractionDigits,n.maximumFractionDigits,r),n.minimumIntegerDigits&&(a=this.processMinimumIntegers(a,n.minimumIntegerDigits)),i.isCustomFormat&&n.minimumFractionDigits<n.maximumFractionDigits&&/\d+\.\d+/.test(a)){for(var o=a.split("."),l=o[1],h=l.length,u=h-1;u>=0&&(l[""+u]==="0"&&u>=n.minimumFractionDigits);u--)l=l.slice(0,u);a=o[0]+"."+l}return n.type==="scientific"&&(a=e.toExponential(n.maximumFractionDigits),a=a.replace("e",i.numberMapper.numberSymbols[zu[4]])),a=a.replace(".",i.numberMapper.numberSymbols[zu[3]]),a=n.format==="#,###,,;(#,###,,)"?this.customPivotFormat(parseInt(a)):a,n.useGrouping&&(a=this.groupNumbers(a,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[zu[3]]||".",n.groupData.secondary)),a=qi.convertValueParts(a,vt.latnParseRegex,i.numberMapper.mapper),n.nlead==="N/A"?n.nlead:a==="0"&&r&&r.format==="0"?a+n.nend:n.nlead+a+n.nend}},s.processSignificantDigits=function(e,t,i){var r=e+"",n,a=r.length;return a<t?e.toPrecision(t):(r=e.toPrecision(i),n=+r,n+"")},s.groupNumbers=function(e,t,i,r,n){for(var a=!m(n)&&n!==0,o=e.split(r),l=o[0],h=l.length,u="";h>t;)u=l.slice(h-t,h)+(u.length?i+u:""),h-=t,a&&(t=n,a=!1);return o[0]=l.slice(0,h)+(u.length?i:"")+u,o.join(r)},s.processFraction=function(e,t,i,r){var n=(e+"").split(".")[1],a=n?n.length:0;if(t&&a<t){var o="";if(a===0)o=e.toFixed(t);else{o+=e;for(var l=0;l<t-a;l++)o+="0";return o}return e.toFixed(t)}else if(!m(i)&&(a>i||i===0))return e.toFixed(i);var h=e+"";return h[0]==="0"&&r&&r.format==="###.00"&&(h=h.slice(1)),h},s.processMinimumIntegers=function(e,t){var i=e.split("."),r=i[0],n=r.length;if(n<t){for(var a=0;a<t-n;a++)r="0"+r;i[0]=r}return i.join(".")},s.customPivotFormat=function(e){if(e>=5e5){e/=1e6;var t=e.toString().split(".");t[0];var i=t[1];return i&&+i.substring(0,1)>=5?Math.ceil(e).toString():Math.floor(e).toString()}return""},s}(),dA="stand-alone",b_=/^[0-9]*$/,pA={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},C_="months",S_=function(){function s(){}return s.dateParser=function(e,t,i){var r=this,n=vt.getDependables(i,e,t.calendar),a=qi.getCurrentNumericOptions(n.parserObject,qi.getNumberingSystem(i),!1,Qs()),o={},l=t.format||vt.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,""),h="",u;if(Re(l))jc("Format options or type given must be invalid");else{l=vt.ConvertDateToWeekFormat(l),o={isIslamic:vt.islamicRegex.test(t.calendar),pattern:l,evalposition:{},culture:e};for(var c=l.match(vt.dateParseRegex)||[],d=c.length,p=0,f=0,v=!1,g=a.numericRegex,b=qi.getNumberMapper(n.parserObject,qi.getNumberingSystem(i)),y=0;y<d;y++){var C=c[parseInt(y.toString(),10)],x=C.length,w=C[0]==="K"?"h":C[0],M=void 0,E=void 0,T=v_[w],D=x===2?"":"?";switch(v&&(p=f,v=!1),w){case"E":case"c":var N=void 0;N=n.dateObject[vt.days][dA][vt.monthIndex[x]];var A=qi.reverseObject(N);h+="("+Object.keys(A).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(E=!0,(w==="M"||w==="L")&&x>2){var L=void 0;L=n.dateObject[C_][dA][vt.monthIndex[x]],o[T]=qi.reverseObject(L),h+="("+Object.keys(o[T]).join("|")+")"}else if(w==="f"){if(x>3)continue;M=!0,h+="("+g+g+"?"+g+"?)"}else M=!0,h+="("+g+g+D+")";w==="h"&&(o.hour12=!0);break;case"W":var k=x===1?"?":"";h+="("+g+k+g+")";break;case"y":E=M=!0,x===2?h+="("+g+g+")":h+="("+g+"{"+x+",})";break;case"a":E=!0;var O=ie("dayPeriods.format.wide",n.dateObject);o[T]=qi.reverseObject(O),h+="("+Object.keys(o[T]).join("|")+")";break;case"G":E=!0;var R=x<=3?"eraAbbr":x===4?"eraNames":"eraNarrow";o[T]=qi.reverseObject(ie("eras."+R,n.dateObject)),h+="("+Object.keys(o[T]).join("|")+"?)";break;case"z":var j=new Date().getTimezoneOffset();E=j!==0,o[T]=ie("dates.timeZoneNames",n.parserObject);var P=o[T];u=x<4;var F=u?"+H;-H":P.hourFormat;F=F.replace(/:/g,b.timeSeparator),h+="("+this.parseTimeZoneRegx(F,P,g)+")?",v=!0,f=u?6:12;break;case"'":var z=C.replace(/'/g,"");h+="("+z+")?";break;default:h+="([\\D])";break}if(E&&(o.evalposition[""+T]={isNumber:M,pos:y+1+p,hourOnly:u}),y===d-1&&!m(h)){var q=RegExp;o.parserRegex=new q("^"+h+"$","i")}}}return function(X){var G=r.internalDateParse(X,o,a);if(m(G)||!Object.keys(G).length)return null;if(o.isIslamic){var Z={},se=G.year,oe=G.day,fe=G.month,be=se?se+"":"",Ne=be.length===2;(!se||!fe||!oe||Ne)&&(Z=Tf.getHijriDate(new Date)),Ne&&(se=parseInt((Z.year+"").slice(0,2)+be,10));var we=Tf.toGregorian(se||Z.year,fe||Z.month,oe||Z.date);G.year=we.getFullYear(),G.month=we.getMonth()+1,G.day=we.getDate()}return r.getDateObject(G)}},s.getDateObject=function(e,t){var i=t||new Date;i.setMilliseconds(0);var r=["hour","minute","second","milliseconds","month","day"],n=e.year,a=e.designator,o=e.timeZone;if(!Re(n)){var l=(n+"").length;if(l<=2){var h=Math.floor(i.getFullYear()/100)*100;n+=h}i.setFullYear(n)}for(var u=0,c=r;u<c.length;u++){var d=c[u],p=e[d];if(Re(p)&&d==="day"&&i.setDate(1),!Re(p))if(d==="month"){if(p-=1,p<0||p>11)return new Date("invalid");var f=i.getDate();i.setDate(1),i[pA[d]](p);var v=new Date(i.getFullYear(),p+1,0).getDate();i.setDate(f<v?f:v)}else{if(d==="day"){var g=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(p<1||p>g)return null}i[pA[d]](p)}}if(!Re(a)){var b=i.getHours();a==="pm"?i.setHours(b+(b===12?0:12)):b===12&&i.setHours(0)}if(!Re(o)){var y=o-i.getTimezoneOffset();y!==0&&i.setMinutes(i.getMinutes()+y)}return i},s.internalDateParse=function(e,t,i){var r=e.match(t.parserRegex),n={hour:0,minute:0,second:0};if(m(r))return null;for(var a=Object.keys(t.evalposition),o=0,l=a;o<l.length;o++){var h=l[o],u=t.evalposition[""+h],c=r[u.pos];if(u.isNumber)n[h]=this.internalNumberParser(c,i);else if(h==="timeZone"&&!Re(c)){var d=u.pos,p=void 0,f=r[d+1],v=!Re(f);u.hourOnly?p=this.getZoneValue(v,f,r[d+4],i)*60:(p=this.getZoneValue(v,f,r[d+7],i)*60,p+=this.getZoneValue(v,r[d+4],r[d+10],i)),m(p)||(n[""+h]=p)}else c=h==="month"&&!t.isIslamic&&(t.culture==="en"||t.culture==="en-GB"||t.culture==="en-US")?c[0].toUpperCase()+c.substring(1).toLowerCase():c,c=h!=="month"&&h==="designator"&&t.culture==="en-GB"?c.toLowerCase():c,n[h]=t[h][c]}return t.hour12&&(n.hour12=!0),n},s.internalNumberParser=function(e,t){return e=qi.convertValueParts(e,t.numberParseRegex,t.numericPair),b_.test(e)?+e:null},s.parseTimeZoneRegx=function(e,t,i){var r=t.gmtFormat,n,a="("+i+")("+i+")",o;return n=e.replace("+","\\+"),e.indexOf("HH")!==-1?n=n.replace(/HH|mm/g,"("+a+")"):n=n.replace(/H|m/g,"("+a+"?)"),o=n.split(";").map(function(l){return r.replace("{0}",l)}),n=o.join("|")+"|"+t.gmtZeroFormat,n},s.getZoneValue=function(e,t,i,r){var n=e?t:i;if(!n)return 0;var a=this.internalNumberParser(n,r);return e?-a:a},s}(),x_=RegExp,w_=new x_("^([^0-9]*)(([0-9,]*[0-9]+)(.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$"),M_=/,/g,E_=["minusSign","infinity"],I_=function(){function s(){}return s.numberParser=function(e,t,i){var r=this,n=vt.getDependables(i,e,"",!0),a={custom:!0},o;vt.formatRegex.test(t.format)||!t.format?(me(a,vt.getProperNumericSkeleton(t.format||"N")),a.custom=!1,a.fractionDigits||t.maximumFractionDigits&&(a.maximumFractionDigits=t.maximumFractionDigits)):me(a,vt.customFormat(t.format,null,null)),ie("numbers",n.parserObject),o=qi.getCurrentNumericOptions(n.parserObject,qi.getNumberingSystem(i),!0,Qs()),a.symbolRegex=qi.getSymbolRegex(Object.keys(o.symbolMatch)),a.infinity=o.symbolNumberSystem[E_[1]];var l;if(l=vt.getSymbolPattern(a.type,o.numberSystem,n.numericObject,a.isAccount),l){l=l.replace(/\u00A4/g,vt.defaultCurrency);var h=l.split(";");a.nData=vt.getFormatData(h[1]||"-"+h[0],!0,""),a.pData=vt.getFormatData(h[0],!0,"")}return function(u){return r.getParsedNumber(u,a,o)}},s.getParsedNumber=function(e,t,i){var r,n,a,o,l,h;if(e.indexOf(t.infinity)!==-1)return 1/0;e=qi.convertValueParts(e,t.symbolRegex,i.symbolMatch),e=qi.convertValueParts(e,i.numberParseRegex,i.numericPair),e=e.indexOf("-")!==-1?e.replace("-.","-0."):e,e.indexOf(".")===0&&(e="0"+e);var u=e.match(w_);if(m(u))return NaN;o=u[1],a=u[2];var c=u[5];return l=u[6],r=t.custom?o===t.nData.nlead&&l===t.nData.nend:o.indexOf(t.nData.nlead)!==-1&&l.indexOf(t.nData.nend)!==-1,n=r?t.nData.isPercent:t.pData.isPercent,a=a.replace(M_,""),c&&(a+=c),h=+a,(t.type==="percent"||n)&&(h=h/100),(t.custom||t.fractionDigits)&&(h=parseFloat(h.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.fractionDigits))),t.maximumFractionDigits&&(h=this.convertMaxFracDigits(a,t,h,r)),r&&(h*=-1),h},s.convertMaxFracDigits=function(e,t,i,r){var n=e.split(".");return n[1]&&n[1].length>t.maximumFractionDigits&&(i=+i.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.maximumFractionDigits)),i},s}(),xy=function(){function s(e){this.ranArray=[],this.boundedEvents={},!m(e)&&(this.context=e)}return s.prototype.on=function(e,t,i,r){if(!m(t)){var n=i||this.context;if(this.notExist(e)){this.boundedEvents[""+e]=[{handler:t,context:n,id:r}];return}m(r)?this.isHandlerPresent(this.boundedEvents[""+e],t)||this.boundedEvents[""+e].push({handler:t,context:n}):this.ranArray.indexOf(r)===-1&&(this.ranArray.push(r),this.boundedEvents[""+e].push({handler:t,context:n,id:r}))}},s.prototype.off=function(e,t,i){if(!this.notExist(e)){var r=ie(e,this.boundedEvents);if(t){for(var n=0;n<r.length;n++)if(i){if(r[parseInt(n.toString(),10)].id===i){r.splice(n,1);var a=this.ranArray.indexOf(i);a!==-1&&this.ranArray.splice(a,1);break}}else if(t===r[parseInt(n.toString(),10)].handler){r.splice(n,1);break}}else delete this.boundedEvents[""+e]}},s.prototype.notify=function(e,t,i,r){if(this.notExist(e)){i&&i.call(this,t);return}t&&(t.name=e);var n="Blazor",a=ie(e,this.boundedEvents).slice(0);if(window[""+n])return this.blazorCallback(a,t,i,r,0);for(var o=0,l=a;o<l.length;o++){var h=l[o];h.handler.call(h.context,t)}i&&i.call(this,t)},s.prototype.blazorCallback=function(e,t,i,r,n){var a=this,o=n===e.length-1;if(n<e.length){var l=e[parseInt(n.toString(),10)],h=l.handler.call(l.context,t);if(h&&typeof h.then=="function"){if(!i)return h;h.then(function(u){if(u=typeof u=="string"&&a.isJson(u)?JSON.parse(u,a.dateReviver):u,me(t,t,u,!0),i&&o)i.call(l.context,t);else return a.blazorCallback(e,t,i,r,n+1)}).catch(function(u){r&&r.call(l.context,typeof u=="string"&&a.isJson(u)?JSON.parse(u,a.dateReviver):u)})}else if(i&&o)i.call(l.context,t);else return this.blazorCallback(e,t,i,r,n+1)}},s.prototype.dateReviver=function(e,t){var i=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/;return Qs&&typeof t=="string"&&t.match(i)!==null?new Date(t):t},s.prototype.isJson=function(e){try{JSON.parse(e)}catch{return!1}return!0},s.prototype.destroy=function(){this.boundedEvents=this.context=void 0},s.prototype.offIntlEvents=function(){var e=this.boundedEvents.notifyExternalChange;if(e){for(var t=0;t<e.length;t++){var i=e[0].context;i&&i.detectFunction&&i.randomId&&!i.isRendered&&(this.off("notifyExternalChange",i.detectFunction,i.randomId),t--)}this.boundedEvents.notifyExternalChange.length||delete this.boundedEvents.notifyExternalChange}},s.prototype.notExist=function(e){return this.boundedEvents.hasOwnProperty(e)===!1||this.boundedEvents[e].length<=0},s.prototype.isHandlerPresent=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.handler===t)return!0}return!1},s}(),sd=new xy,T_=!1,hr={},Df="en-US",jd="USD",_w=["numericObject","dateObject"],_t=function(){function s(e){e&&(this.culture=e)}return s.prototype.getDateFormat=function(e){return pP.dateFormat(this.getCulture(),e||{type:"date",skeleton:"short"},hr)},s.prototype.getNumberFormat=function(e){return e&&!e.currency&&(e.currency=jd),fP.numberFormatter(this.getCulture(),e||{},hr)},s.prototype.getDateParser=function(e){return S_.dateParser(this.getCulture(),e||{skeleton:"short",type:"date"},hr)},s.prototype.getNumberParser=function(e){return I_.numberParser(this.getCulture(),e||{format:"N"},hr)},s.prototype.formatNumber=function(e,t){return this.getNumberFormat(t)(e)},s.prototype.formatDate=function(e,t){return this.getDateFormat(t)(e)},s.prototype.parseDate=function(e,t){return this.getDateParser(t)(e)},s.prototype.parseNumber=function(e,t){return this.getNumberParser(t)(e)},s.prototype.getDatePattern=function(e,t){return vt.getActualDateTimeFormat(this.getCulture(),e,hr,t)},s.prototype.getNumberPattern=function(e,t){return vt.getActualNumberFormat(this.getCulture(),e,hr,t)},s.prototype.getFirstDayOfWeek=function(){return vt.getWeekData(this.getCulture(),hr)},s.prototype.getCulture=function(){return this.culture||Df},s}();function D_(s){Df=s,sd.notify("notifyExternalChange",{locale:Df})}function Lo(s,e){var t=vt.getDependables(hr,s,"",!0)[_w[0]],i=vt.getDependables(hr,s,"")[_w[1]],r=ie("defaultNumberingSystem",t),n=ie("symbols-numberSystem-"+r,t),a=vt.getSymbolPattern(e||"decimal",r,t,!1);return me(n,vt.getFormatData(a,!0,"",!0),{dateSeparator:vt.getDateSeparator(i)})}function ad(s,e){var t=vt.getDependables(hr,s,"",!0);return vt.getCurrencySymbol(t.numericObject,e)}function xl(s){return vt.getDependables(hr,"",s,!1)[_w[1]]}var fA=RegExp,vA={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}},vt;(function(s){s.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,s.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*[0#\ ]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,s.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var e=/[0-9]/g;s.defaultCurrency="$";var t=["infinity","nan","group","decimal"],i=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,r={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};s.dateConverterMapper=/dddd|ddd/ig;var n="sun";s.islamicRegex=/^islamic/;var a={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};s.formatRegex=new fA("(^[ncpae]{1})([0-1]?[0-9]|20)?$","i"),s.currencyFormatRegex=new fA("(^[ca]{1})([0-1]?[0-9]|20)?$","i"),s.curWithoutNumberRegex=/(c|a)$/ig;var o={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};s.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,s.basicPatterns=["short","medium","long","full"],s.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhuʻl-Q.",12:"Dhuʻl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabiʻ I",4:"Rabiʻ II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Shaʻban",9:"Ramadan",10:"Shawwal",11:"Dhuʻl-Qiʻdah",12:"Dhuʻl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"€","symbol-alt-narrow":"€"},GBP:{displayName:"British Pound","symbol-alt-narrow":"£"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"×",perMille:"‰",infinity:"∞",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"¤#,##0.00",accounting:"¤#,##0.00;(¤#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},s.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"∞"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},s.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},s.month="months",s.days="days",s.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"};function l(O,R,j,P,F){var z,q=j||"date";if(F)z=d({skeleton:O},F).format||d({skeleton:"d"},"en-US").format;else{if(s.basicPatterns.indexOf(O)!==-1){if(z=ie(q+"Formats."+O,R),q==="dateTime"){var X=ie("dateFormats."+O,R),G=ie("timeFormats."+O,R);z=z.replace("{1}",X).replace("{0}",G)}}else z=ie("dateTimeFormats.availableFormats."+O,R);Re(z)&&O==="yMd"&&(z="M/d/y")}return z}s.getResultantPattern=l;function h(O,R,j,P){var F={},z=j||"gregorian";if(F.parserObject=qi.getMainObject(O,R)||s.defaultObject,P)F.numericObject=ie("numbers",F.parserObject);else{var q="dates.calendars."+z;F.dateObject=ie(q,F.parserObject)}return F}s.getDependables=h;function u(O,R,j,P){return ie(O+"Formats-numberSystem-"+R+(P?".accounting":".standard"),j)||(P?ie(O+"Formats-numberSystem-"+R+".standard",j):"")}s.getSymbolPattern=u;function c(O){var R=O.match(s.dateConverterMapper);if(R&&Qs()){var j=R[0].length===3?"EEE":"EEEE";return O.replace(s.dateConverterMapper,j)}return O}s.ConvertDateToWeekFormat=c;function d(O,R){var j=O.format||O.skeleton,P=ie((R||"en-US")+"."+j,vA);return P||(P=ie("en-US."+j,vA)),P&&(P=c(P),O.format=P.replace(/tt/,"a")),O}s.compareBlazorDateFormats=d;function p(O){var R=O.match(s.formatRegex),j={},P=R[1].toUpperCase();return j.isAccount=P==="A",j.type=s.patternMatcher[P],O.length>1&&(j.fractionDigits=parseInt(R[2],10)),j}s.getProperNumericSkeleton=p;function f(O,R,j,P){var F=P?{}:{nlead:"",nend:""},z=O.match(s.customRegex);if(z){P||(F.nlead=v(z[1],j),F.nend=v(z[10],j),F.groupPattern=z[4]);var q=z[7];if(q&&R){var X=q.match(e);m(X)?F.minimumFraction=0:F.minimumFraction=X.length,F.maximumFraction=q.length-1}}return F}s.getFormatData=f;function v(O,R){return O?(O=O.replace(s.defaultCurrency,R),R===""?O.trim():O):""}s.changeCurrencySymbol=v;function g(O,R,j){var P=j?"."+j:".symbol",F=ie("currencies."+R+P,O)||ie("currencies."+R+".symbol-alt-narrow",O)||"$";return F}s.getCurrencySymbol=g;function b(O,R,j){for(var P={},F=O.split(";"),z=["pData","nData","zeroData"],q=0;q<F.length;q++)P[z[q]]=y(F[q],R,j);return m(P.nData)&&(P.nData=me({},P.pData),P.nData.nlead=m(R)?"-"+P.nData.nlead:R.minusSymbol+P.nData.nlead),P}s.customFormat=b;function y(O,R,j){var P={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},F=O.match(s.customRegex);if(m(F)||F[5]===""&&O!=="N/A")return P.type=void 0,P;P.nlead=F[1],P.nend=F[10];var z=F[6],q=!!z.match(/\ $/g),X=z.replace(/\ $/g,"").indexOf(" ")!==-1;P.useGrouping=z.indexOf(",")!==-1||X,z=z.replace(/,/g,"");var G=F[7];if(z.indexOf("0")!==-1&&(P.minimumIntegerDigits=z.length-z.indexOf("0")),m(G)||(P.minimumFractionDigits=G.lastIndexOf("0"),P.maximumFractionDigits=G.lastIndexOf("#"),P.minimumFractionDigits===-1&&(P.minimumFractionDigits=0),(P.maximumFractionDigits===-1||P.maximumFractionDigits<P.minimumFractionDigits)&&(P.maximumFractionDigits=P.minimumFractionDigits)),m(R)?me(P,C([P.nlead,P.nend],"%","%")):(R.isCustomFormat=!0,me(P,C([P.nlead,P.nend],"$",R.currencySymbol)),P.isCurrency||me(P,C([P.nlead,P.nend],"%",R.percentSymbol))),!m(j)){var Z=u(P.type,R.numberMapper.numberSystem,j,!1);P.useGrouping&&(P.groupSeparator=X?" ":R.numberMapper.numberSymbols[t[2]],P.groupData=fP.getGroupingDetails(Z.split(";")[0])),P.nlead=P.nlead.replace(/'/g,""),P.nend=q?" "+P.nend.replace(/'/g,""):P.nend.replace(/'/g,"")}return P}s.customNumberFormat=y;function C(O,R,j){for(var P={nlead:O[0],nend:O[1]},F=0;F<2;F++){var z=O[parseInt(F.toString(),10)],q=z.indexOf(R);if(q!==-1&&(q<z.indexOf("'")||q>z.lastIndexOf("'"))){P[o[F]]=z.substr(0,q)+j+z.substr(q+1),P[o[R]]=!0,P.type=P.isCurrency?"currency":"percent";break}}return P}s.isCurrencyPercent=C;function x(O){var R=(ie("dateFormats.short",O)||"").match(/[d‏M‏]([^d‏M])[d‏M‏]/i);return R?R[1]:"/"}s.getDateSeparator=x;function w(O,R,j,P){var F=h(j,O,R.calendar),z=R.format||l(R.skeleton,F.dateObject,R.type);if(P){if(z=z.replace(i,function(fe){return r[fe]}),z.indexOf("z")!==-1){var q=z.match(/z/g).length,X=void 0,G={timeZone:{}};G.numMapper=qi.getNumberMapper(F.parserObject,qi.getNumberingSystem(j)),G.timeZone=ie("dates.timeZoneNames",F.parserObject);var Z=new Date,se=Z.getTimezoneOffset(),oe=q<4?"+H;-H":G.timeZone.hourFormat;oe=oe.replace(/:/g,G.numMapper.timeSeparator),se===0?X=G.timeZone.gmtZeroFormat:(X=pP.getTimeZoneValue(se,oe),X=G.timeZone.gmtFormat.replace(/\{0\}/,X)),z=z.replace(/[z]+/,'"'+X+'"')}z=z.replace(/ $/,"")}return z}s.getActualDateTimeFormat=w;function M(O,R){if(O.indexOf(",")!==-1){var j=O.split(",");O=j[0]+ie("numberMapper.numberSymbols.group",R)+j[1].replace(".",ie("numberMapper.numberSymbols.decimal",R))}else O=O.replace(".",ie("numberMapper.numberSymbols.decimal",R));return O}function E(O,R,j,P){var F=h(j,O,"",!0),z={custom:!0};F.numericObject;var q,X={},G=(R.format||"").match(s.currencyFormatRegex);s.formatRegex.test(R.format)&&p(R.format||"N");var Z={};if(G){Z.numberMapper=qi.getNumberMapper(F.parserObject,qi.getNumberingSystem(j),!0);var se=g(F.numericObject,R.currency||jd,R.altSymbol),oe=u("currency",Z.numberMapper.numberSystem,F.numericObject,/a/i.test(R.format));oe=oe.replace(/\u00A4/g,se);var fe=oe.split(";");X.hasNegativePattern=fe.length>1,X.nData=f(fe[1]||"-"+fe[0],!0,se),X.pData=f(fe[0],!1,se),!G[2]&&!R.minimumFractionDigits&&!R.maximumFractionDigits&&(q=f(oe.split(";")[0],!0,"",!0).minimumFraction)}var be;if(s.formatRegex.test(R.format)||!R.format){if(me(z,p(R.format||"N")),z.custom=!1,be="###0",z.fractionDigits||R.minimumFractionDigits||R.maximumFractionDigits||q){var Ne=0;z.fractionDigits&&(R.minimumFractionDigits=R.maximumFractionDigits=z.fractionDigits),be=T(be,q||z.fractionDigits||R.minimumFractionDigits||Ne,R.maximumFractionDigits||Ne)}if(R.minimumIntegerDigits&&(be=D(be,R.minimumIntegerDigits)),R.useGrouping&&(be=N(be)),z.type==="currency"||z.type&&Qs()){var we=be;be=X.pData.nlead+we+X.pData.nend,(X.hasNegativePattern||Qs())&&(be+=";"+X.nData.nlead+we+X.nData.nend)}z.type==="percent"&&!Qs()&&(be+=" %")}else be=R.format.replace(/'/g,'"');return Object.keys(Z).length>0&&(be=P?be:M(be,Z)),be}s.getActualNumberFormat=E;function T(O,R,j){O+=".";for(var P=0;P<R;P++)O+="0";if(R<j)for(var F=j-R,z=0;z<F;z++)O+="#";return O}s.fractionDigitsPattern=T;function D(O,R){for(var j=O.split("."),P="",F=0;F<R;F++)P+="0";return j[1]?P+"."+j[1]:P}s.minimumIntegerPattern=D;function N(O){var R=O.split("."),j=R[0],P=3-j.length%3,F=P&&P===1?"#":P===2?"##":"";j=F+j,O="";for(var z=j.length-1;z>0;z=z-3)O=","+j[z-2]+j[z-1]+j[parseInt(z.toString(),10)]+O;return O=O.slice(1),R[1]?O+"."+R[1]:O}s.groupingPattern=N;function A(O,R){var j=n,P=ie("supplemental.weekData.firstDay",R),F=O;return/en-/.test(F)&&(F=F.slice(3)),F=F.slice(0,2).toUpperCase()+F.substr(2),P&&(j=P[""+F]||P[F.slice(0,2)]||n),a[""+j]}s.getWeekData=A;function L(O,R,j){var P=d_(j);if(R!==P)for(var F=0,z=O;F<z.length;F++){var q=z[F];q.nend=q.nend.replace(R,P),q.nlead=q.nlead.replace(R,P)}}s.replaceBlazorCurrency=L;function k(O){var R=new Date(O.getFullYear(),0,1),j=R.getDay(),P;j=j>=0?j:j+7;var F=Math.floor((O.getTime()-R.getTime()-(O.getTimezoneOffset()-R.getTimezoneOffset())*6e4)/864e5)+1;if(j<4){if(P=Math.floor((F+j-1)/7)+1,P>52){var z=new Date(O.getFullYear()+1,0,1),q=z.getDay();q=q>=0?q:q+7,P=q<4?1:53}}else P=Math.floor((F+j-1)/7);return P}s.getWeekOfYear=k})(vt||(vt={}));var LC=function(){function s(e,t,i){this.type="GET",this.emitError=!0,typeof e=="string"?(this.url=e,this.type=m(t)?this.type:t.toUpperCase(),this.contentType=i):na(e)&&Object.keys(e).length>0&&bt(this,e),this.contentType=m(this.contentType)?"application/json; charset=utf-8":this.contentType}return s.prototype.send=function(e){var t=this,i={"application/json":"json","multipart/form-data":"formData","application/octet-stream":"blob","application/x-www-form-urlencoded":"formData"};try{m(this.fetchRequest)&&this.type==="GET"?this.fetchRequest=new Request(this.url,{method:this.type}):m(this.fetchRequest)&&(this.data=m(e)?this.data:e,this.fetchRequest=new Request(this.url,{method:this.type,headers:{"Content-Type":this.contentType},body:this.data}));var r={cancel:!1,fetchRequest:this.fetchRequest};return this.triggerEvent(this.beforeSend,r),r.cancel?null:(this.fetchResponse=fetch(this.fetchRequest),this.fetchResponse.then(function(n){if(t.triggerEvent(t.onLoad,n),!n.ok)throw n;for(var a="text",o=0,l=Object.keys(i);o<l.length;o++){var h=l[o];n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf(h)!==-1&&(a=i[h])}return n[a]()}).then(function(n){return t.triggerEvent(t.onSuccess,n,t),n}).catch(function(n){var a={};return t.emitError&&(t.triggerEvent(t.onFailure,n),a=Promise.reject(n)),a}))}catch(n){return n}},s.prototype.triggerEvent=function(e,t,i){!m(e)&&typeof e=="function"&&e(t,i)},s}(),A_=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,N_=/msie|trident/i,k_=/Trident\/7\./,L_=/(ipad|iphone|ipod touch)/i,O_=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,R_=/android/i,F_=/trident|windows phone|edge/i,P_=/(version)[ /]([\w.]+)/i,OC={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};typeof window<"u"&&(window.browserDetails=window.browserDetails||{});var B=function(){function s(){}return s.extractBrowserDetail=function(){for(var e={culture:{}},t=Object.keys(OC),i=[],r=0,n=t;r<n.length;r++){var a=n[r];if(i=s.userAgent.match(OC[""+a]),i){if(e.name=i[1].toLowerCase()==="opr"?"opera":i[1].toLowerCase(),e.name=i[1].toLowerCase()==="crios"?"chrome":e.name,e.version=i[2],e.culture.name=e.culture.language=navigator.language,s.userAgent.match(k_)){e.name="msie";break}var o=s.userAgent.match(P_);e.name==="safari"&&o&&(e.version=o[2]);break}}return e},s.getEvent=function(e){var t={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return s.isPointer?t[""+e].isPointer:s.isTouch?t[""+e].isTouch+(s.isDevice?"":" "+t[""+e].isDevice):t[""+e].isDevice},s.getTouchStartEvent=function(){return s.getEvent("start")},s.getTouchEndEvent=function(){return s.getEvent("end")},s.getTouchMoveEvent=function(){return s.getEvent("move")},s.getTouchCancelEvent=function(){return s.getEvent("cancel")},s.isSafari=function(){return s.isDevice&&s.isIos&&s.isTouch&&typeof window<"u"&&window.navigator.userAgent.toLowerCase().indexOf("iphone")===-1&&window.navigator.userAgent.toLowerCase().indexOf("safari")>-1},s.getValue=function(e,t){var i=typeof window<"u"?window.browserDetails:{};return typeof navigator<"u"&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1&&s.isTouch===!0&&!OC.CHROME.test(navigator.userAgent)&&(i.isIos=!0,i.isDevice=!0,i.isTouch=!0,i.isPointer=!0),typeof i[""+e]>"u"?i[""+e]=t.test(s.userAgent):i[""+e]},Object.defineProperty(s,"userAgent",{get:function(){return s.uA},set:function(e){s.uA=e,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(s,"info",{get:function(){return Re(window.browserDetails.info)?window.browserDetails.info=s.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isIE",{get:function(){return s.getValue("isIE",N_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isTouch",{get:function(){return Re(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isPointer",{get:function(){return Re(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isMSPointer",{get:function(){return Re(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isDevice",{get:function(){return s.getValue("isDevice",A_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isIos",{get:function(){return s.getValue("isIos",L_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isIos7",{get:function(){return s.getValue("isIos7",O_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isAndroid",{get:function(){return s.getValue("isAndroid",R_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isWebView",{get:function(){return Re(window.browserDetails.isWebView)&&(window.browserDetails.isWebView=!(Re(window.cordova)&&Re(window.PhoneGap)&&Re(window.phonegap)&&window.forge!=="object")),window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(s,"isWindows",{get:function(){return s.getValue("isWindows",F_)},enumerable:!0,configurable:!0}),Object.defineProperty(s,"touchStartEvent",{get:function(){return Re(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=s.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(s,"touchMoveEvent",{get:function(){return Re(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=s.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(s,"touchEndEvent",{get:function(){return Re(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=s.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(s,"touchCancelEvent",{get:function(){return Re(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=s.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),s.uA=typeof navigator<"u"?navigator.userAgent:"",s}(),I=function(){function s(){}return s.addOrGetEventData=function(e){return"__eventList"in e?e.__eventList.events:(e.__eventList={},e.__eventList.events=[])},s.add=function(e,t,i,r,n){var a=s.addOrGetEventData(e),o;n?o=dP(i,n):o=i,r&&(o=o.bind(r));for(var l=t.split(" "),h=0;h<l.length;h++)a.push({name:l[parseInt(h.toString(),10)],listener:i,debounce:o}),B.isIE?e.addEventListener(l[parseInt(h.toString(),10)],o):e.addEventListener(l[parseInt(h.toString(),10)],o,{passive:!1});return o},s.remove=function(e,t,i){for(var r=s.addOrGetEventData(e),n=t.split(" "),a=function(l){var h=-1,u;r&&r.length!==0&&r.some(function(c,d){return c.name===n[parseInt(l.toString(),10)]&&c.listener===i?(h=d,u=c.debounce,!0):!1}),h!==-1&&r.splice(h,1),u&&e.removeEventListener(n[parseInt(l.toString(),10)],u)},o=0;o<n.length;o++)a(o)},s.clearEvents=function(e){var t,i;t=s.addOrGetEventData(e),i=me([],i,t);for(var r=0;r<i.length;r++)e.removeEventListener(i[parseInt(r.toString(),10)].name,i[parseInt(r.toString(),10)].debounce),t.shift()},s.trigger=function(e,t,i){for(var r=s.addOrGetEventData(e),n=0,a=r;n<a.length;n++){var o=a[n];o.name===t&&o.debounce.call(this,i)}},s}(),z_=/^svg|^path|^g/;function St(s,e){var t=z_.test(s)?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s);return typeof e>"u"||(t.innerHTML=e.innerHTML?e.innerHTML:"",e.className!==void 0&&(t.className=e.className),e.id!==void 0&&(t.id=e.id),e.styles!==void 0&&t.setAttribute("style",e.styles),e.attrs!==void 0&&De(t,e.attrs)),t}function Q(s,e){for(var t=vP(e),i=RegExp,r=0,n=s;r<n.length;r++)for(var a=n[r],o=0,l=t;o<l.length;o++){var h=l[o];if(na(a)){var u=ie("attributes.className",a);m(u)?kt("attributes.className",h,a):new i("\\b"+h+"\\b","i").test(u)||kt("attributes.className",u+" "+h,a)}else a.classList.contains(h)||a.classList.add(h)}return s}function te(s,e){for(var t=vP(e),i=0,r=s;i<r.length;i++){var n=r[i],a=na(n),o=a?ie("attributes.className",n):n.className!=="";if(o)for(var l=0,h=t;l<h.length;l++){var u=h[l];if(a){var c=ie("attributes.className",n),d=c.split(" "),p=d.indexOf(u);p!==-1&&d.splice(p,1),kt("attributes.className",d.join(" "),n)}else n.classList.remove(u)}}return s}function vP(s){var e=[];return typeof s=="string"?e.push(s):e=s,e}function or(s){var e=s;return e.style.visibility===""&&e.offsetWidth>0}function xs(s,e,t){for(var i=document.createDocumentFragment(),r=0,n=s;r<n.length;r++){var a=n[r];i.appendChild(a)}return e.insertBefore(i,e.firstElementChild),t&&mP(e),s}function Ut(s,e,t){var i=document.createDocumentFragment();if(s instanceof NodeList)for(;s.length>0;)i.appendChild(s[0]);else for(var r=0,n=s;r<n.length;r++){var a=n[r];i.appendChild(a)}return e.appendChild(i),t&&mP(e),s}function mP(s){var e=s.querySelectorAll("script");e.forEach(function(t){var i=document.createElement("script");i.text=t.innerHTML,document.head.appendChild(i),ne(i)})}function ne(s){var e=s.parentNode;if(e)return e.removeChild(s)}function pt(s){var e=s.parentNode;I.clearEvents(s),e.removeChild(s)}function De(s,e){for(var t=Object.keys(e),i=s,r=0,n=t;r<n.length;r++){var a=n[r];if(na(i)){var o=a;a==="tabindex"&&(o="tabIndex"),i.attributes[""+o]=e[""+a]}else i.setAttribute(a,e[""+a])}return i}function $(s,e,t){return e===void 0&&(e=document),s=gP(s),e.querySelector(s)}function ze(s,e,t){e===void 0&&(e=document),s=gP(s);var i=e.querySelectorAll(s);return i}function gP(s){var e=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(s.match(/#[0-9]/g)||s.match(e)){for(var t=s.split(","),i=0;i<t.length;i++){for(var r=t[parseInt(i.toString(),10)].split(" "),n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].indexOf("#")>-1&&!r[parseInt(n.toString(),10)].match(/\[.*\]/)){var a=r[parseInt(n.toString(),10)].split("#");if(a[1].match(/^\d/)||a[1].match(e)){var o=r[parseInt(n.toString(),10)].split(".");o[0]=o[0].replace(/#/,"[id='")+"']",r[parseInt(n.toString(),10)]=o.join(".")}}t[parseInt(i.toString(),10)]=r.join(" ")}return t.join(",")}return s}function U(s,e){var t=s;if(typeof t.closest=="function")return t.closest(e);for(;t&&t.nodeType===1;){if(fI(t,e))return t;t=t.parentNode}return null}function tt(s,e){e!==void 0&&Object.keys(e).forEach(function(t){s.style[t]=e[t]})}function br(s,e,t){Q([s],e),te([s],t)}function fI(s,e){var t=s.matches||s.msMatchesSelector||s.webkitMatchesSelector;return t?t.call(s,e):[].indexOf.call(document.querySelectorAll(e),s)!==-1}var j_=new RegExp("]"),Xo=function(){function s(e,t){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new xy(this),Re(t)||(typeof t=="string"?this.element=document.querySelector(t):this.element=t,m(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),Re(e)||this.setProperties(e,!0),this.isDestroyed=!1}return s.prototype.setProperties=function(e,t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!t,bt(this,e),t!==!0&&(bt(this.changedProperties,e),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},s.callChildDataBind=function(e,t){for(var i=Object.keys(e),r=0,n=i;r<n.length;r++){var a=n[r];if(t[""+a]instanceof Array)for(var o=0,l=t[""+a];o<l.length;o++){var h=l[o];h.dataBind!==void 0&&h.dataBind()}else t[""+a].dataBind()}},s.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},s.prototype.dataBind=function(){if(s.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var e=this.isProtectedOnChange,t=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(t,i),this.isProtectedOnChange=e}},s.prototype.serverDataBind=function(e){},s.prototype.saveChanges=function(e,t,i){this.isProtectedOnChange||(this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.finalUpdate(),this.finalUpdate=a_(this.dataBind.bind(this)))},s.prototype.addEventListener=function(e,t){this.modelObserver.on(e,t)},s.prototype.removeEventListener=function(e,t){this.modelObserver.off(e,t)},s.prototype.trigger=function(e,t,i,r){var n=this;if(this.isDestroyed!==!0){var a=this.isProtectedOnChange;this.isProtectedOnChange=!1;var o=this.modelObserver.notify(e,t,i,r);if(j_.test(e)){var l=ie(e,this);if(l){var h="Blazor";if(window[""+h]){var u=l.call(this,t);u&&typeof u.then=="function"?i?u.then(function(c){i&&(c=typeof c=="string"&&n.modelObserver.isJson(c)?JSON.parse(c):c,i.call(n,c))}).catch(function(c){r&&(c=typeof c=="string"&&n.modelObserver.isJson(c)?JSON.parse(c):c,r.call(n,c))}):o=u:i&&i.call(this,t)}else l.call(this,t),i&&i.call(this,t)}else i&&i.call(this,t)}return this.isProtectedOnChange=a,o}},s.prototype.addInstance=function(){var e="e-"+this.getModuleName().toLowerCase();Q([this.element],["e-lib",e]),m(this.element.ej2_instances)?kt("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},s.prototype.destroy=function(){var e=this;this.element.ej2_instances=this.element.ej2_instances?this.element.ej2_instances.filter(function(t){return t!==e}):[],te([this.element],["e-"+this.getModuleName()]),this.element.ej2_instances.length===0&&te([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},s}();function Ct(s,e){var t,i,r=typeof s=="string"?document.getElementById(s):s;for(i=0;i<r.ej2_instances.length;i++)if(t=r.ej2_instances[parseInt(i.toString(),10)],typeof e=="string"){var n=t.getModuleName();if(e===n)return t}else if(t instanceof e)return t}function yP(s,e,t,i){return(!s.properties.hasOwnProperty(e)||!(s.properties[e]instanceof i))&&(s.properties[""+e]=Sy(i,[s,e,t])),s.properties[""+e]}function Ww(s,e,t,i,r,n){for(var a=[],o=t?t.length:0,l=0;l<o;l++){var h=i;if(n&&(h=i(t[parseInt(l.toString(),10)],s)),r){var u=Sy(h,[s,e,{},!0]);u.setProperties(t[parseInt(l.toString(),10)],!0),a.push(u)}else a.push(Sy(h,[s,e,t[parseInt(l.toString(),10)],!1]))}return a}function bP(s,e){return function(){return this.properties.hasOwnProperty(e)||(this.properties[""+e]=s),this.properties[""+e]}}function B_(s,e){return function(t){if(this.properties[""+e]!==t){var i=this.properties.hasOwnProperty(e)?this.properties[e]:s;this.saveChanges(e,t,i),this.properties[""+e]=t}}}function H_(s,e,t){return function(){return yP(this,e,s,t)}}function V_(s,e,t){return function(i){yP(this,e,s,t).setProperties(i)}}function U_(s,e,t){return function(){var i=this;if(!this.properties.hasOwnProperty(e)){var r=Ww(this,e,s,t,!1);this.properties[""+e]=r}var n=this.controlParent!==void 0&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return!this.properties[e].hasOwnProperty("push")&&!n&&["push","pop"].forEach(function(a){var o={value:W_(a,e,t,i.properties[""+e]).bind(i),configurable:!0};Object.defineProperty(i.properties[""+e],a,o)}),this.properties[e].hasOwnProperty("isComplexArray")||Object.defineProperty(this.properties[""+e],"isComplexArray",{value:!0}),this.properties[""+e]}}function __(s,e,t){return function(i){this.isComplexArraySetter=!0;var r=Ww(this,e,s,t,!1),n=Ww(this,e,i,t,!0);this.isComplexArraySetter=!1,this.saveChanges(e,n,r),this.properties[""+e]=n}}function W_(s,e,t,i){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=this.propName?this.getParentKey()+"."+e+"-":e+"-";switch(s){case"push":for(var o=0;o<r.length;o++){Array.prototype[""+s].apply(i,[r[parseInt(o.toString(),10)]]);var l=mA(a+(i.length-1),r[parseInt(o.toString(),10)],!this.controlParent,s);this.serverDataBind(l,r[parseInt(o.toString(),10)],!1,s)}break;case"pop":Array.prototype[""+s].apply(i);var h=mA(a+i.length,null,!this.controlParent,s);this.serverDataBind(h,{ejsAction:"pop"},!1,s);break}return i}}function mA(s,e,t,i){var r=s;if(t&&(r={},r[""+s]=e,e&&typeof e=="object")){var n="ejsAction";r[""+s][""+n]=i}return r}function S(s){return function(e,t){var i={set:B_(s,t),get:bP(s,t),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i),gb(e,t,"prop",s)}}function Ee(s,e){return function(t,i){var r={set:V_(s,i,e),get:H_(s,i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),gb(t,i,"complexProp",s,e)}}function ii(s,e){return function(t,i){var r={set:__(s,i,e),get:U_(s,i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),gb(t,i,"colProp",s,e)}}function _(){return function(s,e){var t={set:function(i){var r=this.properties[""+e];if(r!==i){var n=CP(this,e);Re(r)===!1&&n.context.removeEventListener(n.prefix,r),n.context.addEventListener(n.prefix,i),this.properties[""+e]=i}},get:bP(void 0,e),enumerable:!0,configurable:!0};Object.defineProperty(s,e,t),gb(s,e,"event")}}function Ot(s){}function gb(s,e,t,i,r){Re(s.propList)&&(s.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),s.propList[t+"s"].push({propertyName:e,defaultValue:i,type:r}),s.propList[t+"Names"].push(e)}function CP(s,e){if(s.hasOwnProperty("parentObj")===!1)return{context:s,prefix:e};var t=ie("propName",s);return t&&(e=t+"-"+e),CP(ie("parentObj",s),e)}var q_=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),fo=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ri=function(s){q_(e,s);function e(i){var r=s.call(this,i,void 0)||this;return r.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},r}t=e,e.prototype.animate=function(i,r){r=r||{};var n=this.getModel(r);if(typeof i=="string")for(var a=Array.prototype.slice.call(ze(i,document)),o=0,l=a;o<l.length;o++){var h=l[o];n.element=h,t.delayAnimation(n)}else n.element=i,t.delayAnimation(n)},e.stop=function(i,r){i.style.animation="",i.removeAttribute("e-animate");var n=i.getAttribute("e-animation-id");if(n){var a=parseInt(n,10);cancelAnimationFrame(a),i.removeAttribute("e-animation-id")}r&&r.end&&r.end.call(this,r)},e.delayAnimation=function(i){vi==="Disable"||vi===qw.Disable?(i.begin&&i.begin.call(this,i),i.end&&i.end.call(this,i)):i.delay?setTimeout(function(){t.applyAnimation(i)},i.delay):t.applyAnimation(i)},e.applyAnimation=function(i){var r=this;i.timeStamp=0;var n=0,a=0,o=0,l=i.duration;i.element.setAttribute("e-animate","true");var h=function(u){try{if(u){o=o===0?u:o,i.timeStamp=u+i.timeStamp-o,o=u,!n&&i.begin&&i.begin.call(r,i),n=n+1;var c=i.timeStamp/n;i.timeStamp<l&&i.timeStamp+c<l&&i.element.getAttribute("e-animate")?(i.element.style.animation=i.name+" "+i.duration+"ms "+i.timingFunction,i.progress&&i.progress.call(r,i),requestAnimationFrame(h)):(cancelAnimationFrame(a),i.element.removeAttribute("e-animation-id"),i.element.removeAttribute("e-animate"),i.element.style.animation="",i.end&&i.end.call(r,i))}else a=requestAnimationFrame(h),i.element.setAttribute("e-animation-id",a.toString())}catch(d){cancelAnimationFrame(a),i.element.removeAttribute("e-animation-id"),i.fail&&i.fail.call(r,d)}};h()},e.prototype.getModel=function(i){return{name:i.name||this.name,delay:i.delay||this.delay,duration:i.duration!==void 0?i.duration:this.duration,begin:i.begin||this.begin,end:i.end||this.end,fail:i.fail||this.fail,progress:i.progress||this.progress,timingFunction:this.easing[i.timingFunction]?this.easing[i.timingFunction]:i.timingFunction||this.easing[this.timingFunction]}},e.prototype.onPropertyChanged=function(i,r){},e.prototype.getModuleName=function(){return"animation"},e.prototype.destroy=function(){};var t;return fo([S("FadeIn")],e.prototype,"name",void 0),fo([S(400)],e.prototype,"duration",void 0),fo([S("ease")],e.prototype,"timingFunction",void 0),fo([S(0)],e.prototype,"delay",void 0),fo([_()],e.prototype,"progress",void 0),fo([_()],e.prototype,"begin",void 0),fo([_()],e.prototype,"end",void 0),fo([_()],e.prototype,"fail",void 0),e=t=fo([Ot],e),e}(Xo);function yr(s,e,t){var i=Y_(e);return i.rippleFlag===!1||i.rippleFlag===void 0&&!Zl?function(){}:(s.setAttribute("data-ripple","true"),I.add(s,"mousedown",gA,{parent:s,rippleOptions:i}),I.add(s,"mouseup",yA,{parent:s,rippleOptions:i,done:t}),I.add(s,"mouseleave",xc,{parent:s,rippleOptions:i}),B.isPointer&&I.add(s,"transitionend",xc,{parent:s,rippleOptions:i}),function(){s.removeAttribute("data-ripple"),I.remove(s,"mousedown",gA),I.remove(s,"mouseup",yA),I.remove(s,"mouseleave",xc),I.remove(s,"transitionend",xc)})}function Y_(s){var e={selector:s&&s.selector?s.selector:null,ignore:s&&s.ignore?s.ignore:null,rippleFlag:s&&s.rippleFlag,isCenterRipple:s&&s.isCenterRipple,duration:s&&s.duration?s.duration:350};return e}function gA(s){var e=s.target,t=this.rippleOptions.selector,i=t?U(e,t):e;if(!(!i||this.rippleOptions&&U(e,this.rippleOptions.ignore))){var r=i.getBoundingClientRect(),n=s.pageX-document.body.scrollLeft,a=s.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),o=Math.max(Math.abs(n-r.left),Math.abs(n-r.right)),l=Math.max(Math.abs(a-r.top),Math.abs(a-r.bottom)),h=Math.sqrt(o*o+l*l),u=h*2+"px",c=n-r.left-h,d=a-r.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(c=0,d=0,u="100%"),i.classList.add("e-ripple");var p=this.rippleOptions.duration.toString(),f="width: "+u+";height: "+u+";left: "+c+"px;top: "+d+"px;transition-duration: "+p+"ms;",v=St("div",{className:"e-ripple-element",styles:f});i.appendChild(v),window.getComputedStyle(v).getPropertyValue("opacity"),v.style.transform="scale(1)",i!==this.parent&&I.add(i,"mouseleave",xc,{parent:this.parent,rippleOptions:this.rippleOptions})}}function yA(s){SP(s,this)}function xc(s){SP(s,this)}function SP(s,e){var t=e.rippleOptions.duration,i=s.target,r=e.rippleOptions.selector,n=r?U(i,r):i;if(!(!n||n&&n.className.indexOf("e-ripple")===-1)){var a=ze(".e-ripple-element",n),o=a[a.length-1];o&&(o.style.opacity="0.5"),e.parent!==n&&I.remove(n,"mouseleave",xc),setTimeout(function(){o&&o.parentNode&&o.parentNode.removeChild(o),n.getElementsByClassName("e-ripple-element").length||n.classList.remove("e-ripple"),e.done&&e.done(s)},t)}}var Zl=!1;function Q_(s){return Zl=s,Zl}var vi,qw;(function(s){s.Default="Default",s.Enable="Enable",s.Disable="Disable"})(qw||(qw={}));var G_="Module",$_=function(){function s(e){this.loadedModules=[],this.parent=e}return s.prototype.inject=function(e,t){var i=e.length;if(i===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(e);for(var r=0;r<i;r++)for(var n=e[parseInt(r.toString(),10)],a=0,o=t;a<o.length;a++){var l=o[a],h=n.member;if(l&&l.prototype.getModuleName()===n.member&&!this.isModuleLoaded(h)){var u=Sy(l,n.args),c=this.getMemberName(h);n.isProperty?kt(c,l,this.parent):kt(c,u,this.parent);var d=n;d.member=c,this.loadedModules.push(d)}}},s.prototype.clean=function(){for(var e=0,t=this.loadedModules;e<t.length;e++){var i=t[e];i.isProperty||ie(i.member,this.parent).destroy()}this.loadedModules=[]},s.prototype.clearUnusedModule=function(e){for(var t=this,i=e.map(function(l){return t.getMemberName(l.member)}),r=this.loadedModules.filter(function(l){return i.indexOf(l.member)===-1}),n=0,a=r;n<a.length;n++){var o=a[n];o.isProperty||ie(o.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(o),1),dI(this.parent,o.member)}},s.prototype.getMemberName=function(e){return e[0].toLowerCase()+e.substring(1)+G_},s.prototype.isModuleLoaded=function(e){for(var t=0,i=this.loadedModules;t<i.length;t++){var r=i[t];if(r.member===this.getMemberName(e))return!0}return!1},s}(),ke=function(){function s(e,t,i,r){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=ie("callChildDataBind",Xo),this.parentObj=e,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=t,this.isParentArray=r,this.setProperties(i,!0)}return s.prototype.updateChange=function(e,t){e===!0?this.parentObj.childChangedProperties[""+t]=e:delete this.parentObj.childChangedProperties[""+t],this.parentObj.updateChange&&this.parentObj.updateChange(e,this.parentObj.propName)},s.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var e=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),t=function(){clearTimeout(e)};this.finalUpdate=t}},s.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},s.prototype.setProperties=function(e,t){t===!0?(bt(this,e),this.updateChange(!1,this.propName),this.clearChanges()):bt(this,e)},s.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var e=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(kt(this.propName+"."+e,this.changedProperties,this.parentObj.changedProperties),kt(this.propName+"."+e,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},s.prototype.saveChanges=function(e,t,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(e,t,!0),this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},s.prototype.serverDataBind=function(e,t,i,r){},s.prototype.getParentKey=function(e){var t="",i=this.propName;if(this.isParentArray){t=this.parentObj[this.propName].indexOf(this);var r=this.parentObj[this.propName].length;r=e?r:r>0?r-1:0,t=t!==-1?"-"+t:"-"+r,i=i+t}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+t),i},s}(),X_=["grid","pivotview","treegrid","spreadsheet","rangeNavigator","DocumentEditor","listbox","inplaceeditor","PdfViewer","richtexteditor","DashboardLayout","chart","stockChart","circulargauge","diagram","heatmap","lineargauge","maps","slider","smithchart","barcode","sparkline","treemap","bulletChart","kanban","daterangepicker","schedule","gantt","signature","query-builder","drop-down-tree","carousel","filemanager","uploader","accordion","tab","treeview"],bA=[115,121,110,99,102,117,115,105,111,110,46,105,115,76,105,99,86,97,108,105,100,97,116,101,100],Yw,xP=function(){function s(e){this.isValidated=!1,this.isLicensed=!0,this.version="24",this.platform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats|essentialstudio/i,this.errors={noLicense:"<span>This application was built using a trial version of Syncfusion Essential Studio. To remove the license validation message permanently, a valid license key must be included.</span>",trailExpired:"<span>This application was built using a trial version of Syncfusion Essential Studio. To remove the license validation message permanently, a valid license key must be included.</span>",versionMismatched:"<span>The included Syncfusion license key is invalid.</span>",platformMismatched:"<span>The included Syncfusion license key is invalid.</span>",invalidKey:"<span>The included Syncfusion license key is invalid.</span>"},this.manager=function(){var t=null;function i(n){t=n}function r(){return t}return{setKey:i,getKey:r}}(),this.npxManager=function(){var t="npxKeyReplace";function i(){return t}return{getKey:i}}(),this.manager.setKey(e)}return s.prototype.validate=function(){var e=[115,121,110,99,102,117,115,105,111,110,46,108,105,99,101,110,115,101,67,111,110,116,101,110,116],t=[115,121,110,99,102,117,115,105,111,110,46,99,108,97,105,109,65,99,99,111,117,110,116,85,82,76];if(!this.isValidated&&Pu&&!ie(Jv(bA),Pu)&&!ie("Blazor",Pu)){var i=void 0,r=void 0;if(this.manager&&this.manager.getKey()||this.npxManager&&this.npxManager.getKey()!=="npxKeyReplace"){var n=this.getInfoFromKey();if(n&&n.length)for(var a=0,o=n;a<o.length;a++){var l=o[a];if(!this.platform.test(l.platform)||l.invalidPlatform)i=this.errors.platformMismatched;else if(l.version.indexOf(this.version)===-1)i=this.errors.versionMismatched,i=i.replace("##LicenseVersion",l.version),i=i.replace("##Requireversion",this.version+".x");else if(l.expiryDate){var h=new Date(l.expiryDate),u=new Date;if(h!==u&&h<u)i=this.errors.trailExpired;else break}}else i=this.errors.invalidKey}else{var c=ie(Jv(e),Pu);r=ie(Jv(t),Pu),c&&c!==""?i=c:i=this.errors.noLicense}if(i&&typeof document<"u"&&!m(document)){Yw=r&&r!==""?r:"https://www.syncfusion.com/account/claim-license-key?pl=SmF2YVNjcmlwdA==&vs=MjQ=&utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information";var d=St("div",{innerHTML:`<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style="top: 6px;
                    position: absolute;
                    left: 16px;
                    width: 24px;
                    height: 24px;"/>`+i+' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href='+Yw+">Claim your free account</a>"});d.setAttribute("style",`position: fixed;
                top: 10px;
                left: 10px;
                right: 10px;
                font-size: 14px;
                background: #EEF2FF;
                color: #222222;
                z-index: 999999999;
                text-align: left;
                border: 1px solid #EEEEEE;
                padding: 10px 11px 10px 50px;
                border-radius: 8px;
                font-family: Helvetica Neue, Helvetica, Arial;`),document.body.appendChild(d),this.isLicensed=!1}this.isValidated=!0,kt(Jv(bA),this.isValidated,Pu)}return this.isLicensed},s.prototype.getDecryptedData=function(e){try{return atob(e)}catch{return""}},s.prototype.getInfoFromKey=function(){try{var e="",t=[5439488,7929856,5111808,6488064,4587520,7667712,5439488,6881280,5177344,7208960,4194304,4456448,6619136,7733248,5242880,7077888,6356992,7602176,4587520,7274496,7471104,7143424],i=[],r=[],n=!1,a=!1;this.manager.getKey()?e=this.manager.getKey():(a=!0,e=this.npxManager.getKey().split("npxKeyReplace")[1]);for(var o=e.split(";"),l=0,h=o;l<h.length;l++){var u=h[l],c=this.getDecryptedData(u);if(c){var d=0,p="";if(a){for(var g=c[c.length-1],b=[],f=0;f<c.length;f++)b[parseInt(f.toString(),10)]=c[parseInt(f.toString(),10)].charCodeAt(0)-g.charCodeAt(0);for(var f=0;f<b.length;f++)p+=String.fromCharCode(b[parseInt(f.toString(),10)])}else for(var f=0;f<c.length;f++,d++){d===t.length&&(d=0);var v=c.charCodeAt(f);p+=String.fromCharCode(v^t[parseInt(d.toString(),10)]>>16)}this.platform.test(p)?(i=p.split(";"),n=!1,i.length>3&&r.push({platform:i[0],version:i[1],expiryDate:i[2]})):p&&p.split(";").length>3&&(n=!0)}}return n&&!r.length?[{invalidPlatform:n}]:r.length?r:null}catch{return null}},s}(),wP=new xP;function Jv(s){for(var e="",t=0,i=s;t<i.length;t++){var r=i[t];e+=String.fromCharCode(r)}return e}function MP(s){wP=new xP(s)}var K_=function(s){return s&&MP(s),wP.validate()},Z_=function(){var s=`
    <div style="
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 99999;
    ">
        <div style="
    background: #FFFFFF;
    height: 455px;
    width: 840px;
    font-family: Helvetica Neue, Helvetica, Arial;
    color: #000000;
    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);
    display: block;
    margin: 8% auto;
    border-radius: 20px;
    ">
            <div style="
    position: absolute;
width: 838px;
height: 62px;
background-color: #F9F9F9;
border: 1px solid #EEEEEE;
border-top-left-radius: 20px;
border-top-right-radius: 20px;
">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="
    text-align: left;
    width: 146px;
    position: absolute;
    top: 14px;
    left: 31px;
">
            </div>
            <div style="
    position: relative;
    top: 80px;
    left: 32px;
    font-size: 20px;
    text-align: left;
    font-weight: 700;
    letter-spacing: 0.02em;
    font-style: normal;
    line-height: 125%;
    ">Claim your FREE account and get a key in less than a minute</div>
            <ul style="
        font-size: 15px;
        font-weight: 400;
        color: #333333;
        letter-spacing: 0.01em;
        position: relative;
        left: 32px;
        top: 88px;
        line-height: 180%;
        ">
                <li><span>Access to a 30-day free trial of any of our products.</span></li>
                <li><span>Access to 24x5 support by developers via the <a href="https://support.syncfusion.com/create?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">support tickets</a>, <a href="https://www.syncfusion.com/forums?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">forum</a>, <a href="https://www.syncfusion.com/feedback?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">feature &amp; feedback page</a> and chat.</span></li>
                <li><span>200+ <a href="https://www.syncfusion.com/succinctly-free-ebooks?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">ebooks </a>on the latest technologies, industry trends, and research topics.</span>
                </li>
                <li><span>Largest collection of over 7,000 flat and wireframe icons for free with Syncfusion <a href="https://www.syncfusion.com/downloads/metrostudio?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">Metro Studio.</a></span></li>
                <li><span>Free and unlimited access to Syncfusion technical <a href="https://www.syncfusion.com/blogs/?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">blogs</a> and <a href="https://www.syncfusion.com/resources/techportal/whitepapers?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">whitepapers.</a></span></li>
            </ul>
            <div style="
            font-size: 18px;
            font-weight: 700;
            position: relative;
            line-height: 125%;
            letter-spacing: 0.02em;
            top: 90px;
            left: 32px;
    ">Syncfusion is trusted by 29,000+ businesses worldwide</div>
            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODIwIiBoZWlnaHQ9IjU2IiB2aWV3Qm94PSIwIDAgODIwIDU2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MjcuNjE3IDIyLjU2NTlWMjQuNzIyNkM0MjYuNTU4IDI0LjM2MzggNDI1LjM5OCAyNC4xNTQ0IDQyNC40NzQgMjQuMTU0NEM0MjMuMzMzIDI0LjE1NDQgNDIyLjY5OCAyNC40OTEyIDQyMi42OTggMjUuMDk2M0M0MjIuNjk4IDI1LjQ4MjQgNDIyLjk3NiAyNS43MzgzIDQyMy43NzMgMjYuMDg1NEw0MjUuOTE3IDI3LjAxNzRDNDI3LjYzMyAyNy43NjM5IDQyOC40OTcgMjguODUzIDQyOC40OTcgMzAuMjY4MUM0MjguNDk3IDMyLjQ1MjIgNDI2LjU0NiAzMy44MyA0MjMuNDUyIDMzLjgzQzQyMi4zMjQgMzMuODMgNDIxLjAxOCAzMy42NzM2IDQxOS42MzYgMzMuMzcwOVYzMS4xNDE2QzQyMS4wMDYgMzEuNTAyOCA0MjIuMjYyIDMxLjY5NTcgNDIzLjIzOSAzMS42OTU3QzQyNC41MTggMzEuNjk1NyA0MjUuMjAzIDMxLjM1MDYgNDI1LjIwMyAzMC43MDc0QzQyNS4yMDMgMzAuMzIwOCA0MjQuOTM1IDMwLjAzNjcgNDI0LjMyMiAyOS43NzE3TDQyMS45NzUgMjguNzU5M0M0MjAuMjM2IDI4LjAwNzggNDE5LjQzMyAyNi45OTU0IDQxOS40MzMgMjUuNTUyMUM0MTkuNDMzIDIzLjQ4MzcgNDIxLjMxNCAyMi4xNjQ5IDQyNC4yNjUgMjIuMTY0OUM0MjUuMjk4IDIyLjE2NDkgNDI2LjU3IDIyLjMxNzEgNDI3LjYxNyAyMi41NjU5VjIyLjU2NTlaTTQzMC4xNjcgMjIuMzkwOUg0MzMuNjM1VjMzLjYwMzlINDMwLjE2N1YyMi4zOTA5Wk00NDQuOTExIDIyLjM5MDlWMjQuNDQ1MUg0MzkuNjc1VjI2Ljk3NDJINDQ0LjI0OVYyOC44MzIzSDQzOS42NzVWMzEuNDU0M0g0NDQuOTc4VjMzLjYwMzlINDM2LjMwNVYyMi4zOTA5SDQ0NC45MTFaTTQ2MS4yOTQgMjIuMzkwOVYzMy42MDM5SDQ1Ny45MzlWMjYuMjIzNkw0NTQuNjUyIDMzLjY5MTVINDUyLjUzMUw0NDkuMjY2IDI2LjIyMzZWMzMuNjAzOUg0NDYuOTQ5VjIyLjM5MDlINDUxLjE4NEw0NTQuMTc4IDI5LjIxMTRMNDU3LjE1NiAyMi4zOTA5SDQ2MS4yOTRWMjIuMzkwOVpNNDcyLjU3OSAyMi4zOTA5VjI0LjQ0NTFINDY3LjMzNVYyNi45NzQySDQ3MS45MDhWMjguODMyM0g0NjcuMzM1VjMxLjQ1NDNINDcyLjYzOFYzMy42MDM5SDQ2My45NTdWMjIuMzkwOUg0NzIuNTc5Wk00ODQuNzk0IDIyLjM5MDlWMzMuNjAzOUg0ODEuMDkzTDQ3Ni45MjYgMjYuNDEyM1YzMy42MDM5SDQ3NC42MDhWMjIuMzkwOUg0NzguNDA3TDQ4Mi40ODQgMjkuNDg3NlYyMi4zOTA5SDQ4NC43OTRaTTQ5NC44NTggMjIuNTY1OVYyNC43MjI2QzQ5My44MDcgMjQuMzY2MyA0OTIuNjQgMjQuMTU0NCA0OTEuNzMyIDI0LjE1NDRDNDkwLjU3MyAyNC4xNTQ0IDQ4OS45MzkgMjQuNDg1OCA0ODkuOTM5IDI1LjA5M0M0ODkuOTM5IDI1LjQ4ODYgNDkwLjE5OCAyNS43MjUgNDkxLjAyMyAyNi4wODU5TDQ5My4xNTcgMjcuMDE3OEM0OTQuODg1IDI3Ljc3MjIgNDk1LjczOSAyOC44NTE4IDQ5NS43MzkgMzAuMjgzNUM0OTUuNzM5IDMyLjQ1NTkgNDkzLjc4NiAzMy44MzA4IDQ5MC42OTkgMzMuODMwOEM0ODkuNTY5IDMzLjgzMDggNDg4LjI1OSAzMy42NzM2IDQ4Ni44NzggMzMuMzcxN1YzMS4xNDI0QzQ4OC4yNDcgMzEuNTAyOCA0ODkuNDk5IDMxLjY5NjUgNDkwLjQ3IDMxLjY5NjVDNDkxLjc0IDMxLjY5NjUgNDkyLjQ0NCAzMS4zNTE1IDQ5Mi40NDQgMzAuNzI4NUM0OTIuNDQ0IDMwLjMxNjMgNDkyLjE5NyAzMC4wNTA0IDQ5MS41NTUgMjkuNzcyNUw0ODkuMjE4IDI4Ljc2MDFDNDg3LjQ2NyAyOC4wMDI4IDQ4Ni42NzQgMjcuMDAyIDQ4Ni42NzQgMjUuNTUzM0M0ODYuNjc0IDIzLjQ4NjIgNDg4LjU1NiAyMi4xNjY1IDQ5MS41IDIyLjE2NjVDNDkyLjUzNiAyMi4xNjUzIDQ5My44MTMgMjIuMzE3MSA0OTQuODU4IDIyLjU2NTlWMjIuNTY1OVoiIGZpbGw9IiMwMEEwQjAiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzUyLjQxMyAyNi44MTlDMzUwLjk5MiAyNS4yNzU5IDM0OS42MzggMjMuODMxNSAzNDguMzQ5IDIyLjE1NzRMMzQ3LjkyIDIxLjU5OTVDMzQ5LjQwNiAyMS4zNjkzIDM1MC42OTUgMjAuMzg0OCAzNTAuNjk1IDE4Ljc0MzNDMzUwLjY5NSAxNy4yMzMxIDM0OS41MzkgMTYuMjQ4MiAzNDcuODIxIDE2LjI0ODJDMzQ2LjU5OCAxNi4yNDgyIDM0NS43MDYgMTYuMzEzNyAzNDUuMjQzIDE2LjMxMzdDMzQ0LjcxNSAxNi4zMTM3IDM0NC4yODUgMTYuMzEzNyAzNDMuNzkgMTYuMjgwOEMzNDMuODU2IDE4LjE1MjEgMzQzLjg4OSAxOC4yODM0IDM0My44ODkgMTkuNDMyMlYyMy42MzQzQzM0My44ODkgMjQuNDU1MyAzNDMuODU2IDI1LjI3NTkgMzQzLjc5IDI2LjgxODZDMzQ0LjE1MyAyNi43MjAyIDM0NC41MTcgMjYuNzIwMiAzNDQuNzgxIDI2LjcyMDJDMzQ1LjA0NSAyNi43MjAyIDM0NS40MDkgMjYuNzUzMSAzNDUuNzA2IDI2LjgxODZDMzQ1LjY0IDI1Ljc2NzkgMzQ1LjYwNyAyNC4wMjgzIDM0NS42MDcgMjMuNjM0M1YyMS4yMDUxQzM0Ny4xNiAyMy4yMDc3IDM0OS4yMDkgMjUuNjY5NSAzNTAuMDAxIDI2LjgxODZDMzUwLjM5OCAyNi43MjAyIDM1MC43MjggMjYuNzIwMiAzNTEuMTI0IDI2LjcyMDJDMzUxLjQ1NSAyNi43MjA2IDM1MS45MTggMjYuNzIwNiAzNTIuNDEzIDI2LjgxOVYyNi44MTlaTTM0OC44NzggMTkuMDA2QzM0OC44NzggMjAuMDIzNCAzNDguMzE3IDIxLjIwNTQgMzQ2Ljc5NyAyMS4yMDU0QzM0Ni40IDIxLjIwNTQgMzQ2LjAwMyAyMS4yMDU0IDM0NS42MDcgMjEuMTcyNVYxNy4wNjg4QzM0Ni4wMDMgMTYuOTcwNCAzNDYuNDk5IDE2LjkwNDYgMzQ2Ljc2MyAxNi45MDQ2QzM0OC4wODUgMTYuOTA0OSAzNDguODc4IDE3LjY2IDM0OC44NzggMTkuMDA2VjE5LjAwNlpNMzgyLjM4IDI2Ljg4NDVDMzgxLjgxOSAyNi4yOTM2IDM4MC45NiAyNS4zNDE3IDM4MC4xMzQgMjQuNDIyM0MzODAuODI4IDIzLjY2NzIgMzgxLjU1NSAyMi41NTEgMzgxLjk4NCAyMS41OTkxQzM4MS43MTkgMjEuNDY3OCAzODEuMzU2IDIxLjIwNTEgMzgxLjA5MiAyMC45NzUzQzM4MC45OTMgMjEuNzk1OSAzODAuNDMyIDIyLjg3OTIgMzc5LjYzOSAyMy44MzE1QzM3OC41MTUgMjIuNTE4NSAzNzguMjE4IDIyLjE1NzQgMzc3LjE5MyAyMC43Nzg1QzM3OC41ODEgMTkuODkyMSAzNzkuMjQyIDE4Ljg3NDMgMzc5LjI0MiAxOC4wNTM3QzM3OS4yNDIgMTcuMTAxNyAzNzguNTgxIDE2LjExNjkgMzc2Ljk2MiAxNi4xMTY5QzM3NS4yMTEgMTYuMTE2OSAzNzQuMzUyIDE3LjIwMDIgMzc0LjM1MiAxOC40ODAzQzM3NC4zNTIgMTkuMjM1NCAzNzQuNTUgMTkuODkxNyAzNzUuMzc2IDIwLjk3NTNDMzc0LjA1NCAyMS42OTc1IDM3Mi43NjYgMjIuNzQ3OSAzNzIuNzY2IDI0LjQyMjNDMzcyLjc2NiAyNi4wNjM5IDM3NC4wODcgMjYuOTE3NCAzNzUuNzA3IDI2LjkxNzRDMzc3LjE5MyAyNi45MTc0IDM3OC4xNTEgMjYuMzI2NiAzNzguOTEyIDI1LjYzNjlMMzc5LjkwMiAyNi44MTlDMzgwLjIgMjYuNzg2MSAzODAuNTMxIDI2LjcyMDYgMzgwLjg2MSAyNi43MjA2QzM4MS4zMjQgMjYuNzIwNiAzODEuODUyIDI2Ljc4NjEgMzgyLjM4IDI2Ljg4NDVWMjYuODg0NVpNMzgzLjM3MiA0MC4wMTU4QzM4MS45MTggMzguNDczIDM4MC41OTcgMzcuMDYxMiAzNzkuMzA4IDM1LjM4NzFMMzc4Ljg3OCAzNC44Mjg4QzM4MC4zMzIgMzQuNTk5MSAzODEuNjU0IDMzLjYxNSAzODEuNjU0IDMxLjk0MDFDMzgxLjY1NCAzMC40NjMyIDM4MC40OTggMjkuNDQ1NCAzNzguNzc5IDI5LjQ0NTRDMzc3LjU1NyAyOS40NDU0IDM3Ni42MzIgMjkuNTQzNSAzNzYuMTY5IDI5LjU0MzVDMzc1LjY3MyAyOS41NDM1IDM3NS4yNDQgMjkuNTQzNSAzNzQuNzQ4IDI5LjQ3NzZDMzc0LjgxNCAzMS4zODIyIDM3NC44NDggMzEuNDgwMiAzNzQuODQ4IDMyLjYyOTRWMzYuODMxMUMzNzQuODQ4IDM3LjY1MjQgMzc0LjgxNCAzOC41MDUyIDM3NC43NDggNDAuMDE1NEMzNzUuMTEyIDM5Ljk0OTYgMzc1LjQ3NSAzOS45NDk2IDM3NS43MDcgMzkuOTQ5NkMzNzYuMDA0IDM5Ljk0OTYgMzc2LjM2OCAzOS45NDk2IDM3Ni42MzIgNDAuMDE1NEMzNzYuNTY1IDM4Ljk5OCAzNzYuNTMzIDM3LjI1ODEgMzc2LjUzMyAzNi44MzExVjM0LjQzNDhDMzc4LjExOSAzNi40MDQyIDM4MC4xNjcgMzguODk5NiAzODAuOTYgNDAuMDE1NEMzODEuMzU2IDM5Ljk0OTYgMzgxLjY4NyAzOS45NDk2IDM4Mi4wODMgMzkuOTQ5NkMzODIuMzggMzkuOTUgMzgyLjg3NiAzOS45NSAzODMuMzcyIDQwLjAxNThaTTM2Mi4xNiAyNi44MTlDMzYwLjk3MSAyNS41NzE1IDM1OC44ODkgMjIuOTc4IDM1OC4wNjMgMjEuOTkzNUwzNTcuMjM3IDIwLjk3NTdDMzU4LjA5NiAxOS45NTgzIDM1OC42OSAxOS4zMzQxIDM1OS4zMTkgMTguNTc5QzM2MC4wNDUgMTcuNzkxIDM2MC43MDYgMTYuOTcwNCAzNjEuNDk5IDE2LjI0ODJDMzYxLjEzNiAxNi4zMTM3IDM2MC45MzcgMTYuMzEzNyAzNjAuNzM5IDE2LjMxMzdDMzYwLjU0MSAxNi4zMTM3IDM2MC4zNDMgMTYuMzEzNyAzNjAuMTQ0IDE2LjI0ODJDMzU5LjkxMyAxNi42MDkzIDM1OS41NSAxNy4wNjg4IDM1OS4xNTMgMTcuNTI4N0MzNTguNzU2IDE3Ljk1NTYgMzU4LjM2IDE4LjM4MjIgMzU4LjA2MyAxOC43NDMzQzM1Ny4yMzYgMTkuNjk1MiAzNTYuNzc0IDIwLjE1NDcgMzU1LjU4NSAyMS4yNzA5VjE5LjQ2NTVDMzU1LjU4NSAxOC40MTUxIDM1NS41ODUgMTcuNzI1NSAzNTUuNjUxIDE2LjI0ODJDMzU1LjMyMSAxNi4zMTM3IDM1NC45NTcgMTYuMzEzNyAzNTQuNzI2IDE2LjMxMzdDMzU0LjQ2MSAxNi4zMTM3IDM1NC4wMzIgMTYuMzEzNyAzNTMuNzY4IDE2LjI0ODJDMzUzLjgzMyAxNy44MjM5IDM1My44NjcgMTguMjgzNCAzNTMuODY3IDE5LjQzMjVWMjMuNjM0N0MzNTMuODY3IDI0LjY4NSAzNTMuODMzIDI1LjMwODggMzUzLjc2OCAyNi44MTlDMzU0LjE2NCAyNi43MjA2IDM1NC40OTUgMjYuNzIwNiAzNTQuNzI2IDI2LjcyMDZDMzU0Ljk1NyAyNi43MjA2IDM1NS4zNTMgMjYuNzUzNSAzNTUuNjUxIDI2LjgxOUMzNTUuNTg1IDI1LjE0NDkgMzU1LjU4NSAyNC4xNTk3IDM1NS41ODUgMjMuNjM0N1YyMS40MzUyQzM1Ni44MDcgMjIuODc5NiAzNTguNjkgMjUuMjQzMyAzNTkuNzQ4IDI2LjgxOUMzNjAuMTMgMjYuNzU2MyAzNjAuNTE3IDI2LjcyMzQgMzYwLjkwNSAyNi43MjA2QzM2MS4yMDIgMjYuNzIwNiAzNjEuNjY1IDI2LjcyMDYgMzYyLjE2IDI2LjgxOVYyNi44MTlaTTM3Mi42MDEgNDAuMDE1OEMzNzIuNTY4IDM5Ljg1MTkgMzcyLjUzNSAzOS43MjA2IDM3Mi41MzUgMzkuNTIzNEMzNzIuNTM1IDM5LjM5MjggMzcyLjU2OCAzOS4yMjgxIDM3Mi42MDEgMzkuMDk2NEMzNzEuMjggMzkuMTI5NyAzNjguOTAxIDM5LjE5NTIgMzY4LjM3MiAzOS4xOTUyVjM0LjY2NDlDMzY5LjY5NCAzNC42NjQ5IDM3MC45ODIgMzQuNjY0OSAzNzIuMjcgMzQuNzk2M0MzNzIuMjM4IDM0LjYzMjQgMzcyLjIwNCAzNC40Njc3IDM3Mi4yMDQgMzQuMzM2NEMzNzIuMjA0IDM0LjIwNTggMzcyLjIwNCAzNC4wNDE5IDM3Mi4yNyAzMy44NDQ3QzM3MS4zNDYgMzMuOTQyOCAzNjkuMTk4IDMzLjk3NiAzNjguMzcyIDMzLjk3NlYzMC4yNjZDMzY5LjgyNiAzMC4yNjYgMzcwLjY4NSAzMC4yNjYgMzcxLjE4IDMwLjI5OTNMMzcyLjUwMiAzMC4zNjUxQzM3Mi40MzYgMzAuMTY3OSAzNzIuNDM2IDMwLjA2OTIgMzcyLjQzNiAyOS45MDUzQzM3Mi40MzYgMjkuNzQxNCAzNzIuNDM2IDI5LjcwODEgMzcyLjUwMiAyOS40NDU4QzM3MS40MTEgMjkuNDc4MyAzNjkuOTI1IDI5LjU0MzggMzY5LjI2NCAyOS41NDM4QzM2OC44MDIgMjkuNTQzOCAzNjcuMzQ4IDI5LjUxMTMgMzY2LjU4NyAyOS40NDU4QzM2Ni42NTQgMzAuMjY2NCAzNjYuNjg2IDMxLjYxMjMgMzY2LjY4NiAzMi41NjQyVjM2Ljg2NTFDMzY2LjY4NiAzNy40ODg1IDM2Ni42MiAzOC43MzU3IDM2Ni41ODcgNDAuMDE2MkMzNjcuNTEzIDM5Ljk1MDMgMzY4LjgwMiAzOS45NTAzIDM2OS4yNjQgMzkuOTUwM0MzNzAuMDI0IDM5Ljk1IDM3MS42NDMgMzkuOTUgMzcyLjYwMSA0MC4wMTU4Wk0zNjQuNjA1IDM5LjEyOTRDMzY0LjQ0IDM4LjgwMDggMzY0LjM0MSAzOC4zMDg4IDM2NC4yNzUgMzguMDQ2MUMzNjIuOTIgMzkuMTYxOSAzNjEuOTk1IDM5LjM5MjQgMzYwLjkzOCAzOS4zOTI0QzM1OC41OTIgMzkuMzkyNCAzNTcuMzM3IDM3LjI5MTMgMzU3LjMzNyAzNC42NjQ5QzM1Ny4zMzcgMzEuNzQzNiAzNTguNzU3IDMwLjAzNjIgMzYxLjE2OSAzMC4wMzYyQzM2Mi40MjUgMzAuMDM2MiAzNjMuNjE0IDMwLjU5NDUgMzY0LjE3NiAzMS4xNTI4QzM2NC4yMDggMzAuODg5OCAzNjQuMzA4IDMwLjM2NDggMzY0LjQ3MyAzMC4wNjg4QzM2My4zMTYgMjkuNTExMyAzNjIuMjU5IDI5LjM0NjYgMzYxLjEwMiAyOS4zNDY2QzM1Ny4yMzcgMjkuMzQ2NiAzNTUuNDUzIDMxLjc0MzYgMzU1LjQ1MyAzNC44Mjg4QzM1NS40NTMgMzguMzA5MSAzNTcuNzk4IDQwLjE0NzEgMzYwLjczOSA0MC4xNDcxQzM2Mi40MjUgNDAuMTQ3MSAzNjMuODEyIDM5LjYyMjIgMzY0LjYwNSAzOS4xMjk0VjM5LjEyOTRaTTM0Mi4zMDMgMjYuODE5QzM0MC41MTkgMjMuNDA0OSAzMzguOCAxOS4xMzczIDMzNy41NzggMTYuMTE2OUgzMzcuMzhDMzM2LjU4NyAxOC4wMjA3IDMzNS4xMzMgMjEuMjcwOSAzMzQuNzM3IDIyLjE4OTlDMzM0LjI3NCAyMy4zMDYxIDMzMy4yNSAyNS41MDU2IDMzMi41ODkgMjYuODE4NkMzMzIuODAzIDI2Ljc1MzggMzMzLjAyNiAyNi43MjA2IDMzMy4yNSAyNi43MjAyQzMzMy40NDggMjYuNzIwMiAzMzMuNjEzIDI2Ljc1MzEgMzMzLjg0NSAyNi44MTg2QzMzNC4xNzUgMjUuOTMyMiAzMzQuNjM4IDI0LjgxNiAzMzUuMTMzIDIzLjYzNDNDMzM1Ljc5NCAyMy42MDE0IDMzNi4zODkgMjMuNTY4OCAzMzYuOTg0IDIzLjU2ODhDMzM3LjYxMiAyMy41Njg4IDMzOC4yNzIgMjMuNjAxNCAzMzguOTMzIDIzLjYzNDNMMzM5LjU5NCAyNS4yMUwzNDAuMjU1IDI2LjgxODZDMzQwLjcxNyAyNi43MjAyIDM0MS4wOCAyNi43MjAyIDM0MS4zMTIgMjYuNzIwMkMzNDEuNjA5IDI2LjcyMDYgMzQxLjg3MyAyNi43MjA2IDM0Mi4zMDMgMjYuODE5VjI2LjgxOVpNMzUzLjYzNiAyOS40NDU0QzM1My40MzggMjkuNTExMyAzNTMuMjczIDI5LjU0MzUgMzUzLjEwNyAyOS41NDM1QzM1Mi45MDkgMjkuNTQzNSAzNTIuNzQ0IDI5LjUxMDkgMzUyLjU0NiAyOS40NDU0QzM1Mi42NDQgMzAuNzU4NCAzNTIuNjc4IDMyLjA3MTQgMzUyLjY3OCAzMy4zNTE5VjM2LjczMzRDMzUyLjE0OSAzNi4yNzM2IDM1MC44NiAzNS4wOTE5IDM0OS4zNzQgMzMuNzEzQzM0Ny44NiAzMi4zMDc0IDM0Ni4zOTQgMzAuODUxMSAzNDQuOTc5IDI5LjM0NjZIMzQ0Ljc0OEMzNDQuNzgxIDMwLjgyNDMgMzQ0LjgxNCAzMi40IDM0NC44MTQgMzMuODExNFYzNS44Nzk5QzM0NC44MTQgMzcuNjUyOCAzNDQuODE0IDM4LjYwNDcgMzQ0LjcxNSA0MC4wMTYyQzM0NC45OCAzOS45NTAzIDM0NS4xMTIgMzkuOTUwMyAzNDUuMzEgMzkuOTUwM0MzNDUuNDQyIDM5Ljk1MDMgMzQ1LjU3NSAzOS45NTAzIDM0NS44MDYgNDAuMDE2MkMzNDUuNzQgMzguNjcwNiAzNDUuNzA3IDM2LjQ3MDggMzQ1LjcwNyAzNS44Nzk5VjMyLjU5NjhDMzQ4LjE4NSAzNC44NjI1IDM1MS4yMjQgMzcuODgyNiAzNTMuNDcxIDQwLjE0NzVIMzUzLjYwM0MzNTMuNjAzIDM4LjkzMjkgMzUzLjUzNyAzNy43MTc5IDM1My41MzcgMzYuNTA0VjM0LjYzMjdDMzUzLjUzNiAzMi40MzI1IDM1My41MzYgMzEuMzQ5MyAzNTMuNjM2IDI5LjQ0NTRaTTM0Mi41NjcgNDAuMDE1OEMzNDIuNTM0IDM5Ljg1MTkgMzQyLjUwMSAzOS43MjA2IDM0Mi41MDEgMzkuNTIzNEMzNDIuNTAxIDM5LjM5MjggMzQyLjUzNCAzOS4yMjgxIDM0Mi41NjcgMzkuMDk2NEMzNDEuMjQ2IDM5LjEyOTcgMzM4Ljg2NyAzOS4xOTUyIDMzOC4zNzEgMzkuMTk1MlYzNC42NjQ5QzMzOS42NiAzNC42NjQ5IDM0MC45NDggMzQuNjY0OSAzNDIuMjM3IDM0Ljc5NjNDMzQyLjIwNCAzNC42MzI0IDM0Mi4xNzEgMzQuNDY3NyAzNDIuMTcxIDM0LjMzNjRDMzQyLjE3MSAzNC4yMDU4IDM0Mi4xNzEgMzQuMDQxOSAzNDIuMjM3IDMzLjg0NDdDMzQxLjMxMiAzMy45NDI4IDMzOS4xOTcgMzMuOTc2IDMzOC4zNzEgMzMuOTc2VjMwLjI2NkMzMzkuNzkyIDMwLjI2NiAzNDAuNjUxIDMwLjI2NiAzNDEuMTc5IDMwLjI5OTNMMzQyLjQ2OCAzMC4zNjUxQzM0Mi40MzUgMzAuMTY3OSAzNDIuNDM1IDMwLjA2OTIgMzQyLjQzNSAyOS45MDUzQzM0Mi40MzUgMjkuNzQxNCAzNDIuNDM1IDI5LjY3NTUgMzQyLjQ2OCAyOS40NDU4QzM0MS4zNzggMjkuNDc4MyAzMzkuODkxIDI5LjU0MzggMzM5LjIzIDI5LjU0MzhDMzM4Ljc2NyAyOS41NDM4IDMzNy4zMTQgMjkuNTExMyAzMzYuNTU0IDI5LjQ0NThDMzM2LjYyIDMwLjI2NjQgMzM2LjY1MyAzMS42MTIzIDMzNi42NTMgMzIuNTY0MlYzNi44NjUxQzMzNi42NTMgMzcuNDg4NSAzMzYuNTg3IDM4LjczNTcgMzM2LjU1NCA0MC4wMTYyQzMzNy41MTIgMzkuOTUwMyAzMzguNzY3IDM5Ljk1MDMgMzM5LjIzIDM5Ljk1MDNDMzM5Ljk5IDM5Ljk1IDM0MS42NDIgMzkuOTUgMzQyLjU2NyA0MC4wMTU4VjQwLjAxNThaTTMzMS4yMDEgMjYuODE5QzMzMC42NzMgMjMuMjQwNiAzMzAuMjEgMTkuNDk4NCAzMjkuODQ3IDE2LjExNjlDMzI5Ljc0OCAxNi4xNDk4IDMyOS43MTQgMTYuMTQ5OCAzMjkuNjQ5IDE2LjExNjlDMzI4Ljk1NSAxNy4zMzE1IDMyOC4xNjIgMTguNjQ0NSAzMjcuNTY3IDE5LjU2MzlDMzI3LjAwNiAyMC40NTAzIDMyNi4zNDUgMjEuNTAwNyAzMjUuNTg1IDIyLjYxNjlDMzIzLjk5OSAyMC41ODE3IDMyMi4zNDcgMTguMDIxMSAzMjEuMjU2IDE2LjExNjlDMzIxLjE5IDE2LjE0OTggMzIxLjE1NyAxNi4xMTY5IDMyMS4wOTEgMTYuMTE2OUMzMjAuNzI4IDE5LjQ5OCAzMjAuMjMyIDIzLjI3MzIgMzE5LjczNiAyNi44MTlDMzIwLjAwMSAyNi43MjA2IDMyMC4xNjYgMjYuNzIwNiAzMjAuMjk4IDI2LjcyMDZDMzIwLjQ5NiAyNi43MjA2IDMyMC42MjggMjYuNzUzNSAzMjAuODU5IDI2LjgxOUMzMjAuOTkyIDI0LjQ1NTMgMzIxLjI1NiAyMi4xMjQ0IDMyMS41NTMgMTkuNjYyM0MzMjIuODQyIDIxLjUzMzYgMzIzLjk2NSAyMy4xNDIyIDMyNS4yMjEgMjQuODQ5M0MzMjYuMjc4IDIzLjIwNzcgMzI3LjM2OCAyMS40MzQ4IDMyOC41NTggMTkuNjI5NEMzMjguODg4IDIyLjE1NyAzMjkuMTg2IDI0LjQ1NTMgMzI5LjM1MSAyNi44MTlDMzI5Ljc4IDI2LjcyMDYgMzMwLjA3OCAyNi43MjA2IDMzMC4yNzYgMjYuNzIwNkMzMzAuNTQgMjYuNzIwNiAzMzAuODA1IDI2LjcyMDYgMzMxLjIwMSAyNi44MTlWMjYuODE5Wk0zMzQuOTY4IDMyLjIwMjhDMzM0Ljk2OCAzMC4yOTg5IDMzMy40NDggMjkuNDQ1NCAzMzEuNTk4IDI5LjQ0NTRDMzMwLjc3MiAyOS40NDU0IDMyOS44OCAyOS41NDM1IDMyOS4yNTIgMjkuNTQzNUMzMjkuMDIxIDI5LjU0MzUgMzI4LjUyNSAyOS41NDM1IDMyNy45OTcgMjkuNDc3NkMzMjguMDMgMzAuNTI4MyAzMjguMDk2IDMxLjQxNDggMzI4LjA5NiAzMi40MzIyVjM2LjkyOTVDMzI4LjA5NiAzNy45MTQ4IDMyOC4wMyAzOC45OTggMzI3Ljk5NyA0MC4wMTU0QzMyOC40MjYgMzkuOTQ5NiAzMjguNzI0IDM5Ljk0OTYgMzI4LjkyMiAzOS45NDk2QzMyOS4xNTMgMzkuOTQ5NiAzMjkuNDg0IDM5Ljk0OTYgMzI5Ljg4IDQwLjAxNTRDMzI5LjgxNSAzOS4wMzE5IDMyOS43ODIgMzguMDQ2NSAzMjkuNzgxIDM3LjA2MDlWMzUuNDJDMzMwLjE0NSAzNS40NTI2IDMzMC41MDggMzUuNDUyNiAzMzAuOTA1IDM1LjQ1MjZDMzMyLjgyIDM1LjQ1MjYgMzM0Ljk2OCAzNC43MzA0IDMzNC45NjggMzIuMjAyOFYzMi4yMDI4Wk0zMjYuMDE0IDM2Ljg5NzNDMzI2LjAxNCAzNS4yNTU4IDMyNC45MjQgMzQuNTMzNiAzMjMuMDQgMzMuNzQ1NkMzMjEuNjg2IDMzLjE4OCAzMjAuOTkyIDMyLjY5NTYgMzIwLjk5MiAzMS42NDQ1QzMyMC45OTIgMzAuNjYgMzIxLjc1MiAzMC4wMzYyIDMyMy4wMDggMzAuMDM2MkMzMjMuODM0IDMwLjAzNjIgMzI0LjU2MSAzMC4zMzE1IDMyNS4yMjIgMzAuODU2OEMzMjUuMjg3IDMwLjQ5NTcgMzI1LjQ1MyAzMC4xMzQ3IDMyNS42NTEgMjkuODM5NEMzMjQuODU4IDI5LjQ3ODMgMzIzLjk5OSAyOS4zNDcgMzIzLjA3NCAyOS4zNDdDMzIwLjM2NSAyOS4zNDcgMzE5LjUwNSAzMC44OTA1IDMxOS41MDUgMzIuMjAzNUMzMTkuNTA1IDMzLjgxMTggMzIwLjI5OSAzNC41NjcyIDMyMi4zNDcgMzUuMzU1M0MzMjMuNjM2IDM1Ljg0NyAzMjQuMjk2IDM2LjQ3MTEgMzI0LjI5NiAzNy41NTQ0QzMyNC4yOTYgMzguNzAzNSAzMjMuNDM3IDM5LjQyNTcgMzIyLjI0OCAzOS40MjU3QzMyMS41NTQgMzkuNDI1NyAzMjAuMzY1IDM5LjA2NDYgMzE5LjUzOSAzOC4zMDk5QzMxOS41MDUgMzguNzM2MSAzMTkuNTA1IDM5LjEzMDQgMzE5LjM3MyAzOS40OTE1QzMxOS45MDIgMzkuNzU0NiAzMjEuMTI1IDQwLjE0NzkgMzIyLjIxNSA0MC4xNDc5QzMyNC45OSA0MC4xNDcxIDMyNi4wMTQgMzguNDM5NyAzMjYuMDE0IDM2Ljg5NzNWMzYuODk3M1pNMzc4LjE1MiAxNy45ODgyQzM3OC4xNTIgMTguOTczIDM3Ny40NTggMTkuNjYyMyAzNzYuNzY0IDIwLjIyMDJDMzc2LjMwMSAxOS41NjM5IDM3NS43NCAxOC42NzcxIDM3NS43NCAxNy45ODgyQzM3NS43NCAxNy4yMzMxIDM3Ni4yNjggMTYuODA2MSAzNzYuOTk1IDE2LjgwNjFDMzc3Ljk4NyAxNi44MDY1IDM3OC4xNTIgMTcuNjkyNiAzNzguMTUyIDE3Ljk4ODJWMTcuOTg4MlpNMzc4LjQ4MiAyNS4wMTMyQzM3OC4xMTkgMjUuMzQxNyAzNzcuMjYgMjUuOTY1NSAzNzYuNTMzIDI1Ljk2NTVDMzc1LjU3NCAyNS45NjU1IDM3NC40MTggMjUuMjc1OSAzNzQuNDE4IDIzLjc5ODZDMzc0LjQxOCAyMi40ODU1IDM3NS4yNzcgMjEuODk0NyAzNzUuODA2IDIxLjU2NjVDMzc3LjAyOCAyMy4yNDA2IDM3Ny4wOTUgMjMuMzM5MSAzNzguNDgyIDI1LjAxMzJaTTM3OS44MDQgMzIuMjAyOEMzNzkuODA0IDMzLjI1MzUgMzc5LjI3NSAzNC40MDI2IDM3Ny43NTUgMzQuNDAyNkMzNzcuMzI2IDM0LjQwMjYgMzc2LjkyOSAzNC40MDI2IDM3Ni41MzMgMzQuMzY5M1YzMC4yNjU2QzM3Ni45MjkgMzAuMTY3NiAzNzcuNDI1IDMwLjEzNDMgMzc3LjcyMiAzMC4xMzQzQzM3OS4wMTEgMzAuMTM0MyAzNzkuODA0IDMwLjg4OTggMzc5LjgwNCAzMi4yMDI4Wk0zMzguNjAyIDIyLjgxNDFDMzM3LjkwOSAyMi44NDY2IDMzNy41NDUgMjIuODQ2NiAzMzcuMDgyIDIyLjg0NjZDMzM2LjUyMSAyMi44NDY2IDMzNi4xOSAyMi44NDY2IDMzNS40NjMgMjIuODE0MUwzMzcuMDgyIDE5LjAwNkwzMzguNjAyIDIyLjgxNDFaTTMzMy4xNTEgMzIuMzAwOEMzMzMuMTUxIDMzLjgxMTEgMzMyLjI1OCAzNC43OTU5IDMzMC44MDUgMzQuNzk1OUMzMzAuNTA3IDM0Ljc5NTkgMzMwLjE3NyAzNC43OTU5IDMyOS43OCAzNC43MzAxVjMwLjIzMjdDMzMwLjI0MyAzMC4xNjY5IDMzMC42MzkgMzAuMTMzOSAzMzEuMDM2IDMwLjEzMzlDMzMyLjQyNCAzMC4xMzQzIDMzMy4xNTEgMzEuMDIxMSAzMzMuMTUxIDMyLjMwMDhaTTM2OS41MjggMjMuNjY3NkMzNjkuNTI4IDIyLjAyNiAzNjguNDM4IDIxLjMwMzkgMzY2LjU1NSAyMC41MTYyQzM2NS4yIDE5Ljk1ODMgMzY0LjUwNiAxOS40OTg4IDM2NC41MDYgMTguNDE1MUMzNjQuNTA2IDE3LjQ2MzIgMzY1LjI2NiAxNi44MDY1IDM2Ni41MjEgMTYuODA2NUMzNjcuMzQ4IDE2LjgwNjUgMzY4LjA3NSAxNy4xMDE3IDM2OC43MzUgMTcuNjI3NUMzNjguODAyIDE3LjI2NjQgMzY4Ljk2NyAxNi45MDQ5IDM2OS4xMzEgMTYuNjQyMkMzNjguMzcyIDE2LjI4MTEgMzY3LjQ3OSAxNi4xMTcyIDM2Ni41ODcgMTYuMTE3MkMzNjMuOTQ0IDE2LjExNzIgMzYyLjk4NiAxNy42NiAzNjIuOTg2IDE5LjAwNkMzNjIuOTg2IDIwLjU4MTcgMzYzLjgxMiAyMS4zMzY4IDM2NS44NjEgMjIuMTI0NEMzNjcuMTQ5IDIyLjYxNjkgMzY3LjgxIDIzLjI0MDYgMzY3LjgxIDI0LjM1NjhDMzY3LjgxIDI1LjQ3MyAzNjYuOTUxIDI2LjE5NTIgMzY1Ljc2MiAyNi4xOTUyQzM2NS4wMzUgMjYuMTk1MiAzNjMuODc5IDI1LjgzNDEgMzYzLjA1MiAyNS4xMTE5QzM2My4wMiAyNS41Mzg5IDM2Mi45ODYgMjUuOSAzNjIuODg3IDI2LjI2MTFDMzYzLjM4MyAyNi41MjM4IDM2NC42MDYgMjYuOTE3NCAzNjUuNzI5IDI2LjkxNzRDMzY4LjUwNCAyNi45MTc0IDM2OS41MjggMjUuMjQzMyAzNjkuNTI4IDIzLjY2NzZWMjMuNjY3NloiIGZpbGw9IiMwMzY1NTUiLz4NCjxwYXRoIGQ9Ik02NDAuNDE2IDIwLjU1NzNDNjM4LjY3MSAxOS44MzU0IDYzNy42MzEgMTkuNTU1MSA2MzYuNTk4IDE5LjU1NTFDNjM1LjUxNCAxOS41NTUxIDYzNC44MTkgMTkuOTE3IDYzNC44MTkgMjAuNDc2NUM2MzQuODE5IDIyLjE2NDUgNjQwLjk2MiAyMS42ODkzIDY0MC45NjIgMjUuNTkzNkM2NDAuOTYyIDI3Ljc0NjQgNjM5LjAyNCAyOC45OTc0IDYzNi4zMzIgMjguOTk3NEM2MzQuMjIgMjguOTk3NCA2MzMuMTggMjguNDg4IDYzMS45ODMgMjcuOTExNlYyNS40OTYyQzYzMy43MSAyNi41NjM1IDYzNC43NjggMjYuOTQwMSA2MzYuMTAxIDI2Ljk0MDFDNjM3LjI1NiAyNi45NDAxIDYzNy44NzkgMjYuNTYzNSA2MzcuODc5IDI1LjkwNjNDNjM3Ljg3OSAyNC4wNjg1IDYzMS43MzcgMjQuNzQxNSA2MzEuNzM3IDIwLjcyMTNDNjMxLjczNyAxOC43ODI3IDYzMy41MzQgMTcuNDk5IDYzNi4zMzIgMTcuNDk5QzYzNy42ODIgMTcuNDk5IDYzOC45MDEgMTcuNzYzNSA2NDAuNDE2IDE4LjM3MDdWMjAuNTU3M1pNNjQ5LjAxNiAyOC40ODQxQzY0Ny45OTIgMjguODMwNiA2NDcuMTI2IDI4Ljk5NTQgNjQ2LjI2MiAyOC45OTU0QzY0My40MDIgMjguOTk1NCA2NDEuNTUyIDI3LjQ0MjIgNjQxLjU1MiAyNS4wNzkyQzY0MS41NTIgMjIuNzU5NCA2NDMuNDczIDIxLjEyMDIgNjQ2LjE1NiAyMS4xMjAyQzY0Ni45ODUgMjEuMTIwMiA2NDguMDQ0IDIxLjMxODIgNjQ4Ljg5MSAyMS42MTIzVjIzLjM4ODFDNjQ4LjIyMSAyMy4wNTYyIDY0Ny40NDQgMjIuODc0MSA2NDYuODA5IDIyLjg3NDFDNjQ1LjI3MyAyMi44NzQxIDY0NC4yODYgMjMuNzM0MyA2NDQuMjg2IDI1LjA2MTlDNjQ0LjI4NiAyNi40MDggNjQ1LjI1NiAyNy4yOTQgNjQ2LjcyIDI3LjI5NEM2NDcuMzM3IDI3LjI5NCA2NDcuODg2IDI3LjE2MjMgNjQ5LjAxNiAyNi43NjhMNjQ5LjAxNiAyOC40ODQxWk02NzEuMzIgMjQuMjA5QzY3MS40MjUgMjMuMTU0OCA2NzIuMDgxIDIyLjU0NTcgNjczLjA4NyAyMi41NDU3QzY3NC4wNzYgMjIuNTQ1NyA2NzQuNzQ2IDIzLjE3MjEgNjc0Ljg1MiAyNC4yMDlINjcxLjMyWk02NzIuOTEgMjEuMTIyOUM2NzAuNCAyMS4xMjI5IDY2OC42MTQgMjIuNzc1NSA2NjguNjE0IDI1LjEwMTJDNjY4LjYxNCAyNy40NDQxIDY3MC40NzEgMjguOTk1NCA2NzMuMzM1IDI4Ljk5NTRDNjczLjk3IDI4Ljk5NTQgNjc1LjUwNCAyOC45OTU0IDY3Ni45NjYgMjcuOTg3VjI2LjUwNDJDNjc1Ljc2OSAyNy4yOTkzIDY3NC45NzcgMjcuNTczMSA2NzMuOTU1IDI3LjU3MzFDNjcyLjM0MSAyNy41NzMxIDY3MS4zNTQgMjYuNzk0OSA2NzEuMjY1IDI1LjQ2NjZINjc3LjExQzY3Ny4yMzIgMjIuNjkzOSA2NzUuMjc5IDIxLjEyMjkgNjcyLjkxIDIxLjEyMjlWMjEuMTIyOVpNNjc4LjA5OSAyOC44NTcySDY4MC42NTRWMjEuMjYyN0g2NzguMDk5VjI4Ljg1NzJaTTY4Ny43NjcgMjYuNzgxNUM2ODcuMjM0IDI3LjIyODEgNjg2Ljc5MiAyNy40MDcyIDY4Ni4yNDYgMjcuNDA3MkM2ODUuMDQzIDI3LjQwNzIgNjg0LjI4MSAyNi40ODM4IDY4NC4yODEgMjUuMTAwNEM2ODQuMjgxIDIzLjU4NDEgNjg1LjA0MyAyMi43MTAxIDY4Ni4zMzEgMjIuNzEwMUM2ODYuNzkyIDIyLjcxMDEgNjg3LjM5NCAyMi45MDggNjg3Ljc2NyAyMy4xNTU5VjI2Ljc4MTVaTTY4Ny43NjcgMTcuNjM5MVYyMS41OTU4QzY4Ny4wNzYgMjEuMjg0NyA2ODYuMzg4IDIxLjEyMDIgNjg1LjY0NCAyMS4xMjAyQzY4My4zMTMgMjEuMTIwMiA2ODEuNyAyMi43MjY2IDY4MS43IDI1LjA1MDdDNjgxLjcgMjcuMzI0OCA2ODMuMzEzIDI4Ljk5NzQgNjg1LjUgMjguOTk3NEM2ODYuMzY3IDI4Ljk5NzQgNjg3LjAzNyAyOC43ODU2IDY4Ny43NjcgMjguMjQzNVYyOC44NTQ5SDY5MC4zMjJWMTcuNjM5MUg2ODcuNzY3Wk02OTQuMTA1IDI0LjIwOUM2OTQuMjExIDIzLjE1NDggNjk0Ljg2NCAyMi41NDU3IDY5NS44NjggMjIuNTQ1N0M2OTYuODU4IDIyLjU0NTcgNjk3LjUzNSAyMy4xNzIxIDY5Ny42NDEgMjQuMjA5SDY5NC4xMDVaTTY5NS42OTQgMjEuMTIyOUM2OTMuMTg0IDIxLjEyMjkgNjkxLjQgMjIuNzc1NSA2OTEuNCAyNS4xMDEyQzY5MS40IDI3LjQ0NDEgNjkzLjI1OSAyOC45OTU0IDY5Ni4xMTkgMjguOTk1NEM2OTYuNzUzIDI4Ljk5NTQgNjk4LjI5IDI4Ljk5NTQgNjk5Ljc1NSAyNy45ODdWMjYuNTA0MkM2OTguNTU3IDI3LjI5OTMgNjk3Ljc2MyAyNy41NzMxIDY5Ni43MzYgMjcuNTczMUM2OTUuMTMxIDI3LjU3MzEgNjk0LjE0IDI2Ljc5NDkgNjk0LjA1MSAyNS40NjY2SDY5OS44OTRDNzAwLjAxNSAyMi42OTM5IDY5OC4wNjEgMjEuMTIyOSA2OTUuNjk0IDIxLjEyMjkiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik03MDMuNzIxIDIzLjQzNjhINzAzLjc1OEM3MDQuNTE3IDIxLjg1NjIgNzA1LjM2NiAyMS4xMTUgNzA2LjM1MiAyMS4xMTVDNzA2Ljg2MiAyMS4xMTUgNzA3LjMwMyAyMS4yOTY0IDcwOC4wNDQgMjEuODA3Nkw3MDcuMzQxIDIzLjkxMzNDNzA2LjY3IDIzLjUxODYgNzA2LjIyOSAyMy4zNTM1IDcwNS44MjMgMjMuMzUzNUM3MDQuODg2IDIzLjM1MzUgNzA0LjI4NiAyNC4xNzc1IDcwMy43MjEgMjUuNTcwNFYyOC44NDY2SDcwMS4xNjJWMjEuMjU0MUg3MDMuNzIxVjIzLjQzNjhaTTY4MC43NzUgMTguMDY3NEM2ODEuMDE1IDE4LjY1NzUgNjgwLjU4MyAxOS40ODA1IDY3OS44MTQgMTkuOTA0QzY3OS4wNDEgMjAuMzI3MSA2NzguMjI0IDIwLjE5MjggNjc3Ljk4NiAxOS42MDI3QzY3Ny43NDMgMTkuMDExNyA2NzguMTczIDE4LjE4NzcgNjc4Ljk0NSAxNy43NjY2QzY3OS43MTYgMTcuMzQxMSA2ODAuNTMzIDE3LjQ3NTkgNjgwLjc3NSAxOC4wNjc0WiIgZmlsbD0iIzAwOUU0RCIvPg0KPHBhdGggZD0iTTY1OC4yMiAyNC4wMjMxQzY1OC4yMiAyMS45NjUxIDY1Ni43MTkgMjEuMTIyNiA2NTUuMjM5IDIxLjEyMjZDNjU0LjIzMiAyMS4xMjI2IDY1My40MDQgMjEuNTE4NCA2NTIuNjY0IDIyLjM5MjFINjUyLjYyOVYxNy42MzkySDY1MC4wNzFWMjguODM1M0g2NTIuNjI5VjI0LjAyMzFDNjUzLjIyOCAyMy4yMTYxIDY1My43MzggMjIuODcxMSA2NTQuMzM4IDIyLjg3MTFDNjU1LjEzNCAyMi44NzExIDY1NS42NjIgMjMuMzk4NiA2NTUuNjYyIDI0LjUzMjlWMjcuMjAwOEM2NTYuNTIgMjYuNzg5NiA2NTcuMzkzIDI2LjUzNzQgNjU4LjIyIDI2LjQ0MzhWMjQuMDIzMVpNNjY0LjYzNiAyMS4xMTk5QzY2My41OTQgMjEuMTE5OSA2NjIuNzk5IDIxLjQ4MTEgNjYxLjk4NCAyMi4zNDkzVjIxLjI2MjRINjU5LjQyOFYyNi40MjM0QzY2MC4zMTMgMjYuNTA1OCA2NjEuNDQzIDI2Ljg4NDcgNjYxLjk4NCAyNy41MTA0VjIzLjk2MzRDNjYyLjY1NyAyMy4wMjMyIDY2My4xMzQgMjIuNzA5NyA2NjMuNzcgMjIuNzA5N0M2NjQuNDk0IDIyLjcwOTcgNjY1LjA0NSAyMy4xNTU2IDY2NS4wNDUgMjQuMjI2NFYyOC44MzcySDY2Ny42MDJWMjQuMDI4OUM2NjcuNjAyIDIxLjc5MjYgNjY1LjkwOCAyMS4xMTk5IDY2NC42MzYgMjEuMTE5OVYyMS4xMTk5Wk02NjkuMDE1IDMxLjAxODFINjY2LjA0M1YzMi45ODY0SDY2OC45MDlWMzMuODMxMkg2NjYuMDQzVjM1Ljg2MTlINjY5LjEwM1YzNi43MDU1SDY2NS4wNDZWMzAuMTc1Mkg2NjkuMDE1TDY2OS4wMTUgMzEuMDE4MVpNNjcxLjQ0MiAzNi43MDkzSDY3Mi4zNTJWMzAuMTczM0g2NzEuNDQyVjM2LjcwOTNaTTY3Ni44NTkgMzMuMDQ4NEM2NzcuNTA0IDMzLjA0ODQgNjc3LjkwNCAzMy40NjMxIDY3Ny45MzUgMzQuMTE0Mkg2NzUuNjE2QzY3NS43NDIgMzMuNDM0MiA2NzYuMTYxIDMzLjA0ODQgNjc2Ljg1OSAzMy4wNDg0Wk02NzUuNiAzNC42ODFINjc4Ljg0MkM2NzguODQyIDMzLjA4NjkgNjc4LjA2MiAzMi4zMTggNjc2LjgzOCAzMi4zMThDNjc1LjU2OSAzMi4zMTggNjc0LjY4OCAzMy4xOTI0IDY3NC42ODggMzQuNDk2OUM2NzQuNjg4IDM1LjY4OSA2NzUuNDg0IDM2Ljc4OTggNjc2LjkxNyAzNi43ODk4QzY3Ny42OTggMzYuNzg5OCA2NzguMjAzIDM2LjYyODEgNjc4Ljc2MyAzNi4yODJWMzUuNDU2QzY3OC4yMjIgMzUuNzg1NiA2NzcuNjk4IDM1Ljk3NTggNjc3LjE0NyAzNS45NzU4QzY3Ni4yNjUgMzUuOTc1OCA2NzUuNzQyIDM1LjUzNSA2NzUuNiAzNC42ODA2VjM0LjY4MVpNNjg0Ljc4NiAzMy41MzA5QzY4NC4yNjMgMzMuMTk2NiA2ODMuOTE0IDMzLjA5ODUgNjgzLjUxNSAzMy4wOTg1QzY4Mi42ODIgMzMuMDk4NSA2ODIuMTA1IDMzLjY5NDUgNjgyLjEwNSAzNC41NjdDNjgyLjEwNSAzNS40NTYgNjgyLjcxOSAzNS45OTE2IDY4My42NjggMzUuOTkxNkM2ODQuMDU4IDM1Ljk5MTYgNjg0LjQzIDM1Ljg5NzMgNjg0Ljg4OCAzNS43MDU5VjM2LjU0MjZDNjg0LjU4MiAzNi42Nzc0IDY4My45OTcgMzYuNzg5OCA2ODMuNTE1IDM2Ljc4OThDNjgyLjEzNiAzNi43ODk4IDY4MS4xOCAzNS45MDYyIDY4MS4xOCAzNC42NDMyQzY4MS4xOCAzMy4yMTc4IDY4Mi4wNTQgMzIuMzE4IDY4My40NTMgMzIuMzE4QzY4My45ODcgMzIuMzE4IDY4NC4zNDYgMzIuNDMzOSA2ODQuNzg3IDMyLjYxNDVMNjg0Ljc4NiAzMy41MzA5Wk02ODguOTM0IDMyLjQwMDRINjkwLjM5NVYzMy4xNjUxSDY4OC45MzRWMzUuMzc1MkM2ODguOTM0IDM1Ljg4MTEgNjg5LjMyNyAzNi4wMjc0IDY4OS41OTMgMzYuMDI3NEM2ODkuOTIyIDM2LjAyNzQgNjkwLjI2MiAzNS45MiA2OTAuNjMgMzUuNzA3OVYzNi41MDM3QzY5MC4zMSAzNi42Njc4IDY4OS44MiAzNi43ODk4IDY4OS41MTkgMzYuNzg5OEM2ODguNTI4IDM2Ljc4OTggNjg4LjAyNyAzNi4yMTYxIDY4OC4wMjcgMzUuNDM5MVYzMy4xNjUxSDY4Ny4yMjRWMzMuMDcwM0w2ODguOTM0IDMxLjUxMDJWMzIuNDAwNFpNNjkzLjg3NiAzMi40MDA0VjMzLjM5NjlINjkzLjg5NUM2OTQuMzU5IDMyLjYzNDUgNjk0LjggMzIuMzE4IDY5NS4yMyAzMi4zMThDNjk1LjYwMSAzMi4zMTggNjk1Ljk0NyAzMi40ODAxIDY5Ni4zMjkgMzIuODE2Nkw2OTUuODQ3IDMzLjU2NDRDNjk1LjU3IDMzLjMwOTEgNjk1LjIxMSAzMy4xMzMxIDY5NC45OTUgMzMuMTMzMUM2OTQuMzY4IDMzLjEzMzEgNjkzLjg3NiAzMy43MjY4IDY5My44NzYgMzQuNDYyNlYzNi43MDkzSDY5Mi45NjdWMzIuNDAwNEg2OTMuODc2Wk03MDUuNjU3IDMzLjUzMDlDNzA1LjEzMSAzMy4xOTY2IDcwNC43ODIgMzMuMDk4NSA3MDQuMzgxIDMzLjA5ODVDNzAzLjU0OSAzMy4wOTg1IDcwMi45NzcgMzMuNjk0NSA3MDIuOTc3IDM0LjU2N0M3MDIuOTc3IDM1LjQ1NiA3MDMuNTkyIDM1Ljk5MTYgNzA0LjUzNSAzNS45OTE2QzcwNC45MjUgMzUuOTkxNiA3MDUuMjk1IDM1Ljg5NzMgNzA1Ljc2IDM1LjcwNTlWMzYuNTQyNkM3MDUuNDQ3IDM2LjY3NzQgNzA0Ljg2MiAzNi43ODk4IDcwNC4zOCAzNi43ODk4QzcwMy4wMDQgMzYuNzg5OCA3MDIuMDQ0IDM1LjkwNjIgNzAyLjA0NCAzNC42NDMyQzcwMi4wNDQgMzMuMjE3OCA3MDIuOTIyIDMyLjMxOCA3MDQuMzIgMzIuMzE4QzcwNC44NTUgMzIuMzE4IDcwNS4yMTIgMzIuNDMzOSA3MDUuNjU3IDMyLjYxNDVMNzA1LjY1NyAzMy41MzA5Wk02OTguNzQyIDM2LjcwOTNINjk5LjY1MlYzMi40MDA4SDY5OC43NDJWMzYuNzA5M1oiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik02OTkuNjg0IDMwLjg1MjVDNjk5Ljc3MyAzMS4wNjA0IDY5OS42MTggMzEuMzU0NCA2OTkuMzQ0IDMxLjUwNDFDNjk5LjA2OCAzMS42NTQzIDY5OC43NzYgMzEuNjA2MiA2OTguNjkzIDMxLjM5NzhDNjk4LjYxIDMxLjE4NzQgNjk4Ljc2MSAzMC44OTU4IDY5OS4wMzggMzAuNzQ1NkM2OTkuMzExIDMwLjU5MzUgNjk5LjYwMSAzMC42NDIxIDY5OS42ODQgMzAuODUyNVYzMC44NTI1Wk02NTguOTQgMzEuMjAwOUM2NTguNzc5IDMxLjIwMDkgNjU4LjcxMSAzMS4yMjU1IDY1OC42NDYgMzEuMjkzOEM2NTguNjIgMzEuMzIwMyA2NTguNjEgMzEuMzQ3MiA2NTguNiAzMS40MDExTDY1Ny43ODQgMzQuMjg3QzY1Ny41OTMgMzUuMjk5MiA2NTYuMjU5IDM2LjMwOTkgNjU0LjUyMSAzNi4zMDk5SDY1Mi4xMDRMNjUyLjUyMyAzNC44MjdINjU0LjA3NkM2NTQuMjM0IDM0LjgyNyA2NTQuMzU4IDM0Ljc3MjEgNjU0LjQ2MiAzNC42NjQzQzY1NC41IDM0LjYyMjUgNjU0LjU1IDM0LjU1NyA2NTQuNTU2IDM0LjQ4OTZMNjU1LjIwMSAzMS45NjgxQzY1NS4zOTEgMzAuOTU1NSA2NTYuNTM4IDI5LjgzNjkgNjU4LjI3NiAyOS44MzY5SDY2MC43NTFMNjYwLjQzNSAzMS4yMDA5SDY1OC45NFpNNjU5LjQ5NyAzMi45NTk2TDY1OS43NzMgMzIuMDI1OUg2NjIuMjg4QzY2Mi41OTggMzAuNjcyIDY2Mi4zNTQgMjkuNDE3NyA2NjEuNDczIDI4LjU5NjFDNjU5LjY4OSAyNi45MzMyIDY1NS45NTcgMjcuNDk4MyA2NTMuMTc3IDI5Ljk3NzlDNjUyLjc0MyAzMC4zNjMgNjUyLjM3NiAzMC43NzkzIDY1Mi4wNDIgMzEuMjA0OEg2NTMuNTU2TDY1My4yMDQgMzIuMTQwNEg2NTEuMzk1QzY1MS4yMjIgMzIuNDM1NCA2NTEuMDYgMzIuNzI4MSA2NTAuOTM2IDMzLjAyNUg2NTMuMDgxTDY1Mi43MzcgMzMuOTYwN0g2NTAuNjNDNjUwLjI2OSAzNS4zOTAxIDY1MC40OTkgMzYuNzIzMyA2NTEuNDA2IDM3LjU2OTlDNjUzLjE2NyAzOS4yMTE2IDY1Ni44ODggMzguNjM0NiA2NTkuNjY3IDM2LjE1NTRDNjYwLjE1MyAzNS43MjQyIDY2MC41NTUgMzUuMjU4NyA2NjAuOTE4IDM0Ljc4MDhINjU4Ljk3M0w2NTkuMjY5IDMzLjg0NzFINjYxLjU0M0M2NjEuNzEgMzMuNTUwMSA2NjEuODYzIDMzLjI1NjUgNjYxLjk4MyAzMi45NTk2SDY1OS40OTdaIiBmaWxsPSIjMDA5RTREIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfNThfMTExKSI+DQo8cGF0aCBkPSJNNzc1LjA2OCA0MS4yMjc0Qzc2Ni4yODUgNDIuMDQ2MyA3NTcuMTMxIDQwLjc1NjQgNzU1Ljg0OCAzMy44MTlDNzU1LjIyMSAzMC4zOTkgNzU2Ljc2NSAyNi43NzI1IDc1OC44MSAyNC41MTg0VjIzLjMxNDhDNzU1LjEyNiAyNi41OCA3NTMuMTMgMzAuNzExNSA3NTQuMjggMzUuNTkyQzc1NS43NDggNDEuODUxOCA3NjMuNjAzIDQ1LjM5NjcgNzc1LjU5NSA0NC4yMTk1Qzc4MC4zNDIgNDMuNzU0NSA3ODYuNTUgNDIuMjEyIDc5MC44NjkgMzkuODE0NFYzNi40MTA5Qzc4Ni45NDkgMzguNzcxMyA3ODAuNDY4IDQwLjcyMTEgNzc1LjA2OCA0MS4yMjc0VjQxLjIyNzRaTTc5OC4yMDUgMjMuMjMzNUM3OTYuMTIyIDEyLjk1MzMgNzc2LjM3MyAxMi4zMDE2IDc2My42NDMgMjAuMTMzOFYyMC45OTg5Qzc3Ni4zNTkgMTQuMzkxNSA3OTQuMzk1IDE0LjQzMTcgNzk2LjAzNyAyMy45MDE2Qzc5Ni41ODkgMjcuMDM0MiA3OTQuODQzIDMwLjI5NzggNzkxLjcyMyAzMi4xNzdWMzQuNjM0MkM3OTUuNDc2IDMzLjI0MzIgNzk5LjMyNCAyOC43NDQyIDc5OC4yMDUgMjMuMjMzNVYyMy4yMzM1WiIgZmlsbD0iIzBFN0RDMiIvPg0KPHBhdGggZD0iTTc5MC4xNTkgMjEuNzM2OEg3ODcuODU2VjMyLjEwM0M3ODcuODU2IDMzLjMxNzkgNzg4LjQzNyAzNC4zNzQ0IDc5MC4xNTkgMzQuNTQzMlYyMS43MzY4Wk03NjIuNzM5IDI1LjUyMTdINzYwLjQzMkw3NjAuNDMxIDMyLjI5NDNDNzYwLjQzMSAzMy41MTM0IDc2MS4wMTMgMzQuNTY4OCA3NjIuNzM5IDM0LjczNDRWMjUuNTIxN1YyNS41MjE3Wk03NjAuNDMyIDIyLjA1MjFINzYyLjczMlYyNC4yNTg0SDc2MC40MzJWMjIuMDUyMVpNNzc2LjUzIDM0LjYyNzJDNzc0LjY2NiAzNC42MjcyIDc3My44NzcgMzMuMzE3NyA3NzMuODc3IDMyLjAyOFYyMy4wMzU1SDc3Ni4xNlYyNS41MjE3SDc3Ny44NzlWMjcuMzg1M0g3NzYuMTZWMzEuODg1NEM3NzYuMTYgMzIuNDExMyA3NzYuNDA3IDMyLjcwNDQgNzc2Ljk1IDMyLjcwNDRINzc3Ljg3OVYzNC42MjcyTDc3Ni41MyAzNC42MjcyVjM0LjYyNzJaTTc4MC43MzEgMzAuNzk2MUM3ODAuNzMxIDMxLjk3NjggNzgxLjQ2MSAzMi44NDQ2IDc4Mi43NTQgMzIuODQ0NkM3ODMuNzY2IDMyLjg0NDYgNzg0LjI2NiAzMi41NjA1IDc4NC44NSAzMS45NzY4TDc4Ni4yNjEgMzMuMzM0OUM3ODUuMzU3IDM0LjIzNzkgNzg0LjQwOSAzNC43ODcgNzgyLjczNyAzNC43ODdDNzgwLjU1MiAzNC43ODcgNzc4LjQ1OSAzMy41ODE5IDc3OC40NTkgMzAuMDY4NkM3NzguNDU5IDI3LjA2NTEgNzgwLjI4OCAyNS4zNjczIDc4Mi42ODYgMjUuMzY3M0M3ODUuMTI0IDI1LjM2NzMgNzg2LjUyNSAyNy4zNTQ5IDc4Ni41MjUgMjkuOTYzOVYzMC43OTYzSDc4MC43MzFWMzAuNzk2MVpNNzgyLjU4NiAyNy4yNzU2Qzc4MS44MDUgMjcuMjc1NiA3ODEuMjA0IDI3LjY4MjMgNzgwLjk1IDI4LjIzMDlDNzgwLjgwMiAyOC41NjA3IDc4MC43NDcgMjguODE3NyA3ODAuNzMxIDI5LjIyMjlINzg0LjI0OUM3ODQuMjA0IDI4LjIzMDkgNzgzLjc1OSAyNy4yNzU2IDc4Mi41ODYgMjcuMjc1NlpNNzY4LjkzOSAyNy4zODUzQzc2OS42MDggMjcuMzg1MyA3NjkuODg3IDI3LjcxOTggNzY5Ljg4NyAyOC4yNjI2VjM0LjY0MDZINzcyLjE3VjI4LjI0OTJDNzcyLjE3IDI2Ljk1NDIgNzcxLjQ4NyAyNS41MjQxIDc2OS40ODIgMjUuNTI0MUw3NjQuNzY2IDI1LjUyMTdWMzQuNjQwNkg3NjcuMDVWMjcuMzg1M0g3NjguOTM5VjI3LjM4NTNaTTc5Mi42MzcgMjMuNTg5MUM3OTIuMTI5IDIzLjU4OTEgNzkxLjcyNCAyMy4xNzU0IDc5MS43MjQgMjIuNjYyOUM3OTEuNzI0IDIyLjE1MjkgNzkyLjEyOSAyMS43MzY4IDc5Mi42MzcgMjEuNzM2OEM3OTMuMTQyIDIxLjczNjggNzkzLjU1NiAyMi4xNTI5IDc5My41NTYgMjIuNjYyOUM3OTMuNTU2IDIzLjE3NTQgNzkzLjE0MiAyMy41ODkxIDc5Mi42MzcgMjMuNTg5MVpNNzkyLjYzNyAyMS44OTEyQzc5Mi4yMTggMjEuODkxMiA3OTEuODgyIDIyLjI0MDcgNzkxLjg4MiAyMi42NjI5Qzc5MS44ODIgMjMuMDg3NiA3OTIuMjE4IDIzLjQzMDkgNzkyLjYzNyAyMy40MzA5Qzc5My4wNTUgMjMuNDMwOSA3OTMuNDAyIDIzLjA4NzYgNzkzLjQwMiAyMi42NjI5Qzc5My40MDIgMjIuMjQwNyA3OTMuMDU1IDIxLjg5MTIgNzkyLjYzNyAyMS44OTEyWk03OTMuMDQzIDIzLjIxOEg3OTIuODcyQzc5Mi44NjQgMjMuMjE3OSA3OTIuODU3IDIzLjIxNTcgNzkyLjg1MSAyMy4yMTE2Qzc5Mi44NDUgMjMuMjA3NSA3OTIuODQgMjMuMjAxNyA3OTIuODM3IDIzLjE5NDlMNzkyLjYwNSAyMi43OTdDNzkyLjU5OCAyMi43ODg1IDc5Mi41NzkgMjIuNzc4OCA3OTIuNTczIDIyLjc3ODhINzkyLjQ2N1YyMy4xNzU0Qzc5Mi40NjcgMjMuMTk1IDc5Mi40NTMgMjMuMjE4MSA3OTIuNDI4IDIzLjIxODFINzkyLjI3NEM3OTIuMjUxIDIzLjIxODEgNzkyLjIzNSAyMy4xOTUgNzkyLjIzNSAyMy4xNzU0VjIyLjE3NDlDNzkyLjIzNSAyMi4xMTY0IDc5Mi4yNTQgMjIuMDkyNCA3OTIuMzA1IDIyLjA4NUM3OTIuMzYxIDIyLjA3OSA3OTIuNTA1IDIyLjA3MTYgNzkyLjU4NiAyMi4wNzE2Qzc5Mi44NzIgMjIuMDcxNiA3OTMuMDM5IDIyLjE1NjYgNzkzLjAzOSAyMi40MjQ0VjIyLjQ0NEM3OTMuMDM5IDIyLjYwOTQgNzkyLjk1OSAyMi42OTk1IDc5Mi44MzMgMjIuNzM5N0w3OTMuMDc0IDIzLjE1NDdDNzkzLjA3OCAyMy4xNjQgNzkzLjA4IDIzLjE3MzkgNzkzLjA4IDIzLjE4NEM3OTMuMDggMjMuMTk5NyA3OTMuMDcyIDIzLjIxOCA3OTMuMDQzIDIzLjIxOFYyMy4yMThaTTc5Mi44MjEgMjIuNDI0NEM3OTIuODIxIDIyLjMxMjcgNzkyLjc1MiAyMi4yNzczIDc5Mi42MDUgMjIuMjc3M0g3OTIuNDU5VjIyLjU5NDdDNzkyLjQ4MiAyMi41OTQ3IDc5Mi41ODYgMjIuNTk5NiA3OTIuNjA1IDIyLjU5OTZDNzkyLjc1MiAyMi41OTk2IDc5Mi44MjEgMjIuNTUgNzkyLjgyMSAyMi40NDRWMjIuNDI0NFoiIGZpbGw9IiMwRTdEQzIiLz4NCjwvZz4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMV81OF8xMTEpIj4NCjxwYXRoIGQ9Ik01MzMuNzczIDIwLjk5MTFDNTI5LjI2MyAyMC45OTExIDUyNS41OTkgMjQuNjU0NyA1MjUuNTk5IDI5LjE2NDRDNTI1LjU5OSAzMy42NzQxIDUyOS4yNjMgMzcuMzM3NyA1MzMuNzczIDM3LjMzNzdDNTM4LjI4MiAzNy4zMzc3IDU0MS45NDYgMzMuNjc0MSA1NDEuOTQ2IDI5LjE2NDRDNTQxLjk0NiAyNC42NTQ3IDUzOC4yODIgMjAuOTkxMSA1MzMuNzczIDIwLjk5MTFaTTUzMy43NzMgMzYuNTE4NkM1MjkuNzEzIDM2LjUxODYgNTI2LjQxOSAzMy4yMTUgNTI2LjQxOSAyOS4xNjQ0QzUyNi40MTkgMjUuMTEzNyA1MjkuNzEzIDIxLjgxMDIgNTMzLjc3MyAyMS44MTAyQzUzNy44MzIgMjEuODEwMiA1NDEuMTI3IDI1LjExMzcgNTQxLjEyNyAyOS4xNjQ0QzU0MS4xMjcgMzMuMjE1IDUzNy44MzIgMzYuNTE4NiA1MzMuNzczIDM2LjUxODZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTUzNi42OSAyMy45MjUyQzUzNi42NjMgMjMuOTA3MiA1MzYuNjI3IDIzLjg5ODIgNTM2LjU5MSAyMy44OTgyQzUzNi40ODMgMjMuODk4MiA1MzYuNDAyIDIzLjk3OTIgNTM2LjQwMiAyNC4wODczVjI2LjY0MzdDNTM2LjQwMiAyNi43MzM3IDUzNi4zMyAyNi44MDU3IDUzNi4yNCAyNi44MDU3SDUzMS4yOUM1MzEuMiAyNi44MDU3IDUzMS4xMzcgMjYuNzMzNyA1MzEuMTI4IDI2LjY0MzdWMjQuMDg3M0M1MzEuMTI4IDI0LjA1MTMgNTMxLjExOSAyNC4wMjQyIDUzMS4xMDEgMjMuOTg4MkM1MzEuMDQ3IDIzLjg5ODIgNTMwLjkzIDIzLjg3MTIgNTMwLjgzOSAyMy45MjUyQzUyOS4wMTIgMjUuMDUwNCA1MjcuOTA1IDI3LjAwMzcgNTI3LjkwNSAyOS4xNjQxQzUyNy45MDUgMzEuMzI0NCA1MjkuMDEyIDMzLjI3NzcgNTMwLjg1NyAzNC40MDI5QzUzMC44ODUgMzQuNDIwOSA1MzAuOTIxIDM0LjQyOTkgNTMwLjk1NyAzNC40Mjk5QzUzMS4wNjUgMzQuNDI5OSA1MzEuMTQ2IDM0LjM0ODkgNTMxLjE0NiAzNC4yNDA5VjMxLjY4NDVDNTMxLjE0NiAzMS41OTQ0IDUzMS4yMTggMzEuNTMxNCA1MzEuMzA4IDMxLjUyMjRINTM2LjI1OEM1MzYuMzQ4IDMxLjUyMjQgNTM2LjQyIDMxLjU5NDQgNTM2LjQyIDMxLjY4NDVWMzQuMjQwOUM1MzYuNDIgMzQuMjc2OSA1MzYuNDI5IDM0LjMwMzkgNTM2LjQ0NyAzNC4zMzk5QzUzNi41MDEgMzQuNDI5OSA1MzYuNjE4IDM0LjQ1NjkgNTM2LjcwOCAzNC40MDI5QzUzOC41NTQgMzMuMjc3NyA1MzkuNjYxIDMxLjMyNDQgNTM5LjY2MSAyOS4xNjQxQzUzOS42NjEgMjcuMDAzNyA1MzguNTM2IDI1LjA1MDQgNTM2LjY5IDIzLjkyNTJWMjMuOTI1MlpNNTMwLjE5MSAzMi4zNjg2TDUzMC4yMTggMzIuNjc0Nkw1MzAuMDIgMzIuNDMxNkM1MjguNDk5IDMwLjUxNDMgNTI4LjQ5OSAyNy44MDQ4IDUzMC4wMiAyNS44ODc1TDUzMC4xOTEgMjUuNjcxNUw1MzAuMjE4IDI1LjY0NDVMNTMwLjE5MSAyNS45NTk2QzUzMC4xNjQgMjYuMjExNiA1MzAuMTU1IDI2LjQ3MjYgNTMwLjE1NSAyNi43MzM3VjMxLjU4NTRDNTMwLjE1NSAzMS44NDY1IDUzMC4xNzMgMzIuMTA3NSA1MzAuMTkxIDMyLjM2ODZaTTUzNi40MDIgMzAuMzg4M0M1MzYuNDAyIDMwLjQ3ODMgNTM2LjMzIDMwLjU1MDMgNTM2LjI0IDMwLjU1MDNINTMxLjI5QzUzMS4yIDMwLjU1MDMgNTMxLjEzNyAzMC40NzgzIDUzMS4xMjggMzAuMzg4M1YyNy45Mzk5QzUzMS4xMjggMjcuODQ5OSA1MzEuMiAyNy43Nzc4IDUzMS4yOSAyNy43Nzc4SDUzNi4yNEM1MzYuMzMgMjcuNzc3OCA1MzYuNDAyIDI3Ljg0OTkgNTM2LjQwMiAyNy45Mzk5VjMwLjM4ODNaTTUzNy41MTkgMzIuNDMxNkw1MzcuMzIxIDMyLjY3NDZMNTM3LjM0OCAzMi4zNjg2QzUzNy4zNzUgMzIuMTE2NSA1MzcuMzg0IDMxLjg1NTUgNTM3LjM4NCAzMS41OTQ0VjI2LjczMzdDNTM3LjM4NCAyNi40NzI2IDUzNy4zNzUgMjYuMjExNiA1MzcuMzQ4IDI1Ljk1OTZMNTM3LjMzOSAyNS44MjQ1TDUzNy4zMyAyNS42ODA1VjI1LjY0NDVMNTM3LjUxOSAyNS44ODc1QzUzOC4yNTcgMjYuODA1NyA1MzguNjYyIDI3Ljk3NTkgNTM4LjY2MiAyOS4xNTUxQzUzOC42NjIgMzAuMzM0MiA1MzguMjU3IDMxLjUxMzQgNTM3LjUxOSAzMi40MzE2VjMyLjQzMTZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTU1NC4yNzYgMjkuMDIwMkM1NTQuMjMxIDI5LjAwMjIgNTU0LjE3NyAyOC45ODQyIDU1NC4xNzcgMjguOTMwMkM1NTQuMTc3IDI4Ljg5NDIgNTU0LjE5NSAyOC44NjcyIDU1NC4yMzEgMjguODQ5MkM1NTQuMjk0IDI4LjgyMjIgNTU1Ljg1MSAyOC4yNjQxIDU1NS44NTEgMjYuNDI3OEM1NTUuODUxIDI0LjM4NDUgNTU0LjQ3NCAyMy4xNjkzIDU1Mi4xNTIgMjMuMTY5M0g1NDYuNTI2VjM1LjE3NzJINTUyLjY2NUM1NTQuNDU2IDM1LjE3NzIgNTU2LjM4MiAzMy45MDggNTU2LjM4MiAzMS44NjQ2QzU1Ni4zODIgMjkuOTExMyA1NTQuOTA2IDI5LjIyNzIgNTU0LjI3NiAyOS4wMjAyVjI5LjAyMDJaTTU0OS4zNjEgMjUuNjI2N0M1NDkuMzYxIDI1LjU4MTcgNTQ5LjM5NyAyNS41NDU2IDU0OS40NDIgMjUuNTQ1Nkg1NTEuNjc1QzU1Mi40MTMgMjUuNTQ1NiA1NTIuOTE3IDI2LjA0MDcgNTUyLjkxNyAyNi43Nzg4QzU1Mi45MTcgMjcuMzU0OSA1NTIuNDY3IDI3Ljk3NiA1NTEuNjIxIDI3Ljk3Nkg1NDkuNDQyQzU0OS4zOTcgMjcuOTc2IDU0OS4zNjEgMjcuOTQgNTQ5LjM2MSAyNy44OTVWMjUuNjI2N1pNNTUxLjY3NSAzMi44MDk4SDU0OS40NDJDNTQ5LjM5NyAzMi44MDk4IDU0OS4zNjEgMzIuNzczOCA1NDkuMzYxIDMyLjcyODhWMzAuMzM0NEM1NDkuMzYxIDMwLjI4OTQgNTQ5LjM5NyAzMC4yNTM0IDU0OS40NDIgMzAuMjUzNEg1NTEuNjIxQzU1Mi42OTIgMzAuMjUzNCA1NTMuMzA0IDMwLjcxMjUgNTUzLjMwNCAzMS41MjI2QzU1My4zMDQgMzIuMzU5NyA1NTIuNzM3IDMyLjgwOTggNTUxLjY3NSAzMi44MDk4VjMyLjgwOThaTTU3NS4zODQgMjcuOTQ5TDU3NC45NTIgMjcuODU5QzU3My45OCAyNy42NTIgNTczLjAzNSAyNy4zOTA5IDU3My4wMzUgMjYuNTUzOEM1NzMuMDM1IDI1LjcxNjcgNTczLjgxOCAyNS4zMzg2IDU3NC41OTIgMjUuMzM4NkM1NzUuNTAxIDI1LjMzODYgNTc2LjQwMSAyNS43NDM3IDU3Ny4wODYgMjYuNDQ1OEw1NzguODY4IDI0LjY4MTVDNTc4LjEwMyAyMy44MzU0IDU3Ni43NDQgMjIuODYzMiA1NzQuNTQ3IDIyLjg2MzJDNTcxLjkwMSAyMi44NjMyIDU3MC4xMTggMjQuMzY2NSA1NzAuMTE4IDI2LjYwNzhDNTcwLjExOCAyOC45NzUyIDU3MS45ODIgMjkuODY2MyA1NzMuNTQ4IDMwLjE5OTRMNTczLjk3MSAzMC4yODk0QzU3NS40OTIgMzAuNjEzNSA1NzYuMjEyIDMwLjg1NjUgNTc2LjIxMiAzMS43MjA2QzU3Ni4yMTIgMzIuNDk0NyA1NzUuNTE5IDMzLjAwNzggNTc0LjQ5MyAzMy4wMDc4QzU3My4yODcgMzMuMDA3OCA1NzIuMjE2IDMyLjQ3NjcgNTcxLjQwNiAzMS40Nzc2TDU2OS41NzggMzMuMjY4OUM1NzAuNTUxIDM0LjQyMTEgNTcxLjgzOCAzNS40NjUyIDU3NC41MjkgMzUuNDY1MkM1NzYuODI1IDM1LjQ2NTIgNTc5LjE1NiAzNC4xMzMgNTc5LjE1NiAzMS41NzY2QzU3OS4xNDcgMjguOTU3MiA1NzcuMzY1IDI4LjM2MzEgNTc1LjM4NCAyNy45NDlWMjcuOTQ5Wk01OTkuMTAzIDIzLjE2OTNWMjcuNTYyQzU5OS4xMDMgMjcuNjA3IDU5OS4wNjcgMjcuNjQzIDU5OS4wMjIgMjcuNjQzSDU5NS4zMzFDNTk1LjI4NiAyNy42NDMgNTk1LjI1IDI3LjYwNyA1OTUuMjUgMjcuNTYyVjIzLjE2OTNINTkyLjIyNlYzNS4xNzcySDU5NS4yNVYzMC40NjA0QzU5NS4yNSAzMC40MTU0IDU5NS4yODYgMzAuMzc5NCA1OTUuMzMxIDMwLjM3OTRINTk5LjAyMkM1OTkuMDY3IDMwLjM3OTQgNTk5LjEwMyAzMC40MTU0IDU5OS4xMDMgMzAuNDYwNFYzNS4xNzcySDYwMi4xNDZWMjMuMTY5M0g1OTkuMTAzWk01ODYuMTQxIDMyLjcxOThDNTg0Ljc4MiAzMi43MTk4IDU4My4zMTUgMzEuNTg1NiA1ODMuMzE1IDI5LjA5MjJDNTgzLjMxNSAyNi44MTQ4IDU4NC42OTIgMjUuNjI2NyA1ODYuMDUxIDI1LjYyNjdDNTg3LjA0MSAyNS42MjY3IDU4Ny43MzQgMjYuMDQwNyA1ODguMjgzIDI2Ljk1ODlMNTkwLjYwNiAyNS40MTk2QzU4OS40MTggMjMuNjczMyA1ODguMDA0IDIyLjg4MTIgNTg2LjAzMyAyMi44ODEyQzU4Mi4xNzEgMjIuODgxMiA1ODAuNDQzIDI2LjAwNDcgNTgwLjQ0MyAyOS4wOTIyQzU4MC40NDMgMzIuODQ1OCA1ODIuNzI5IDM1LjQ2NTIgNTg1Ljk5NyAzNS40NjUyQzU4OC40MjcgMzUuNDY1MiA1ODkuNTM1IDM0LjU3NDEgNTkwLjY5NiAzMi45MjY4TDU4OC4zNTUgMzEuMzUxNkM1ODcuODMzIDMyLjE5NzcgNTg3LjI2NiAzMi43MTk4IDU4Ni4xNDEgMzIuNzE5OFpNNTYzLjE3OCAyMi44NjMyQzU1OS44NzUgMjIuODYzMiA1NTcuNjYxIDI1LjM5MjYgNTU3LjY2MSAyOS4xNjQyQzU1Ny42NjEgMzIuOTM1OCA1NTkuODc1IDM1LjQ2NTIgNTYzLjE3OCAzNS40NjUyQzU2Ni40ODIgMzUuNDY1MiA1NjguNjk2IDMyLjkzNTggNTY4LjY5NiAyOS4xNjQyQzU2OC42OTYgMjUuMzkyNiA1NjYuNDgyIDIyLjg2MzIgNTYzLjE3OCAyMi44NjMyVjIyLjg2MzJaTTU2My4xNzggMzIuNzE5OEM1NjEuNTU4IDMyLjcxOTggNTYwLjUxNCAzMS4zMjQ2IDU2MC41MTQgMjkuMTY0MkM1NjAuNTE0IDI3LjAxMjkgNTYxLjU1OCAyNS42MjY3IDU2My4xNzggMjUuNjI2N0M1NjQuODA4IDI1LjYyNjcgNTY1Ljg2MSAyNy4wMTI5IDU2NS44NjEgMjkuMTY0MkM1NjUuODYxIDMxLjMyNDYgNTY0LjgwOCAzMi43MTk4IDU2My4xNzggMzIuNzE5OFoiIGZpbGw9IiNGODAwMDAiLz4NCjwvZz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTQ2LjM0NCAyMi4xODExQzE0Ny41OTUgMjIuMjg1NCAxNDguODQ1IDIxLjU1NTMgMTQ5LjYyNyAyMC42Mjk4QzE1MC4zOTUgMTkuNjc4MSAxNTAuOTAzIDE4LjQwMDUgMTUwLjc3MyAxNy4wOTY5QzE0OS42NjYgMTcuMTQ5MSAxNDguMjk4IDE3LjgyNjkgMTQ3LjUxNyAxOC43Nzg2QzE0Ni44IDE5LjU5OTkgMTQ2LjE4OCAyMC45Mjk2IDE0Ni4zNDQgMjIuMTgxMVpNMTQ3Ljg0MSAyMy4wNzk3QzE0OC42NTMgMjIuNzYwNiAxNDkuNjU4IDIyLjM2NTYgMTUwLjc2IDIyLjQyOTFDMTUxLjQ2MyAyMi40ODEyIDE1My40OTUgMjIuNjg5OCAxNTQuNzk4IDI0LjYxOTJDMTU0Ljc5MiAyNC42MjM3IDE1NC43NzggMjQuNjMyMyAxNTQuNzU5IDI0LjY0NUMxNTQuNDM2IDI0Ljg1NDggMTUyLjM5IDI2LjE4NzEgMTUyLjQxNCAyOC44MTY5QzE1Mi40MzkgMzEuOTQ5OSAxNTQuOTg4IDMzLjExODMgMTU1LjMyMiAzMy4yNzExQzE1NS4zNDQgMzMuMjgxMSAxNTUuMzU2IDMzLjI4NjcgMTU1LjM1OCAzMy4yODgzQzE1NS4zNTYgMzMuMjkyNiAxNTUuMzU0IDMzLjMwMSAxNTUuMzUgMzMuMzEzM0MxNTUuMjgzIDMzLjUyODggMTU0Ljg0NSAzNC45NDg5IDE1My44NDcgMzYuNDA0QzE1Mi45MjIgMzcuNzU5OCAxNTEuOTcxIDM5LjA4OTUgMTUwLjQ2IDM5LjExNTZDMTQ5Ljc0OSAzOS4xMjgzIDE0OS4yNyAzOC45MjExIDE0OC43NzIgMzguNzA1NEMxNDguMjQ3IDM4LjQ3ODUgMTQ3LjcwMSAzOC4yNDIyIDE0Ni44NCAzOC4yNDIyQzE0NS45NDcgMzguMjQyMiAxNDUuMzc2IDM4LjQ4NDggMTQ0LjgyNiAzOC43MTg0QzE0NC4zNDggMzguOTIxNCAxNDMuODg3IDM5LjExNzQgMTQzLjI0NSAzOS4xNDE3QzE0MS43ODYgMzkuMTkzOCAxNDAuNjc5IDM3LjcwNzcgMTM5Ljc1NCAzNi4zNTE5QzEzNy44NjYgMzMuNjE0MyAxMzYuNDIgMjguNjM0NCAxMzguMzc0IDI1LjI3MUMxMzkuMzI1IDIzLjU4OTMgMTQxLjA1NyAyMi41MzM0IDE0Mi45MTkgMjIuNTA3M0MxNDMuNzMyIDIyLjQ5MjUgMTQ0LjUwNyAyMi44MDA2IDE0NS4xODQgMjMuMDcwMUMxNDUuNzAyIDIzLjI3NTggMTQ2LjE2MiAyMy40NTg5IDE0Ni41NCAyMy40NTg5QzE0Ni44NzcgMjMuNDU4OSAxNDcuMzE5IDIzLjI4NTEgMTQ3Ljg0MSAyMy4wNzk3WiIgZmlsbD0iYmxhY2siLz4NCjxwYXRoIGQ9Ik0zNi44NTg3IDM3LjUyNDFIMzEuOTg3NEwzNS4wMzQyIDE5LjY2NjhIMzkuOTA1MkwzNi44NTg3IDM3LjUyNDFaIiBmaWxsPSIjMDA1NzlGIi8+DQo8cGF0aCBkPSJNNTQuNTE1NyAyMC4xMDQxQzUzLjU1NDkgMTkuNzQyOCA1Mi4wMzA5IDE5LjM0MzggNTAuMTQ2NiAxOS4zNDM4QzQ1LjMzNjEgMTkuMzQzOCA0MS45NDg2IDIxLjc3NTMgNDEuOTI3OCAyNS4yNTE2QzQxLjg4NzggMjcuODE2NSA0NC4zNTMxIDI5LjI0MSA0Ni4xOTcgMzAuMDk2MkM0OC4wODE2IDMwLjk3MDEgNDguNzIyMyAzMS41NDA1IDQ4LjcyMjMgMzIuMzE5NEM0OC43MDMxIDMzLjUxNTcgNDcuMTk5NCAzNC4wNjcyIDQ1Ljc5NjkgMzQuMDY3MkM0My44NTIxIDM0LjA2NzIgNDIuODEgMzMuNzgyOSA0MS4yMjY0IDMzLjExNzNMNDAuNTg1IDMyLjgzMkwzOS45MDMzIDM2Ljg0MDZDNDEuMDQ1OCAzNy4zMzM5IDQzLjE1MDcgMzcuNzcxNyA0NS4zMzYxIDM3Ljc5MDlDNTAuNDQ3MyAzNy43OTA5IDUzLjc3NDkgMzUuMzk3MSA1My44MTQzIDMxLjY5MjVDNTMuODMzOCAyOS42NTk3IDUyLjUzMiAyOC4xMDIgNDkuNzI1NCAyNi44MjkyQzQ4LjAyMTcgMjYuMDEyMSA0Ni45NzgzIDI1LjQ2MTIgNDYuOTc4MyAyNC42MjUyQzQ2Ljk5ODMgMjMuODY1MiA0Ny44NjA4IDIzLjA4NjggNDkuNzg0IDIzLjA4NjhDNTEuMzY3NyAyMy4wNDg2IDUyLjUzMTIgMjMuNDA5NCA1My40MTI2IDIzLjc3MDVMNTMuODUzMiAyMy45NjAxTDU0LjUxNTcgMjAuMTA0MVoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik02MC45OTI0IDMxLjE5NzlDNjEuMzkzNiAzMC4xNzIgNjIuOTM3MiAyNi4yMDE2IDYyLjkzNzIgMjYuMjAxNkM2Mi45MTcgMjYuMjM5NyA2My4zMzc2IDI1LjE1NjggNjMuNTc4MSAyNC40OTE5TDYzLjkxODYgMjYuMDMwNkM2My45MTg2IDI2LjAzMDYgNjQuODQxIDMwLjMwNTEgNjUuMDQxNCAzMS4xOTc5QzY0LjI4IDMxLjE5NzkgNjEuOTU0NiAzMS4xOTc5IDYwLjk5MjQgMzEuMTk3OVpNNjcuMDA1NCAxOS42NjY4SDYzLjIzNzRDNjIuMDc1NSAxOS42NjY4IDYxLjE5MjcgMTkuOTg5NSA2MC42OTE0IDIxLjE0ODRMNTMuNDU1OCAzNy41MjM5SDU4LjU2NzFDNTguNTY3MSAzNy41MjM5IDU5LjQwODUgMzUuMzE5OSA1OS41ODk0IDM0Ljg0NTJDNjAuMTUwMSAzNC44NDUyIDY1LjEyMjMgMzQuODQ1MiA2NS44NDM3IDM0Ljg0NTJDNjUuOTgzNSAzNS40NzIxIDY2LjQyNDkgMzcuNTIzOSA2Ni40MjQ5IDM3LjUyMzlINzAuOTM1Mkw2Ny4wMDU0IDE5LjY2NjhWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0yNy45MTggMTkuNjY2OEwyMy4xNDc1IDMxLjg0MzhMMjIuNjI2MiAyOS4zNzQxQzIxLjc0NDIgMjYuNTI0NSAxOC45NzgxIDIzLjQyODQgMTUuODkxNCAyMS44ODlMMjAuMjYxIDM3LjUwNTJIMjUuNDEyMkwzMy4wNjkgMTkuNjY2OEgyNy45MThWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0xOC43MTg0IDE5LjY2NjhIMTAuODgxMUwxMC44MDA5IDIwLjAyNzZDMTYuOTE0NSAyMS41MDk1IDIwLjk2MzUgMjUuMDgxNSAyMi42MjcgMjkuMzc0OUwyMC45MjMyIDIxLjE2NzlDMjAuNjQyNyAyMC4wMjc0IDE5Ljc4MDcgMTkuNzA0NCAxOC43MTg0IDE5LjY2NjhaIiBmaWxsPSIjRkFBNjFBIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDJfNThfMTExKSI+DQo8cGF0aCBkPSJNMjIxLjE1OCAxNy40OTlWMTguOTM1NkgyMzEuMzA2VjE3LjQ5OUgyMjEuMTU4Wk0yMzIuNzQ0IDE3LjQ5OVYxOC45MzU2SDI0Ny4yMDZDMjQ3LjIwNiAxOC45MzU2IDI0NS43MjkgMTcuNDk5IDI0My43NzMgMTcuNDk5SDIzMi43NDRaTTI1MC4wNDMgMTcuNDk5VjE4LjkzNTZIMjU4Ljc5M0wyNTguMjczIDE3LjQ5OUgyNTAuMDQzWk0yNjUuMDY1IDE3LjQ5OUwyNjQuNTQ2IDE4LjkzNTZIMjczLjIxNlYxNy40OTlIMjY1LjA2NVpNMjIxLjE1OCAyMC4yOTI5VjIxLjcyOTZIMjMxLjMwNlYyMC4yOTI5SDIyMS4xNThaTTIzMi43NDQgMjAuMjk1VjIxLjcyOTdIMjQ4Ljg4NEMyNDguODg0IDIxLjcyOTcgMjQ4LjY5NiAyMC42MjM5IDI0OC4zNjcgMjAuMjk1SDIzMi43NDRaTTI1MC4wNDMgMjAuMjk1VjIxLjcyOTdIMjU5Ljc1MkwyNTkuMjcxIDIwLjI5NUgyNTAuMDQzWk0yNjQuMDI3IDIwLjI5NUwyNjMuNTQ2IDIxLjcyOTdIMjczLjIxNlYyMC4yOTVIMjY0LjAyN1YyMC4yOTVaTTIyNC4wNzQgMjMuMDg2OVYyNC41MjU3SDIyOC40NjlWMjMuMDg2OUgyMjQuMDc0VjIzLjA4NjlaTTIzNS42NjEgMjMuMDg2OVYyNC41MjU3SDI0MC4wNTZWMjMuMDg2OUgyMzUuNjYxVjIzLjA4NjlaTTI0NC4zMzEgMjMuMDg2OVYyNC41MjU3SDI0OC43MjZDMjQ4LjcyNiAyNC41MjU3IDI0OS4wMDUgMjMuNzY1OSAyNDkuMDA1IDIzLjA4NjlIMjQ0LjMzMVYyMy4wODY5Wk0yNTIuOTYgMjMuMDg2OVYyNC41MjU3SDI2MC43NTJMMjYwLjIzMiAyMy4wODY5SDI1Mi45NlYyMy4wODY5Wk0yNjMuMDY5IDIzLjA4NjlMMjYyLjU0OCAyNC41MjU3SDI3MC4zNzlWMjMuMDg2OUgyNjMuMDY5VjIzLjA4NjlaTTIyNC4wNzQgMjUuODgzVjI3LjMxOTdIMjI4LjQ2OVYyNS44ODNIMjI0LjA3NFYyNS44ODNaTTIzNS42NjEgMjUuODgzVjI3LjMxOTdIMjQ2Ljg4N0MyNDYuODg3IDI3LjMxOTcgMjQ3LjgyNiAyNi41ODI1IDI0OC4xMjUgMjUuODgzSDIzNS42NjFaTTI1Mi45NiAyNS44ODNWMjcuMzE5N0gyNTcuMzU1VjI2LjUyTDI1Ny42MzQgMjcuMzE5N0gyNjUuNjg0TDI2NS45ODQgMjYuNTJWMjcuMzE5N0gyNzAuMzc5VjI1Ljg4M0gyNjIuMTI5TDI2MS42OTEgMjcuMDk5OUwyNjEuMjUxIDI1Ljg4M0gyNTIuOTZaTTIyNC4wNzQgMjguNjc3VjMwLjExMzdIMjI4LjQ2OVYyOC42NzdIMjI0LjA3NFpNMjM1LjY2MSAyOC42NzdWMzAuMTEzN0gyNDguMTI1QzI0Ny44MjYgMjkuNDE2NSAyNDYuODg3IDI4LjY3NyAyNDYuODg3IDI4LjY3N0gyMzUuNjYxWk0yNTIuOTYgMjguNjc3VjMwLjExMzdIMjU3LjM1NVYyOC42NzdIMjUyLjk2Wk0yNTguMTUzIDI4LjY3N0wyNTguNjg1IDMwLjExMzdIMjY0LjcyMUwyNjUuMjI2IDI4LjY3N0gyNTguMTUzWk0yNjUuOTg0IDI4LjY3N1YzMC4xMTM3SDI3MC4zNzlWMjguNjc3SDI2NS45ODRaTTIyNC4wNzQgMzEuNDcxVjMyLjkwNzZIMjI4LjQ2OVYzMS40NzFIMjI0LjA3NFpNMjM1LjY2MSAzMS40NzFWMzIuOTA3NkgyNDAuMDU2VjMxLjQ3MUgyMzUuNjYxWk0yNDQuMzMxIDMxLjQ3MVYzMi45MDc2SDI0OS4wMDVDMjQ5LjAwNSAzMi4yMjk2IDI0OC43MjYgMzEuNDcxIDI0OC43MjYgMzEuNDcxSDI0NC4zMzFWMzEuNDcxWk0yNTIuOTYgMzEuNDcxVjMyLjkwNzZIMjU3LjM1NVYzMS40NzFIMjUyLjk2Wk0yNTkuMTUxIDMxLjQ3MUwyNTkuNjY2IDMyLjkwNzZIMjYzLjcxM0wyNjQuMjMyIDMxLjQ3MUgyNTkuMTUxWk0yNjUuOTg0IDMxLjQ3MVYzMi45MDc2SDI3MC4zNzlWMzEuNDcxSDI2NS45ODRaTTIyMS4yMzcgMzQuMjY1VjM1LjcwMzdIMjMxLjM4NlYzNC4yNjVIMjIxLjIzN1pNMjMyLjc0NCAzNC4yNjVWMzUuNzAzN0gyNDguMzY3QzI0OC42OTYgMzUuMzc0MyAyNDguODg0IDM0LjI2NSAyNDguODg0IDM0LjI2NUgyMzIuNzQ0VjM0LjI2NVpNMjUwLjEyMyAzNC4yNjVWMzUuNzAzN0gyNTcuMzU1VjM0LjI2NUgyNTAuMTIzWk0yNjAuMTUxIDM0LjI2NUwyNjAuNjggMzUuNzAzN0gyNjIuNzM5TDI2My4yMzYgMzQuMjY1SDI2MC4xNTFaTTI2NS45ODQgMzQuMjY1VjM1LjcwMzdIMjczLjI5NVYzNC4yNjVIMjY1Ljk4NFpNMjIxLjIzNyAzNy4wNjFWMzguNDk3N0gyMzEuMzg2VjM3LjA2MUgyMjEuMjM3Wk0yMzIuNzQ0IDM3LjA2MVYzOC40OTU2SDI0My43NzNDMjQ1LjcyOSAzOC40OTU2IDI0Ny4yMDYgMzcuMDYxIDI0Ny4yMDYgMzcuMDYxSDIzMi43NDRaTTI1MC4xMjMgMzcuMDYxVjM4LjQ5NzdIMjU3LjM1NVYzNy4wNjFIMjUwLjEyM1pNMjYxLjE1NSAzNy4wNjFMMjYxLjY2NCAzOC40OTM2TDI2MS43NTIgMzguNDk1NkwyNjIuMjY5IDM3LjA2MUgyNjEuMTU1VjM3LjA2MVpNMjY1Ljk4NCAzNy4wNjFWMzguNDk3N0gyNzMuMjk1VjM3LjA2MUgyNjUuOTg0WiIgZmlsbD0iIzFGNzBDMSIvPg0KPC9nPg0KPGRlZnM+DQo8Y2xpcFBhdGggaWQ9ImNsaXAwXzU4XzExMSI+DQo8cmVjdCB3aWR0aD0iNDQuNDQ3MyIgaGVpZ2h0PSIyOS42MzE1IiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzUzLjk1NSAxNC44MTU1KSIvPg0KPC9jbGlwUGF0aD4NCjxjbGlwUGF0aCBpZD0iY2xpcDFfNThfMTExIj4NCjxyZWN0IHdpZHRoPSI3Ni41NDgxIiBoZWlnaHQ9IjE2LjM1MDciIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MjUuNTk5IDIwLjk4ODkpIi8+DQo8L2NsaXBQYXRoPg0KPGNsaXBQYXRoIGlkPSJjbGlwMl81OF8xMTEiPg0KPHJlY3Qgd2lkdGg9IjUyLjEzNzIiIGhlaWdodD0iMjAuOTk4NyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMS4xNTggMTcuNDk5KSIvPg0KPC9jbGlwUGF0aD4NCjwvZGVmcz4NCjwvc3ZnPg0K" style="
            width: 742.5px;
            position: relative;
            top: 107px;
            left: 32px;
            ">
            <a href=`+Yw+` style="
        float: left;
        border-radius: 56px;
        background: #0D6EFD;
        padding-top: 8px;
        width: 280px;
        height: 38px;
        text-align: center;
        position: relative;
        top: 127px;
        left: 274px;
        font-size: 16px;
        color: white;
        text-decoration: none;
        letter-spacing: 0.02em;
    ">Claim your FREE account</a>
            <div style="
    font-size: 14px;
    position: relative;
    top: 180px;
    left: 19px;
    letter-spacing: 0.02em;
    font-weight: 500;
    line-height: 125%;
">have a Syncfusion account? <a href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login" style="text-decoration: none;
color: #0D6EFD;
font-weight: 500;">Sign In</a></div>
        </div>
    </div>`;if(typeof document<"u"&&!m(document)){var e=St("div",{innerHTML:s});document.body.appendChild(e)}},J_=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),em=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Qw=0,RC,CA=0,FC=0,SA=!0,xA=!1,Pi=function(s){J_(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.randomId=l_(),r.isStringTemplate=!1,r.needsID=!1,r.isReactHybrid=!1,m(r.enableRtl)&&r.setProperties({enableRtl:T_},!0),m(r.locale)&&r.setProperties({locale:Df},!0),r.moduleLoader=new $_(r),r.localObserver=new xy(r),sd.on("notifyExternalChange",r.detectFunction,r,r.randomId),typeof window<"u"&&typeof document<"u"&&!K_()&&X_.indexOf(r.getModuleName())!==-1&&(FC=FC+1,FC>5&&(SA=!1)),Re(i)||r.appendTo(),r}return e.prototype.requiredModules=function(){return[]},e.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&(this.setPersistData(),this.detachUnloadEvent()),this.localObserver.destroy(),!this.refreshing&&(te([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),s.prototype.destroy.call(this),this.moduleLoader.clean(),sd.off("notifyExternalChange",this.detectFunction,this.randomId)))},e.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new xy(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},e.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},e.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},e.prototype.getLocalData=function(){var t=this.getModuleName()+this.element.id;return window.localStorage.getItem(t)},e.prototype.attachUnloadEvent=function(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("unload",this.handleUnload)},e.prototype.handleUnload=function(){this.setPersistData()},e.prototype.detachUnloadEvent=function(){window.removeEventListener("unload",this.handleUnload)},e.prototype.appendTo=function(t){if(!m(t)&&typeof t=="string"?this.element=$(t,document):m(t)||(this.element=t),!m(this.element)){var i="e-"+this.getModuleName().toLowerCase();Q([this.element],["e-control",i]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),this.attachUnloadEvent());var r=ie("ej2_instances",this.element);(!r||r.indexOf(this)===-1)&&s.prototype.addInstance.call(this),this.preRender(),this.injectModules(),!SA&&!xA&&(Z_(),xA=!0),this.render(),this.mount?this.accessMount():this.trigger("created")}},e.prototype.renderComplete=function(t){this.isRendered=!0},e.prototype.dataBind=function(){this.injectModules(),s.prototype.dataBind.call(this)},e.prototype.on=function(t,i,r){if(typeof t=="string")this.localObserver.on(t,i,r);else for(var n=0,a=t;n<a.length;n++){var o=a[n];this.localObserver.on(o.event,o.handler,o.context)}},e.prototype.off=function(t,i){if(typeof t=="string")this.localObserver.off(t,i);else for(var r=0,n=t;r<n.length;r++){var a=n[r];this.localObserver.off(a.event,a.handler)}},e.prototype.notify=function(t,i){this.isDestroyed!==!0&&this.localObserver.notify(t,i)},e.prototype.getInjectedModules=function(){return this.injectedModules},e.Inject=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var r=0;r<t.length;r++)this.prototype.injectedModules.indexOf(t[parseInt(r.toString(),10)])===-1&&this.prototype.injectedModules.push(t[parseInt(r.toString(),10)])},e.prototype.createElement=function(t,i,r){return St(t,i)},e.prototype.triggerStateChange=function(t,i){this.isReactHybrid&&(this.setState(),this.currentContext={calls:t,args:i})},e.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},e.prototype.detectFunction=function(t){var i=Object.keys(t);i.length&&(this[i[0]]=t[i[0]])},e.prototype.mergePersistData=function(){var t;t=window.localStorage.getItem(this.getModuleName()+this.element.id),m(t)||t===""||this.setProperties(JSON.parse(t),!0)},e.prototype.setPersistData=function(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())},e.prototype.renderReactTemplates=function(t){m(t)||t()},e.prototype.clearTemplate=function(t,i){},e.prototype.getUniqueID=function(t){return this.isHistoryChanged()&&(Qw=0),RC=this.pageID(location.href),CA=history.length,t+"_"+RC+"_"+Qw++},e.prototype.pageID=function(t){var i=0;if(t.length===0)return i;for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);i=(i<<5)-i+n,i=i&i}return Math.abs(i)},e.prototype.isHistoryChanged=function(){return RC!==this.pageID(location.href)||CA!==history.length},e.prototype.addOnPersist=function(t){for(var i=this,r={},n=0,a=t;n<a.length;n++){var o=a[n],l=void 0;l=ie(o,this),Re(l)||kt(o,this.getActualProperties(l),r)}return JSON.stringify(r,function(h,u){return i.getActualProperties(u)})},e.prototype.getActualProperties=function(t){return t instanceof ke?ie("properties",t):t},e.prototype.ignoreOnPersist=function(t){return JSON.stringify(this.iterateJsonProperties(this.properties,t))},e.prototype.iterateJsonProperties=function(t,i){for(var r={},n=function(u){if(i.indexOf(u)===-1){var c=t[u];if(typeof c=="object"&&!(c instanceof Array)){var d=i.filter(function(p){var f=RegExp;return new f(u+".").test(p)}).map(function(p){return p.replace(u+".","")});r[""+u]=a.iterateJsonProperties(a.getActualProperties(c),d)}else r[""+u]=c}},a=this,o=0,l=Object.keys(t);o<l.length;o++){var h=l[o];n(h)}return r},em([S(!1)],e.prototype,"enablePersistence",void 0),em([S()],e.prototype,"enableRtl",void 0),em([S()],e.prototype,"locale",void 0),e=em([Ot],e),e}(Xo);(function(){typeof window<"u"&&window.addEventListener("popstate",function(){Qw=0})})();var EP=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Oi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},eW={left:0,top:0,bottom:0,right:0},PC={isDragged:!1},tW=function(s){EP(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Oi([S(0)],e.prototype,"left",void 0),Oi([S(0)],e.prototype,"top",void 0),e}(ke),vI=function(s){EP(e,s);function e(i,r){var n=s.call(this,r,i)||this;return n.dragLimit=t.getDefaultPosition(),n.borderWidth=t.getDefaultPosition(),n.padding=t.getDefaultPosition(),n.diffX=0,n.prevLeft=0,n.prevTop=0,n.dragProcessStarted=!1,n.eleTop=0,n.tapHoldTimer=0,n.externalInitialize=!1,n.diffY=0,n.parentScrollX=0,n.parentScrollY=0,n.droppables={},n.bind(),n}t=e,e.prototype.bind=function(){this.toggleEvents(),B.isIE&&Q([this.element],"e-block-touch"),this.droppables[this.scope]={}},e.getDefaultPosition=function(){return me({},eW)},e.prototype.toggleEvents=function(i){var r;Re(this.handle)||(r=$(this.handle,this.element));var n=this.enableTapHold&&B.isDevice&&B.isTouch?this.mobileInitialize:this.initialize;i?I.remove(r||this.element,B.isSafari()?"touchstart":B.touchStartEvent,n):I.add(r||this.element,B.isSafari()?"touchstart":B.touchStartEvent,n,this)},e.prototype.mobileInitialize=function(i){var r=this,n=i.currentTarget;this.tapHoldTimer=setTimeout(function(){r.externalInitialize=!0,r.removeTapholdTimer(),r.initialize(i,n)},this.tapHoldThreshold),I.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.removeTapholdTimer,this),I.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.removeTapholdTimer,this)},e.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer),I.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.removeTapholdTimer),I.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.removeTapholdTimer)},e.prototype.getScrollableParent=function(i,r){var n={vertical:"scrollHeight",horizontal:"scrollWidth"},a={vertical:"clientHeight",horizontal:"clientWidth"};return m(i)?null:i[n[""+r]]>i[a[""+r]]?(r==="vertical"?i.scrollTop>0:i.scrollLeft>0)?(r==="vertical"?(this.parentScrollY=this.parentScrollY+(this.parentScrollY===0?i.scrollTop:i.scrollTop-this.parentScrollY),this.tempScrollHeight=i.scrollHeight):(this.parentScrollX=this.parentScrollX+(this.parentScrollX===0?i.scrollLeft:i.scrollLeft-this.parentScrollX),this.tempScrollWidth=i.scrollWidth),m(i)?i:this.getScrollableParent(i.parentNode,r)):this.getScrollableParent(i.parentNode,r):this.getScrollableParent(i.parentNode,r)},e.prototype.getScrollableValues=function(){this.parentScrollX=0,this.parentScrollY=0,this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")},e.prototype.initialize=function(i,r){if(this.currentStateTarget=i.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=i.currentTarget||r,this.dragProcessStarted=!1,this.abort){var n=this.abort;typeof n=="string"&&(n=[n]);for(var a=0;a<n.length;a++)if(!m(U(i.target,n[parseInt(a.toString(),10)]))){this.isDragStarted()&&this.isDragStarted(!0);return}}this.preventDefault&&!Re(i.changedTouches)&&i.type!=="touchstart"&&i.preventDefault(),this.element.setAttribute("aria-grabbed","true");var o=this.getCoordinates(i);if(this.initialPosition={x:o.pageX,y:o.pageY},!this.clone){var l=this.element.getBoundingClientRect();this.getScrollableValues(),i.clientX===i.pageX&&(this.parentScrollX=0),i.clientY===i.pageY&&(this.parentScrollY=0),this.relativeXPosition=o.pageX-(l.left+this.parentScrollX),this.relativeYPosition=o.pageY-(l.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(i):(I.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart,this),I.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),i.type!=="touchstart"&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,I.trigger(document.documentElement,B.isSafari()?"touchstart":B.touchStartEvent,i)}},e.prototype.intDragStart=function(i){this.removeTapholdTimer();var r=!Re(i.changedTouches);if(!(r&&i.changedTouches.length!==1)){var n=this.getCoordinates(i),a,o=getComputedStyle(this.element);this.margin={left:parseInt(o.marginLeft,10),top:parseInt(o.marginTop,10),right:parseInt(o.marginRight,10),bottom:parseInt(o.marginBottom,10)};var l=this.element;if(this.clone&&this.dragTarget){var h=U(i.target,this.dragTarget);m(h)||(l=h)}this.isReplaceDragEle&&(l=this.currentStateCheck(i.target,l)),this.offset=this.calculateParentPosition(l),this.position=this.getMousePosition(i,this.isDragScroll);var u=this.initialPosition.x-n.pageX,c=this.initialPosition.y-n.pageY,d=Math.sqrt(u*u+c*c);if(d>=this.distance||this.externalInitialize){var p=this.getHelperElement(i);if(!p||m(p))return;r&&i.preventDefault();var f=this.helperElement=p;if(this.parentClientRect=this.calculateParentPosition(f.offsetParent),this.dragStart){var v=this.getProperTargetElement(i),g={event:i,element:l,target:v,bindEvents:null,dragElement:f};this.trigger("dragStart",g)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),a={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();var b=getComputedStyle(l),y=parseFloat(b.marginTop);this.clone&&y!==0&&(a.top+=y),this.eleTop=isNaN(parseFloat(b.top))?0:parseFloat(b.top)-this.offset.top,this.enableScrollHandler&&!this.clone&&(a.top-=this.parentScrollY,a.left-=this.parentScrollX);var C=this.getProcessedPositionValue({top:a.top-this.diffY+"px",left:a.left-this.diffX+"px"});this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(a.top+=this.dragArea.scrollTop),this.dragElePosition={top:a.top,left:a.left},tt(f,this.getDragPosition({position:"absolute",left:C.left,top:C.top})),I.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart),I.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy),this.bindDragEvents(f)}}},e.prototype.bindDragEvents=function(i){or(i)?(I.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDrag,this),I.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,i)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},e.prototype.elementInViewport=function(i){for(this.top=i.offsetTop,this.left=i.offsetLeft,this.width=i.offsetWidth,this.height=i.offsetHeight;i.offsetParent;)i=i.offsetParent,this.top+=i.offsetTop,this.left+=i.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},e.prototype.getProcessedPositionValue=function(i){return this.queryPositionInfo?this.queryPositionInfo(i):i},e.prototype.calculateParentPosition=function(i){if(m(i))return{left:0,top:0};var r=i.getBoundingClientRect(),n=getComputedStyle(i);return{left:r.left+window.pageXOffset-parseInt(n.marginLeft,10),top:r.top+window.pageYOffset-parseInt(n.marginTop,10)}},e.prototype.intDrag=function(i){if(!(!Re(i.changedTouches)&&i.changedTouches.length!==1)){this.clone&&i.changedTouches&&B.isDevice&&B.isTouch&&i.preventDefault();var r,n;this.position=this.getMousePosition(i,this.isDragScroll);var a=this.getDocumentWidthHeight("Height");a<this.position.top&&(this.position.top=a);var o=this.getDocumentWidthHeight("Width");if(o<this.position.left&&(this.position.left=o),this.drag){var l=this.getProperTargetElement(i);this.trigger("drag",{event:i,element:this.element,target:l})}var h=this.checkTargetElement(i);if(h.target&&h.instance){var u=!0;this.hoverObject&&(this.hoverObject.instance!==h.instance?this.triggerOutFunction(i,h):u=!1),u&&(h.instance.dragData[this.scope]=this.droppables[this.scope],h.instance.intOver(i,h.target),this.hoverObject=h)}else this.hoverObject&&this.triggerOutFunction(i,h);var c=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var d=this.parentClientRect.left,p=this.parentClientRect.top,f=this.getCoordinates(i),v=f.pageX,g=f.pageY,b=this.position.left-this.diffX,y=this.position.top-this.diffY,C=getComputedStyle(c);if(this.dragArea){if(this.enableAutoScroll&&this.setDragArea(),this.pageX!==v||this.skipDistanceCheck){var x=c.offsetWidth+(parseFloat(C.marginLeft)+parseFloat(C.marginRight));this.dragLimit.left>b&&b>0?r=this.dragLimit.left:this.dragLimit.right+window.pageXOffset<b+x&&b>0?r=b-(b-this.dragLimit.right)+window.pageXOffset-x:r=b<0?this.dragLimit.left:b}if(this.pageY!==g||this.skipDistanceCheck){var w=c.offsetHeight+(parseFloat(C.marginTop)+parseFloat(C.marginBottom));this.dragLimit.top>y&&y>0?n=this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<y+w&&y>0?n=y-(y-this.dragLimit.bottom)+window.pageYOffset-w:n=y<0?this.dragLimit.top:y}}else r=b,n=y;var M=p+this.borderWidth.top,E=d+this.borderWidth.left;this.dragProcessStarted&&(m(n)&&(n=this.prevTop),m(r)&&(r=this.prevLeft));var T,D;if(this.helperElement.classList.contains("e-treeview"))this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,T=n-M<0?this.dragLimit.top:n-this.borderWidth.top,D=r-E<0?this.dragLimit.left:r-this.borderWidth.left):(T=n-this.borderWidth.top,D=r-this.borderWidth.left);else if(this.dragArea){var N=this.helperElement.classList.contains("e-dialog");this.dragLimit.top=this.clone?this.dragLimit.top:0,T=n-M<0?this.dragLimit.top:n-M,D=r-E<0?N?r-(E-this.borderWidth.left):this.dragElePosition.left:r-E}else T=n-M,D=r-E;var A=parseFloat(getComputedStyle(this.element).marginTop);if(A>0&&(this.clone&&(T+=A,y<0&&(A+y>=0?T=A+y:T-=A),this.dragArea&&(T=this.dragLimit.bottom<T?this.dragLimit.bottom:T)),n-M<0))if(y+A+(c.offsetHeight-M)>=0){var L=this.dragLimit.top+y-M;L+A+M<0?T-=A+M:T=L}else T-=A+M;if(this.dragArea&&this.helperElement.classList.contains("e-treeview")){var w=c.offsetHeight+(parseFloat(C.marginTop)+parseFloat(C.marginBottom));T=T+w>this.dragLimit.bottom?this.dragLimit.bottom-w:T}this.enableScrollHandler&&!this.clone&&(T-=this.parentScrollY,D-=this.parentScrollX),this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(T+=this.dragArea.scrollTop);var k=this.getProcessedPositionValue({top:T+"px",left:D+"px"});tt(c,this.getDragPosition(k)),!this.elementInViewport(c)&&this.enableAutoScroll&&!this.helperElement.classList.contains("e-treeview")&&this.helperElement.scrollIntoView();var O=document.querySelectorAll(":hover");if(this.enableAutoScroll&&this.helperElement.classList.contains("e-treeview")){O.length===0&&(O=this.getPathElements(i));var R=this.getScrollParent(O,!1);this.elementInViewport(this.helperElement)?this.getScrollPosition(R,T):this.elementInViewport(this.helperElement)||(O=[].slice.call(document.querySelectorAll(":hover")),O.length===0&&(O=this.getPathElements(i)),R=this.getScrollParent(O,!0),this.getScrollPosition(R,T))}this.dragProcessStarted=!0,this.prevLeft=r,this.prevTop=n,this.position.left=r,this.position.top=n,this.pageX=v,this.pageY=g}},e.prototype.getScrollParent=function(i,r){for(var n=r?i.reverse():i,a,o=n.length-1;o>=0;o--)if(a=window.getComputedStyle(n[parseInt(o.toString(),10)])["overflow-y"],(a==="auto"||a==="scroll")&&n[parseInt(o.toString(),10)].scrollHeight>n[parseInt(o.toString(),10)].clientHeight)return n[parseInt(o.toString(),10)];if(a=window.getComputedStyle(document.scrollingElement)["overflow-y"],a==="visible")return document.scrollingElement.style.overflow="auto",document.scrollingElement},e.prototype.getScrollPosition=function(i,r){i&&i===document.scrollingElement?i.clientHeight+document.scrollingElement.scrollTop-this.helperElement.clientHeight<r&&i.getBoundingClientRect().height+this.parentClientRect.top>r?i.scrollTop+=this.helperElement.clientHeight:i.scrollTop>r-this.helperElement.clientHeight&&(i.scrollTop-=this.helperElement.clientHeight):i&&i!==document.scrollingElement&&(i.clientHeight+i.getBoundingClientRect().top-this.helperElement.clientHeight+document.scrollingElement.scrollTop<r?i.scrollTop+=this.helperElement.clientHeight:i.getBoundingClientRect().top>r-this.helperElement.clientHeight-document.scrollingElement.scrollTop&&(i.scrollTop-=this.helperElement.clientHeight))},e.prototype.getPathElements=function(i){var r=i.clientX>0?i.clientX:0,n=i.clientY>0?i.clientY:0;return document.elementsFromPoint(r,n)},e.prototype.triggerOutFunction=function(i,r){this.hoverObject.instance.intOut(i,r.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null},e.prototype.getDragPosition=function(i){var r=me({},i);return this.axis&&(this.axis==="x"?delete r.top:this.axis==="y"&&delete r.left),r},e.prototype.getDocumentWidthHeight=function(i){var r=document.body,n=document.documentElement,a=Math.max(r["scroll"+i],n["scroll"+i],r["offset"+i],n["offset"+i],n["client"+i]);return a},e.prototype.intDragStop=function(i){if(this.dragProcessStarted=!1,!(!Re(i.changedTouches)&&i.changedTouches.length!==1)){var r=["touchend","pointerup","mouseup"];if(r.indexOf(i.type)!==-1){if(this.dragStop){var n=this.getProperTargetElement(i);this.trigger("dragStop",{event:i,element:this.element,target:n,helper:this.helperElement})}this.intDestroy(i)}else this.element.setAttribute("aria-grabbed","false");var a=this.checkTargetElement(i);a.target&&a.instance&&(a.instance.dragStopCalled=!0,a.instance.dragData[this.scope]=this.droppables[this.scope],a.instance.intDrop(i,a.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},e.prototype.intDestroy=function(i){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),I.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart),I.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDragStop),I.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy),I.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)},e.prototype.onPropertyChanged=function(i,r){},e.prototype.getModuleName=function(){return"draggable"},e.prototype.isDragStarted=function(i){return i&&(PC.isDragged=!PC.isDragged),PC.isDragged},e.prototype.setDragArea=function(){var i,r,n=0,a=0,o,l=typeof this.dragArea;if(l==="string"?o=$(this.dragArea):o=this.dragArea,o){var h=o.getBoundingClientRect();i=o.scrollWidth?o.scrollWidth:h.right-h.left,r=o.scrollHeight?this.dragArea&&!m(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?o.clientHeight:o.scrollHeight:h.bottom-h.top;for(var u=["Top","Left","Bottom","Right"],c=getComputedStyle(o),d=0;d<u.length;d++){var p=u[parseInt(d.toString(),10)],f=c["border"+p+"Width"],v=c["padding"+p],g=p.toLowerCase();this.borderWidth[""+g]=isNaN(parseFloat(f))?0:parseFloat(f),this.padding[""+g]=isNaN(parseFloat(v))?0:parseFloat(v)}this.dragArea&&!m(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?n=h.top+document.scrollingElement.scrollTop:n=h.top,a=h.left,this.dragLimit.left=a+this.borderWidth.left+this.padding.left,this.dragLimit.top=o.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=a+i-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+r-(this.borderWidth.bottom+this.padding.bottom)}},e.prototype.getProperTargetElement=function(i){var r=this.getCoordinates(i),n,a=this.helperElement.style.pointerEvents||"",o=i.type.indexOf("pointer")!==-1&&B.info.name==="safari"&&parseInt(B.info.version)>12;return pI(i.target,this.helperElement)||i.type.indexOf("touch")!==-1||o?(this.helperElement.style.pointerEvents="none",n=document.elementFromPoint(r.clientX,r.clientY),this.helperElement.style.pointerEvents=a):n=i.target,n},e.prototype.currentStateCheck=function(i,r){var n;return!m(this.currentStateTarget)&&this.currentStateTarget!==i?n=this.currentStateTarget:n=m(r)?i:r,n},e.prototype.getMousePosition=function(i,r){var n=i.srcElement!==void 0?i.srcElement:i.target,a=this.getCoordinates(i),o,l,h=m(n.offsetParent);if(r?(o=this.clone?a.pageX:a.pageX+(h?0:n.offsetParent.scrollLeft)-this.relativeXPosition,l=this.clone?a.pageY:a.pageY+(h?0:n.offsetParent.scrollTop)-this.relativeYPosition):(o=this.clone?a.pageX:a.pageX+window.pageXOffset-this.relativeXPosition,l=this.clone?a.pageY:a.pageY+window.pageYOffset-this.relativeYPosition),document.scrollingElement&&!r&&!this.clone){var u=document.scrollingElement.scrollHeight>0&&document.scrollingElement.scrollHeight>document.scrollingElement.clientHeight&&document.scrollingElement.scrollTop>0,c=document.scrollingElement.scrollWidth>0&&document.scrollingElement.scrollWidth>document.scrollingElement.clientWidth&&document.scrollingElement.scrollLeft>0;o=c?o-document.scrollingElement.scrollLeft:o,l=u?l-document.scrollingElement.scrollTop:l}return{left:o-(this.margin.left+this.cursorAt.left),top:l-(this.margin.top+this.cursorAt.top)}},e.prototype.getCoordinates=function(i){return i.type.indexOf("touch")>-1?i.changedTouches[0]:i},e.prototype.getHelperElement=function(i){var r;return this.clone?this.helper?r=this.helper({sender:i,element:this.target}):(r=St("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(r)):r=this.element,r},e.prototype.setGlobalDroppables=function(i,r,n){this.droppables[this.scope]=i?null:{draggable:r,helper:n,draggedElement:this.element}},e.prototype.checkTargetElement=function(i){var r=this.getProperTargetElement(i),n=this.getDropInstance(r);if(!n&&r&&!m(r.parentNode)){var a=U(r.parentNode,".e-droppable")||r.parentElement;a&&(n=this.getDropInstance(a))}return{target:r,instance:n}},e.prototype.getDropInstance=function(i){var r="getModuleName",n,a=i&&i.ej2_instances;if(a)for(var o=0,l=a;o<l.length;o++){var h=l[o];if(h[""+r]()==="droppable"){n=h;break}}return n},e.prototype.destroy=function(){this.toggleEvents(!0),s.prototype.destroy.call(this)};var t;return Oi([Ee({},tW)],e.prototype,"cursorAt",void 0),Oi([S(!0)],e.prototype,"clone",void 0),Oi([S()],e.prototype,"dragArea",void 0),Oi([S()],e.prototype,"isDragScroll",void 0),Oi([S()],e.prototype,"isReplaceDragEle",void 0),Oi([S(!0)],e.prototype,"isPreventSelect",void 0),Oi([_()],e.prototype,"drag",void 0),Oi([_()],e.prototype,"dragStart",void 0),Oi([_()],e.prototype,"dragStop",void 0),Oi([S(1)],e.prototype,"distance",void 0),Oi([S()],e.prototype,"handle",void 0),Oi([S()],e.prototype,"abort",void 0),Oi([S()],e.prototype,"helper",void 0),Oi([S("default")],e.prototype,"scope",void 0),Oi([S("")],e.prototype,"dragTarget",void 0),Oi([S()],e.prototype,"axis",void 0),Oi([S()],e.prototype,"queryPositionInfo",void 0),Oi([S(!1)],e.prototype,"enableTailMode",void 0),Oi([S(!1)],e.prototype,"skipDistanceCheck",void 0),Oi([S(!0)],e.prototype,"preventDefault",void 0),Oi([S(!1)],e.prototype,"enableAutoScroll",void 0),Oi([S(!1)],e.prototype,"enableTapHold",void 0),Oi([S(750)],e.prototype,"tapHoldThreshold",void 0),Oi([S(!1)],e.prototype,"enableScrollHandler",void 0),e=t=Oi([Ot],e),e}(Xo),iW=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ju=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},rW=function(s){iW(e,s);function e(t,i){var r=s.call(this,i,t)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return e.prototype.bind=function(){this.wireEvents()},e.prototype.wireEvents=function(){I.add(this.element,B.isSafari()?"touchend":B.touchEndEvent,this.intDrop,this)},e.prototype.onPropertyChanged=function(t,i){},e.prototype.getModuleName=function(){return"droppable"},e.prototype.intOver=function(t,i){if(!this.mouseOver){var r=this.dragData[this.scope];this.trigger("over",{event:t,target:i,dragData:r}),this.mouseOver=!0}},e.prototype.intOut=function(t,i){this.mouseOver&&(this.trigger("out",{evt:t,target:i}),this.mouseOver=!1)},e.prototype.intDrop=function(t,i){if(this.dragStopCalled)this.dragStopCalled=!1;else return;var r=!0,n=this.dragData[this.scope],a=n?n.helper&&or(n.helper):!1,o;a&&(o=this.isDropArea(t,n.helper,i),this.accept&&(r=fI(n.helper,this.accept))),a&&this.drop&&o.canDrop&&r&&this.trigger("drop",{event:t,target:o.target,droppedElement:n.helper,dragData:n}),this.mouseOver=!1},e.prototype.isDropArea=function(t,i,r){var n={canDrop:!0,target:r||t.target},a=t.type==="touchend";if(a||n.target===i){i.style.display="none";var o=a?t.changedTouches[0]:t,l=document.elementFromPoint(o.clientX,o.clientY);n.canDrop=!1,n.canDrop=pI(l,this.element),n.canDrop&&(n.target=l),i.style.display=""}return n},e.prototype.destroy=function(){I.remove(this.element,B.isSafari()?"touchend":B.touchEndEvent,this.intDrop),s.prototype.destroy.call(this)},ju([S()],e.prototype,"accept",void 0),ju([S("default")],e.prototype,"scope",void 0),ju([_()],e.prototype,"drop",void 0),ju([_()],e.prototype,"over",void 0),ju([_()],e.prototype,"out",void 0),e=ju([Ot],e),e}(Xo),nW=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),tm=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},sW={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},wr=function(s){nW(e,s);function e(i,r){var n=s.call(this,r,i)||this;return n.keyPressHandler=function(a){for(var o=a.altKey,l=a.ctrlKey,h=a.shiftKey,u=a.which,c=Object.keys(n.keyConfigs),d=0,p=c;d<p.length;d++)for(var f=p[d],v=n.keyConfigs[""+f].split(","),g=0,b=v;g<b.length;g++){var y=b[g],C=t.getKeyConfigData(y.trim());o===C.altKey&&l===C.ctrlKey&&h===C.shiftKey&&u===C.keyCode&&(a.action=f,n.keyAction&&n.keyAction(a))}},n.bind(),n}t=e,e.prototype.destroy=function(){this.unwireEvents(),s.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(i,r){},e.prototype.bind=function(){this.wireEvents()},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},e.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},e.getKeyConfigData=function(i){if(i in this.configCache)return this.configCache[""+i];var r=i.toLowerCase().split("+"),n={altKey:r.indexOf("alt")!==-1,ctrlKey:r.indexOf("ctrl")!==-1,shiftKey:r.indexOf("shift")!==-1,keyCode:null};return r[r.length-1].length>1&&Number(r[r.length-1])?n.keyCode=Number(r[r.length-1]):n.keyCode=t.getKeyCode(r[r.length-1]),t.configCache[""+i]=n,n},e.getKeyCode=function(i){return sW[""+i]||i.toUpperCase().charCodeAt(0)};var t;return e.configCache={},tm([S({})],e.prototype,"keyConfigs",void 0),tm([S("keyup")],e.prototype,"eventName",void 0),tm([_()],e.prototype,"keyAction",void 0),e=t=tm([Ot],e),e}(Xo),In=function(){function s(e,t,i){this.controlName=e,this.localeStrings=t,this.setLocale(i||Df)}return s.prototype.setLocale=function(e){var t=this.intGetControlConstant(s.locale,e);this.currentLocale=t||this.localeStrings},s.load=function(e){this.locale=me(this.locale,e,{},!0)},s.prototype.getConstant=function(e){return m(this.currentLocale[""+e])?this.localeStrings[""+e]||"":this.currentLocale[""+e]},s.prototype.intGetControlConstant=function(e,t){return e[""+t]?e[""+t][this.controlName]:null},s.locale={},s}(),IP=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Do=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},aW=function(s){IP(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Do([S(50)],e.prototype,"swipeThresholdDistance",void 0),e}(ke),oW=/(Up|Down)/,Pn=function(s){IP(e,s);function e(t,i){var r=s.call(this,i,t)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(n){if(r.touchAction===!0){var a=r.updateChangeTouches(n);n.changedTouches!==void 0&&(r.touchAction=!1),r.isTouchMoved=!1,r.movedDirection="",r.startPoint=r.lastMovedPoint={clientX:a.clientX,clientY:a.clientY},r.startEventData=a,r.hScrollLocked=r.vScrollLocked=!1,r.tStampStart=Date.now(),r.timeOutTapHold=setTimeout(function(){r.tapHoldEvent(n)},r.tapHoldThreshold),I.add(r.element,B.touchMoveEvent,r.moveEvent,r),I.add(r.element,B.touchEndEvent,r.endEvent,r),I.add(r.element,B.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(n){var a=r.updateChangeTouches(n);r.movedPoint=a,r.isTouchMoved=!(a.clientX===r.startPoint.clientX&&a.clientY===r.startPoint.clientY);var o={};if(r.isTouchMoved){clearTimeout(r.timeOutTapHold),r.calcScrollPoints(n);var l={startEvents:r.startEventData,originalEvent:n,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(a)};o=me(o,{},l),r.trigger("scroll",o),r.lastMovedPoint={clientX:a.clientX,clientY:a.clientY}}},r.cancelEvent=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap),r.tapCount=0,r.swipeFn(n),I.remove(r.element,B.touchCancelEvent,r.cancelEvent)},r.endEvent=function(n){r.swipeFn(n),r.isTouchMoved||typeof r.tap=="function"&&(r.trigger("tap",{originalEvent:n,tapCount:++r.tapCount}),r.timeOutTap=setTimeout(function(){r.tapCount=0},r.tapThreshold)),r.modeclear()},r.swipeFn=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap);var a=r.updateChangeTouches(n),o=a.clientX-r.startPoint.clientX,l=a.clientY-r.startPoint.clientY;o=Math.floor(o<0?-1*o:o),l=Math.floor(l<0?-1*l:o),r.isTouchMoved=o>1||l>1;var h=/Firefox/.test(B.userAgent);h&&a.clientX===0&&a.clientY===0&&n.type==="mouseup"&&(r.isTouchMoved=!1),r.endPoint=a,r.calcPoints(n);var u={originalEvent:n,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(a)};if(r.isTouchMoved){var c=void 0,d=r.swipeSettings.swipeThresholdDistance;c=me(c,r.defaultArgs,u);var p=!1,f=r.element,v=r.isScrollable(f),g=oW.test(r.movedDirection);(d<r.distanceX&&!g||d<r.distanceY&&g)&&(v?p=r.checkSwipe(f,g):p=!0),p&&r.trigger("swipe",c)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout(function(){r.touchAction=!0},typeof r.tap!="function"?0:20),r.lastTapTime=new Date().getTime(),I.remove(r.element,B.touchMoveEvent,r.moveEvent),I.remove(r.element,B.touchEndEvent,r.endEvent),I.remove(r.element,B.touchCancelEvent,r.cancelEvent)},r.bind(),r}return e.prototype.onPropertyChanged=function(t,i){},e.prototype.bind=function(){this.wireEvents(),B.isIE&&this.element.classList.add("e-block-touch")},e.prototype.destroy=function(){this.unwireEvents(),s.prototype.destroy.call(this)},e.prototype.wireEvents=function(){I.add(this.element,B.touchStartEvent,this.startEvent,this)},e.prototype.unwireEvents=function(){I.remove(this.element,B.touchStartEvent,this.startEvent)},e.prototype.getModuleName=function(){return"touch"},e.prototype.isScrollable=function(t){var i=getComputedStyle(t),r=i.overflow+i.overflowX+i.overflowY;return!!/(auto|scroll)/.test(r)},e.prototype.tapHoldEvent=function(t){this.tapCount=0,this.touchAction=!0;var i;I.remove(this.element,B.touchMoveEvent,this.moveEvent),I.remove(this.element,B.touchEndEvent,this.endEvent),i={originalEvent:t},this.trigger("tapHold",i),I.remove(this.element,B.touchCancelEvent,this.cancelEvent)},e.prototype.calcPoints=function(t){var i=this.updateChangeTouches(t);this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=i.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=i.clientY<this.startPoint.clientY?"Up":"Down"},e.prototype.calcScrollPoints=function(t){var i=this.updateChangeTouches(t);this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||this.hScrollLocked===!0)&&this.vScrollLocked===!1?(this.scrollDirection=i.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=i.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},e.prototype.getVelocity=function(t){var i=t.clientX,r=t.clientY,n=Date.now(),a=i-this.startPoint.clientX,o=r-this.startPoint.clientX,l=n-this.tStampStart;return Math.sqrt(a*a+o*o)/l},e.prototype.checkSwipe=function(t,i){var r=["scroll","offset"],n=i?["Height","Top"]:["Width","Left"];return t[r[0]+n[0]]<=t[r[1]+n[0]]?!0:t[r[0]+n[1]]===0||t[r[1]+n[0]]+t[r[0]+n[1]]>=t[r[0]+n[0]]},e.prototype.updateChangeTouches=function(t){var i=t.changedTouches&&t.changedTouches.length!==0?t.changedTouches[0]:t;return i},Do([_()],e.prototype,"tap",void 0),Do([_()],e.prototype,"tapHold",void 0),Do([_()],e.prototype,"swipe",void 0),Do([_()],e.prototype,"scroll",void 0),Do([S(350)],e.prototype,"tapThreshold",void 0),Do([S(750)],e.prototype,"tapHoldThreshold",void 0),Do([Ee({},aW)],e.prototype,"swipeSettings",void 0),e=Do([Ot],e),e}(Xo),lW=new RegExp("\\n\\s+|(?<=>)\\s{1,}(?=<)","g"),hW=new RegExp(/'|"/g),uW=new RegExp("if ?\\("),cW=new RegExp("else if ?\\("),wA=new RegExp("else"),dW=new RegExp("for ?\\("),MA=new RegExp("(/if|/for)"),pW=new RegExp("\\((.*)\\)",""),mI=new RegExp("^[0-9]+$","g"),fW=new RegExp(`[\\w"'.\\s+]+`,"g"),vW=new RegExp('"(.*?)"',"g"),mW=new RegExp(`[\\w"'@#$.\\s-+]+`,"g"),gW=new RegExp("\\${([^}]*)}","g"),yW=/^\..*/gm,Gw=/\\/gi,bW=/\\\\/gi,CW=new RegExp(`[\\w"'@#$.\\s+]+`,"g"),SW=/\window\./gm;function xW(s,e,t){if(typeof s=="function")return s;var i="data",r=wW(s,i,e,t),n=`var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-■\\s]+)['])/g);
        var hrefRegex = (/(?:href)([\\s='"./]+)([\\w-./?=&\\\\#"]+)((.)([\\w)(!-;/?-■\\s]+)['])/g);
        if(str.match(valueRegEx)){
            var check = str.match(valueRegEx);
            var str1 = str;
            for (var i=0; i < check.length; i++) {
                var check1 = str.match(valueRegEx)[i].split('value=')[1];
                var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                str1 = str1.replace(check1, change);
            }
            str = str.replace(str, str1);
        }
        else if (str.match(/(?:href='')/) === null) {
            if(str.match(hrefRegex)) {
                var check = str.match(hrefRegex);
                var str1 = str;
                for (var i=0; i < check.length; i++) {
                    var check1 = str.match(hrefRegex)[i].split('href=')[1];
                    if (check1) {
                        var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                        change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                        str1 = str1.replace(check1, change);
                    }
                }
                str = str.replace(str, str1);
            }
        }
        `,a='var str="'+r+'";'+n+" return str;",o=new Function(i,a);return o.bind(e)}function wW(s,e,t,i){var r=0,n=[],a=s.match(/class="([^"]+|)\s{2}/g),o="";return a&&a.forEach(function(l){o=l.replace(/\s\s+/g," "),s=s.replace(l,o)}),s.replace(lW,"").replace(vW,"'$1'").replace(gW,function(l,h,u,c){var d=/@|#|\$/gm,p=h.match(pW);if(p){var f=p[1];if(cW.test(h))h='";} '+h.replace(p[1],f.replace(fW,function(M){return M=M.trim(),tc(M,!hW.test(M)&&n.indexOf(M)===-1,e,n,i)}))+`{ 
 str = str + "`;else if(uW.test(h))h='"; '+h.replace(p[1],f.replace(mW,function(M){return IA(M,e,n,i)}))+`{ 
 str = str + "`;else if(dW.test(h)){var v=p[1].split(" of ");h='"; '+h.replace(p[1],function(M){return n.push(v[0]),n.push(v[0]+"Index"),r=r+1,"var i"+r+"=0; i"+r+" < "+tc(v[1],!0,e,n,i)+".length; i"+r+"++"})+`{ 
 `+v[0]+"= "+tc(v[1],!0,e,n,i)+"[i"+r+`]; 
 var `+v[0]+"Index=i"+r+`; 
 str = str + "`}else{var g=h.split("("),b=t&&t.hasOwnProperty(g[0])?"this.":"global";b=/\./.test(g[0])?"":b;var y=p[1].split(",");p[1].length!==0&&!/data/.test(y[0])&&!/window./.test(y[0])&&(p[1]=b==="global"?e+"."+p[1]:p[1]);var C=/@|\$|#/gm,x=/\]\./gm;if(SW.test(h)&&x.test(h)||C.test(h)){var w=/@|\$|#|\]\./gm;w.test(h)&&(h='"+ '+(b==="global"?"":b)+h.replace(p[1],f.replace(CW,function(M){return IA(M,e,n,i)}))+'+ "')}else h='" + '+(b==="global"?"":b)+h.replace(f,tc(p[1].replace(/,( |)data.|,/gi,","+e+".").replace(/,( |)data.window/gi,",window"),b!=="global",e,n,i))+'+"'}}else wA.test(h)?h='"; '+h.replace(wA,`} else { 
 str = str + "`):h.match(MA)?h=h.replace(MA,`"; 
 } 
 str = str + "`):d.test(h)?(h.match(Gw)&&(h=EA(h)),h='"+'+$w(h,n.indexOf(h)===-1,e,n)+'"]+"'):h.match(Gw)?(h=EA(h),h='"+'+$w(h,n.indexOf(h)===-1,e,n)+'"]+"'):h=h!==""?'"+'+tc(h.replace(/,/gi,"+"+e+"."),n.indexOf(h)===-1,e,n,i)+'+"':"${}";return h})}function tc(s,e,t,i,r){return e&&!mI.test(s)&&i.indexOf(s.split(".")[0])===-1&&!r&&s!=="true"&&s!=="false"?t+"."+s:s}function MW(s,e,t,i){var r=/^\..*/gm;return e&&!mI.test(s)&&i.indexOf(s.split(".")[0])===-1&&!r.test(s)?t+"."+s:s}function $w(s,e,t,i){return e&&!mI.test(s)&&i.indexOf(s.split(".")[0])===-1?t+'["'+s:s}function EA(s){var e="\\\\";return s.match(bW)?s=s:s=s.replace(Gw,e),s}function IA(s,e,t,i){s=s.trim();var r=/\window\./gm;if(r.test(s))return s;var n=/'|"/gm,a=/@|\$|#/gm;return a.test(s)&&(s=$w(s,t.indexOf(s)===-1,e,t)+'"]'),yW.test(s)?MW(s,!n.test(s)&&t.indexOf(s)===-1,e,t):tc(s,!n.test(s)&&t.indexOf(s)===-1,e,t,i)}var EW=/^[\n\r.]+<tr|^<tr/,IW=/^[\n\r.]+<svg|^<path|^<g/;function TW(){return"-"+Math.random().toString(36).substr(2,5)}function pi(s,e,t){var i=gI.compile(s,e,t);return function(r,n,a,o,l,h,u,c){var d=i(r,n,a,u,c);if(typeof d=="string")if(IW.test(d)){var p=St("svg",{innerHTML:d});return p.childNodes}else{var p=St(EW.test(d)?"table":"div",{innerHTML:d});return p.childNodes}else return d}}function Yp(s,e,t){var i=document.getElementById(s);if(i)for(var r=i.getElementsByClassName("blazor-inner-template"),n=0;n<r.length;n++){var a=" ";m(t)?a=r[parseInt(n.toString(),10)].getAttribute("data-templateId"):a=r[parseInt(t.toString(),10)].getAttribute("data-templateId");var o=document.getElementById(a);if(o)for(var l=o.childNodes.length,h=0;h<l;h++)m(t)?r[parseInt(n.toString(),10)].appendChild(o.childNodes[0]):(r[parseInt(t.toString(),10)].appendChild(o.childNodes[0]),n=r.length)}}function DW(s){gI.compile=s.compile}function AW(){return gI.compile}function wy(s,e){var t;return s.prototype.CSPTemplate=!0,m(e)?t=s:(t=s.bind(e),t.prototype=Object.create(s.prototype)),t}var NW=function(){function s(){}return s.prototype.compile=function(e,t,i){return t===void 0&&(t={}),xW(e,t)},s}(),gI={compile:new NW().compile},kW=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],LW=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],TA=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","oncanplay","oncanplaythrough","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeypress","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onstart","onpropertychange","oncopy","ontoggle","onpointerout","onpointermove","onpointerleave","onpointerenter","onpointerrawupdate","onpointerover","onbeforecopy","onbeforecut","onbeforeinput"],Fi=function(){function s(){}return s.beforeSanitize=function(){return{selectors:{tags:kW,attributes:LW}}},s.sanitize=function(e){var t=this.beforeSanitize(),i=this.serializeValue(t,e);return i},s.serializeValue=function(e,t){this.removeAttrs=e.selectors.attributes,this.removeTags=e.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=t,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),i.replace(/&amp;/g,"&")},s.removeElement=function(){for(var e=this.wrapElement.children,t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)].attributes,r=0;r<i.length;r++)this.wrapElement.children[parseInt(t.toString(),10)].removeAttribute(i[parseInt(r.toString(),10)].localName)},s.removeXssTags=function(){var e=this.wrapElement.querySelectorAll(this.removeTags.join(","));if(e.length>0)e.forEach(function(t){ne(t)});else return},s.removeJsEvents=function(){var e=this.wrapElement.querySelectorAll("["+TA.join("],[")+"]");if(e.length>0)e.forEach(function(t){TA.forEach(function(i){t.hasAttribute(i)&&t.removeAttribute(i)})});else return},s.removeXssAttrs=function(){var e=this;this.removeAttrs.forEach(function(t,i){var r=e.wrapElement.querySelectorAll(t.selector);r.length>0&&r.forEach(function(n){n.removeAttribute(t.attribute)})})},s}(),OW=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),RW=["alt","className","disabled","form","id","readOnly","style","tabIndex","title","type","name","onClick","onFocus","onBlur"],FW=["accordion","tab","splitter"],PW=new RegExp("]"),zW=function(s){OW(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.mountingState=!1,t.attrKeys=[],t.cachedTimeOut=0,t.isAppendCalled=!1,t.initRenderCalled=!1,t.isReactForeceUpdate=!1,t.isReact=!0,t.isshouldComponentUpdateCalled=!1,t.isCreated=!1,t}return e.prototype.componentDidMount=function(){this.refreshChild(!0),this.canDelayUpdate=FW.indexOf(this.getModuleName())!==-1,this.renderReactComponent(),this.portals&&this.portals.length&&(this.mountingState=!0,this.renderReactTemplates(),this.mountingState=!1)},e.prototype.componentDidUpdate=function(t){!this.isshouldComponentUpdateCalled&&this.initRenderCalled&&!this.isReactForeceUpdate&&t!==this.props&&(this.isshouldComponentUpdateCalled=!0,this.updateProperties(this.props,!1,t))},e.prototype.renderReactComponent=function(){var t=this.reactElement;t&&!this.isAppendCalled&&(this.isAppendCalled=!0,this.appendTo(t))},e.prototype.shouldComponentUpdate=function(t){return this.isshouldComponentUpdateCalled=!0,this.initRenderCalled?(this.isAppendCalled||(clearTimeout(this.cachedTimeOut),this.isAppendCalled=!0,this.appendTo(this.reactElement)),this.updateProperties(t),!0):(this.updateProperties(t,!0),!0)},e.prototype.updateProperties=function(t,i,r){for(var n=this,a=me({},t),o=Object.keys(t),l=me({},r||this.props),h=m(l.statelessTemplates)?m(this.statelessTemplateProps)?[]:this.statelessTemplateProps:l.statelessTemplates,u=0,c=o;u<c.length;u++){var d=c[u],p=d==="className";if(d!=="children")if(!p&&!m(this.htmlattributes[""+d])&&this.htmlattributes[""+d]!==a[""+d]&&(this.htmlattributes[""+d]=a[""+d]),this.compareValues(l[""+d],t[""+d]))delete a[""+d];else if(this.attrKeys.indexOf(d)!==-1)if(p){this.clsName=!0;for(var f=l[""+d].split(" "),v=0;v<f.length;v++)this.element.classList.remove(f[parseInt(v.toString(),10)]);for(var g=a[""+d].split(" "),b=0;b<g.length;b++)this.element.classList.add(g[parseInt(b.toString(),10)])}else d!=="disabled"&&!this.properties.hasOwnProperty(d)&&delete a[""+d];else(d==="value"&&t[""+d]===this[""+d]||h.indexOf(d)>-1&&(d==="content"&&typeof a[""+d]=="function"||t[""+d].toString()===this[""+d].toString()))&&delete a[""+d]}a.children&&delete a.children,this.initRenderCalled&&(this.canDelayUpdate||l.delayUpdate)?setTimeout(function(){n.refreshProperties(a,t,i)}):this.refreshProperties(a,t,i)},e.prototype.refreshProperties=function(t,i,r){var n=m(this.props.statelessTemplates)?[]:this.props.statelessTemplates;Object.keys(t).length&&(r||this.processComplexTemplate(t,this),this.setProperties(t,r)),n.indexOf("directiveTemplates")===-1&&this.refreshChild(r,i)},e.prototype.processComplexTemplate=function(t,i){var r=i.complexTemplate;if(r)for(var n in r){var a=r[""+n];t[""+n]&&kt(a,ie(n,t),t)}},e.prototype.getDefaultAttributes=function(){var t=this;this.isReact=!0;var i=Object.keys(this.props),r=["children","statelessTemplates","immediateRender","isLegacyTemplate","delayUpdate"];this.htmlattributes||(this.htmlattributes={}),this.attrKeys=RW.concat(this.controlAttributes||[]);for(var n=0,a=i;n<a.length;n++){var o=a[n];(o.indexOf("data-")!==-1||o.indexOf("aria-")!==-1||this.attrKeys.indexOf(o)!==-1||Object.keys(this.properties).indexOf(""+o)===-1&&r.indexOf(""+o)===-1)&&this.htmlattributes[""+o]!==this.props[""+o]&&(this.htmlattributes[""+o]=this.props[""+o])}if(!this.htmlattributes.ref){this.htmlattributes.ref=function(d){t.reactElement=d};var l=["autocomplete","combobox","dropdownlist","dropdowntree","multiselect","listbox","colorpicker","numerictextbox","textbox","uploader","maskedtextbox","slider","datepicker","datetimepicker","daterangepicker","timepicker","checkbox","switch","radio","rating"];l.indexOf(this.getModuleName())!==-1&&(this.htmlattributes.key=""+e.reactUid,e.reactUid++,this.type&&!this.htmlattributes.type&&(this.htmlattributes.type=this.multiline?"hidden":this.type),this.name&&!this.htmlattributes.name&&(this.htmlattributes.name=this.name))}if(this.clsName){for(var h=this.element.classList,u=this.htmlattributes.className,c=0;c<h.length;c++)u.indexOf(h[parseInt(c.toString(),10)])===-1&&(this.htmlattributes.className=this.htmlattributes.className+" "+h[parseInt(c.toString(),10)]);this.clsName=!1}return this.htmlattributes},e.prototype.trigger=function(t,i,r){var n=this;if(this.isDestroyed!==!0&&this.modelObserver){if(PW.test(t)){var a=ie(t,this);a?(a.call(this,i),r&&r.call(this,i)):r&&r.call(this,i)}(t==="change"||t==="input")&&this.props.onChange&&i.event&&this.props.onChange.call(void 0,{syntheticEvent:i.event,nativeEvent:{text:i.value},value:i.value,target:this});var o=this.isProtectedOnChange;this.isProtectedOnChange=!1,t==="created"?setTimeout(function(){n.isCreated=!0,n.isDestroyed||n.modelObserver.notify(t,i,r)},10):this.modelObserver.notify(t,i,r),this.isProtectedOnChange=o}},e.prototype.compareValues=function(t,i){var r=typeof t,n=typeof i;if(r===n){if(t===i)return!0;if((!m(t)&&t.constructor)!==(!m(i)&&i.constructor))return!1;if(t instanceof Date||t instanceof RegExp||t instanceof String||t instanceof Number)return t.toString()===i.toString();if(na(t)||Array.isArray(t)){var a=t,o=i;return na(a)&&(a=[t],o=[i]),this.compareObjects(a,o).status}if(t.constructor&&t.constructor.name===i.constructor.name&&(t.constructor.name==="Query"||t.constructor.name==="DataManager")&&JSON.stringify(t)===JSON.stringify(i))return!0}return!1},e.prototype.compareObjects=function(t,i,r){var n=!0,a=t.length===i.length,o=[],l=m(this.templateProps)?[]:this.templateProps;if(a)for(var h=0,u=i.length;h<u;h++){var c={},d=t[parseInt(h.toString(),10)],p=i[parseInt(h.toString(),10)],f=Object.keys(p);if(f.length!==0)for(var v=0,g=f;v<g.length;v++){var b=g[v],y=d[""+b],C=p[""+b];if(b==="items"){for(var x=0;x<C.length;x++)if(this.getModuleName()==="richtexteditor"&&typeof C[parseInt(x.toString(),10)]=="object")return{status:!0}}if(this.getModuleName()==="grid"&&b==="field"&&(c[""+b]=C),!d.hasOwnProperty(b)||!(l.length>0&&l.indexOf(""+b)===-1&&typeof C=="function"?this.compareValues(y.toString(),C.toString()):this.compareValues(y,C))){if(!r)return{status:!1};n=!1,c[""+b]=C}}else if(i[parseInt(h.toString(),10)]===t[parseInt(h.toString(),10)])n=!0;else{if(!r)return{status:!1};n=!1}this.getModuleName()==="grid"&&r==="columns"&&m(c.field)&&(c.field=void 0),Object.keys(c).length&&o.push({index:h,value:c,key:r})}else n=!1;return{status:n,changedProperties:o}},e.prototype.refreshChild=function(t,i){if(this.checkInjectedModules){for(var r=this.getInjectedModules()||[],n=this.getInjectedServices()||[],a=0,o=n;a<o.length;a++){var l=o[a];r.indexOf(l)===-1&&r.push(l)}this.injectedModules=r}if(this.directivekeys){var h=[],u=this.validateChildren({},this.directivekeys,i||this.props);if(u&&Object.keys(u).length){if(!t&&this.skipRefresh)for(var c=0,d=this.skipRefresh;c<d.length;c++){var p=d[c];delete u[""+p]}if(this.prevProperties)for(var f=Object.keys(this.prevProperties),v=0;v<f.length;v++){var g=f[parseInt(v.toString(),10)];if(u.hasOwnProperty(g)){var b=this.compareObjects(this.prevProperties[""+g],u[""+g],g);if(b.status)delete u[""+g];else{b.changedProperties.length&&(h=h.concat(b.changedProperties));var y={};y[""+g]=u[""+g],this.prevProperties=me(this.prevProperties,y)}}}else this.prevProperties=me({},u,{},!0);if(h.length)if(this.getModuleName()==="grid"&&g==="columns")for(var C=0,x=this.columns;C<x.length;C++){var w=ie("field",x[parseInt(C.toString(),10)]),M=ie(C+".value.field",h);if(w===M){var E=ie(h[parseInt(C.toString(),10)].key+"."+h[parseInt(C.toString(),10)].index,this);E&&E.setProperties?E.setProperties(h[parseInt(C.toString(),10)].value):me(E,h[parseInt(C.toString(),10)].value)}else this.setProperties(u,t)}else for(var T=0,D=h;T<D.length;T++){var N=D[T],A=ie(N.key+"."+N.index,this);A&&A.setProperties?A.setProperties(N.value):me(A,N.value)}else this.setProperties(u,t)}}},e.prototype.componentWillUnmount=function(){clearTimeout(this.cachedTimeOut);var t=["dropdowntree","checkbox"];this.initRenderCalled&&this.isAppendCalled&&this.element&&(t.indexOf(this.getModuleName())||document.body.contains(this.element))&&!this.isDestroyed&&this.isCreated&&this.destroy(),sd.offIntlEvents()},e.prototype.appendReactElement=function(t,i){var r=nb.createPortal(t,i);this.portals?this.portals.push(r):this.portals=[r]},e.prototype.renderReactTemplates=function(t){this.isReactForeceUpdate=!0,t?this.forceUpdate(t):this.forceUpdate(),this.isReactForeceUpdate=!1},e.prototype.clearTemplate=function(t,i,r){var n=this;t&&t.length?Array.prototype.forEach.call(t,function(a){if(n.portals.forEach(function(l){l.propName}),!m(i)&&n.portals[i]&&n.portals[i].propName===a)n.portals.splice(i,1);else for(var o=0;o<n.portals.length;o++)n.portals[parseInt(o.toString(),10)].propName===a&&(n.portals.splice(o,1),o--)}):this.portals=[],this.renderReactTemplates(r)},e.prototype.validateChildren=function(t,i,r){for(var n=!1,a=le.Children.toArray(r.children),o=0,l=a;o<l.length;o++){var h=l[o],u=this.getChildType(h),c=i[""+u];if(u&&i){var d=this.getChildProps(le.Children.toArray(h.props.children),c);d.length&&(n=!0,t[h.type.propertyName||u]=d)}}return n?t:null},e.prototype.getChildType=function(t){return t.type&&t.type.isDirective&&t.type.moduleName||""},e.prototype.getChildProps=function(t,i){for(var r=[],n=0,a=t;n<a.length;n++){var o=a[n],l=!1,h=void 0;typeof i=="string"?(l=!0,h=i):h=Object.keys(i)[0];var u=o.props,c=this.getChildType(o);if(c===h)if(l||!u.children){var d=me({},u,{},!0);this.processComplexTemplate(d,o.type),r.push(d)}else{var p=this.validateChildren(me({},u),i[""+h],u)||u;p.children&&delete p.children,this.processComplexTemplate(p,o.type),r.push(p)}}return r},e.prototype.getInjectedServices=function(){for(var t=le.Children.toArray(this.props.children),i=0,r=t;i<r.length;i++){var n=r[i];if(n.type&&n.type.isService)return n.props.services}return[]},e.reactUid=1,e}(le.Component);function jW(s,e){e.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){i!=="isMounted"&&i!=="replaceState"&&(s.prototype[""+i]=t.prototype[""+i])})})}var BW=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(s){BW(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(){return null},e.isDirective=!0,e})(le.PureComponent);var HW=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(s){HW(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(){return null},e.isService=!0,e})(le.PureComponent);var VW=AW();function UW(s,e){return typeof s=="string"||s.prototype&&s.prototype.CSPTemplate&&typeof s=="function"?VW(s,e):function(t,i,r,n){var a=s,o=t;typeof a=="object"&&(a=s.template,o=me({},t,s.data||{}));var l;n?l=n:l=document.createElement("div");var h=le.createElement(a,o),u=nb.createPortal(h,l);if(u.propName=r,i.portals?i.portals.push(u):i.portals=[u],!n)return[l]}}DW({compile:UW});function ee(s){var e,t=[];s=s.indexOf("!")>-1?s.split("!")[1]:s,s=s.indexOf(":")===-1?s+":"+s:s;var i=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g);if(!i.test(s)){var r=s.split(":");s=m(s.match(/[0-9]/))?r[0]+"1:"+r[1]+"1":"A"+r[0]+":A"+r[1]}return s.split(":").forEach(function(n){e=xe(n),t.push(e[0]),t.push(e[1])}),t}function xe(s){return[parseInt(s.match(/\d+/)[0],10)-1,Rn(s.match(/[A-Z]+/i)[0].toUpperCase())]}function Rn(s){var e=0;s=s.split("").reverse().join("");for(var t=s.length-1;t>=0;t--)e+=(s[t].charCodeAt(0)-64)*Math.pow(26,t);return e-1}function Je(s,e){return Ur(e+1)+(s+1)}function je(s){return Je(s[0],s[1])+":"+(m(s[2])?Je(s[0],s[1]):Je(s[2],s[3]))}function Ur(s){var e="Z";return s/26>1?Ur(s%26===0?s/26-1:Math.floor(s/26))+String.fromCharCode(s%26===0?e.charCodeAt(0):64+s%26):String.fromCharCode(64+s)}function ir(s){return ee(nu(s))}function nu(s){return s.split("!")[1]||s}function _W(s){return s.name+"!"+s.selectedRange}function TP(s,e){return{sheetIndex:La(s,e),indices:ir(e)}}function La(s,e){var t;return e.indexOf("!")>-1?t=gt(s,Ms(e)):t=s.activeSheetIndex,t}function lt(s){var e=s.slice();return s[0]>s[2]&&DA(e,0,2),s[1]>s[3]&&DA(e,1,3),e}function DA(s,e,t){var i=s[e];s[e]=s[t],s[t]=i}function Af(s){return s[0]===s[2]&&s[1]===s[3]}function zC(s,e,t,i,r){return new WW(s,e,t,i,r)}var WW=function(){function s(e,t,i,r,n){this.preventCallback=!1,this.context=e,this.workerTask=t,this.defaultListener=i,this.workerData=r,n&&(this.preventCallback=!0),this.initWorker()}return s.prototype.terminate=function(){this.worker.terminate(),URL.revokeObjectURL(this.workerUrl)},s.prototype.initWorker=function(){var e=new Blob([this.getFnCode()],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(e),this.worker=new Worker(this.workerUrl),this.worker.onmessage=this.messageFromWorker.bind(this),this.worker.onerror=this.onError.bind(this),this.worker.postMessage(this.workerData)},s.prototype.messageFromWorker=function(e){this.terminate(),this.defaultListener.apply(this.context,[e.data])},s.prototype.onError=function(e){if(this.terminate(),e.message&&e.message.includes("FormData"))this.defaultListener.apply(this.context,[{isFormDataError:!0}]);else throw e.message||e},s.prototype.getFnCode=function(){var e="",t,i,r="",n=!1;if(typeof this.workerTask=="function")this.workerTask.toString().indexOf("function")<0?r="function "+this.workerTask.toString():(r=this.workerTask.toString(),n=!0),e+="self.workerTask = "+r+`; 
`;else if(typeof this.workerTask=="object")for(i=Object.keys(this.workerTask),t=0;t<i.length;t++)this.workerTask[i[t]].toString().indexOf("function")<0?r="function "+this.workerTask[i[t]].toString():(r=this.workerTask[i[t]].toString(),n=!0),e+=(t===0?"self.workerTask":i[t])+"= "+r+`; 
`;return e+="self.onmessage = "+(n?"":" function ")+(this.preventCallback?this.getMessageFn.toString():this.getCallbackMessageFn.toString())+`; 
`,e},s.prototype.getCallbackMessageFn=function(e){postMessage(this.workerTask.apply(this,e.data))},s.prototype.getMessageFn=function(e){this.workerTask.apply(this,e.data)},s}(),$e=function(){function s(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="",typeof e=="string"?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return s.prototype.setKey=function(e){return this.key=e,this},s.prototype.using=function(e){return this.dataManager=e,this},s.prototype.execute=function(e,t,i,r){return e=e||this.dataManager,e?e.executeQuery(this,t,i,r):ce.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},s.prototype.executeLocal=function(e){return e=e||this.dataManager,e?e.executeLocal(this):ce.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},s.prototype.clone=function(){var e=new s;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e},s.prototype.from=function(e){return this.fromTable=e,this},s.prototype.addParams=function(e,t){return typeof t=="function"?this.params.push({key:e,fn:t}):this.params.push({key:e,value:t}),this},s.prototype.distinct=function(e){return typeof e=="string"?this.distincts=[].slice.call([e],0):this.distincts=e.slice(0),this},s.prototype.expand=function(e){return typeof e=="string"?this.expands=[].slice.call([e],0):this.expands=e.slice(0),this},s.prototype.where=function(e,t,i,r,n,a){t=t?t.toLowerCase():null;var o=null;return typeof e=="string"?o=new It(e,t,i,r,n,a):e instanceof It&&(o=e),this.queries.push({fn:"onWhere",e:o}),this},s.prototype.search=function(e,t,i,r,n){typeof t=="string"&&(t=[t]),(!i||i==="none")&&(i="contains");var a=ce.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:i,searchKey:e,ignoreCase:r,ignoreAccent:n,comparer:a}}),this},s.prototype.sortBy=function(e,t,i){return this.sortByForeignKey(e,t,i)},s.prototype.sortByForeignKey=function(e,t,i,r){var n=m(r)?"ascending":r,a,o;if(typeof e=="string"&&ce.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),(!t||typeof t=="string")&&(n=t?t.toLowerCase():"ascending",t=ce.fnSort(t)),i){a=s.filterQueries(this.queries,"onSortBy");for(var l=0;l<a.length;l++)if(o=a[l].e.fieldName,typeof o=="string"){if(o===e)return this}else if(o instanceof Array){for(var h=0;h<o.length;h++)if(o[h]===e||e.toLowerCase()===o[h]+" desc")return this}}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:n}}),this},s.prototype.sortByDesc=function(e){return this.sortBy(e,"descending")},s.prototype.group=function(e,t,i){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:i||null}}),this},s.prototype.page=function(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this},s.prototype.range=function(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this},s.prototype.take=function(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this},s.prototype.skip=function(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this},s.prototype.select=function(e){return typeof e=="string"&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this},s.prototype.hierarchy=function(e,t){return this.subQuerySelector=t,this.subQuery=e,this},s.prototype.foreignKey=function(e){return this.fKey=e,this},s.prototype.requiresCount=function(){return this.isCountRequired=!0,this},s.prototype.aggregate=function(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this},s.filterQueries=function(e,t){return e.filter(function(i){return i.fn===t})},s.filterQueryLists=function(e,t){for(var i=e.filter(function(a){return t.indexOf(a.fn)!==-1}),r={},n=0;n<i.length;n++)r[i[n].fn]||(r[i[n].fn]=i[n].e);return r},s}(),It=function(){function s(e,t,i,r,n,a){return r===void 0&&(r=!1),this.ignoreAccent=!1,this.isComplex=!1,typeof e=="string"?(this.field=e,this.operator=t.toLowerCase(),this.value=i,this.matchCase=a,this.ignoreCase=r,this.ignoreAccent=n,this.isComplex=!1,this.comparer=ce.fnOperators.processOperator(this.operator)):(e instanceof s&&i instanceof s||i instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],this.matchCase=e.matchCase,this.ignoreCase=e.ignoreCase,this.ignoreAccent=e.ignoreAccent,i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}return s.and=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"and")},s.prototype.and=function(e,t,i,r,n){return s.combine(this,e,t,i,"and",r,n)},s.or=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"or")},s.prototype.or=function(e,t,i,r,n){return s.combine(this,e,t,i,"or",r,n)},s.ornot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"or not")},s.prototype.ornot=function(e,t,i,r,n){return s.combine(this,e,t,i,"ornot",r,n)},s.andnot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"and not")},s.prototype.andnot=function(e,t,i,r,n){return s.combine(this,e,t,i,"andnot",r,n)},s.fromJson=function(e){if(e instanceof Array){for(var t=[],i=0,r=e.length;i<r;i++)t.push(this.fromJSONData(e[i]));return t}var n=e;return this.fromJSONData(n)},s.prototype.validate=function(e){var t=this.predicates?this.predicates:[],i,r;if(!this.isComplex&&this.comparer)return this.condition&&this.condition.indexOf("not")!==-1?(this.condition=this.condition.split("not")[0]===""?void 0:this.condition.split("not")[0],!this.comparer.call(this,ce.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent)):this.comparer.call(this,ce.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);this.condition&&this.condition.indexOf("not")!==-1?r=this.condition.indexOf("and")!==-1:r=this.condition==="and";for(var n=0;n<t.length;n++)if(n>0&&this.condition&&this.condition.indexOf("not")!==-1&&(t[n].condition=t[n].condition?t[n].condition+"not":"not"),i=t[n].validate(e),r){if(!i)return!1}else if(i)return!0;return r},s.prototype.toJson=function(){var e,t;if(this.isComplex){e=[],t=this.predicates;for(var i=0;i<t.length;i++)e.push(t[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e,matchCase:this.matchCase}},s.combinePredicates=function(e,t){if(e.length===1){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new s(e[0],t,e.slice(1))},s.combine=function(e,t,i,r,n,a,o){return t instanceof s?s[n](e,t):typeof t=="string"?s[n](e,new s(t,i,r,a,o)):ce.throwError("Predicate - "+n+" : invalid arguments")},s.fromJSONData=function(e){for(var t=e.predicates||[],i=t.length,r=[],n,a=0;a<i;a++)r.push(this.fromJSONData(t[a]));return e.isComplex?n=new s(r[0],e.condition,r.slice(1)):n=new s(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent),n},s}(),AA={GroupGuid:"{271bbba0-1ee7}"},ce=function(){function s(){}return s.getValue=function(e,t){return typeof e=="function"?e.call(t||{}):e},s.endsWith=function(e,t){return e.slice&&e.slice(-t.length)===t},s.notEndsWith=function(e,t){return e.slice&&e.slice(-t.length)!==t},s.startsWith=function(e,t){return e.slice(0,t.length)===t},s.notStartsWith=function(e,t){return e.slice(0,t.length)!==t},s.wildCard=function(e,t){var i,r;if(t.indexOf("[")!==-1&&(t=t.split("[").join("[[]")),t.indexOf("(")!==-1&&(t=t.split("(").join("[(]")),t.indexOf(")")!==-1&&(t=t.split(")").join("[)]")),t.indexOf("\\")!==-1&&(t=t.split("\\").join("[\\\\]")),t.indexOf("*")!==-1){t.charAt(0)!=="*"&&(t="^"+t),t.charAt(t.length-1)!=="*"&&(t=t+"$"),i=t.split("*");for(var n=0;n<i.length;n++)i[n].indexOf(".")===-1?i[n]=i[n]+".*":i[n]=i[n]+"*";t=i.join("")}(t.indexOf("%3f")!==-1||t.indexOf("?")!==-1)&&(r=t.indexOf("%3f")!==-1?t.split("%3f"):t.split("?"),t=r.join("."));var a=new RegExp(t,"g");return a.test(e)},s.like=function(e,t){return t.indexOf("%")!==-1?t.charAt(0)==="%"&&t.lastIndexOf("%")<2?(t=t.substring(1,t.length),s.startsWith(s.toLowerCase(e),s.toLowerCase(t))):t.charAt(t.length-1)==="%"&&t.indexOf("%")>t.length-3?(t=t.substring(0,t.length-1),s.endsWith(s.toLowerCase(e),s.toLowerCase(t))):(t.lastIndexOf("%")!==t.indexOf("%")&&t.lastIndexOf("%")>t.indexOf("%")+1&&(t=t.substring(t.indexOf("%")+1,t.lastIndexOf("%"))),e.indexOf(t)!==-1):!1},s.fnSort=function(e){return e=e?s.toLowerCase(e):"ascending",e==="ascending"?this.fnAscending:this.fnDescending},s.fnAscending=function(e,t){return m(e)&&m(t)||t==null?-1:typeof e=="string"?e.localeCompare(t):e==null?1:e-t},s.fnDescending=function(e,t){return m(e)&&m(t)?-1:t==null?1:typeof e=="string"?e.localeCompare(t)*-1:e==null?-1:t-e},s.extractFields=function(e,t){for(var i={},r=0;r<t.length;r++)i=this.setValue(t[r],this.getObject(t[r],e),i);return i},s.select=function(e,t){for(var i=[],r=0;r<e.length;r++)i.push(this.extractFields(e[r],t));return i},s.group=function(e,t,i,r,n,a,o){r=r||1;var l=e,h="GroupGuid";if(l.GroupGuid===AA[h]){for(var u=function(C){if(m(n))l[C].items=c.group(l[C].items,t,i,l.level+1,null,a,o),l[C].count=l[C].items.length;else{var x=-1,w=n.filter(function(M){return M.key===l[C].key});x=n.indexOf(w[0]),l[C].items=c.group(l[C].items,t,i,l.level+1,n[x].items,a,o),l[C].count=n[x].count}},c=this,d=0;d<l.length;d++)u(d);return l.childLevels+=1,l}var p={},f=[];f.GroupGuid=AA[h],f.level=r,f.childLevels=0,f.records=l;for(var v=function(C){var x=g.getVal(l,C,t);if(m(a)||(x=a(x,t)),!p[x]&&(p[x]={key:x,count:0,items:[],aggregates:{},field:t},f.push(p[x]),!m(n))){var w=n.filter(function(M){return M.key===p[x].key});p[x].count=w[0].count}p[x].count=m(n)?p[x].count+=1:p[x].count,(!o||o&&i.length)&&p[x].items.push(l[C])},g=this,b=0;b<l.length;b++)v(b);if(i&&i.length)for(var y=function(C){for(var x={},w=void 0,M=i,E=0;E<i.length;E++)if(w=s.aggregates[i[E].type],m(n))w&&(x[M[E].field+" - "+M[E].type]=w(f[C].items,M[E].field));else{var T=n.filter(function(D){return D.key===f[C].key});w&&(x[M[E].field+" - "+M[E].type]=w(T[0].items,M[E].field))}f[C].aggregates=x},b=0;b<f.length;b++)y(b);if(o&&f.length&&i.length)for(var b=0;b<f.length;b++)f[b].items=[];return l.length&&f||l},s.buildHierarchy=function(e,t,i,r,n){var a,o={},l;for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),a=0;a<r.length;a++){var h=this.getObject(e,r[a]);l=o[h]||(o[h]=[]),l.push(r[a])}for(a=0;a<i.length;a++){var h=this.getObject(n||e,i[a]);i[a][t]=o[h]}},s.getFieldList=function(e,t,i){if(i===void 0&&(i=""),t==null)return this.getFieldList(e,[],i);for(var r=e,n=Object.keys(e),a=0,o=n;a<o.length;a++){var l=o[a];typeof r[l]=="object"&&!(r[l]instanceof Array)?this.getFieldList(r[l],t,i+l+"."):t.push(i+l)}return t},s.getObject=function(e,t){if(!e)return t;if(t){if(e.indexOf(".")===-1){var i=e.charAt(0).toLowerCase()+e.slice(1),r=e.charAt(0).toUpperCase()+e.slice(1);return m(t[e])?m(t[i])?m(t[r])?null:t[r]:t[i]:t[e]}for(var n=t,a=e.split("."),o=0;o<a.length&&n!=null;o++){if(n=n[a[o]],n===void 0){var l=a[o].charAt(0).toUpperCase()+a[o].slice(1);n=t[l]||t[l.charAt(0).toLowerCase()+l.slice(1)]||null}t=n}return n}},s.setValue=function(e,t,i){var r=e.toString().split("."),n=i||{},a=n,o,l=r.length,h;for(o=0;o<l;o++)h=r[o],o+1===l?a[h]=t===void 0?void 0:t:m(a[h])&&(a[h]={}),a=a[h];return n},s.sort=function(e,t,i){if(e.length<=1)return e;var r=parseInt((e.length/2).toString(),10),n=e.slice(0,r),a=e.slice(r);return n=this.sort(n,t,i),a=this.sort(a,t,i),this.merge(n,a,t,i)},s.ignoreDiacritics=function(e){if(typeof e!="string")return e;var t=e.split(""),i=t.map(function(r){return r in s.diacritics?s.diacritics[r]:r});return i.join("")},s.merge=function(e,t,i,r){for(var n=[],a;e.length>0||t.length>0;)e.length>0&&t.length>0?r?a=r(this.getVal(e,0,i),this.getVal(t,0,i),e[0],t[0])<=0?e:t:a=e[0][i]<e[0][i]?e:t:a=e.length>0?e:t,n.push(a.shift());return n},s.getVal=function(e,t,i){return i?this.getObject(i,e[t]):e[t]},s.toLowerCase=function(e){return e?typeof e=="string"?e.toLowerCase():e.toString():e===0||e===!1?e.toString():""},s.callAdaptorFunction=function(e,t,i,r){if(t in e){var n=e[t](i,r);m(n)||(i=n)}return i},s.getAddParams=function(e,t,i){var r={};return s.callAdaptorFunction(e,"addParams",{dm:t,query:i,params:i.params,reqParams:r}),r},s.isPlainObject=function(e){return!!e&&e.constructor===Object},s.isCors=function(){var e=null,t="XMLHttpRequest";try{e=new window[t]}catch{}return!!e&&"withCredentials"in e},s.getGuid=function(e){var t="0123456789abcdef",i;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(r,n){if("crypto"in window&&"getRandomValues"in crypto){var a=new Uint8Array(1);window.crypto.getRandomValues(a),i=a[0]%16|0}else i=Math.random()*16|0;return t[n===19?i&3|8:i]})},s.isNull=function(e){return e==null},s.getItemFromComparer=function(e,t,i){var r,n,a,o=0,l=typeof s.getVal(e,0,t)=="string";if(e.length)for(;m(r)&&o<e.length;)r=s.getVal(e,o,t),a=e[o++];for(;o<e.length;o++)n=s.getVal(e,o,t),!m(n)&&(l&&(r=+r,n=+n),i(r,n)>0&&(r=n,a=e[o]));return a},s.distinct=function(e,t,i){i=m(i)?!1:i;var r=[],n,a={};return e.forEach(function(o,l){n=typeof e[l]=="object"?s.getVal(e,l,t):e[l],n in a||(r.push(i?e[l]:n),a[n]=1)}),r},s.processData=function(e,t){var i=this.prepareQuery(e),r=new ge(t);e.requiresCounts&&i.requiresCount();var n=r.executeLocal(i),a={result:e.requiresCounts?n.result:n,count:n.count,aggregates:JSON.stringify(n.aggregates)};return e.requiresCounts?a:n},s.prepareQuery=function(e){var t=this,i=new $e;if(e.select&&i.select(e.select),e.where){var r=s.parse.parseJson(e.where);r.filter(function(a){if(m(a.condition))i.where(a.field,a.operator,a.value,a.ignoreCase,a.ignoreAccent);else{var o=[];a.field?o.push(new It(a.field,a.operator,a.value,a.ignoreCase,a.ignoreAccent)):o=o.concat(t.getPredicate(a.predicates)),a.condition==="or"?i.where(It.or(o)):a.condition==="and"&&i.where(It.and(o))}})}if(e.search){var n=s.parse.parseJson(e.search);n.filter(function(a){return i.search(a.key,a.fields,a.operator,a.ignoreCase,a.ignoreAccent)})}return e.aggregates&&e.aggregates.filter(function(a){return i.aggregate(a.type,a.field)}),e.sorted&&e.sorted.filter(function(a){return i.sortBy(a.name,a.direction)}),e.skip&&i.skip(e.skip),e.take&&i.take(e.take),e.group&&e.group.filter(function(a){return i.group(a)}),i},s.getPredicate=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];if(r.field)t.push(new It(r.field,r.operator,r.value,r.ignoreCase,r.ignoreAccent));else{for(var n=[],a=this.getPredicate(r.predicates),o=0,l=Object.keys(a);o<l.length;o++){var h=l[o];n.push(a[h])}t.push(r.condition==="or"?It.or(n):It.and(n))}}return t},s.serverTimezoneOffset=null,s.timeZoneHandling=!0,s.throwError=function(e){try{throw new Error(e)}catch(t){throw t.message+`
`+t.stack}},s.aggregates={sum:function(e,t){for(var i=0,r,n=typeof s.getVal(e,0,t)!="number",a=0;a<e.length;a++)r=s.getVal(e,a,t),!isNaN(r)&&r!==null&&(n&&(r=+r),i+=r);return i},average:function(e,t){return s.aggregates.sum(e,t)/e.length},min:function(e,t){var i;return typeof t=="function"&&(i=t,t=null),s.getObject(t,s.getItemFromComparer(e,t,i||s.fnAscending))},max:function(e,t){var i;return typeof t=="function"&&(i=t,t=null),s.getObject(t,s.getItemFromComparer(e,t,i||s.fnDescending))},truecount:function(e,t){return new ge(e).executeLocal(new $e().where(t,"equal",!0,!0)).length},falsecount:function(e,t){return new ge(e).executeLocal(new $e().where(t,"equal",!1,!0)).length},count:function(e,t){return e.length}},s.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},s.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},s.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not substringof",wildcard:"wildcard",like:"like"},s.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not contains",wildcard:"wildcard",like:"like"},s.diacritics={"Ⓐ":"A",Ａ:"A",À:"A",Á:"A",Â:"A",Ầ:"A",Ấ:"A",Ẫ:"A",Ẩ:"A",Ã:"A",Ā:"A",Ă:"A",Ằ:"A",Ắ:"A",Ẵ:"A",Ẳ:"A",Ȧ:"A",Ǡ:"A",Ä:"A",Ǟ:"A",Ả:"A",Å:"A",Ǻ:"A",Ǎ:"A",Ȁ:"A",Ȃ:"A",Ạ:"A",Ậ:"A",Ặ:"A",Ḁ:"A",Ą:"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA",Æ:"AE",Ǽ:"AE",Ǣ:"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B",Ｂ:"B",Ḃ:"B",Ḅ:"B",Ḇ:"B","Ƀ":"B",Ƃ:"B",Ɓ:"B","Ⓒ":"C",Ｃ:"C",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",Ç:"C",Ḉ:"C",Ƈ:"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D",Ｄ:"D",Ḋ:"D",Ď:"D",Ḍ:"D",Ḑ:"D",Ḓ:"D",Ḏ:"D",Đ:"D",Ƌ:"D",Ɗ:"D",Ɖ:"D","Ꝺ":"D",Ǳ:"DZ",Ǆ:"DZ",ǲ:"Dz",ǅ:"Dz","Ⓔ":"E",Ｅ:"E",È:"E",É:"E",Ê:"E",Ề:"E",Ế:"E",Ễ:"E",Ể:"E",Ẽ:"E",Ē:"E",Ḕ:"E",Ḗ:"E",Ĕ:"E",Ė:"E",Ë:"E",Ẻ:"E",Ě:"E",Ȅ:"E",Ȇ:"E",Ẹ:"E",Ệ:"E",Ȩ:"E",Ḝ:"E",Ę:"E",Ḙ:"E",Ḛ:"E",Ɛ:"E",Ǝ:"E","Ⓕ":"F",Ｆ:"F",Ḟ:"F",Ƒ:"F","Ꝼ":"F","Ⓖ":"G",Ｇ:"G",Ǵ:"G",Ĝ:"G",Ḡ:"G",Ğ:"G",Ġ:"G",Ǧ:"G",Ģ:"G",Ǥ:"G",Ɠ:"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H",Ｈ:"H",Ĥ:"H",Ḣ:"H",Ḧ:"H",Ȟ:"H",Ḥ:"H",Ḩ:"H",Ḫ:"H",Ħ:"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I",Ｉ:"I",Ì:"I",Í:"I",Î:"I",Ĩ:"I",Ī:"I",Ĭ:"I",İ:"I",Ï:"I",Ḯ:"I",Ỉ:"I",Ǐ:"I",Ȉ:"I",Ȋ:"I",Ị:"I",Į:"I",Ḭ:"I",Ɨ:"I","Ⓙ":"J",Ｊ:"J",Ĵ:"J","Ɉ":"J","Ⓚ":"K",Ｋ:"K",Ḱ:"K",Ǩ:"K",Ḳ:"K",Ķ:"K",Ḵ:"K",Ƙ:"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L",Ｌ:"L",Ŀ:"L",Ĺ:"L",Ľ:"L",Ḷ:"L",Ḹ:"L",Ļ:"L",Ḽ:"L",Ḻ:"L",Ł:"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L",Ǉ:"LJ",ǈ:"Lj","Ⓜ":"M",Ｍ:"M",Ḿ:"M",Ṁ:"M",Ṃ:"M","Ɱ":"M",Ɯ:"M","Ⓝ":"N",Ｎ:"N",Ǹ:"N",Ń:"N",Ñ:"N",Ṅ:"N",Ň:"N",Ṇ:"N",Ņ:"N",Ṋ:"N",Ṉ:"N","Ƞ":"N",Ɲ:"N","Ꞑ":"N","Ꞥ":"N",Ǌ:"NJ",ǋ:"Nj","Ⓞ":"O",Ｏ:"O",Ò:"O",Ó:"O",Ô:"O",Ồ:"O",Ố:"O",Ỗ:"O",Ổ:"O",Õ:"O",Ṍ:"O",Ȭ:"O",Ṏ:"O",Ō:"O",Ṑ:"O",Ṓ:"O",Ŏ:"O",Ȯ:"O",Ȱ:"O",Ö:"O",Ȫ:"O",Ỏ:"O",Ő:"O",Ǒ:"O",Ȍ:"O",Ȏ:"O",Ơ:"O",Ờ:"O",Ớ:"O",Ỡ:"O",Ở:"O",Ợ:"O",Ọ:"O",Ộ:"O",Ǫ:"O",Ǭ:"O",Ø:"O",Ǿ:"O",Ɔ:"O",Ɵ:"O","Ꝋ":"O","Ꝍ":"O",Ƣ:"OI","Ꝏ":"OO",Ȣ:"OU","Ⓟ":"P",Ｐ:"P",Ṕ:"P",Ṗ:"P",Ƥ:"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q",Ｑ:"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R",Ｒ:"R",Ŕ:"R",Ṙ:"R",Ř:"R",Ȑ:"R",Ȓ:"R",Ṛ:"R",Ṝ:"R",Ŗ:"R",Ṟ:"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S",Ｓ:"S","ẞ":"S",Ś:"S",Ṥ:"S",Ŝ:"S",Ṡ:"S",Š:"S",Ṧ:"S",Ṣ:"S",Ṩ:"S",Ș:"S",Ş:"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T",Ｔ:"T",Ṫ:"T",Ť:"T",Ṭ:"T",Ț:"T",Ţ:"T",Ṱ:"T",Ṯ:"T",Ŧ:"T",Ƭ:"T",Ʈ:"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U",Ｕ:"U",Ù:"U",Ú:"U",Û:"U",Ũ:"U",Ṹ:"U",Ū:"U",Ṻ:"U",Ŭ:"U",Ü:"U",Ǜ:"U",Ǘ:"U",Ǖ:"U",Ǚ:"U",Ủ:"U",Ů:"U",Ű:"U",Ǔ:"U",Ȕ:"U",Ȗ:"U",Ư:"U",Ừ:"U",Ứ:"U",Ữ:"U",Ử:"U",Ự:"U",Ụ:"U",Ṳ:"U",Ų:"U",Ṷ:"U",Ṵ:"U","Ʉ":"U","Ⓥ":"V",Ｖ:"V",Ṽ:"V",Ṿ:"V",Ʋ:"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W",Ｗ:"W",Ẁ:"W",Ẃ:"W",Ŵ:"W",Ẇ:"W",Ẅ:"W",Ẉ:"W","Ⱳ":"W","Ⓧ":"X",Ｘ:"X",Ẋ:"X",Ẍ:"X","Ⓨ":"Y",Ｙ:"Y",Ỳ:"Y",Ý:"Y",Ŷ:"Y",Ỹ:"Y",Ȳ:"Y",Ẏ:"Y",Ÿ:"Y",Ỷ:"Y",Ỵ:"Y",Ƴ:"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z",Ｚ:"Z",Ź:"Z",Ẑ:"Z",Ż:"Z",Ž:"Z",Ẓ:"Z",Ẕ:"Z",Ƶ:"Z",Ȥ:"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a",ａ:"a",ẚ:"a",à:"a",á:"a",â:"a",ầ:"a",ấ:"a",ẫ:"a",ẩ:"a",ã:"a",ā:"a",ă:"a",ằ:"a",ắ:"a",ẵ:"a",ẳ:"a",ȧ:"a",ǡ:"a",ä:"a",ǟ:"a",ả:"a",å:"a",ǻ:"a",ǎ:"a",ȁ:"a",ȃ:"a",ạ:"a",ậ:"a",ặ:"a",ḁ:"a",ą:"a","ⱥ":"a",ɐ:"a","ꜳ":"aa",æ:"ae",ǽ:"ae",ǣ:"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b",ｂ:"b",ḃ:"b",ḅ:"b",ḇ:"b",ƀ:"b",ƃ:"b",ɓ:"b","ⓒ":"c",ｃ:"c",ć:"c",ĉ:"c",ċ:"c",č:"c",ç:"c",ḉ:"c",ƈ:"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d",ｄ:"d",ḋ:"d",ď:"d",ḍ:"d",ḑ:"d",ḓ:"d",ḏ:"d",đ:"d",ƌ:"d",ɖ:"d",ɗ:"d","ꝺ":"d",ǳ:"dz",ǆ:"dz","ⓔ":"e",ｅ:"e",è:"e",é:"e",ê:"e",ề:"e",ế:"e",ễ:"e",ể:"e",ẽ:"e",ē:"e",ḕ:"e",ḗ:"e",ĕ:"e",ė:"e",ë:"e",ẻ:"e",ě:"e",ȅ:"e",ȇ:"e",ẹ:"e",ệ:"e",ȩ:"e",ḝ:"e",ę:"e",ḙ:"e",ḛ:"e","ɇ":"e",ɛ:"e",ǝ:"e","ⓕ":"f",ｆ:"f",ḟ:"f",ƒ:"f","ꝼ":"f","ⓖ":"g",ｇ:"g",ǵ:"g",ĝ:"g",ḡ:"g",ğ:"g",ġ:"g",ǧ:"g",ģ:"g",ǥ:"g",ɠ:"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h",ｈ:"h",ĥ:"h",ḣ:"h",ḧ:"h",ȟ:"h",ḥ:"h",ḩ:"h",ḫ:"h",ẖ:"h",ħ:"h","ⱨ":"h","ⱶ":"h",ɥ:"h",ƕ:"hv","ⓘ":"i",ｉ:"i",ì:"i",í:"i",î:"i",ĩ:"i",ī:"i",ĭ:"i",ï:"i",ḯ:"i",ỉ:"i",ǐ:"i",ȉ:"i",ȋ:"i",ị:"i",į:"i",ḭ:"i",ɨ:"i",ı:"i","ⓙ":"j",ｊ:"j",ĵ:"j",ǰ:"j","ɉ":"j","ⓚ":"k",ｋ:"k",ḱ:"k",ǩ:"k",ḳ:"k",ķ:"k",ḵ:"k",ƙ:"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l",ｌ:"l",ŀ:"l",ĺ:"l",ľ:"l",ḷ:"l",ḹ:"l",ļ:"l",ḽ:"l",ḻ:"l",ſ:"l",ł:"l",ƚ:"l",ɫ:"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l",ǉ:"lj","ⓜ":"m",ｍ:"m",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ɯ:"m","ⓝ":"n",ｎ:"n",ǹ:"n",ń:"n",ñ:"n",ṅ:"n",ň:"n",ṇ:"n",ņ:"n",ṋ:"n",ṉ:"n",ƞ:"n",ɲ:"n",ŉ:"n","ꞑ":"n","ꞥ":"n",ǌ:"nj","ⓞ":"o",ｏ:"o",ò:"o",ó:"o",ô:"o",ồ:"o",ố:"o",ỗ:"o",ổ:"o",õ:"o",ṍ:"o",ȭ:"o",ṏ:"o",ō:"o",ṑ:"o",ṓ:"o",ŏ:"o",ȯ:"o",ȱ:"o",ö:"o",ȫ:"o",ỏ:"o",ő:"o",ǒ:"o",ȍ:"o",ȏ:"o",ơ:"o",ờ:"o",ớ:"o",ỡ:"o",ở:"o",ợ:"o",ọ:"o",ộ:"o",ǫ:"o",ǭ:"o",ø:"o",ǿ:"o",ɔ:"o","ꝋ":"o","ꝍ":"o",ɵ:"o",ƣ:"oi",ȣ:"ou","ꝏ":"oo","ⓟ":"p",ｐ:"p",ṕ:"p",ṗ:"p",ƥ:"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q",ｑ:"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r",ｒ:"r",ŕ:"r",ṙ:"r",ř:"r",ȑ:"r",ȓ:"r",ṛ:"r",ṝ:"r",ŗ:"r",ṟ:"r","ɍ":"r",ɽ:"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s",ｓ:"s",ß:"s",ś:"s",ṥ:"s",ŝ:"s",ṡ:"s",š:"s",ṧ:"s",ṣ:"s",ṩ:"s",ș:"s",ş:"s","ȿ":"s","ꞩ":"s","ꞅ":"s",ẛ:"s","ⓣ":"t",ｔ:"t",ṫ:"t",ẗ:"t",ť:"t",ṭ:"t",ț:"t",ţ:"t",ṱ:"t",ṯ:"t",ŧ:"t",ƭ:"t",ʈ:"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u",ｕ:"u",ù:"u",ú:"u",û:"u",ũ:"u",ṹ:"u",ū:"u",ṻ:"u",ŭ:"u",ü:"u",ǜ:"u",ǘ:"u",ǖ:"u",ǚ:"u",ủ:"u",ů:"u",ű:"u",ǔ:"u",ȕ:"u",ȗ:"u",ư:"u",ừ:"u",ứ:"u",ữ:"u",ử:"u",ự:"u",ụ:"u",ṳ:"u",ų:"u",ṷ:"u",ṵ:"u",ʉ:"u","ⓥ":"v",ｖ:"v",ṽ:"v",ṿ:"v",ʋ:"v","ꝟ":"v",ʌ:"v","ꝡ":"vy","ⓦ":"w",ｗ:"w",ẁ:"w",ẃ:"w",ŵ:"w",ẇ:"w",ẅ:"w",ẘ:"w",ẉ:"w","ⱳ":"w","ⓧ":"x",ｘ:"x",ẋ:"x",ẍ:"x","ⓨ":"y",ｙ:"y",ỳ:"y",ý:"y",ŷ:"y",ỹ:"y",ȳ:"y",ẏ:"y",ÿ:"y",ỷ:"y",ẙ:"y",ỵ:"y",ƴ:"y","ɏ":"y","ỿ":"y","ⓩ":"z",ｚ:"z",ź:"z",ẑ:"z",ż:"z",ž:"z",ẓ:"z",ẕ:"z",ƶ:"z",ȥ:"z","ɀ":"z","ⱬ":"z","ꝣ":"z",Ά:"Α",Έ:"Ε",Ή:"Η",Ί:"Ι",Ϊ:"Ι",Ό:"Ο",Ύ:"Υ",Ϋ:"Υ",Ώ:"Ω",ά:"α",έ:"ε",ή:"η",ί:"ι",ϊ:"ι",ΐ:"ι",ό:"ο",ύ:"υ",ϋ:"υ",ΰ:"υ",ω:"ω",ς:"σ"},s.fnOperators={equal:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?s.toLowerCase(e)===s.toLowerCase(t):e===t},notequal:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),!s.fnOperators.equal(e,t,i)},lessthan:function(e,t,i){return i?s.toLowerCase(e)<s.toLowerCase(t):(m(e)&&(e=void 0),e<t)},greaterthan:function(e,t,i){return i?s.toLowerCase(e)>s.toLowerCase(t):e>t},lessthanorequal:function(e,t,i){return i?s.toLowerCase(e)<=s.toLowerCase(t):(m(e)&&(e=void 0),e<=t)},greaterthanorequal:function(e,t,i){return i?s.toLowerCase(e)>=s.toLowerCase(t):e>=t},contains:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?!m(e)&&!m(t)&&s.toLowerCase(e).indexOf(s.toLowerCase(t))!==-1:!m(e)&&!m(t)&&e.toString().indexOf(t)!==-1},doesnotcontain:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?!m(e)&&!m(t)&&s.toLowerCase(e).indexOf(s.toLowerCase(t))===-1:!m(e)&&!m(t)&&e.toString().indexOf(t)===-1},isnotnull:function(e){return e!=null},isnull:function(e){return e==null},startswith:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?e&&t&&s.startsWith(s.toLowerCase(e),s.toLowerCase(t)):e&&t&&s.startsWith(e,t)},doesnotstartwith:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?e&&t&&s.notStartsWith(s.toLowerCase(e),s.toLowerCase(t)):e&&t&&s.notStartsWith(e,t)},like:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?e&&t&&s.like(s.toLowerCase(e),s.toLowerCase(t)):e&&t&&s.like(e,t)},isempty:function(e){return e===void 0||e===""},isnotempty:function(e){return e!==void 0&&e!==""},wildcard:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?(e||typeof e=="boolean")&&t&&typeof e!="object"&&s.wildCard(s.toLowerCase(e),s.toLowerCase(t)):(e||typeof e=="boolean")&&t&&s.wildCard(e,t)},endswith:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?e&&t&&s.endsWith(s.toLowerCase(e),s.toLowerCase(t)):e&&t&&s.endsWith(e,t)},doesnotendwith:function(e,t,i,r){return r&&(e=s.ignoreDiacritics(e),t=s.ignoreDiacritics(t)),i?e&&t&&s.notEndsWith(s.toLowerCase(e),s.toLowerCase(t)):e&&t&&s.notEndsWith(e,t)},processSymbols:function(e){var t=s.operatorSymbols[e];if(t){var i=s.fnOperators[t];return i}return s.throwError("Query - Process Operator : Invalid operator")},processOperator:function(e){var t=s.fnOperators[e];return t||s.fnOperators.processSymbols(e)}},s.parse={parseJson:function(e){return typeof e=="string"&&(/^[\s]*\[|^[\s]*\{(.)+:/g.test(e)||e.indexOf('"')===-1)?e=JSON.parse(e,s.parse.jsonReviver):e instanceof Array?s.parse.iterateAndReviveArray(e):typeof e=="object"&&e!==null&&s.parse.iterateAndReviveJson(e),e},iterateAndReviveArray:function(e){for(var t=0;t<e.length;t++)typeof e[t]=="object"&&e[t]!==null?s.parse.iterateAndReviveJson(e[t]):typeof e[t]=="string"&&(!/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(e[t])||e[t].toString().indexOf('"')===-1)?e[t]=s.parse.jsonReviver("",e[t]):e[t]=s.parse.parseJson(e[t])},iterateAndReviveJson:function(e){for(var t,i=Object.keys(e),r=0,n=i;r<n.length;r++){var a=n[r];s.startsWith(a,"__")||(t=e[a],typeof t=="object"?t instanceof Array?s.parse.iterateAndReviveArray(t):t&&s.parse.iterateAndReviveJson(t):e[a]=s.parse.jsonReviver(e[a],t))}},jsonReviver:function(e,t){if(typeof t=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t),r=s.timeZoneHandling?s.serverTimezoneOffset:null;if(i)return s.dateParse.toTimeZone(new Date(parseInt(i[1],10)),r,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)){var n=t.indexOf("Z")>-1||t.indexOf("z")>-1,a=t.split(/[^0-9.]/);if(n){if(a[5].indexOf(".")>-1){var o=a[5].split(".");a[5]=o[0],a[6]=new Date(t).getUTCMilliseconds().toString()}else a[6]="00";t=s.dateParse.toTimeZone(new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10),parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5]?a[5]:"00",10),parseInt(a[6],10)),s.serverTimezoneOffset,!1)}else{var l=new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10),parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5]?a[5]:"00",10)),h=parseInt(a[6],10),u=parseInt(a[7],10);if(isNaN(h)&&isNaN(u))return l;t.indexOf("+")>-1?l.setHours(l.getHours()-h,l.getMinutes()-u):l.setHours(l.getHours()+h,l.getMinutes()+u),t=s.dateParse.toTimeZone(l,s.serverTimezoneOffset,!1)}s.serverTimezoneOffset==null&&(t=s.dateParse.addSelfOffset(t))}else if(/^\d{4}-\d{2}-\d{2}$/.test(t)){var a=t.split(/[^0-9.]/);return new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10))}}return t},isJson:function(e){return typeof e[0]=="string"?e:s.parse.parseJson(e)},isGuid:function(e){var t=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i,i=t.exec(e);return i!=null},replacer:function(e,t){return s.isPlainObject(e)?s.parse.jsonReplacer(e,t):e instanceof Array?s.parse.arrayReplacer(e):e instanceof Date?s.parse.jsonReplacer({val:e},t).val:e},jsonReplacer:function(e,t){for(var i,r=Object.keys(e),n=0,a=r;n<a.length;n++){var o=a[n];if(i=e[o],i instanceof Date){var l=i;s.serverTimezoneOffset==null?e[o]=s.dateParse.toTimeZone(l,null).toJSON():(l=new Date(+l+s.serverTimezoneOffset*36e5),e[o]=s.dateParse.toTimeZone(s.dateParse.addSelfOffset(l),null).toJSON())}}return e},arrayReplacer:function(e){for(var t=0;t<e.length;t++)s.isPlainObject(e[t])?e[t]=s.parse.jsonReplacer(e[t]):e[t]instanceof Date&&(e[t]=s.parse.jsonReplacer({date:e[t]}).date);return e},jsonDateReplacer:function(e,t){if(e==="value"&&t){if(typeof t=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t);if(i)t=s.dateParse.toTimeZone(new Date(parseInt(i[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)){var r=t.split(/[^0-9]/);t=s.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),null,!0)}}if(t instanceof Date)return t=s.dateParse.addSelfOffset(t),s.serverTimezoneOffset===null?s.dateParse.toTimeZone(s.dateParse.addSelfOffset(t),null).toJSON():(t=s.dateParse.toTimeZone(t,t.getTimezoneOffset()/60-s.serverTimezoneOffset,!1),t.toJSON())}return t}},s.dateParse={addSelfOffset:function(e){return new Date(+e-e.getTimezoneOffset()*6e4)},toUTC:function(e){return new Date(+e+e.getTimezoneOffset()*6e4)},toTimeZone:function(e,t,i){if(t===null)return e;var r=i?s.dateParse.toUTC(e):e;return new Date(+r-t*36e5)},toLocalTime:function(e){var t=e,i=-t.getTimezoneOffset(),r=i>=0?"+":"-",n=function(o){var l=Math.floor(Math.abs(o));return(l<10?"0":"")+l},a=t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+"T"+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+r+n(i/60)+":"+n(i%60);return a}},s}(),co=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qW={GroupGuid:"{271bbba0-1ee7}"},DP=function(){function s(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=s,this.dataSource=e,this.pvt={}}return s.prototype.processResponse=function(e,t,i,r){return e},s}(),Xw=function(s){co(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.processQuery=function(t,i){for(var r=t.dataSource.json.slice(0),n=r.length,a=!0,o,l,h={},u=0,c=[],d,p=0;p<i.lazyLoad.length;p++)u++,h[i.lazyLoad[p].key]=i.lazyLoad[p].value;for(var f={},p=0;p<i.queries.length;p++){if(l=i.queries[p],(l.fn==="onPage"||l.fn==="onGroup")&&i.lazyLoad.length){l.fn==="onGroup"&&c.push(l.e),l.fn==="onPage"&&(d=l.e);continue}o=this[l.fn].call(this,r,l.e,i),l.fn==="onAggregates"?f[l.e.field+" - "+l.e.type]=o:r=o!==void 0?o:r,(l.fn==="onPage"||l.fn==="onSkip"||l.fn==="onTake"||l.fn==="onRange")&&(a=!1),a&&(n=r.length)}if(u){var v={query:i,lazyLoad:h,result:r,group:c,page:d},g=this.lazyLoadGroup(v);r=g.result,n=g.count}return i.isCountRequired&&(r={result:r,count:n,aggregates:f}),r},e.prototype.lazyLoadGroup=function(t){var i=0,r=this.getAggregate(t.query),n=t.result;if(m(t.lazyLoad.onDemandGroupInfo)){var l=t.group[0].fieldName;n=ce.group(n,l,r,null,null,t.group[0].comparer,!0),i=n.length;var h=n;t.page&&(n=this.onPage(n,t.page,t.query)),this.formGroupResult(n,h)}else{for(var a=t.lazyLoad.onDemandGroupInfo,o=a.where.length-1;o>=0;o--)n=this.onWhere(n,a.where[o]);if(t.group.length!==a.level){var l=t.group[a.level].fieldName;n=ce.group(n,l,r,null,null,t.group[0].comparer,!0)}i=n.length;var h=n;n=n.slice(a.skip),n=n.slice(0,a.take),t.group.length!==a.level&&this.formGroupResult(n,h)}return{result:n,count:i}},e.prototype.formGroupResult=function(t,i){if(t.length&&i.length){var r="GroupGuid",n="childLevels",a="level",o="records";t[r]=i[r],t[n]=i[n],t[a]=i[a],t[o]=i[o]}return t},e.prototype.getAggregate=function(t){var i=$e.filterQueries(t.queries,"onAggregates"),r=[];if(i.length)for(var n=void 0,a=0;a<i.length;a++)n=i[a].e,r.push({type:n.type,field:ce.getValue(n.field,t)});return r},e.prototype.batchRequest=function(t,i,r){var n,a=i.deletedRecords.length;for(n=0;n<i.addedRecords.length;n++)this.insert(t,i.addedRecords[n]);for(n=0;n<i.changedRecords.length;n++)this.update(t,r.key,i.changedRecords[n]);for(n=0;n<a;n++)this.remove(t,r.key,i.deletedRecords[n]);return i},e.prototype.onWhere=function(t,i){return!t||!t.length?t:t.filter(function(r){if(i)return i.validate(r)})},e.prototype.onAggregates=function(t,i){var r=ce.aggregates[i.type];return!t||!r||t.length===0?null:r(t,i.field)},e.prototype.onSearch=function(t,i){return!t||!t.length?t:(i.fieldNames.length===0&&ce.getFieldList(t[0],i.fieldNames),t.filter(function(r){for(var n=0;n<i.fieldNames.length;n++)if(i.comparer.call(r,ce.getObject(i.fieldNames[n],r),i.searchKey,i.ignoreCase,i.ignoreAccent))return!0;return!1}))},e.prototype.onSortBy=function(t,i,r){if(!t||!t.length)return t;var n,a=ce.getValue(i.fieldName,r);if(!a)return t.sort(i.comparer);if(a instanceof Array){a=a.slice(0);for(var o=a.length-1;o>=0;o--)a[o]&&(n=i.comparer,ce.endsWith(a[o]," desc")&&(n=ce.fnSort("descending"),a[o]=a[o].replace(" desc","")),t=ce.sort(t,a[o],n));return t}return ce.sort(t,a,i.comparer)},e.prototype.onGroup=function(t,i,r){if(!t||!t.length)return t;var n=this.getAggregate(r);return ce.group(t,ce.getValue(i.fieldName,r),n,null,null,i.comparer)},e.prototype.onPage=function(t,i,r){var n=ce.getValue(i.pageSize,r),a=(ce.getValue(i.pageIndex,r)-1)*n,o=a+n;return!t||!t.length?t:t.slice(a,o)},e.prototype.onRange=function(t,i){return!t||!t.length?t:t.slice(ce.getValue(i.start),ce.getValue(i.end))},e.prototype.onTake=function(t,i){return!t||!t.length?t:t.slice(0,ce.getValue(i.nos))},e.prototype.onSkip=function(t,i){return!t||!t.length?t:t.slice(ce.getValue(i.nos))},e.prototype.onSelect=function(t,i){return!t||!t.length?t:ce.select(t,ce.getValue(i.fieldNames))},e.prototype.insert=function(t,i,r,n,a){return m(a)?t.dataSource.json.push(i):t.dataSource.json.splice(a,0,i)},e.prototype.remove=function(t,i,r,n){var a=t.dataSource.json,o;for(typeof r=="object"&&!(r instanceof Date)&&(r=ce.getObject(i,r)),o=0;o<a.length&&ce.getObject(i,a[o])!==r;o++);return o!==a.length?a.splice(o,1):null},e.prototype.update=function(t,i,r,n){var a=t.dataSource.json,o,l;for(m(i)||(l=ie(i,r)),o=0;o<a.length&&!(!m(i)&&ie(i,a[o])===l);o++);return o<a.length?bt(a[o],r):null},e}(DP),oo=function(s){co(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.processQuery=function(t,i,r){var n=this.getQueryRequest(i),a=$e.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=i.params,l=t.dataSource.url,h,u,c=null,d=this.options,p={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in a?(h=a.onPage,u=ce.getValue(h.pageIndex,i),c=ce.getValue(h.pageSize,i),u=(u-1)*c):"onRange"in a&&(h=a.onRange,u=h.start,c=h.end-h.start);for(var f=0;f<n.sorts.length;f++)h=ce.getValue(n.sorts[f].e.fieldName,i),p.sorts.push(ce.callAdaptorFunction(this,"onEachSort",{name:h,direction:n.sorts[f].e.direction},i));r&&(h=this.getFiltersFrom(r,i),h&&p.filters.push(ce.callAdaptorFunction(this,"onEachWhere",h.toJson(),i)));for(var f=0;f<n.filters.length;f++){var v=ce.callAdaptorFunction(this,"onEachWhere",n.filters[f].e.toJson(),i);this.getModuleName&&this.getModuleName()==="ODataV4Adaptor"&&!m(n.filters[f].e.key)&&n.filters.length>1&&(v="("+v+")"),p.filters.push(v);for(var g=typeof p.filters[f]=="object"?Object.keys(p.filters[f]):[],b=0,y=g;b<y.length;b++){var C=y[b];ce.isNull(p[C])&&delete p[C]}}for(var f=0;f<n.searches.length;f++)h=n.searches[f].e,p.searches.push(ce.callAdaptorFunction(this,"onEachSearch",{fields:h.fieldNames,operator:h.operator,key:h.searchKey,ignoreCase:h.ignoreCase},i));for(var f=0;f<n.groups.length;f++)p.groups.push(ce.getValue(n.groups[f].e.fieldName,i));for(var f=0;f<n.aggregates.length;f++)h=n.aggregates[f].e,p.aggregates.push({type:h.type,field:ce.getValue(h.field,i)});var x={};if(this.getRequestQuery(d,i,a,p,x),ce.callAdaptorFunction(this,"addParams",{dm:t,query:i,params:o,reqParams:x}),i.lazyLoad.length)for(var f=0;f<i.lazyLoad.length;f++)x[i.lazyLoad[f].key]=i.lazyLoad[f].value;for(var w=Object.keys(x),M=0,E=w;M<E.length;M++){var C=E[M];(ce.isNull(x[C])||x[C]===""||x[C].length===0)&&delete x[C]}!(d.skip in x&&d.take in x)&&c!==null&&(x[d.skip]=ce.callAdaptorFunction(this,"onSkip",u,i),x[d.take]=ce.callAdaptorFunction(this,"onTake",c,i));var T=this.pvt;return this.pvt={},this.options.requestType==="json"?{data:JSON.stringify(x,ce.parse.jsonDateReplacer),url:l,pvtData:T,type:"POST",contentType:"application/json; charset=utf-8"}:(h=this.convertToQueryString(x,i,t),h=(t.dataSource.url.indexOf("?")!==-1?"&":"/")+h,{type:"GET",url:h.length?l.replace(/\/*$/,h):l,pvtData:T})},e.prototype.getRequestQuery=function(t,i,r,n,a){var o="param",l=a;l[t.from]=i.fromTable,t.apply&&i.distincts.length&&(l[t.apply]="onDistinct"in this?ce.callAdaptorFunction(this,"onDistinct",i.distincts):""),!i.distincts.length&&t.expand&&(l[t.expand]="onExpand"in this&&"onSelect"in r?ce.callAdaptorFunction(this,"onExpand",{selects:ce.getValue(r.onSelect.fieldNames,i),expands:i.expands},i):i.expands),l[t.select]="onSelect"in r&&!i.distincts.length?ce.callAdaptorFunction(this,"onSelect",ce.getValue(r.onSelect.fieldNames,i),i):"",l[t.count]=i.isCountRequired?ce.callAdaptorFunction(this,"onCount",i.isCountRequired,i):"",l[t.search]=n.searches.length?ce.callAdaptorFunction(this,"onSearch",n.searches,i):"",l[t.skip]="onSkip"in r?ce.callAdaptorFunction(this,"onSkip",ce.getValue(r.onSkip.nos,i),i):"",l[t.take]="onTake"in r?ce.callAdaptorFunction(this,"onTake",ce.getValue(r.onTake.nos,i),i):"",l[t.where]=n.filters.length||n.searches.length?ce.callAdaptorFunction(this,"onWhere",n.filters,i):"",l[t.sortBy]=n.sorts.length?ce.callAdaptorFunction(this,"onSortBy",n.sorts,i):"",l[t.group]=n.groups.length?ce.callAdaptorFunction(this,"onGroup",n.groups,i):"",l[t.aggregates]=n.aggregates.length?ce.callAdaptorFunction(this,"onAggregates",n.aggregates,i):"",l[o]=[]},e.prototype.convertToQueryString=function(t,i,r){return""},e.prototype.processResponse=function(t,i,r,n,a,o){if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("application/json")!==-1){var l=ce.timeZoneHandling;i&&!i.timeZoneHandling&&(ce.timeZoneHandling=!1),t=ce.parse.parseJson(t),ce.timeZoneHandling=l}var h=a,u=h.pvtData||{},c=t?t.groupDs:[];if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("xml")!==-1)return r.isCountRequired?{result:[],count:0}:[];var d=JSON.parse(h.data);if(d&&d.action==="batch"&&t&&t.addedRecords)return o.addedRecords=t.addedRecords,o;t&&t.d&&(t=t.d);var p={};t&&"count"in t&&(p.count=t.count),p.result=t&&t.result?t.result:t;var f=!1;if(Array.isArray(t.result)&&t.result.length){var v="key",g="value",b="level";if(m(t.result[0][v])||(p.result=this.formRemoteGroupedData(p.result,1,u.groups.length-1)),r&&r.lazyLoad.length&&u.groups.length){for(var y=0;y<r.lazyLoad.length;y++)if(r.lazyLoad[y][v]==="onDemandGroupInfo"){var C=r.lazyLoad[y][g][b];u.groups.length===C&&(f=!0)}}}return f||this.getAggregateResult(u,t,p,c,r),ce.isNull(p.count)?p.result:{result:p.result,count:p.count,aggregates:p.aggregates}},e.prototype.formRemoteGroupedData=function(t,i,r){for(var n=0;n<t.length;n++)t[n].items.length&&Object.keys(t[n].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(t[n].items,i+1,r-1);var a="GroupGuid",o="childLevels",l="level",h="records";return t[a]=qW[a],t[l]=i,t[o]=r,t[h]=t[0].items.length?this.getGroupedRecords(t,!m(t[0].items[h])):[],t},e.prototype.getGroupedRecords=function(t,i){for(var r=[],n="records",a=0;a<t.length;a++)if(i)r=r.concat(t[a].items[n]);else for(var o=0;o<t[a].items.length;o++)r.push(t[a].items[o]);return r},e.prototype.onGroup=function(t){return this.pvt.groups=t,t},e.prototype.onAggregates=function(t){this.pvt.aggregates=t},e.prototype.batchRequest=function(t,i,r,n,a){var o,l;return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.removeUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(me({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r[o],key:r[l]},ce.getAddParams(this,t,n)))}},e.prototype.beforeSend=function(t,i){},e.prototype.insert=function(t,i,r,n){return{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{value:i,table:r,action:"insert"},ce.getAddParams(this,t,n)))}},e.prototype.remove=function(t,i,r,n,a){return{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{key:r,keyColumn:i,table:n,action:"remove"},ce.getAddParams(this,t,a)))}},e.prototype.update=function(t,i,r,n,a){return{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{value:r,action:"update",keyColumn:i,key:ce.getObject(i,r),table:n},ce.getAddParams(this,t,a)))}},e.prototype.getFiltersFrom=function(t,i){var r=i.fKey,n,a=r,o=i.key,l=[];typeof t[0]!="object"&&(a=null);for(var h=0;h<t.length;h++)typeof t[0]=="object"?n=ce.getObject(o||a,t[h]):n=t[h],l.push(new It(r,"equal",n));return It.or(l)},e.prototype.getAggregateResult=function(t,i,r,n,a){var o=i;if(i&&i.result&&(o=i.result),t&&t.aggregates&&t.aggregates.length){var l=t.aggregates,h=void 0,u=o,c={};i.aggregate&&(u=i.aggregate);for(var d=0;d<l.length;d++)h=ce.aggregates[l[d].type],h&&(c[l[d].field+" - "+l[d].type]=h(u,l[d].field));r.aggregates=c}var p="key",f=Array.isArray(i.result)&&i.result.length&&!m(i.result[0][p]);if(t&&t.groups&&t.groups.length&&!f){for(var v=t.groups,d=0;d<v.length;d++){var g=null;m(n)||(n=ce.group(n,v[d]));var b=$e.filterQueries(a.queries,"onGroup")[d].e;o=ce.group(o,v[d],t.aggregates,g,n,b.comparer)}r.result=o}return r},e.prototype.getQueryRequest=function(t){var i={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return i.sorts=$e.filterQueries(t.queries,"onSortBy"),i.groups=$e.filterQueries(t.queries,"onGroup"),i.filters=$e.filterQueries(t.queries,"onWhere"),i.searches=$e.filterQueries(t.queries,"onSearch"),i.aggregates=$e.filterQueries(t.queries,"onAggregates"),i},e.prototype.addParams=function(t){var i=t.reqParams;t.params.length&&(i.params={});for(var r=0,n=t.params;r<n.length;r++){var a=n[r];if(i[a.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");i[a.key]=a.value,a.fn&&(i[a.key]=a.fn.call(t.query,a.key,t.query,t.dm)),i.params[a.key]=i[a.key]}},e}(DP),Bc=function(s){co(e,s);function e(t){var i=s.call(this)||this;return i.options=me({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),me(i.options,t||{}),i}return e.prototype.getModuleName=function(){return"ODataAdaptor"},e.prototype.onPredicate=function(t,i,r){var n="",a,o,l=t.value,h=typeof l,u=t.field?e.getField(t.field):null;if(l instanceof Date&&(l="datetime'"+ce.parse.replacer(l)+"'"),h==="string"&&(l=l.replace(/'/g,"''"),t.ignoreCase&&(l=l.toLowerCase()),t.operator!=="like"&&(l=encodeURIComponent(l)),t.operator!=="wildcard"&&t.operator!=="like"&&(l="'"+l+"'"),r&&(u="cast("+u+", 'Edm.String')"),ce.parse.isGuid(l)&&(o="guid"),t.ignoreCase&&(o||(u="tolower("+u+")"),l=l.toLowerCase())),t.operator==="isempty"||t.operator==="isnull"||t.operator==="isnotempty"||t.operator==="isnotnull"?(a=t.operator.indexOf("isnot")!==-1?ce.odBiOperator.notequal:ce.odBiOperator.equal,l=t.operator==="isnull"||t.operator==="isnotnull"?null:"''"):a=ce.odBiOperator[t.operator],a)return n+=u,n+=a,o&&(n+=o),n+l;if(!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?a=ce.odv4UniOperator[t.operator]:a=ce.odUniOperator[t.operator],a==="like")l=l,l.indexOf("%")!==-1&&(l.charAt(0)==="%"&&l.lastIndexOf("%")<2?(l=l.substring(1,l.length),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.startswith:ce.odUniOperator.startswith):l.charAt(l.length-1)==="%"&&l.indexOf("%")>l.length-3?(l=l.substring(0,l.length-1),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.endswith:ce.odUniOperator.endswith):l.lastIndexOf("%")!==l.indexOf("%")&&l.lastIndexOf("%")>l.indexOf("%")+1?(l=l.substring(l.indexOf("%")+1,l.lastIndexOf("%")),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.contains:ce.odUniOperator.contains):a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.contains:ce.odUniOperator.contains),l=encodeURIComponent(l),l="'"+l+"'";else if(a==="wildcard")if(l=l,l.indexOf("*")!==-1){var c=l.split("*"),d=void 0,p=0;if(l.indexOf("*")!==0&&c[0].indexOf("%3f")===-1&&c[0].indexOf("?")===-1&&(d=c[0],d="'"+d+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.startswith:ce.odUniOperator.startswith,n+=a+"(",n+=u+",",o&&(n+=o),n+=d+")",p++),l.lastIndexOf("*")!==l.length-1&&c[c.length-1].indexOf("%3f")===-1&&c[c.length-1].indexOf("?")===-1&&(d=c[c.length-1],d="'"+d+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.endswith:ce.odUniOperator.endswith,p>0&&(n+=" and "),n+=a+"(",n+=u+",",o&&(n+=o),n+=d+")",p++),c.length>2){for(var f=1;f<c.length-1;f++)if(c[f].indexOf("%3f")===-1&&c[f].indexOf("?")===-1){if(d=c[f],d="'"+d+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.contains:ce.odUniOperator.contains,p>0&&(n+=" and "),a==="substringof"||a==="not substringof"){var v=d;d=u,u=v}n+=a+"(",n+=u+",",o&&(n+=o),n+=d+")",p++}}p===0?(a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.contains:ce.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'"):a="wildcard"}else a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ce.odv4UniOperator.contains:ce.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'";if(a==="substringof"||a==="not substringof"){var v=l;l=u,u=v}return a!=="wildcard"&&(n+=a+"(",n+=u+",",o&&(n+=o),n+=l+")"),n},e.prototype.addParams=function(t){s.prototype.addParams.call(this,t),delete t.reqParams.params},e.prototype.onComplexPredicate=function(t,i,r){for(var n=[],a=0;a<t.predicates.length;a++)n.push("("+this.onEachWhere(t.predicates[a],i,r)+")");return n.join(" "+t.condition+" ")},e.prototype.onEachWhere=function(t,i,r){return t.isComplex?this.onComplexPredicate(t,i,r):this.onPredicate(t,i,r)},e.prototype.onWhere=function(t){return this.pvt.search&&t.push(this.onEachWhere(this.pvt.search,null,!0)),t.join(" and ")},e.prototype.onEachSearch=function(t){t.fields&&t.fields.length===0&&ce.throwError("Query() - Search : oData search requires list of field names to search");for(var i=this.pvt.search||[],r=0;r<t.fields.length;r++)i.push(new It(t.fields[r],t.operator,t.key,t.ignoreCase));this.pvt.search=i},e.prototype.onSearch=function(t){return this.pvt.search=It.or(this.pvt.search),""},e.prototype.onEachSort=function(t){var i=[];if(t.name instanceof Array)for(var r=0;r<t.name.length;r++)i.push(e.getField(t.name[r])+(t.direction==="descending"?" desc":""));else i.push(e.getField(t.name)+(t.direction==="descending"?" desc":""));return i.join(",")},e.prototype.onSortBy=function(t){return t.reverse().join(",")},e.prototype.onGroup=function(t){return this.pvt.groups=t,[]},e.prototype.onSelect=function(t){for(var i=0;i<t.length;i++)t[i]=e.getField(t[i]);return t.join(",")},e.prototype.onAggregates=function(t){return this.pvt.aggregates=t,""},e.prototype.onCount=function(t){return t===!0?"allpages":""},e.prototype.beforeSend=function(t,i,r){ce.endsWith(r.url,this.options.batch)&&r.type.toLowerCase()==="post"?(i.headers.set("Accept",this.options.multipartAccept),i.headers.set("DataServiceVersion","2.0")):i.headers.set("Accept",this.options.accept),i.headers.set("DataServiceVersion","2.0"),i.headers.set("MaxDataServiceVersion","2.0")},e.prototype.processResponse=function(t,i,r,n,a,o){var l="odata.metadata";if(a&&a.type==="GET"&&!this.rootUrl&&t[l]){var h=t[l].split("/$metadata#");this.rootUrl=h[0],this.resourceTableName=h[1]}var u="pvtData";if(!m(t.d)){var c=r&&r.isCountRequired?t.d.results:t.d,d="__metadata";if(!m(c))for(var p=0;p<c.length;p++)m(c[p][d])||delete c[p][d]}var f=a&&a[u],v=this.processBatchResponse(t,r,n,a,o);if(v)return v;var g=n&&a.fetchRequest.headers.get("DataServiceVersion"),b=null,y=g&&parseInt(g,10)||2;if(r&&r.isCountRequired){var C="__count";(t[C]||t["odata.count"])&&(b=t[C]||t["odata.count"]),t.d&&(t=t.d),(t[C]||t["odata.count"])&&(b=t[C]||t["odata.count"])}y===3&&t.value&&(t=t.value),t.d&&(t=t.d),y<3&&t.results&&(t=t.results);var x={};return x.count=b,x.result=t,this.getAggregateResult(f,t,x,null,r),ce.isNull(b)?x.result:{result:x.result,count:x.count,aggregates:x.aggregates}},e.prototype.convertToQueryString=function(t,i,r){var n=[],a="table",o=t[a]||"",l="$format";delete t[a],r.dataSource.requiresFormat&&(t[l]="json");for(var h=Object.keys(t),u=0,c=h;u<c.length;u++){var d=c[u];n.push(d+"="+t[d])}return n=n.join("&"),r.dataSource.url&&r.dataSource.url.indexOf("?")!==-1&&!o?n:n.length?o+"?"+n:o||""},e.prototype.localTimeReplacer=function(t,i){for(var r=0,n=m(i)?[]:Object.keys(i);r<n.length;r++){var a=n[r];i[a]instanceof Date&&(i[a]=ce.dateParse.toLocalTime(i[a]))}return i},e.prototype.insert=function(t,i,r){return{url:(t.dataSource.insertUrl||t.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null)}},e.prototype.remove=function(t,i,r,n){var a;return typeof r=="string"&&!ce.parse.isGuid(r)?a="('"+r+"')":a="("+r+")",{type:"DELETE",url:(t.dataSource.removeUrl||t.dataSource.url).replace(/\/*$/,n?"/"+n:"")+a}},e.prototype.update=function(t,i,r,n,a,o){this.options.updateType==="PATCH"&&!m(o)&&(r=this.compareAndRemove(r,o,i));var l;return typeof r[i]=="string"&&!ce.parse.isGuid(r[i])?l="('"+r[i]+"')":l="("+r[i]+")",{type:this.options.updateType,url:(t.dataSource.updateUrl||t.dataSource.url).replace(/\/*$/,n?"/"+n:"")+l,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},e.prototype.batchRequest=function(t,i,r,n,a){var o=r.guid=ce.getGuid(this.options.batchPre),l=this.rootUrl?this.rootUrl+"/"+this.options.batch:t.dataSource.url.replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;var h={url:r.url,key:r.key,cid:1,cSet:ce.getGuid(this.options.changeSet)},u="--"+o+`
`;return u+="Content-Type: multipart/mixed; boundary="+h.cSet.replace("--","")+`
`,this.pvt.changeSet=0,u+=this.generateInsertRequest(i.addedRecords,h,t),u+=this.generateUpdateRequest(i.changedRecords,h,t,a?a.changedRecords:[]),u+=this.generateDeleteRequest(i.deletedRecords,h,t),u+=h.cSet+`--
`,u+="--"+o+"--",{type:"POST",url:l,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+o,data:u}},e.prototype.generateDeleteRequest=function(t,i,r){if(!t)return"";var n="",a={method:"DELETE ",url:function(o,l,h){var u=ce.getObject(h,o[l]);if(typeof u=="number"||ce.parse.isGuid(u))return"("+u+")";if(u instanceof Date){var c=o[l][h];return"("+c.toJSON()+")"}else return"('"+u+"')"},data:function(o,l){return""}};return n=this.generateBodyContent(t,i,a,r),n+`
`},e.prototype.generateInsertRequest=function(t,i,r){if(!t)return"";var n="",a={method:"POST ",url:function(o,l,h){return""},data:function(o,l){return JSON.stringify(o[l])+`

`}};return n=this.generateBodyContent(t,i,a,r),n},e.prototype.generateUpdateRequest=function(t,i,r,n){var a=this;if(!t)return"";var o="";t.forEach(function(h){return h=a.compareAndRemove(h,n.filter(function(u){return ce.getObject(i.key,u)===ce.getObject(i.key,h)})[0],i.key)});var l={method:this.options.updateType+" ",url:function(h,u,c){if(typeof h[u][c]=="number"||ce.parse.isGuid(h[u][c]))return"("+h[u][c]+")";if(h[u][c]instanceof Date){var d=h[u][c];return"("+d.toJSON()+")"}else return"('"+h[u][c]+"')"},data:function(h,u){return JSON.stringify(h[u])+`

`}};return o=this.generateBodyContent(t,i,l,r),o},e.getField=function(t){return t.replace(/\./g,"/")},e.prototype.generateBodyContent=function(t,i,r,n){for(var a="",o=0;o<t.length;o++)a+=`
`+i.cSet+`
`,a+=this.options.changeSetContent+`

`,a+=r.method,r.method==="POST "?a+=(n.dataSource.insertUrl||n.dataSource.crudUrl||i.url)+r.url(t,o,i.key)+` HTTP/1.1
`:r.method==="PUT "||r.method==="PATCH "?a+=(n.dataSource.updateUrl||n.dataSource.crudUrl||i.url)+r.url(t,o,i.key)+` HTTP/1.1
`:r.method==="DELETE "&&(a+=(n.dataSource.removeUrl||n.dataSource.crudUrl||i.url)+r.url(t,o,i.key)+` HTTP/1.1
`),a+="Accept: "+this.options.accept+`
`,a+="Content-Id: "+this.pvt.changeSet+++`
`,a+=this.options.batchChangeSetContentType+`
`,m(t[o]["@odata.etag"])?a+=`
`:(a+="If-Match: "+t[o]["@odata.etag"]+`

`,delete t[o]["@odata.etag"]),a+=r.data(t,o);return a},e.prototype.processBatchResponse=function(t,i,r,n,a){if(r&&r.headers.get("Content-Type")&&r.headers.get("Content-Type").indexOf("xml")!==-1)return i.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&ce.endsWith(n.url,this.options.batch)&&n.type.toLowerCase()==="post"){var o=r.headers.get("Content-Type"),l=void 0,h=void 0,u=t+"";if(o=o.substring(o.indexOf("=batchresponse")+1),u=u.split(o),u.length<2)return{};u=u[1];var c=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(u);c&&u.replace(c[0],"");var d=c?c[1]:"";u=u.split(d);for(var p=u.length;p>-1;p--)!/\bContent-ID:/i.test(u[p])||!/\bHTTP.+201/.test(u[p])||(l=parseInt(/\bContent-ID: (\d+)/i.exec(u[p])[1],10),a.addedRecords[l]&&(h=ce.parse.parseJson(/^\{.+\}/m.exec(u[p])[0]),me({},a.addedRecords[l],this.processResponse(h))));return a}return null},e.prototype.compareAndRemove=function(t,i,r){var n=this;return m(i)||Object.keys(t).forEach(function(a){if(a!==r&&a!=="@odata.etag")if(ce.isPlainObject(t[a])){n.compareAndRemove(t[a],i[a]);var o=Object.keys(t[a]).filter(function(l){return l!=="@odata.etag"});o.length===0&&delete t[a]}else(t[a]===i[a]||t[a]&&i[a]&&t[a].valueOf()===i[a].valueOf())&&delete t[a]}),t},e}(oo);(function(s){co(e,s);function e(t){var i=s.call(this,t)||this;return i.options=me({},i.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),me(i.options,t||{}),i}return e.prototype.getModuleName=function(){return"ODataV4Adaptor"},e.prototype.onCount=function(t){return t===!0?"true":""},e.prototype.onPredicate=function(t,i,r){var n="",a=t.value,o=a instanceof Date;if(i instanceof $e)for(var l=this.getQueryRequest(i),h=0;h<l.filters.length;h++)l.filters[h].e.key===t.value&&(r=!0);return n=s.prototype.onPredicate.call(this,t,i,r),o&&(n=n.replace(/datetime'(.*)'$/,"$1")),ce.parse.isGuid(a)&&(n=n.replace("guid","").replace(/'/g,"")),n},e.prototype.onEachSearch=function(t){var i=this.pvt.searches||[];i.push(t.key),this.pvt.searches=i},e.prototype.onSearch=function(t){return this.pvt.searches.join(" OR ")},e.prototype.onExpand=function(t){var i=this,r={},n={},a=t.expands.slice(),o=[],l=t.selects.filter(function(h){return h.indexOf(".")>-1});return l.forEach(function(h){var u=h.split(".");if(u[0]in r||(r[u[0]]=[]),u.length===2)r[u[0]].length&&Object.keys(r).indexOf(u[0])!==-1?r[u[0]][0].indexOf("$expand")!==-1&&r[u[0]][0].indexOf(";$select=")===-1?r[u[0]][0]=r[u[0]][0]+";$select="+u[1]:r[u[0]][0]=r[u[0]][0]+","+u[1]:r[u[0]].push("$select="+u[1]);else{for(var c="$select="+u[u.length-1],d="",p="",f=1;f<u.length-1;f++)d=d+"$expand="+u[f]+"(",p=p+")";var v=d+c+p;if(r[u[0]].length&&Object.keys(r).indexOf(u[0])!==-1&&i.expandQueryIndex(r[u[0]],!0)){var g=i.expandQueryIndex(r[u[0]]);r[u[0]][g]=r[u[0]][g]+v.replace("$expand=",",")}else r[u[0]].push(v)}}),Object.keys(r).forEach(function(h){a.indexOf(h)===-1&&a.push(h)}),a.forEach(function(h){n[h]=h in r?h+"("+r[h].join(";")+")":h}),Object.keys(n).forEach(function(h){return o.push(n[h])}),o.join(",")},e.prototype.expandQueryIndex=function(t,i){for(var r=0;r<t.length;r++)if(t[r].indexOf("$expand")!==-1)return i?!0:r;return i?!1:0},e.prototype.onDistinct=function(t){var i=t.map(function(r){return Bc.getField(r)}).join(",");return"groupby(("+i+"))"},e.prototype.onSelect=function(t){return s.prototype.onSelect.call(this,t.filter(function(i){return i.indexOf(".")===-1}))},e.prototype.beforeSend=function(t,i,r){(r.type==="POST"||r.type==="PUT"||r.type==="PATCH")&&i.headers.set("Prefer","return=representation"),i.headers.set("Accept",this.options.accept)},e.prototype.processResponse=function(t,i,r,n,a,o){var l="@odata.context",h="@context";if(a&&a.type==="GET"&&!this.rootUrl&&(t[l]||t[h])){var u=t[l]?t[l].split("/$metadata#"):t[h].split("/$metadata#");this.rootUrl=u[0],this.resourceTableName=u[1]}var c="pvtData",d=a&&a[c],p=s.prototype.processBatchResponse.call(this,t,r,n,a,o);if(p)return p;var f=null,v="@odata.count",g="@count";r&&r.isCountRequired&&(v in t?f=t[v]:g in t&&(f=t[g])),t=m(t.value)?t:t.value;var b={};return b.count=f,b.result=t,this.getAggregateResult(d,t,b,null,r),ce.isNull(f)?b.result:{result:b.result,count:f,aggregates:b.aggregates}},e})(Bc);(function(s){co(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.getModuleName=function(){return"WebApiAdaptor"},e.prototype.insert=function(t,i,r){return{type:"POST",url:t.dataSource.url,data:JSON.stringify(i)}},e.prototype.remove=function(t,i,r,n){return{type:"DELETE",url:t.dataSource.url+"/"+r,data:JSON.stringify(r)}},e.prototype.update=function(t,i,r,n){return{type:"PUT",url:t.dataSource.url,data:JSON.stringify(r)}},e.prototype.batchRequest=function(t,i,r){var n=this,a=r.guid=ce.getGuid(this.options.batchPre),o=t.dataSource.url.replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;for(var l=[],h=function(f,v){i.addedRecords.forEach(function(g,b){var y={method:"POST ",url:function(C,x,w){return""},data:function(C,x){return JSON.stringify(C[x])+`

`}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("POST /api/"+(t.dataSource.insertUrl||t.dataSource.crudUrl||r.url)+y.url(i.addedRecords,f,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.addedRecords.length;u<c;u++)h(u);for(var d=function(f,v){i.changedRecords.forEach(function(g,b){var y={method:n.options.updateType+" ",url:function(C,x,w){return""},data:function(C,x){return JSON.stringify(C[x])+`

`}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("PUT /api/"+(t.dataSource.updateUrl||t.dataSource.crudUrl||r.url)+y.url(i.changedRecords,f,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.changedRecords.length;u<c;u++)d(u);for(var p=function(f,v){i.deletedRecords.forEach(function(g,b){var y={mtd:"DELETE ",url:function(C,x,w){var M=ce.getObject(w,C[x]);if(typeof M=="number"||ce.parse.isGuid(M))return"/"+M;if(M instanceof Date){var E=C[x][w];return"/"+E.toJSON()}else return"/'"+M+"'"},data:function(C,x){return""}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("DELETE /api/"+(t.dataSource.removeUrl||t.dataSource.crudUrl||r.url)+y.url(i.deletedRecords,f,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.deletedRecords.length;u<c;u++)p(u);return l.push("--"+a+"--",""),{type:"POST",url:o,contentType:"multipart/mixed; boundary="+a,data:l.join(`\r
`)}},e.prototype.beforeSend=function(t,i,r){i.headers.set("Accept","application/json, text/javascript, */*; q=0.01")},e.prototype.processResponse=function(t,i,r,n,a,o){var l="pvtData",h=a&&a[l],u=null,c={};if(a&&a.type.toLowerCase()!=="post"){var d=n&&a.fetchRequest.headers.get("DataServiceVersion"),p=d&&parseInt(d,10)||2;r&&r.isCountRequired&&(ce.isNull(t.Count)||(u=t.Count)),p<3&&t.Items&&(t=t.Items),c.count=u,c.result=t,this.getAggregateResult(h,t,c,null,r)}return c.result=c.result||t,ce.isNull(u)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}},e})(Bc);(function(s){co(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.processQuery=function(t,i,r){var n=new oo().processQuery(t,i,r),a="data",o=ce.parse.parseJson(n[a]),l={},h="value";if(o.param)for(var u=0;u<o.param.length;u++){var c=o.param[u],d=Object.keys(c)[0];l[d]=c[d]}l[h]=o;var p="pvtData",f="url";return{data:JSON.stringify(l),url:n[f],pvtData:n[p],type:"POST",contentType:"application/json; charset=utf-8"}},e})(oo);var YW=function(s){co(e,s);function e(){var t=s.call(this)||this;return kt("beforeSend",oo.prototype.beforeSend,t),t}return e.prototype.insert=function(t,i,r,n,a){return this.pvt.position=a,this.updateType="add",{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{value:i,table:r,action:"insert"},ce.getAddParams(this,t,n)))}},e.prototype.remove=function(t,i,r,n,a){return s.prototype.remove.call(this,t,i,r),{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{key:r,keyColumn:i,table:n,action:"remove"},ce.getAddParams(this,t,a)))}},e.prototype.update=function(t,i,r,n,a){return this.updateType="update",this.updateKey=i,{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(me({},{value:r,action:"update",keyColumn:i,key:r[i],table:n},ce.getAddParams(this,t,a)))}},e.prototype.processResponse=function(t,i,r,n,a,o,l){var h,u=a?JSON.parse(a.data):t;if(t=u.action==="batch"?ce.parse.parseJson(t):t,this.updateType==="add"&&s.prototype.insert.call(this,i,t,null,null,this.pvt.position),this.updateType==="update"&&s.prototype.update.call(this,i,this.updateKey,t),this.updateType=void 0,t.added)for(h=0;h<t.added.length;h++)s.prototype.insert.call(this,i,t.added[h]);if(t.changed)for(h=0;h<t.changed.length;h++)s.prototype.update.call(this,i,l.key,t.changed[h]);if(t.deleted)for(h=0;h<t.deleted.length;h++)s.prototype.remove.call(this,i,l.key,t.deleted[h]);return t},e.prototype.batchRequest=function(t,i,r,n,a){return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(me({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r.url,key:r.key},ce.getAddParams(this,t,n)))}},e.prototype.addParams=function(t){var i=new oo;i.addParams(t)},e}(Xw),QW=function(s){co(e,s);function e(t){var i=s.call(this)||this;return i.options=me({},i.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),me(i.options,t||{}),i}return e.prototype.getModuleName=function(){return"CustomDataAdaptor"},e}(oo);(function(s){co(e,s);function e(t){var i=s.call(this)||this;return i.opt=t,i.schema=i.opt.response,i.query=i.opt.query,i.getVariables=i.opt.getVariables?i.opt.getVariables:function(){},i.getQuery=function(){return i.query},i}return e.prototype.getModuleName=function(){return"GraphQLAdaptor"},e.prototype.processQuery=function(t,i){var r=s.prototype.processQuery.apply(this,arguments),n=JSON.parse(r.data),a=["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"],o={},l="searchwhereparams";a.filter(function(c){o[c]=l.indexOf(c)>-1?JSON.stringify(n[c]):n[c]});var h=this.getVariables()||{};h.datamanager=o;var u=JSON.stringify({query:this.getQuery(),variables:h});return r.data=u,r},e.prototype.processResponse=function(t,i,r,n,a){var o=t,l,h,u=ie(this.schema.result,o.data);this.schema.count&&(l=ie(this.schema.count,o.data)),this.schema.aggregates&&(h=ie(this.schema.aggregates,o.data),h=m(h)?h:ce.parse.parseJson(h));var c=a.pvtData||{},d={result:u,aggregates:h},p=d;return c&&c.groups&&c.groups.length&&this.getAggregateResult(c,p,d,null,r),m(l)?d.result:{result:d.result,count:l,aggregates:h}},e.prototype.insert=function(){var t=s.prototype.insert.apply(this,arguments);return this.generateCrudData(t,"insert")},e.prototype.update=function(){var t=s.prototype.update.apply(this,arguments);return this.generateCrudData(t,"update")},e.prototype.remove=function(){var t=s.prototype.remove.apply(this,arguments);return this.generateCrudData(t,"remove")},e.prototype.batchRequest=function(t,i,r,n,a){var o=s.prototype.batchRequest.apply(this,arguments),l=JSON.parse(o.data);return l.key=r.key,o.data=JSON.stringify(l),this.generateCrudData(o,"batch")},e.prototype.generateCrudData=function(t,i){var r=JSON.parse(t.data);return t.data=JSON.stringify({query:this.opt.getMutation(i),variables:r}),t},e})(oo);var GW=function(s){co(e,s);function e(t,i,r){var n=s.call(this)||this;n.isCrudAction=!1,n.isInsertAction=!1,m(t)||(n.cacheAdaptor=t),n.pageSize=r,n.guidId=ce.getGuid("cacheAdaptor");var a={keys:[],results:[]};window.localStorage.setItem(n.guidId,JSON.stringify(a));var o=n.guidId;return m(i)||setInterval(function(){for(var l=ce.parse.parseJson(window.localStorage.getItem(o)),h=[],u=0;u<l.results.length;u++){var c=+new Date,d=+new Date(l.results[u].timeStamp);l.results[u].timeStamp=c-d,c-d>i&&h.push(u)}for(var u=0;u<h.length;u++)l.results.splice(h[u],1),l.keys.splice(h[u],1);window.localStorage.removeItem(o),window.localStorage.setItem(o,JSON.stringify(l))},i),n}return e.prototype.generateKey=function(t,i){var r=this.getQueryRequest(i),n=$e.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=t,o="onPage";o in n&&(a+=n[o].pageIndex),r.sorts.forEach(function(d){a+=d.e.direction+d.e.fieldName}),r.groups.forEach(function(d){a+=d.e.fieldName}),r.searches.forEach(function(d){a+=d.e.searchKey});for(var l=0;l<r.filters.length;l++){var h=r.filters[l];if(h.e.isComplex){var u=i.clone();u.queries=[];for(var c=0;c<h.e.predicates.length;c++)u.queries.push({fn:"onWhere",e:h.e.predicates[c],filter:i.queries.filter});a+=h.e.condition+this.generateKey(t,u)}else a+=h.e.field+h.e.operator+h.e.value}return a},e.prototype.processQuery=function(t,i,r){var n=this.generateKey(t.dataSource.url,i),a=ce.parse.parseJson(window.localStorage.getItem(this.guidId)),o=a?a.results[a.keys.indexOf(n)]:null;return o!=null&&!this.isCrudAction&&!this.isInsertAction?o:(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0)))},e.prototype.processResponse=function(t,i,r,n,a,o){if(this.isInsertAction||a&&this.cacheAdaptor.options.batch&&ce.endsWith(a.url,this.cacheAdaptor.options.batch)&&a.type.toLowerCase()==="post")return this.cacheAdaptor.processResponse(t,i,r,n,a,o);t=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var l=r?this.generateKey(i.dataSource.url,r):i.dataSource.url,h={};h=ce.parse.parseJson(window.localStorage.getItem(this.guidId));var u=h.keys.indexOf(l);for(u!==-1&&(h.results.splice(u,1),h.keys.splice(u,1)),h.results[h.keys.push(l)-1]={keys:l,result:t.result,timeStamp:new Date,count:t.count};h.results.length>this.pageSize;)h.results.splice(0,1),h.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(h)),t},e.prototype.beforeSend=function(t,i,r){!m(this.cacheAdaptor.options.batch)&&ce.endsWith(r.url,this.cacheAdaptor.options.batch)&&r.type.toLowerCase()==="post"&&i.headers.set("Accept",this.cacheAdaptor.options.multipartAccept),t.dataSource.crossDomain||i.headers.set("Accept",this.cacheAdaptor.options.accept)},e.prototype.update=function(t,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.update(t,i,r,n)},e.prototype.insert=function(t,i,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(t,i,r)},e.prototype.remove=function(t,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(t,i,r,n)},e.prototype.batchRequest=function(t,i,r){return this.cacheAdaptor.batchRequest(t,i,r)},e}(oo),ge=function(){function s(e,t,i){var r=this;this.dateParse=!0,this.timeZoneHandling=!0,this.persistQuery={},this.isInitialLoad=!1,this.requests=[],this.isInitialLoad=!0,!e&&!this.dataSource&&(e=[]),i=i||e.adaptor,e&&e.timeZoneHandling===!1&&(this.timeZoneHandling=e.timeZoneHandling);var n;return e instanceof Array?n={json:e,offline:!0}:typeof e=="object"?(e.json||(e.json=[]),e.enablePersistence||(e.enablePersistence=!1),e.id||(e.id=""),e.ignoreOnPersist||(e.ignoreOnPersist=[]),n={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:e.offline!==void 0?e.offline:e.adaptor instanceof YW||e.adaptor instanceof QW?!1:!e.url,requiresFormat:e.requiresFormat,enablePersistence:e.enablePersistence,id:e.id,ignoreOnPersist:e.ignoreOnPersist}):ce.throwError("DataManager: Invalid arguments"),n.requiresFormat===void 0&&!ce.isCors()&&(n.requiresFormat=m(n.crossDomain)?!0:n.crossDomain),n.dataType===void 0&&(n.dataType="json"),this.dataSource=n,this.defaultQuery=t,this.dataSource.enablePersistence&&this.dataSource.id&&window.addEventListener("unload",this.setPersistData.bind(this)),n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=i||new Bc,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new $e),this.ready.then(function(a){r.dataSource.offline=!0,r.isDataAvailable=!0,n.json=a.result,r.adaptor=new Xw})):this.adaptor=n.offline?new Xw:new Bc,!n.jsonp&&this.adaptor instanceof Bc&&(n.jsonp="callback"),this.adaptor=i||this.adaptor,n.enableCaching&&(this.adaptor=new GW(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}return s.prototype.getPersistedData=function(e){var t=localStorage.getItem(e||this.dataSource.id);return JSON.parse(t)},s.prototype.setPersistData=function(e,t,i){localStorage.setItem(t||this.dataSource.id,JSON.stringify(i||this.persistQuery))},s.prototype.setPersistQuery=function(e){var t=this,i=this.getPersistedData();if(this.isInitialLoad&&i&&Object.keys(i).length){this.persistQuery=i,this.persistQuery.queries=this.persistQuery.queries.filter(function(n){if(t.dataSource.ignoreOnPersist&&t.dataSource.ignoreOnPersist.length&&n.fn&&t.dataSource.ignoreOnPersist.some(function(l){return n.fn===l}))return!1;if(n.fn==="onWhere"){var a=n.e;if(a&&a.isComplex&&a.predicates instanceof Array){var o=a.predicates.map(function(l){if(l.predicates&&l.predicates instanceof Array){var h=l.predicates.map(function(g){var b=g.field,y=g.operator,C=g.value,x=g.ignoreCase,w=g.ignoreAccent,M=g.matchCase;return new It(b,y,C,x,w,M)});return l.condition==="and"?It.and(h):It.or(h)}else{var u=l.field,c=l.operator,d=l.value,p=l.ignoreCase,f=l.ignoreAccent,v=l.matchCase;return new It(u,c,d,p,f,v)}});n.e=new It(o[0],a.condition,o.slice(1))}}return!0});var r=me(new $e,this.persistQuery);return this.isInitialLoad=!1,r}else return this.persistQuery=e,this.isInitialLoad=!1,e},s.prototype.setDefaultQuery=function(e){return this.defaultQuery=e,this},s.prototype.executeLocal=function(e){!this.defaultQuery&&!(e instanceof $e)&&ce.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||ce.throwError("DataManager - executeLocal() : Json data is required to execute"),this.dataSource.enablePersistence&&this.dataSource.id&&(e=this.setPersistQuery(e)),e=e||this.defaultQuery;var t=this.adaptor.processQuery(this,e);if(e.subQuery){var i=e.subQuery.fromTable,r=e.subQuery.lookups,n=e.isCountRequired?t.result:t;r&&r instanceof Array&&ce.buildHierarchy(e.subQuery.fKey,i,n,r,e.subQuery.key);for(var a=0;a<n.length;a++)n[a][i]instanceof Array&&(n[a]=me({},{},n[a]),n[a][i]=this.adaptor.processResponse(e.subQuery.using(new s(n[a][i].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)},s.prototype.executeQuery=function(e,t,i,r){var n=this,a="makeRequest";this.dataSource.enablePersistence&&this.dataSource.id&&(e=this.setPersistQuery(e)),typeof e=="function"&&(r=i,i=t,t=e,e=null),e||(e=this.defaultQuery),e instanceof $e||ce.throwError("DataManager - executeQuery() : A query is required to execute");var o=new xa,l={query:e};if(!this.dataSource.offline&&this.dataSource.url!==void 0&&this.dataSource.url!==""||!m(this.adaptor[a])||this.isCustomDataAdaptor(this.adaptor)){var h=this.adaptor.processQuery(this,e);m(this.adaptor[a])?!m(h.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(h,o,l,e)):(l=s.getDeferedArgs(e,h,l),o.resolve(l)):this.adaptor[a](h,o,l,e)}else s.nextTick(function(){var u=n.executeLocal(e);l=s.getDeferedArgs(e,u,l),o.resolve(l)});return(t||i)&&o.promise.then(t,i),r&&o.promise.then(r,r),o.promise},s.getDeferedArgs=function(e,t,i){return e.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i},s.nextTick=function(e){(window.setImmediate||window.setTimeout)(e,0)},s.prototype.extendRequest=function(e,t,i){return me({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},e)},s.prototype.makeRequest=function(e,t,i,r){var n=this,a=!!r.subQuerySelector,o=function(g){i.error=g,t.reject(i)},l=function(g,b,y,C,x,w,M){i.xhr=y,i.count=b?parseInt(b.toString(),10):0,i.result=g,i.request=C,i.aggregates=w,i.actual=x,i.virtualSelectRecords=M,t.resolve(i)},h=function(g,b){var y=new xa,C={parent:i};r.subQuery.isChild=!0;var x=n.adaptor.processQuery(n,r.subQuery,g?n.adaptor.processResponse(g):b),w=n.makeRequest(x,y,C,r.subQuery);return a||y.then(function(M){g&&(ce.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,g,M,r.subQuery.key),l(g,M.count,M.xhr))},o),w},u=function(g,b){if(n.isGraphQLAdaptor(n.adaptor)&&!m(g.errors))return o(g.errors);n.isCustomDataAdaptor(n.adaptor)&&(b=me({},n.fetchReqOption,b)),b.contentType.indexOf("xml")===-1&&n.dateParse&&(g=ce.parse.parseJson(g));var y=n.adaptor.processResponse(g,n,r,b.fetchRequest,b),C=0,x=null,w="virtualSelectRecords",M=g[w];if(r.isCountRequired&&(C=y.count,x=y.aggregates,y=y.result),!r.subQuery){l(y,C,b.fetchRequest,b.type,g,x,M);return}a||h(y,b)},c=this.extendRequest(e,u,o);if(this.isCustomDataAdaptor(this.adaptor)){this.fetchReqOption=c;var p=c;this.adaptor.options.getData({data:p.data,onSuccess:p.onSuccess,onFailure:p.onFailure})}else{var d=new LC(c);d.beforeSend=function(){n.beforeSend(d.fetchRequest,d)},c=d.send(),c.catch(function(g){return!0}),this.requests.push(d)}if(a){var f=void 0,v=r.subQuerySelector.call(this,{query:r.subQuery,parent:r});v&&v.length?(f=Promise.all([c,h(null,v)]),f.then(function(){for(var g=[],b=0;b<arguments.length;b++)g[b]=arguments[b];var y=g[0],C=n.adaptor.processResponse(y[0],n,r,n.requests[0].fetchRequest,n.requests[0]),x=0;r.isCountRequired&&(x=C.count,C=C.result);var w=n.adaptor.processResponse(y[1],n,r.subQuery,n.requests[1].fetchRequest,n.requests[1]);x=0,r.subQuery.isCountRequired&&(x=w.count,w=w.result),ce.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,C,w,r.subQuery.key),a=!1,l(C,x,n.requests[0].fetchRequest)})):a=!1}return c},s.prototype.beforeSend=function(e,t){this.adaptor.beforeSend(this,e,t);for(var i=this.dataSource.headers,r,n=0;i&&n<i.length;n++){r=[];for(var a=Object.keys(i[n]),o=0,l=a;o<l.length;o++){var h=l[o];r.push(h),e.headers.set(h,i[n][h])}}},s.prototype.saveChanges=function(e,t,i,r,n){var a=this;i instanceof $e&&(r=i,i=null);var o={url:i,key:t||this.dataSource.key},l=this.adaptor.batchRequest(this,e,o,r||new $e,n),h="dofetchRequest";if(this.dataSource.offline)return l;if(m(this.adaptor[h])){if(this.isCustomDataAdaptor(this.adaptor))return this.dofetchRequest(l,this.adaptor.options.batchUpdate);var u=new xa,c=new LC(l);return c.beforeSend=function(){a.beforeSend(c.fetchRequest,c)},c.onSuccess=function(d,p){a.isGraphQLAdaptor(a.adaptor)&&(m(d.errors)||c.onFailure(JSON.stringify(d.errors))),u.resolve(a.adaptor.processResponse(d,a,null,p.fetchRequest,p,e,o))},c.onFailure=function(d){u.reject([{error:d}])},c.send().catch(function(d){return!0}),u.promise}else return this.adaptor[h](l)},s.prototype.insert=function(e,t,i,r){t instanceof $e&&(i=t,t=null);var n=this.adaptor.insert(this,e,t,i,r),a="dofetchRequest";return this.dataSource.offline?n:m(this.adaptor[a])?this.dofetchRequest(n,this.adaptor.options.addRecord):this.adaptor[a](n)},s.prototype.remove=function(e,t,i,r){typeof t=="object"&&(t=ce.getObject(e,t)),i instanceof $e&&(r=i,i=null);var n=this.adaptor.remove(this,e,t,i,r),a="dofetchRequest";if(this.dataSource.offline)return n;if(m(this.adaptor[a])){var o=this.adaptor.options.deleteRecord;return this.dofetchRequest(n,o)}else return this.adaptor[a](n)},s.prototype.update=function(e,t,i,r,n){i instanceof $e&&(r=i,i=null);var a=this.adaptor.update(this,e,t,i,r,n),o="dofetchRequest";if(this.dataSource.offline)return a;if(m(this.adaptor[o])){var l=this.adaptor.options.updateRecord;return this.dofetchRequest(a,l)}else return this.adaptor[o](a)},s.prototype.isCustomDataAdaptor=function(e){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="CustomDataAdaptor"},s.prototype.isGraphQLAdaptor=function(e){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="GraphQLAdaptor"},s.prototype.successFunc=function(e,t){if(this.isGraphQLAdaptor(this.adaptor)){var i=JSON.parse(e);m(i.errors)||this.failureFunc(JSON.stringify(i.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=me({},this.fetchReqOption,t));try{ce.parse.parseJson(e)}catch{e=[]}e=this.adaptor.processResponse(ce.parse.parseJson(e),this,null,t.fetchRequest,t),this.fetchDeffered.resolve(e)},s.prototype.failureFunc=function(e){this.fetchDeffered.reject([{error:e}])},s.prototype.dofetchRequest=function(e,t){var i=this;if(e=me({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.fetchDeffered=new xa,this.isCustomDataAdaptor(this.adaptor))this.fetchReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{var r=new LC(e);r.beforeSend=function(){i.beforeSend(r.fetchRequest,r)},r.onSuccess=this.successFunc.bind(this),r.onFailure=this.failureFunc.bind(this),r.send().catch(function(n){return!0})}return this.fetchDeffered.promise},s.prototype.clearPersistence=function(){window.removeEventListener("unload",this.setPersistData.bind(this)),this.dataSource.enablePersistence=!1,this.persistQuery={},window.localStorage.setItem(this.dataSource.id,"[]")},s}(),xa=function(){function s(){var e=this;this.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return s}(),AP=function(){function s(e){this.parent=e,this.requestedInfo=[],this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(od,this.updateSheetFromDataSourceHandler,this),this.parent.on(Kw,this.dataSourceChangedHandler,this),this.parent.on(wg,this.dataChangedHandler,this),this.parent.on(Nf,this.triggerDataChangeHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(od,this.updateSheetFromDataSourceHandler),this.parent.off(Kw,this.dataSourceChangedHandler),this.parent.off(wg,this.dataChangedHandler),this.parent.off(Nf,this.triggerDataChangeHandler))},s.prototype.updateSheetFromDataSourceHandler=function(e){var t=this,i,r,n,a,o,l,h=[],u=[],c,d,p=new xa,f,v,g;e.promise=p.promise;var b,y=e.autoDetectFormat,C=y&&rz(this.parent);if(e.sheet&&e.sheet.ranges.length)for(var x=function(E){var T=e.sheet.ranges[E];b=ee(T.startCell),e.isSaveAction&&(e.indexes=b);var D=e.indexes[0],N=e.indexes[2];f=b[0],l=T.dataSource instanceof ge?T.dataSource:T.dataSource?new ge(T.dataSource):new ge,o=o||l.dataSource.url,e.sheet.isLocalData=!l.dataSource.url,f<=D?D=D-f:f<=N?(N=N-f,D=0):D=-1,T.showFieldAsHeader&&D!==0&&(D-=1);var A=!1,L=0;w.initRangeInfo(T);var k=w.getMaxCount(T);if(g=w.getLoadedInfo(D,N,T),D=g.unloadedRange[0],N=g.unloadedRange[1],T.info.insertRowRange&&(T.info.insertRowRange.forEach(function(R){L+=R[1]-R[0]+1}),D-=L,N-=L),D>=k?A=!0:N>k&&(N=k),e.loadComplete||w.requestedInfo.push({deferred:p,indexes:e.indexes,isNotLoaded:g.isNotLoaded}),D>=0&&g.isNotLoaded&&!A){u[E]=D,h[E]=!1;var O=(T.query?T.query:new $e).clone();l.executeQuery(O.range(D,N>=k?N:N+1).requiresCount()).then(function(R){if(!(!t.parent||t.parent.isDestroyed)){if(a=R.result&&R.result.result?R.result.result:R.result,n=ee(T.startCell),f=n[0],v=n[1],a&&a.length){if(T.info.count||(k=R.count,T.info.count=R.count),r=T.info.flds||Object.keys(a[0]),T.info.fldLen||(T.info.fldLen=r.length,T.info.flds=r),T.info.insertColumnRange){var j=0;T.info.insertColumnRange.forEach(function(G){for(var Z=G[0];Z<=G[1];Z++)Z<=v?r.splice(0,0,"emptyCell"+j):r.splice(Z-v,0,"emptyCell"+j),j++})}u[E]===0&&T.showFieldAsHeader&&(c=f+u[E]+L,r.forEach(function(G,Z){i=Y(c,v+Z,e.sheet,!0),i?G.includes("emptyCell")||(i.value=G):e.sheet.rows[f+u[E]].cells[v+Z]=G.includes("emptyCell")?{}:{value:G}})),a.forEach(function(G,Z){c=f+u[E]+Z+(T.showFieldAsHeader?1:0)+L;for(var se=0;se<r.length;se++)d=v+se,i=Y(c,d,e.sheet,!0),i?r[se].includes("emptyCell")||Ht(c,d,e.sheet,t.getCellDataFromProp(G[r[se]]),!0):i=e.sheet.rows[c].cells[d]=r[se].includes("emptyCell")?{}:t.getCellDataFromProp(G[r[se]]),y&&C(i)})}else r=[];var P;f+(k||R.count)>0?P=f+(k||R.count)+(T.showFieldAsHeader?1:0)+L-1:P=e.sheet.usedRange.rowIndex;var F=v+r.length-1<0?e.sheet.usedRange.colIndex:v+r.length-1,z={rowIndex:P,colIndex:F};if(e.isFinite&&(z.rowIndex=P<e.sheet.rowCount?P:e.sheet.rowCount-1,z.colIndex=F<e.sheet.colCount?F:e.sheet.colCount-1),e.sheet.usedRange.rowIndex<z.rowIndex&&(e.sheet.usedRange.rowIndex=z.rowIndex),e.sheet.usedRange.colIndex<z.colIndex&&(e.sheet.usedRange.colIndex=z.colIndex),L?(g=t.getLoadedInfo(D,N,T),D=g.unloadedRange[0],N=g.unloadedRange[1],D>k&&(g.isNotLoaded=!1),g.isNotLoaded&&(N>k&&(N=k),T.info.loadedRange.push([D,N]))):T.info.loadedRange.push([D,N]),h[E]=!0,h.indexOf(!1)===-1){var q=void 0;if(N+f<f+T.info.count){e.rangeSettingCount||(e.rangeSettingCount=[]),e.rangeSettingCount.push(E),q=!0;var X={sheet:e.sheet,indexes:[0,0,P,F],promise:new Promise(function(G,Z){G(function(){}())}),rangeSettingCount:e.rangeSettingCount,isFinite:e.isFinite,loadComplete:e.loadComplete,autoDetectFormat:e.autoDetectFormat,resolveAfterFullDataLoaded:e.resolveAfterFullDataLoaded};t.updateSheetFromDataSourceHandler(X),X.promise.then(function(){t.parent.getModuleName()!=="workbook"&&(e.rangeSettingCount.pop(),e.rangeSettingCount.length||t.parent.notify("created",null),e.formulaCellRef?t.notfyFormulaCellRefresh(e.formulaCellRef,e.sheetIndex):e.loadComplete&&e.loadComplete())})}else e.formulaCellRef?t.notfyFormulaCellRefresh(e.formulaCellRef,e.sheetIndex):e.loadComplete&&e.loadComplete();q&&e.resolveAfterFullDataLoaded||(t.checkResolve(e.indexes),e.resolveAfterFullDataLoaded&&t.checkResolve([0,0,0,0]))}}})}else E===0&&h.indexOf(!1)===-1&&w.checkResolve(e.indexes)},w=this,M=e.sheet.ranges.length-1;M>=0;M--)x(M);else p.resolve()},s.prototype.notfyFormulaCellRefresh=function(e,t){this.parent.formulaRefCell=null,this.parent.notify("updateView",{indexes:ee(e),sheetIndex:t,refreshing:!0})},s.prototype.checkResolve=function(e){var t,i,r=0;this.requestedInfo.forEach(function(n,a){i=JSON.stringify(n.indexes)===JSON.stringify(e),(i||t)&&(a===0?(n.deferred.resolve(),r++,t=!0):t&&(n.isLoaded||!n.isNotLoaded)||i&&t?(n.deferred.resolve(),r++):i?n.isLoaded=!0:t=!1)}),this.requestedInfo.splice(0,r)},s.prototype.getCellDataFromProp=function(e){var t={};return Object.prototype.toString.call(e)==="[object Object]"?e.formula?t.formula=e.formula:m(e.value)||(typeof e.value=="string"&&(e.value.indexOf("http://")===0||e.value.indexOf("https://")===0||e.value.indexOf("ftp://")===0||e.value.indexOf("www.")===0)?(t.hyperlink=e.value,t.style={textDecoration:"underline",color:"#00e"}):t.value=e.value):Bt(e)?t.formula=e:typeof e=="string"&&(e.indexOf("http://")===0||e.indexOf("https://")===0||e.indexOf("ftp://")===0||e.indexOf("www.")===0)?(t.hyperlink=e,t.style={textDecoration:"underline",color:"#00e"}):t.value=e,t},s.prototype.getLoadedInfo=function(e,t,i){var r=!0;return i.info.loadedRange.forEach(function(n){n[0]<=e&&e<=n[1]?n[0]<=t&&t<=n[1]?r=!1:e=n[1]+1:n[0]<=t&&t<=n[1]&&(t=n[0]-1)}),{isNotLoaded:r,unloadedRange:[e,t]}},s.prototype.getMaxCount=function(e){if(e.query){for(var t=e.query.queries,i=0;i<t.length;i++)if(t[i].fn==="onTake")return Math.min(t[i].e.nos,e.info.count||t[i].e.nos)}return e.info.count},s.prototype.initRangeInfo=function(e){e.info||(e.info={loadedRange:[]})},s.prototype.dataSourceChangedHandler=function(e){var t=this,i,r=this.parent.sheets[e.sheetIdx],n=r.ranges[e.rangeIdx];if(n&&(this.checkRangeHasChanges(r,e.rangeIdx)||!n.info)){var a=n.showFieldAsHeader,o=xe(n.startCell);n.info&&(n.info.loadedRange.forEach(function(c){for(var d=c[0];d<=c[1]&&d<n.info.count+(a?1:0);d++)if(i=r.rows[d+o[0]],i)for(var p=o[1];p<o[1]+n.info.fldLen;p++)i.cells&&i.cells[p]&&delete i.cells[p]}),n.info=null);var l=this.parent.viewport,h=[l.topIndex,l.leftIndex,l.bottomIndex,l.rightIndex],u={sheet:r,indexes:h,dataSourceChange:!0,promise:new Promise(function(c,d){c(function(){}())})};this.updateSheetFromDataSourceHandler(u),u.promise.then(function(){t.parent.trigger("dataSourceChanged",{data:e.changedData,action:"dataSourceChanged",rangeIndex:Number(e.rangeIdx),sheetIndex:Number(e.sheetIdx)}),t.parent.notify("updateView",{indexes:h,checkWrap:!0,checkCF:!0})})}},s.prototype.checkRangeHasChanges=function(e,t){return this.parent.isAngular?e.changedRangeIdx===parseInt(t,10)?(delete e.changedRangeIdx,!0):!1:!0},s.prototype.dataChangedHandler=function(e){var t=this,i=[{}],r,n,a,o,l,h,u,c=e.sheetIdx===void 0?this.parent.activeSheetIndex:e.sheetIdx,d=this.parent.sheets[c],p,f;d.ranges.forEach(function(v,g){if(v.dataSource){var b=void 0;if(o=xe(v.startCell),a=o.concat([o[0]+v.info.count+(v.showFieldAsHeader?0:-1),o[1]+v.info.fldLen-1]),e.modelType==="Row"||e.modelType==="Column")if(e.modelType==="Column"){if(e.insertType)l=a[1]<e.index&&a[3]>=e.index,p=[e.index],l?(e.model.forEach(function(){v.info.flds.splice(e.index-o[1],0,"")}),v.info.fldLen+=e.model.length):a[3]+1===e.index&&e.insertType==="after"?(e.model.forEach(function(){v.info.flds.splice(e.index-o[1],0,"")}),v.info.fldLen+=e.model.length):a[1]>=e.index&&(v.startCell=Je(o[0],o[1]+e.model.length));else if(l=a[1]<=e.startIndex&&a[3]>=e.startIndex,l)for(var y=e.startIndex;y<=e.endIndex;y++)y<=a[3]&&(v.info.flds.splice(e.startIndex,1),v.info.fldLen-=1);return}else if(e.insertType){if(l=(!v.showFieldAsHeader&&(e.insertType==="above"||e.isMethod)?a[0]<=e.index:a[0]<e.index)&&a[2]>=e.index,p=[e.index],l||a[2]+1===e.index&&e.insertType==="below"?(b=!0,v.info.count+=e.model.length):a[0]>=e.index&&(v.startCell=Je(o[0]+e.model.length,o[1])),e.isMethod)return}else l=a[0]<=e.startIndex&&a[2]>=e.startIndex,e.isDataRequest?p=[e.startIndex,a[1],e.startIndex,a[1]]:r="delete";else{p=ee(e.requestType&&e.requestType.toLowerCase().includes("paste")?e.pastedRange.split("!")[1]:e.sheetIdx>-1?e.address:(e.address||e.range||e.fillRange).split("!")[1]);var C=[v.showFieldAsHeader?a[0]+1:a[0]].concat(a.slice(1,4));if(v.showFieldAsHeader&&p[0]===o[0])for(var y=p[1];y<=p[3];y++)y>=C[1]&&y<=C[3]&&(v.info.flds[y-o[1]]=Y(o[0],y,d,!1,!0).value||"");if(l=Uf(C,p,!0),e.requestType==="paste"&&e.copiedInfo.isCut){if(f=[].slice.call(e.copiedInfo.range),v.showFieldAsHeader&&f[0]===o[0]){for(var y=f[1];y<=f[3];y++)y>=C[1]&&y<=C[3]&&(v.info.flds[y-o[1]]="");l=!1}h=Uf(C,f,!0)}}if(l||b||h){if(e.modelType==="Row"&&!e.insertType&&!e.isDataRequest){if(e.deletedModel.forEach(function(N,A){i[A]={},v.info.flds.forEach(function(L,k){N.cells?(n=N.cells[o[1]+k],i[A][""+L]=t.getFormattedValue(n)):i[A][""+L]=null}),v.info.count-=1}),e.isMethod)return;u={count:e.deletedModel.length,index:e.endIndex}}else{r=b?"add":"edit";var x=0;if(h){x=f[2]-f[0]+1;for(var w=function(N){i[N]={},v.info.flds.forEach(function(A,L){A&&(n=Y(f[0]+N,o[1]+L,d),i[N][""+A]=t.getFormattedValue(n))})},y=0;y<x;y++)w(y)}if(l||b)for(var M=!e.isDataRequest&&!h&&!b&&!e.skipFilterCheck,E=function(N,A){if(M&&Aa(d,p[0]+N))return T=A,"continue";i[A+x]={},v.info.flds.forEach(function(L,k){L&&(n=Y(p[0]+N,o[1]+k,d),i[A+x][""+L]=t.getFormattedValue(n))}),A++,T=A},T,y=0,D=0;y<(b?e.model.length:p[2]-p[0]+1||1);y++)E(y,D),D=T}e.isDataRequest?e.data=i:t.parent.trigger("dataSourceChanged",{data:i,action:r,rangeIndex:g,sheetIndex:c})}else u&&u.count&&a[0]>u.index&&(v.startCell=Je(o[0]-u.count,o[1]))}})},s.prototype.getFormattedValue=function(e){var t=this.parent.getDisplayText(e);return t===""?null:e&&!e.format&&typeof e.value=="number"?e.value:t},s.prototype.triggerDataChangeHandler=function(e){var t=["insert","delete","edit","cellDelete","cellSave","autofill","clipboard","clear"],i=!0;if(((e.action==="delete"||e.action==="insert")&&["Sheet"].indexOf(e.eventArgs.modelType)>-1||e.action==="clear"&&["Clear Formats","Clear Hyperlinks"].indexOf(e.eventArgs.type)>-1||e.action==="clipboard"&&e.eventArgs.requestType==="Formats")&&(i=!1),i&&t.indexOf(e.action)>-1){var r=void 0;e.isUndo&&(e.action==="delete"||e.action==="insert")?(r=me({},e.eventArgs),e.action==="delete"?(r.index=r.startIndex,r.model=r.deletedModel,r.insertType="below"):(r.startIndex=r.index,r.endIndex=e.eventArgs.index+e.eventArgs.model.length-1,r.deletedModel=r.model,delete r.insertType)):r=e.eventArgs,this.parent.notify(wg,r)}},s.prototype.getModuleName=function(){return"dataBind"},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.requestedInfo=[]},s}(),NP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.open=function(e){var t=this;if(this.parent.allowOpen){if(e.jsonObject){this.fetchSuccess(e.jsonObject,e,null,!0,!0);return}var i=new FormData;if(e.file)i.append("file",e.file);else if(e.sheetIndex>=0)i.append("sheetPassword",e.sheetPassword),i.append("sheetIndex",e.sheetIndex.toString());else{this.parent.isOpen=!1;return}var r={passWord:""};e.password&&e.password.length&&(r.passWord=e.password),r.passWord&&r.passWord.length&&(e.password=r.passWord),e.password&&i.append("password",e.password);var n={file:e.file||null,cancel:!1,requestData:{method:"POST",body:i},password:r.passWord},a=e.guid;if(m(e.sheetPassword)&&!a?(this.parent.trigger("beforeOpen",n),this.parent.notify(li,{eventArgs:n,action:"beforeOpen"})):a&&i.append("guid",a),n.cancel){this.parent.isOpen=!1;return}fetch(this.parent.openUrl,n.requestData).then(function(o){return o.ok?o.json():Promise.reject({status:o.status,statusText:o.statusText,url:o.url})}).then(function(o){return t.fetchSuccess(o,n,e.orginalFile,void 0,!0)}).catch(function(o){return t.fetchFailure(o)})}},s.prototype.fetchFailure=function(e){Re(e.status)&&Re(e.statusText)&&(e.statusText="Improper response"),this.parent.notify(t1,e),this.parent.isOpen=!1},s.prototype.fetchSuccess=function(e,t,i,r,n){var a=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],o=typeof e=="string"?JSON.parse(e):e,l=o.Workbook;if(a.indexOf(l)>-1){i&&(t.file=i),this.parent.notify(Ty,{context:this,data:l,guid:o.Guid,eventArgs:t,isOpenFromJson:r});return}this.updateModel(l,r,n),this.parent.notify(Ty,{context:this,data:l,isOpenFromJson:r,eventArgs:t}),this.parent.isOpen=!1,t&&t.password&&t.password.length>0&&(this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.parent.password="")},s.prototype.updateModel=function(e,t,i){this.parent.notify(xt,{action:"unRegisterSheet"}),this.setSelectAllRange(e.sheets,t),this.parent.sheetNameCount=1,this.parent.sheets=[],this.parent.notify(Jl,{}),e.activeSheetIndex=e.activeSheetIndex||0,this.parent.setProperties({isProtected:e.isProtected||!1,password:e.password||"",sheets:e.sheets,activeSheetIndex:e.activeSheetIndex,definedNames:e.definedNames||[],filterCollection:e.filterCollection||[],sortCollection:e.sortCollection||[]},!0),m(e.showSheetTabs)||(this.parent.showSheetTabs=e.showSheetTabs),kp(this.parent,void 0,i),this.parent.notify(Ff,null),this.parent.notify(xt,{action:"registerSheet",isImport:!0}),this.parent.notify(xt,{action:"initiateDefinedNames"}),this.parent.notify(u1,null)},s.prototype.setSelectAllRange=function(e,t){var i=this,r,n;e.forEach(function(a){if(a.selectedRange){var o=ee(a.selectedRange),l=(Re(a.rowCount)?100:a.rowCount)-1,h=(Re(a.colCount)?100:a.colCount)-1;o[2]===65535&&(o[2]=l),o[3]===255&&(o[3]=h),o[0]===65535&&(o[0]=l),o[1]===255&&(o[1]=h),a.selectedRange=je(o)}if(t&&i.parent.isAngular){for(var u=0;u<i.parent.sheets.length;u++)if(r=Pe(i.parent,u),a.name===r.name){a.ranges&&a.ranges.forEach(function(c,d){n=r.ranges[d],n&&n.template&&(c.template=n.template)});break}}})},s.prototype.addEventListener=function(){this.parent.on(My,this.open.bind(this))},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(My,this.open.bind(this))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"workbookOpen"},s}(),$W="workbookDestroyed",od="updateSheetFromDataSource",Kw="dataSourceChanged",wg="dataChanged",Nf="triggerDataChange",My="workbookOpen",kf="beginSave",li="actionBegin",Ey="sortImport",su="findToolDlg",Lf="exportDialog",Qp="getFilteredCollection",Of="saveCompleted",Rf="applyNumber",jn="getFormattedCell",Zw="refreshCellElem",Ri="setCellFormat",Jw="findAllValues",ld="textDecorationUpdate",dr="applyCellFormat",hd="updateRowColCount",xt="workbookFormulaOperation",au="workbookEditOperation",yn="checkDateFormat",e1="checkNumberFormat",Iy="getFormattedBarText",sa="activeCellChanged",Ty="openSuccess",t1="openFailure",Ff="sheetCreated",Jl="sheetsDestroyed",Gp="aggregateComputation",i1="getUniqueRange",ud="removeUniquecol",ou="checkUniqueRange",Dy="reApplyFormula",cd="clearFormulaDependentCells",Ay="formulaInValidation",XW="beforeSort",Pf="initiateSort",r1="updateSortedDataOnCell",$p="sortComplete",KW="beforeHyperlinkCreate",ZW="afterHyperlinkCreate",JW="beforeHyperlinkClick",e6="afterHyperlinkClick",dd="setLinkModel",Ny="initiateFilter",NA="filterRangeAlert",eh="wrapText",n1="onSave",s1="insert",a1="delete",Js="insertModel",zf="deleteModel",jf="isValidation",Yo="cellValidation",pd="addHighlight",o1="find",_h="gotoHandler",Bf="replace",fd="replaceAll",ky="showFindAlert",l1="findKeyUp",h1="removeHighlight",t6="queryCellInfo",Ly="count",u1="protectSheet",kA="updateToggleItem",Hc="protectsheetHandler",Oy="replaceAllDialog",kP="unprotectsheetHandler",i6="editAlert",Ry="setLockCells",Fn="setMerge",yl="applyMerge",Vc="mergedRange",cr="activeCellMergedRange",Fy="insertMerge",nn="hideShow",vd="setCFRule",er="applyCF",no="clearCFRule",md="clear",c1="clearCF",Py="setImage",th="setChart",wc="initiateChart",Oa="refreshRibbonIcons",lu="refreshChart",Al="refreshChartSize",d1="updateChart",zy="deleteChartColl",p1="focusChartBorder",f1="saveError",v1="validationHighlight",LA="updateFilter",Hf="beforeInsert",Vf="beforeDelete",Mg="deleteHyperlink",jy="moveOrDuplicateSheet",gd="setAutoFill",OA="refreshCell",m1="getFillInfo",By="getautofillDDB",Hy="rowFillHandler",Vy="getTextSpace",Uy="refreshClipboard",_y="updateView",Gs="selectionComplete",ih="refreshInsertDelete",Wy="getUpdatedFormulaOnInsertDelete",r6="beforeCellUpdate",g1="duplicateSheetFilterHandler",RA="unMerge",y1="addFormatToCustomFormatDlg",b1="checkFormulaRef",n6=function(){function s(e){this.parent=e}return s.prototype.processSheet=function(e,t){var i=JSON.parse(e,function(r,n){if(!((Array.isArray(n)||typeof n=="string")&&!n.length))return n});return[t,i]},s.prototype.processSave=function(e,t,i,r,n){var a=this,o=new FormData,l,h=Object.keys(t);for(o.append("JSONData",JSON.stringify(e)),l=0;l<h.length;l++)o.append(h[l],t[h[l]]);for(h=Object.keys(i),l=0;l<h.length;l++)o.append(h[l],i[h[l]]);o.append("pdfLayoutSettings",JSON.stringify(r)),fetch(t.url,{method:"POST",body:o}).then(function(u){return u.ok?u.blob():Promise.reject({message:u.statusText})}).then(function(u){new Promise(function(c){var d=new FileReader;d.onload=function(){var p=d.result.toString(),f=i.customParams&&typeof i.customParams=="string"&&i.customParams.toLowerCase()==="saveashtml";if(p.indexOf("data:text/plain;base64,")>-1||!f&&p.indexOf("data:text/html;base64,")>-1||p.indexOf("data:application/json;base64,")>-1){var v=void 0;if(p=p.replace("data:text/plain;base64,",""),p=p.replace("data:text/html;base64,",""),p.indexOf("data:application/json;base64,")>-1?(p=p.replace("data:application/json;base64,",""),v=atob(p).split(".")):v=atob(p).split(/(\r\n|\n|\r)/gm),v.length){var g=v[0].length>1&&v[0][0]==='"'?v[0].split('"')[1]+".":v[0];n?n.apply(a,[{dialog:g}]):postMessage({dialog:g})}}else n?n.apply(a,[u]):postMessage(u);c(d.result)},d.readAsDataURL(u)})}).catch(function(u){n?n.apply(a,[{error:u.message}]):postMessage({error:u.message})})},s}(),s6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),C1=function(){return C1=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},C1.apply(this,arguments)},LP=function(s){s6(e,s);function e(t){var i=s.call(this,t)||this;return i.isProcessCompleted=!1,i.saveJSON={},i.isFullPost=!1,i.needBlobData=!1,i.customParams=null,i.pdfLayoutSettings={fitSheetOnOnePage:!1},i.addEventListener(),i}return e.prototype.getModuleName=function(){return"workbookSave"},e.prototype.destroy=function(){this.removeEventListener(),this.parent=null},e.prototype.addEventListener=function(){this.parent.on(kf,this.initiateSave,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(kf,this.initiateSave)},e.prototype.initiateSave=function(t){var i=t.saveSettings;this.parent.notify(Qp,null),this.saveSettings={saveType:i.saveType,url:i.url,fileName:i.fileName||"Sample"},this.isFullPost=t.isFullPost,this.needBlobData=t.needBlobData,this.needBlobData&&(this.isFullPost=!1),this.customParams=t.customParams,this.pdfLayoutSettings=t.pdfLayoutSettings,this.updateBasicSettings(),this.processSheets(i.autoDetectFormat)},e.prototype.updateBasicSettings=function(){var t=this.getStringifyObject(this.parent,["sheets","_isScalar","observers","closed","isStopped","hasError","__isAsync","beforeCellFormat","beforeCellRender","beforeDataBound","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEditing","cellSave","beforeCellSave","contextMenuItemSelect","contextMenuBeforeClose","contextMenuBeforeOpen","created","dataBound","fileMenuItemSelect","fileMenuBeforeClose","fileMenuBeforeOpen","saveComplete","sortComplete","select","actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeHyperlinkClick","beforeHyperlinkCreate","openComplete","openFailure","queryCellInfo","dialogBeforeOpen","dataSourceChanged","beforeConditionalFormat","beforeCellUpdate"]),i=JSON.parse(t),r=this.parent.sheets.length;r&&(i.sheets=[]),this.saveJSON=i},e.prototype.processSheets=function(t){var i=this,r=["dataSource","startCell","query","showFieldAsHeader","result"];this.parent.isAngular&&r.push("template");for(var n,a,o,l,h=0,u=this.parent.sheets.length;h<u;h++){o=this.parent.sheets[h],n=!1,a=!1;for(var c=0,d=o.ranges.length;c<d;c++)if(l=o.ranges[c],l.dataSource&&(a=!0,!l.info||!l.info.loadedRange||!l.info.loadedRange.length)){n=!0;break}if(n){var p=function(v){zC(i,i.processSheet,i.updateSheet,[i.getStringifyObject(i.parent.sheets[v],r,v),v])},f=this.parent;this.parent.notify(od,{sheet:o,sheetIndex:h,loadComplete:p.bind(this,h),isFinite:f.scrollSettings&&f.scrollSettings.isFinite,isSaveAction:!0,autoDetectFormat:t})}else zC(this,this.processSheet,this.updateSheet,[this.getStringifyObject(o,r,h,t&&a),h])}},e.prototype.updateSheet=function(t){this.saveJSON.sheets[t[0]]=t[1],this.isProcessCompleted=this.getSheetLength(this.saveJSON.sheets)===this.parent.sheets.length,this.isProcessCompleted&&this.save(this.saveSettings)},e.prototype.getSheetLength=function(t){var i=0;return t.forEach(function(r){r&&i++}),i},e.prototype.save=function(t){var i={cancel:!1,jsonObject:this.saveJSON};this.parent.notify(n1,i),i.cancel||(this.isFullPost?(this.initiateFullPostSave(),this.saveJSON={}):zC(this,{workerTask:this.processSave},this.updateSaveResult,[this.saveJSON,t,this.customParams,this.pdfLayoutSettings],!0))},e.prototype.updateSaveResult=function(t){if(t.isFormDataError){this.processSave(this.saveJSON,this.saveSettings,this.customParams,this.pdfLayoutSettings,this.updateSaveResult);return}this.saveJSON={};var i={status:"Success",message:"",url:this.saveSettings.url,fileName:this.saveSettings.fileName,saveType:this.saveSettings.saveType,blobData:null};typeof t=="object"&&t.error?(i.status="Failure",i.message=t.error.toString()):typeof t=="object"&&t.dialog?this.parent.notify(f1,{content:t.dialog}):this.needBlobData?i.blobData=t:this.ClientFileDownload(t),this.parent.trigger("saveComplete",i),this.parent.notify(Of,i)},e.prototype.ClientFileDownload=function(t){var i=this.parent.createElement("a",{attrs:{download:this.getFileNameWithExtension()}}),r=URL.createObjectURL(t);i.href=r,document.body.appendChild(i),i.click(),URL.revokeObjectURL(r),document.body.removeChild(i)},e.prototype.initiateFullPostSave=function(){var t=Object.keys(this.saveSettings),i,r=this.parent.createElement("form",{attrs:{method:"POST",action:this.saveSettings.url}}),n=this.parent.createElement("input",{attrs:{type:"hidden",name:"JSONData"}});for(n.value=JSON.stringify(this.saveJSON),r.appendChild(n),i=0;i<t.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:t[i]}}),n.value=this.saveSettings[t[i]],r.appendChild(n);for(t=Object.keys(this.customParams),i=0;i<t.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:t[i]}}),n.value=this.customParams[t[i]],r.appendChild(n);n=this.parent.createElement("input",{attrs:{type:"hidden",name:"pdfLayoutSettings"}}),n.value=JSON.stringify(this.pdfLayoutSettings),r.appendChild(n),document.body.appendChild(r),r.submit(),ne(r),this.parent.notify(Of,{})},e.prototype.getStringifyObject=function(t,i,r,n){var a=this;i===void 0&&(i=[]),r===0&&this.parent.notify(ud,{clearAll:!0});var o=[],l,h=n&&rz(this.parent),u=JSON.stringify(t,function(d,p){if(!(i.indexOf(d)>-1)){if(p&&p.cells)for(var f=0,v=p.cells.length;f<v;f++){var g=p.cells[f],b=[Number(d),f];if(g&&(g.value?n&&!g.formula&&h(g):g.formula&&g.formula.indexOf("=UNIQUE(")<0&&(a.parent.notify(xt,{action:"refreshCalculate",value:g.formula,rowIndex:b[0],colIndex:f,isFormula:Bt(g.formula),sheetIndex:r,isRefreshing:!0}),g.value=Y(b[0],f,t).value),g.chart)){o.push({index:b,chart:g.chart}),l=[];for(var y=0,C=g.chart.length;y<C;y++){var x=Object.assign({},g.chart[y]);delete x.id,l.push(x)}g.chart=l}}return p&&p.properties&&p.maxHgts&&(p.properties=C1({},p.properties,{maxHgts:p.maxHgts})),p&&typeof p=="object"&&p.hasOwnProperty("properties")?p.properties:p!==null?p:void 0}}),c=Pe(this.parent,r);return o.forEach(function(d){Ht(d.index[0],d.index[1],c,{chart:d.chart},!0)}),u},e.prototype.getFileNameWithExtension=function(t){t||(t=this.saveSettings.fileName);var i=this.getFileExtension(),r=t.lastIndexOf(".");return r>-1&&(t=t.substr(0,r)),t+i},e.prototype.getFileExtension=function(){return"."+this.saveSettings.saveType.toLowerCase()},e}(n6),W;(function(s){s[s.na=0]="na",s[s.value=1]="value",s[s.ref=2]="ref",s[s.divzero=3]="divzero",s[s.num=4]="num",s[s.name=5]="name",s[s.null=6]="null"})(W||(W={}));var Ce;(function(s){s[s.operators_cannot_start_with_expression=0]="operators_cannot_start_with_expression",s[s.reservedWord_And=1]="reservedWord_And",s[s.reservedWord_Xor=2]="reservedWord_Xor",s[s.reservedWord_If=3]="reservedWord_If",s[s.number_contains_2_decimal_points=4]="number_contains_2_decimal_points",s[s.reservedWord_Else=5]="reservedWord_Else",s[s.reservedWord_Not=6]="reservedWord_Not",s[s.invalid_char_in_number=7]="invalid_char_in_number",s[s.invalid_characters_following_with_operator=6]="invalid_characters_following_with_operator",s[s.mismatched_parentheses=8]="mismatched_parentheses",s[s.unknown_formula_name=9]="unknown_formula_name",s[s.requires_a_single_argument=10]="requires_a_single_argument",s[s.requires_3_args=11]="requires_3_args",s[s.invalid_Math_argument=12]="invalid_Math_argument",s[s.requires_2_args=13]="requires_2_args",s[s.bad_index=14]="bad_index",s[s.too_complex=15]="too_complex",s[s.circular_reference=16]="circular_reference",s[s.missing_formula=17]="missing_formula",s[s.improper_formula=18]="improper_formula",s[s.invalid_expression=19]="invalid_expression",s[s.cell_empty=20]="cell_empty",s[s.bad_formula=21]="bad_formula",s[s.empty_expression=22]="empty_expression",s[s.virtual_mode_required=23]="virtual_mode_required",s[s.mismatched_tics=24]="mismatched_tics",s[s.wrong_number_arguments=25]="wrong_number_arguments",s[s.invalid_arguments=26]="invalid_arguments",s[s.iterations_do_not_converge=27]="iterations_do_not_converge",s[s.calculation_overflow=29]="calculation_overflow",s[s.already_registered=28]="already_registered",s[s.missing_sheet=30]="missing_sheet",s[s.cannot_parse=31]="cannot_parse",s[s.expression_cannot_end_with_an_operator=32]="expression_cannot_end_with_an_operator",s[s.spill=33]="spill",s[s.div=34]="div"})(Ce||(Ce={}));var S1;(function(s){s.xlsx="xlsx",s.xlsm="xlsm",s.xlsb="xlsb",s.xltx="xltx",s.xltm="xltm",s.xls="xls",s.xml="xml",s.xlam="xlam",s.xla="xla",s.xlw="xlw",s.xlr="xlr",s.prn="prn",s.txt="txt",s.csv="csv",s.dif="dif",s.slk="slk"})(S1||(S1={}));function a6(s){switch(s){case"dd-MMM-yyyy":case"dd MMM yyyy":s="medium";break;case"MMM yyyy":s="yMMM";break;case"MM/dd/yyyy":case"dd/MM/yyyy":case"dd/MM/yy":s="short";break;case"dddd MMMM dd yyyy":case"dd MMMM yyyy":s="long";break;case"d MMMM yyyy":s="yMMMd";break;case"yyyy":s="y";break;case"h:mm":s="Hm";break;case"h:mm tt":s="hm";break;case"h":s="H";break;case"h tt":s="h";break;case"dddd":s="E";break;case"h:mm:ss tt":s="hms";break;case"h:mm:ss":s="Hms";break;case"d":s="d";break;case"d dddd":s="Ed";break;case"M":s="M";break;case"Md":s="Md";break;case"MMM":s="MMM";break;case"ddd MMM d":s="MMMEd";break;case"MMM d":s="MMMd";break;case"M/yyyy":s="yM";break;case"ddd":s="E";break;default:s="";break}return s}function o6(s){var e=!1;for(var t in S1)if(s.indexOf("."+t+"]")>-1){e=!0;break}return e}function l6(s){var e=[];return s.includeBasicFormulas&&e.push({member:"basic-formulas",args:[s]}),e}var h6="Module";function FA(s,e){for(var t=e,i=s.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<i.length&&!Re(t);r++)t=t[i[r]];return t}function PA(s,e,t){var i=s.replace(/\[/g,".").replace(/\]/g,"").split("."),r=t||{},n=r,a,o=i.length,l;for(a=0;a<o;a++)l=i[a],a+1===o?n[""+l]=e===void 0?{}:e:m(n[""+l])&&(n[""+l]={}),n=n[""+l];return r}var u6=function(){function s(e){this.loadedModules=[],this.parent=e}return s.prototype.inject=function(e,t){var i=e.length;if(i===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(e);for(var r=0;r<i;r++)for(var n=e[r],a=0,o=t;a<o.length;a++){var l=o[a],h=n.member;if(l.prototype.getModuleName()===n.member&&!this.isModuleLoaded(h)){var u=this.createInstance(l,n.args),c=this.getMemberName(h);n.isProperty?PA(c,l,this.parent):PA(c,u,this.parent);var d=n;d.member=c,this.loadedModules.push(d)}}},s.prototype.createInstance=function(e,t){var i=t;return i.unshift(void 0),new(Function.prototype.bind.apply(e,i))},s.prototype.clean=function(){for(var e=0,t=this.loadedModules;e<t.length;e++){var i=t[e];i.isProperty||FA(i.member,this.parent).destroy()}this.loadedModules=[]},s.prototype.clearUnusedModule=function(e){for(var t=this,i=e.map(function(l){return t.getMemberName(l.member)}),r=this.loadedModules.filter(function(l){return i.indexOf(l.member)===-1}),n=0,a=r;n<a.length;n++){var o=a[n];o.isProperty||FA(o.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(o),1),this.deleteObject(this.parent,o.member)}},s.prototype.getMemberName=function(e){return e[0].toLowerCase()+e.substring(1)+h6},s.prototype.deleteObject=function(e,t){delete e[""+t]},s.prototype.isModuleLoaded=function(e){for(var t=0,i=this.loadedModules;t<i.length;t++){var r=i[t];if(r.member===this.getMemberName(e))return!0}return!1},s}(),c6=function(){function s(e){this.formulas=[{formulaName:"SUM",category:"Math & Trig",description:"Sums individual values, cell references or ranges."},{formulaName:"SUMIFS",category:"Math & Trig",description:"Sums the cells specified by a given set of conditionsor criteria."},{formulaName:"SUMPRODUCT",category:"Math & Trig",description:"Returns sum of the product of given ranges of arrays."},{formulaName:"ABS",category:"Math & Trig",description:"Returns the absolute value of a number."},{formulaName:"RAND",category:"Math & Trig",description:"Return a random number between 0 and 1."},{formulaName:"FLOOR",category:"Math & Trig",description:"Returns the round a number down to the nearest integer."},{formulaName:"CEILING",category:"Math & Trig",description:"Returns a number rounded up to a multiple of another number."},{formulaName:"SUMIF",category:"Math & Trig",description:"It will sum up cells that meet the given criteria."},{formulaName:"PRODUCT",category:"Math & Trig",description:"Multiplies all the numbers given as arguments and returns the product."},{formulaName:"AVERAGE",category:"Statistical",description:"The sum of the numbers divided by how many numbers are being averaged."},{formulaName:"AVERAGEIF",category:"Statistical",description:"Computes the average of the numbers in a range that meet the supplied criteria."},{formulaName:"COUNT",category:"Statistical",description:"Counts the numbers in the list of arguments, exclude text entries."},{formulaName:"COUNTA",category:"Statistical",description:"Counts the non-empty values in the list of arguments."},{formulaName:"COUNTIF",category:"Statistical",description:"Counts the number of cells in a range that meet a specified condition."},{formulaName:"COUNTIFS",category:"Statistical",description:"Counts the number of times each cells in all the ranges that meet the specific conditions."},{formulaName:"AVERAGEA",category:"Statistical",description:"Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references."},{formulaName:"AVERAGEIFS",category:"Statistical",description:"Conditionally returns the average of the contents of cells for the set of ranges."},{formulaName:"MIN",category:"Statistical",description:"Returns the smaller number in set of arguments."},{formulaName:"MAX",category:"Statistical",description:"Returns the largest number in set of arguments."},{formulaName:"DATE",category:"Date",description:"Returns the date, given the year, month and day of the month."},{formulaName:"DAY",category:"Date",description:"Returns the day of a given date."},{formulaName:"TODAY",category:"Date",description:"Returns the current date as date value."},{formulaName:"DAYS",category:"Date",description:"Returns the number of days between two dates."},{formulaName:"WEEKDAY",category:"Date",description:"Returns the day of the week corresponding to a date."},{formulaName:"IF",category:"Logical",description:"Returns one value if a logical expression is TRUE and another if it is FALSE"},{formulaName:"AND",category:"Logical",description:"Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise."},{formulaName:"IFS",category:"Logical",description:"Checks multiple conditions and returns a value corresponding to the first TRUE result."},{formulaName:"IFERROR",category:"Logical",description:"Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula."},{formulaName:"CHOOSE",category:"Lookup & Reference",description:"Returns a value from a list, given an index number."},{formulaName:"INDEX",category:"Lookup & Reference",description:"Returns a value from a table, given a row and column number."},{formulaName:"FIND",category:"Text",description:"Returns the position of a string of text within another string."},{formulaName:"CONCATENATE",category:"Text",description:" Used to join two or more strings together."},{formulaName:"CONCAT",category:"Text",description:"Concatenates a list or range of text strings."},{formulaName:"SUBTOTAL",category:"Lookup & Reference",description:"Returns a subtotal in a list or database."},{formulaName:"RADIANS",category:"Math & Trig",description:"Converts degrees to radians."},{formulaName:"OR",category:"Logical",description:"Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE."},{formulaName:"NOT",category:"Logical",description:"Returns the inverse of a given logical expression."},{formulaName:"MATCH",category:"Lookup & Reference",description:"Returns the relative position of an checked item in range that matches a specified value in a specified order"},{formulaName:"RANDBETWEEN",category:"Math & Trig",description:"Returns an integer random number in a specified range."},{formulaName:"SLOPE",category:"Statistical",description:"Returns the slope of the line from linear regression of the data points."},{formulaName:"INTERCEPT",category:"Statistical",description:"Calculates the point of the Y-intercept line via linear regression."},{formulaName:"RSQ",category:"Statistical",description:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_ys and known_xs"},{formulaName:"UNIQUE",category:"Lookup & Reference",description:"Returns a unique values from a range or array."},{formulaName:"ROUNDUP",category:"Math & Trig",description:"Rounds a number away from zero."},{formulaName:"ROUNDDOWN",category:"Math & Trig",description:"Rounds a number down, toward zero."},{formulaName:"INT",category:"Math & Trig",description:"Returns a number to the nearest integer."},{formulaName:"LN",category:"Math & Trig",description:"Returns the natural logarithm of a number."},{formulaName:"ISNUMBER",category:"Information",description:"Returns TRUE, if the argument is number and FALSE otherwise."},{formulaName:"ROUND",category:"Math & Trig",description:"Rounds a number to a specified number of digits."},{formulaName:"LOG",category:"Math & Trig",description:"Returns the logarithm of a number to the base that you specify."},{formulaName:"POWER",category:"Math & Trig",description:"Returns the result of a number raised to power."},{formulaName:"SQRT",category:"Math & Trig",description:"Returns the square root of a positive number."},{formulaName:"TRUNC",category:"Math & Trig",description:"Returns the truncated value of a number to a specified number of decimal places."},{formulaName:"EXP",category:"Math & Trig",description:"Returns e raised to the power of the given number."},{formulaName:"GEOMEAN",category:"Statistical",description:"Returns the geometric mean of an array or range of positive data."},{formulaName:"TEXT",category:"Lookup & Reference",description:"Converts a value to text in specified number format."},{formulaName:"SORT",category:"Lookup & Reference",description:"Sorts a range of an array."},{formulaName:"LOOKUP",category:"Lookup & Reference",description:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range."},{formulaName:"VLOOKUP",category:"Lookup & Reference",description:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row."},{formulaName:"HLOOKUP",category:"Lookup & Reference",description:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify."},{formulaName:"T",category:"Text",description:"Checks whether a value is text or not and returns the text."},{formulaName:"EXACT",category:"Text",description:"Checks whether a two text strings are exactly same and returns TRUE or FALSE."},{formulaName:"LEN",category:"Text",description:"Returns a number of characters in a given string."},{formulaName:"MOD",category:"Math & Trig",description:"Returns a remainder after a number is divided by divisor."},{formulaName:"ODD",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest odd integer."},{formulaName:"PI",category:"Math & Trig",description:"Returns the value of pi."},{formulaName:"COUNTBLANK",category:"Statistical",description:"Returns the number of empty cells in a specified range of cells."},{formulaName:"EVEN",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest even integer."},{formulaName:"FACT",category:"Math & Trig",description:"Returns the factorial of a number."},{formulaName:"DECIMAL",category:"Math & Trig",description:"Converts a text representation of a number in a given base into a decimal number."},{formulaName:"DEGREES",category:"Math & Trig",description:"Converts radians to degrees."},{formulaName:"ADDRESS",category:"Lookup & Reference",description:"Returns a cell reference as text, given specified row and column numbers."},{formulaName:"TIME",category:"Date & Time",description:"Converts hours, minutes, seconds to the time formatted text."},{formulaName:"CHAR",category:"Text",description:"Returns the character from the specified number."},{formulaName:"CODE",category:"Text",description:"Returns the numeric code for the first character in a given string."},{formulaName:"DOLLAR",category:"Text",description:"Converts the number to currency formatted text."},{formulaName:"SMALL",category:"Statistical",description:"Returns the k-th smallest value in a given array."},{formulaName:"LARGE",category:"Statistical",description:"Returns the k-th largest value in a given array."},{formulaName:"MEDIAN",category:"Statistical",description:"Returns the median of the given set of numbers."},{formulaName:"EDATE",category:"Date & Time",description:"Returns a date with given number of months before or after the specified date."},{formulaName:"EOMONTH",category:"Date & Time",description:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date."},{formulaName:"DATEVALUE",category:"Date & Time",description:"Converts a date string into date value."},{formulaName:"HOUR",category:"Date & Time",description:"Returns the number of hours in a specified time string."},{formulaName:"MINUTE",category:"Date & Time",description:"Returns the number of minutes in a specified time string."},{formulaName:"SECOND",category:"Date & Time",description:"Returns the number of seconds in a specified time string."},{formulaName:"NOW",category:"Date & Time",description:"Returns the current date and time."},{formulaName:"MONTH",category:"Date & Time",description:"Returns the number of months in a specified date string."},{formulaName:"PROPER",category:"Text",description:"Converts a text to proper case; first letter to uppercase and other letters to lowercase."}],this.isConcat=!1,this.parent=e,this.init()}return s.prototype.init=function(){for(var e,t=0;t<this.formulas.length;t++)e=ie("Compute"+this.formulas[t].formulaName,this).bind(this),this.addFormulaCollection(this.formulas[t].formulaName.toUpperCase(),e,this.formulas[t].category,this.formulas[t].description)},s.prototype.addFormulaCollection=function(e,t,i,r){this.parent.libraryFormulas={fName:e,handler:t,category:i,description:r}},s.prototype.ComputeSUM=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var r=0,n,a,o=0;if(!m(e))for(var l=e,h=function(f){f.toString().indexOf(".")>-1&&(o=Math.max(o,f.split(".")[1].length))},u=0;u<l.length;u++){var c=l[u].toString();if(c.indexOf(":")>-1&&this.parent.isCellReference(c)){for(var d=this.parent.getCellCollection(c.split(this.parent.tic).join("")),p=0;p<d.length;p++)if(n=i?this.parent.getValueFromArg(d[p],null,null,!0):this.parent.getValueFromArg(d[p]),!(i&&n.includes("SUBTOTAL("))){if(this.parent.getErrorStrings().indexOf(n)>-1)return n;m(n[0])||isNaN(this.parent.parseFloat(n))||(h(n),r=r+this.parent.parseFloat(n))}}else{if(l[u].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(l[u].split(this.parent.tic).join("")))||l[u].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.value];if(l[u].split(this.parent.tic).join("")===this.parent.trueValue&&(l[u]="1"),l[u].split(this.parent.tic).join("")===this.parent.falseValue&&(l[u]="0"),a=i?this.parent.getValueFromArg(l[u].split(this.parent.tic).join(""),null,null,!0):this.parent.getValueFromArg(l[u].split(this.parent.tic).join("")),i&&a.includes("SUBTOTAL("))continue;if(this.parent.getErrorStrings().indexOf(a)>-1)return a;if(m(a)||isNaN(this.parent.parseFloat(a)))continue;a.length>0&&(h(a),r=r+this.parent.parseFloat(a+""))}}return r.toString().indexOf(".")>-1?r.toFixed(o):r},s.prototype.ComputeINT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n;return(!m(e)&&e.length!==1||e[0]==="")&&(i=this.parent.formulaErrorStrings[Ce.invalid_arguments]),e[0]!==""&&e.length===1&&(i=e[0],n=i.indexOf('"'),i=i.indexOf('"')>-1?i.replace('"',""):i,i=i.indexOf('"')>-1?i.replace('"',""):i,i=this.parent.getValueFromArg(i),i=i.toUpperCase()==="TRUE"?"1":i==="FALSE"?"0":i,r=this.parent.parseFloat(i),r=Math.floor(r)),isNaN(r)&&(i=n>-1?this.parent.getErrorStrings()[W.value]:this.parent.getErrorStrings()[W.name]),r||i},s.prototype.ComputeTODAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length!==1||e[0]!=="")i=this.parent.formulaErrorStrings[Ce.invalid_arguments];else{var r=new Date(Date.now());this.parent.parentObject.getModuleName()==="spreadsheet"?(i=this.parent.parentObject.dateToInt(r),this.parent.parser.storedStringText.toUpperCase().indexOf("TODAY")===0&&this.parent.cell!==""&&this.parent.parentObject.setDateFormat(this.parent.getSheetId(this.parent.grid),this.parent.rowIndex(this.parent.cell)-1,this.parent.colIndex(this.parent.cell)-1)):i=r.getFullYear()+"/"+this.parent.calculateDate((r.getMonth()+1).toString())+"/"+this.parent.calculateDate(r.getDate().toString())}return i},s.prototype.ComputeWEEKDAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e[0]===""&&m(e[1])||e.length>2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]===""&&e[1]===""||e[1]==="")return this.parent.getErrorStrings()[W.num].toString();if(e.length===1&&e.push("1"),e[0].indexOf(this.parent.tic)>-1&&e[0].split(this.parent.tic).join("").trim()===""||e[1].split(this.parent.tic).join("").trim()===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];var i,r,n;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[0].split(this.parent.tic).join("")))?i=this.parent.getValueFromArg(e[0]):i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0";if(this.parent.isCellReference(e[1])?r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0":r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=this.parent.parseFloat(i),r=this.parent.parseFloat(r),isNaN(r)||isNaN(n))return this.parent.getErrorStrings()[W.value];if(n<0||n>2958465)return this.parent.getErrorStrings()[W.num].toString();switch(r=parseInt(r.toString(),10),n=n<1?0:Math.floor(n)%7,r){case 1:case 17:n=n<=0?n+7:n;break;case 2:case 11:n=n-1,n=n<=0?n+7:n;break;case 3:n=n-2,n=n<0?n+7:n;break;case 12:n=n+5,n=n>7?n-7:n;break;case 13:n=n+4,n=n>7?n-7:n;break;case 14:n=n+3,n=n>7?n-7:n;break;case 15:n=n+2,n=n>7?n-7:n;break;case 16:n=n+1,n=n>7?n-7:n;break;default:n=this.parent.getErrorStrings()[W.num].toString();break}return n},s.prototype.ComputePROPER=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),e&&e[0]===""||e.length!==1)return this.parent.formulaErrorStrings[Ce.invalid_arguments];var n=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");if(n===this.parent.getErrorStrings()[W.name])return this.parent.getErrorStrings()[W.name];for(var a=n.toLowerCase().split(" "),o=0;o<a.length;o++)if(a[o][0]){for(var l=0;l<a[o].length;l++)if(a[o].charCodeAt(l)>=97&&a[o].charCodeAt(l)<=122){a[o]=a[o].replace(a[o][l],a[o][l].toUpperCase());break}}if(i=a.join(" "),i.indexOf("-")>0){for(var h=i.split("-"),o=0;o<h.length;o++)if(h[o][0]){for(var l=0;l<h[o].length;l++)if(h[o].charCodeAt(l)>=97&&h[o].charCodeAt(l)<=122){h[o]=h[o].replace(h[o][l],h[o][l].toUpperCase());break}}i=h.join("-")}if(i.indexOf(",")>0){for(var u=i.split(","),o=0;o<u.length;o++)if(u[o][0]){for(var l=0;l<u[o].length;l++)if(u[o].charCodeAt(l)>=97&&u[o].charCodeAt(l)<=122){u[o]=u[o].replace(u[o][l],u[o][l].toUpperCase());break}}i=u.join(",")}return r&&(i=this.parent.tic+i+this.parent.tic),i},s.prototype.ComputeSUMPRODUCT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r;if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var n=0,a=0,o,l=null,h=e,u=[],c=0;c<h.length;c++)u.push(this.parent.getCellCollection(h[c]).length);for(var d=0;d<u.length;d++)if(u[d]&&u[d+1]&&u[d]!==u[d+1])return this.parent.getErrorStrings()[W.value];for(var p=0;p<h.length;++p){var f=h[p];if(!f.startsWith(this.parent.tic)&&this.parent.isCellReference(f)){var c=f.indexOf(":"),v=this.parent.rowIndex(f.substr(0,c)),g=this.parent.rowIndex(f.substr(c+1));if(!(v!==-1||g===-1)==(v===-1||g!==-1))return this.parent.getErrorStrings()[W.name];v>g&&(i=[g,v],v=i[0],g=i[1]);var b=this.parent.colIndex(f.substr(0,c)),y=this.parent.colIndex(f.substr(c+1));if(b>y&&(r=[y,b],b=r[0],y=r[1]),l===null)for(a=(g-v+1)*(y-b+1),l=[],c=0;c<a;++c)l[c]=1;c=0;for(var C=v;C<=g;++C)for(var x=b;x<=y;++x){var w=this.getSheetReference(f)+this.parent.convertAlpha(x)+C,M=this.parent.getValueFromArg(w);if(this.parent.getErrorStrings().indexOf(M)>-1)return M;if(isNaN(this.parent.parseFloat(M)))l[c]=0;else{if(isNaN(l[c]))return this.parent.getErrorStrings()[W.name];l[c]=l[c]*this.parent.parseFloat(M)}c++}}else{var E=this.parent.getValueFromArg(f);return o=E.indexOf('"'),this.parent.getErrorStrings().indexOf(E)>-1?E:o>-1?0:this.parent.getErrorStrings()[W.value]}}for(var c=0;c<a;++c)n+=l[c];return n},s.prototype.ComputeROUNDUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n,a,o,l=e.length;if(!m(e)&&l>2&&(i=this.parent.formulaErrorStrings[Ce.invalid_arguments]),l===1&&e[0]!=="")a=e[0].indexOf('"'),r=e[0].indexOf('"')>-1?e[0].replace('"',""):e[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),o=this.parent.parseFloat(r),o>0?o+=.4999999999:o<0&&(o-=.4999999999),o=this.parent.parseFloat(o.toFixed(0)),i=o.toString();else if(l===2){if(a=e[0].indexOf('"')>-1?e[0].indexOf('"'):e[1].indexOf('"')>-1?e[1].indexOf('"'):-1,this.parent.isCellReference(e[0]))r=this.parent.getValueFromArg(e[0])||"0";else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(e[1]))n=this.parent.getValueFromArg(e[1])||"0";else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",u=isNaN(Number(n))||n.trim()==="";if((e[0].indexOf('"')>-1||this.parent.isCellReference(e[0]))&&h||(e[1].indexOf('"')>-1||this.parent.isCellReference(e[1]))&&u)return this.parent.getErrorStrings()[W.value];var c=Math.ceil(this.parent.parseFloat(n));if(o=this.parent.parseFloat(r),c>0){o>0?o+=.4999999999/Math.pow(10,c):o<0&&(o-=.4999999999/Math.pow(10,c));var d=r.indexOf(this.parent.getParseDecimalSeparator()),p=0;d!==-1&&(p=r.length-d-1,p=p>=c?c:p),o=this.parent.parseFloat(o.toFixed(p)),i=o.toString(),isNaN(o)&&(c.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.value]:i=this.parent.getErrorStrings()[W.name])}else o>0?o=o/Math.pow(10,-c)+.49999:o<0&&(o=o/Math.pow(10,-c)-.49999),o>0&&c<-9?o=1*Math.pow(10,-c):o=this.parent.parseFloat(o.toFixed(0))*Math.pow(10,-c),i=o.toString(),isNaN(o)&&(i=c.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.value]:i=this.parent.getErrorStrings()[W.name])}else i=a>-1?this.parent.getErrorStrings()[W.value]:this.parent.formulaErrorStrings[Ce.invalid_arguments];return i},s.prototype.ComputeROUNDDOWN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n,a,o,l=e.length;if(!m(e)&&l>2&&(i=this.parent.formulaErrorStrings[Ce.invalid_arguments]),l===1&&e[0]!=="")a=e[0].indexOf('"'),r=e[0].indexOf('"')>-1?e[0].replace('"',""):e[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),o=this.parent.parseFloat(r),o>0?o-=.4999999999:o<0&&(o+=.4999999999),o=this.parent.parseFloat(o.toFixed(0)),i=o.toString();else if(l===2){if(a=e[0].indexOf('"')>-1?e[0].indexOf('"'):e[1].indexOf('"')>-1?e[1].indexOf('"'):-1,this.parent.isCellReference(e[0]))r=this.parent.getValueFromArg(e[0])||"0";else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(e[1]))n=this.parent.getValueFromArg(e[1])||"0";else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",u=isNaN(Number(n))||n.trim()==="";if((e[0].indexOf('"')>-1||this.parent.isCellReference(e[0]))&&h||(e[1].indexOf('"')>-1||this.parent.isCellReference(e[1]))&&u)return this.parent.getErrorStrings()[W.value];var c=Math.ceil(this.parent.parseFloat(n));if(o=this.parent.parseFloat(r),c>0){o>0?o-=.4999999999/Math.pow(10,c):o<0&&(o+=.4999999999/Math.pow(10,c));var d=r.indexOf(this.parent.getParseDecimalSeparator()),p=0;d!==-1&&(p=r.length-d-1,p=p>=c?c:p),o=this.parent.parseFloat(o.toFixed(p)),i=o.toString(),isNaN(o)&&(c.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.value]:i=this.parent.getErrorStrings()[W.name])}else o>0?o=o/Math.pow(10,-c)-.49999:o<0&&(o=o/Math.pow(10,-c)+.49999),o>0&&c<-9?o=1*Math.pow(10,-c):o=this.parent.parseFloat(o.toFixed(0))*Math.pow(10,-c),i=o.toString(),isNaN(o)&&(i=c.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.value]:i=this.parent.getErrorStrings()[W.name])}else i=a>-1?this.parent.getErrorStrings()[W.value]:this.parent.formulaErrorStrings[Ce.invalid_arguments];return i},s.prototype.ComputeCOUNT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var r=e,n,a,o=0,l,h,u=0;u<r.length;u++)if(n=r[u],this.parent.isCellReference(n))if(n.indexOf(":")>-1){a=this.parent.getCellCollection(n.split(this.parent.tic).join(""));for(var c=0;c<a.length;c++)l=i?this.parent.getValueFromArg(a[c],null,null,!0):this.parent.getValueFromArg(a[c]),!(i&&l.includes("SUBTOTAL("))&&(isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&o++)}else{if(l=i?this.parent.getValueFromArg(n,null,null,!0):this.parent.getValueFromArg(n),i&&l.includes("SUBTOTAL("))continue;isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&o++}else h=this.parent.getValueFromArg(n).split(this.parent.tic).join(""),(n.length===0&&h.trim()===""||(!isNaN(this.parent.parseFloat(h))||n===this.parent.trueValue||n===this.parent.falseValue)&&n.length>0&&n.trim()!==""&&h.trim()!=="")&&o++;return o},s.prototype.ComputeDATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(e.length!==3)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var r=[],n=0;n<e.length;++n)r[n]=this.parent.getValueFromArg(e[n]);r[0]=r[0]===this.parent.trueValue?"1":r[0]===this.parent.falseValue?"0":r[0],r[1]=r[1]===this.parent.trueValue?"1":r[1]===this.parent.falseValue?"0":r[1],r[2]=r[2]===this.parent.trueValue?"1":r[2]===this.parent.falseValue?"0":r[2];for(var a=0;a<r.length;a++){var o=r[a];if(this.parent.getErrorStrings().indexOf(o)>-1)return o;if(o==='""'||o==='"0"'&&e[a]!=='"0"'||o==='"TRUE"'||o==='"FALSE"')return this.parent.getErrorStrings()[W.value].toString()}var l=Math.floor(this.parent.parseFloat(r[0].split(this.parent.tic).join(""))),h=Math.floor(this.parent.parseFloat(r[1].split(this.parent.tic).join(""))),u=Math.floor(this.parent.parseFloat(r[2].split(this.parent.tic).join(""))),c=0;if(!isNaN(l)&&!isNaN(h)&&!isNaN(u)){if(l<0&&h<=12||l>=1e4&&h>0)return this.parent.getErrorStrings()[W.num].toString();for(;h>12;)h-=12,l++;c=this.parent.getSerialDateFromDate(l,h,u)}else return this.parent.getErrorStrings()[W.value].toString();if(c===0)return this.parent.getErrorStrings()[W.num].toString();var d=this.parent.fromOADate(c);return d.toString()!=="Invalid Date"?d.getFullYear()<1900||1e4<=d.getFullYear()?this.parent.getErrorStrings()[W.num].toString():i?c.toString():this.parent.calculateDate((d.getMonth()+1).toString())+"/"+this.parent.calculateDate(d.getDate().toString())+"/"+d.getFullYear():c.toString()},s.prototype.ComputeFLOOR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=e,r=i.length,n,a,o;if(r!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var l=0;l<i.length;l++){var h=i[l].split(this.parent.tic).join("").trim();if(h===""||i[l].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(h)))return this.parent.getErrorStrings()[W.value];if(ur(i[l])){if(o=this.parent.getValueFromArg(i[l])||"0",o=o===this.parent.trueValue?"1":o===this.parent.falseValue?"0":o,o.toUpperCase().match(/[A-Z]/)||o.includes('"')||!this.parent.isNumber(o))return this.parent.getErrorStrings()[W.value]}else o=this.parent.getValueFromArg(i[l].split(this.parent.tic).join("")),o=o===this.parent.trueValue?"1":o===this.parent.falseValue?"0":o;i[l]=o}return n=this.parent.parseFloat(i[0]),a=this.parent.parseFloat(i[1]),n>0&&a<0?this.parent.getErrorStrings()[W.num]:(n>0||n<0)&&a===0?this.parent.getErrorStrings()[W.divzero]:isNaN(n)?this.parent.getErrorStrings()[W.name]:n===0&&a===0?0:Math.floor(n/a)*a},s.prototype.ComputeCEILING=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=e,r=i.length,n,a,o;if(r!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var l=0;l<i.length;l++){var h=i[l].split(this.parent.tic).join("").trim();if(h===""||i[l].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(h)))return this.parent.getErrorStrings()[W.value];if(ur(i[l])){if(o=this.parent.getValueFromArg(i[l])||"0",o=o===this.parent.trueValue?"1":o===this.parent.falseValue?"0":o,o.toUpperCase().match(/[A-Z]/)||o.includes('"')||!this.parent.isNumber(o))return this.parent.getErrorStrings()[W.value]}else o=this.parent.getValueFromArg(i[l].split(this.parent.tic).join("")),o=o===this.parent.trueValue?"1":o===this.parent.falseValue?"0":o;i[l]=o}return n=this.parent.parseFloat(i[0]),a=this.parent.parseFloat(i[1]),n>0&&a<0?this.parent.getErrorStrings()[W.num]:isNaN(n)?this.parent.getErrorStrings()[W.name]:(n>0||n===0)&&a===0?0:Math.ceil(n/a)*a},s.prototype.ComputeDAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n;if(m(i)||i.length===1&&i[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(i.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var a=i[0].startsWith(this.parent.tic)&&i[0].endsWith(this.parent.tic);if(!a&&this.parent.isCellReference(i[0])){if(n=this.parent.getValueFromArg(i[0].split(this.parent.tic).join("")),n.startsWith(this.parent.tic)&&n.endsWith(this.parent.tic))return this.parent.getErrorStrings()[W.value]}else if(a){if(n=i[0].split(this.parent.tic).join(""),n===""||n===this.parent.trueValue||n===this.parent.falseValue)return this.parent.getErrorStrings()[W.value]}else n=this.parent.getValueFromArg(i[0].split(this.parent.tic).join(""));return this.parent.getErrorStrings().indexOf(n)>-1?n:Number(n)<0?this.parent.getErrorStrings()[W.num]:Math.floor(Number(n))===0||n===this.parent.falseValue?0:n===this.parent.trueValue?1:(r=this.parent.isNaN(Number(n))?this.parent.parseDate(n):this.parent.intToDate(n),Object.prototype.toString.call(r)==="[object Date]"&&(r=new Date(r).getFullYear()<1900||new Date(r).getFullYear()>9999?"NaN":r.getDate()),r.toString()==="NaN"?this.parent.getErrorStrings()[W.value]:r)},s.prototype.ComputeIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(this.parent.getErrorStrings().indexOf(e[0])>0)return e[0];var r=e,n;r.length===4&&r[3]==="nestedFormulaTrue"&&(n=!0,r.pop());var a,o;if(r.length>3||r.length===1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(r.length<=3){var l=void 0,h=void 0,u="";if(a=this.parent.getValueFromArg(r[0]),this.parent.getErrorStrings().indexOf(a)>-1)return a;if(a.toUpperCase()===this.parent.trueValue||this.parent.parseFloat(a)>0||this.parent.parseFloat(a)<0){if(i&&r[1].includes(":")){l=this.parent.getCellCollection(r[1]);for(var c=0;c<l.length;c++)h=this.parent.getValueFromArg(l[c]),isNaN(this.parent.parseFloat(h))||(u+=h+",");return u.slice(0,u.length-1)}o=r[1]===""?"0":this.parent.getValueFromArg(r[1])}else if(a.toUpperCase()===this.parent.falseValue||this.parent.parseFloat(a)===0){if(m(r[2]))return this.parent.falseValue;if(i&&r[2].includes(":")){l=this.parent.getCellCollection(r[2]);for(var c=0;c<l.length;c++)h=this.parent.getValueFromArg(l[c]),isNaN(this.parent.parseFloat(h))||(u+=h+",");return u.slice(0,u.length-1)}o=r[2]===""?"0":this.parent.getValueFromArg(r[2])}else return this.parent.formulaErrorStrings[Ce.requires_3_args]}return!n&&o.indexOf(this.parent.tic)>-1?o.split(this.parent.tic).join(""):o===""?"0":o},s.prototype.ComputeIFERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=e,r;if(i.length!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0])||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r}else if(r=this.parent.getValueFromArg(i[0],null,!0)||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r=r.split(this.parent.tic).join("").trim(),r;return this.parent.isCellReference(i[1])?r=this.parent.getValueFromArg(i[1])||"0":(r=this.parent.getValueFromArg(i[1])||"0",r=r.split(this.parent.tic).join("").trim()),r},s.prototype.ComputePRODUCT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var r=1,n,a,o=!0,l;if(!m(e))for(var h=e,u=0;u<h.length;u++){var c=h[u];if(c.indexOf(":")>-1&&this.parent.isCellReference(c))for(var d=this.parent.getCellCollection(c),p=0;p<d.length;p++)n=i?this.parent.getValueFromArg(d[p],null,null,!0):this.parent.getValueFromArg(d[p]),!(i&&n.includes("SUBTOTAL("))&&He(n)&&(l=this.parent.parseFloat(n),isNaN(l)||n.length>0&&(r=r*l,o=!1));else if(c.indexOf(":")===-1&&this.parent.isCellReference(c)){if(a=i?this.parent.getValueFromArg(h[u],null,null,!0):this.parent.getValueFromArg(h[u]),i&&a.includes("SUBTOTAL(")||!He(a))continue}else{a=h[u];var f=a.indexOf(this.parent.tic)>-1&&a.split(this.parent.tic).join("").trim()==="";if(f||h[u].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a.split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];a=this.parent.getValueFromArg(h[u].split(this.parent.tic).join("")),a=a===this.parent.trueValue?"1":a===this.parent.falseValue?"0":a.split(this.parent.tic).join("")}l=this.parent.parseFloat(a),isNaN(l)||a.length>0&&(r=r*l,o=!1)}return o?"0":r.toString()},s.prototype.ComputeDAYS=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r;if(m(t)&&t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(t.length!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var n=t,a=function(c){return c=c.split(e.parent.tic).join(""),e.parent.isCellReference(c)&&(c=e.parent.getValueFromArg(c)),c===e.parent.trueValue?c="1":c===e.parent.falseValue?c="0":c||(c=new Date(Date.parse("1899-12-31")).toDateString()),c},o=a(n[0]),l=a(n[1]);if(o[0]==="#")return o;if(l[0]==="#")return l;var h=this.parent.isNaN(Number(o))?this.parent.parseDate(o):this.parent.intToDate(o),u=this.parent.isNaN(Number(l))?this.parent.parseDate(l):this.parent.intToDate(l);if(h.toString()[0]==="#")return h.toString();if(u.toString()[0]==="#")return u.toString();if(Object.prototype.toString.call(h)==="[object Date]"&&Object.prototype.toString.call(u)==="[object Date]")r=Math.ceil(h.getTime()-u.getTime())/(1e3*3600*24);else return this.parent.getErrorStrings()[W.value];return Math.round(r)},s.prototype.ComputeUNIQUE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n,a;if(i[i.length-1]==="isComputeExp"&&(n=!0,i.pop()),m(e)||e[0]===""||i.length>3)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var o=i[1]?i[1].toUpperCase():"FALSE",l=i[2]?i[2].toUpperCase():"FALSE",h=[],u=a=this.parent.actCell;if(i[0].indexOf(":")>-1){if(m(i[0].match(/[0-9]/))){var c=i[0].split(":");i[0]=c[0]+"1:"+c[1]+(this.parent.spreadSheetUsedRange[0]+1)}else if(m(i[0].toUpperCase().match(/[A-Z]/))){var c=i[0].split(":");i[0]="A"+c[0]+":"+Ft(this.parent.spreadSheetUsedRange[1]+1)+c[1]}var d=i[0].split(":");if(this.parent.isCellReference(d[0])&&this.parent.isCellReference(d[1])){for(var p=this.parent.dependencyCollection,f=0;f<p.length&&!n;f++)p[f].split(":")[0]===i[0].split(":")[0]&&this.clearDependency(p[f]);this.parent.dependencyCollection.indexOf(i[0])===-1?n||this.parent.dependencyCollection.push(i[0]):this.clearDependency(i[0]);var v=i[0].indexOf(":"),g=void 0,b=this.parent.rowIndex(this.parent.substring(i[0],0,v)),y=this.parent.colIndex(this.parent.substring(i[0],0,v)),C=this.parent.rowIndex(this.parent.substring(i[0],v+1,v+i[0].length-v-1)),x=this.parent.colIndex(this.parent.substring(i[0],v+1,v+i[0].length-v-1));b>C&&(g=C,C=b,b=g),y>x&&(g=x,x=y,y=g);var w="";i[0].indexOf("!")===0&&(w=i[0].substring(0,i[0].replace("!","").indexOf("!")+2)),i[0]=w+Ft(y)+b+":"+Ft(x)+C;for(var M=this.parent.getCellCollection(i[0]),E=x-y,T=[],f=0;f<M.length;f++)T.push(M[f]);if(o==="FALSE")if(E===0)for(var f=0;f<T.length;f++){var D=this.parent.getValueFromArg(T[f]);D=D===""?"0":D,h.push(D)}else for(var N="",A=E,f=0;f<T.length;f++){if(f===T.length-1){var D=this.parent.getValueFromArg(T[f]);D=D===""?"0":D,N=N+D+"+",h.push(N.substring(0,N.length-1))}if(f<=A){var D=this.parent.getValueFromArg(T[f]);D=D===""?"0":D,N=N+D+"+"}else{h.push(N.substring(0,N.length-1)),A=E+f;var D=this.parent.getValueFromArg(T[f]);D=D===""?"0":D,N=D+"+"}}else for(var N="",A=E+1,L=C-b,f=0;f<A;f++){for(var k=0;k<=L;k++){var D=this.parent.getValueFromArg(T[k*A+f]);D=D===""?"0":D,N=N+D+"+"}h.push(N.substring(0,N.length-1)),N=""}for(var O=[],R=[],f=0;f<h.length;f++)O.indexOf(h[f])===-1?O.push(h[f]):R.push(h[f]);if(l==="TRUE"){for(var j=[],f=0;f<O.length;f++)R.indexOf(O[f])===-1&&j.push(O[f]);O=j}if(n){var P;return E!==0?(P=[],O.forEach(function(H){P=P.concat(H.split("+"))})):P=o==="FALSE"?O:O[0].split("+"),P}u=u.indexOf("!")>-1?u.split("!")[1]:u;var F=this.parent.rowIndex(u),z=this.parent.colIndex(u);if(this.parent.dependencyLevel===0){var q=!1;if(o==="FALSE")for(var f=F,A=O.length+F;f<A;f++)for(var X=O[0].split("+"),G=z,Z=X.length+z;G<Z;G++)f===A-1&&G===Z-1&&this.parent.uniqueRange.indexOf(a+":"+Ft(G)+f)===-1&&this.parent.uniqueRange.push(a+":"+Ft(G)+f),this.checkSpill(G,f)&&(q=!0);else for(var f=z,A=O.length+z;f<A;f++)for(var X=O[0].split("+"),se=F,Z=X.length+F;se<Z;se++)f===A-1&&se===Z-1&&this.parent.uniqueRange.indexOf(this.parent.actCell+":"+Ft(f)+se)===-1&&this.parent.uniqueRange.push(this.parent.actCell+":"+Ft(f)+se),this.checkSpill(f,se)&&(q=!0);if(q)return this.parent.formulaErrorStrings[Ce.spill]}else if(this.parent.dependencyLevel>0&&this.parent.getValueFromArg(Ft(z)+F,!0).indexOf("#SPILL!")>-1)return this.parent.formulaErrorStrings[Ce.spill];if(o==="FALSE"){var oe=this.parent.getSheetFamilyItem(this.parent.grid),fe="",be=void 0;oe.sheetNameToParentObject!==null&&oe.sheetNameToParentObject.size>0&&(fe=oe.parentObjectToToken.get(this.parent.grid),be=fe+u);for(var f=0;f<O.length;f++){var X=O[f].split("+");f>0&&(F++,z=this.parent.colIndex(u));for(var Ne=0;Ne<X.length;Ne++)this.setValueRefresh(X[Ne],F,z,u),(f>0||Ne>0)&&this.parent.refresh(fe+Ft(z)+F.toString(),be),X[Ne+1]&&z++}r=O[0].split("+")[0]}else{for(var f=0;f<O.length;f++)for(var X=O[f].split("+"),we=0;we<X.length;we++)this.setValueRefresh(X[we],F,z,u),X[we+1]?F++:(z++,F=this.parent.rowIndex(u));r=O[0].split("+")[0]}}}else if(this.parent.isCellReference(i[0]))this.parent.dependencyCollection.indexOf(i[0])===-1?n||this.parent.dependencyCollection.push(i[0]):this.clearDependency(i[0]),r=this.parent.getValueFromArg(i[0]);else return i[0].split('"').join("");return r},s.prototype.setValueRefresh=function(e,t,i,r){this.parent.parentObject.setValueRowCol(this.parent.getSheetId(this.parent.grid),e,t,i)},s.prototype.checkSpill=function(e,t){var i=!1,r=this.parent.getValueFromArg(Ft(e)+t,!0),n="!"+this.parent.getSheetID(this.parent.grid)+"!"+Ft(e)+t,a;return this.parent.getFormulaInfoTable().get(n)&&(a=this.parent.getFormulaInfoTable().get(n).formulaText),r&&(r.toUpperCase().indexOf("UNIQUE")<0||a&&!a.toUpperCase().includes("UNIQUE"))&&r!==this.parent.formulaErrorStrings[Ce.wrong_number_arguments]&&(i=!0),i},s.prototype.clearDependency=function(e){var t=this.parent.actCell,i="";if(t.indexOf("!")>-1){var r=t.split("!");t=r[1],i=r[0]+"!"}for(var n=this.parent.rowIndex(t),a=this.parent.colIndex(t),o=e.indexOf(":"),l=this.parent.rowIndex(this.parent.substring(e,0,o)),h=this.parent.colIndex(this.parent.substring(e,0,o)),u=this.parent.rowIndex(this.parent.substring(e,o+1,o+e.length-o-1)),c=this.parent.colIndex(this.parent.substring(e,o+1,o+e.length-o-1)),d=u-l+n,p=c-h+a,f=this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+t)?this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+t).getFormulaText():"",v=n;v<=d;v++)for(var g=a;g<=p;g++)if(this.parent.dependencyLevel>0||f.indexOf("UNIQUE")>-1){if(this.parent.getValueFromArg("!"+this.parent.getSheetID(this.parent.grid)+"!"+Ft(a)+n,!0).indexOf("#SPILL!")>-1)return;this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,"",v,g),this.parent.refresh("!"+this.parent.getSheetID(this.parent.grid)+"!"+Ft(g)+v,t),this.parent.actCell=i+t}},s.prototype.ComputeT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i="",r;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var n=e[0];n=n.indexOf(":")>-1?n.split(":")[0]:n,n=this.parent.getValueFromArg(n);var a=/^[0-9.]+$/;return n.match(a)===null&&n.toUpperCase()!=="TRUE"&&n.toUpperCase()!=="FALSE"&&(i=n,r&&(i=this.parent.tic+i+this.parent.tic)),i},s.prototype.ComputeHOUR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||m(e)||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.num];i=this.parent.intToTime(i)}else{var r={value:i.toString()};if(this.parent.parentObject.notify(yn,r),r.isDate||r.isTime)i=this.parent.intToTime(r.updatedVal);else return this.parent.getErrorStrings()[W.value]}var n=new Date(Date.parse(i));if(n.toString()==="Invalid Date"){var a=new Date(Date.now()).toLocaleDateString()+" "+i;n=new Date(Date.parse(a))}return n.toString()==="Invalid Date"&&(n=this.parent.fromOADate(this.parent.parseFloat(i))),n.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.value]:n.getFullYear()<1900||n.getFullYear()>9999?this.parent.getErrorStrings()[W.value]:n.getHours()},s.prototype.ComputeMINUTE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||m(e)||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.num];i=this.parent.intToTime(i)}else{var r={value:i.toString()};if(this.parent.parentObject.notify(yn,r),r.isDate||r.isTime)i=this.parent.intToTime(r.updatedVal);else return this.parent.getErrorStrings()[W.value]}var n=new Date(Date.parse(i));if(n.toString()==="Invalid Date"){var a=new Date(Date.now()).toLocaleDateString()+" "+i;n=new Date(Date.parse(a))}return n.toString()==="Invalid Date"&&(n=this.parent.fromOADate(this.parent.parseFloat(i))),n.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.value]:n.getFullYear()<1900||n.getFullYear()>9999?this.parent.getErrorStrings()[W.value]:n.getMinutes()},s.prototype.ComputeSECOND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||m(e)||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.num];i=this.parent.intToTime(i)}else{var r={value:i.toString()};if(this.parent.parentObject.notify(yn,r),r.isDate||r.isTime)i=this.parent.intToTime(r.updatedVal);else return this.parent.getErrorStrings()[W.value]}var n=new Date(Date.parse(i));if(n.toString()==="Invalid Date"){var a=new Date(Date.now()).toLocaleDateString()+" "+i;n=new Date(Date.parse(a))}return n.toString()==="Invalid Date"&&(n=this.parent.fromOADate(this.parent.parseFloat(i))),n.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.value]:n.getFullYear()<1900||n.getFullYear()>9999?this.parent.getErrorStrings()[W.value]:n.getSeconds()},s.prototype.ComputeMONTH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e[0]==="")return this.parent.getErrorStrings()[W.value];if(e.length!==1||m(e))return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(!this.parent.isCellReference(e[0])&&e[0].indexOf(this.parent.tic)===-1)return this.parent.getErrorStrings()[W.value];var i=this.spreadsheetFormat(e[0]),r=this.spreadsheetDisplayText(e[0]),n=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),a=this.parseDouble(n),o=0,l=new Date(Date.parse(n));!isNaN(a)&&l.getFullYear()>9999&&(l=this.parent.fromOADate(a));var h=parseInt(n,10);return h<0?this.parent.getErrorStrings()[W.num]:(h===0&&n!==i&&i.indexOf("h:mm")>-1&&(l=this.parent.fromOADate(parseInt(r,10))),l.toString()==="Invalid Date"&&(l=this.parent.fromOADate(parseInt(n,10))),l.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.value]:(l.toString()!=="Invalid Date"&&(o=l.getMonth()+1),o.toString()))},s.prototype.ComputeNOW=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||e[0]!=="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=new Date(Date.now()),r=new _t,n=r.getDateFormat({format:"M/d/yyyy h:mm:ss a"}),a=this.parent.parentObject.dateToInt(n(i),!0);return a.toString()},s.prototype.ComputeEXACT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1,r;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),m(e)||e.length!==2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];var n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join(""),a=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");return a===n&&(i=!0),r&&(i=this.parent.tic+i+this.parent.tic),i},s.prototype.ComputeLEN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length!==1)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]==="")return this.parent.getErrorStrings()[W.value];var i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");return i==="#NAME?"?this.parent.getErrorStrings()[W.name]:i.length},s.prototype.ComputeMOD=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[1]===""&&!e[0].includes('"'))return this.parent.formulaErrorStrings[Ce.div];if(e[0]===""&&!e[1].includes('"'))return 0;for(var r=0;r<e.length;r++){var n=e[r].split(this.parent.tic).join("").trim();if(n===""||e[r].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(n)))return this.parent.getErrorStrings()[W.value];if(ur(e[r])){if(i=this.parent.getValueFromArg(e[r])||"0",i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,i.toUpperCase().match(/[A-Z]/)||i.includes('"')||!this.parent.isNumber(i))return this.parent.getErrorStrings()[W.value]}else i=this.parent.getValueFromArg(e[r].split(this.parent.tic).join("")),i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;e[r]=i}var a=e[0],o=e[1];if(o==="0"||o==="")return this.parent.formulaErrorStrings[Ce.div];if(a==="0"||a==="")return 0;a=parseFloat(a),o=parseFloat(o);var l=(a%o+o)%o;return isNaN(l)?this.parent.getErrorStrings()[W.name]:l},s.prototype.ComputeODD=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=e[0].split(this.parent.tic).join("").trim();if(i===""||e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.value];var r;if(ur(e[0])){if(r=this.parent.getValueFromArg(e[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}else{if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}var n=Math.ceil(parseInt(r,10)),a=n===0;return n=n%2===0?n>0?n+1:n-1:n,Math.ceil(parseInt(r,10))%2!==0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.name]:a?1:n},s.prototype.ComputeEVEN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var i=e[0].split(this.parent.tic).join("").trim();if(i===""||e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.value];var r;if(ur(e[0])){if(r=this.parent.getValueFromArg(e[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}else{if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}var n=Math.ceil(parseInt(r,10));return n=n%2===0?n:n>0?n+1:n-1,Math.ceil(parseInt(r,10))%2===0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.name]:n},s.prototype.ComputePI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;return e&&e[0]!==""?i=this.parent.formulaErrorStrings[Ce.invalid_arguments]:i=Math.PI,i},s.prototype.ComputeMEDIAN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=[];if(m(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var n=0;n<e.length;n++)if(this.parent.isCellReference(e[n]))if(e[n].indexOf(":")>-1)for(var a=this.parent.getCellCollection(e[n]),o=0;o<a.length;o++){var l=this.parent.getValueFromArg(a[o]);if(this.parent.getErrorStrings().indexOf(l)>-1)return l;l.trim()!==""&&r.push(this.parent.parseFloat(l))}else{var h=this.parent.getValueFromArg(e[n]);if(this.parent.getErrorStrings().indexOf(h)>-1)return h;h.trim()!==""&&r.push(this.parent.parseFloat(h))}else if(e[n]===""||e[n]===this.parent.falseValue&&!this.parent.isCellReference(e[n]))r.push(0);else if(e[n]===this.parent.trueValue&&!this.parent.isCellReference(e[n]))r.push(1);else{if(e[n].indexOf(this.parent.tic)>-1&&isNaN(parseFloat(e[n].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];r.push(this.parent.parseFloat(this.parent.getValueFromArg(e[n]).split(this.parent.tic).join("")))}r=r.sort(function(d,p){return d-p});for(var u=r.length,c=0;c<u&&!(isNaN(r[c])&&(r.splice(c,1),u=r.length,c--,r.length===0));c++);if(r.length%2!==0&&!isNaN(r[parseInt((r.length/2).toString(),10)]))i=r[parseInt((r.length/2).toString(),10)];else if(!isNaN(r[r.length/2])&&!isNaN(r[r.length/2-1]))i=(r[r.length/2]+r[r.length/2-1])/2;else return this.parent.getErrorStrings()[W.num];return i},s.prototype.ComputeEDATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==2||m(e))return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]===""||e[1]==="")return this.parent.getErrorStrings()[W.na];if(e[0].split(this.parent.tic).join("")===""||e[1].split(this.parent.tic).join("")===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];var i,r;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.value];if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""));if(this.parent.isCellReference(e[1])){if(e[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.value];r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.num];n=this.parent.fromOADate(i)}else n=new Date(Date.parse(i));if(isNaN(r)||m(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.value];var a=n.getDate();n.setMonth(n.getMonth()+r),a!==n.getDate()&&n.setDate(0);var o=this.parent.parentObject.dateToInt(n);return i.toString()==="0"&&(o-=1),o<0||o>2958465?this.parent.getErrorStrings()[W.num]:o.toString()},s.prototype.ComputeEOMONTH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==2||m(e))return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]===""||e[1]==="")return this.parent.getErrorStrings()[W.na];if(e[0].split(this.parent.tic).join("")===""||e[1].split(this.parent.tic).join("")===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];var i,r;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.value];if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.isCellReference(e[1])){if(e[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.value];r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.num];n=this.parent.fromOADate(i)}else n=new Date(Date.parse(i));if(isNaN(r)||m(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.value];n=new Date(n.getFullYear(),n.getMonth()+(r+1),0);var a=this.parent.parentObject.dateToInt(n);return a<0||a>2958465||n.getFullYear()<1900?this.parent.getErrorStrings()[W.num]:a.toString()},s.prototype.ComputeDATEVALUE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r;return e.length!==1||m(e)?this.parent.formulaErrorStrings[Ce.invalid_arguments]:e[0]===""||this.parent.isCellReference(e[0])?this.parent.getErrorStrings()[W.value]:e[0].indexOf(this.parent.tic)===-1?this.parent.getErrorStrings()[W.value]:(r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),i=isNaN(parseInt(r,10))?new Date(Date.parse(r)):this.parent.fromOADate(parseInt(r,10)),m(this.parent.isDate(i))||parseInt(r,10).toString().length!==5?this.parent.getErrorStrings()[W.value]:this.parent.isDate(r)&&this.parent.isDate(r).getFullYear().toString().length!==4?this.parent.getErrorStrings()[W.value]:parseFloat(r).toFixed(0).toString())},s.prototype.ComputeCOUNTBLANK=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=0;if(e.length!==1||m(e)||!this.parent.isCellReference(e[0]))return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]==="")return this.parent.getErrorStrings()[W.value];for(var r=this.parent.getCellCollection(e[0]),n=0;n<r.length;n++)this.parent.getValueFromArg(r[n])===""&&i++;return i},s.prototype.ComputeFACT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=1;if(m(e)||e.length!==1)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0]==="")return this.parent.getErrorStrings()[W.value];var r=parseInt(this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),10);if(this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("").toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[W.value];if(r<0)return this.parent.getErrorStrings()[W.num];for(var n=1;n<=r;n++)i=i*n;return i},s.prototype.ComputeDECIMAL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=/[@#$%^&*()?:{}|<>+-]/g;if(m(e)||e.length!==2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0].match(r))return this.parent.getErrorStrings()[W.num];if(e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];var n=void 0,a=void 0;this.parent.isCellReference(e[0].toString())?n=this.parent.getValueFromArg(e[0]):n=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),this.parent.isCellReference(e[1].toString())?a=this.parent.getValueFromArg(e[1]):a=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");var o=parseInt(n,10),l=parseInt(a,10);return this.parent.getErrorStrings().indexOf(n)>-1?n:this.parent.getErrorStrings().indexOf(a)>-1?a:n===""&&a!==""?0:n===""||o<0||!isNaN(o)&&!Number.isInteger(parseFloat(n))?this.parent.getErrorStrings()[W.num]:a===""||l<2||l>36||isNaN(l)?this.parent.getErrorStrings()[W.num]:isNaN(this.parent.parseFloat(n))&&this.parent.parseFloat(a)<=10?this.parent.getErrorStrings()[W.num]:(i=parseInt(n,parseInt(a,10)),isNaN(i)?this.parent.getErrorStrings()[W.num]:i)},s.prototype.ComputeDEGREES=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var r=Math.PI,n=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");return n.toUpperCase().match(/[A-Z]/)?this.parent.getErrorStrings()[W.value]:isNaN(parseInt(n,10))?this.parent.getErrorStrings()[W.value]:(i=parseFloat(n)*(180/r),parseInt(i.toString(),10))},s.prototype.ComputeADDRESS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length>5||e[0]===""||e[1]===""||e.length<2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];e[2]=e[2]?e[2]:"1",e[3]=e[3]?e[3]:"TRUE";var r=this.parent.getValueFromArg(e[0]),n=this.parent.getValueFromArg(e[1]),a=this.parent.getValueFromArg(e[2]),o=this.parent.getValueFromArg(e[3]);if(a=a.split(this.parent.tic).join(""),o=o.split(this.parent.tic).join(""),r=r.split(this.parent.tic).join(""),n=n.split(this.parent.tic).join(""),parseInt(r,10)<=0||parseInt(n,10)<=0)return this.parent.getErrorStrings()[W.value];if(r.toUpperCase().match(/[A-Z]/)||n.toUpperCase().match(/[A-Z]/)||a.toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[W.value];o==="TRUE"||o==="1"?a==="1"?i="$"+Ft(parseInt(n,10))+"$"+parseInt(r,10):a==="2"?i=Ft(parseInt(n,10))+"$"+parseInt(r,10):a==="3"?i="$"+Ft(parseInt(n,10))+parseInt(r,10):a==="4"&&(i=Ft(parseInt(n,10))+parseInt(r,10)):(o==="FALSE"||o==="0")&&(a==="1"?i="R"+parseInt(r,10)+"C"+parseInt(n,10):a==="2"?i="R"+parseInt(r,10)+"C["+parseInt(n,10)+"]":a==="3"?i="R["+parseInt(r,10)+"]C"+parseInt(n,10):a==="4"&&(i="R["+parseInt(r,10)+"]C["+parseInt(n,10)+"]"));var l=["TRUE","FALSE","1","0"];if(l.indexOf(o)===-1)return this.parent.getErrorStrings()[W.name];if(!m(e[4])&&e[4]!==""){var h=this.parent.getValueFromArg(e[4]).split(this.parent.tic).join("");if(h==="#NAME?")return this.parent.getErrorStrings()[W.name];i=h+"!"+i}return i},s.prototype.ComputeTIME=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==3)return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e[0].indexOf(this.parent.tic)>-1&&e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];if(e[1].indexOf(this.parent.tic)>-1&&e[1].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];if(e[2].indexOf(this.parent.tic)>-1&&e[2].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];var r,n,a;if(this.parent.isCellReference(e[0])){if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",r.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(isNaN(this.parent.parseFloat(r))&&!(r===this.parent.trueValue||r===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];if(this.parent.isCellReference(e[1])){if(n=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0",n.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;if(isNaN(this.parent.parseFloat(n))&&!(n===this.parent.trueValue||n===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];if(this.parent.isCellReference(e[2])){if(a=this.parent.getValueFromArg(e[2].split(this.parent.tic).join(""))||"0",a.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(e[2].indexOf(this.parent.tic)>-1&&(e[2].split(this.parent.tic).join("")===this.parent.trueValue||e[2].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];a=this.parent.getValueFromArg(e[2]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(a)>-1)return a;if(isNaN(this.parent.parseFloat(a))&&!(a===this.parent.trueValue||a===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];if(r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,a=a===this.parent.trueValue?"1":a===this.parent.falseValue?"0":a,r=parseInt(this.parent.parseFloat(r).toString(),10),n=parseInt(this.parent.parseFloat(n).toString(),10),a=parseInt(this.parent.parseFloat(a).toString(),10),isNaN(r)||isNaN(n)||isNaN(a))return this.parent.getErrorStrings()[W.value];if(r>32767||n>32767||a>32767)return this.parent.getErrorStrings()[W.num];var o=new Date(1900,0,1,r,n,a);if(o.getFullYear()<1900)return this.parent.getErrorStrings()[W.num];var l=o.getHours(),h=o.getMinutes(),u=o.getSeconds(),c="AM",d=l;d>=12&&(d=l-12,c="PM"),d===0&&(d=12),h=h<10?"0"+h:h,u=u<10?"0"+u:u,d=d<10?"0"+d:d,i=d+":"+h+":"+u+" "+c;var p={value:i.toString()};return this.parent.parentObject.notify(yn,p),p.isTime&&(i=p.updatedVal),i},s.prototype.ComputeCHAR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");if(r==="#NAME?")return this.parent.getErrorStrings()[W.name];if(r.toUpperCase().match(/^[0-9]+$/)){var n=parseInt(r,10);if(n>255||n<=0)return this.parent.getErrorStrings()[W.value];i=String.fromCharCode(n)}else return this.parent.getErrorStrings()[W.value];return i},s.prototype.ComputeCODE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");if(r==="#NAME?")return this.parent.getErrorStrings()[W.name];if(r!=="")i=r.charCodeAt(0);else return this.parent.getErrorStrings()[W.value];return i},s.prototype.ComputeDOLLAR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(n=!0,e.pop()),e.length===1&&(e[0]===""&&(r=!0),e.push("2")),m(e)||e.length!==2||r)return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var a=0;a<e.length;a++)if(e[a].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[a])))return this.parent.getErrorStrings()[W.value];var o=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),l=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(o=o===""||o===this.parent.falseValue?"0":o===this.parent.trueValue?"1":o,l=l===""||l===this.parent.falseValue?"0":l===this.parent.trueValue?"1":l,o==="#NAME?"||l==="#NAME?")return this.parent.getErrorStrings()[W.name];if(o.toUpperCase().match(/^[-]?[0-9.]+$/)&&l.toUpperCase().match(/^[-]?[0-9.]+$/)){for(var h=new _t,u=parseInt(l,10),c=Math.pow(10,-1*u),d="",p=1;p<=u;p++)d+="0";var f=Math.round(this.parent.parseFloat(o)/c)*c;isNaN(f)?i=this.parent.getErrorStrings()[W.value]:i=h.formatNumber(f,{format:"$#,##0."+d+";($#,##0."+d+");$0."+d})}else return this.parent.getErrorStrings()[W.value];return n&&(i=this.parent.tic+i+this.parent.tic),i},s.prototype.ComputeSMALL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e[0]===""||e.length!==2)return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var r=this.parent.getCellCollection(e[0]),n=[],a=0;a<r.length;a++)n.push(parseFloat(this.parent.getValueFromArg(r[a]).split(this.parent.tic).join("")));n=n.sort(function(u,c){return u-c});for(var o=n.length,l=0;l<o&&!(isNaN(n[l])&&(n.splice(l,1),o=n.length,l--,n.length===0));l++);var h=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(h==="#NAME?")return this.parent.getErrorStrings()[W.name];if(h=parseInt(h,10),h.toString().toUpperCase().match(/^[0-9]+$/)&&n[h-1]&&n[h-1].toString().toUpperCase().match(/^[-.0-9]+$/)&&h!==0)i=n[h-1];else return m(n[h-1])?this.parent.getErrorStrings()[W.num]:this.parent.getErrorStrings()[W.value];return i},s.prototype.ComputeLARGE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(m(e)||e.length!==2||e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var r=this.parent.getCellCollection(e[0]),n=[],a=0;a<r.length;a++)n.push(parseFloat(this.parent.getValueFromArg(r[a]).split(this.parent.tic).join("")));n=n.sort(function(h,u){return u-h});for(var o=0;o<n.length&&!(isNaN(n[o])&&(n.splice(o,1),o--,n.length===0));o++);var l=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(l==="#NAME?")return this.parent.getErrorStrings()[W.name];if(l=parseInt(l,10),l.toString().toUpperCase().match(/^[0-9]+$/)&&n[l-1]&&n[l-1].toString().toUpperCase().match(/^[-.0-9]+$/)&&l!==0)i=n[l-1];else return m(n[l-1])?this.parent.getErrorStrings()[W.num]:this.parent.getErrorStrings()[W.value];return i},s.prototype.ComputeCHOOSE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];if(e.length<2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var i=e;if(i[0].indexOf(":")>-1&&this.parent.isCellReference(i[0])){var r=this.parent.getCellCollection(i[0]);if(r.length===1)i[0]=r[0];else return this.parent.getErrorStrings()[W.value]}var n=this.parent.getValueFromArg(i[0]);if(this.parent.getErrorStrings().indexOf(n)>-1)return n;var a=this.parent.parseFloat(this.parent.getValueFromArg(i[0].split(this.parent.tic).join("")));if(a<1)return this.parent.getErrorStrings()[W.value];a=Math.floor(a);var o;if(m(i[a]))return this.parent.getErrorStrings()[W.value];if(o=i[a],o===""&&(o="0"),o.indexOf(":")>-1&&this.parent.isCellReference(o)){var r=this.parent.getCellCollection(i[0].split(this.parent.tic).join(""));if(r.length===1)i[0]=r[0];else return this.parent.getErrorStrings()[W.value]}return this.parent.getValueFromArg(o).split(this.parent.tic).join("")},s.prototype.ComputeSUMIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0])||i[2]&&i[2].indexOf(":")<0&&!this.parent.isCellReference(i[2]))return this.parent.formulaErrorStrings[Ce.improper_formula];if(i.length>3||i.length<2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r=this.parent.computeSumIfAndAvgIf(e,!1);return typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:r[0]},s.prototype.ComputeABS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r="",n;if(e.length===0||e.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];var a=i[0].split(this.parent.tic).join("").trim();if(a===""||i[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.value];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0]),this.parent.getErrorStrings().indexOf(r)>-1)return this.parent.getErrorStrings()[W.value];if(r===this.parent.trueValue&&(r="1"),(r===""||r===this.parent.falseValue)&&(r="0"),n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}else{if(r=this.parent.getValueFromArg(i[0]).split(this.parent.tic).join(),r===this.parent.trueValue&&(r="1"),r===this.parent.falseValue&&(r="0"),this.parent.getErrorStrings().indexOf(r)>-1)return r;if(n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.value]}return Math.abs(n)},s.prototype.ComputeAVERAGE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var r=e,n=0;n<r.length;n++)if(r[n].indexOf(":")>-1&&r[n].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value];return this.parent.calculateAvg(r,i)},s.prototype.ComputeAVERAGEIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.formulaErrorStrings[Ce.improper_formula];var r=this.parent.computeSumIfAndAvgIf(e,!0);return r[1]===0||r[0].toString()==="NaN"?this.parent.formulaErrorStrings[Ce.div]:typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:this.parent.parseFloat(r[0])/this.parent.parseFloat(r[1])},s.prototype.ComputeCONCATENATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.invalid_arguments];for(var i=e,r="",n="",a=0;a<i.length;a++){if(i[a].indexOf(":")>-1&&this.parent.isCellReference(i[a]))if(this.isConcat)for(var o=this.parent.getCellCollection(i[a]),l=0;l<o.length;l++)n=this.parent.getValueFromArg(o[l]),r=r+n;else return this.parent.getErrorStrings()[W.value];else{if(i.length===1&&i[0].indexOf(this.parent.tic)<0)return this.parent.getErrorStrings()[W.name];n=this.parent.getValueFromArg(i[a]),r=r+n}if(this.parent.getErrorStrings().indexOf(n)>-1)return n}return r.split(this.parent.tic).join("")},s.prototype.ComputeCONCAT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isConcat=!0,this.ComputeCONCATENATE.apply(this,e)},s.prototype.ComputeMAX=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.parent.computeMinMax(e,"max")},s.prototype.ComputeMIN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.parent.computeMinMax(e,"min")},s.prototype.ComputeRAND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length===1&&e[0]===""&&(e.length=0),e.length>0?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:Math.random().toString()},s.prototype.ComputeAND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(e)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[Ce.invalid_arguments]:this.parent.computeAndOrNot(i,"and")},s.prototype.ComputeOR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(e)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[Ce.invalid_arguments]:this.parent.computeAndOrNot(i,"or")},s.prototype.ComputeNOT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(e)||e.length>1||e[0]===""?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:this.parent.computeAndOrNot(i,"not")},s.prototype.ComputeFIND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var i=e;if(i.length>3)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r=this.parent.removeTics(this.parent.getValueFromArg(i[0])),n=this.parent.removeTics(this.parent.getValueFromArg(i[1]));if(this.parent.getErrorStrings().indexOf(r)>-1||this.parent.getErrorStrings().indexOf(n)>-1)return this.parent.getErrorStrings()[W.name];var a=1;if(i.length===3){if(a=this.parent.removeTics(this.parent.getValueFromArg(i[2])),this.parent.getErrorStrings().indexOf(a)>-1)return a;a=this.parent.parseFloat(a),isNaN(a)&&(a=1)}if(a<=0||a>n.length)return this.parent.getErrorStrings()[W.value];var o=n.indexOf(r,a-1);return o<0?this.parent.getErrorStrings()[W.value]:(Number(o)+1).toString()},s.prototype.ComputeINDEX=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r;i.length&&i[i.length-1]==="nestedFormulaTrue"&&(r=!0,i.pop());var n=i.length;if(m(e)||i.length===1&&i[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(n>3)return this.parent.getErrorStrings()[W.ref];var a="";if(n>2)for(var o=0;o<n;o++){if(this.parent.isCellReference(i[o])&&i[o].indexOf(":")<0){var l=this.parent.getValueFromArg(i[o]);if(this.parent.getErrorStrings().indexOf(l)>-1)return this.parent.getErrorStrings()[W.ref]}this.parent.isCellReference(i[o])&&i[o]}if(a=i[0],i[1]=i[1]===""?"1":i[1],i[1]=this.parent.getValueFromArg(i[1]),this.parent.getErrorStrings().indexOf(i[1])>-1)return i[1];if(!m(i[2])){if(i[2]=i[2]===""?"1":i[2],i[2]=this.parent.getValueFromArg(i[2]),this.parent.getErrorStrings().indexOf(i[2])>-1)return i[2];if(i[2]==="0")return this.parent.getErrorStrings()[W.value]}var h=parseFloat(i[1]);h=isNaN(h)?-1:h;var u=parseFloat(i[2]?i[2]:"1");if(u=isNaN(u)?-1:u,h===-1||u===-1)return this.parent.getErrorStrings()[W.value];var c=i[0].indexOf(":"),d=this.parent.rowIndex(a.substring(0,c)),p=this.parent.rowIndex(a.substring(c+1)),f=this.parent.colIndex(a.substring(0,c)),v=this.parent.colIndex(a.substring(c+1));if(h>p-d+1||u>v-f+1)return this.parent.getErrorStrings()[W.ref];h=d+h-1,u=f+u-1;var g=this.getSheetReference(a)+this.parent.convertAlpha(u)+h,b=this.parent.getValueFromArg(g);return b===""?0:r&&!He(b)&&b!==this.parent.trueValue&&b!==this.parent.falseValue&&this.parent.getErrorStrings().indexOf(b)===-1?'"'+b+'"':b},s.prototype.getSheetReference=function(e){return e.indexOf(this.parent.sheetToken)===0&&e.lastIndexOf(this.parent.sheetToken)>e.indexOf(this.parent.sheetToken)?e.substring(0,e.lastIndexOf(this.parent.sheetToken)+1):""},s.prototype.ComputeIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(m(e)||i.length===1&&i[0]===""||i.length%2!==0)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var r="",n="",a=0;a<i.length;a++){if(r=this.parent.getValueFromArg(i[a]),i[a]==="")return this.parent.getErrorStrings()[W.na];if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(r!==this.parent.trueValue&&r!==this.parent.falseValue)return this.parent.getErrorStrings()[W.value];if(r===this.parent.trueValue)return this.parent.isCellReference(i[a+1].split(this.parent.tic).join(""))||i[a+1].includes(this.parent.arithMarker)?(n=this.parent.getValueFromArg(i[a+1]),n=n===""?"0":n):(n=i[a+1]===""?"0":this.parent.getValueFromArg(i[a+1]),n.indexOf(this.parent.tic)>-1&&(n=n.split(this.parent.tic).join(""))),a=a+1,n;r===this.parent.falseValue&&(a=a+1)}return this.parent.getErrorStrings()[W.na]},s.prototype.ComputeCOUNTA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var r=e,n,a=0,o,l,h=0;h<r.length;h++)if(this.parent.isCellReference(r[h]))if(r[h].indexOf(":")>-1){n=this.parent.getCellCollection(r[h].split(this.parent.tic).join(""));for(var u=0;u<n.length;u++)o=i?this.parent.getValueFromArg(n[u],null,null,!0):this.parent.getValueFromArg(n[u]),!(i&&o.includes("SUBTOTAL("))&&o.length>0&&a++}else{if(o=i?this.parent.getValueFromArg(r[h],null,null,!0):this.parent.getValueFromArg(r[h]),i&&o.includes("SUBTOTAL("))continue;o.length>0&&a++}else l=this.parent.getValueFromArg(r[h]).split(this.parent.tic).join(""),(l.length>0||l.length===0&&l.trim()==="")&&a++;return a},s.prototype.ComputeAVERAGEA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(m(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var i=e,r,n=0,a,o,l=0,h,u=0;u<i.length;u++)if(this.parent.isCellReference(i[u]))if(i[u].indexOf(":")>-1){r=this.parent.getCellCollection(i[u].split(this.parent.tic).join(""));for(var c=0;c<r.length;c++){if(a=this.parent.getValueFromArg(r[c]),a=this.processLogicalCellValue(a),this.parent.getErrorStrings().indexOf(a)>-1)return a;if(m(a)||a==="")continue;h=this.parent.parseFloat(a),a=isNaN(h)?0:h,n+=a,l=l+1}}else{if(a=this.parent.getValueFromArg(i[u]),a=this.processLogicalCellValue(a),this.parent.getErrorStrings().indexOf(a)>-1)return a;if(m(a)||a==="")continue;h=this.parent.parseFloat(a),a=isNaN(h)?0:h,n+=a,l=l+1}else{if(i[u].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(i[u].split(this.parent.tic).join("")))||i[u].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.value];if(i[u]=this.processLogicalCellValue(i[u]),o=this.parent.getValueFromArg(i[u].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(o)>-1)return o;n+=this.parent.parseFloat(o),l=l+1}return l===0?this.parent.getErrorStrings()[W.divzero]:n/l},s.prototype.processLogicalCellValue=function(e){var t=e;return t.toUpperCase()===this.parent.trueValue?t="1":t.toUpperCase()===this.parent.falseValue&&(t="0"),t},s.prototype.ComputeSORT=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n;t.length&&t[t.length-1]==="nestedFormulaTrue"&&(r=!0,t.pop());var a=t,o,l=[];if(m(t)||t[0]===""||a.length>4)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];a[1]=a[1]?a[1]:"1",a[2]=a[2]?a[2]:"1",a[3]=a[3]?a[3]:"FALSE",a[0]=a[0].split("$").join("");var h,u=[];if(a[0].indexOf(":")>-1){var c=a[0].split(":");if(this.parent.isCellReference(c[0])&&this.parent.isCellReference(c[1])){var d=a[0].indexOf(":"),p=void 0,f=this.parent.rowIndex(this.parent.substring(a[0],0,d)),v=this.parent.colIndex(this.parent.substring(a[0],0,d)),g=this.parent.rowIndex(this.parent.substring(a[0],d+1,d+a[0].length-d-1)),b=this.parent.colIndex(this.parent.substring(a[0],d+1,d+a[0].length-d-1));if(f>g&&(p=g,g=f,f=p),v>b&&(p=b,b=v,v=p),this.parent.isCellReference(a[3])){if(a[3]=this.parent.getValueFromArg(a[3]).toUpperCase(),a[3]!==this.parent.trueValue&&a[3]!==this.parent.falseValue)if(He(a[3]))a[3]=Number(a[3])===0?this.parent.falseValue:this.parent.trueValue;else if(a[3]==="")a[3]=this.parent.falseValue;else return this.parent.getErrorStrings()[W.value]}else if(n=a[3].startsWith(this.parent.tic)&&a[3].endsWith(this.parent.tic),a[3]=this.parent.getValueFromArg(a[3]),a[3]=He(a[3])?Number(a[3])===0?this.parent.falseValue:this.parent.trueValue:a[3].split(this.parent.tic).join("").toUpperCase(),a[3]!==this.parent.trueValue&&a[3]!==this.parent.falseValue)return n?this.parent.getErrorStrings()[W.value]:this.parent.getErrorStrings()[W.name];if(this.parent.isCellReference(a[2])?(a[2]=this.parent.getValueFromArg(a[2]),a[2]=a[2]===this.parent.trueValue?"1":a[2]):(a[2]=this.parent.getValueFromArg(a[2]),a[2]=a[2]===this.parent.trueValue?"1":a[2].split(this.parent.tic).join("")),a[2]=He(a[2])?Math.floor(Number(a[2])).toString():a[2],a[2]!=="1"&&a[2]!=="-1")return this.parent.getErrorStrings().indexOf(a[2])>-1?this.parent.getErrorStrings()[W.name]:this.parent.getErrorStrings()[W.value];var y=a[2]==="1"?"Ascending":"Descending";if(this.parent.isCellReference(a[1])){if(a[1]=this.parent.getValueFromArg(a[1]),a[1]=He(a[1])?Math.floor(Number(a[1])).toString():a[1]===this.parent.trueValue?"1":a[1]===this.parent.falseValue?"0":a[1],isNaN(this.parseDouble(a[1]))||this.parseDouble(a[1])<1||(a[3]===this.parent.trueValue?g-f+1<this.parseDouble(a[1]):b-v+1<this.parseDouble(a[1])))return this.parent.getErrorStrings()[W.value]}else if(n=a[1].startsWith(this.parent.tic)&&a[1].endsWith(this.parent.tic),a[1]=this.parent.getValueFromArg(a[1]),a[1]=He(a[1])?Math.floor(Number(a[1])).toString():a[1]===this.parent.trueValue?"1":a[1]===this.parent.falseValue?"0":a[1].split(this.parent.tic).join(""),isNaN(this.parseDouble(a[1]))?n:this.parseDouble(a[1])<1||(a[3]===this.parent.trueValue?g-f+1<this.parseDouble(a[1]):b-v+1<this.parseDouble(a[1])))return this.parent.getErrorStrings()[W.value];var C="";a[0].indexOf("!")===0&&(C=a[0],C=C.replace("!",""),C=C.indexOf("!"),C=a[0].substring(0,C+2)),a[0]=C+Ft(v)+f+":"+Ft(b)+g,h=this.parent.getCellCollection(a[0]);for(var x=0;x<h.length;x++)u.push(this.parent.getValueFromArg(h[x]));var w=[],M=[],E=[],T=[],D=[],N=b-v+1,A=function(Ne){Ne?Ne.toUpperCase()==="TRUE"||Ne.toUpperCase()==="FALSE"?(T.push(Ne),w.push(Ne)):isNaN(e.parseDouble(Ne))?(E.push(Ne),w.push(Ne)):(M.push(e.parseDouble(Ne)),w.push(e.parseDouble(Ne))):Ne===""&&(D.push(e.parseDouble(Ne).toString()),w.push(e.parseDouble(Ne).toString()))};if(a[3]==="TRUE")for(var x=0;x<N;x++)A(u[x+(this.parseDouble(a[1])-1)*N]);if(a[3]==="FALSE")for(var x=0;x<u.length;x++)A(u[x*N+this.parseDouble(a[1])-1]);for(var L=M.length>0?ce.sort(M,null,ce.fnSort(y)):[],k=E.length>0?ce.sort(E,null,ce.fnSort(y)):[],O=T.length>0?ce.sort(T,null,ce.fnSort(y)):[],R=y==="Ascending"?L.concat(k,O,D):O.concat(k,L,D),j=[],P=0;P<R.length;P++)for(var F=0;F<w.length;F++)JSON.stringify(R[P])===JSON.stringify(w[F])&&j.indexOf(F)===-1&&j.push(F);if(a[3]==="TRUE"){for(var z=f,q=0;z<=g;z++,q++)for(var P=0,X=0;P<j.length;P++,X++){var G=this.parent.getValueFromArg(C+Ft(j[P]+v)+z);if(r&&G!==""){l.push(G);continue}G=G===""?"0":G;var Z=this.parent.actCell;Z=Z.indexOf("!")>-1?Z.split("!")[1]:Z;var se=this.parent.rowIndex(Z),oe=this.parent.colIndex(Z);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,G,se+q,oe+X)}o=this.parent.getValueFromArg(C+Ft(j[0]+v)+f)}if(a[3]==="FALSE"){for(var P=0,q=0;P<j.length;P++,q++)for(var fe=v,X=0;fe<=b;fe++,X++){var be=this.parent.getValueFromArg(C+Ft(fe)+(j[P]+f));if(r&&be!==""){l.push(be);continue}be=be===""?"0":be;var Z=this.parent.actCell;Z=Z.indexOf("!")>-1?Z.split("!")[1]:Z;var oe=this.parent.colIndex(Z),se=this.parent.rowIndex(Z);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,be,se+q,oe+X)}o=this.parent.getValueFromArg(C+Ft(v)+(j[0]+f))}}}return r?l.join(","):o===""?"0":o},s.prototype.ComputeCOUNTIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(m(e)||e[0]===""||i.length!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.getErrorStrings()[W.name];var r,n=0,a,o=[],l="equal";if(i[1]==="")return 0;var h=i[1].startsWith(this.parent.tic)&&i[1].endsWith(this.parent.tic),u=i[1].split(this.parent.tic).join(""),c=u.includes("*"),d=u==="*"||u==="<>*",p=c&&!d?u.replace(/\*/g,"").trim():u,f=!1;if(!h&&this.parent.isCellReference(p)&&(p=this.parent.getValueFromArg(p),f=!0),c&&!d){var v=u.indexOf("*");u[0]==="*"&&(p="*"+p),u[u.length-1]==="*"&&(p+="*"),v>0&&v<u.length-1&&(p=u.substring(0,v)+"*"+u.substring(v+1))}if(u=p,u.startsWith("<=")?(l="lessEq",u=u.substring(2)):u.startsWith(">=")?(l="greaterEq",u=u.substring(2)):u.startsWith("<>")?(l="notEq",u=u.substring(2)):u.startsWith("<")?(l="less",u=u.substring(1)):u.startsWith(">")?(l="greater",u=u.substring(1)):u.startsWith("=")&&(l="equal",u=u.substring(1)),(!h&&this.parent.isCellReference(u)&&!f||u.includes(this.parent.arithMarker))&&(u=this.parent.getValueFromArg(u)),i[0].indexOf(":")>-1&&this.parent.isCellReference(i[0])){r=this.parent.getCellCollection(i[0].split(this.parent.tic).join(""));for(var g=0;g<r.length;g++)a=this.parent.getValueFromArg(r[g]),(u.indexOf("*")>-1||u.indexOf("?")>-1)&&(a=this.parent.findWildCardValue(u.toLowerCase(),a.toLowerCase())),o.push(a),o.push(u),this.parent.processLogical(o,l)===this.parent.trueValue&&n++}return n},s.prototype.ComputeSUMIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.calculateIFS(e);return i},s.prototype.calculateIFS=function(e,t){var i=this;if(m(e)||e[0]===""||e.length<2||e.length>127)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(e.length===3&&e[2].includes(this.parent.tic+this.parent.tic)){var r="",n,a=e[2].split(this.parent.tic+this.parent.tic);return a.forEach(function(o){o=o.trim().split(i.parent.tic).join(""),o&&(n=i.parent.computeIfsFormulas([e[0],e[1],o],i.parent.falseValue,t).toString(),r+=(r?",":"")+n)}),r}return this.parent.computeIfsFormulas(e,this.parent.falseValue,t)},s.prototype.ComputeTEXT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e.length,r=e[0],n=e[1];if(i!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var a=r,o=n;if(n==="")return this.parent.getValueFromArg(a);var l=new Date(1900,0,1,0,0,0),h=a+","+o,u=new _t;if(this.parent.getErrorStrings().indexOf(h)>-1)return h;if(a=this.parent.getValueFromArg(a),He(a.split(this.parent.tic).join(""))&&(a=a.split(this.parent.tic).join("")),n.startsWith('"')&&n.endsWith('"')?o=o.split(this.parent.tic).join(""):o=this.parent.getValueFromArg(o),o==="")return"";a===""&&(o.length>0&&(o.toUpperCase().indexOf("M")>-1||o.toUpperCase().indexOf("D")>-1||o.toUpperCase().indexOf("Y")>-1||o.toUpperCase().indexOf("S")>-1||o.toUpperCase().indexOf("T")>-1)||o.toUpperCase().indexOf("H")>-1)&&(a=l.toString());var c=this.parseDouble(a);if(isNaN(c)&&this.parent.isDate(new Date(a))!==null&&(c=this.parent.toOADate(new Date(a))),l=Date.parse(a.split(this.parent.tic).join("")),!isNaN(c)||!isNaN(l))if(o.length>0&&o.indexOf("#")===-1&&(o.toUpperCase().indexOf("M")>-1||o.toUpperCase().indexOf("D")>-1||o.toUpperCase().indexOf("Y")>-1||o.toUpperCase().indexOf("S")>-1||o.toUpperCase().indexOf("T")>-1)||o.toUpperCase().indexOf("H")>-1){o=o.split("Y").join("y").split("D").join("d").split("H").join("h"),o=o.split("S").join("s").split("m").join("M").split("AM/PM").join("tt");var d=o.split(""),p=!1,f=!1,v=0,g=0;for(v=0;v<d.length;){var b=d[v];b==="s"&&d[g]==="M"&&(d[g]="m",d[g-1]==="M"&&(d[g-1]="m")),this.parent.isChar(b)&&(g=v),b==="M"&&p&&(d[v]="m",f=!0),b==="h"?p=!0:this.parent.isChar(b)&&b!=="M"&&b!=="h"&&!f&&(p=!1,f=!1),v++}o=String(d),o=o.split(",").join("").split(`
`).join(" ");var y=this.parent.fromOADate(c);c===0&&(y=l);var C=a6(o);if(C===""){var x=Es(y),w=this.parent.parentObject.getDisplayText({format:o,value:x});return w}var M=u.getDateFormat({skeleton:C,type:"date"}),E=M(new Date(y.toString()));a=E}else a=this.parent.parentObject.getDisplayText({format:o,value:c});return a},s.prototype.ComputeCOUNTIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.parent.computeIfsFormulas(e,this.parent.trueValue);return i},s.prototype.ComputeAVERAGEIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.calculateIFS(e,this.parent.trueValue);return i},s.prototype.ComputeMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(m(i)||i.length===1&&i[0]===""||i.length<2||i.length>3)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r,n=[],a=i[0].split(this.parent.tic).join("");if(this.parent.isCellReference(a)&&(a=this.parent.getValueFromArg(a)),!a.toString().length)return this.parent.getErrorStrings()[W.na];i[2]=m(i[2])?"1":i[2].split(this.parent.tic).join(""),i[2].split(this.parent.tic).join("")===this.parent.trueValue&&(i[2]="1"),i[2].split(this.parent.tic).join("")===this.parent.falseValue&&(i[2]="0");var o=parseFloat(i[2]);if(o!==-1&&o!==0&&o!==1)return this.parent.getErrorStrings()[W.na];var l=0,h="";if(i[1].indexOf(":")>-1||this.parent.isCellReference(i[1])){r=this.parent.getCellCollection(i[1].split(this.parent.tic).join(""));for(var u=0;u<r.length;u++)n[u]=this.parent.getValueFromArg(r[u]).split(this.parent.tic).join("");for(var c=0;c<n.length;c++)if(n[c].toString().length){if(o===1){if(a===n[c])return c+1;a>n[c]&&(h?n[c]>h&&(l=c+1,h=n[c]):(l=c+1,h=n[c]))}else if(o===0){if((a.indexOf("*")>-1||a.indexOf("?")>-1)&&(n[c]=this.parent.findWildCardValue(a,n[c])),a===n[c]||this.parent.parseFloat(a)===this.parent.parseFloat(n[c]))return c+1}else if(o===-1){if(a===n[c])return c+1;a<n[c]&&(h?n[c]<h&&(l=c+1,h=n[c]):(l=c+1,h=n[c]))}}}return l||this.parent.getErrorStrings()[W.na]},s.prototype.ComputeLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(i)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:this.parent.computeLookup(i)},s.prototype.ComputeVLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(i)||i.length===1&&i[0]===""||i.length<3||i.length>4?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:this.parent.computeVHLookup(i,!0)},s.prototype.ComputeHLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return m(i)||i.length===1&&i[0]===""||i.length<3||i.length>4?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:this.parent.computeVHLookup(i)},s.prototype.ComputeSUBTOTAL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r="";if(i.length<2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var n=this.parent.parseFloat(this.parent.getValueFromArg(i[0].split(this.parent.tic).join(""))),a=i.slice(1,i.length);switch(n){case 1:case 101:r=this.ComputeAVERAGE.apply(this,a.concat(["isSubtotal"]));break;case 2:case 102:r=this.ComputeCOUNT.apply(this,a.concat(["isSubtotal"]));break;case 3:case 103:r=this.ComputeCOUNTA.apply(this,a.concat(["isSubtotal"]));break;case 4:case 104:r=this.ComputeMAX.apply(this,a.concat(["isSubtotal"]));break;case 5:case 105:r=this.ComputeMIN.apply(this,a.concat(["isSubtotal"]));break;case 6:case 106:r=this.ComputePRODUCT.apply(this,a.concat(["isSubtotal"]));break;case 7:case 107:r=this.ComputeDAY.apply(this,a);break;case 8:case 108:r=this.ComputeCONCAT.apply(this,a);break;case 9:case 109:r=this.ComputeSUM.apply(this,a.concat(["isSubtotal"]));break;case 10:case 110:r=this.ComputeAVERAGEA.apply(this,a);break;case 11:case 111:r=this.ComputeABS.apply(this,a);break;default:r=this.parent.getErrorStrings()[W.value];break}return r},s.prototype.ComputeRADIANS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r;if(i[0]===""||i.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i[0].indexOf(":")>-1||i[0].split(this.parent.tic).join("")==="")return this.parent.getErrorStrings()[W.value];var n=i[0].split(this.parent.tic).join("");i[0]=isNaN(this.parent.parseFloat(n))?i[0]:n;var a=this.parent.getValueFromArg(i[0]),o=this.parent.parseFloat(a);if(!isNaN(o))r=Math.PI*o/180;else return a.indexOf(this.parent.tic)>-1?this.parent.getErrorStrings()[W.value]:this.parent.getErrorStrings()[W.name];return r},s.prototype.ComputeRANDBETWEEN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e.length,r,n,a;if(i!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];for(var o=0;o<i;o++){if(e[o]==="")return this.parent.getErrorStrings()[W.na];if(e[o].indexOf(this.parent.tic)>-1){if(isNaN(parseFloat(e[o].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.value];e[o]=e[o].split(this.parent.tic).join("")}if(a=parseFloat(this.parent.getValueFromArg(e[o])),this.parent.isCellReference(e[o])){if(a=this.parent.getValueFromArg(e[o])===""?0:a,o===0?r=a:n=a,r===0&&n===0)return"0";if(isNaN(a))return this.parent.getErrorStrings()[W.value]}else{if(isNaN(a))return this.parent.getErrorStrings()[W.name];o===0?r=a:n=a}}return n<r?this.parent.getErrorStrings()[W.num]:r===0?Math.floor(Math.random()*(n-(r-1)))+r:n-r===1?Math.round(Math.random()*(n-r)+r):Math.floor(Math.random()*(n-(r-1)))+r},s.prototype.ComputeSLOPE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i.length!==2||i[0]==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r=this.parent.getCellCollection(i[1].split(this.parent.tic).join("")),n=this.parent.getCellCollection(i[0].split(this.parent.tic).join(""));if(n.length!==r.length)return this.parent.getErrorStrings()[W.na];var a=this.getDataCollection(n),o=this.getDataCollection(r);if(o.indexOf("#NAME?")>-1||a.indexOf("#NAME?")>-1)return this.parent.getErrorStrings()[W.name];for(var l=0,h=0,u=0,c=0,d=0,p=o.length;d<p;++d)Number(o[d]).toString()!=="NaN"&&Number(a[d]).toString()!=="NaN"&&(l+=Number(o[d])*Number(a[d]),u+=Number(o[d]),c+=Number(a[d]),h+=Number(o[d])*Number(o[d]));var f=((l-u*c/o.length)/(h-u*u/o.length)).toString();return f==="NaN"?this.parent.getErrorStrings()[W.divzero]:f},s.prototype.ComputeINTERCEPT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i[0]===""||i.length!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r=this.parent.getCellCollection(i[0].split(this.parent.tic).join("")),n=this.parent.getCellCollection(i[1].split(this.parent.tic).join(""));if(r.length!==n.length)return this.parent.getErrorStrings()[W.na];var a=this.getDataCollection(n),o=this.getDataCollection(r);if(a.indexOf("#NAME?")>-1||o.indexOf("#NAME?")>-1)return this.parent.getErrorStrings()[W.name];for(var l=0,h=0,u=0,c=a.length;u<c;++u)l+=Number(a[u]),h+=Number(o[u]);l=l/a.length,h=h/a.length;for(var d=0,p=0,f,u=0,c=a.length;u<c;++u)f=Number(a[u])-l,d+=f*(Number(o[u])-h),p+=f*f;var v=(h-d/p*l).toString();return v==="NaN"?this.parent.getErrorStrings()[W.divzero]:v},s.prototype.ComputeLN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r="",n,a;if(e.length===0||e.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0]),n=this.parent.parseFloat(r),n<=0||r==="")return this.parent.getErrorStrings()[W.num];if(isNaN(n))return this.parent.getErrorStrings()[W.value]}else{if(a=this.parent.getValueFromArg(i[0].split(this.parent.tic).join("")),n=this.parent.parseFloat(a),n<=0||n.toString()==="")return this.parent.getErrorStrings()[W.num];if(isNaN(n))return this.parent.getErrorStrings()[W.value]}return Math.log(n)},s.prototype.ComputeISNUMBER=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(e.length===0||e.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];var r=this.parent.isCellReference(i[0])?this.parent.getValueFromArg(i[0]):this.parent.getValueFromArg(i[0].split(this.parent.tic).join(""));if(r.toString()==="")return!1;var n=this.parent.parseFloat(r);return!isNaN(n)},s.prototype.ComputeROUND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n=0,a=0,o,l,h,u,c,d;return e.length===0||e.length>2?this.parent.formulaErrorStrings[Ce.wrong_number_arguments]:e.length===1?(r=i[0].split(this.parent.tic).join("")==="TRUE"?"1":i[0].split(this.parent.tic).join("")==="FALSE"?"0":i[0],isNaN(this.parent.parseFloat(r))?this.parent.formulaErrorStrings[Ce.invalid_arguments]:Math.round(this.parent.parseFloat(r)).toString()):(l=this.parent.getValueFromArg(i[0]),h=this.parent.getValueFromArg(i[1]),l=l==="TRUE"?"1":l==="FALSE"?"0":l,h=h==="TRUE"?"1":h==="FALSE"?"0":h,l=l.split(this.parent.tic).join(""),h=h.split(this.parent.tic).join(""),c=isNaN(Number(l))||l.trim()==="",d=isNaN(Number(h))||h.trim()==="",(i[0].indexOf('"')>-1||this.parent.isCellReference(i[0]))&&c||(i[1].indexOf('"')>-1||this.parent.isCellReference(i[1]))&&d?this.parent.getErrorStrings()[W.value]:l===""&&h===""||l===""?0:(n=this.parent.parseFloat(l),a=this.parent.parseFloat(h),!isNaN(a)&&!isNaN(n)&&a>0?o=this.parent.parseFloat(this.preciseRound(n,a)):(u=Math.pow(10,-a),o=Math.round(n/u)*u),o.toString()))},s.prototype.preciseRound=function(e,t){var i=e>=0?1:-1;return(Math.round(e*Math.pow(10,t)+i*.001)/Math.pow(10,t)).toFixed(t)},s.prototype.ComputePOWER=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n,a;if(e.length===0||e.length>2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];n=this.parent.getValueFromArg(i[0]),a=this.parent.getValueFromArg(i[1]),n=n.split(this.parent.tic).join("")==="TRUE"?"1":n.split(this.parent.tic).join("")==="FALSE"?"0":n,a=a.split(this.parent.tic).join("")==="TRUE"?"1":a.split(this.parent.tic).join("")==="FALSE"?"0":a;var o=this.parent.parseFloat(n),l=this.parent.parseFloat(a);if(!isNaN(o)&&!isNaN(l)){if(o===0&&l<0)return this.parent.getErrorStrings()[W.divzero];if(o===0&&l===0)return this.parent.getErrorStrings()[W.num];r=Math.pow(o,l)}else return this.parent.getErrorStrings()[W.value];return r.toString()},s.prototype.ComputeSQRT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=e[0];if(e.length===0||e.length>1||r==="")return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(r.split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.value];if(this.parent.isCellReference(r)){if(i=this.parent.getValueFromArg(r)||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.value]}else{if(r.indexOf(this.parent.tic)>-1&&(r.split(this.parent.tic).join("")===this.parent.trueValue||r.split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.value];i=this.parent.getValueFromArg(r).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.parseFloat(i)<0)return this.parent.getErrorStrings()[W.num];if(isNaN(this.parent.parseFloat(i))){var n={value:i};if(this.parent.parentObject.notify(yn,n),n.isDate||n.isTime)i=n.updatedVal;else return this.parent.getErrorStrings()[W.value]}return Math.sqrt(this.parent.parseFloat(i))},s.prototype.ComputeLOG=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n;if(e.length===0||e.length>2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(r=this.parent.getValueFromArg(i[0]),n=e.length===2?this.parent.getValueFromArg(i[1]):"10",r===""||r===null||n===""||n===null)return this.parent.getErrorStrings()[W.num];r=r.split(this.parent.tic).join("")==="TRUE"?"1":r.split(this.parent.tic).join("")==="FALSE"?"0":r,n=n.split(this.parent.tic).join("")==="TRUE"?"1":n.split(this.parent.tic).join("")==="FALSE"?"0":n;var a=this.parent.parseFloat(r),o=this.parent.parseFloat(n);return a<=0||o<=0?this.parent.getErrorStrings()[W.num]:o===1?this.parent.getErrorStrings()[W.divzero]:!isNaN(a)&&!isNaN(o)?(Math.log(a)/Math.LN10/(Math.log(o)/Math.LN10)).toString():this.parent.getErrorStrings()[W.value]},s.prototype.ComputeTRUNC=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r,n=0;if(e.length===0||e.length>2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];e.length===2&&(n=this.parent.getValueFromArg(i[1]),n=n.split(this.parent.tic).join("")==="TRUE"?"1":n.split(this.parent.tic).join("")==="FALSE"?"0":n,n=this.parent.parseFloat(n)),r=this.parent.getValueFromArg(i[0]),r=r.split(this.parent.tic).join("")==="TRUE"?"1":r.split(this.parent.tic).join("")==="FALSE"?"0":r;var a=this.parent.parseFloat(r.split(this.parent.tic).join(""));if(isNaN(a)||isNaN(n))return i[0]===this.parent.tic||this.parent.isCellReference(i[0])||i[1]===this.parent.tic||this.parent.isCellReference(i[1])?this.parent.getErrorStrings()[W.value]:this.parent.getErrorStrings()[W.name];var o=Math.pow(10,n),l=a<0?-1:1;return(l*Math.floor(o*Math.abs(a))/o).toString()},s.prototype.ComputeEXP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r;if(e.length===0||e.length>1)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];r=this.parent.getValueFromArg(i[0]),r=r.split(this.parent.tic).join("")==="TRUE"?"1":r.split(this.parent.tic).join("")==="FALSE"?"0":r,r===""&&(r="0");var n=this.parent.parseFloat(r);return n>709?this.parent.getErrorStrings()[W.num]:isNaN(n)?i[0]===this.parent.tic||this.parent.isCellReference(i[0])?this.parent.getErrorStrings()[W.value]:this.parent.getErrorStrings()[W.name]:Math.exp(n).toString()},s.prototype.ComputeGEOMEAN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r=1,n=0,a=0,o=0,l,h,u,c;if(e.length===0)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(i.length===1&&i[0]==="")return r.toString();for(h=0;h<i.length;h++)if(i[h].indexOf(":")>-1){if(i[0]===this.parent.tic)return this.parent.getErrorStrings()[W.value];for(c=this.parent.getCellCollection(i[h].split(this.parent.tic).join("")),u=0;u<c.length;u++){a=this.parent.getValueFromArg(c[u]),o=a.split(this.parent.tic).join("");var d=o===this.parent.trueValue||o===this.parent.falseValue;if(l=this.parent.parseFloat(a),l<=0)return this.parent.getErrorStrings()[W.num];d||this.parent.getErrorStrings().indexOf(a)>-1||isNaN(l)||(n++,r=r*l)}}else{a=this.parent.getValueFromArg(i[h]);var p=a.split(this.parent.tic).join(""),f=isNaN(this.parent.parseFloat(p));if(a.indexOf('"')>-1&&f)return this.parent.getErrorStrings()[W.value];i[h]=i[h].startsWith("n")?i[h].slice(1):i[h];var v=p==="TRUE"||p==="FALSE";if(a===""&&i[h]===""||this.parent.getErrorStrings().indexOf(a)>-1)return this.parent.getErrorStrings()[W.num];if(v&&this.parent.isCellReference(i[h]))continue;if(a.length>0){if(a=a.indexOf('"')>-1?p:a,a=a.split(this.parent.tic).join("")==="TRUE"?"1":a.split(this.parent.tic).join("")==="FALSE"?"0":a,!this.parent.isCellReference(i[h])&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.value];if(l=this.parent.parseFloat(a),l<=0)return this.parent.getErrorStrings()[W.num];isNaN(l)||(n++,r=r*l)}}return n>0&&(r=Math.pow(r,1/n)),r.toString()},s.prototype.ComputeRSQ=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=0,n=e;if(n.length!==2)return this.parent.formulaErrorStrings[Ce.wrong_number_arguments];if(n[0]===""||n[1]==="")return this.parent.getErrorStrings()[W.value];if(n[0].includes('"')||n[1].includes('"'))return this.parent.getErrorStrings()[W.na];if(n[0].indexOf(":")===-1&&ur(n[0])&&n[1].indexOf(":")===-1&&ur(n[1]))return this.parent.getErrorStrings()[W.divzero];var a=this.parent.getCellCollection(n[0]),o=this.parent.getCellCollection(n[1]);if(a.length!==o.length)return this.parent.getErrorStrings()[W.na];for(var l=this.getDataCollection(o),h=this.getDataCollection(a),u=0;u<l.length;u++){var c=Number(l[u]),d=Number(h[u]);He(c)&&He(d)&&r++}if(r<=1)return this.parent.getErrorStrings()[W.divzero];if(r==2)return 1;var p=this.getMeanArray(l,h),f=p[0],v=p[1],g=this.getCorrelation(l,h,f,v);return i=Math.pow(g,2),i},s.prototype.getCorrelation=function(e,t,i,r){for(var n=0,a=0,o=0,l=0;l<e.length;l++)if(He(e[l])&&He(t[l])){var h=Number(e[l])-i,u=Number(t[l])-r;n+=h*u,a+=Math.pow(h,2),o+=Math.pow(u,2)}var c=n/Math.sqrt(a*o);return c},s.prototype.getMeanArray=function(e,t){for(var i=0,r=0,n=0,a=0,o=0,l=0;l<e.length;l++)He(e[l])&&He(t[l])&&(r+=Number(e[l]),n+=Number(t[l]),i++);return a=r/i,o=n/i,[a,o]},s.prototype.getDataCollection=function(e){for(var t=[],i=0,r=e.length;i<r;i++)t.push(this.parent.getValueFromArg(e[i]));return t},s.prototype.parseDouble=function(e){var t=this.parent.parseFloat(e.toString());return isNaN(t)?NaN:t},s.prototype.spreadsheetDisplayText=function(e){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(e)){var t=this.parent.parentObject.getIndexes(e);e=this.parent.parentObject.getDisplayText(this.parent.parentObject.getActiveSheet().rows[t.startIdx].cells[t.endIdx])}return e},s.prototype.spreadsheetFormat=function(e){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(e)){var t=this.parent.parentObject.getIndexes(e);e=this.parent.parentObject.getActiveSheet().rows[t.startIdx].cells[t.endIdx].format}return e},s.prototype.getModuleName=function(){return"basic-formulas"},s}(),d6=function(){function s(e){this.emptyStr="",this.storedStringText=this.emptyStr,this.sheetToken="!",this.tokenAdd="a",this.tokenSubtract="s",this.tokenMultiply="m",this.tokenDivide="d",this.tokenLess="l",this.charEm="r",this.charEp="x",this.tokenGreater="g",this.tokenEqual="e",this.tokenLessEq="k",this.tokenGreaterEq="j",this.tokenNotEqual="o",this.tokenAnd="c",this.tokenEm="v",this.tokenEp="t",this.tokenOr="~",this.charAnd="i",this.charLess="<",this.charGreater=">",this.charEqual="=",this.charLessEq="f",this.charGreaterEq="h",this.charNoEqual="z",this.stringGreaterEq=">=",this.stringLessEq="<=",this.stringNoEqual="<>",this.stringAnd="&",this.stringOr="^",this.charOr="w",this.charAdd="+",this.charSubtract="-",this.charMultiply="*",this.charDivide="/",this.fixedReference="$",this.spaceString=" ",this.ignoreBracet=!1,this.isError=!1,this.isFormulaParsed=!1,this.findNamedRange=!1,this.stringsColl=new Map,this.tokens=[this.tokenAdd,this.tokenSubtract,this.tokenMultiply,this.tokenDivide,this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual,this.tokenAnd,this.tokenOr],this.charNOTop="§",this.specialSym=["~","@","#","?"],this.isFailureTriggered=!1,this.parent=e}return s.prototype.parse=function(e,t){var i=this;if(this.parent.isTextEmpty(e))return e;if(o6(e))return this.parent.getErrorStrings()[W.ref];this.parent.getFormulaCharacter()!=="\0"&&this.parent.getFormulaCharacter()===e[0]&&(e=e.substring(1)),(this.parent.namedRanges.size>0||this.parent.storedData.size>0)&&(e=this.checkForNamedRangeAndKeyValue(e),this.findNamedRange=!1),e=e.replace(/[-+*\/\&\^]+/g,function(p){for(var f="";1<p.length;)switch(p.substring(0,2)){case"++":p="+"+p.substring(2);break;case"--":p="+"+p.substring(2);break;case"+-":p="-"+p.substring(2);break;case"-+":p="-"+p.substring(2);break;case"*+":p="*"+p.substring(2);break;case"/+":p="/"+p.substring(2);break;case"^+":p="^"+p.substring(2);break;case"&+":p="&"+p.substring(2);break;case"*-":case"/-":case"^-":case"&-":f=p.substring(0,1),p=p.substring(1);break;default:throw new rs(i.parent.formulaErrorStrings[Ce.invalid_expression],!0)}return f+p}),e=e.split("-(-").join("(");var r=this.storeStrings(e);e=this.storedStringText;var n=0;if(m(r)&&(e=e.split(" ").join("")),e=e.split("=>").join(">="),e=e.split("=<").join("<="),(e[e.length-1]!==this.parent.arithMarker||this.indexOfAny(e,this.tokens)!==e.length-2)&&(e=e.toUpperCase()),e.indexOf(this.sheetToken)>-1){var a=this.parent.getSheetFamilyItem(this.parent.grid);if(a.sheetNameToParentObject!=null&&a.sheetNameToParentObject.size>0){e[0]!==this.sheetToken.toString()&&(e=this.parent.setTokensForSheets(e));var o=this.parent.getSheetToken(e.split(this.parent.tic).join(this.emptyStr)),l=this.checkScopedRange(e.split('"').join(this.emptyStr).split(this.sheetToken).join(""));m(o)&&o!==""&&this.parent.namedRanges.size>0&&l!==""&&(e=l)}}e=this.markLibraryFormulas(e);try{e=this.formulaAutoCorrection(e)}catch(p){var h={message:p.message,exception:p,isForceCalculable:p.formulaCorrection,computeForceCalculate:!1};if(!h.isForceCalculable)throw this.parent.formulaErrorStrings[Ce.invalid_expression];if(this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0),h.isForceCalculable&&h.computeForceCalculate)e=this.formulaAutoCorrection(e,h),this.parent.storedData.get(t).formulaText="="+e;else throw this.parent.formulaErrorStrings[Ce.invalid_expression]}if(!this.ignoreBracet)for(n=e.indexOf(")");n>-1;){var u=e.substring(0,n).lastIndexOf("(");if(u===-1)throw new rs(this.parent.formulaErrorStrings[Ce.mismatched_parentheses]);if(u===n-1)throw new rs(this.parent.formulaErrorStrings[Ce.empty_expression]);var c=this.emptyStr;this.ignoreBracet?c=this.parent.substring(e,u,n-u+1):c=this.parent.substring(e,u+1,n-u-1);try{e=e.substring(0,u)+this.parseSimple(c)+e.substring(n+1)}catch(p){var h=this.exceptionArgs(p);this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0);var d=typeof h.exception=="string"?h.exception:h.message;return(this.parent.getErrorLine(p)?"":"#"+this.parent.getErrorLine(p)+": ")+d}n=e.indexOf(")")}if(!this.ignoreBracet&&e.indexOf("(")>-1)throw new rs(this.parent.formulaErrorStrings[Ce.mismatched_parentheses]);return e=this.parseSimple(e),r!==null&&r.size>0&&(e=this.setStrings(e,r)),e},s.prototype.exceptionArgs=function(e){return{message:e.message,exception:e,isForceCalculable:e.formulaCorrection,computeForceCalculate:!1}},s.prototype.formulaAutoCorrection=function(e,t){var i=["*","+","-","/","^","&"],r=[">","=","<"],n=0,a="",o="",l="",h="",u="",c="",d="",p=0;if(this.parent.formulaErrorStrings.indexOf(e)>-1)return e;if(this.indexOfAny(e,this.specialSym)>-1)throw new rs(this.parent.formulaErrorStrings[Ce.invalid_expression],!1);for(;n<e.length;)if(e=e.split("-*").join("-").split("/*").join("/").split("*/").join("*").split("-/").join("-").split("*+").join("*").split("+*").join("+"),this.parent.isDigit(e[n])&&e.length>n+1&&this.indexOfAny(e[n+1],i)>-1&&e.length>n+2&&!m(e[n+2])&&this.indexOfAny(e[n+2],i)>-1&&(e[n+2]!=="-"||e[n+1]!=="*"&&e[n+1]!=="/"&&e[n+1]!=="^"&&e[n+1]!=="&"))if(t&&t.computeForceCalculate)this.parent.isDigit(e[n])?(p<1?(c=e[n],l=e[n+1],m(l)&&(l=this.emptyStr),l=l==="&"?"":l,p=p+1,a=a+c+l):p<2&&(d=e[n],h=e[n-1],u=e[n+1],p=0,h==="-"?(u=m(u)?this.emptyStr:u,u=u==="&"?"":u,a=a+h+d+u):(u=m(u)?this.emptyStr:u,a=a+d+u)),n=n+2):(a=e[n]==="-"?a+e[n]:a,n=n+1);else throw this.parent.formulaErrorStrings[Ce.improper_formula];else if((this.parent.isDigit(e[n])||e[n]===this.parent.rightBracket||this.parent.storedData.has(e[n].toUpperCase()))&&(m(e[n+1])||this.indexOfAny(e[n+1],i))>-1)o=m(e[n+1])?this.emptyStr:e[n+1],o=o==="&"&&e[n+2]!=="-"?"":o,a=e[n-1]==="-"?a+e[n-1]+e[n]+o:a+e[n]+o,n=n+2;else if(this.indexOfAny(e[n],r)>-1&&!m(e[n-1])&&!m(e[n+1]))a=a+e[n],n=n+1;else if(e[n]==="q")for(;e[n]!==this.parent.leftBracket;)a=a+e[n],n=n+1;else e[n]===this.parent.leftBracket||e[n]===this.parent.rightBracket||e[n]==="{"||e[n]==="}"||e[n]==="("||e[n]===")"||this.parent.isUpperChar(e[n])||e[n].indexOf(":")>-1||e[n]===this.parent.getParseArgumentSeparator()||e[n]==="%"&&this.parent.isDigit(e[n-1])||e[n]===this.parent.tic||e[n]===" "||e[n]==="."||e[n]===this.sheetToken||e[n]==="$"||e[n]==="_"?(a=a+e[n],n=n+1):(this.parent.isDigit(e[n])&&(a=e[n-1]==="-"?a+e[n-1]+e[n]:a+e[n]),(e[n]==="-"||e[n]==="+")&&(a=a+e[n],a=a.split("++").join("+").split("+-").join("-").split("-+").join("-")),(e[n]==="/"||e[n]==="*"||e[n]==="^")&&(a=a+e[n]),n=n+1);return a=a===this.emptyStr?e:a,this.indexOfAny(a[a.length-1],i)>-1&&(a=a.substring(0,a.length-1)),a=a.split("--").join("-").split("-+").join("-").split("+-").join("-"),a},s.prototype.checkScopedRange=function(e){var t=this,i=this.emptyStr,r="NaN",n=this.parent.getSheetID(this.parent.grid),a=this.parent.getSheetFamilyItem(this.parent.grid);if(e[0]===this.sheetToken.toString()){var o=e.indexOf(this.sheetToken,1),l=parseInt(e.substr(1,o-1),10);o>1&&!this.parent.isNaN(l)&&(e=e.substring(o+1),n=l)}var h="!"+n.toString();return a===null||a.sheetNameToToken==null||a.sheetNameToToken.forEach(function(u,c){if(a.sheetNameToToken.get(c).toString()===h+"!"){var d=t.emptyStr;t.parent.namedRanges.forEach(function(p,f){m(t.parent.parentObject)?d=a.sheetNameToToken.get(f).toUpperCase():d=(t.parent.parentObject.getActiveSheet().name+t.sheetToken+e).toUpperCase(),t.parent.getNamedRanges().has(d)&&(i=t.parent.getNamedRanges().get(d).toUpperCase(),r=i)})}}),r},s.prototype.storeStrings=function(e){var t=0,i=0,r=0,n="",a=null,o,l=e.indexOf(this.parent.tic);if(l>-1)for(t=e.indexOf(this.parent.tic);t>-1&&e.length>0;){if(a===null&&(a=this.stringsColl),i=t+1<e.length?e.indexOf(this.parent.tic,t+1):-1,i===-1)throw new rs(this.parent.formulaErrorStrings[Ce.mismatched_tics]);o=this.parent.substring(e,t,i-t+1),n=this.parent.tic+this.spaceString+r.toString()+this.parent.tic,a=a.set(n,o),e=e.substring(0,t)+n+e.substring(i+1),t=t+n.length,t<=e.length&&(t=e.indexOf(this.parent.tic,t)),r++}return this.storedStringText=e,a},s.prototype.setStrings=function(e,t){for(var i=0;i<t.size;i++)t.forEach(function(r,n){e=e.split(n).join(r)});return e},s.prototype.parseSimple=function(e){var t=!0,i=e;if(i.length>0&&i[0]==="+"&&(i=i.substring(1)),i==="#DIV/0!")return"#DIV/0!";if(i==="#NAME?")return"#NAME?";if(i===""||this.parent.formulaErrorStrings.indexOf(i)>-1)return i;i=i.split(this.stringLessEq).join(this.charLessEq),i=i.split(this.stringGreaterEq).join(this.charGreaterEq),i=i.split(this.stringNoEqual).join(this.charNoEqual),i=i.split(this.stringAnd).join(this.charAnd),i=i.split(this.stringOr).join(this.charOr),i=i.split(this.fixedReference).join(this.emptyStr),t=!0;var r=[this.tokenEp,this.tokenEm],n=[this.tokenMultiply,this.tokenDivide],a=[this.tokenAdd,this.tokenSubtract],o=[this.charMultiply,this.charDivide],l=[this.charAdd,this.charSubtract],h=[this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual],u=[this.charLess,this.charGreater,this.charEqual,this.charLessEq,this.charGreaterEq,this.charNoEqual],c=[this.charEp,this.charEm],d=[this.tokenAnd],p=[this.charAnd],f=[this.charOr],v=[this.tokenOr];return i=this.parseSimpleOperators(i,r,c),i=this.parseSimpleOperators(i,v,f),t&&(i=this.parseSimpleOperators(i,n,o)),t&&(i=this.parseSimpleOperators(i,a,l)),t&&(i=this.parseSimpleOperators(i,h,u)),t&&(i=this.parseSimpleOperators(i,d,p)),i},s.prototype.parseSimpleOperators=function(e,t,i){if(this.parent.getErrorStrings().indexOf(e)>-1)return e;for(var r=e,n=0,a="",o=0;o<i.length;o++)a=a+i[o];r=r.split("---").join("-").split("--").join("+").split(this.parent.getParseArgumentSeparator()+"-").join(this.parent.getParseArgumentSeparator()+"u").split(this.parent.leftBracket+"-").join(this.parent.leftBracket+"u").split("=-").join("=u"),r=r.split(",+").join(",").split(this.parent.leftBracket+"+").join(this.parent.leftBracket).split("=+").join("=").split(">+").join(">").split("<+").join("<").split("/+").join("/").split("*+").join("*").split("++").join("+").split("*-").join("*u").split("/-").join("/u").split("w-").join("wu").split("i-").join("iu").toString(),r.length>0&&r[0]==="-"?(r=r.substring(1).split("-").join(this.tokenOr),r="0-"+r,r=this.parseSimpleOperators(r,[this.tokenSubtract],[this.charSubtract]),r=r.split(this.tokenOr).join("-")):r.length>0&&r[0]==="+"?r=r.substring(1):r.length>0&&r[r.length-1]==="+"&&(r=r.substring(0,r.length-1));try{if(this.indexOfAny(r,i)>-1){if(r.includes(" ")){for(var l="",h=0;h<r.length;h++){var u=r[h];if(i.indexOf(u)>=0)l=l.trim()+u;else{if(u===" "&&i.indexOf(l[l.length-1])>=0)continue;l+=u}}r=l}for(n=this.indexOfAny(r,i);n>-1;){var c="",d="",p=0,f=0,v=!1,g=["*","+","-","/","w","=","<",">"],b=r[n]===this.charNOTop,y=0;if(b)p=n;else if(y=n-1,r[y]===this.parent.arithMarker){var C=this.findLeftMarker(r.substring(0,y-1));if(C<0)throw new rs(this.parent.formulaErrorStrings[Ce.cannot_parse]);c=this.parent.substring(r,C+1,y-C-1),p=C+1}else if(r[y]===this.parent.rightBracket){for(var x=0,C=y-1;C>0&&(r[C]!=="q"||x!==0);)r[C]==="q"?x--:r[C]===this.parent.rightBracket&&x++,C--;if(C<0)throw new rs(this.parent.formulaErrorStrings[Ce.cannot_parse]);c=this.parent.substring(r,C,y-C+1),p=C}else if(r[y]===this.parent.tic[0]){var w=r.substring(0,y-1).lastIndexOf(this.parent.tic);if(w<0)throw new rs(this.parent.formulaErrorStrings[Ce.cannot_parse]);c=this.parent.substring(r,w,y-w+1),p=w}else{for(var M=!1;y>-1&&(this.parent.isDigit(r[y])||!M&&(r[y]===this.parent.getParseDecimalSeparator()||r[y]==="%"));)!this.parent.isDigit(r[y])&&r[y]!=="%"&&(M=!0),y=y-1;if(y>-1&&M&&r[y]===this.parent.getParseDecimalSeparator())throw new rs(this.parent.formulaErrorStrings[Ce.number_contains_2_decimal_points]);if(y=y+1,y===0||y>0&&!this.parent.isUpperChar(r[y-1]))c="n"+this.parent.substring(r,y,n-y),p=y;else if(y>0&&r[y-1]==="E"&&(r.substring(y-4,y)==="TRUE"&&(m(r[y-5])||g.indexOf(r[y-5])>-1)||r.substring(y-5,y)==="FALSE"&&(m(r[y-6])||g.indexOf(r[y-6])>-1))&&(r.substring(y+1,y+5)==="TRUE"||r.substring(y+1,y+6)==="FALSE"))y=r.substring(y-4,y)==="TRUE"?y-4:y-5,c=r.substring(y,n)==="TRUE"?"n1":r.substring(y,n)==="FALSE"?"n0":c,p=y,v=!0;else{for(y=y-1;y>-1&&(this.parent.isUpperChar(r[y])||this.parent.isDigit(r[y]));)y=y-1;if(y>-1&&r[y]===this.sheetToken){for(y=y-1;y>-1&&r[y]!==this.sheetToken;)y=y-1;y>-1&&r[y]===this.sheetToken&&(y=y-1)}if(y>-1&&r[y]===":"){for(y=y-1;y>-1&&this.parent.isDigit(r[y]);)y=y-1;for(;y>-1&&this.parent.isUpperChar(r[y]);)y=y-1;if(y>-1&&r[y]===this.sheetToken){for(y--;y>-1&&r[y]!==this.sheetToken;)y--;y>-1&&r[y]===this.sheetToken&&y--}y=y+1,c=this.parent.substring(r,y,n-y),c=this.parent.getCellFrom(c)}else{var E=!1;y>0&&!this.parent.isUpperChar(r[y])&&(E=r[y]==="u"&&r[y-1]===this.parent.getParseArgumentSeparator()),E||(y=y+1),c=this.parent.substring(r,y,n-y)}this.parent.updateDependentCell(c),p=y}(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(c.toUpperCase())||this.parent.storedData.has(c.toUpperCase()))&&(c="n"+this.checkForNamedRangeAndKeyValue(c))}if(n===r.length-1)throw new rs(this.parent.formulaErrorStrings[Ce.expression_cannot_end_with_an_operator]);y=n+1;var E=r[y]==="u";if(E&&(y=y+1),r[y]===this.parent.tic[0]){var C=r.substring(y+1).indexOf(this.parent.tic);if(C<0)throw this.parent.formulaErrorStrings[Ce.cannot_parse];d=this.parent.substring(r,y,C+2),f=C+y+2}else if(r[y]===this.parent.arithMarker){var C=this.findRightMarker(r.substring(y+1));if(C<0)throw new rs(this.parent.formulaErrorStrings[Ce.cannot_parse]);d=this.parent.substring(r,y+1,C),f=C+y+2}else if(r[y]==="q"){for(var x=0,C=y+1;C<r.length&&(r[C]!==this.parent.rightBracket||x!==0);)r[C]===this.parent.rightBracket?x++:r[C]==="q"&&x--,C++;if(C===r.length)throw this.parent.formulaErrorStrings[Ce.cannot_parse];d=this.parent.substring(r,y,C-y+1),E&&(d="u"+d),f=C+1}else if(this.parent.isDigit(r[y])||r[y]===this.parent.getParseDecimalSeparator()){var M=r[y]===this.parent.getParseDecimalSeparator();for(y=y+1;y<r.length&&(this.parent.isDigit(r[y])||!M&&r[y]===this.parent.getParseDecimalSeparator());)r[y]===this.parent.getParseDecimalSeparator()&&(M=!0),y=y+1;if(y<r.length&&r[y]==="%"&&(y+=1),M&&y<r.length&&r[y]===this.parent.getParseDecimalSeparator())throw this.parent.formulaErrorStrings[Ce.number_contains_2_decimal_points];d="n"+this.parent.substring(r,n+1,y-n-1),f=y}else if(this.parent.isUpperChar(r[y])||r[y]===this.sheetToken||r[y]==="u"){if(r[y]===this.sheetToken)for(y=y+1;y<r.length&&r[y]!==this.sheetToken;)y=y+1;y=y+1;for(var T=0,D=!1;y<r.length&&(this.parent.isUpperChar(r[y])||r[y]==="_"||r[y]==="."||r[y]==="["||r[y]==="]"||r[y]==="#"||r[y]===" "||r[y]==="%"||r[y]===this.parent.getParseDecimalSeparator()&&D);)y!==r.length-1&&r[y]==="["&&r[y+1]==="["&&(D=!0),y!==r.length-1&&r[y]==="]"&&r[y+1]==="]"&&(D=!1),y++,T++;var N=y===r.length||!this.parent.isDigit(r[y]);if(T>1){for(;y<r.length&&(this.parent.isUpperChar(r[y])||this.parent.isDigit(r[y])||r[y]===" "||r[y]==="_");)y++;N=!0}for(;y<r.length&&this.parent.isDigit(r[y]);)y=y+1;if(y<r.length&&r[y]===":"){if(y=y+1,y<r.length&&r[y]===this.sheetToken){for(y++;y<r.length&&r[y]!==this.sheetToken;)y=y+1;y<r.length&&r[y]===this.sheetToken&&y++}for(;y<r.length&&this.parent.isUpperChar(r[y]);)y=y+1;for(;y<r.length&&this.parent.isDigit(r[y]);)y=y+1;y=y-1,d=this.parent.substring(r,n+1,y-n),d=this.parent.getCellFrom(d)}else y=y-1,d=this.parent.substring(r,n+1,y-n),E=r[y]==="u",E&&(d="u"+d);N&&d.startsWith(this.sheetToken)&&(N=!this.parent.isCellReference(d)),N||this.parent.updateDependentCell(d),(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(d.toUpperCase())||this.parent.storedData.has(d.toUpperCase()))&&(d="n"+this.checkForNamedRangeAndKeyValue(d));var A=["*","+","-","/","w"].indexOf(r[y-d.length])>-1;d=d==="TRUE"&&(v||A)?"n1":d==="FALSE"&&(v||A)?"n0":d,f=y+1}var L=a.indexOf(r[n]),k=this.parent.arithMarker+c+d+t[L]+this.parent.arithMarker;p>0&&(k=r.substring(0,p)+k),f<r.length&&(k=k+r.substring(f)),k=k.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString()),r=k,n=this.indexOfAny(r,i)}}else if(r.length>0&&(this.parent.isUpperChar(r[0])||r[0]===this.sheetToken)){for(var O=!0,R=!0,j=!1,P=r.length,C=0;C<P;++C)if(r[C]===this.sheetToken){if(C>0&&!j)throw this.parent.getErrorStrings()[W.ref];for(j=!0,C++;C<P&&this.parent.isDigit(r[C]);)C++;if(C===P||r[C]!==this.sheetToken){O=!1;break}}else{if(!R&&this.parent.isChar(r[C])){O=!1;break}if(this.parent.isChar(r[C])||this.parent.isDigit(r[C])||r[C]===this.sheetToken)R=this.parent.isUpperChar(r[C]);else{O=!1;break}}O&&this.parent.updateDependentCell(r)}return r}catch(F){return F}},s.prototype.indexOfAny=function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return i;return-1},s.prototype.findLeftMarker=function(e){var t=-1;if(e.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=e.length-1;r>=0;--r)if(e[r]===this.parent.rightBracket)i--;else if(e[r]===this.parent.leftBracket)i++;else if(e[r]===this.parent.arithMarker&&i===0){t=r;break}}return t},s.prototype.findRightMarker=function(e){var t=-1;if(e.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=0;r<e.length;++r)if(e[r]===this.parent.rightBracket)i--;else if(e[r]===this.parent.leftBracket)i++;else if(e[r]===this.parent.arithMarker&&i===0){t=r;break}}return t},s.prototype.parseFormula=function(e,t){if(e.length>0&&e[0]===this.parent.getFormulaCharacter()&&(e=e.substring(1)),e.indexOf("#REF!")>-1)return this.parent.getErrorStrings()[W.ref];e.length>0&&e[0]==="+"&&(e=e.substring(1));try{this.isFailureTriggered=!1,this.isError=!1,e=this.parse(e.trim(),t),this.isFormulaParsed=!0}catch(n){var i=this.exceptionArgs(n);this.isFailureTriggered||(this.parent.trigger("onFailure",i),this.isFailureTriggered=!0);var r=typeof i.exception=="string"?i.exception:i.message;e=(m(this.parent.getErrorLine(n))?"":"#"+this.parent.getErrorLine(n)+": ")+r,this.isError=!0}return e},s.prototype.markLibraryFormulas=function(e){var t=0,i=e.indexOf(")");if(i===-1)e=this.markNamedRanges(e);else for(;i>-1;){for(var r=0,n=i-1;n>-1&&(e[n]!=="("||r!==0);)e[n]===")"&&r++,n--;if(n===-1)throw new rs(this.parent.formulaErrorStrings[Ce.mismatched_parentheses]);for(var a=n-1;a>-1&&this.parent.isChar(e[a]);)a--;var o=n-a-1,l=this.parent.substring(e,a+1,o);if(o>0&&!m(this.parent.getFunction(l))){var h=this.parent.substring(e,n,i-n+1),u=this.parent.getParseArgumentSeparator();if(l==="AREAS")this.ignoreBracet=!0;else if(this.ignoreBracet=!1,l.includes("IFS")&&l!=="COUNTIFS"&&h.includes("{")){var c=h.indexOf("{"),d=this.parent.substring(h,c,h.indexOf("}")-c+1);h=h.split(d).join(d.split(u).join(this.parent.tic+this.parent.tic))}try{var p=void 0;h=h.split("(").join("").split(")").join(""),h="("+this.formulaAutoCorrection(h,p)+")"}catch(g){var p={message:g.message,exception:g,isForceCalculable:g.formulaCorrection,computeForceCalculate:!1};if(!p.isForceCalculable)throw this.parent.formulaErrorStrings[Ce.improper_formula];if(this.isFailureTriggered||(this.parent.trigger("onFailure",p),this.isFailureTriggered=!0,t=t+1),p.computeForceCalculate=t>0?!0:p.computeForceCalculate,p.isForceCalculable)if(p.computeForceCalculate)h=h.split("(").join("").split(")").join(""),h="("+this.formulaAutoCorrection(h,p)+")";else throw this.parent.formulaErrorStrings[Ce.improper_formula];else throw this.parent.formulaErrorStrings[Ce.improper_formula]}h=this.markNamedRanges(h),h=this.swapInnerParens(h),h=this.addParensToArgs(h);var f=h.lastIndexOf(u);f===-1&&h.length>2&&h[0]==="("&&h[h.length-1]===")"&&h[1]!=="{"&&h[1]!=="("&&(h=h.substring(0,h.length-1)+"}"+h.substring(h.length-1),h=h[0]+"{"+h.substring(1)),e=e.substring(0,a+1)+"q"+this.parent.substring(e,a+1,o)+h.split("(").join(this.parent.leftBracket).split(")").join(this.parent.rightBracket)+e.substring(i+1)}else{if(o>0)return this.parent.getErrorStrings()[W.name];var v=this.emptyStr;n>0&&(v=e.substring(0,n)),v=v+"{"+this.parent.substring(e,n+1,i-n-1)+"}",i<e.length&&(v=v+e.substring(i+1)),v=this.markNamedRanges(v),e=v}i=e.indexOf(")")}return e=e.split("{").join("(").split("}").join(")"),e},s.prototype.swapInnerParens=function(e){return e.length>2&&(e=e[0]+e.substr(1,e.length-2).split("(").join("{").split(")").join("}")+e[e.length-1]),e},s.prototype.addParensToArgs=function(e){if(e.length===0)return this.emptyStr;var t=[];t.push(this.parent.getParseArgumentSeparator()),t.push(this.parent.rightBracket);var i=e.lastIndexOf(this.parent.getParseArgumentSeparator()),r=0;if(i===-1){if(e.length>2&&e[0]==="("&&e[e.length-1]===")")if(e[1]!=="{"&&e[1]!=="(")e=e.substring(0,e.length-1)+"}"+e.substring(e.length-1),e=e[0]+"{"+e.substring(1);else{var n=["+","-","*","/"];i=this.lastIndexOfAny(e,n),r===0&&e[e.length-1]===")"&&(r=e.length-1),r>0&&e[i+1]!=="{"&&e[i-1]==="}"&&(e=e.substr(0,r)+"}"+e.substr(r),e=e.substr(0,i+1)+"{"+e.substr(i+1))}}else for(var a=!0;i>-1;){var o=this.indexOfAny(e.substring(i+1,e.length),t);o>=0?o=i+o+1:o===-1&&e[e.length-1]===")"&&(o=e.length-1),o>0&&e[i+1]!=="{"&&e[o-1]!=="}"&&e[o-1]!=="¢"&&(e=e.substr(0,o).trim()+"}"+e.substr(o),e=e.substr(0,i+1)+"{"+e.substr(i+1).trim()),i=e.substr(0,i).lastIndexOf(this.parent.getParseArgumentSeparator()),a&&i===-1&&e[0]==="("&&(i=0,a=!1)}return e=e.split("{}").join(this.emptyStr),e},s.prototype.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>-1;i--)if(t.indexOf(e[i])>-1)return i;return-1},s.prototype.markNamedRanges=function(e){var t=[")",this.parent.getParseArgumentSeparator(),"}","+","-","*","/","<",">","=","&",":"],i=e.length>0&&(e[0]==="("||e[0]==="{")?1:0;e.indexOf("#N/A")>-1&&(e=e.split("#N/A").join("#N~A")),e.indexOf("#DIV/0!")>-1&&(e=e.split("#DIV/0!").join("#DIV~0!"));for(var r=this.indexOfAny(e.substring(i),t);r>-1&&r+i<e.length;){var n=this.emptyStr,a=null;if(this.parent.substring(e,i,r).indexOf("[")>-1?a=this.getTableRange(this.parent.substring(e,i,r)):this.parent.storedData.has(this.parent.substring(e,i,r))?a=this.checkForNamedRangeAndKeyValue(this.parent.substring(e,i,r)):this.parent.namedRanges.has(this.parent.substring(e,i,r))&&(a=this.checkForNamedRangeAndKeyValue(this.parent.substring(e,i,r))),m(a)&&(n=this.checkScopedRange(this.parent.substring(e,i,r)),n!=="NaN"?(this.findNamedRange=!0,a=n):this.parent.substring(e,i,r).startsWith(this.sheetToken.toString()),!m(a)&&this.findNamedRange&&a.indexOf(this.fixedReference)>-1&&(a=a.split(this.fixedReference).join(this.emptyStr))),m(a)||(a=a.toUpperCase(),a=this.parent.setTokensForSheets(a),a=this.markLibraryFormulas(a)),!m(a)&&a!==this.emptyStr)e=e.substring(0,i)+a+e.substring(i+r),i+=a.length+1;else for(i+=r+1;i<e.length&&!this.parent.isUpperChar(e[i])&&e[i]!==this.sheetToken;)i++;for(r=i,i<e.length-1&&e[i]==="{"&&(i=i+1),r=this.indexOfAny(e.substring(i),t);r===0&&i<e.length-1;)i++,r=this.indexOfAny(e.substring(i),t);if((r===-1||e.substring(i).indexOf("[")>-1)&&i<e.length){if(e.substring(i).indexOf("[")>-1?a=this.getTableRange(e.substring(i)):this.parent.storedData.has(e.substring(i))?a=this.parent.storedData.size>0?this.checkForNamedRangeAndKeyValue(e.substring(i)):a:a=this.parent.namedRanges.size>0?this.checkForNamedRangeAndKeyValue(e.substring(i)):a,m(a)&&(n=this.checkScopedRange(e.substring(i)),n!=="NaN"&&(a=n)),!m(a)&&a!==this.emptyStr&&(a=a.toUpperCase(),a=this.parent.setTokensForSheets(a),a=this.markLibraryFormulas(a),a!=null)){var o=e.substring(i);o[o.length-1]===")"?e=e.substring(0,i)+a+")":e=e.substring(0,i)+a,i+=a.toString().length+1}r=i<e.length?this.indexOfAny(e.substring(i),t):-1}}return e.indexOf("#N~A")>-1&&(e=e.split("#N~A").join("#N/A")),e.indexOf("#DIV~0!")>-1&&(e=e.split("#DIV~0!").join("#DIV/0!")),e},s.prototype.checkForNamedRangeAndKeyValue=function(e){var t=this.emptyStr;if(e.indexOf("[")>-1){var i=this.getTableRange(e);m(i)||(this.findNamedRange=!0,e=i)}if(t=this.checkScopedRange(e),t!=="NaN")this.findNamedRange=!0,e=t;else{if(e.indexOf(this.sheetToken)>-1){var r=this.parent.getSheetFamilyItem(this.parent.grid),n=e.split('"').join(this.emptyStr);n=n.substr(0,n.indexOf(this.sheetToken)),r.sheetNameToToken.has(n.toUpperCase())&&parseInt(r.sheetNameToToken.get(n.toUpperCase()).split(this.sheetToken).join(this.emptyStr))}this.parent.storedData.size>0&&this.parent.storedData.has(e)&&(e="A"+this.parent.colIndex(e)),this.parent.namedRanges.size>0&&this.parent.namedRanges.has(e.toUpperCase())&&(m(this.parent.parentObject)?(e=this.parse(this.parent.namedRanges.get(e.toUpperCase())),e=this.parent.setTokensForSheets(e),e.indexOf(this.fixedReference)>-1&&e.split(this.fixedReference).join(this.emptyStr),this.findNamedRange=!0):e=this.parse(this.parent.namedRanges.get(e.toUpperCase()))),this.findNamedRange&&e[0]!=="!"&&e[0]!=="q"&&e[0]!=="bq"&&(e=this.parent.setTokensForSheets(e),e.indexOf(this.fixedReference)>-1&&(e=e.split(this.fixedReference).join(this.emptyStr)))}return e},s.prototype.getTableRange=function(e){e=e.replace(" ",this.emptyStr).toUpperCase();var t=e.replace("]",this.emptyStr).replace("#DATA",this.emptyStr);return t.indexOf(this.parent.getParseArgumentSeparator())>-1&&(t.substring(0,t.indexOf(this.parent.getParseArgumentSeparator())).replace("[",this.emptyStr),t=t.replace("[",this.emptyStr).replace(this.parent.getParseArgumentSeparator(),"_")),this.emptyStr,t.toUpperCase()},s.prototype.findNextEndIndex=function(e,t){for(var i=0,r=t,n=!1;!n&&t<e.length;)e[r]==="["?i++:e[r]==="]"&&(i--,i===0&&(n=!0)),t++;return t=t-r,t},s}(),p6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jC=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},f6=function(s){p6(e,s);function e(i){var r=s.call(this,null,null)||this;r.lFormulas=new Map,r.storedData=new Map,r.keyToRowsMap=new Map,r.rowsToKeyMap=new Map,r.rightBracket="¡",r.leftBracket="¢",r.sheetToken="!",r.emptyString="",r.leftBrace="{",r.rightBrace="}",r.cell=r.emptyString,r.cellPrefix="!0!A",r.treatEmptyStringAsZero=!1,r.tic='"',r.singleTic="'",r.trueValue="TRUE",r.falseValue="FALSE",r.parseDecimalSeparator=".",r.arithMarker="´",r.arithMarker2=r.arithMarker+r.arithMarker,r.dependentCells=null,r.dependentFormulaCells=null,r.minValue=Number.MIN_SAFE_INTEGER,r.maxValue=Number.MAX_SAFE_INTEGER,r.categoryCollection=["All"],r.dependencyLevel=0,r.randomValues=new Map,r.isRandomVal=!1,r.randCollection=[],r.dependencyCollection=[],r.uniqueRange=[],r.formulaErrorStrings=["binary operators cannot start an expression","cannot parse","bad library","invalid char in front of","number contains 2 decimal points","expression cannot end with an operator","invalid characters following an operator","invalid character in number","mismatched parentheses","unknown formula name","requires a single argument","requires 3 arguments","invalid Math argument","requires 2 arguments","#NAME?","too complex","circular reference: ","missing formula","improper formula","invalid expression","cell empty","bad formula","empty expression","","mismatched string quotes","wrong number of arguments","invalid arguments","iterations do not converge","Control is already registered","Calculation overflow","Missing sheet","cannot_parse","expression_cannot_end_with_an_operator","#SPILL!","#DIV/0!"],r.errorStrings=null,r.parseArgumentSeparator=",",r.dateTime1900=new Date(1900,0,1,0,0,0),r.isParseDecimalSeparatorChanged=!1,r.isArgumentSeparatorChanged=!1,r.sheetFamilyID=0,r.defaultFamilyItem=null,r.sheetFamiliesList=null,r.modelToSheetID=null,r.tokenCount=0,r.sortedSheetNames=null,r.tempSheetPlaceHolder="",r.namedRanges=new Map,r.formulaInfoTable=null,r.oaDate=new Date(1899,11,30),r.millisecondsOfaDay=24*60*60*1e3,r.parseDateTimeSeparator="/";var n=new u6(r);return r.includeBasicFormulas&&t.Inject(c6),r.injectedModules&&r.injectedModules.length&&n.inject(r.requiredModules(),r.injectedModules),r.parentObject=m(i)?r:i,r.grid=r.parentObject,r.parser=new d6(r),r}t=e,Object.defineProperty(e.prototype,"libraryFormulas",{get:function(){return this.lFormulas},set:function(i){this.lFormulas.set(i.fName,{handler:i.handler,category:i.category,description:i.description})},enumerable:!0,configurable:!0}),e.prototype.getParseArgumentSeparator=function(){var i=",";return!this.isArgumentSeparatorChanged&&i!==this.parseArgumentSeparator&&(this.parseArgumentSeparator=i),this.parseArgumentSeparator},e.prototype.setParseArgumentSeparator=function(i){this.parseArgumentSeparator=i,this.isArgumentSeparatorChanged=!0},e.prototype.getParseDateTimeSeparator=function(){return this.parseDateTimeSeparator},e.prototype.setTreatEmptyStringAsZero=function(i){this.treatEmptyStringAsZero=i},e.prototype.getTreatEmptyStringAsZero=function(){return this.treatEmptyStringAsZero},e.prototype.setParseDateTimeSeparator=function(i){this.parseDateTimeSeparator=i},e.prototype.requiredModules=function(){return l6(this)},e.Inject=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var n=0;n<i.length;n++)this.prototype.injectedModules.indexOf(i[n])===-1&&this.prototype.injectedModules.push(i[n])},e.prototype.getInjectedModules=function(){return this.injectedModules},e.prototype.onPropertyChanged=function(i,r){},e.prototype.getModuleName=function(){return"calculate"},e.prototype.getFormulaCharacter=function(){return"="},e.prototype.isUpperChar=function(i){var r=i.charCodeAt(0);return r>64&&r<91},e.prototype.resetKeys=function(){this.storedData.clear(),this.keyToRowsMap.clear(),this.rowsToKeyMap.clear()},e.prototype.updateDependentCell=function(i){var r=this.getSheetFamilyItem(this.grid),n=this.cell;if(n!==this.emptyString){if(r.sheetNameToParentObject!==null){var a=r.parentObjectToToken.get(this.grid);n.indexOf(this.sheetToken)===-1&&(n=a+n),i.indexOf(this.sheetToken)===-1&&(i=a+i)}if(this.getDependentCells().has(i)){var o=this.getDependentCells().get(i);o.indexOf(n)<0&&n!==i&&o.push(n)}else this.getDependentCells().set(i,[n]);this.addToFormulaDependentCells(i)}},e.prototype.addToFormulaDependentCells=function(i){var r=this.cell,n=this.getSheetFamilyItem(this.grid);if(n.sheetNameToParentObject!=null&&r.indexOf(this.sheetToken)===-1){var a=n.parentObjectToToken.get(this.grid);r=a+r}this.getDependentFormulaCells().has(r)?this.getDependentFormulaCells().get(r).has(i)||this.getDependentFormulaCells().get(r).set(i,i):(this.getDependentFormulaCells().set(r,new Map),this.getDependentFormulaCells().get(r).set(i,i))},e.prototype.getDependentCells=function(){return this.dependentCells==null&&(this.dependentCells=new Map),this.dependentCells},e.prototype.getDependentFormulaCells=function(){if(this.isSheetMember()){var i=this.getSheetFamilyItem(this.grid);return i.sheetDependentFormulaCells==null&&(i.sheetDependentFormulaCells=new Map),i.sheetDependentFormulaCells}else return this.dependentFormulaCells==null&&(this.dependentFormulaCells=new Map),this.dependentFormulaCells},e.prototype.getLibraryFormulas=function(){return this.lFormulas},e.prototype.getFunction=function(i){return this.getLibraryFormulas().has(i.toUpperCase())?this.getLibraryFormulas().get(i.toUpperCase()).handler:null},e.prototype.intToDate=function(i){var r=Number(i);r=r>0&&r<1?1+r:r===0?1:r,r>60&&(r-=1);var n=new Date("01/01/1900"),a=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds());return new Date(new Date((r-1)*(1e3*3600*24)+a).toUTCString().replace(" GMT",""))},e.prototype.getFormulaInfoTable=function(){if(this.isSheetMember()){var i=this.getSheetFamilyItem(this.grid);return i.sheetFormulaInfotable===null&&(i.sheetFormulaInfotable=new Map),i.sheetFormulaInfotable}else return this.formulaInfoTable===null&&(this.formulaInfoTable=new Map),this.formulaInfoTable},e.prototype.getFormula=function(i){return i=i.toUpperCase(),this.storedData.has(i)?this.storedData.get(i).getFormulaText():""},e.prototype.getParseDecimalSeparator=function(){var i=".";return!this.isParseDecimalSeparatorChanged&&i!==this.parseDecimalSeparator&&(this.parseDecimalSeparator=i),this.parseDecimalSeparator},e.prototype.setParseDecimalSeparator=function(i){this.parseDecimalSeparator=i,this.isParseDecimalSeparatorChanged=!0},e.prototype.getSheetToken=function(i){var r=0,n=this.emptyString;if(r<i.length&&i[r]===this.sheetToken){for(r++;r<i.length&&i[r]!==this.sheetToken;)r++;n=i.substring(0,r+1)}if(r<i.length)return n;throw this.formulaErrorStrings[Ce.bad_index]},e.prototype.getSheetID=function(i){var r=this.getSheetFamilyItem(i);if(r.sheetNameToParentObject!=null&&r.sheetNameToParentObject.size>0){var n=r.parentObjectToToken.get(i);if(n){n=n.split(this.sheetToken).join(this.emptyString);var a=this.parseFloat(n);if(!this.isNaN(a))return a}}return-1},e.prototype.parseFloat=function(i){var r=Number(i);return isNaN(r)&&typeof i=="string"&&i.includes(",")&&(r=Number(i.split(",").join(""))),r},e.prototype.rowIndex=function(i){var r=0,n=!1;if(r<i.length&&i[r]===this.sheetToken){for(r++;r<i.length&&i[r]!==this.sheetToken;)r++;r++}for(;r<i.length&&this.isChar(i[r]);)n=!0,r++;var a=parseInt(i.substring(r),10);if(r<i.length&&!this.isNaN(a))return a;if(n)return-1;throw this.formulaErrorStrings[Ce.bad_index]},e.prototype.colIndex=function(i){var r=0,n=0;if(i=i.toUpperCase(),r<i.length&&i[r]===this.sheetToken){for(r++;r<i.length&&i[r]!==this.sheetToken;)r++;r++}for(;r<i.length&&this.isChar(i[r]);){var a=i[r].charCodeAt(0);n=n*26+a-64,r++}return n===0?-1:n},e.prototype.getErrorStrings=function(){return this.errorStrings===null&&(this.errorStrings=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"]),this.errorStrings},e.prototype.substring=function(i,r,n){return i.substring(r,n+r)},e.prototype.isChar=function(i){return i.charCodeAt(0)>=65&&i.charCodeAt(0)<=90||i.charCodeAt(0)>=97&&i.charCodeAt(0)<=122},e.prototype.getSheetFamilyItem=function(i,r){return this.sheetFamilyID===0?(this.defaultFamilyItem==null&&(this.defaultFamilyItem=new jA),this.defaultFamilyItem):(this.sheetFamiliesList==null&&(this.sheetFamiliesList=new Map),r===void 0&&(r=this.modelToSheetID.get(i)),this.sheetFamiliesList.has(r)||this.sheetFamiliesList.set(r,new jA),this.sheetFamiliesList.get(r))},e.prototype.setKeyValue=function(i,r){i=i.toUpperCase();var n=r.toString().trim();(!this.storedData.get(i)||n.indexOf(this.leftBrace)===0)&&(this.storedData.set(i,new zA),this.keyToRowsMap.set(i,this.keyToRowsMap.size+1),this.rowsToKeyMap.set(this.rowsToKeyMap.size+1,i));var a=this.storedData.get(i);if(a.getFormulaText()!=null&&a.getFormulaText().length>0&&a.getFormulaText()!==n){var o=this.cellPrefix+this.keyToRowsMap.get(i).toString(),l=this.getDependentFormulaCells().get(o);l!=null&&this.clearFormulaDependentCells(o)}n.length>0&&n[0]===this.getFormulaCharacter()?a.setFormulaText(n):a.getFormulaValue()!==n&&(a.setFormulaText(""),a.setParsedFormula(""),a.setFormulaValue(n))},e.prototype.clearFormulaDependentCells=function(i){var r=this,n=this.getDependentFormulaCells().get(i);n&&(n.forEach(function(a,o){var l=o,h=r.getDependentCells().get(l);r.arrayRemove(h,i),h.length===0&&r.getDependentCells().delete(l)}),this.getDependentFormulaCells().delete(i))},e.prototype.arrayRemove=function(i,r){var n=i.indexOf(r);return n!==-1&&i.splice(n,1),i},e.prototype.getKeyValue=function(i){if(i=i.toUpperCase(),this.storedData.has(i)!==null){var r=this.storedData.get(i),n=r.getFormulaText();if(n.length>0&&n[0]===this.getFormulaCharacter()){this.cell=this.cellPrefix+this.keyToRowsMap.get(i).toString(),n=n.substring(1);try{r.setParsedFormula(this.parser.parseFormula(n,i))}catch(l){var a={message:l.message,exception:l,isForceCalculable:!1,computeForceCalculate:!1};return this.trigger("onFailure",a),r.setFormulaValue(a.message),this.storedData.get(i).getFormulaValue()}try{r.setFormulaValue(this.computeFormula(r.getParsedFormula()))}catch(l){var a={message:l.message,exception:l,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",a);var o=typeof a.exception=="string"?a.exception:a.message;return(m(this.getErrorLine(l))?"":"#"+this.getErrorLine(l)+": ")+o}}return this.storedData.get(i).getFormulaValue()}else return this.emptyString},e.prototype.getNamedRanges=function(){return this.namedRanges},e.prototype.addNamedRange=function(i,r){var n=i.split(this.sheetToken);if(n.length>1){var a=this.getSheetFamilyItem(this.grid);if(!a.parentObjectToToken.get(n[0]))return!1;i=n[0]+this.sheetToken+n[1].toUpperCase()}else i=i.toUpperCase();return this.namedRanges.set(i,r),!0},e.prototype.removeNamedRange=function(i){return i=i.toUpperCase(),this.namedRanges.get(i)!=null?(this.namedRanges.delete(i),!0):!1},e.prototype.convertAlpha=function(i){for(var r=[],n=0,a="A";i>0;){i--;var o=a.charCodeAt(0);r[n]=String.fromCharCode(i%26+o),i=parseInt((i/26).toString(),10),n++}for(var l=[],h=0;h<n;h++)l[n-h-1]=r[h];return l.join("")},e.prototype.getCellCollection=function(i){if(i.indexOf(":")<0)if(this.isCellReference(i))i=i+":"+i;else return i.split(this.getParseArgumentSeparator());var r=this.emptyString,n=i.indexOf(this.sheetToken);if(n>-1)for(var a=n,o=a+1;o<i.length;){if(i[o]===this.sheetToken){r=i.substr(0,o+1);break}o++}var l=i.indexOf(":"),h,u,c,d;if(l>0&&this.isChar(i[l-1]))for(var p=l-2;p>=0&&this.isDigit(i[p]);)p--;h=this.rowIndex(this.substring(i,0,l)),u=this.rowIndex(this.substring(i,l+1,l+i.length-l-1)),c=this.colIndex(this.substring(i,0,l)),d=this.colIndex(this.substring(i,l+1,l+i.length-l-1)),h>u&&(l=u,u=h,h=l),c>d&&(l=d,d=c,c=l);var f=[],v,g=0;for(l=h;l<=u;l++)for(v=c;v<=d;v++)f[g]=r+this.emptyString+this.convertAlpha(v)+l.toString(),g++;return f},e.prototype.computeFormula=function(i,r){return this.calculateFormula(i,!1,r)},e.prototype.calculateFormula=function(i,r,n){var a=this,o,l,h,u=!1,c;if(this.parser.isError)return i;this.parser.isFormulaParsed?o=i:o=this.parser.parseFormula(i),this.parser.isFormulaParsed=!1;try{if(l=this.findLastIndexOfq(o),l>0&&(u=!0),o!==this.emptyString&&l>-1)for(var d=l+1;d>-1;){if(o[d]!==this.rightBracket){d++;continue}var p=o.substring(l,d+1),f=p.split(this.leftBracket)[0].split("q").join(this.emptyString),v=void 0;if(this.getLibraryFormulas().get(f.toUpperCase()).isCustom){v=p.substring(p.indexOf(this.leftBracket)+1,p.indexOf(this.rightBracket)).split(this.getParseArgumentSeparator());var g=0,b=[],y=void 0;for(g=0;g<v.length;g++)v[g].includes(":")&&this.isCellReference(v[g])?(y=this.getCellCollection(v[g]),y.length>1?(b.push(v[g]),y.forEach(function(A){a.updateDependentCell(A)})):b.push(this.getValueFromArg(v[g]))):b.push(this.getValueFromArg(v[g]));v=b}else{var C=p.substring(p.indexOf(this.leftBracket)+1,p.indexOf(this.rightBracket));v=[];for(var x=this.getParseArgumentSeparator(),w="",M=void 0,E=0,T=C.length-1;E<=T;E++)C[E]==='"'&&(M=!M),C[E]===x&&!M?(v.push(w),w="",E===T&&v.push(w)):(w+=C[E],E===T&&v.push(w));v.length||(v=[""]),u&&f&&(f==="IF"||f==="INDEX")&&v.push("nestedFormulaTrue"),u&&f&&f==="SORT"&&v.push("nestedFormulaTrue"),u&&f&&f==="IF"&&v.push("nestedFormulaTrue"),u&&f&&f==="T"&&v.push("nestedFormulaTrue"),u&&f&&f==="EXACT"&&v.push("nestedFormulaTrue"),u&&f&&f==="PROPER"&&v.push("nestedFormulaTrue"),u&&f&&f==="DOLLAR"&&v.push("nestedFormulaTrue"),u&&f&&f==="DATE"&&v.push("nestedFormulaTrue"),n&&f==="UNIQUE"&&v.push("isComputeExp")}if(h=m(this.getFunction(f))?this.getErrorStrings()[W.name]:this.getFunction(f).apply(void 0,v),u){c=this.processNestedFormula(o,p,h);var D=this.findLastIndexOfq(c);D===0&&(u=!1),D===-1&&(h=this.computeValue(c,r)),l=d=D,o=c;continue}break}else this.formulaErrorStrings.indexOf(o)>-1?h=o:o!==this.emptyString&&l===-1&&(h=this.computeValue(o,r))}catch(A){var v={message:A.message,exception:A,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",v);var N=typeof v.exception=="string"?v.exception:v.message;h=(m(this.getErrorLine(A))?"":"#"+this.getErrorLine(A)+": ")+N}return h},e.prototype.computeSumIfAndAvgIf=function(i,r){if(m(i)||i[0]===this.emptyString||i.length===0)return this.formulaErrorStrings[Ce.wrong_number_arguments];for(var n=i,a=0;a<n.length;a++)if(this.isCellReference(n[a])&&m(n[a].match(/[0-9]/))&&n[a].indexOf("!")<0){var o=n[a].split(":");n[a]=o[0]+"1:"+o[1]+this.spreadSheetUsedRange[0]}var l=n.length;if(l!==2&&l!==3&&l===0)return this.formulaErrorStrings[Ce.wrong_number_arguments];if(n[1]==="")return r?this.getErrorStrings()[W.divzero]:"0";var h=n[0],u=n[1].startsWith(this.tic)&&n[1].endsWith(this.tic),c=n[1].split(this.tic).join(this.emptyString);if(c.length>255)return this.getErrorStrings()[W.value];var d=c.includes("*"),p=c.includes("?"),f=d?c.replace(/\*/g,"").trim():c,v=!1;if(!u&&this.isCellReference(f)&&(f=this.getValueFromArg(f),v=!0),d){var g=c.indexOf("*");c[0]==="*"&&(f="*"+f),c[c.length-1]==="*"&&(f+="*"),g>0&&g<c.length-1&&(f=c.substring(0,g)+"*"+c.substring(g+1))}c=f;var b=this.parser.tokenEqual;c.startsWith("<=")?(b=this.parser.tokenLessEq,c=c.substring(2)):c.startsWith(">=")?(b=this.parser.tokenGreaterEq,c=c.substring(2)):c.startsWith("<>")?(b=this.parser.tokenNotEqual,c=c.substring(2)):c.startsWith("<")?(b=this.parser.tokenLess,c=c.substring(1)):c.startsWith(">")?(b=this.parser.tokenGreater,c=c.substring(1)):c.startsWith("=")&&(b=this.parser.tokenEqual,c=c.substring(1)),(!u&&this.isCellReference(c)&&!v||c.includes(this.arithMarker))&&(c=this.getValueFromArg(c));var y=this.parseFloat(c),C=n[0],x=this.getCellCollection(l>2?n[2]:h),w=this.getCellCollection(C);if(w.length>x.length){var M=this.colIndex(x[x.length-1])+this.colIndex(w[w.length-1])-this.colIndex(w[0]),E=n[2].split(":");E[1]=(this.convertAlpha(M)+this.rowIndex(w[w.length-1])).toString(),x=this.getCellCollection(E.join(":"))}var T=this.getComputeSumIfValue(w,x,c.toLowerCase(),y,b,d,p);return[T[0],T[1]]},e.prototype.computeLookup=function(i){var r,n,a,o,l=[],h=[],u=[],c=[],d,p,f=[],v=i,g=v.length;if(g===1||g>3)return this.formulaErrorStrings[Ce.wrong_number_arguments];if(v[1]===""||v[2]==="")return this.getErrorStrings()[W.value];if(d=this.getValueFromArg(v[0]),v[0].indexOf(this.tic)>-1&&v[0].toUpperCase().split(this.tic).join("")!==this.trueValue&&v[0].toUpperCase().split(this.tic).join("")!==this.falseValue&&this.isNaN(this.parseFloat(v[0].split(this.tic).join("")))&&(d=d.split(this.tic).join("")),this.getErrorStrings().indexOf(d)>-1)return d;var b=v[1].split(":");if(b.length===2&&this.isCellReference(b[0])&&this.isCellReference(b[1])&&g===2){var y=v[1].indexOf(":"),C=this.rowIndex(this.substring(v[1],0,y)),x=this.colIndex(this.substring(v[1],0,y)),w=this.rowIndex(this.substring(v[1],y+1,y+v[1].length-y-1)),M=this.colIndex(this.substring(v[1],y+1,y+v[1].length-y-1));C>w&&(r=[w,C],C=r[0],w=r[1]),x>M&&(n=[M,x],x=n[0],M=n[1]);var E="";v[1].indexOf("!")===0&&(E=v[1],E=E.replace("!",""),E=E.indexOf("!"),E=v[1].substring(0,E+2));var T=M-x+1,D=w-C+1;D>T||D===T?(a=E+Ft(x)+C+":"+Ft(x)+w,o=E+Ft(M)+C+":"+Ft(M)+w):D<T&&(a=E+Ft(x)+C+":"+Ft(M)+C,o=E+Ft(x)+w+":"+Ft(M)+w),(C!==w||x!==M)&&(p=!0)}if(p)l=this.getCellCollection(a),h=this.getCellCollection(o);else{l=this.getCellCollection(v[1]);var N=g===2?v[1]:v[2];h=this.getCellCollection(N);var A=ee(v[1]),L=ee(N),k=A[1]===A[3]?!0:A[0]===A[2],O=L[1]===L[3]?!0:L[0]===L[2];if(!k||!O)return this.getErrorStrings()[W.na]}for(var R=0;R<l.length;R++)c.push(this.getValueFromArg(l[R]).split(this.tic).join(""));var j=c.map(function(we){return we===""?NaN:Number(we)}).sort(function(we,H){return we-H}),P=j[j.length-1],F=j[0],z=this.parseFloat(d);if(this.isNaN(z)){for(var X=0;X<l.length;X++)if(u[X]=this.getValueFromArg(l[X]).split(this.tic).join(""),!m(h[X])&&d!==""&&u[X]!==""){if(d.toUpperCase()===u[X].toUpperCase())f.push(this.getValueFromArg(h[X]).split(this.tic).join("")||"0");else if(d.indexOf("*")>-1||d.indexOf("?")>-1){var G=d;if(d.indexOf("*")>-1){G=G.replace(/\*/g,"").trim(),this.isCellReference(G)&&(G=this.getValueFromArg(G));var Z=d.indexOf("*");d[0]==="*"&&(G="*"+G),d[d.length-1]==="*"&&(G+="*"),Z>0&&Z<d.length-1&&(G=d.substring(0,Z)+"*"+d.substring(Z+1))}var se=[],oe=this.findWildCardValue(G.toLowerCase(),u[X].toLowerCase());se.push(oe),se.push(d),this.processLogical(se,"equal")===this.trueValue&&f.push(this.getValueFromArg(h[X]).split(this.tic).join("")||"0")}}}else for(var q=0;q<j.length;q++)u[q]=j[q].toString().split(this.tic).join(""),!m(h[q])&&u[q]!==""&&z===this.parseFloat(u[q])&&f.push(this.getValueFromArg(h[q]).split(this.tic).join("")||"0");if(f.length>0)return f[f.length-1];if(z>P&&!m(h[l.length-1]))return this.getValueFromArg(h[l.length-1]).split(this.tic).join("")||"0";if(z<F)return this.getErrorStrings()[W.na];if(c.indexOf(d.split(this.tic).join(""))<0&&d!==this.trueValue&&d!==this.falseValue){if(!this.isNaN(z)&&!this.isNaN(P)&&!this.isNaN(F)){for(var fe=[],be=0;be<j.length;be++)z>j[be]&&fe.push(j[be]);var y=fe.length-1;if(!m(h[y])&&y>=0)return this.getValueFromArg(h[y]).split(this.tic).join("")||"0"}else if(this.isNaN(z)&&d!==""&&/^[a-zA-Z!@#$%^&*()_+{}\[\]:;<>,.?~\\/-]/.test(d)){var Ne=c.sort(),y=this.findClosestMatch(d.split(this.tic).join(""),Ne);if(!m(h[y])&&y>=0)return this.getValueFromArg(h[y]).split(this.tic).join("")||"0"}}return this.getErrorStrings()[W.na]},e.prototype.computeVHLookup=function(i,r){var n,a,o,l,h,u,c,d=[],p=[],f=[],v=i,g=r?this.trueValue:this.falseValue;if(v[0]===""||v[1]==="")return this.getErrorStrings()[W.na];if(o=this.getValueFromArg(v[0]),v[0].indexOf(this.tic)>-1&&v[0].toUpperCase().split(this.tic).join("")!==this.trueValue&&v[0].toUpperCase().split(this.tic).join("")!==this.falseValue&&this.isNaN(this.parseFloat(v[0].split(this.tic).join("")))&&(o=o.split(this.tic).join("")),this.getErrorStrings().indexOf(o)>-1)return o;this.isCellReference(v[2])||v[2].includes(this.arithMarker)?l=this.getValueFromArg(v[2])||"0":l=this.getValueFromArg(v[2]).split(this.tic).join(""),l=l.toUpperCase()===this.trueValue?"1":l.toUpperCase()===this.falseValue?"0":l;var b=this.parseFloat(l),y=v[1].split(":");if(this.isCellReference(y[0])&&this.isCellReference(y[1])){var C=v[1].indexOf(":"),x=this.rowIndex(this.substring(v[1],0,C)),w=this.colIndex(this.substring(v[1],0,C)),M=this.rowIndex(this.substring(v[1],C+1,C+v[1].length-C-1)),E=this.colIndex(this.substring(v[1],C+1,C+v[1].length-C-1));x>M&&(n=[M,x],x=n[0],M=n[1]),w>E&&(a=[E,w],w=a[0],E=a[1]);var T="";v[1].indexOf("!")===0&&(T=v[1],T=T.replace("!",""),T=T.indexOf("!"),T=v[1].substring(0,T+2)),g===this.trueValue?h=T+Ft(w)+x+":"+Ft(w)+M:h=T+Ft(w)+x+":"+Ft(E)+x;var D=void 0;if(g===this.trueValue){if(D=w+b-1,D>E)return this.getErrorStrings()[W.ref]}else if(D=x+b-1,D>M)return this.getErrorStrings()[W.ref];if(b<1||this.isNaN(b))return this.getErrorStrings()[W.value];g===this.trueValue?u=T+Ft(D)+x+":"+Ft(D)+M:u=T+Ft(w)+D+":"+Ft(E)+D}if(v[3]=v[3]?v[3]:this.trueValue,this.isCellReference(v[3])?v[3]=this.getValueFromArg(v[3]):v[3]=this.getValueFromArg(v[3]).split(this.tic).join(""),this.getErrorStrings().indexOf(v[3])>-1)return v[3];if(v[3].toUpperCase()===this.falseValue||v[3]==="0")c=this.falseValue;else if(v[3].toUpperCase()===this.trueValue||v[3]==="1")c=this.trueValue;else return this.getErrorStrings()[W.value];for(var N=this.getCellCollection(h),A=this.getCellCollection(u),L=0;L<N.length;L++)p.push(this.getValueFromArg(N[L]).split(this.tic).join(""));var k=this.parseFloat(o);if(c==="FALSE"){for(var O=0;O<N.length;O++)if(d[O]=this.getValueFromArg(N[O]).split(this.tic).join(""),!m(A[O])){if(!this.isNaN(k)&&d[O]!==""&&k===this.parseFloat(d[O]))f.push(this.getValueFromArg(A[O]).split(this.tic).join("")||"0");else if(d[O]!==""&&o.toUpperCase()===d[O].toUpperCase())f.push(this.getValueFromArg(A[O]).split(this.tic).join("")||"0");else if(o.indexOf("*")>-1||o.indexOf("?")>-1){var R=o;if(o.indexOf("*")>-1){R=R.replace(/\*/g,"").trim(),this.isCellReference(R)&&(R=this.getValueFromArg(R));var j=o.indexOf("*");o[0]==="*"&&(R="*"+R),o[o.length-1]==="*"&&(R+="*"),j>0&&j<o.length-1&&(R=o.substring(0,j)+"*"+o.substring(j+1))}var P=[],F=this.findWildCardValue(R.toLowerCase(),d[O].toLowerCase());P.push(F),P.push(o),this.processLogical(P,"equal")===this.trueValue&&f.push(this.getValueFromArg(A[O]).split(this.tic).join("")||"0")}}return f.length>0?f[0]:this.getErrorStrings()[W.na]}else if(c==="TRUE"){for(var z=p.map(function(Ne){return Ne===""?NaN:Number(Ne)}).sort(function(Ne,we){return Ne-we}),q=z[z.length-1],X=z[0],G=o.toUpperCase(),Z=0;Z<N.length;Z++)d[Z]=this.getValueFromArg(N[Z]).split(this.tic).join(""),!m(A[Z])&&o!==""&&d[Z]!==""&&(G===this.trueValue||G===this.falseValue)&&G===d[Z].toUpperCase()?f.push(this.getValueFromArg(A[Z]).split(this.tic).join("")||"0"):!m(A[Z])&&o!==""&&d[Z]!==""&&G===d[Z].toUpperCase()&&f.push(this.getValueFromArg(A[Z]).split(this.tic).join("")||"0");for(var se=0;se<z.length;se++)d[se]=z[se].toString().split(this.tic).join(""),!m(A[se])&&o!==""&&!this.isNaN(k)&&d[se]!==""&&k===this.parseFloat(d[se])&&f.push(this.getValueFromArg(A[se]).split(this.tic).join("")||"0");if(f.length>0)return f[f.length-1];if(o.indexOf("*")>-1||o.indexOf("?")>-1||G.split(this.tic).join("")===this.trueValue||G.split(this.tic).join("")===this.falseValue)return this.getErrorStrings()[W.na];if(k>q&&!m(A[N.length-1]))return this.getValueFromArg(A[N.length-1]).split(this.tic).join("");if(p.indexOf(o.split(this.tic).join(""))<0&&o!==this.trueValue&&o!==this.falseValue){if(!this.isNaN(k)&&o!==""&&!this.isNaN(q)&&!this.isNaN(X)){for(var oe=[],fe=0;fe<z.length;fe++)k>z[fe]&&oe.push(z[fe]);var C=oe.length-1;if(!m(A[C])&&C>=0)return this.getValueFromArg(A[C]).split(this.tic).join("")||"0"}else if(this.isNaN(k)&&o!==""&&this.isNaN(q)&&this.isNaN(X)){var be=p.sort(),C=this.findClosestMatch(o.split(this.tic).join(""),be);if(!m(A[C])&&C>=0)return this.getValueFromArg(A[C]).split(this.tic).join("")||"0"}}}return this.getErrorStrings()[W.na]},e.prototype.findClosestMatch=function(i,r){for(var n=0,a=r.length-1;n<=a;){var o=Math.floor((n+a)/2),l=r[o],h=this.compareStrings(i.toLowerCase(),l.toLowerCase());if(h===0)return o;h===1?n=o+1:a=o-1}for(var u=n-1;u>=0;u--)if(this.compareStrings(i.toLowerCase(),r[u].toLowerCase())!==-1)return u;return-1},e.prototype.compareStrings=function(i,r){for(var n=Math.min(i.length,r.length),a=0;a<n;a++){var o=i.charCodeAt(a),l=r.charCodeAt(a);if(o<l)return-1;if(o>l)return 1}return i.length<r.length?-1:i.length>r.length?1:0},e.prototype.findWildCardValue=function(i,r){var n="";if(i.indexOf("?")>-1){var a=RegExp(i.replace(/\?/g,"[\\s\\S]"));r.length===i.length&&this.isNaN(this.parseFloat(r))&&r.match(a)?n=i:n=r}else if(i.indexOf("*")>-1){for(var o=i.indexOf("*"),l="",h="",u=this.falseValue,c=this.falseValue,d=o-1;d>=0;d--)l=l+i[d],c=this.trueValue;for(var d=o+1;d<i.length;d++)h=h+i[d],u=this.trueValue;var p=l===""?-1:r.indexOf(l.split("").reverse().join("")),f=h===""?-1:r.indexOf(h);if(p>-1||f>-1){var v=l.split("").reverse().join("")===r.substr(0,l.length),g=h===r.substring(r.length-h.length,r.length);c===this.trueValue&&u===this.trueValue&&this.isNaN(this.parseFloat(l))&&this.isNaN(this.parseFloat(h))?n=v&&g?i:r:c===this.trueValue&&this.isNaN(this.parseFloat(l))?n=v?i:r:u===this.trueValue&&this.isNaN(this.parseFloat(h))&&(n=g?i:r)}else n=r}return n},e.prototype.getComputeSumIfValue=function(i,r,n,a,o,l,h){var u=0,c=0;switch(o){case this.parser.tokenEqual:for(var d=l?n.replace(/\*/g,""):n,p=0;p<i.length;p++){var f=this.getValueFromRange(r,p),v=this.getValueFromArg(i[p].split(this.tic).join("")).toLowerCase(),g=this.parseFloat(v);if(v===n&&g===a){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}else if(v===n)this.isNaN(f)||(u=u+f,c=c+1);else if(l&&d&&v&&this.isNaN(this.parseFloat(v))){var C=n.indexOf("*");n[0]==="*"&&d.length<=v.length&&d===v.slice(v.length-d.length,v.length)?this.isNaN(f)||(u=u+f,c=c+1):n[n.length-1]==="*"&&d.length<=v.length&&d===v.slice(0,d.length)?this.isNaN(f)||(u=u+f,c=c+1):C>-1&&v.startsWith(n.substr(0,C))&&v.endsWith(n.substr(C+1))&&(this.isNaN(f)||(u=u+f,c=c+1))}else if(l&&!d&&v&&this.isNaN(this.parseFloat(v)))this.isNaN(f)||(u=u+f,c=c+1);else if(h&&d&&v&&this.isNaN(this.parseFloat(v))){var x=RegExp(d.replace(/\?/g,"[\\s\\S]"));v.length===n.length&&v.match(x)&&(this.isNaN(f)||(u=u+f,c=c+1))}}break;case this.parser.tokenLess:for(var p=0;p<i.length;p++){var v=this.getValueFromArg(i[p].split(this.tic).join("")),g=this.parseFloat(v);if(g<a){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}}break;case this.parser.tokenGreater:for(var p=0;p<i.length;p++){var v=this.getValueFromArg(i[p].split(this.tic).join("")),g=this.parseFloat(v);if(g>a){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}}break;case this.parser.tokenLessEq:for(var p=0;p<i.length;p++){var v=this.getValueFromArg(i[p].split(this.tic).join("")),g=this.parseFloat(v);if(g<=a){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}}break;case this.parser.tokenGreaterEq:for(var p=0;p<i.length;p++){var v=this.getValueFromArg(i[p].split(this.tic).join("")),g=this.parseFloat(v);if(g>=a){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}}break;case this.parser.tokenNotEqual:for(var d=l?n.replace(/\*/g,""):n,p=0;p<i.length;p++){var f=this.getValueFromRange(r,p),v=this.getValueFromArg(i[p].split(this.tic).join("")).toLowerCase(),g=this.parseFloat(v);if(v!==n&&g!==a&&!l&&!h){var b=this.getValueFromArg(r[p].split(this.tic).join("")),y=this.parseFloat(b);this.isNaN(y)||(u=u+y,c=c+1)}else if(l&&d&&v&&this.isNaN(this.parseFloat(v))){var C=n.indexOf("*");n[0]==="*"&&d.length<=v.length&&d!==v.slice(v.length-d.length,v.length)?this.isNaN(f)||(u=u+f,c=c+1):n[n.length-1]==="*"&&d.length<=v.length&&d!==v.slice(0,d.length)?this.isNaN(f)||(u=u+f,c=c+1):(C>-1&&!v.startsWith(n.substr(0,C))||!v.endsWith(n.substr(C+1)))&&(this.isNaN(f)||(u=u+f,c=c+1))}else if(l&&!d&&!this.isNaN(this.parseFloat(v)))this.isNaN(f)||(u=u+f,c=c+1);else if(h&&d&&v&&this.isNaN(this.parseFloat(v))){var x=RegExp(d.replace(/\?/g,"[\\s\\S]"));(v.length!==n.length||!v.match(x))&&(this.isNaN(f)||(u=u+f,c=c+1))}}break}return[u,c]},e.prototype.getValueFromRange=function(i,r){var n=i[r];return n=this.getValueFromArg(n),this.parseFloat(n.toString())},e.prototype.computeAndOrNot=function(i,r){for(var n=this,a=r==="and",o=r==="or",l=r==="not",h=!!(a||l),u,c,d=[],p=i,f=0;f<p.length;f++){if(p[f]===this.tic)return this.getErrorStrings()[W.value];if(this.isCellReference(p[f]))for(var v=this.getCellCollection(p[f]),g=0;g<v.length;g++){if(this.getErrorStrings().indexOf(v[g])>-1)return v[g];if(v[g][0]===this.tic)return this.getErrorStrings()[W.name];if(u=this.getValueFromArg(v[g]),this.getErrorStrings().indexOf(u)>-1)return u;c=this.parseFloat(u),u===this.falseValue||u!==""&&c===0||l&&u===""?d.push(this.falseValue):u===this.trueValue||!isNaN(c)&&u!==""?d.push(this.trueValue):(u===""||isNaN(c))&&d.push(this.getErrorStrings()[W.value])}else{if(u=this.getValueFromArg(p[f]).split(this.tic).join("").toUpperCase(),this.getErrorStrings().indexOf(u)>-1)return u;c=this.parseFloat(u),u===this.falseValue||p[f]===""||u!==""&&c===0?d.push(this.falseValue):u===this.trueValue||!isNaN(c)&&u!==""?d.push(this.trueValue):(u===""||isNaN(c))&&d.push(this.getErrorStrings()[W.value])}}var b=d.every(function(y){return y===n.getErrorStrings()[W.value]});if(b)return this.getErrorStrings()[W.value];for(var g=0;g<d.length;g++){if((a||l)&&d[g]===this.falseValue){h=!1;break}if(o&&d[g]===this.trueValue){h=!0;break}}return h=l?!h:h,h?this.trueValue:this.falseValue},e.prototype.removeTics=function(i){return i.length>1&&i[0]===this.tic[0]&&i[i.length-1]===this.tic[0]&&(i=this.substring(i,1,i.length-2)),i},e.prototype.getCellFrom=function(i){var r="",n=i.indexOf(":")>-1?i.split(":"):[i],a=n.length-1,o=this.rowIndex(n[0]),l;if(o===this.rowIndex(n[a])){var h=this.colIndex(n[0]),u=this.colIndex(n[a]),c=this.colIndex(this.cell);c>=h&&c<=u&&(r=Ft(c).toString()+o.toString())}else if(this.colIndex(n[0])===this.colIndex(n[a])){l=this.colIndex(n[0]);var d=this.rowIndex(n[a]),p=this.rowIndex(this.cell);p>=o&&p<=d&&(r=Ft(l).toString()+p.toString())}return r},e.prototype.computeValue=function(i,r,n){try{var a=[],o=0,l="";for(a.length=0;o<i.length;){var h=i[o]==="u";if(h&&(o=o+1),i[o]===this.arithMarker){o=o+1;continue}else if(this.isDigit(i[o])){for(var u=this.emptyString;o<i.length&&(this.isDigit(i[o])||i[o]===this.parseDecimalSeparator);)u=u+i[o],o=o+1;if(a.push(u),!i[o])return a.toString()}if(i[o]===this.sheetToken){for(l=i[o],o=o+1;o<i.length&&i[o]!==this.sheetToken;)l=l+i[o],o=o+1;o<i.length&&(l=l+i[o],o=o+1)}else if(this.isUpperChar(i[o])){for(var u=this.emptyString,c="";o<i.length&&this.isUpperChar(i[o]);){var d=i[o];u=u+d,o=o+1}for(;o<i.length&&this.isDigit(i[o]);){var p=i[o];u=u+p,o=o+1}if(o<i.length&&i[o]===":"){if(u=u+i[o],o=o+1,o<i.length&&i[o]===this.sheetToken)for(u=u+i[o],o=o+1;o<i.length&&i[o]!==this.sheetToken;)u=u+i[o],o=o+1;for(;o<i.length&&this.isUpperChar(i[o]);)u=u+i[o],o=o+1;for(;o<i.length&&this.isDigit(i[o]);)u=u+i[o],o=o+1;u=l+this.getCellFrom(u)}else u=l+u;if(c=this.getParentObjectCellValue(u,r).toString(),l="",typeof c=="string"&&this.getErrorStrings().indexOf(c)>-1)return c;h&&(this.isNaN(this.parseFloat(c))?c="-"+c:c=(-this.parseFloat(c)).toString()),a.push(c)}else if(i[o]==="q"){var f=i.substring(o+1).indexOf(this.leftBracket),v=i.substring(o+f+1).indexOf(this.rightBracket);i=this.substring(i,o+f+2,v-1)}else if(i[o]===this.tic[0]){var u=i[o].toString();for(o=o+1;o<i.length&&i[o]!==this.tic[0];)u=u+i[o],o=o+1;var c=u.split(this.tic).join(this.emptyString);c===this.trueValue||c===this.falseValue||!this.isNaN(this.parseFloat(c))&&c!==""?a.push(this.tic+c+this.tic):a.push(c),o=o+1}else if(i[o]==="%"&&a.length>0){var g=a[0],b=this.parseFloat(g);this.isNaN(b)||(a.pop(),a.push((b/100).toString())),o=o+1}else if(i.substring(o).indexOf(this.trueValue)===0)a.push(this.trueValue),o+=this.trueValue.length;else if(i.substring(o).indexOf(this.falseValue)===0)a.push(this.falseValue),o+=this.falseValue.length;else if(i[o]===this.tic[0]||i[o]==="|"){var u=i[o].toString();for(o++;o<i.length&&i[o]!==this.tic[0];)u=u+i[o],o=o+1;a.push(u+this.tic),o+=1}else{if(i[o]===" "&&o<i.length-1){o+=1;continue}switch(i[o]){case"#":{var y=0;this.getErrorStrings().indexOf(i.substring(o))>-1?(i.indexOf("!")===-1||i.substring(o).indexOf("!")===-1?y=i.indexOf("#N/A")>-1?i.indexOf("#N/A")+4+o:i.indexOf("?")+1+o:y=i.indexOf("!")+1+o,a.push(this.substring(i,o,y-o))):(y=o+1,a.push(this.substring(i,o,y-o))),o=y}break;case"n":{o=o+1;var u="";if(i[o]==="n")continue;if(i.substring(o).indexOf("Infinity")===0)u="Infinity",o+=u.length;else{for((i[o]==="u"||h||i[o]==="-")&&(u="-",h?h=!1:o=o+1);o<i.length&&this.isDigit(i[o])||i[o]===this.getParseDecimalSeparator();)u=u+i[o],o=o+1;if(o<i.length&&i[o]==="%")if(o=o+1,u===""){if(a.length>0){var g=a[0],b=this.parseFloat(g);this.isNaN(b)||(a.pop(),a.push((b/100).toString()))}}else u=(this.parseFloat(u)/100).toString()}u&&a.push(u)}break;case this.parser.tokenAdd:this.getValArithmetic(a,"add",n),o=o+1;break;case this.parser.tokenSubtract:this.getValArithmetic(a,"sub",n),o=o+1;break;case this.parser.tokenMultiply:this.getValArithmetic(a,"mul",n),o=o+1;break;case this.parser.tokenDivide:this.getValArithmetic(a,"div",n),o=o+1;break;case this.parser.tokenLess:this.processLogical(a,"less"),o=o+1;break;case this.parser.tokenGreater:this.processLogical(a,"greater"),o=o+1;break;case this.parser.tokenGreaterEq:this.processLogical(a,"greaterEq"),o=o+1;break;case this.parser.tokenLessEq:this.processLogical(a,"lessEq"),o=o+1;break;case this.parser.tokenNotEqual:this.processLogical(a,"notEq"),o=o+1;break;case this.parser.tokenOr:this.processLogical(a,"or"),o=o+1;break;case this.parser.tokenAnd:this.processLogical(a,"and"),o=o+1;break;case this.parser.tokenEqual:this.processLogical(a,"equal"),o=o+1;break;default:return this.getErrorStrings()[W.value]}}}if(a.length===0)return this.emptyString;for(var u=this.emptyString,C=a.length;C>0;){if(u=a.pop()+u,u===this.emptyString&&this.isCellReference(i)&&this.getTreatEmptyStringAsZero())return"0";C--}return u}catch(x){throw this.getErrorStrings().indexOf(x)>-1||this.formulaErrorStrings.indexOf(x)>-1?x:new rs(this.formulaErrorStrings[Ce.invalid_expression])}},e.prototype.getValArithmetic=function(i,r,n){var a=i.pop();a=a===this.trueValue?"1":a===this.falseValue?"0":a,a=a===this.emptyString?"0":this.getErrorStrings().indexOf(a.toString())<0?this.parseFloat(a+"").toString():a;var o=Number(a);if(isNaN(o)&&!n)throw a===this.getErrorStrings()[W.divzero]?this.getErrorStrings()[W.divzero]:this.getErrorStrings()[W.value];var l=i.pop();if(l=l===this.trueValue?"1":l===this.falseValue?"0":l,l=l===this.emptyString?"0":this.getErrorStrings().indexOf(l.toString())<0?this.parseFloat(l+"").toString():l,o=Number(l),isNaN(o)&&!n)throw a===this.getErrorStrings()[W.divzero]?this.getErrorStrings()[W.divzero]:this.getErrorStrings()[W.value];r==="add"&&i.push((Number(l)+Number(a)).toString()),r==="sub"&&i.push((Number(l)-Number(a)).toString()),r==="mul"&&i.push((Number(l)*Number(a)).toString()),r==="div"&&(this.isNaN(this.parseFloat(a))||this.isNaN(this.parseFloat(l))?i.push(this.getErrorStrings()[W.value]):this.parseFloat(a)===0?i.push(this.getErrorStrings()[W.divzero]):i.push((Number(l)/Number(a)).toString()))},e.prototype.processLogical=function(i,r){var n,a,o,l,h;r!=="and"&&r!=="equal"&&(n=i.pop(),a=i.pop(),this.isNaN(this.parseFloat(n))&&this.isNaN(this.parseFloat(a))&&(n=n.toString().toLowerCase(),a=a.toString().toLowerCase()),m(n)||(o=n.indexOf(this.tic)>-1?n:this.parseFloat(n)),m(a)||(l=a.indexOf(this.tic)>-1?a:this.parseFloat(a)),n==="*"&&this.isNaN(this.parseFloat(a))&&a!==""&&(h=!0));var u;return r==="less"&&(!this.isNaN(o)&&!this.isNaN(l)?u=l<o?this.trueValue:this.falseValue:u=a.toUpperCase().split(this.tic).join("").localeCompare(n.toUpperCase().split(this.tic).join(""))<0?this.trueValue:this.falseValue),r==="greater"&&(!this.isNaN(o)&&!this.isNaN(l)?u=l>o?this.trueValue:this.falseValue:u=a.toUpperCase().split(this.tic).join("").localeCompare(n.toUpperCase().split(this.tic).join(""))>0?this.trueValue:this.falseValue),r==="lessEq"&&(!this.isNaN(o)&&!this.isNaN(l)?u=l<=o?this.trueValue:this.falseValue:u=a.toUpperCase().split(this.tic).join("").localeCompare(n.toUpperCase().split(this.tic).join(""))<=0?this.trueValue:this.falseValue),r==="greaterEq"&&(!this.isNaN(o)&&!this.isNaN(l)?u=l>=o?this.trueValue:this.falseValue:u=a.toUpperCase().split(this.tic).join("").localeCompare(n.toUpperCase().split(this.tic).join(""))>=0?this.trueValue:this.falseValue),r==="notEq"&&(u=a!==n?this.trueValue:this.falseValue,h&&(u=this.falseValue)),r==="and"&&(n=i.pop().toString(),a="",i.length>0&&(a=i.pop().toString()),u=this.emptyString+a+n+this.emptyString,u=u.split(this.tic).join("")),r==="equal"&&(n=i.pop(),a=i.pop(),this.isNaN(this.parseFloat(n))&&this.isNaN(this.parseFloat(a))&&(n=n.toString().toLowerCase(),a=a.toString().toLowerCase()),n==="*"&&this.isNaN(this.parseFloat(a))&&a!==""&&(h=!0),u=n===a||h?this.trueValue:this.falseValue),r==="or"&&(u=Math.pow(this.parseFloat(l),this.parseFloat(o)).toString(),u=this.isNaN(this.parseFloat(u))?this.getErrorStrings()[W.value]:u),i.push(u),u},e.prototype.computeStoreCells=function(i){for(var r=i.cellValue,n=i.cellRange,a=i.criteria,o=i.argArray,l=i.isCriteria,h=i.storedCells,u=i.isCountIfS===this.trueValue,c=i.countVal||0,d=l===this.trueValue?h:r,p=[],f,v=0;v<d.length;v++){var g=[],b=this.getValueFromArg(r[v]),y=o[u?1+c*2:2+c],C=y.startsWith(this.tic)&&y.endsWith(this.tic);f=y.trim().split(this.tic).join(this.emptyString);var x=f.includes("*"),w=f==="*"||f==="<>*",M=x&&!w?f.replace(/\*/g,"").trim():f,E=!1;if(!C&&this.isCellReference(M)&&(M=this.getValueFromArg(M),E=!0),x&&!w){var T=f.indexOf("*");f[0]==="*"&&(M="*"+M),f[f.length-1]==="*"&&(M+="*"),T>0&&T<f.length-1&&(M=f.substring(0,T)+"*"+f.substring(T+1))}f=M;var D="";if(l=u?this.trueValue:l,l===this.trueValue){var N="",A=0,L=0,k=void 0,O=void 0,R=void 0,j=void 0;h[v]=u&&!c?r[v]:h[v],N=h[v],c&&(k=n[c-1],O=k.indexOf("!")>-1?ee(k.substring(k.lastIndexOf("!")+1)):ee(k),R=N.indexOf("!")>-1?xe(N.substring(N.lastIndexOf("!")+1)):xe(N),j=n[c].indexOf("!")>-1?ee(n[c].substring(n[c].lastIndexOf("!")+1)):ee(n[c]));var P=N.indexOf("!")>-1,F=void 0,z="",q="";for(P&&(q=N.substring(0,N.lastIndexOf("!")+1),N=N.substring(N.lastIndexOf("!")+1));!this.isDigit(N[A]);)A=A+1;if(this.isCellReference(n[c])&&n[c].indexOf(":")>-1)for(D=u&&!c?d[v].indexOf("!")>-1?d[v].substring(d[v].lastIndexOf("!")+1):d[v]:Je(j[0]+(R[0]-O[0]),j[1]+(R[1]-O[1])),F=n[c].indexOf("!")>-1,F&&(z=n[c].substring(0,n[c].lastIndexOf("!")+1));!this.isDigit(D[L]);)L=L+1;var X=this.substring(N,A),G=this.substring(D,L),Z=this.substring(N,A,N.length-A),se=this.substring(D,L,D.length-A);P&&(X=q+X,G=q+G),Z!==se&&(h[v]=this.substring(h[v],P?q.length+A:A)+se),D=h[v].split(X).join(G),F?(D.indexOf("!")>-1&&(D=D.substring(D.lastIndexOf("!")+1)),D=z+D):D=D.substring(D.lastIndexOf("!")+1),b=this.getValueFromArg(D),f=u?f:a[c-1].split(this.tic).join(this.emptyString)}var oe="equal";f.startsWith("<=")?(oe="lessEq",f=f.substring(2)):f.startsWith(">=")?(oe="greaterEq",f=f.substring(2)):f.startsWith("<>")?(oe="notEq",f=f.substring(2)):f.startsWith("<")?(oe="less",f=f.substring(1)):f.startsWith(">")?(oe="greater",f=f.substring(1)):f.startsWith("=")&&(oe="equal",f=f.substring(1)),(!C&&this.isCellReference(f)&&(!E||D!==""&&!u)||f.includes(this.arithMarker))&&(f=this.getValueFromArg(f)),(f.indexOf("*")>-1||f.indexOf("?")>-1)&&(b=this.findWildCardValue(f.toLowerCase(),b.toLowerCase())),g.push(b.toLowerCase()),g.push(f.toLowerCase()),this.processLogical(g,oe)===this.trueValue&&(l===this.falseValue?p.push(r[v]):p.push(D))}return h=p,p=[],h},e.prototype.computeIfsFormulas=function(i,r,n){if(r===this.trueValue&&(m(i)||i[0]===""||i.length<2||i.length>127||i.length%2!==0))return this.formulaErrorStrings[Ce.wrong_number_arguments];for(var a=i,o=[],l=[],h=[],u=0,c=0,d=0;d<a.length;d++)a[d].indexOf(":")>-1&&this.isCellReference(a[d])?o.push(a[d].trim()):l.push(a[d].trim());o=o.toString().split(",,").join(","),o=o.split(this.getParseArgumentSeparator());for(var p=[],d=0;d<o.length;d++)p.push(this.getCellCollection(o[d]).length);for(var f=0;f<p.length;f++)if(p[f]&&p[f+1]&&p[f]!==p[f+1])return this.getErrorStrings()[W.value];for(var v=0;v<l.length;v++)if(l[v]==="")return n===this.trueValue?this.getErrorStrings()[W.divzero]:0;var g,b;if(r===this.falseValue){b=this.falseValue,g=this.getCellCollection(o[1]);var y={cellValue:g,cellRange:o,criteria:l,argArray:a,isCriteria:b,storedCells:h,isCountIfS:r};if(h=this.computeStoreCells(y),u=h.length,u===0)return n===this.trueValue?this.getErrorStrings()[W.divzero]:0}for(var C=r===this.trueValue?0:2,d=C;d<o.length;d++){b=this.trueValue,b=r===this.trueValue&&d===0?this.falseValue:this.trueValue,g=this.getCellCollection(o[d]);var y={cellValue:g,cellRange:o,criteria:l,argArray:a,isCriteria:b,storedCells:h,isCountIfS:r,countVal:d};if(h=this.computeStoreCells(y),u=h.length,u===0)return n===this.trueValue?this.getErrorStrings()[W.divzero]:0}for(var x=0,w=o[0].indexOf("!")>-1?ee(o[0].substring(o[0].lastIndexOf("!")+1)):ee(o[0]),M=o[o.length-1],E=M.indexOf("!")>-1?ee(M.substring(M.lastIndexOf("!")+1)):ee(M),f=0;f<h.length;f++){var T="",D="",N=0,A=0;T=h[f];var L=T.indexOf("!")>-1,k=void 0,O="",R="";for(L&&(R=T.substring(0,T.lastIndexOf("!")+1),T=T.substring(T.lastIndexOf("!")+1));!this.isDigit(T[N]);)N=N+1;if(this.isCellReference(o[0])&&o[0].indexOf(":")>-1)for(D=Je(w[0]+(xe(T)[0]-E[0]),w[1]+(xe(T)[1]-E[1])),k=o[0].indexOf("!")>-1,k&&(O=o[0].substring(0,o[0].lastIndexOf("!")+1));!this.isDigit(D[A]);)A=A+1;var j=this.substring(T,N),P=this.substring(D,A),F=this.substring(T,N,T.length-N),z=this.substring(D,A,D.length-N);if(L&&(j=R+j,P=R+P),F!==z&&(h[f]=this.substring(h[f],L?R.length+N:N)+z),g=h[f].split(j).join(P),k?(g.indexOf("!")>-1&&(g=g.substring(g.lastIndexOf("!")+1)),g=O+g):g=g.substring(g.lastIndexOf("!")+1),r===this.trueValue)c=c+1;else{var q=this.getValueFromArg(g),X=parseFloat(q===""&&n!==this.trueValue?"0":q);He(X)&&(x++,c=c+X)}}return n===this.trueValue&&(c=c/x),c},e.prototype.processNestedFormula=function(i,r,n){if(n&&!n.toString().includes('"')){var a=i.indexOf(r)+r.length;if(i[a]==='"'&&this.getErrorStrings().indexOf(n.toString())<0&&!He(n)&&n!==this.trueValue&&n!==this.falseValue)return i.split(r).join('"'+n+'"')}return i.split(r).join("n"+n)},e.prototype.isNaN=function(i){return i.toString()==="NaN"||typeof i=="string"},e.prototype.isNumber=function(i){return i-parseFloat(i)>=0},e.prototype.fromOADate=function(i){i=i>0&&i<1?1+i:i===0?1:i,i>60&&(i-=1);var r=new Date("01/01/1900"),n=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());return new Date(new Date((i-1)*this.millisecondsOfaDay+n).toUTCString().replace(" GMT",""))},e.prototype.getSerialDateFromDate=function(i,r,n){var a=0;i<1900&&(i+=1900);for(var o=!1;!o;){for(;r>12;)i++,r-=12;for(;r<1;)r+=12,i--;o=!0;for(var l=new Date(i,r,1,-1).getDate();n>l;)l=new Date(i,r,1,-1).getDate(),r++,n-=l,o=!1;n<1&&(r--,r<1&&(r=12,i--),l=new Date(i,r,1,-1).getDate(),n=l+n,o=!1)}var h=Date.parse(i.toString()+this.getParseDateTimeSeparator()+r.toString()+this.getParseDateTimeSeparator()+n.toString());return this.isNaN(h)||(a=this.toOADate(new Date(h))),a},e.prototype.intToTime=function(i){if(m(i))return"";var r=i.toString().split(".");m(r[1])||(i=parseFloat(r[0]+1+"."+r[1])||i);var n=this.intToDate(i.toString()),a=new _t;return a.formatDate(n,{type:"time",skeleton:"medium",format:"h:mm:ss a"})},e.prototype.toOADate=function(i,r,n){var a=new Date("01/01/1900"),o=Mc(i)?i:new Date(i),l=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),h=Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds()),u=(h-l)/(1e3*3600*24);return(r?u:parseInt(u.toString(),10))+(n?0:u>60?2:1)},e.prototype.calculateDate=function(i){return this.parseFloat(i)<10?"0"+i:i},e.prototype.isTextEmpty=function(i){return i===null||i===""},e.prototype.isDigit=function(i){var r=i.charCodeAt(0);return r>47&&r<58},e.prototype.findLastIndexOfq=function(i){for(var r=i.lastIndexOf("q"),n=i.lastIndexOf(this.leftBracket);n<r;)r=i.substring(0,r).lastIndexOf("q");return r},e.prototype.getValueFromArg=function(i,r,n,a){i=i.trim();var o=i,l=this.dateTime1900,h=o;if(m(o)||this.isTextEmpty(o))return o;if(i[0]===this.tic||i[0]===this.singleTic)return l=this.isDate(i.split(this.tic).join("")),this.isNaN(this.parseFloat(i.split(this.tic).join("")))&&!m(l)&&!this.isNaN(l.getDate())&&this.dateTime1900<=l?this.toOADate(l,!0).toString():i;if(i=i.split("u").join("-"),!this.isUpperChar(o[0])&&(this.isDigit(o[0])||o[0]===this.getParseDecimalSeparator()||o[0]==="-"||o[0]==="n"))return o[0]==="n"&&(o=o.substring(1),o.indexOf('"n')>-1&&(o=o.replace('"n','"'))),o;var u=["+","-","/","*",")",")","{"];if(this.parser.indexOfAny(o,u)===-1&&this.isUpperChar(o[0])||o[0]===this.sheetToken){if(o!==this.trueValue&&o!==this.falseValue&&this.isCellReference(o)){var c=this.getSheetFamilyItem(this.grid);if(c.sheetNameToParentObject!==null&&c.sheetNameToParentObject.size>0&&o.indexOf(this.sheetToken)===-1){var d=c.parentObjectToToken.get(this.grid);o=d+o}}if(o===this.cell){var p=this.getDependentCells().get(o);if(p!=null&&p.indexOf(o)>-1&&this.arrayRemove(p,o),this.getDependentFormulaCells().has(this.cell)||this.clearFormulaDependentCells(this.cell),!r)throw this.formulaErrorStrings[Ce.circular_reference]+o}return h=this.getParentObjectCellValue(o,!1,r,a),this.updateDependentCell(o),h.toString()}return this.getErrorStrings().indexOf(i)>-1?i:this.computeValue(h.toString(),!1,n)},e.prototype.isDate=function(i){if(typeof i=="object"||Date.parse(i)!==null){var r=new Date(Date.parse(i));return r>=this.dateTime1900?r:null}else return null},e.prototype.isValidCellReference=function(i){var r=0,n=0,a=0,o=[89,71,69],l=this.emptyString;if(this.namedRanges.has(i))return!1;for(var h=0;h<i.length;h++)this.isChar(i[h])&&n++;if(l=i.substring(r,n),l.length<4){for(;a<l.length;)if(!m(l[a])&&l[a].charCodeAt(0)<o[a]){a++;continue}else{if(m(l[a])&&a>0)break;return!1}var u=this.parseFloat(i.substring(n,i.length));if(u<1048576)return!0}return!1},e.prototype.parseDate=function(i){if(!this.isNaN(i)){if(i instanceof Date)return new Date(i);var r=parseInt(i,10);return r<0?this.getErrorStrings()[W.num]:r<=60?new Date(this.dateTime1900.getTime()+(r-1)*864e5):new Date(this.dateTime1900.getTime()+(r-2)*864e5)}return typeof i=="string"&&(i=new Date(i),!this.isNaN(i))?i:this.getErrorStrings()[W.value]},e.prototype.isCellReference=function(i){if(i=i.trim(),i===this.emptyString)return!1;i=this.setTokensForSheets(i);var r=this.getSheetToken(i),n=!1;r!==""&&(i=i.split(r).join(this.emptyString));var a=!1,o=!1;if(i.indexOf(":")!==i.lastIndexOf(":"))return!1;for(var l=i.split("").join(this.getParseArgumentSeparator()).split(this.getParseArgumentSeparator()),h=0;h<l.length;h++)if(this.isChar(l[h]))a=!0;else if(this.isDigit(l[h]))o=!0;else if(l[h]===":")a&&o&&(n=!0),a=!1,o=!1;else return!1;return i.indexOf(":")>-1&&i.indexOf(this.tic)===-1?n&&a&&o?!0:!!((a&&!o||!a&&o)&&!n):!!(a&&o&&i.indexOf(this.tic)===-1&&this.isValidCell(i))},e.prototype.setTokensForSheets=function(i){var r=this.getSheetFamilyItem(this.grid),n=this.getSortedSheetNames();if(n!=null)for(var a=0;a<n.length;a++){var o=r.sheetNameToToken.get(n[a]);o=o.split(this.sheetToken).join(this.tempSheetPlaceHolder);var l=this.singleTic+"SHEET"+n[a]+this.singleTic+this.sheetToken;i.indexOf(l)===-1&&(l="SHEET"+n[a]+this.sheetToken),i=i.split(l).join(o),l=n[a]+this.sheetToken,i=i.split(l).join(o)}if(i=i.split(this.tempSheetPlaceHolder).join(this.sheetToken),i.indexOf("!!")>-1){i=i.replace("!!","!");var h=i.split("");h[1]=(parseInt(h[1],10)+1).toString(),i=h.join("")}return i},e.prototype.getParentObjectCellValue=function(i,r,n,a){if(i===this.trueValue||i===this.falseValue)return i;var o=i.lastIndexOf(this.sheetToken),l=0,h=0,u=this.grid,c=this.getSheetFamilyItem(u);if(o>-1&&c.tokenToParentObject!==null)this.grid=c.tokenToParentObject.get(i.substring(0,o+1)),l=this.rowIndex(i),h=this.colIndex(i);else if(o===-1){for(var d=0;d<i.length&&this.isChar(i[d]);)d++;if(d===i.length||!this.isValidCell(i))return i=i.toLowerCase(),i===""?this.getErrorStrings()[W.value]:this.getErrorStrings()[W.name];l=this.rowIndex(i),h=this.colIndex(i),c.isSheetMember&&c.parentObjectToToken!=null&&(i=c.parentObjectToToken.get(this.grid)+i)}var p=this.cell===""||this.cell===null?"":this.cell;if(this.cell=i,p===this.cell&&!n)throw this.formulaErrorStrings[Ce.circular_reference];var f=this.getParentCellValue(l,h,this.grid,p,u,r,n,a);return this.grid=u,this.cell=p,f},e.prototype.getParentCellValue=function(i,r,n,a,o,l,h,u){var c,d=this.getSheetId(n);if(this.parentObject.getValueRowCol===void 0)c=this.getValueRowCol(d,i,r);else return a&&(a=o===n?"":a+","+(o&&typeof o=="string"&&Number(o)>-1?o:this.getSheetID(o))),c=this.parentObject.getValueRowCol(d,i,r,a,l,h,u),m(c)?this.emptyString:c.toString();return(c===""||c===void 0)&&(c=""),c},e.prototype.isValidCell=function(i){var r=i.search(/\d/);if(r===0){var n=i.search(/[a-zA-Z]/);i=i.substring(n,i.length)+i.substring(0,n)}var a=this.rowIndex(i),o=this.colIndex(i);return a>0&&a<=1048576&&o>0&&o<=16384},e.prototype.getSheetId=function(i){return i&&typeof i=="string"&&Number(i)>-1?Number(i):this.getSheetID(i)+1},e.prototype.getValueRowCol=function(i,r,n){var a=this.rowsToKeyMap.get(r).toString(),o=this.getKeyValue(a).toString();if(o!=null&&o[o.length-1]==="%"&&o.length>1){var l=this.parseFloat(o.substring(0,o.length-1));this.isNaN(l)&&(o=(Number(l)/100).toString())}return o},e.prototype.defineFunction=function(i,r,n){typeof r=="string"&&(r=ie(r,window)),i=i.toUpperCase(),this.libraryFormulas.set(i,{handler:r,isCustom:!0,description:n})},e.prototype.valueChanged=function(i,r,n,a,o,l,h,u){var c=i;this.spreadSheetUsedRange=a,this.grid=i;var d=!0,p=!0,f=this.getSheetFamilyItem(c),v=Ft(r.getColIndex())+r.getRowIndex().toString();if(this.actCell=l+"!"+v,f.sheetNameToParentObject!==null&&f.sheetNameToParentObject.size>0){var g=f.parentObjectToToken.get(c);v=g+v}var b=r.getValue().toUpperCase();if(b.indexOf("=RAND()")>-1||b.indexOf("=NOW()")>-1||b.indexOf("NOW()")>-1||b.indexOf("RAND()")>-1||b.indexOf("=RANDBETWEEN(")>-1||b.indexOf("RANDBETWEEN(")>-1||this.randomValues.has(v)){var y=this.randCollection.toString();this.randomValues.has(v)?this.randomValues.has(v)&&(b.indexOf("=RAND()")>-1||b.indexOf("=NOW()")>-1||b.indexOf("NOW()")>-1||b.indexOf("RAND()")>-1||b.indexOf("=RANDBETWEEN(")>-1||b.indexOf("RANDBETWEEN(")>-1?this.randomValues.set(v,r.getValue()):r.getValue().toUpperCase()!==this.randomValues.get(v.toUpperCase())&&(this.randomValues.delete(v),y=y.split(v+this.parseArgumentSeparator).join("").split(this.parseArgumentSeparator+v).join("").split(v).join(""),this.randCollection=y.split(this.parseArgumentSeparator)),this.randomValues.size===0&&this.randCollection.length&&(this.isRandomVal=!1,this.randomValues.clear(),this.randCollection=[])):(this.randomValues.set(v,r.getValue()),this.randCollection.push(v),this.isRandomVal=!0)}if(r.getValue()&&r.getValue()[0]===this.getFormulaCharacter()){this.cell=v;var C=void 0;if(m(p)||(p=n),this.getFormulaInfoTable().has(v)){if(C=this.getFormulaInfoTable().get(v),r.getValue()!==C.getFormulaText()||C.getParsedFormula()==null){C.setFormulaText(r.getValue()),this.getDependentFormulaCells().has(this.cell)&&this.clearFormulaDependentCells(this.cell);try{C.setParsedFormula(this.parser.parseFormula(r.getValue()))}catch(w){C.setFormulaValue(w),p=!1}}if(p){this.parser.isFormulaParsed=!0;var x=this.calculateFormula(C.getParsedFormula(),o);d=x!==C.getFormulaValue(),C.setFormulaValue(x)}}else{C=new zA,C.setFormulaText(r.getValue()),this.getDependentFormulaCells().has(v)||this.getDependentFormulaCells().set(v,new Map);try{C.setParsedFormula(this.parser.parseFormula(r.getValue()))}catch(w){C.setFormulaValue(w),p=!1}p&&C.setFormulaValue(this.calculateFormula(C.getParsedFormula(),o)),this.getFormulaInfoTable().has(v)?this.getFormulaInfoTable().set(v,C):this.getFormulaInfoTable().set(v,C)}p&&(this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(c)+1,C.getFormulaValue(),r.getRowIndex(),r.getColIndex()):this.parentObject.setValueRowCol(this.getSheetId(c),C.getFormulaValue(),r.getRowIndex(),r.getColIndex(),C.getFormulaText(),h))}else this.getFormulaInfoTable().has(v)&&(this.getFormulaInfoTable().delete(v),this.getDependentFormulaCells().has(v)&&this.clearFormulaDependentCells(v));p&&d&&this.getDependentCells().has(v)&&this.getDependentCells().get(v).toString()!==v&&this.refresh(v,void 0,void 0,u)},e.prototype.setValueRowCol=function(i,r,n,a){},e.prototype.getSortedSheetNames=function(){var i=this.getSheetFamilyItem(this.grid);if(i!=null&&i.sheetNameToToken!=null){var r=[];i.sheetNameToToken.forEach(function(n,a){r.push(a),r.sort()}),this.sortedSheetNames=r,this.sortedSheetNames.sort(),this.sortedSheetNames.length>9&&this.sortedSheetNames[0].includes("1")&&this.sortedSheetNames[1].includes("10")&&(this.sortedSheetNames.splice(this.sortedSheetNames.indexOf("2"),0,this.sortedSheetNames[0]),this.sortedSheetNames.splice(0,1))}return this.sortedSheetNames},e.prototype.getErrorLine=function(i){var r=i.stack?i.stack.split(`
`)[1].split(":"):null;return r?r[r.length-2]:null},e.prototype.createSheetFamilyID=function(){return this.sheetFamilyID===Number.MAX_SAFE_INTEGER&&(this.sheetFamilyID=Number.MIN_SAFE_INTEGER),this.sheetFamilyID++},e.prototype.computeMinMax=function(i,r){var n,a,o=!1;if(i.length&&i[i.length-1]==="isSubtotal"&&(o=!0,i.pop()),m(i)||i.length===0)return this.formulaErrorStrings[Ce.wrong_number_arguments];n=r==="max"?this.minValue:this.maxValue;for(var l=0,h=i.length;l<h;l++)i[l].split(this.tic).join("").trim()===this.emptyString&&(n=0);var u=i;if(u.length>255)return this.getErrorStrings()[W.value];for(var c=0;c<u.length;c++)if(u[c].indexOf(":")>-1&&this.isCellReference(u[c])){for(var d=this.getCellCollection(u[c]),p=0;p<d.length;p++)if(a=o?this.getValueFromArg(d[p],null,null,!0):this.getValueFromArg(d[p]),!(o&&a.includes("SUBTOTAL("))){var f=this.parseFloat(a);a===""||this.isNaN(this.parseFloat(f))||this.getErrorStrings().indexOf(a)>-1||(n=r==="max"?Math.max(n,f):Math.min(n,f))}}else{var v=o?this.getValueFromArg(u[c],null,null,!0):this.getValueFromArg(u[c]);if(o&&v.includes("SUBTOTAL("))continue;var f=0,g=this.isCellReference(u[c]),b=v===""&&g,y=this.isNaN(this.parseFloat(v))&&g,C=v===(this.trueValue||this.falseValue)&&g;if(u[c]=u[c].startsWith("n")?u[c].slice(1):u[c],this.getErrorStrings().indexOf(v)>-1)return v;if(v===this.trueValue&&u[c]===this.trueValue)v="1";else if(v===this.falseValue&&u[c]===this.falseValue)v="0";else if(b||y||C)continue;if(v.indexOf('"')>-1&&(v=v.split(this.tic).join("")),this.isNaN(this.parseFloat(v)))return this.getErrorStrings()[W.value];f=this.parseFloat(v),n=r==="max"?Math.max(n,f):Math.min(n,f)}return(n===this.minValue||n===this.maxValue)&&(n=0),n.toString()},e.prototype.calculateAvg=function(i,r){for(var n=i,a=[],o,l,h=0,u=0,c=0;c<n.length;c++)if(this.isCellReference(n[c]))if(n[c].indexOf(":")>-1){a=this.getCellCollection(n[c]);for(var d=0;d<a.length;d++)if(o=r?this.getValueFromArg(a[d],null,null,!0):this.getValueFromArg(a[d]),!(r&&o.includes("SUBTOTAL("))){if(this.getErrorStrings().indexOf(o)>-1)return o;if(m(o)||isNaN(this.parseFloat(o))||o==="")continue;h=h+this.parseFloat(o),u=u+1}}else{if(o=r?this.getValueFromArg(n[c],null,null,!0):this.getValueFromArg(n[c]),r&&o.includes("SUBTOTAL("))continue;if(this.getErrorStrings().indexOf(o)>-1)return o;if(m(o)||isNaN(this.parseFloat(o))||o==="")continue;h=h+this.parseFloat(o),u=u+1}else{if(n[c].indexOf(this.tic)>-1&&(isNaN(this.parseFloat(n[c].split(this.tic).join("")))||n[c].split(this.tic).join("").trim()===""))return this.getErrorStrings()[W.value];(n[c].length===0||i[c]===this.falseValue)&&(n[c]="0"),i[c]===this.trueValue&&(n[c]="1"),l=this.getValueFromArg(n[c].split(this.tic).join("")),h=h+this.parseFloat(l),u=u+1}return u===0?this.getErrorStrings()[W.divzero]:(h/u).toString()},e.prototype.registerGridAsSheet=function(i,r,n){m(this.modelToSheetID)&&(this.modelToSheetID=new Map),m(this.modelToSheetID.get(r))&&this.modelToSheetID.set(r,n);var a=this.getSheetFamilyItem(r);a.isSheetMember=!0;var o=i.toUpperCase();if(a.parentObjectToToken.size===0&&(a.parentObjectToToken=new Map),a.sheetNameToParentObject.size===0&&(a.sheetNameToParentObject=new Map),a.sheetNameToToken.size===0&&(a.sheetNameToToken=new Map),a.tokenToParentObject.size===0&&(a.tokenToParentObject=new Map),Re(a.sheetNameToParentObject.get(o))){var l=this.sheetToken+this.tokenCount.toString()+this.sheetToken;this.tokenCount++,a.tokenToParentObject.set(l,r),a.parentObjectToToken.set(r,l),a.sheetNameToToken.set(o,l),a.sheetNameToParentObject.set(o,r)}else{var l=a.sheetNameToToken.get(o);a.tokenToParentObject.set(l,r),a.parentObjectToToken.set(r,l)}return i},e.prototype.unregisterGridAsSheet=function(i,r,n){var a=this,o=[r];n&&(o=[],m(this.modelToSheetID)||this.modelToSheetID.forEach(function(l,h){o.push(h)})),o.forEach(function(l){var h=a.getSheetFamilyItem(l),u=(n?l:i).toUpperCase();if(h.sheetNameToParentObject!=null&&h.sheetNameToParentObject.has(u)){h.sheetNameToParentObject.delete(u);var c=h.sheetNameToToken.get(u);h.sheetNameToToken.delete(u),h.tokenToParentObject.delete(c),h.parentObjectToToken.delete(l)}})},e.prototype.computeExpression=function(i,r){var n=this.parser.parseFormula(i),a=this.computeFormula(n,r);return a},e.prototype.isSheetMember=function(){var i=this.getSheetFamilyItem(this.grid);return m(i)?!1:i.isSheetMember},e.prototype.dispose=function(){this.resetKeys(),this.namedRanges.clear(),this.lFormulas.clear()},e.prototype.refreshRandValues=function(i){var r,n,a,o="",l;if(this.randomValues.has(i)){this.randomValues.delete(i);var h=this.randCollection.indexOf(i);h>-1&&this.randCollection.splice(h,1),this.randomValues.size===0&&!this.randCollection.length&&(this.randomValues.clear(),this.randCollection=[])}for(var u=0;u<this.randomValues.size;u++)r=this.rowIndex(this.randCollection[u]),n=this.colIndex(this.randCollection[u]),o=(parseFloat(this.getSheetToken(this.randCollection[u]).split(this.sheetToken).join(""))+1).toString(),l=this.getSheetFamilyItem(o),this.grid=l.sheetNameToParentObject.get(o),a=this.randomValues.get(this.randCollection[u]),a=this.computeFormula(a),this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(this.grid)+1,a,r,n):this.parentObject.setValueRowCol(this.getSheetId(this.grid),a,r,n)},e.prototype.refresh=function(i,r,n,a){var o=this,l;if(n||(l=!0,n=[]),this.getDependentCells().has(i)){var h=this.getSheetFamilyItem(this.grid);try{var u=this.getDependentCells().get(i),c=void 0;for(c=0;c<u.length;c++){var d=u[c];if(!(r&&d.indexOf(r)>-1||d===i||n.indexOf(d)>-1)){var p=this.getSheetToken(d),f=this.parentObject.sheets,v=this.parentObject.activeSheetIndex;if(p.length){this.grid=h.tokenToParentObject.get(p);var g=Number(this.grid),b="";if(!this.isNaN(g)&&f)for(var y=0;y<f.length;y++)f[y].id===g&&(b=f[y].name,v=y);this.actCell=b+"!"+d.split(p)[1]}else this.actCell=d.split(p)[1];try{var C=function(R,j){j&&(o.cell=R,o.parser.isFormulaParsed=!0,j.setFormulaValue(o.calculateFormula(j.getParsedFormula(),!0)))},x=this.rowIndex(d),w=this.colIndex(d),M=this.getFormulaInfoTable().get(d);if(this.parentObject.setValueRowCol===void 0)C(d,M),this.setValueRowCol(this.getSheetID(this.grid)+1,M.getFormulaValue(),x,w);else{var E=f&&f[v].rows&&f[v].rows[x-1]&&f[v].rows[x-1].cells&&f[v].rows[x-1].cells[w-1],T=void 0;if(E&&E.formula&&E.formula.toLowerCase().includes("unique"))if(!this.uniqueCells||this.uniqueCells.indexOf(d)===-1)this.uniqueCells||(this.uniqueCells=[]),this.uniqueCells.push(d),C(d,M),T=M.getFormulaValue(),this.uniqueCells.splice(this.uniqueCells.indexOf(d),1),this.uniqueCells.length||(this.uniqueCells=null);else continue;else n.indexOf(d)===-1&&n.push(d),T=null;this.parentObject.setValueRowCol(this.getSheetId(this.grid),T,x,w,M.getFormulaText())}this.refresh(d,null,n)}catch{continue}}}if(l){var D,N,A,L,k,O=this.parentObject.sheets;O||(n=[]),n.forEach(function(R){D=o.getSheetId(h.tokenToParentObject.get(o.getSheetToken(R)));for(var j=0;j<O.length;j++)if(O[j].id===D){N=j;break}A=o.rowIndex(R)-1,L=o.colIndex(R)-1,k=O[N].rows[A]&&O[N].rows[A].cells[L],k&&o.parentObject.notify("calculateFormula",{cell:k,rowIdx:A,colIdx:L,sheetIndex:N,isDependentRefresh:!0,isRandomFormula:a})})}}finally{this.grid=h.tokenToParentObject.get(this.getSheetToken(i))}}};var t;return jC([S(!0)],e.prototype,"includeBasicFormulas",void 0),jC([_()],e.prototype,"onFailure",void 0),e=t=jC([Ot],e),e}(Xo),rs=function(){function s(e,t){this.formulaCorrection=!1,this.message=e,this.formulaCorrection=t}return s}(),zA=function(){function s(){this.calcID=Number.MIN_VALUE+1,this.calcID1=Number.MIN_VALUE+1}return s.prototype.getFormulaText=function(){return this.formulaText},s.prototype.setFormulaText=function(e){this.formulaText=e},s.prototype.getFormulaValue=function(){return this.formulaValue},s.prototype.setFormulaValue=function(e){this.formulaValue=e},s.prototype.getParsedFormula=function(){return this.parsedFormula},s.prototype.setParsedFormula=function(e){this.parsedFormula=e},s}(),jA=function(){function s(){this.isSheetMember=!1,this.parentObjectToToken=new Map,this.sheetDependentFormulaCells=new Map,this.sheetNameToParentObject=new Map,this.sheetNameToToken=new Map,this.tokenToParentObject=new Map,this.sheetFormulaInfotable=new Map}return s}();function Ft(s){for(var e=[],t=0,i="A";s>0&&t<9;){s--;var r=i.charCodeAt(0);e[t]=String.fromCharCode(s%26+r),s=parseInt((s/26).toString(),10),t++}for(var n=[],a=0;a<t;a++)n[t-a-1]=e[a];return n.join("")}var BA=function(){function s(e,t,i){return this.row=e,this.col=t,this.value=i,this.getRowIndex=function(){return e},this.setRowIndex=function(r){e=r},this.getColIndex=function(){return t},this.setColIndex=function(r){t=r},this.getValue=function(){return i},this}return s}(),OP=function(){function s(e){this.uniqueOBracket="",this.uniqueCBracket="",this.uniqueCSeparator="",this.uniqueCOperator="",this.uniquePOperator="",this.uniqueSOperator="",this.uniqueMOperator="",this.uniqueDOperator="",this.uniqueModOperator="",this.uniqueConcateOperator="",this.uniqueEqualOperator="",this.uniqueExpOperator="",this.uniqueGTOperator="",this.uniqueLTOperator="",this.sheetInfo=[],this.parent=e,this.init()}return s.prototype.init=function(){var e=this;this.addEventListener(),this.initCalculate(),this.registerSheet(),this.parent.customFormulaCollection.forEach(function(t,i){e.addCustomFunction(t.handler,i,t.description)})},s.prototype.destroy=function(){var e=this;if(this.removeEventListener(),this.parent.refreshing){this.clearAllUniqueFormulaValue();var t=this.calculateInstance.getLibraryFormulas();t.forEach(function(i,r){i.isCustom&&e.parent.customFormulaCollection.set(r,{handler:i.handler,description:i.description})})}this.calculateInstance.dispose(),this.calculateInstance=null,this.parent=null},s.prototype.addEventListener=function(){this.parent.on(xt,this.performFormulaOperation,this),this.parent.on(Gp,this.aggregateComputation,this),this.parent.on(i1,this.getUniqueRange,this),this.parent.on(ud,this.removeUniquecol,this),this.parent.on(cd,this.clearFormulaDependentCells,this),this.parent.on(Ay,this.formulaInValidation,this),this.parent.on(ih,this.refreshInsertDelete,this),this.parent.on(Wy,this.getUpdatedFormulaOnInsertDelete,this),this.parent.on(b1,this.autoCorrectCellRef,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(xt,this.performFormulaOperation),this.parent.off(Gp,this.aggregateComputation),this.parent.off(i1,this.getUniqueRange),this.parent.off(ud,this.removeUniquecol),this.parent.off(cd,this.clearFormulaDependentCells),this.parent.off(Ay,this.formulaInValidation),this.parent.off(ih,this.refreshInsertDelete),this.parent.off(Wy,this.getUpdatedFormulaOnInsertDelete),this.parent.on(b1,this.autoCorrectCellRef,this))},s.prototype.getModuleName=function(){return"workbookFormula"},s.prototype.initCalculate=function(){this.calculateInstance=new f6(this.parent),this.calcID=this.calculateInstance.createSheetFamilyID(),this.calculateInstance.setTreatEmptyStringAsZero(!0),this.calculateInstance.grid=this.parent.getActiveSheet().id.toString()},s.prototype.clearFormulaDependentCells=function(e){if(e.isOpen){this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear();return}var t=e.cellRef.split(":")[0],i=this.parent.getActiveSheet().id.toString(),r=this.calculateInstance.getSheetFamilyItem(i);r.isSheetMember&&!m(r.parentObjectToToken)&&(t=r.parentObjectToToken.get(i)+t),this.calculateInstance.clearFormulaDependentCells(t)},s.prototype.formulaInValidation=function(e){var t=this.calculateInstance.getLibraryFormulas().get(e.value);e.skip=m(t)},s.prototype.performFormulaOperation=function(e){var t=e.action,i,r;t!=="refreshCalculate"&&(i=this.calculateInstance.getLibraryFormulas(),r=Array.from(i.values()));var n;switch(t){case"getLibraryFormulas":e.formulaCollection=Array.from(i.keys());break;case"getFormulaCategory":n=["All"];for(var a=1;a<Array.from(i.values()).length;a++)n.indexOf(r[a].category)<0&&n.push(r[a].category);e.categoryCollection=n;break;case"dropDownSelectFormulas":for(var a=0;a<Array.from(i.values()).length;a++)e.selectCategory===r[a].category&&(e.formulaCollection[a]=Array.from(i.keys())[a]);break;case"getFormulaDescription":for(var a=0;a<Array.from(i.values()).length;a++)e.selectedList===Array.from(i.keys())[a]&&(e.description=r[a].description,e.isCustom=r[a].isCustom);break;case"registerSheet":this.registerSheet(e.sheetIndex,e.sheetCount),e.isImport&&this.updateSheetInfo();break;case"unRegisterSheet":this.unRegisterSheet(e.sheetIndex,e.sheetCount,e.propertyChange);break;case"initSheetInfo":this.updateSheetInfo();break;case"refreshCalculate":e.isFormula&&(e.value=this.autoCorrectFormula(e.value,e.rowIndex,e.colIndex,e.sheetIndex),e.isClipboard&&e.value.toString().toUpperCase().includes("UNIQUE")&&(this.parent.sheets[e.sheetIndex].rows[e.rowIndex].cells[e.colIndex].value="")),e.isFormulaDependent=this.refreshCalculate(e.rowIndex,e.colIndex,e.value,e.isFormula,e.sheetIndex,e.isRefreshing,e.isDependentRefresh,e.isRandomFormula),e.value=e.value?e.value.toString().split("^+").join("^").split("&+").join("&"):e.value;break;case"refreshRandomFormula":this.refreshRandomFormula(),this.calculateInstance.cell="";break;case"getArgumentSeparator":e.argumentSeparator=this.calculateInstance.getParseArgumentSeparator();break;case"addDefinedName":e.isAdded=this.addDefinedName(e.definedName,!1,e.index,e.isEventTrigger);break;case"removeDefinedName":e.isRemoved=this.removeDefinedName(e.definedName,e.scope,e.isEventTrigger);break;case"initiateDefinedNames":this.initiateDefinedNames();break;case"renameUpdation":this.renameUpdation(e.value,e.pName);break;case"addSheet":this.sheetInfo.push({visibleName:e.visibleName,sheet:e.sheetName,index:e.sheetId});break;case"getSheetInfo":e.sheetInfo=this.sheetInfo;break;case"deleteSheetTab":for(var a=0;a<this.sheetInfo.length;a++)if(this.sheetInfo[a].index===e.sheetId){var o=this.sheetInfo[a].visibleName,l=this.sheetInfo[a].sheet;this.sheetInfo.splice(a,1);var h=e.sheetId.toString();this.sheetDeletion(l,h),this.calculateInstance.unregisterGridAsSheet(h,h),this.definedNamesDeletion(o);break}break;case"getReferenceError":e.refError=this.referenceError();break;case"getAlpha":e.col=Ft(e.col);break;case"addCustomFunction":this.addCustomFunction(e.functionHandler,e.functionName,e.formulaDescription);break;case"computeExpression":e.calcValue=this.calculateInstance.computeExpression(e.formula,e.isFromComputeExpression);break;case"registerGridInCalc":this.calculateInstance.grid=e.sheetID;break;case"dependentCellsAvailable":case"checkFormulaAdded":var u=this.calculateInstance.getSheetFamilyItem(e.sheetId);u.isSheetMember&&!m(u.parentObjectToToken)&&(e.address=u.parentObjectToToken.get(e.sheetId)+e.address),t==="checkFormulaAdded"?e.added=this.calculateInstance.getFormulaInfoTable().has(e.address):e.isAvailable=this.calculateInstance.getDependentCells().has(e.address);break}},s.prototype.definedNamesDeletion=function(e){var t=this.parent.definedNames;if(t&&t.length>0)for(var i=t.length-1;i>=0;i--)t[i].refersTo.split("=")[1].split("!")[0].split("'").join("")===e&&this.removeDefinedName(t[i].name,t[i].scope)},s.prototype.referenceError=function(){return this.calculateInstance.getErrorStrings()[W.ref]},s.prototype.getSheetInfo=function(){return this.sheetInfo},s.prototype.addCustomFunction=function(e,t,i){this.calculateInstance.defineFunction(t,e,i)},s.prototype.updateSheetInfo=function(){var e=this;this.sheetInfo=[],this.parent.sheets.forEach(function(t){e.sheetInfo.push({visibleName:t.name,sheet:"Sheet"+t.id,index:t.id})})},s.prototype.sheetDeletion=function(e,t){var i=this,r=this.calculateInstance.getDependentCells(),n,a,o,l,h,u=this.calculateInstance.getSheetFamilyItem(t),c=this.calculateInstance.namedRanges,d,p;c&&c.size&&(d=Array.from(c.keys()),p=Array.from(c.values()));var f,v;r.forEach(function(g,b){g.forEach(function(y){if(n=i.calculateInstance.getFormulaInfoTable().get(y),!m(n)){a=n.formulaText;var C=!1;if(!a.includes(e)&&c&&c.size){var x=a.replace(/\w+/g,function(w){var M=d.indexOf(w);return M!==-1?(C=!0,p[M]):w});a=x}f=e.toUpperCase(),a=a.toUpperCase(),v=a.indexOf(f),v>-1&&(a[v-1]==="'"&&a[v+f.length]==="'"&&(f="'"+f+"'"),f+=i.calculateInstance.sheetToken,a=a.split(f).join(i.referenceError()),o=i.calculateInstance.rowIndex(y),l=i.calculateInstance.colIndex(y),h=y.slice(0,y.lastIndexOf(i.calculateInstance.sheetToken)+1),i.updateDataContainer([o-1,l-1],{value:a,visible:!1,isNamedRange:C,sheetId:u.tokenToParentObject.has(h)?Number(u.tokenToParentObject.get(h)):parseInt(y.split("!")[1],10)+1}),i.calculateInstance.refresh(n.getParsedFormula()))}h=b.slice(0,b.lastIndexOf(i.calculateInstance.sheetToken)+1),t===(u.tokenToParentObject.has(h)?u.tokenToParentObject.get(h):b.split("!")[1])&&(i.calculateInstance.getFormulaInfoTable().delete(b),i.calculateInstance.clearFormulaDependentCells(b))})})},s.prototype.renameUpdation=function(e,t){var i=this,r,n,a=t.toUpperCase(),o=new RegExp(`[!@#$%^&()+=';,.{}|\\":<>~_-]`,"g"),l=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,h=RegExp,u=new h(t.replace(o,"\\$&")+l,"gi");this.sheetInfo.forEach(function(c,d){r=Pe(i.parent,d);for(var p=0,f=r.usedRange.rowIndex;p<=f;p++)for(var v=0,g=r.usedRange.colIndex;v<=g;v++)n=Y(p,v,r,!1,!0),n.formula&&Bt(n.formula)&&n.formula.toUpperCase().includes(a)&&n.formula.match(u)&&(n.formula=n.formula.replace(u,e));c.visibleName===t&&(c.visibleName=e)})},s.prototype.updateDataContainer=function(e,t){for(var i,r,n,a=0,o=this.parent.sheets.length;a<o;a++)if(i=Pe(this.parent,a),i.id===t.sheetId){e[0]in i.rows?(r=i.rows[e[0]],e[1]in r.cells?(n=r.cells[e[1]],n.formula=t.isNamedRange?n.formula:t.value,t.visible?a===this.parent.activeSheetIndex&&i.activeCell===Je(e[0],e[1])&&this.parent.notify(Gs,{}):n.value=this.referenceError()):r.cells[e[1]]=n={}):(r=i.rows[e[0]]={},r[e[1]]=n={});break}},s.prototype.parseSheetRef=function(e,t){var i,r=new RegExp(`[!@#$%^&()+=';,.{}|":<>~_-]`,"g"),n=0,a=this.getSheetInfo(),o=a.length,l=[];l.length=0;var h,u,c,d,p,f=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,v=RegExp;for(n=0;n<o;n++)if(a[n].sheet!==a[n].visibleName&&(i=new v(a[n].visibleName.replace(r,"\\$&")+f,"gi"),c=n,e.match(i))){for(var g=n+1;g<o;g++)a[g].visibleName.includes(a[n].visibleName)&&(h=new v(a[g].visibleName.replace(r,"\\$&")+f,"gi"),u=e.search(h),d=e.search(i),u>-1&&(u<d||u===d&&a[g].visibleName.length>a[n].visibleName.length)&&(p=new RegExp("Sheet","gi"),a[g].visibleName.search(p)!==0&&(i=h,c=g)));e=e.replace(i,c+"/"),l.push(c)}n=0;for(var b;n<l.length;)i=new v(l[n]+"/"+f,"gi"),b=t?"`"+a[l[n]].sheet+"`":a[l[n]].sheet,e=e.replace(i,b),n++;return e},s.prototype.registerSheet=function(e,t){e===void 0&&(e=0),t===void 0&&(t=this.parent.sheets.length);for(var i;e<t;)i=Pe(this.parent,e).id+"",this.calculateInstance.registerGridAsSheet(i,i,this.calcID),e++},s.prototype.unRegisterSheet=function(e,t,i){e===void 0&&(e=0),t===void 0&&(t=this.parent.sheets.length);var r;if(this.calculateInstance.tokenCount=0,i)this.calculateInstance.unregisterGridAsSheet(r,r,i);else for(;e<t;)r=Pe(this.parent,e).id+"",this.calculateInstance.unregisterGridAsSheet(r,r),e++},s.prototype.getUniqueRange=function(e){e.range=this.calculateInstance.uniqueRange},s.prototype.removeUniquecol=function(e){if(e&&e.clearAll){this.clearAllUniqueFormulaValue();return}for(var t=this.parent.getActiveSheet(),i=0;i<this.calculateInstance.uniqueRange.length;i++){var r=this.calculateInstance.uniqueRange[i].split(":")[0].split("!");if(r[0]===t.name&&r[1]===t.activeCell){var n=ee(this.calculateInstance.uniqueRange[i]);this.calculateInstance.uniqueRange.splice(i,1);for(var a=n[0];a<=n[2];a++)for(var o=n[1];o<=n[3];o++){var l=Y(a,o,this.parent.getActiveSheet());l.formula="",this.parent.updateCell({value:"",formula:""},je([a,o]))}}}},s.prototype.refreshCalculate=function(e,t,i,r,n,a,o,l){var h=this,u=m(n)?this.parent.getActiveSheet():Pe(this.parent,n),c=u.id+"",d=u.name,p=this.calculateInstance.getSheetFamilyItem(c),f=Ur(t+1)+(e+1);if(p.isSheetMember&&!m(p.parentObjectToToken)&&(f=p.parentObjectToToken.get(c)+f),r){var v=i;i=this.parseSheetRef(i);var g=new BA(e+1,t+1,i),b=[u.usedRange.rowIndex,u.usedRange.colIndex];this.calculateInstance.valueChanged(c,g,!0,b,a,d,l),this.calculateInstance.isRandomVal===!0&&!l&&this.refreshRandomFormula();var y=Y(e,t,u);if(y&&v&&!o){v=v.toString().toUpperCase();var C=void 0;if(v.indexOf("=SUM(")===0?C="=SUM(":v.indexOf("=AVERAGE(")===0?C="=AVERAGE(":v.indexOf("=ROUNDDOWN(")===0?C="=ROUNDDOWN(":v.indexOf("=ROUNDUP(")===0?C="=ROUNDUP(":v.indexOf("=MOD(")===0&&(C="=MOD("),C){if(v=v.replace(C,""),v.includes(")")){v=v.slice(0,v.lastIndexOf(")"));for(var x=void 0,w=void 0;v.includes("(")&&v.includes(")");)w=v.indexOf("("),x=v.slice(w+1),v=v.slice(0,w)+(x.includes(")")?x.slice(x.indexOf(")")+1):x)}for(var M=v.split(this.calculateInstance.getParseArgumentSeparator()),E,T=void 0,D=void 0,N,A=void 0,L,k=void 0,w=0;w<M.length;w++)if(E=M[w].split(":")[0],E.includes("!")?(A=E.split("!"),L=A[0],E=A[1]):L="",ur(E)&&(L?(N=gt(this.parent,L),D=N!==void 0?Pe(this.parent,N):u):D=u,k=ee(E),T=Y(k[0],k[1],D),T&&T.format)){y.format=T.format;break}}else{var O=this.calculateInstance.getDependentFormulaCells().get(f);if(O&&O.size&&this.calculateInstance.getFormulaInfoTable().has(f)&&this.calculateInstance.getFormulaInfoTable().get(f).getParsedFormula().lastIndexOf("q")===-1&&!y.format){var R,j,P,F,z,q,X=this.calculateInstance.getSheetFamilyItem(null,this.calcID);O.forEach(function(G){R||(P=G.slice(0,G.lastIndexOf("!")+1),G=G.replace(P,""),ur(G)&&(q=ee(G),X.tokenToParentObject.has(P)?(z=Qn(h.parent,Number(X.tokenToParentObject.get(P))),F=z!==void 0?Pe(h.parent,z):u):F=u,j=Y(q[0],q[1],F),j&&j.format&&(R=j.format)))}),R&&(y.format=R)}}}}else this.calculateInstance.getFormulaInfoTable().has(f)&&(this.calculateInstance.getFormulaInfoTable().delete(f),this.calculateInstance.clearFormulaDependentCells(f)),this.calculateInstance.refresh(f),this.calculateInstance.refreshRandValues(f);return this.calculateInstance.cell="",this.calculateInstance.getDependentCells().has(f)},s.prototype.refreshRandomFormula=function(){var e,t,i="",r=this.calculateInstance.randCollection;if(this.calculateInstance.randomValues.size>1&&this.calculateInstance.randomValues.size===r.length)for(var n=0;n<this.calculateInstance.randomValues.size;n++){e=this.calculateInstance.rowIndex(r[n]),t=this.calculateInstance.colIndex(r[n]),i=this.calculateInstance.randomValues.get(r[n]);var a=(parseFloat(this.calculateInstance.getSheetToken(r[n]).split(this.calculateInstance.sheetToken).join(""))+1).toString(),o=new BA(e,t,i);this.calculateInstance.valueChanged(a,o,!0,void 0,void 0,void 0,!1,!0)}},s.prototype.autoCorrectFormula=function(e,t,i,r){if(!m(e)){e=this.autoCorrectCellRef({formula:e}),e=e.toString(),e.split("(").length===2&&e.indexOf(")")<0&&(e+=")");var n=void 0;e.indexOf("=")===0&&(e=e.slice(1),n=!0);var a=e.match(/</g),o=e.match(/>/g),l=e.match(/=/g);if(a){for(var h="",u=0;u<a.length;u++)h=h+a[u];e=e.replace(h,"<")}if(o){for(var c="",d=0;d<o.length;d++)c=c+o[d];e=e.replace(c,">")}if(l){for(var p="",f=0;f<l.length;f++)p=p+l[f];e=e.split(p).join("=")}e=n?"="+e:e,(a||o||l)&&(Y(t,i,m(r)?this.parent.getActiveSheet():Pe(this.parent,r)).formula=e)}return e},s.prototype.correctCellReference=function(e){var t=this,i=e.split(":"),r,n,a,o,l;return i.forEach(function(h,u){if(n=h.split("!"),e=n[1]||h,l=null,e.includes("&"))r=e.split("&"),t.calculateInstance.isCellReference(r[1].split("$").join(""))&&(r[1]=t.getUpdatedCellRef(r[1]),l=r.join("&"));else if(t.calculateInstance.isCellReference(e.split("$").join("")))l=t.getUpdatedCellRef(e),n.length>1&&(l=n[0]+"!"+l);else if(a=h.match(/[\/\+\-\*\^\>\<\>=\<=\<>]+/g),a){r=h.split(a[0]);for(var c=0;c<r.length;c++)n=r[c].split("!"),e=n[1]||n[0],t.calculateInstance.isCellReference(e.split("$").join(""))&&(r[c]=t.getUpdatedCellRef(e),n.length>1&&(r[c]=n[0]+"!"+r[c]));l=r.join(a[0])}l&&l!==h&&(o=!0,i[u]=l)}),{isInvalid:o,ref:i.join(":")}},s.prototype.autoCorrectCellRef=function(e){var t=e.formula.lastIndexOf(")"),i;if(t>-1&&e.formula.split(")").length===2){for(var r=t-1;r>-1&&e.formula[r]!=="(";){if(e.formula[r]===")")return e.formula;r--}if(r>-1){for(var n=e.formula.substring(r+1,t),a=n.split(","),o=void 0,l=0;l<a.length;l++)i=this.correctCellReference(a[l]),i.isInvalid&&(o=!0,a[l]=i.ref);o&&(e.formula=e.formula.split(n).join(a.join(",")),e.isInvalid=!0)}}else e.formula.startsWith("=")&&!e.formula.includes(")")&&(i=this.correctCellReference(e.formula.substring(1,e.formula.length)),i.isInvalid&&(e.formula="="+i.ref,e.isInvalid=!0));return e.formula},s.prototype.getUpdatedCellRef=function(e){var t=e;e=e.trim();var i=e.indexOf("$")===0,r=e.search(/[a-zA-Z]/),n=e.search(/\d/);return r=i?r-1:r,(i?n>1:n>0)&&He(e.substring(n,e.length))?t:e.substring(r,e.length)+e.substring(0,r)},s.prototype.initiateDefinedNames=function(){for(var e=this.parent.definedNames,t=0;t<e.length;){var i=e[t],r=this.parseSheetRef(i.refersTo),n=nu(r),a=!1,o=r.indexOf("http:")>-1?!0:r.indexOf("https:")>-1;if(n=n.split("$").join(""),n=n.split("=").join(""),n.indexOf(":")>-1){var l=n.split(":");(ur(l[0])&&ur(l[1])||l[0].match(/[0-9]/)&&l[1].match(/[0-9]/)||l[0].toUpperCase().match(/[A-Z]/)&&l[1].toUpperCase().match(/[A-Z]/))&&(a=!0)}else n.indexOf(":")<0&&ur(n)&&(a=!0);o&&(a=!1),a?this.addDefinedName(i,!0,void 0,!0):(this.removeDefinedName(i.name,i.scope,!0),t--),t++}},s.prototype.addDefinedName=function(e,t,i,r){(i===void 0||i<-1)&&(i=this.parent.definedNames.length);var n=!0,a,o=e.name;if(e.refersTo.indexOf("!")<0){var l=Ns(this.parent);l=l.indexOf(" ")!==-1?"'"+l+"'":l,e.refersTo=l+"!"+(e.refersTo.indexOf("=")<0?e.refersTo:e.refersTo.split("=")[1])}var h=e.refersTo,u=this.parseSheetRef(e.refersTo);e.scope?(a=gt(this.parent,e.scope),a>-1&&(o=Ns(this.parent,a)+"!"+o)):e.scope="",e.comment||(e.comment=""),!t&&this.checkIsNameExist(e.name,e.scope)?n=!1:(this.calculateInstance.addNamedRange(o,u[0]==="="?u.substr(1):u),u[0]!=="="&&(e.refersTo="="+h),this.parent.definedNames.indexOf(e)<0&&this.parent.definedNames.splice(i,0,e));var c={name:e.name,scope:e.scope,comment:e.comment,refersTo:e.refersTo,cancel:!1};return r||this.parent.notify("actionComplete",{eventArgs:c,action:"addDefinedName"}),n},s.prototype.removeDefinedName=function(e,t,i){var r=!1,n=this.getIndexFromNameColl(e,t);if(n>-1){var a=e;if(t){var o=gt(this.parent,t);o&&(a=Ns(this.parent,o)+"!"+e)}if(this.calculateInstance.removeNamedRange(a),this.parent.definedNames.splice(n,1),!i){var l={name:e,scope:t,cancel:!1};this.parent.notify("actionComplete",{eventArgs:l,action:"removeDefinedName"})}r=!0}return r},s.prototype.checkIsNameExist=function(e,t){var i=this.parent.definedNames.some(function(r){return r.name===e&&(t?r.scope===t:r.scope==="")});return i},s.prototype.getIndexFromNameColl=function(e,t){t===void 0&&(t="");var i=-1;return this.parent.definedNames.filter(function(r,n){r.name===e&&r.scope===t&&(i=n)}),i},s.prototype.toFixed=function(e){var t=Number(e);return Math.round(t)!==t&&(e=t.toFixed(2)),e},s.prototype.aggregateComputation=function(e){var t=this.parent.getActiveSheet(),i=z6(t),r=ee(i.split(":")[1]);r[0]+1===t.rowCount&&r[1]+1===t.colCount&&(i="A1:"+Je(t.usedRange.rowIndex,t.usedRange.colIndex));var n,a,o=this.calculateInstance.getCellCollection(i);for(a=0;a<o.length;a++)if(n=this.calculateInstance.getValueFromArg(o[a]),He(n)){e.countOnly=!1;break}if(e.Count=this.calculateInstance.getFunction("COUNTA")(i),!(!e.Count||e.countOnly)){var l=["SUM","AVERAGE","MIN","MAX"],h=[],u=ee(t.activeCell),c=Y(u[0],u[1],t,!1,!0);for(a=0;a<4;a++){if(n=this.toFixed(this.calculateInstance.getFunction(l[a])(i)),c.format){var d={formattedText:n,value:n,format:c.format,cell:{value:n,format:c.format}};this.parent.notify(jn,d),n=d.formattedText}h.push(n)}e.Sum=h[0],e.Avg=h[1],e.Min=h[2],e.Max=h[3]}},s.prototype.refreshInsertDelete=function(e){var t=this,i=this.calculateInstance.getDependentFormulaCells(),r,n=Qn(this.parent,e.sheet.id);this.parent.sheets.forEach(function(a,o){for(var l=0,h=a.usedRange.rowIndex;l<=h;l++)for(var u=0,c=a.usedRange.colIndex;u<=c;u++)r=Y(l,u,a,!1,!0),r.formula&&Bt(r.formula)&&(o===n?(e.isInsert||!(e.modelType==="Row"?l>=e.startIndex&&l<=e.endIndex:u>=e.startIndex&&u<=e.endIndex))&&t.updateFormula(e,r,l,u,n):r.formula.includes(e.sheet.name)&&t.updateFormula(e,r,l,u,n,!0,a))}),i.clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.refreshNamedRange(e)},s.prototype.getUpdatedFormulaOnInsertDelete=function(e){this.updateFormula(e.insertDeleteArgs,e.cell,e.row,e.col,e.sheetIdx)},s.prototype.updateFormula=function(e,t,i,r,n,a,o){var l,h,u,c,d,p,f=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),v,g;t.formula&&t.formula.includes("UNIQUE")&&this.clearUniqueRange(i,r,o||e.sheet);for(var b=function(){return u[0]===u[2]&&u[1]===u[3]?Je(u[0],u[1]):je(u)},y=this.parseFormula(this.parseSheetRef(t.formula,!0),!0),C=this.getSheetInfo(),x,w,M=0;M<y.length;M++)if(l=y[M].trim().replace(/[$]/g,""),v=!0,this.calculateInstance.isCellReference(l)){if(p=l.includes(":"),h=M&&y[M-1].trim(),h&&h[h.length-1]==="!"){if(h=h.replace(/['!]/g,""),x=C[n].sheet===C[n].visibleName?e.sheet.name:"`"+C[n].sheet+"`",h!==x)continue}else if(a)continue;!f.test(l)&&l.indexOf(":")>-1&&(v=!1,g=!!m(l.match(/[0-9]/))),u=ee(l),c=this.parent.updateRangeOnInsertDelete(e,u,p),d=lt(u),c&&(y[M]=d[2]<d[0]||d[3]<d[1]?this.calculateInstance.getErrorStrings()[W.ref]:v?b():g?je(u).replace(/\d/g,""):je(u).replace(/[a-zA-Z]/g,""),w=!0)}var E="="+y.join("");if(w){var T,D=RegExp;C.forEach(function(N){E.includes("`"+N.sheet+"`")&&(T=new D("`"+N.sheet+"`","gi"),E=E.replace(T,N.visibleName))}),t.formula!==E&&(t.formula=E,t.value=null)}},s.prototype.clearUniqueRange=function(e,t,i){var r={cellIdx:[e,t,e,t],isUnique:!1,uniqueRange:"",sheetName:i.name};this.parent.notify(ou,r);for(var n=ee(r.uniqueRange),a=n[0];a<=n[2];a++)for(var o=n[1];o<=n[3];o++)delete Y(a,o,i,!1,!0).value},s.prototype.clearAllUniqueFormulaValue=function(){for(var e=this.calculateInstance.uniqueRange,t,i,r,n,a=0;a<e.length;a++)if(t=e[a].split("!"),r=Pe(this.parent,gt(this.parent,t[0])),n=ee(t[1]),i=Y(n[0],n[1],r),!(i&&i.value==="#SPILL!"))for(var o=n[0];o<=n[2];o++)for(var l=n[1];l<=n[3];l++)i=Y(o,l,r),i&&i.value&&delete i.value},s.prototype.parseFormula=function(e,t){var i,r,n=0,a=[],o=[];o=this.markSpecialChar(e.replace("=",""),t),o=t?o.split(/\(|\)|=|\^|>|<|,|\+|-|\*|\/|%|&/g):o.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g);for(var l=o.length;n<l;){if(i=o[n],!i){n++;continue}i.length===1?a.push(this.isUniqueChar(i)?this.getUniqueCharVal(i):i):(r=i[0],i.indexOf("!")>0?(this.isUniqueChar(r)&&(a.push(this.getUniqueCharVal(r)),i=i.substr(1)),r=i.indexOf("!")+1,a.push(i.substr(0,r)),a.push(i.substr(r))):this.isUniqueChar(r)?(a.push(this.getUniqueCharVal(r)),a.push(i.substr(1))):a.push(i)),n++}return a},s.prototype.getUniqueCharVal=function(e){switch(e){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return",";case this.uniqueCOperator:return":";case this.uniquePOperator:return"+";case this.uniqueSOperator:return"-";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<"}return""},s.prototype.isUniqueChar=function(e){var t=e.charCodeAt(e);return t>=129&&t<=142},s.prototype.markSpecialChar=function(e,t){return e=e.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),t?e=e.replace(/,/g,","+this.uniqueCSeparator):e=e.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),e=e.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),e=e.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),e=e.replace(/&/g,"&"+this.uniqueConcateOperator),e=e.replace(/=/g,"="+this.uniqueEqualOperator),e=e.replace(/\^/g,"^"+this.uniqueExpOperator),e=e.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),e.replace(/%/g,"%"+this.uniqueModOperator)},s.prototype.refreshNamedRange=function(e){var t=this;if(e.definedNames&&e.definedNames.length){e.definedNames.forEach(function(g){t.parent.removeDefinedName(g.name,g.scope),t.parent.addDefinedName(g)});return}var i=this.parent.definedNames.length;if(i)for(var r=Object.assign({},this.parent.definedNames),n,a,o,l,h,u,c,d=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),p,f,v=0;v<i;v++)p=!0,l=r[v],o=l.refersTo.split("!"),a=o[0].split("=")[1],u=a,u.match(/'/g)&&(u=u.slice(1,-1)),u===e.sheet.name&&(!d.test(o[1])&&o[1].indexOf(":")>-1&&(p=!1,f=!!m(o[1].match(/[0-9]/))),n=ee(o[1]),h=this.parent.updateRangeOnInsertDelete(e,n),p?c=je(n):c=f?je(n).replace(/\d/g,""):je(n).replace(/[a-zA-Z]/g,""),e.isInsert?this.updateDefinedNames(l,a,c,h):e.modelType==="Row"?this.updateDefinedNames(l,a,c,h,[n[0],n[2]],e):e.modelType==="Column"&&this.updateDefinedNames(l,a,c,h,[n[1],n[3]],e))},s.prototype.updateDefinedNames=function(e,t,i,r,n,a){if(r){var o=this.parent.definedNames.indexOf(e),l={action:"removeDefinedName",isRemoved:!1,definedName:e.name,scope:e.scope,isEventTrigger:!0};if(this.parent.notify(xt,l),n){var h={name:e.name,comment:e.comment,refersTo:e.refersTo,scope:e.scope};if(h=new KP(this.parent,"definedNames",h,!0),a.definedNames?a.definedNames.push(h):a.definedNames=[h],n[1]<n[0])return}e.refersTo=t+"!"+i,this.parent.notify(xt,{action:"addDefinedName",definedName:e,isAdded:!1,index:o,isEventTrigger:!0});var u={name:e.name,scope:e.scope,comment:e.comment,refersTo:e.refersTo,cancel:!1};this.parent.notify("actionComplete",{eventArgs:u,action:"refreshNamedRange"})}},s}();function v6(s){var e=s.toString();if(s===parseInt(e,10))return parseInt(e,10)+"  ";var t=e.indexOf(".")>-1?e.split(".")[1]:0,i=Math.pow(10,t.toString().replace("-","").length),r=Math.abs(RP(t,i));return t/r+"/"+i/r}function RP(s,e){return s=Number(s),e=Number(e),e?RP(e,s%e):s}function Nl(s){s=Number(s),s=s>0&&s<1?1+s:s===0?1:s,s>60&&(s-=1);var e=new Date("01/01/1900"),t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return new Date(new Date((s-1)*(1e3*3600*24)+t).toUTCString().replace(" GMT",""))}function Es(s,e,t){var i=new Date("01/01/1900"),r=Mc(s)?s:new Date(s),n=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),a=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),o=(a-n)/(1e3*3600*24);return(e?o:parseInt(o.toString(),10))+(t?0:o>60?2:1)}function Mc(s){return Object.prototype.toString.call(s)==="[object Date]"&&!isNaN(s.valueOf())}function He(s){return s-parseFloat(s)>=0}function $d(s,e,t,i,r){var n=vt.getDependables(hr,t,null).dateObject,a=n.dateTimeFormats.availableFormats,o={dateObj:null,isCustom:!1,type:""},l=function(){o.type==="time"&&(o.dateObj=new Date("01/01/1900 "+o.dateObj.toLocaleTimeString()))};if(i&&(o.dateObj=e.parseDate(s,{format:i}),o.dateObj&&(o.type=s.toString().indexOf(":")>-1?"time":"datetime",l(),o.isCustom=!0)),m(o.dateObj)){if(s=s.toString(),s&&s.indexOf("/")>-1||s.indexOf("-")>0){var h=r&&r.format||i,u=h.includes("dd-MM-yy");if((u||h.includes("dd/MM/yy"))&&(h=u?"d-M-y":"d/M/y",o.dateObj=e.parseDate(s,{format:h,skeleton:"yMd"}),o.dateObj))return o.type="date",o}if(s.indexOf(":")<0)for(var c=0,d=Object.keys(n.dateFormats);c<d.length;c++){var p=d[c];if(o.dateObj=e.parseDate(s,{format:n.dateFormats[""+p],skeleton:p}),o.dateObj){o.type="date",o.isCustom=!1;break}}if(m(o.dateObj))for(var f=void 0,v=0,g=Object.keys(a);v<g.length;v++){var p=g[v];if(f=a[""+p],o.dateObj=e.parseDate(s,{format:f,skeleton:p}),!o.dateObj&&s.indexOf(":")>-1&&f.indexOf(":")>-1&&(o.dateObj=e.parseDate(s,{format:f.split(" ")[0]})),o.dateObj){o.type=s.toString().indexOf(":")>-1?"time":"datetime",l(),o.isCustom=!0;break}}if(m(o.dateObj))for(var b=0,y=Object.keys(n.timeFormats);b<y.length;b++){var p=y[b];if(o.dateObj=e.parseDate(s,{format:n.timeFormats[""+p],skeleton:p}),o.dateObj){o.type="time",l(),o.isCustom=!1;break}}}return s!=="#DIV/0!"&&!o.dateObj&&new Date(s).toString()!=="Invalid Date"&&(o.dateObj=new Date(s),o.type="date"),o}function Uc(s){if(s&&s!=="."&&s!=="-"){var e=s.toString();if(e.startsWith("-")&&(e=e.slice(1),e=e.includes("-")?s:e),/^\d*\.?\d*$/.test(e))return parseFloat(s)}return s}function vo(s,e,t,i,r){var n=s.value;return He(n)?{isNumber:!0,value:n}:(n&&(r&&n.includes(r)&&(s.format.includes(r)||s.format.includes("$"))&&(n=n.replace(r,"")),n.includes(t)&&yI(n,e,t,i)&&(n=n.split(t).join("")),i!=="."&&n.includes(i)&&(n=n.replace(i,"."))),{isNumber:He(n),value:n})}function yI(s,e,t,i){for(var r=!1,n=123456,a=n.toLocaleString(e),o=a.split(t).reverse(),l=s.split(i)[0].split(t),h=0;h<l.length&&(h===l.length-1?r=l[h].length===o[0].length:r=!Re(o[1])&&(h===0?l[h].length<=o[1].length:l[h].length===o[1].length),!!r);h++);return r}var FP=function(){function s(e){this.parent=e,this.localeObj&&(en.currency=["$#,##0.00","$#,##0","$#,##0_);[Red]($#,##0)","$#,##0.00_);($#,##0.00)","$#,##0_);($#,##0)","$#,##0.00_);[Red]($#,##0.00)"],en.accounting=['_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)','_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)']),this.localeObj=Lo(this.parent.locale),this.decimalSep=this.localeObj.decimal,this.groupSep=this.localeObj.group;var t=vt.getDependables(hr,this.parent.locale,null).dateObject;t.dayPeriods&&t.dayPeriods&&t.dayPeriods.format&&t.dayPeriods.format.wide?(this.localeObj.am=t.dayPeriods.format.wide.am||"AM",this.localeObj.pm=t.dayPeriods.format.wide.pm||"PM"):(this.localeObj.am="AM",this.localeObj.pm="PM");var i={},r=new _t;r.getNumberFormat(i);var n=ad(this.parent.locale,i.currency);if(n!=="$"){var a=r.getNumberPattern({currency:"$",useGrouping:!0,format:"c0"},!0);if(a&&a.endsWith("$")){var o=a[a.indexOf("$")-1].trim().length?"":" ";en.currency.forEach(function(l,h){if(l.includes("$#,##0")){var u="",c=l.split("$#,##0.")[1];if(c)for(var d=0;c[d]=="0";)u+="0",d++;u&&(u="."+u),en.currency[h]=l.split("$#,##0"+u).join("#,##0"+u+o+"$")}}),en.accounting.forEach(function(l,h){if(l.slice(0,l.indexOf("#")).includes("$")){var u=l.split(";"),c;u.forEach(function(d,p){d.includes("$")&&(d=d.replace("$",""),d.includes("0)")?c=d.indexOf("0)")+2:c=d.lastIndexOf(d.includes("0")?"0":d.includes("?")?"?":d.includes('"-"')?'"':"#")+1,c>0&&(u[p]=d.slice(0,c)+o+"$"+d.slice(c)))}),en.accounting[h]=u.join(";")}})}}this.addEventListener()}return s.prototype.numberFormatting=function(e){var t=this.parent.activeSheetIndex,i=!0;e.range&&e.range.indexOf("!")>-1&&(t=gt(this.parent,e.range.split("!")[0]),i=t===this.parent.activeSheetIndex);for(var r=Pe(this.parent,t),n=e.range?e.range.indexOf("!")>-1?e.range.split("!")[1]:e.range:r.selectedRange,a=ee(n),o,l,h,u=a[0];u<=a[2];u++)for(var c=a[1];c<=a[3];c++)h=Y(u,c,r,!1,!0).format,Tn(this.parent,r,{cell:{format:e.format},rowIdx:u,colIdx:c})||(l=Y(u,c,r),l.rowSpan<0||l.colSpan<0||(o={value:l.value,format:l.format,rowIndex:u,colIndex:c,sheetIndex:t,cell:l,refresh:i},this.getFormattedCell(o),i&&(this.setCell(o),this.parent.notify(Zw,{isRightAlign:o.isRightAlign,result:o.formattedText,rowIndex:u,colIndex:c,sheetIndex:o.sheetIndex,type:o.type,curSymbol:o.curSymbol,value:o.value||o.value===0?o.value:"",isRowFill:o.isRowFill,cellEle:o.td}),h&&h!==e.format&&h.includes("[")&&E1().indexOf(ba(e.format))===-1&&this.removeFormatColor(o,{format:h,style:l.style}))),this.parent.setUsedRange(u,c))},s.prototype.getFormattedCell=function(e){var t=e.value===void 0||e.value===null?"":e.value;e.sheetIndex=e.sheetIndex===void 0?this.parent.activeSheetIndex:e.sheetIndex;var i=Pe(this.parent,e.sheetIndex),r=e.cell||Y(e.rowIndex,e.colIndex,i,!1,!0),n=!1,a={},o=new _t;o.getNumberFormat(a);var l=ad(this.parent.locale,a.currency);if((!e.format||e.format==="General")&&!e.skipFormatCheck&&(!r.formula||!r.formula.toLowerCase().startsWith("=text("))){if(e.type=e.format="General",!r.formula||r.formula&&r.formula.indexOf("&-")===-1){var h={value:t,updatedVal:t,cell:r,isEdit:e.isEdit,intl:o};this.checkDateFormat(h),(h.isDate||h.isTime)&&(n=!0,r.value=e.value=h.updatedVal,r.format&&r.format!=="General"?e.format=r.format:r.format=e.format=Ki(h.isDate?"ShortDate":"Time"))}}else e.type=rh(e.format),e.skipFormatCheck&&!e.format&&e.type==="General"&&(e.format="General");if(r.format&&this.isCustomType(r)){e.type="Custom";var u=r.format.indexOf("@")>-1;t!==""&&!u&&this.isPercentageValue(t.toString(),e,r)&&(t=e.value.toString());var c=void 0,d=r.format;if(r.format=r.format.split("\\").join(""),r.format.indexOf(";")>-1)r.format.indexOf("<")>-1||r.format.indexOf(">")>-1?e.result=this.processCustomConditions(r,e):(e.result=this.processCustomAccounting(r,e,l),c=!He(r.value)||r.format==="@"),r.format=d;else if(yd(r.format,!0))t!==""&&(e.result=this.processCustomDateTime(e,r),c=!e.formatApplied),e.result=e.result||r.value;else if(u)c=!0,e.result=this.processCustomText(r.format,t,e);else{var p=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep);if(p.isNumber)if(r.value=e.value=p.value,r.format.includes("E+0")){e.format!==r.format&&(e.format=r.format),this.checkAndSetColor(e);var f=e.format.split("E")[0],v=f.split(".");this.decimalSep!=="."&&v.length===1&&(v=f.split(this.decimalSep)),e.result=v[0].length>1?this.scientificHashFormat(e,v):this.scientificFormat(e)}else e.result=this.processCustomNumberFormat(r,e),c=!He(r.value);else r.format&&r.format.includes("[")&&this.removeFormatColor(e,{format:r.format,style:r.style}),c=e.dataUpdate=!0}e.dataUpdate?e.formattedText=e.result||(m(e.value)?"":e.value.toString()):(e.value=e.result,e.formattedText=m(e.value)?"":e.value.toString()),c?e.isRightAlign=!1:e.isRightAlign=!m(e.value)}else{var g=this.processFormats(e,t,n,r,o,l,a.currency,i);e.formattedText=g.fResult||(e.value===void 0||e.value===null?"":e.value.toString()),e.isRightAlign=g.rightAlign}return e.curSymbol=l,e.formattedText},s.prototype.isCustomType=function(e){var t=rh(e.format);return t==="General"&&e.format!=="General"||t==="Time"&&this.parent.isEdit},s.prototype.processCustomFill=function(e,t,i,r){var n=e[e.indexOf("*")+1],a=e.split("*"+n);if(i.rowIndex===void 0)r=r||this.processCustomNumberFormat({format:a.join(""),value:t.value},i);else{var o=void 0;if(a[1]){var l=parseFloat(t.value);l<0?(o=this.processCustomNumberFormat({format:a[1],value:Math.abs(l).toString()},i),r="-"+a[0]):(o=this.processCustomNumberFormat({format:a[1],value:t.value},i),r=a[0]),l===0&&(o=o.split("0").join(""))}else r=r||this.processCustomNumberFormat({format:a[0],value:t.value},i);i.isRowFill=!0,this.setCell(i),this.parent.notify(Hy,{cell:t,cellEle:i.td,rowIdx:i.rowIndex,colIdx:i.colIndex,beforeFillText:r,repeatChar:n,afterFillText:o})}return r},s.prototype.processCustomDateTime=function(e,t){var i=this,r,n=function(){var v=t.value.toString();if(v.includes(i.localeObj.dateSeparator)||v.indexOf("-")>0||v.includes(i.localeObj.timeSeparator))return!0;var g=vt.getDependables(hr,i.parent.locale,null).dateObject,b=g.months["stand-alone"]&&g.months["stand-alone"].abbreviated;return b&&!!Object.keys(b).find(function(y){return v.includes(b[""+y])})};if(!He(t.value)&&(r=n(),!r))return t.value||"";var a,o=t.format,l=new _t,h=function(v){var g,b;if(r){if(b=$d(t.value,new _t,i.parent.locale,o,t),g=b.dateObj&&b.dateObj.toString()!=="Invalid Date",g){if(b.dateObj.getFullYear()<1900)return"";t.value=Es(b.dateObj,t.value.toString().includes(":"),b.type==="time").toString()}}else{if(i.checkAndProcessNegativeValue(e,t.value))return e.formatApplied=!0,e.formattedText;b={dateObj:Nl(parseFloat(t.value))},g=b.dateObj&&b.dateObj.toString()!=="Invalid Date"}if(g){v&&(e.dateObj=b.dateObj),e.formatApplied=!0;var y=void 0;if(o.startsWith("MM-dd-yyyy "))o=o.split(" ").splice(1).join(" "),y=l.formatDate(b.dateObj,{type:"date",skeleton:"yMd"})+(o?" "+l.formatDate(b.dateObj,{type:a,format:o}):"");else if(y=l.formatDate(b.dateObj,{type:a,format:o}),o=o.toLowerCase(),o.startsWith("[h]")){var C=Number(t.value.toString().split(".")[0])*24+b.dateObj.getHours();y=C.toString()+y.slice(y.indexOf("]")+1)}else if(o.startsWith("[m")){var x=Number(t.value.toString().split(".")[0])*1440+b.dateObj.getHours()*60+b.dateObj.getMinutes();y=x.toString()+y.slice(y.indexOf("]")+1)}else o.startsWith("[s")&&(y=(Number(t.value.toString().split(".")[0])*86400+(b.dateObj.getHours()*60+b.dateObj.getMinutes())*60+b.dateObj.getSeconds()).toString());return u?y.replace(i.localeObj.am,"A").replace(i.localeObj.pm,"P"):y}return""};o=o.split("_(").join(" ").split("_)").join(" "),t.format.indexOf("h")>-1&&(o=o.split("h").join("H"),a="time"),t.format.indexOf("s")>-1&&(a="time");var u=t.format.indexOf("A/P")>-1;if((t.format.indexOf("AM/PM")>-1||u)&&(o=o.split("H").join("h"),o=o.split("A/P").join("AM/PM").split("AM/PM").join("a"),a="time"),t.format.indexOf("d")>-1){a="date";for(var c=o.split(" "),d=void 0,p=0;p<c.length;p++)d=c[p].match(/d/g),d&&d.length>2&&(c[p]=c[p].split("d").join("E"));o=c.join(" ")}if(t.format.indexOf("m")>-1){if(t.format.indexOf("s")>-1||t.format.indexOf("h")>-1){if(a="time",t.format.includes(" ")){var c=o.split(" ");(c[0].includes("d")||c[0].includes("y"))&&(c[0]=c[0].split("m").join("M"),o=c.join(" "))}}else if(a="date",o=o.split("m").join("M"),t.format.indexOf("mmmmm")>-1){o="MMMM";var f=h()[0];return o=t.format.split("mmmmm").join("p"),h(e.checkDate).split("p").join(f)}}return h(e.checkDate)},s.prototype.processCustomConditions=function(e,t){if(He(e.value)){for(var i=e.format.split(";"),r=Number(e.value),n=void 0,a=void 0,o=void 0,l=void 0,h=0;h<i.length;h++)if(e.format=i[h],l=ba(e.format),l&&(e.format=e.format.split("["+l+"]").join("")),e.format.includes("[")){if(n=e.format.split("[")[1].split("]")[0],(a=n.split("<=")).length===2&&r<=Number(a[1])||a.length===1&&(a=n.split(">=")).length===2&&r>=Number(a[1])||a.length===1&&(a=n.split("<")).length===2&&r<Number(a[1])||a.length===1&&(a=n.split(">")).length===2&&r>Number(a[1])){e.format=i[h].split("["+n+"]").join(""),o=!1;break}o=a.length===2}else{e.format=i[h],o=!1;break}return o?(this.removeFormatColor(t,{format:i.join(""),style:e.style}),this.processCustomFill("*#",e,t,"#####")):this.processCustomNumberFormat(e,t)}else return e.value},s.prototype.processCustomAccounting=function(e,t,i){var r=e.format.split(";"),n=vo(e,this.parent.locale,this.groupSep,this.decimalSep,i),a;n.isNumber&&(e.value=n.value,a=parseFloat(n.value));var o;if(a>0)o=r[0];else if(a===0)r[2]?o=r[2].includes(i+"0")?r[2].split("0").join("#"):r[2]:o=r[0];else if(He(a))o=r[1];else{var l=e.value||e.value===0?e.value:"";return e.format="@",r[3]?this.processCustomText(r[3],l,t):l.toString()}return this.processCustomNumberFormat({format:e.format,value:a<0?Math.abs(a).toString():e.value,style:e.style},t,o)},s.prototype.processCustomText=function(e,t,i){t=t.toString();var r=this.processCustomNumberFormat({format:e.split("@").join("#"),value:t.split(t).join("1")},i);return r&&r.split("1").join(t)},s.prototype.thousandSeparator=function(e,t){for(;e;)t=t/1e3,e--;return t},s.prototype.getSeparatorCount=function(e){for(var t=0,i=["#","0"],r=0;r<e.format.length;r++)e.format[r]===","&&!(i.indexOf(e.format[r+1])>-1)&&t++;return t},s.prototype.processDigits=function(e,t){t=t.split("?").join("0");var i=e.value.toString();if(i=this.getFormattedNumber(t,parseFloat(i)),i&&i.includes(this.decimalSep)){var r=i.split(this.decimalSep);i=r[0]+this.decimalSep+r[1].split("0").join("  ")}return i||e.value},s.prototype.processFormatWithSpace=function(e,t,i){var r=" ",n={cell:t,char:r,width:0};this.parent.notify(Vy,n);for(var a=n.width,o,l={format:e,formattedText:""},h=0;h<e.length;h++)if(e[h]==="_"){n.char=e[h+1],this.parent.notify(Vy,n);var u=n.width;o=Math.round(u/a),e=e.replace(e[h]+e[h+1],r.repeat(o))}var c=e.length-e.trim().length;if(c>0){if(l.formattedText=this.getFormattedNumber(e.trim(),i),e[0]===" "){for(var d=1,p=1;e[p]===" ";)d++,p++;c-=d,l.formattedText=r.repeat(d)+l.formattedText}l.formattedText+=r.repeat(c)}else l.formattedText=this.getFormattedNumber(e,i);return l.format=e,l},s.prototype.removeFormatColor=function(e,t){E1().indexOf(ba(t.format))>-1&&(e.color=t.style&&t.style.color?t.style.color:"",this.applyColor(e))},s.prototype.processCustomNumberFormat=function(e,t,i){if(!e.format)return"";var r,n,a=e.value,o=e&&vo(e,this.parent.locale,this.groupSep,this.decimalSep).value;if(He(o)){e.value=o,o=parseFloat(o.toString());var l=i||e.format;if(e.format.indexOf("[")>-1){var h=ba(l);h?(l=l.split("["+h+"]").join(""),t.color=h.toLowerCase(),this.applyColor(t)):this.removeFormatColor(t,e)}(l.indexOf('"')>-1||l.indexOf("\\")>-1)&&(l=this.processText(l),n=o===0&&!l.includes("#")&&!l.includes("0"),n&&(l+="#"));var u=this.getSeparatorCount(e);if(u){r=!0;var c=this.thousandSeparator(u,o);l.indexOf(".")===-1&&(c=Math.round(c)),a=this.getFormattedNumber(l.split(",").join(""),c),c===0&&(a=a.replace("0",""))}if(l.indexOf("?")>-1&&(r=!0,a=this.processDigits(e,l),l=l.split("?").join("")),l.indexOf("_")>-1){r=!0;var c=this.processFormatWithSpace(l,e,o);l=c.format,a=c.formattedText}if(a&&l.indexOf("?")>-1&&(a=a.replace("?"," ")),l.indexOf("*")>-1&&(r=!0,a=this.processCustomFill(l,e,t)),l==="General"&&(r=!0,a=o.toString()),r||(a=this.getFormattedNumber(l,o)),n&&a&&(a=a.replace("0","")),l[0]==="#"&&o>=0&&o<1){var d=l.split("#").join("").split(".");if(!d[0].includes("0")){o===0&&l.includes(".")&&(!d[1]||!d[1].includes("0"))&&(a=this.getFormattedNumber(l,.1),a=a.replace("1",""));var p=a.split(this.decimalSep);p[0]=p[0].toString().replace(/^0+/,""),a=p.join(this.decimalSep)}}a==="-0"&&(a="0")}return a},s.prototype.processText=function(e){var t=e;return t.indexOf('"')>-1?t=t.split('"').join("'"):t.indexOf("\\")>-1&&(t=t.split("\\").join("")),t},s.prototype.processFormats=function(e,t,i,r,n,a,o,l){var h;if(t!==""){var u=void 0;switch(e.type!=="General"&&e.type!=="Text"&&this.isPercentageValue(t.toString(),e,r)&&(t=e.value.toString()),e.type){case"General":h={args:e,currencySymbol:a,fResult:t,intl:n,isRightAlign:i,curCode:o,cell:r,rowIdx:Number(e.rowIndex),colIdx:Number(e.colIndex),sheet:l},h.fResult.toString().startsWith(`
`)||h.fResult.toString().endsWith(`
 `)||this.autoDetectGeneralFormat(h),t=h.fResult,i=h.isRightAlign;break;case"Number":u=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep),u.isNumber&&(r.value=e.value=u.value,t=this.applyNumberFormat(e,n),i=!0);break;case"Currency":u=vo({value:t,format:e.format},this.parent.locale,this.groupSep,this.decimalSep,a),u.isNumber&&(r.value=e.value=u.value,t=this.currencyFormat(e,n,o,r),i=!0);break;case"Percentage":u=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep),u.isNumber&&(r.value=e.value=u.value,t=this.percentageFormat(e,n),i=!0);break;case"Accounting":t=this.accountingFormat(e,t,n,a,o,r),i=e.formatApplied;break;case"ShortDate":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.shortDateFormat(e,n),i=!!t;break;case"LongDate":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.longDateFormat(e,n),i=!!t;break;case"Time":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.timeFormat(e,n),i=!!t;break;case"Fraction":u=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep),u.isNumber&&(r.value=e.value=u.value,t=this.fractionFormat(e),i=!0);break;case"Scientific":u=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep),u.isNumber&&(r.value=e.value=u.value,t=this.scientificFormat(e),i=!0);break;case"Text":this.decimalSep!=="."&&He(t)&&t.toString().includes(".")&&(t=t.toString().replace(".",this.decimalSep)),i=!1;break}}return{fResult:t,rightAlign:i}},s.prototype.autoDetectGeneralFormat=function(e){var t=e.fResult,i,r=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("ADDRESS(")>0,n=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("DOLLAR(")>0,a=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("TEXT(")>0;if(!(n&&e.fResult&&e.fResult.toString().includes(e.currencySymbol)||a)){if(e.fResult&&this.decimalSep!=="."){var o=e.fResult.toString();i=o,o.includes(this.decimalSep)&&(o=o.replace(this.decimalSep,"."),He(o)&&(e.fResult=e.args.value=o=Number(o).toString(),Ht(e.rowIdx,e.colIdx,e.sheet,{value:o},!0),i=o.replace(".",this.decimalSep)))}if(He(e.fResult)){var o=Number(e.fResult).toString();if(e.args.format&&(e.args.format.indexOf("%")>-1?e.fResult=this.percentageFormat(e.args,e.intl):e.args.format.indexOf(e.currencySymbol)>-1?e.fResult=this.currencyFormat(e.args,e.intl,e.curCode,e.args.cell):e.fResult=this.applyNumberFormat(e.args,e.intl)),e.args.format==="General"){if(e.args.cell&&e.args.cell.formula&&o.includes(".")&&o.length>11){var l=o.indexOf(".")+1;i=null,e.args.cell.formula.includes("RANDBETWEEN")&&(e.fResult=o=l<7?o:parseFloat(o).toFixed(0))}var h=o.split(".");if(h[0].length>11){o=Math.abs(Number(h[0])).toString().substring(0,6).replace(/0+$/,"");var u=o.length-1;u>-1&&(e.fResult=this.scientificFormat(e.args,u>5?5:u))}else if(h[1])if(o.length>11){var c=10-(h[0].length-(Math.sign(Number(o))<0?1:0));e.fResult=e.intl.formatNumber(Number(o),{format:c>0?"0."+"0".repeat(c):"0"}),e.fResult&&(e.fResult=Number(e.fResult).toString())}else if(o.includes("e-")){var d=o.split("e-"),u=Number(d[1])+(d[0].includes(".")?d[0].split(".")[1].length:0);d[0]=d[0].replace(".",this.decimalSep),d[1].length===1&&(d[1]="0"+d[1]),Ht(e.rowIdx,e.colIdx,e.sheet,{value:Number(o).toFixed(u)},!0),e.fResult=d.join("E-")}else i&&(e.fResult=i);m(e.fResult)&&!m(o)&&(e.fResult=o)}e.isRightAlign=!0}e.fResult&&this.updateAutoDetectNumberFormat(e),r&&(e.isRightAlign=!1,e.fResult=t)}},s.prototype.updateAutoDetectNumberFormat=function(e){var t=e.fResult.toString(),i=e.args.cell||e.cell;if(this.isPercentageValue(t,e.args,i))i.format=t.includes(this.decimalSep)?Ki("Percentage"):"0%",e.args.updateValue||(e.args.format=i.format,e.fResult=this.percentageFormat(e.args,e.intl),e.isRightAlign=!0);else{var r="";t.includes(e.currencySymbol)&&(r=t.includes(this.decimalSep)?"$#,##0.00":"$#,##0",t=t.replace(e.currencySymbol,""));var n=this.decimalSep==="."||e.args.isEdit;n&&t.includes(this.groupSep)&&yI(t,this.parent.locale,this.groupSep,this.decimalSep)&&(t=t.split(this.groupSep).join(""),r||(r=t.includes(this.decimalSep)?"#,##0.00":"#,##0")),r?(t=t.replace(this.decimalSep,"."),He(t)&&(e.args.value=Number(t).toString(),e.args.updateValue?(e.args.cell.value=e.args.value,e.args.cell.format=r):(Ht(e.rowIdx,e.colIdx,e.sheet,{value:e.args.value,format:r},!0),e.fResult=this.getFormattedNumber(r,Number(e.args.value)),e.isRightAlign=!0))):this.decimalSep!=="."&&e.args.format==="General"&&He(t)&&t.includes(".")&&(e.fResult=Number(t).toString().replace(".",this.decimalSep))}},s.prototype.isPercentageValue=function(e,t,i){if(e.includes("%")){var r=e.split("%");if(r[0]!==""&&r[1].trim()===""&&Number(r[0].split(this.groupSep).join("")).toString()!=="NaN")return t.value=Number(r[0].split(this.groupSep).join(""))/100,i.value=t.value.toString(),!0}return!1},s.prototype.findSuffix=function(e,t){var i=e.length,r=i-t.length;return e.substr(0,r<0?0:r)+t},s.prototype.applyNumberFormat=function(e,t){e.format=this.isCustomFormat(e.format);var i=e.format.split(";");if(Number(e.value)>0)e.format=i[0];else if(Number(e.value)===0){if(e.format=i[2]?i[2]:i[0],e.format.indexOf('"')>-1&&e.format.indexOf("#")===-1)return e.format=e.format.split("_").join(" ").split("*").join(" ").split("?").join(" ").split('"').join(""),e.format}else if(Number(e.value)<0)e.format=m(i[1])?i[0]:i[1].split("*").join(" "),e.format.indexOf("-")>-1&&(e.value=e.value.toString().split("-").join(""));else if(e.format=i[3]?i[3]:i[0],e.format=e.format.split("_").join(" ").split("*").join(" ").split("?").join(" "),e.format.indexOf("@")>-1)return e.format.split("@").join(e.value.toString());if(e.format=e.format.split("_").join(" ").split("*").join(" ").split('"').join(""),e.format.indexOf("?")>-1&&e.format.indexOf(this.decimalSep)>-1){var r=e.format.split(this.decimalSep)[1].length,n="";if(Number(e.value)%1){var a=e.value.toString().split(".")[1].length;r>a?n=" ":n="0"}e.format=e.format.split("?").join(n)}else e.format=e.format.split("?").join(" ");return Number(e.value)<0&&e.cell&&e.cell.format&&(e.format=e.cell.format),t.formatNumber(Number(e.value),{format:e.format})},s.prototype.isCustomFormat=function(e){return(e==='_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-'||e==='_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-')&&(e=""),e=e===""?Ki("Number"):e,e=e.toString().split("_)").join(" ").split("_(").join(" ").split("[Red]").join(""),e},s.prototype.currencyFormat=function(e,t,i,r){e.format=e.format||Ki("Currency"),e.format=e.format.split("_(").join(" ").split("_)").join(" ");var n=e.format.split(";"),a=ba(e.format),o=Number(e.value);return o>=0||m(n[1])?(a&&(e.color=r.style&&r.style.color?r.style.color:"",this.applyColor(e)),e.format=n[0]):(o=Math.abs(o),e.format=n[1].split("["+a+"]").join("").split("*").join(" "),a&&(e.color=a.toLowerCase(),this.applyColor(e))),e.format=this.getFormatForOtherCurrency(e.format),t.formatNumber(o,{format:e.format,currency:i})},s.prototype.applyColor=function(e){e.refresh&&(this.setCell(e),e.td&&e.td.style.color!==e.color&&this.parent.notify(dr,{style:{color:e.color},rowIdx:e.rowIndex,colIdx:e.colIndex,td:e.td}))},s.prototype.setCell=function(e){if(!e.td){var t={sheet:Pe(this.parent,e.sheetIndex),cell:e.cell,rowIdx:e.rowIndex,colIdx:e.colIndex};(e.cell.rowSpan>1||e.cell.colSpan>1)&&bb(t),e.td=this.parent.getCell(t.rowIdx,t.colIdx)}},s.prototype.percentageFormat=function(e,t){return e.format=e.format===""?Ki("Percentage"):e.format,t.formatNumber(Number(e.value),{format:e.format})},s.prototype.accountingFormat=function(e,t,i,r,n,a){e.format=e.format||Ki("Accounting"),e.format=e.format.split("_(").join(" ").split("_)").join(" ").split("[Red]").join("").split("_").join("");var o=e.format.split(";"),l=vo({value:t},this.parent.locale,this.groupSep,this.decimalSep);if(l.isNumber){a.value=e.value=l.value;var h=Number(e.value);if(h>=0?e.format=h===0&&o[2]?o[2]:o[0]:(e.format=o[1].split("*").join(" "),h=Math.abs(h)),!e.format.includes(r)&&!e.format.includes("$")&&(n=r=""),e.format=this.getFormatForOtherCurrency(e.format),e.formatApplied=!0,h===0){if(e.format=this.processText(e.format.split("*").join(" ").split("?").join(" ")),!e.format.includes("#")&&!e.format.includes("0")){e.format+="#";var u=i.formatNumber(h,{format:e.format,currency:n});return u.includes("0")&&(u=u.replace("0","")),u}return i.formatNumber(h,{format:e.format,currency:n})}else return i.formatNumber(h,{format:e.format,currency:n})}else if(o[3])return this.processCustomText(o[3],t,e);return t},s.prototype.getFormatForOtherCurrency=function(e){if(e.indexOf("[$")>-1){var t=e.split("]")[0].split("[$")[1].split("-")[0];e.indexOf("0")>e.indexOf("[$")?e=t+e.slice(e.indexOf("]")+1,e.length):e=e.slice(0,e.indexOf("[$"))+t}return e},s.prototype.checkAndProcessNegativeValue=function(e,t){if(t&&He(t)&&Number(t)<0){if(e.rowIndex===void 0||e.dataUpdate)return e.formattedText="#".repeat(e.dataUpdate?7:10),!0;e.isRowFill=!0,this.setCell(e);var i={cell:e.cell,cellEle:e.td,rowIdx:e.rowIndex,colIdx:e.colIndex,repeatChar:"#"};return this.parent.notify(Hy,i),e.formattedText=i.formattedText,!0}return!1},s.prototype.shortDateFormat=function(e,t){var i,r;if(e.format===""||e.format==="General"||e.format===Ki("ShortDate")?(r="MM-dd-yyyy",i={type:"date",skeleton:"yMd"}):(r=e.format,i={type:"date",format:r}),e.value&&(e.value=e.value.toString(),!He(e.value)&&(e.value.includes(this.localeObj.dateSeparator)||e.value.indexOf("-")>0))){(r==="dd-MM-yyyy"||r==="dd/MM/yyyy")&&(r="");var n=$d(e.value,t,this.parent.locale,r,e.cell).dateObj;if(n&&n.toString()!=="Invalid Date")return n.getFullYear()<1900?He(e.value)?e.value:"":(e.value=Es(n).toString(),e.cell&&(e.cell.value=e.value),e.checkDate&&(e.dateObj=n),t.formatDate(n,i))}var a=Nl(e.value);return a&&a.toString()!=="Invalid Date"&&a.getFullYear()<1900?He(e.value)?e.value.toString():"":(e.checkDate&&(e.dateObj=a),t.formatDate(a,i))},s.prototype.longDateFormat=function(e,t){e.value=e.value.toString();var i;if((e.value.includes(this.localeObj.dateSeparator)||e.value.indexOf("-")>0)&&!He(e.value))if(i=$d(e.value,t,this.parent.locale,"",e.cell).dateObj,i&&i.toString()!=="Invalid Date"&&i.getFullYear()>=1900)e.value=Es(i).toString(),e.cell&&(e.cell.value=e.value);else return He(e.value)?e.value:"";else if(i=Nl(e.value),i&&i.toString()!=="Invalid Date"&&i.getFullYear()<1900)return He(e.value)?e.value:"";var r=e.format===""||e.format==="General"?Ki("LongDate"):e.format.toString();return r===Ki("LongDate")&&(r="EEEE, MMMM d, y"),e.checkDate&&(e.dateObj=i),t.formatDate(i,{type:"date",format:r})},s.prototype.timeFormat=function(e,t){if(m(e.value))return"";var i=e.format===""||e.format==="General"||e.format===Ki("Time")?"h:mm:ss a":e.format,r=e.value.toString();if(!He(r)&&r.includes(this.localeObj.timeSeparator)){var n=$d(r,t,this.parent.locale,i,e.cell);if(n.dateObj&&n.dateObj.toString()!=="Invalid Date")r=e.value=Es(n.dateObj,!0,n.type&&n.type==="time").toString(),e.cell&&(e.cell.value=e.value);else return""}var a=r.split(".");return m(a[1])||(e.value=parseFloat(a[0]+1+"."+a[1])||e.value),t.formatDate(Nl(e.value),{type:"time",skeleton:"medium",format:i})},s.prototype.scientificHashFormat=function(e,t){var i=this.findDecimalPlaces(e.format),r=t[0].split("0").length-1+(t[0].split("#").length-1),n=Number(e.value).toExponential(i+r),a;if(n.includes("e+"))a="e+";else if(n.includes("e-"))a="e-";else return n;var o=n.split(a),l=o[0].split("."),h=Number(o[1]),u;if(a==="e-"){var c=h+Math.abs(h-r*(h>r?2:1));u=c-h,o[1]=c.toString()}else u=h%r,o[1]=(h-u).toString();u>0&&(l[0]+=l[1].substring(0,u),l[1]=l[1].slice(u),o[0]=l.join("."));var d=+("1"+"0".repeat(i));return this.getFormattedNumber(t.join("."),Number((Math.round(Number(o[0])*d)/d).toFixed(i)))+a.toUpperCase()+this.findSuffix(e.format.split("+")[1],o[1])},s.prototype.scientificFormat=function(e,t){e.format=e.format===""?Ki("Scientific"):e.format;var i=e.format.split("+")[1]||"00";t===void 0&&(t=this.findDecimalPlaces(e.format));var r=Number(e.value).toExponential(t);return r.indexOf("e+")>-1?r=r.split("e+")[0]+"E+"+this.findSuffix(i,r.split("e+")[1]):r.indexOf("e-")>-1&&(r=r.split("e-")[0]+"E-"+this.findSuffix(i,r.split("e-")[1])),r.replace(".",this.decimalSep)},s.prototype.fractionFormat=function(e){e.format=e.format||Ki("Fraction"),this.checkAndSetColor(e);var t=e.value.toString().split("."),i=this.getFormattedNumber(e.format.split(" ")[0],Number(t[0])),r=e.format.split("?").length/2;if(t.length===2&&!t[1].startsWith("0".repeat(r))){var n=v6(Number(e.value));if(n)return i+" "+n}return i+" "+"  ".repeat(r*2)},s.prototype.checkAndSetColor=function(e){var t=ba(e.format);t&&(e.format=e.format.split("["+t+"]").join(""),e.color=t.toLowerCase(),this.applyColor(e))},s.prototype.findDecimalPlaces=function(e){var t=e.toUpperCase().indexOf("E");if(t>-1){var i=e.indexOf(this.decimalSep);return i===-1&&this.decimalSep!=="."&&(i=e.indexOf(".")),i>0?e.substring(i+1,t).length:0}return 2},s.prototype.checkDateFormat=function(e){if(!m(e.value)){var t=e.cell||Y(e.rowIndex,e.colIndex,Pe(this.parent,m(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex),!1,!0),i=this.checkCustomDateFormat(e.value.toString(),t,e.isEdit);if(i.val!=="Invalid"){var r=$d(i.val,e.intl||new _t,this.parent.locale,i.format,e.skipCellFormat&&t);if(!m(r.dateObj)&&r.dateObj.toString()!=="Invalid Date"&&r.dateObj.getFullYear()>=1900){if(i.val=Es(r.dateObj,i.val.indexOf(":")>-1,r.type&&r.type==="time").toString(),(!t.format||t.format==="General")&&(r.type==="time"?t.format=Ki("Time"):t.format=Ki("ShortDate"),e.updateValue)){t.value=i.val;return}e.isDate=r.type==="date"||r.type==="datetime",e.isTime=r.type==="time",e.dateObj=r.dateObj}e.updatedVal=i.val}}},s.prototype.checkCustomTimeFormat=function(e,t){var i=this,r=[],n=" "+this.localeObj.am,a=" "+this.localeObj.pm,o=e.includes(n)||e.includes(a);o||(e.includes(n.toLowerCase())||e.includes(a.toLowerCase()))&&(e=e.replace(n.toLowerCase(),n).replace(a.toLowerCase(),a),o=!0);var l=e.split(this.localeObj.timeSeparator),h=l.length===3&&o,u;if(l.length<=3){var c,d,p=o?12:24;l.forEach(function(f,v){f.includes(n)||f.includes(a)?(u=" AM/PM",f=f.replace(n,"").replace(a,"")):u="",c=Number(f),He(c)&&c>=0?c<=p&&v===0?(r.push("h"+u),l.length===1&&(u?(d=e.split(" "),d[0]+=i.localeObj.timeSeparator+"00",l[0]=d.join(" ")):(r=[],e="Invalid"))):c<=60&&(r.length===1||r.length===2)?(r.length===1?r.push("mm"+u):r.push("ss"),f.length===1&&(l[v]="0"+l[v])):(r=[],e="Invalid"):(r=[],e="Invalid")})}else e="Invalid";return r.length&&(e=l.join(this.localeObj.timeSeparator),(!t.format||t.format==="General")&&!h)?(t.format=r.join(":"),{val:e,format:t.format}):{val:e,format:""}},s.prototype.checkCustomDateFormat=function(e,t,i){var r=this,n,a,o=t.format,l;if(e.includes(this.localeObj.dateSeparator)&&(!e.includes(" "+this.localeObj.am)&&!e.includes(" "+this.localeObj.pm)||e.replace(" "+this.localeObj.am,"").replace(" "+this.localeObj.pm,"").includes(this.localeObj.dateSeparator))){if(a=this.localeObj.dateSeparator,e.includes(this.localeObj.timeSeparator)&&e.includes(" ")){var h=e.split(" ");if(e=h.shift(),l=this.checkCustomTimeFormat(h.join(" "),t),l.val==="Invalid")return{val:"Invalid",format:""}}}else if(e.indexOf("-")>0)a="-";else return e.includes(this.localeObj.timeSeparator)||e.includes(" "+this.localeObj.am)||e.includes(" "+this.localeObj.pm)?this.checkCustomTimeFormat(e,t):{val:"Invalid",format:""};if(this.parent.isEdit&&o&&(o.includes("dd-MM-yy")||o.includes("dd/MM/yy"))&&e&&(e.indexOf("/")>-1||e.indexOf("-")>0)&&(!this.parent.locale||this.parent.locale.startsWith("en"))){var u=e.split(a);n=[u[1],u[0]],u[0]=n[0],u[1]=n[1],e=u.join(a)}var c=e.split(a),d="",p=[],f=function(){d=p.join(a),(!o||o==="General")&&(t.format=d+(t.format&&t.format!=="General"?" "+t.format:""))},v,g=vt.getDependables(hr,this.parent.locale,null).dateObject,b=g.months["stand-alone"]?g.months["stand-alone"].wide:{},y=g.months["stand-alone"]?g.months["stand-alone"].abbreviated:{1:""},C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=function(T,D,N,A){if(y[""+D]&&y[""+D].toLowerCase()===N){v=y[""+D];return}var L=T.substring(0,A);L===N&&(v=y[""+D]||C[Number(D)-1])};if(c.length===2){var w=function(T){e=v,p[0]="MMM",Number(T)<=31?(e=T+a+e,r.localeObj.dateSeparator!=="/"&&a!=="-"&&(e+=a+new Date().getFullYear()),p.splice(0,0,"dd"),f()):Number(T)>=1900&&Number(T)<=9999?(e="1"+a+e+a+T,p[1]="yy",f(),p[1]="yyyy",d=p.join(a)):e="Invalid"};c[0]=c[0].toLowerCase().trim(),c[1]=c[1].toLowerCase().trim(),!Number(c[0])&&c[0].length>=y[1].length?(Object.keys(b).find(function(T){return x(b[""+T].toLowerCase(),T,c[0],c[0].length)}),!m(v)&&!c[0].includes(",")&&w(c[1])):!Number(c[1])&&c[1].length>=y[1].length?(Object.keys(b).find(function(T){return x(b[""+T].toLowerCase(),T,c[1],c[1].length)}),m(v)||w(c[0])):Number(c[0])&&Number(c[0])<=12&&Number(c[1])&&(this.localeObj.dateSeparator==="/"||a==="-"||i)&&(v=C[Number(c[0])-1],w(c[1])),p.length||(e="Invalid")}else if(c.length>2)for(var M=function(T){Number(c[T])>-1||(c[T]=c[T].trim(),Object.keys(b).find(function(D){return x(b[""+D].toLowerCase(),D,c[T].trim().toLowerCase(),c[T].length)}),m(v)?e="Invalid":T===1&&(p[1]="MMM",c[2]=c[2].trim(),Number(c[0])<31&&Number(c[2])>=1900&&Number(c[2])<=9999&&(e=c[0]+a+v,e+=a+c[2],p[0]="d",p[2]="yy",f(),p[2]="yyyy",d=p.join(a))))},E=0;E<c.length;E++)M(E);return l&&e!=="Invalid"&&(!d&&(!o||o==="General")?t.format=Ki("ShortDate")+" "+(l.format||Ki("Time")):l.format&&(d+=" "+l.format),e+=" "+l.val),{val:e,format:d}},s.prototype.formattedBarText=function(e){var t=this;if(!(e.value===""||m(e.value))){var i={},r=e.cell&&e.cell.format||"",n=e.type||(r&&yd(r,!0,i,!0)?i.type:""),a=new _t,o=e.value,l=e.showFormattedText&&(r==="dd-MM-yyyy"||r==="dd/MM/yyyy")?r:Ki("ShortDate"),h=Ki("Time"),u=r.toLowerCase(),c=function(){t.decimalSep!=="."&&e.value&&(e.value=e.value.toString(),He(e.value)&&e.value.includes(".")&&(e.value=e.value.replace(".",t.decimalSep)))};if(n==="time"&&u.includes("m")&&!u.includes(":m")&&!u.includes("m:")&&!u.includes("[m")&&!u.includes("am")&&(n="date"),n==="date"){var d=e.value.toString();e.value=this.shortDateFormat({type:n,value:e.value,format:l,cell:e.cell},a),e.value&&d.includes(".")&&(e.value+=" "+this.timeFormat({type:n,value:d,format:h},a))}else n.includes("time")?o&&Number(o)>=1||n==="datetime"?e.value=this.shortDateFormat({type:n,value:e.value,format:l},a)+" "+this.timeFormat({type:n,value:e.value,format:h},a):e.value=this.timeFormat({type:n,value:e.value,format:h},a):e.cell.format&&e.cell.format.includes("%")&&He(e.cell.value)?(e.value=this.parent.getDisplayText(e.cell),e.value.includes("%")||(e.value=o,c())):c();(!e.value||e.value&&e.value.toString().indexOf("null")>-1)&&(e.value=o)}},s.prototype.getFormattedNumber=function(e,t){return new _t().formatNumber(Number(t),{format:e})||""},s.prototype.addEventListener=function(){this.parent.on(Rf,this.numberFormatting,this),this.parent.on(jn,this.getFormattedCell,this),this.parent.on(yn,this.checkDateFormat,this),this.parent.on(Iy,this.formattedBarText,this),this.parent.on(e1,this.updateAutoDetectNumberFormat,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Rf,this.numberFormatting),this.parent.off(jn,this.getFormattedCell),this.parent.off(yn,this.checkDateFormat),this.parent.off(Iy,this.formattedBarText),this.parent.off(e1,this.updateAutoDetectNumberFormat))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"workbookNumberFormat"},s}();function Ki(s){var e="General";switch(s.split(" ").join("")){case"Number":e="0.00";break;case"Currency":e=en.currency[0];break;case"Accounting":e=en.accounting[0];break;case"ShortDate":e="mm-dd-yyyy";break;case"LongDate":e="dddd, mmmm dd, yyyy";break;case"Time":e="h:mm:ss AM/PM";break;case"Percentage":e="0.00%";break;case"Fraction":e="# ?/?";break;case"Scientific":e="0.00E+00";break;case"Text":e="@";break}return e}function rh(s,e){var t="General";switch(s){case'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-':case'_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-':t="Number";break;case"$#,##0.00":case"$#,##0":case"$#,##0_);[Red]($#,##0)":case"$#,##0.00_);($#,##0.00)":case"$#,##0_);($#,##0)":case"$#,##0.00_);[Red]($#,##0.00)":t="Currency";break;case'_($*#,##0.00_);_($*(#,##0.00);_($*"-"??_);_(@_)':case'_($*#,##0.00_);_($* (#,##0.00);_($*"-"??_);_(@_)':case'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)':case'_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * "-"??_ ;_ @_ ':case'_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)':t="Accounting";break;case"mm-dd-yyyy":case"dd/MM/yyyy":t="ShortDate";break;case"dddd, mmmm dd, yyyy":t="LongDate";break;case"h:mm:ss AM/PM":t="Time";break;case"0.00%":case"0%":t="Percentage";break;case"0.00E+00":t="Scientific";break;case"@":t="Text";break;default:s&&(en.currency.indexOf(s)>-1?t="Currency":en.accounting.indexOf(s)>-1||s==='_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'||s==='_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'?t="Accounting":s.includes("?/?")?t="Fraction":s.includes("[$")&&(s.includes("* ")?t="Accounting":t="Currency"),e=!1);break}return e&&(t==="Currency"&&en.currency[0]!=="$#,##0.00"||t==="Accounting"&&en.accounting[0]!=='_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)')&&(t="General"),t}var PP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Pf,this.initiateSortHandler,this),this.parent.on(r1,this.updateSortedDataOnCell,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Pf,this.initiateSortHandler),this.parent.off(r1,this.updateSortedDataOnCell))},s.prototype.initiateSortHandler=function(e){var t=this,i=e.args,r=new xa,n=this.parent.getAddressInfo(i.range),a=Pe(this.parent,n.sheetIndex),o=lt(n.indices),l=i.sortOptions||{sortDescriptors:{},containsHeader:!0},h=!1;if(e.promise=r.promise,o[0]>a.usedRange.rowIndex||o[1]>a.usedRange.colIndex){r.reject(this.parent.serviceLocator.getService(xI).getConstant("SortOutOfRangeError"));return}var u=l.containsHeader,c=i.checkForHeader;if((o[0]===o[2]||c)&&(c||(o=iz(o[0],o[1],a)),h=!0,m(l.containsHeader)&&(typeof Y(o[0],o[1],a,null,!0).value==typeof Y(o[0]+1,o[1],a,null,!0).value?u=!this.isSameStyle(Y(o[0],o[1],a,null,!0).style,Y(o[0]+1,o[1],a,null,!0).style):u=!0)),(m(i.sortOptions)||m(i.sortOptions.containsHeader))&&!h){var d=Y(o[0],o[1],a),p=Y(o[0]+1,o[1],a);d&&p&&(typeof d.value==typeof p.value?u=!this.isSameStyle(d.style,p.style):u=!0)}o[0]=u?o[0]+1:o[0];var f=xe(a.activeCell),v=Ur(f[1]+1);delete l.containsHeader;var g=l.sortDescriptors,b=new $e;if(Array.isArray(g)){(!g||g.length===0)&&(g=[{field:v}]);for(var y=g.length,C=y-1;C>-1;C--)if(g[y-1].field||(g[y-1].field=v),!!g[C].field){var x=g[C].sortComparer||this.sortComparer.bind(this,g[C],l.caseSensitive);b.sortBy(g[C].field,x),v=g[C].field}}else{g||(g={field:v}),g.field||(g.field=v);var x=g.sortComparer||this.sortComparer.bind(this,g,l.caseSensitive);b.sortBy(g.field,x),v=g.field}var w=je(o);$s(this.parent,a.name+"!"+w,!0,null,null,null,null,null,void 0,null,Rn(v)).then(function(M){var E=new ge(M);E.executeQuery(b).then(function(T){t.parent.notify("setActionData",{args:{action:"beforeSort",eventArgs:{range:w,cellDetails:M,sortedCellDetails:T.result}}}),t.updateSortedDataOnCell({result:T.result,range:o,sheet:a,jsonData:M});var D={range:a.name+"!"+w,sortOptions:i.sortOptions};e.previousSort&&(D.previousSort=e.previousSort),r.resolve(D)})})},s.prototype.updateSortedDataOnCell=function(e){for(var t=this,i=[],r,n=function(c,d){for(var p=e.range[1],f=0;p<=e.range[3];p++,f++){if(i[f]||(i[f]=Ur(p+1)),d[i[f]])r=me({},d[i[f]],null,!0);else{if(!Y(c,p,e.sheet))continue;r=null}r=t.skipBorderOnSorting(c,p,e.sheet,r),r&&r.formula&&(r.formula=tz([c,p],[parseInt(d.__rowIndex,10)-1,p],e.sheet,r,t.parent,!0)),Ht(c,p,e.sheet,r)}},a=e.isUndo&&{},o,l,h=e.range[0],u=0;h<=e.range[2];h++,u++){if(ct(e.sheet,h)){u--;continue}if(l=e.result[u],e.isUndo){if(l&&(o=parseInt(l.__rowIndex,10)-1,a[o]=!0,n(o,l),h===o))continue;!a[h]&&e.sheet.rows[h]&&n(h,{})}else n(h,l||{})}},s.prototype.skipBorderOnSorting=function(e,t,i,r){var n=Y(e,t,i),a=["borderBottom","borderTop","borderRight","borderLeft","border"];if(r&&r.style)for(var o=0,l=a;o<l.length;o++){var h=l[o];delete r.style[""+h]}if(n&&n.style)for(var u=0,c=a;u<c.length;u++){var h=c[u];n.style[""+h]&&(r||(r={}),r.style||(r.style={}),r.style[""+h]=n.style[""+h])}return r},s.prototype.isSameStyle=function(e,t){e||(e={}),t||(t={});for(var i=!0,r=Object.keys(e),n=0;n<r.length;n++)if(e[r[n]]===t[r[n]]||this.parent.cellStyle[r[n]]===e[r[n]])i=!0;else{i=!1;break}return i},s.prototype.sortComparer=function(e,t,i,r){var n=e.order||"",a=ce.fnSort(n),o=!1;if(i&&r&&(typeof i.value=="string"||typeof r.value=="string")&&i.value!==""&&r.value!==""&&(He(i.value)&&(i.value=Uc(i.value)),He(r.value)&&(r.value=Uc(r.value),o=!0),!o&&!o)){var l={sensitivity:t?"case":"base"},h=new Intl.Collator(this.parent.locale,l);return!n||n.toLowerCase()==="ascending"?h.compare(i.value,r.value):h.compare(i.value,r.value)*-1}var u=m(i)||i&&(m(i.value)||i.value===""),c=m(r)||r&&(m(r.value)||r.value==="");return u&&c?-1:u?1:c?-1:a(i&&i.value,r&&r.value)},s.prototype.getModuleName=function(){return"workbookSort"},s}(),zP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Ny,this.initiateFilterHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Ny,this.initiateFilterHandler)},s.prototype.initiateFilterHandler=function(e){var t=this,i=e.args,r=new xa,n=Pe(this.parent,La(this.parent,i.range)),a=i.filterOptions||{};if(e.promise=r.promise,a.datasource){this.setFilter(a.datasource,a.predicates,i.range,e.refresh);var o={range:i.range,filterOptions:a};r.resolve(o)}else{var l=lt(ir(i.range));if(l[0]>n.usedRange.rowIndex||l[1]>n.usedRange.colIndex){r.reject("Select a cell or range inside the used range and try again.");return}l[0]===l[2]&&l[2]-l[0]===0&&(l[0]=0,l[1]=0,l[3]=n.usedRange.colIndex),l[2]=n.usedRange.rowIndex,l[0]=l[0]+1;var h=je(l);$s(this.parent,n.name+"!"+h,!0,!0,null,null,null,null,!1).then(function(u){var c=new ge(u);t.setFilter(c,a.predicates,i.range,e.refresh);var d={range:h,filterOptions:a};r.resolve(d)})}},s.prototype.setFilter=function(e,t,i,r){var n=this;if(e&&t){var a=e.dataSource.json,o=new $e;t.length&&o.where(It.and(t));var l=e.executeLocal(o),h="__rowIndex",u,c;if(i.indexOf("!")>-1?(c=gt(this.parent,i.split("!")[0]),u=Pe(this.parent,c)):(u=this.parent.getActiveSheet(),c=gt(this.parent,u.name)),this.parent.getModuleName()==="spreadsheet"){var d=this.parent,p,f;if(d.scrollSettings.enableVirtualization&&(u.rows||a).length>d.viewport.rowCount+d.getThreshold("row")*2||u.frozenRows||u.frozenColumns||r){a.forEach(function(b){p=l.indexOf(b)<0,Ts(u,Number(b[""+h])-1,{hidden:p,isFiltered:p})}),f=c===d.activeSheetIndex;var v=ee(u.paneTopLeftCell);this.parent.updateTopLeftCell(ae(u,v[0],!0)-this.parent.frozenRowCount(u),null,"col")}else a.forEach(function(b){if(p=l.indexOf(b)<0,f)Ts(u,Number(b[""+h])-1,{hidden:p,isFiltered:p});else{var y={startIndex:Number(b[""+h])-1,hide:p,isFiltering:!0,sheetIndex:c};y.endIndex=y.startIndex,n.parent.notify(nn,y),f=y.refreshUI}});f&&d.renderModule.refreshSheet(!1,!1,document.activeElement.id!==this.parent.element.id+"_SearchBox")}else{var g;a.forEach(function(b){g=l.indexOf(b)<0,Ts(u,Number(b[""+h])-1,{hidden:g,isFiltered:g})})}}},s.prototype.getModuleName=function(){return"workbookFilter"},s}(),jP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.setImage=function(e){var t=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,i=e.range&&e.range.indexOf("!")>0?gt(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,r=ee(t),n=Re(i)?this.parent.getActiveSheet():Pe(this.parent,i),a=Y(r[0],r[1],n),o,l=e.options;if(a&&a.image){o=a.image;for(var h=0;h<l.length;h++)o.push(l[h])}Ht(r[0],r[1],n,{image:a&&a.image?o:l},!0)},s.prototype.addEventListener=function(){this.parent.on(Py,this.setImage,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Py,this.setImage)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"workbookImage"},s}(),BP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(th,this.setChartHandler,this),this.parent.on(lu,this.refreshChartData,this),this.parent.on(zy,this.deleteChartColl,this),this.parent.on(Al,this.refreshChartSize,this),this.parent.on(p1,this.focusChartBorder,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(th,this.setChartHandler),this.parent.off(lu,this.refreshChartData),this.parent.off(zy,this.deleteChartColl),this.parent.off(Al,this.refreshChartSize),this.parent.off(p1,this.focusChartBorder))},s.prototype.setChartHandler=function(e){var t=0;e.isInitCell=m(e.isInitCell)?!1:e.isInitCell,e.isUndoRedo=m(e.isUndoRedo)?!0:e.isUndoRedo,e.isPaste=m(e.isPaste)?!1:e.isPaste;var i=e.chart,r;if(i.length>0)for(;t<i.length;){if(e.isCut===!1&&document.getElementById(e.chart[t].id)&&(i[t]={range:i[t].range,id:mi("e_spreadsheet_chart"),theme:i[t].theme,isSeriesInRows:i[t].isSeriesInRows,type:i[t].type,markerSettings:i[t].markerSettings}),document.getElementById(e.chart[t].id))return;r=i[t],r.theme=r.theme||"Material",r.type=r.type||"Line",r.isSeriesInRows=r.isSeriesInRows||!1,r.range=r.range||this.parent.getActiveSheet().selectedRange;var n=lt(ee(r.range)),a=je(n);if(r.range.indexOf("!")>0?r.range=r.range.split("!")[0]+"!"+a:r.range=this.parent.getActiveSheet().name+"!"+a,m(r.id)&&(r.id=mi("e_spreadsheet_chart")),r.markerSettings&&r.markerSettings.visible&&(r.markerSettings.isFilled===void 0&&(r.markerSettings.isFilled=!0),r.markerSettings.shape===void 0&&(r.markerSettings.shape="Circle")),r.height=r.height||290,r.width=r.width||480,this.parent.notify(wc,{option:r,isInitCell:e.isInitCell,triggerEvent:e.isUndoRedo,dataSheetIdx:e.dataSheetIdx,range:e.range,isPaste:e.isPaste}),this.parent.chartColl.push(r),!e.isInitCell||e.isPaste){var o=e.sheetId===void 0?r.range&&r.range.indexOf("!")>0?gt(this.parent,r.range.split("!")[0]):this.parent.activeSheetIndex:Qn(this.parent,e.sheetId),l=e.isPaste?ee(e.range):ee(r.range),h=Re(o)?this.parent.getActiveSheet():this.parent.sheets[o],u=Y(l[0],l[1],h);u&&u.chart?u.chart.push(r):Ht(l[0],l[1],h,{chart:[r]},!0)}t++}},s.prototype.refreshChartData=function(e){if(!(!this.parent.chartColl||!this.parent.chartColl.length))for(var t,i,r,n,a=0,o=this.parent.chartColl.length;a<o;a++){if(t=this.parent.chartColl[a],t.range.includes("!")){if(i=t.range.split("!"),this.parent.activeSheetIndex!==gt(this.parent,i[0]))continue;r=i[1]}else r=t.range;if(e.viewportIndexes){for(var l=0;l<e.viewportIndexes.length;l++)if(qy([e.viewportIndexes[l]],r)){n=!0;break}}else n=e.range?qy([e.range],r):e.showHide?this.inRowColumnRange(ee(r),e.rIdx,e.showHide):Sa(ee(r),e.rIdx,e.cIdx);n&&this.parent.notify(d1,{chart:t})}},s.prototype.inRowColumnRange=function(e,t,i){return i==="rows"?t>=e[0]&&t<=e[2]:t>=e[1]&&t<=e[3]},s.prototype.refreshChartSize=function(e){for(var t,i=1,r=this.parent.sheets.length+1;i<r;){var n=this.parent.chartColl;if(t=n?n.length:0,t)for(;t--;){var a=this.parent.chartColl[t];if(!m(e.overlayEle.querySelector("#"+a.id))){var o=this.parent.element.querySelector("."+a.id),l=Ct(o,"chart");l&&(l.height=e.height,l.width=e.width)}}i++}},s.prototype.focusChartBorder=function(e){for(var t=0;t<this.parent.chartColl.length;t++){var i=document.getElementById(e.id),r=document.getElementById(this.parent.chartColl[t].id);i&&r&&U(r,"."+i.classList[1])===i&&this.parent.notify(wc,{option:this.parent.chartColl[t],isRefresh:!0})}},s.prototype.deleteChartColl=function(e){for(var t=0;t<this.parent.chartColl.length;t++)this.parent.chartColl[t].id+"_overlay"===e.id&&this.parent.chartColl.splice(t,1)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"workbookChart"},s}(),HP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.format=function(e){var t=this,i,r=e.range;r&&typeof r=="string"&&r.indexOf("!")>-1?(r=r.split("!")[1],i=this.parent.sheets[gt(this.parent,e.range.split("!")[0])]):i=this.parent.getActiveSheet(),r===void 0&&(r=i.selectedRange);var n=typeof r!="object"&&e.onActionUpdate,a={range:r,style:Object.assign({},e.style),requestType:"CellFormat"};e.borderType&&(a.borderType=e.borderType);var o={};if(Object.assign(o,a.style,null,!0),n&&(this.parent.trigger("beforeCellFormat",a),this.parent.notify("actionBegin",{eventArgs:a,action:"format"}),a.cancel)){e.cancel=!0;return}var l=typeof a.range=="object"?a.range:lt(ee(a.range));e.borderType&&(this.setTypedBorder(i,e.style.border,l,e.borderType,e.onActionUpdate),delete e.style.border,delete a.style.border);var h,u,c={cell:null,rowIdx:0,colIdx:0,eventOnly:!0,preventEvt:!n},d=function(F){return c.cell={style:F},c.rowIdx=h,c.colIdx=u,Tn(t.parent,i,c)};if(a.style.borderTop!==void 0){for(u=l[1];u<=l[3];u++)h=l[0],d({borderTop:a.style.borderTop})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderBottom",h-1,u),this.checkFullBorder(i,"borderBottom",h-1,u)),this.checkFullBorder(i,"borderTop",h,u),this.setCellBorder(i,c.cell.style,h,u,e.onActionUpdate,u===l[3],null,null,e.isUndoRedo));delete a.style.borderTop}if(a.style.borderBottom!==void 0){var p=void 0,f=void 0;for(u=l[1];u<=l[3];u++)h=l[0],p=Y(h,u,i,!1,!0),p.rowSpan>0?f=Y(l[2],l[1],i,!1,!0):f=Y(l[2],l[3],i,!1,!0),p.rowSpan>1&&f.rowSpan<0||(h=l[2]),d({borderBottom:a.style.borderBottom})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderTop",l[2]+1,u),this.checkFullBorder(i,"borderTop",l[2]+1,u)),this.checkFullBorder(i,"borderBottom",l[2],u),this.setCellBorder(i,c.cell.style,h,u,e.onActionUpdate,u===l[3],null,null,e.isUndoRedo),this.setBottomBorderPriority(i,l[2],u));delete a.style.borderBottom}if(a.style.borderLeft!==void 0){for(var v=l[0];v<=l[2];v++)u=l[1],d({borderLeft:a.style.borderLeft})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderRight",v,u-1),this.checkFullBorder(i,"borderRight",v,u-1)),this.checkFullBorder(i,"borderLeft",v,u),this.setCellBorder(i,c.cell.style,v,u,e.onActionUpdate,null,null,null,e.isUndoRedo));delete a.style.borderLeft}if(a.style.borderRight!==void 0){for(var g=l[0];g<=l[2];g++)u=l[3],d({borderRight:a.style.borderRight})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderLeft",g,u+1),this.checkFullBorder(i,"borderLeft",g,u+1)),this.checkFullBorder(i,"borderRight",g,u),this.setCellBorder(i,c.cell.style,g,u,e.onActionUpdate,null,null,null,e.isUndoRedo));delete a.style.borderRight}var b,y,C;if(Object.keys(a.style).length){var x=this.parent,w=x.viewport&&this.parent.getActiveSheet().id===i.id,M=this.parent.frozenRowCount(i),E=this.parent.frozenColCount(i),T=[M+x.viewport.topIndex,E+x.viewport.leftIndex,x.viewport.bottomIndex,x.viewport.rightIndex],D=void 0,N=void 0,A=void 0,L=void 0;for(h=l[0];h<=l[2];h++)if(N=sh(i,h)||{},!N.isFiltered){for(D=h>=T[0]&&h<=T[2]||h<M,A=!1,u=l[1];u<=l[3];u++)if(!d(a.style)){if(y===void 0&&(a.style.border!==void 0?(b=a.style.border,delete a.style.border,y=!0):y=!1),C=Y(h,u,i,!1,!0),C.rowSpan>1||C.colSpan>1)for(var k=h,O=C.rowSpan>1?h+(C.rowSpan-1):h;k<=O;k++)for(var R=u,j=C.colSpan>1?u+(C.colSpan-1):u;R<=j;R++)y&&this.setFullBorder(i,b,l,k,R,e.onActionUpdate,!0),this.setCellStyle(i,k,R,a.style);if(y&&this.setFullBorder(i,b,l,h,u,e.onActionUpdate),this.setCellStyle(i,h,u,a.style),!!w)if(D&&(u>=T[1]&&u<=T[3]||u<E)){if(L=null,a.style.color&&C.format&&C.format.includes("[")){var P=ba(C.format);P&&(L=P.toLowerCase())}this.parent.notify(dr,{style:a.style,rowIdx:h,colIdx:u,lastCell:u===l[3],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:e.onActionUpdate,formatColor:L})}else N.customHeight||(A=A||w1(a.style,e.onActionUpdate),A&&this.parent.notify(dr,{rowIdx:h,colIdx:u,lastCell:u===l[3],checkHeight:!0,outsideViewport:!D,onActionUpdate:e.onActionUpdate}))}}}y&&(a.style.border=b),this.parent.setUsedRange(l[2],l[3]),e.refreshRibbon&&this.parent.notify(sa,null),n&&(a.style=o,a.range=i.name+"!"+r,this.parent.notify("actionComplete",{eventArgs:a,action:"format"}))},s.prototype.setBottomBorderPriority=function(e,t,i){if(ct(e,t+1)){var r=this.skipHiddenRows(e,t+1),n=this.parent.getCellStyleValue(["borderTop"],[r,i]).borderTop;n!==""&&(e.rows[t].cells[i].style.bottomPriority=!0)}},s.prototype.setFullBorder=function(e,t,i,r,n,a,o){var l={};r===i[0]&&(this.checkAdjacentBorder(e,"borderBottom",r-1,n),this.checkFullBorder(e,"borderBottom",r-1,n)),n===i[1]&&(this.checkAdjacentBorder(e,"borderRight",r,n-1),this.checkFullBorder(e,"borderRight",r,n-1)),n===i[3]?(this.checkAdjacentBorder(e,"borderLeft",r,n+1),this.checkFullBorder(e,"borderLeft",r,n+1)):this.checkAdjacentBorder(e,"border",r,n+1),l.borderRight=t,l.borderTop=t,l.borderLeft=t,l.borderBottom=t,this.setCellBorder(e,l,r,n,a,n===i[3],null,o),r===i[2]?(this.checkAdjacentBorder(e,"borderTop",r+1,n),this.checkFullBorder(e,"borderTop",r+1,n),this.setBottomBorderPriority(e,r,n)):this.checkAdjacentBorder(e,"border",r+1,n)},s.prototype.checkAdjacentBorder=function(e,t,i,r){var n={};this.parent.getCellStyleValue([t],[i,r])[""+t]!==""&&(n[""+t]=void 0,this.setCellStyle(e,i,r,n))},s.prototype.checkFullBorder=function(e,t,i,r){var n=this.parent.getCellStyleValue(["border"],[i,r]).border;if(n!==""){var a={border:void 0};["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(o){o!==t&&(a[""+o]=n)}),this.setCellStyle(e,i,r,a)}},s.prototype.textDecorationActionUpdate=function(e){var t=this.parent.getActiveSheet(),i={range:t.selectedRange,style:e.style,requestType:"CellFormat"};if(this.parent.trigger("beforeCellFormat",i),this.parent.notify("actionBegin",{eventArgs:i,action:"format"}),i.cancel){e.cancel=!0;return}var r=lt(ee(t.selectedRange)),n=e.style.textDecoration,a=n,o=ee(t.activeCell),l=this.parent.getCellStyleValue(["textDecoration"],o).textDecoration,h,u=!1;l==="underline"?a=n==="underline"?"none":"underline line-through":l==="line-through"?a=n==="line-through"?"none":"underline line-through":l==="underline line-through"&&(a=n==="underline"?"line-through":"underline",u=!0),a==="none"&&(u=!0),this.format({style:{textDecoration:a},range:o,refreshRibbon:e.refreshRibbon,onActionUpdate:!0});for(var c=r[0];c<=r[2];c++)for(var d=r[1];d<=r[3];d++)if(!(c===o[0]&&d===o[1])){if(h={},l=this.parent.getCellStyleValue(["textDecoration"],[c,d]).textDecoration,l==="none"){if(u)continue;h.textDecoration=n}else if(l==="underline"||l==="line-through")if(u)if(n===l)h.textDecoration="none";else continue;else h.textDecoration=n!==l?"underline line-through":n;else if(l==="underline line-through")if(u)h.textDecoration=n==="underline"?"line-through":"underline";else continue;this.format({style:h,range:[c,d,c,d],refreshRibbon:e.refreshRibbon,onActionUpdate:!0})}i.range=t.name+"!"+i.range,i.style.textDecoration=a,this.parent.notify("actionComplete",{eventArgs:i,action:"format"})},s.prototype.setTypedBorder=function(e,t,i,r,n){var a;if(r==="Outer"){for(var o=i[1];o<=i[3];o++)this.checkAdjacentBorder(e,"borderBottom",i[0]-1,o),this.checkFullBorder(e,"borderBottom",i[0]-1,o),this.setCellBorder(e,{borderTop:t},i[0],o,n,o===i[3]),this.checkAdjacentBorder(e,"borderTop",i[2]+1,o),this.checkFullBorder(e,"borderTop",i[2]+1,o),this.setCellBorder(e,{borderBottom:t},i[2],o,n,o===i[3],r),this.setBottomBorderPriority(e,i[2],o);for(var l=i[0];l<=i[2];l++)this.checkAdjacentBorder(e,"borderRight",l,i[1]-1),this.checkFullBorder(e,"borderRight",l,i[1]-1),this.setCellBorder(e,{borderLeft:t},l,i[1],n),this.checkAdjacentBorder(e,"borderLeft",l,i[3]+1),this.checkFullBorder(e,"borderLeft",l,i[3]+1),this.setCellBorder(e,{borderRight:t},l,i[3],n,null,r)}else if(r==="Inner")for(var h=i[0];h<=i[2];h++)for(var u=i[1];u<=i[3];u++){var c={};a=this.parent.getCellStyleValue(["border"],[h,u]).border,a!==""&&(c.border=void 0,(u===i[3]||u===i[1]||h===i[0]||h===i[2])&&(h===i[0]&&(c.borderTop=a),h===i[2]&&(c.borderBottom=a),u===i[3]&&(c.borderRight=a),u===i[1]&&(c.borderLeft=a))),u!==i[3]&&(c.borderRight=t),h!==i[0]&&(c.borderTop=t),h!==i[2]&&(c.borderBottom=t),u!==i[1]&&(c.borderLeft=t),this.setCellBorder(e,c,h,u,n,u===i[3])}else if(r==="Vertical")for(var h=i[0];h<=i[2];h++)for(var u=i[1];u<=i[3];u++){var c={borderRight:t,borderLeft:t};u===i[1]&&(this.checkAdjacentBorder(e,"borderRight",h,u-1),this.checkFullBorder(e,"borderRight",h,u-1)),u===i[3]&&(this.checkAdjacentBorder(e,"borderLeft",h,u+1),this.checkFullBorder(e,"borderLeft",h,u+1)),this.setCellBorder(e,c,h,u,n)}else for(var h=i[0];h<=i[2];h++)for(var u=i[1];u<=i[3];u++){var c={borderTop:t,borderBottom:t};h===i[0]&&(this.checkAdjacentBorder(e,"borderBottom",h-1,u),this.checkFullBorder(e,"borderBottom",h-1,u)),this.setCellBorder(e,c,h,u,n,u===i[3]),h===i[2]&&(this.checkAdjacentBorder(e,"borderTop",h+1,u),this.checkFullBorder(e,"borderTop",h+1,u),this.setBottomBorderPriority(e,h,u))}},s.prototype.setCellBorder=function(e,t,i,r,n,a,o,l,h){if(this.setCellStyle(e,i,r,t),!l&&this.parent.getActiveSheet().id===e.id){if(o==="Outer"&&(t.borderBottom||t.borderRight)){var u={range:[i,r,i,r]};this.parent.notify(cr,u),i=u.range[0],r=u.range[1]}h&&(t.borderTop===""&&this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom!==""&&(t.borderTop=this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom),t.borderLeft===""&&this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight!==""&&(t.borderLeft=this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight),t.borderRight===""&&this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft!==""&&(t.borderRight=this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft)),this.parent.notify(dr,{style:t,rowIdx:i,colIdx:r,onActionUpdate:n,first:"",lastCell:a,isHeightCheckNeeded:!0,manualUpdate:!0})}},s.prototype.setCellStyle=function(e,t,i,r){e.rows[t]?e.rows[t].cells||(e.rows[t].cells=[]):e.rows[t]={cells:[]},e.rows[t].cells[i]||(e.rows[t].cells[i]={}),e.rows[t].cells[i].style||(e.rows[t].cells[i].style={}),Object.assign(e.rows[t].cells[i].style,r,null,!0)},s.prototype.skipHiddenRows=function(e,t){return t++,ct(e,t)&&(t=this.skipHiddenRows(e,t)),t},s.prototype.addEventListener=function(){this.parent.on(Ri,this.format,this),this.parent.on(ld,this.textDecorationActionUpdate,this),this.parent.on(md,this.clearCellObj,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ri,this.format),this.parent.off(ld,this.textDecorationActionUpdate),this.parent.off(md,this.clearCellObj))},s.prototype.clearCellObj=function(e){var t=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,i=e.range&&e.range.indexOf("!")>0?gt(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,r=Pe(this.parent,i),n=lt(ir(t)),a=n[0],o=n[2],l=r.conditionalFormats&&r.conditionalFormats.length&&[].slice.call(r.conditionalFormats),h=[],u,c,d,p,f;for(a;a<=o;a++)for(d=n[1],p=n[3],d;d<=p;d++){var v=Y(a,d,r);if(v)switch(e.type){case"Clear Formats":delete v.format,delete v.rowSpan,delete v.style,delete v.wrap,delete v.colSpan;break;case"Clear Contents":v.hyperlink&&this.parent.notify(Mg,{sheet:r,rowIdx:a,colIdx:d,preventRefresh:!0}),f=!!(v.value||v.formula),delete v.value,delete v.formula,f&&(c={action:"refreshCalculate",rowIndex:a,colIndex:d,sheetIndex:i},this.parent.notify(xt,c),l&&!u&&(u=c.isFormulaDependent,u||_f(l,h,a,d)));break;case"Clear Hyperlinks":delete v.hyperlink;break;case"Clear All":f=!!(v.value||v.formula),Ht(a,d,r,{},!1),f&&(c={action:"refreshCalculate",rowIndex:a,colIndex:d,sheetIndex:i},this.parent.notify(xt,c),l&&!u&&(u=c.isFormulaDependent));break}}(h.length||u)&&i===this.parent.activeSheetIndex&&this.parent.notify(er,{cfModel:!u&&h,refreshAll:u,isAction:!0})},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"workbookcellformat"},s}(),VP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(au,this.performEditOperation,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(au,this.performEditOperation)},s.prototype.getModuleName=function(){return"workbookEdit"},s.prototype.performEditOperation=function(e){var t=e.action;switch(t){case"updateCellValue":e.isFormulaDependent=this.updateCellValue(e.address,e.value,e.sheetIndex,e.isValueOnly,e.skipFormatCheck,e.isRandomFormula,e.skipCellFormat);break}},s.prototype.updateCellValue=function(e,t,i,r,n,a,o){i===void 0&&(i=this.parent.activeSheetIndex);var l,h;typeof e=="string"?l=ee(e):l=e;var u=Pe(this.parent,i),c=Y(l[0],l[1],u,!0);if(c||(c=u.rows[l[0]].cells[l[1]]={}),r)c.value=t;else{var d=Bt(t);d=t==="#SPILL!"?!0:d;var p=!1;c.formula&&c.formula.indexOf("UNIQUE")>-1&&t===""&&(p=!0);var f=rh(c.format)!=="Text"&&(!d||!t.toLowerCase().startsWith("=text("));!d&&!p&&(c.formula&&(c.formula=""),c.value=f?Uc(t):t);var v={action:"refreshCalculate",value:t,rowIndex:l[0],colIndex:l[1],sheetIndex:i,isFormula:d,isRandomFormula:a};if(f&&!n){var g={value:t,rowIndex:l[0],colIndex:l[1],sheetIndex:i,updatedVal:"",skipCellFormat:o};d?t.toLowerCase().includes("unique(")&&(g.updatedVal=t):this.parent.notify(yn,g),!m(g.updatedVal)&&g.updatedVal.length>0&&(c.value=g.updatedVal)}if(t==="#SPILL!")c.value=t;else{var b={cellIdx:l,isUnique:!1};if(this.parent.notify(ou,b),p?t=c.value:(this.parent.notify(xt,v),h=v.isFormulaDependent),d){c.formula=v.value,t=c.value;var y=c.formula.toLowerCase();y==="=now()"&&(!c.format||c.format==="General")?c.format="M/d/yyyy h:mm":y.includes("=time(")&&!c.format&&(c.format="h:mm AM/PM")}else c.value&&typeof c.value=="string"&&(c.value.indexOf("www.")===0||c.value.indexOf("https://")===0||c.value.indexOf("http://")===0||c.value.indexOf("ftp://")===0)&&this.parent.notify(dd,{hyperlink:c.value,cell:u.name+"!"+Je(l[0],l[1])})}}return this.parent.setUsedRange(l[0],l[1],u),this.parent.chartColl.length&&!this.parent.isEdit&&!a&&this.parent.notify(lu,{cell:c,rIdx:l[0],cIdx:l[1],sheetIdx:i}),h},s}(),UP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(dd,this.setLinkHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(dd,this.setLinkHandler)},s.prototype.setLinkHandler=function(e){var t=e.hyperlink,i=e.cell,r;if(i&&i.indexOf("!")!==-1){var n=i.split("!");if(r=Pe(this.parent,gt(this.parent,n[0])),i=n[1],!r)return}else r=this.parent.getActiveSheet(),i=i||r.selectedRange;var a=!e.triggerEvt&&r.isProtected;if(!(a&&!r.protectSettings.insertLink)){var o=lt(ee(i));typeof t=="string"?t.toLowerCase().indexOf("www.")===0&&(t="http://"+t):t.address.toLowerCase().indexOf("www.")===0&&(t.address="http://"+t.address);for(var l,h=ee(r.activeCell),u=o[0];u<=o[2];u++)for(var c=o[1];c<=o[3];c++)a&&Cn(Y(u,c,r),oi(r,c))||(l={hyperlink:t},!m(e.displayText)&&u===h[0]&&c===h[1]&&(e.triggerEvt?u===h[0]&&c===h[1]&&(l.value=e.displayText):m(Y(u,c,r,!1,!0).value)&&(l.value=e.displayText)),l.style={textDecoration:"underline",color:"#00e"},Tn(this.parent,r,{cell:l,rowIdx:u,colIdx:c,preventEvt:!e.triggerEvt}))}},s.prototype.getModuleName=function(){return"workbookHyperlink"},s}(),_P=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.insertModel=function(e){var t=this,i,r,n,a;if(e.model){var o,l=[],h,u,c;if(typeof e.start=="number"){o=e.start,e.end=e.end||o,o>e.end&&(o=e.end,e.end=e.start),e.modelType==="Row"&&o<e.model.maxHgts.length&&(c=[]);for(var d=o;d<=e.end;d++)l.push({}),c&&c.push(null)}else e.start?(o=e.start[0].index||0,l=e.start,u=!0):(o=0,l.push({})),e.modelType==="Row"&&o<e.model.maxHgts.length&&(c=[],l.forEach(function(){c.push(null)}));var p={model:l,index:o,modelType:e.modelType,insertType:e.insertType,cancel:!1,isUndoRedo:e.isUndoRedo},f={eventArgs:p,action:"insert"};if(e.isAction){if(this.parent.notify(li,f),p.cancel)return;delete p.cancel,p.isAction=e.isAction}var v={startIndex:o,endIndex:o+l.length-1,modelType:e.modelType,sheet:e.model,isInsert:!0};if(e.modelType==="Row"){if(e.checkCount!==void 0&&e.model.rows&&e.checkCount===e.model.rows.length)return;if(this.parent.notify(ih,v),e.model=e.model,e.model.rows||(e.model.rows=[]),u&&e.model.usedRange.rowIndex>-1&&o>e.model.usedRange.rowIndex)for(var d=e.model.usedRange.rowIndex;d<o-1;d++)l.splice(0,0,{});var g=this.parent.frozenRowCount(e.model);o<g&&(this.parent.setSheetPropertyOnMute(e.model,"frozenRows",e.model.frozenRows+l.length),p.freezePane=!0),(i=e.model.rows).splice.apply(i,[o,0].concat(l)),c&&(r=e.model.maxHgts).splice.apply(r,[o,0].concat(c)),this.setRowColCount(v.startIndex,v.endIndex,e.model,"row"),o>e.model.usedRange.rowIndex?this.parent.setUsedRange(o+(l.length-1),e.model.usedRange.colIndex,e.model,!0):this.parent.setUsedRange(e.model.usedRange.rowIndex+l.length,e.model.usedRange.colIndex,e.model,!0);for(var b=o+l.length,y,C=void 0,x=function(O){e.model.rows[b]&&e.model.rows[b].cells&&e.model.rows[b].cells[O]&&(C=e.model.rows[b].cells[O],C.rowSpan!==void 0&&C.rowSpan<0&&C.colSpan===void 0&&w.parent.notify(Fy,{range:[b,O,b,O],insertCount:l.length,insertModel:"Row"}),C.style&&Y(o-1,O,e.model,!1,!0).style&&(y=w.checkBorder(C.style,e.model.rows[o-1].cells[O].style),y!=={}&&l.forEach(function(R){R.cells||(R.cells=[]),R.cells[O]||(R.cells[O]={}),R.cells[O].style||(R.cells[O].style={}),Object.assign(R.cells[O].style,y)})))},w=this,d=0;d<=e.model.usedRange.colIndex;d++)x(d);p.sheetCount=e.model.rows.length}else if(e.modelType==="Column"){if(e.checkCount!==void 0&&e.model.columns&&e.checkCount===e.model.columns.length)return;this.parent.notify(ih,v),e.model=e.model,e.model.columns||(e.model.columns=[]),o&&!e.model.columns[o-1]&&(e.model.columns[o-1]={}),(n=e.model.columns).splice.apply(n,[o,0].concat(l));var M=this.parent.frozenColCount(e.model);o<M&&(this.parent.setSheetPropertyOnMute(e.model,"frozenColumns",e.model.frozenColumns+l.length),p.freezePane=!0),this.setRowColCount(v.startIndex,v.endIndex,e.model,"col"),o>e.model.usedRange.colIndex?this.parent.setUsedRange(e.model.usedRange.rowIndex,o+(l.length-1),e.model,!0):this.parent.setUsedRange(e.model.usedRange.rowIndex,e.model.usedRange.colIndex+l.length,e.model,!0),e.model.rows||(e.model.rows=[]);var E=[];e.columnCellsModel||(e.columnCellsModel=[]);for(var d=0;d<l.length;d++)E.push(null);h=[];for(var C=void 0,T=void 0,d=0;d<=e.model.usedRange.rowIndex;d++){e.model.rows[d]?e.model.rows[d].cells||(e.model.rows[d].cells=[]):e.model.rows[d]={cells:[]},o&&!e.model.rows[d].cells[o-1]&&(e.model.rows[d].cells[o-1]={}),(a=e.model.rows[d].cells).splice.apply(a,[o,0].concat(e.columnCellsModel[d]&&e.columnCellsModel[d].cells?e.columnCellsModel[d].cells:E));var b=o+l.length;if(e.model.rows[d].cells[b]&&(C=e.model.rows[d].cells[b],C.colSpan!==void 0&&C.colSpan<0&&C.rowSpan===void 0&&h.push({range:[d,b,d,b],insertCount:E.length,insertModel:"Column"}),C.style&&Y(d,o-1,e.model,!1,!0).style&&(T=this.checkBorder(C.style,e.model.rows[d].cells[o-1].style),T!=={})))for(var D=o;D<b;D++)e.model.rows[d].cells[D]||(e.model.rows[d].cells[D]={}),e.model.rows[d].cells[D].style||(e.model.rows[d].cells[D].style={}),Object.assign(e.model.rows[d].cells[D].style,T)}h.forEach(function(R){t.parent.notify(Fy,R)}),p.sheetCount=e.model.columns.length}else{if(e.checkCount!==void 0&&e.checkCount===this.parent.sheets.length)return;for(var N=l,A=Ns(this.parent),L=e.isFromUpdateAction,d=0;d<N.length;d++)if(N[d].name){for(var D=0;D<this.parent.sheets.length;D++)if(N[d].name===this.parent.sheets[D].name){N.splice(d,1),d--;break}}if(!N.length)return;delete l[0].index,this.parent.createSheet(o,l);var k;e.activeSheetIndex?(p.activeSheetIndex=e.activeSheetIndex,this.parent.setProperties({activeSheetIndex:e.activeSheetIndex},!0)):!e.isAction&&e.start<this.parent.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),L&&this.parent.setProperties({activeSheetIndex:gt(this.parent,A)},!0),l.forEach(function(O){u&&t.updateRangeModel(O.ranges);var R=t.parent.viewport,j=[R.topIndex,R.leftIndex,R.bottomIndex,R.rightIndex],P={sheet:O,resolveAfterFullDataLoaded:!0,indexes:j,promise:new Promise(function(F){F(function(){}())})};t.parent.notify(od,P),k=O.id,t.parent.notify(xt,{action:"addSheet",visibleName:O.name,sheetName:"Sheet"+k,sheetId:k})}),p.activeSheetIndex=e.activeSheetIndex,p.sheetCount=this.parent.sheets.length}e.modelType!=="Sheet"&&(this.insertConditionalFormats(e),this.parent.notify(Uy,{start:o,end:o+l.length-1,modelType:e.modelType,model:e.model,isInsert:!0}),p.activeSheetIndex=gt(this.parent,e.model.name)),this.parent.notify(s1,f)}},s.prototype.setRowColCount=function(e,t,i,r){var n=r+"Count";this.parent.setSheetPropertyOnMute(i,n,i[""+n]+(t-e+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(hd,{index:i[""+n]-1,update:r,isInsert:!0,start:e,end:t})},s.prototype.updateRangeModel=function(e){e.forEach(function(t){t.dataSource&&(t.startCell=t.startCell||"A1",t.showFieldAsHeader=t.showFieldAsHeader===void 0||t.showFieldAsHeader,t.template=t.template||"",t.address=t.address||"A1")})},s.prototype.checkBorder=function(e,t){var i={};return e.borderLeft&&e.borderLeft===t.borderLeft&&(i.borderLeft=e.borderLeft),e.borderRight&&e.borderRight===t.borderRight&&(i.borderRight=e.borderRight),e.borderTop&&e.borderTop===t.borderTop&&(i.borderTop=e.borderTop),e.borderBottom&&e.borderBottom===t.borderBottom&&(i.borderBottom=e.borderBottom),i},s.prototype.setInsertInfo=function(e,t,i,r,n){n===void 0&&(n="Row");var a=i=t+(i-1);e.ranges.forEach(function(o){o.info&&t<o.info[""+r]&&(o.info["insert"+n+"Range"]?o.info["insert"+n+"Range"].push([t,a]):o.info["insert"+n+"Range"]=[[t,a]],o.info[""+r]+=a-t+1)})},s.prototype.insertConditionalFormats=function(e){var t=e.model.conditionalFormats;if(e.prevAction==="delete")this.parent.setSheetPropertyOnMute(e.model,"conditionalFormats",e.conditionalFormats);else if(t)for(var i=0,r=t.length;i<r;i++)t[i].range=je(k6(e,ee(t[i].range),!e.isAction&&!e.isUndoRedo))},s.prototype.addEventListener=function(){this.parent.on(Js,this.insertModel,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Js,this.insertModel)},s.prototype.getModuleName=function(){return"workbookinsert"},s}(),m6=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.deleteModel=function(e){var t=this,i=this.parent.sheets.length;if(!(e.modelType==="Sheet"&&i===1)){var r=e.modelType.toLowerCase()+"s";if(e.start=e.start,e.start>e.end){var n=e.start;e.start=e.end,e.end=n}var a={startIndex:e.start,endIndex:e.end,modelType:e.modelType,cancel:!1,isUndoRedo:e.isUndoRedo},o={eventArgs:a,action:"delete"};if(!(e.isAction&&(this.parent.notify(li,o),a.cancel))){var l,h,u=[],c=e.end-e.start+1,d={startIndex:e.start,endIndex:e.end,modelType:e.modelType,sheet:e.model},p=this.parent.scrollSettings.isFinite;if(e.modelType==="Row"){if(e.checkCount!==void 0&&e.checkCount===e.model.usedRange.rowIndex)return;if(this.parent.notify(ih,d),e.model=e.model,p){if(e.start>=e.model.rowCount)return;e.end>=e.model.rowCount&&(e.end=e.model.rowCount-1)}else{if(e.start>e.model.usedRange.rowIndex)return;e.end>e.model.usedRange.rowIndex&&(e.end-=e.end-e.model.usedRange.rowIndex)}this.setRowColCount(e.start,e.end,e.model,"row"),e.start<=e.model.usedRange.rowIndex&&(e.model.usedRange.rowIndex-=e.end-e.start+1,e.model.usedRange.rowIndex<0&&(e.model.usedRange.rowIndex=0));var f=this.parent.frozenRowCount(e.model);e.start<f&&(f=e.end<f?e.end-e.start+1:f-e.start,f=e.model.frozenRows-f,this.parent.setSheetPropertyOnMute(e.model,"frozenRows",f),a.freezePane=!0);var v=e.end+1,g=void 0,b=void 0;if(e.model.rows[e.start]&&e.model.rows[e.start].cells)for(var y=0;y<=e.model.usedRange.colIndex;y++){if(e.model.rows[e.start].cells[y]&&e.model.rows[e.start].cells[y].rowSpan!==void 0&&e.model.rows[e.start].cells[y].rowSpan<0&&e.model.rows[e.start].cells[y].colSpan===void 0&&(b={range:[e.start,y,e.start,y]},this.parent.notify(cr,b),b.range=b.range,b.range[2]<=e.end&&(h=Y(b.range[0],y,e.model),h&&h.rowSpan>1&&(h.rowSpan-(b.range[2]-e.start+1)>1?Ht(b.range[0],y,e.model,{colSpan:h.rowSpan-(b.range[2]-e.start+1)},!0):delete e.model.rows[b.range[0]].cells[y].rowSpan),b=null)),e.model.rows[v]&&e.model.rows[v].cells&&e.model.rows[v].cells[y]&&e.model.rows[v].cells[y].rowSpan!==void 0&&e.model.rows[v].cells[y].rowSpan<0&&e.model.rows[v].cells[y].colSpan===void 0&&(b||(b={range:[v,y,v,y]},this.parent.notify(cr,b)),g=new Object,b.range=b.range,Object.assign(g,Y(b.range[0],b.range[1],e.model)),g&&g.rowSpan&&(g.rowSpan>1||g.colSpan>1))){var C=[];C[1]=y,C[3]=g.colSpan>1?y+(g.colSpan-1):y,b.range=b.range,b.range[0]<e.start?(C[0]=C[2]=b.range[0],g.rowSpan-c>1&&(C[2]+=g.rowSpan-c-1)):(C[0]=C[2]=e.start,g.rowSpan-(e.end-b.range[0]+1)>1&&(C[2]+=g.rowSpan-(e.end-b.range[0]+1)-1)),u.push({range:C,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}b=null}a.sheetCount=e.model.usedRange.rowIndex}else if(e.modelType==="Column"){if(e.checkCount!==void 0&&e.checkCount===e.model.usedRange.colIndex)return;if(this.parent.notify(ih,d),e.model=e.model,p){if(e.start>=e.model.colCount)return;e.end>=e.model.colCount&&(e.end=e.model.colCount-1)}else{if(e.start>e.model.usedRange.colIndex)return;e.end>e.model.usedRange.colIndex&&(e.end-=e.end-e.model.usedRange.colIndex)}this.setRowColCount(e.start,e.end,e.model,"col"),e.start<=e.model.usedRange.colIndex&&(e.model.usedRange.colIndex-=c,e.model.usedRange.colIndex<0&&(e.model.usedRange.colIndex=0));var x=this.parent.frozenColCount(e.model);e.start<x&&(x=e.end<x?e.end-e.start+1:x-e.start,x=e.model.frozenColumns-x,this.parent.setSheetPropertyOnMute(e.model,"frozenColumns",x),this.parent.updateTopLeftCell(),a.freezePane=!0),l=[];for(var v=e.end+1,g=void 0,b=void 0,y=0;y<=e.model.usedRange.rowIndex;y++)if(l.push({}),e.model.rows[y]&&e.model.rows[y].cells){if(e.model.rows[y].cells[e.start]&&e.model.rows[y].cells[e.start].colSpan!==void 0&&e.model.rows[y].cells[e.start].colSpan<0&&e.model.rows[y].cells[e.start].rowSpan===void 0&&(b={range:[y,e.start,y,e.start]},this.parent.notify(cr,b),b.range=b.range,b.range[3]<=e.end)){var w=Y(y,b.range[1],e.model);w&&w.colSpan>1&&(w.colSpan-(b.range[3]-e.start+1)>1?Ht(y,b.range[1],e.model,{colSpan:w.colSpan-(b.range[3]-e.start+1)},!0):delete e.model.rows[y].cells[b.range[1]].colSpan),b=null}if(e.model.rows[y].cells[v]&&e.model.rows[y].cells[v].colSpan!==void 0&&e.model.rows[y].cells[v].colSpan<0&&e.model.rows[y].cells[v].rowSpan===void 0&&(b||(b={range:[y,v,y,v]},this.parent.notify(cr,b)),g=new Object,b.range=b.range,Object.assign(g,Y(b.range[0],b.range[1],e.model)),g&&g.colSpan&&(g.colSpan>1||g.rowSpan>1))){var C=[];C[0]=y,C[2]=g.rowSpan>1?y+(g.rowSpan-1):y,b.range=b.range,b.range[1]<e.start?(C[1]=C[3]=b.range[1],g.colSpan-c>1&&(C[3]+=g.colSpan-c-1)):(C[1]=C[3]=e.start,g.colSpan-(e.end-b.range[1]+1)>1&&(C[3]+=g.colSpan-(e.end-b.range[1]+1)-1)),u.push({range:C,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}l[y].cells=e.model.rows[y].cells.splice(e.start,c),b=null}a.sheetCount=e.model.usedRange.colIndex,a.deletedCellsModel=l}else{if(e.end-e.start===this.parent.sheets.length-1||e.checkCount!==void 0&&e.checkCount===this.parent.sheets.length)return;a.sheetCount=this.parent.sheets.length,a.activeSheetIndex=this.parent.activeSheetIndex}for(var M=[],E=e.modelType==="Row"&&e.start<e.model.maxHgts.length,y=e.start;y<=e.end;y++){var T=e.model[""+r];e.modelType==="Sheet"&&T[y]&&this.parent.notify(xt,{action:"deleteSheetTab",sheetId:T[y].id}),T[e.start]||e.start<T.length?(M.push(T[e.start]||{}),T.splice(e.start,1)):M.push({}),y===e.start&&(M[0].index=e.start),E&&e.model.maxHgts.splice(e.start,1)}u.forEach(function(D){return t.parent.notify(Fn,D)}),this.parent.notify(Vf,e),e.modelType!=="Sheet"&&(this.parent.notify(Uy,e),a.refreshSheet=e.refreshSheet,a.activeSheetIndex=gt(this.parent,e.model.name),a.conditionalFormats=[],this.deleteConditionalFormats(e,a)),a.definedNames=d.definedNames,a.isAction=e.isAction,a.deletedModel=M,delete a.cancel,this.parent.notify(a1,o)}}},s.prototype.setRowColCount=function(e,t,i,r){var n=r+"Count",a=i[""+n];t>=a&&(t=a-1),!(t<e)&&(this.parent.setSheetPropertyOnMute(i,n,a-(t-e+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(hd,{index:a-1,update:r,isDelete:!0,start:e,end:t}))},s.prototype.setDeleteInfo=function(e,t,i,r){r===void 0&&(r="Row");var n=t-e+1,a=[];this.parent.getActiveSheet().ranges.forEach(function(o){o.info&&e<o.info[""+i]&&(o.info["delete"+r+"Range"]?o.info["delete"+r+"Range"].push([e,t]):o.info["delete"+r+"Range"]=[[e,t]],o.info[""+i]-=n,o.info["insert"+r+"Range"]&&(o.info["insert"+r+"Range"]=a))})},s.prototype.deleteConditionalFormats=function(e,t){var i=e.model.conditionalFormats;if(i)for(var r=0;r<i.length;r++){t.conditionalFormats.push(me({},i[r],null,!0));var n=ee(i[r].range),a=ee(e.model.selectedRange);e.modelType==="Column"&&a[1]<=n[1]&&a[3]>=n[3]||e.modelType==="Row"&&a[0]<=n[0]&&a[2]>=n[2]?(i.splice(i.indexOf(i[r]),1),r--):i[r].range=je(L6(e,n))}},s.prototype.addEventListener=function(){this.parent.on(zf,this.deleteModel,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(zf,this.deleteModel)},s.prototype.getModuleName=function(){return"workbookdelete"},s}(),WP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Yo,this.validationHandler,this),this.parent.on(pd,this.addHighlightHandler,this),this.parent.on(h1,this.removeHighlightHandler,this),this.parent.on(Hf,this.beforeInsertDeleteHandler,this),this.parent.on(Vf,this.beforeInsertDeleteHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Yo,this.validationHandler),this.parent.off(pd,this.addHighlightHandler),this.parent.off(h1,this.removeHighlightHandler),this.parent.off(Hf,this.beforeInsertDeleteHandler),this.parent.off(Vf,this.beforeInsertDeleteHandler))},s.prototype.validationHandler=function(e){var t=this,i=e.range,r="";e.range.indexOf("!")>-1&&(i=e.range.split("!")[1],r=e.range.split("!")[0]);var n=Pe(this.parent,r?gt(this.parent,r):this.parent.activeSheetIndex);this.parent.dataValidationRange=(this.parent.dataValidationRange.indexOf("!")>-1?"":n.name+"!")+this.parent.dataValidationRange+i+",";var a=this.getRangeWhenColumnSelected(i,n);i=a.range,m(r)||(e.range=r+"!"+i),e.range=e.range||n.selectedRange;var o=lt(ee(e.range)),l,h,u;e.viewport&&a.isFullCol&&(u=SI(this.parent,e.viewport));for(var c=function(f){if(a.isFullCol)if(h=oi(n,f),e.isRemoveValidation){if(h&&h.validation)return delete h.validation,u&&u.forEach(function(g){for(var b=g[0];b<=g[2];b++)l=Y(b,f,n),t.parent.notify(dr,{rowIdx:b,colIdx:f,style:t.parent.getCellStyleValue(["backgroundColor","color"],[b,f])})}),"continue"}else return h=oi(n,f),h.validation={operator:e.rules.operator,type:e.rules.type,value1:e.rules.value1,value2:e.rules.value2,inCellDropDown:e.rules.inCellDropDown,ignoreBlank:e.rules.ignoreBlank},"continue";for(var v=o[0];v<=o[2];v++)e.isRemoveValidation?(v===o[2]&&(h=oi(n,f),h&&h.validation&&(h.validation.address=A6(h.validation.address,[o[0],f,o[2],f],f))),l=Y(v,f,n),l&&l.validation&&!Tn(d.parent,n,{cell:{validation:{}},rowIdx:v,colIdx:f})&&(delete l.validation,d.parent.notify(dr,{rowIdx:v,colIdx:f,style:d.parent.getCellStyleValue(["backgroundColor","color"],[v,f])}))):(l={validation:Object.assign({},e.rules)},Tn(d.parent,n,{cell:l,rowIdx:v,colIdx:f}))},d=this,p=o[1];p<=o[3];p++)c(p)},s.prototype.addHighlightHandler=function(e){this.InvalidDataHandler(e.range,!1,e.td,e.isclearFormat)},s.prototype.removeHighlightHandler=function(e){this.InvalidDataHandler(e.range,!0)},s.prototype.getRange=function(e){var t=ee(e),i=this.parent.getActiveSheet(),r=i.colCount,n=i.rowCount;return t[2]===n-1&&t[0]===0?e=e.replace(/[0-9]/g,""):t[3]===r-1&&t[2]===0&&(e=e.replace(/\D/g,"")),e},s.prototype.InvalidDataHandler=function(e,t,i,r){var n=!1,a,o,l=e?La(this.parent,e):this.parent.activeSheetIndex,h=Pe(this.parent,l);e=e||h.selectedRange;var u=e.includes("!")?Ms(e):h.name,c=this.getRangeWhenColumnSelected(nu(e),h),d=c.isFullCol;e=u+"!"+c.range;var p=e?lt(ee(e)):[];e=this.getRange(e);var f=e?p[0]:0,v=e?p[2]:h.rows.length;for(f;f<=v;f++)if(h.rows[f]){var g=e?p[1]:0,b=e?p[3]:h.rows[f].cells.length;for(g;g<=b;g++){var y=void 0;if(h.rows[f].cells&&h.rows[f].cells[g]){var C=oi(h,g);if(a=h.rows[f].cells[g],a&&a.validation){if(y=a.validation,r&&!y.isHighlighted)return;t?y.isHighlighted&&(a.validation.isHighlighted=!1):a.validation.isHighlighted=!0}else if(C&&C.validation){if(y=C.validation,r&&!y.isHighlighted)return;t&&d?y.isHighlighted&&(C.validation.isHighlighted=!1):d&&(C.validation.isHighlighted=!0)}o=a.value?a.value:"";var x=[f,g];if(y&&this.parent.allowDataValidation){var w={value:o,range:x,sheetIdx:l,isCell:n,td:i,isValid:!0};this.parent.notify(jf,w);var M=w.isValid;M||!ct(h,f)&&l===this.parent.activeSheetIndex&&this.parent.notify(v1,{isRemoveHighlightedData:t,rowIdx:f,colIdx:g,td:i})}}}}},s.prototype.beforeInsertDeleteHandler=function(e){if(e.modelType!=="Sheet")for(var t,i,r=0,n=this.parent.sheets.length;r<n;r++){i=this.parent.sheets[r];for(var a=0,o=i.rows.length;a<o;a++)if(i.rows[a]&&i.rows[a].cells){for(var l=0,h=i.rows[a].cells.length;l<h;l++)if(t=i.rows[a].cells[l],t&&t.validation){var u=e.name==="beforeInsert",c=e.index+(e.model.length-1),d=e.modelType==="Row"?a>=e.index&&a<=c:l>=e.index&&l<=c,p=void 0;u?p={insertDeleteArgs:{startIndex:e.index,endIndex:e.index+e.model.length-1,modelType:e.modelType,isInsert:!0,sheet:Pe(this.parent,e.activeSheetIndex)},row:a,col:l,sheetIdx:r}:p={insertDeleteArgs:{startIndex:e.start,modelType:e.modelType,endIndex:e.end,sheet:e.model},row:a,col:l,sheetIdx:r},Bt(t.validation.value1)&&!d&&(p.cell={formula:t.validation.value1},this.parent.notify(Wy,p),t.validation.value1=p.cell.formula),Bt(t.validation.value2)&&!d&&(p.cell={formula:t.validation.value2},this.parent.notify(Wy,p),t.validation.value2=p.cell.formula),e.activeSheetIndex===r&&u&&this.updateValidationForInsertedModel(e,i,a,l,t.validation)}}}},s.prototype.getRangeWhenColumnSelected=function(e,t){var i,r=e.split(":");return e.match(/\D/g)&&!e.match(/[0-9]/g)?(r[0]+=1,r[1]+=t.rowCount,e=r[0]+":"+r[1],i=!0):!e.match(/\D/g)&&e.match(/[0-9]/g)&&(r[0]="A"+r[0],r[1]=Je(0,t.colCount-1).replace(/[0-9]/g,"")+r[1],e=r[0]+":"+r[1]),{range:e,isFullCol:i}},s.prototype.updateValidationForInsertedModel=function(e,t,i,r,n){var a=e.index+(e.model.length-1);if(e.modelType==="Column"){if(e.insertType==="before"&&a===r-1||e.insertType==="after"&&e.index-1===r)for(var o=e.index;o<=a;o++)Ht(i,o,t,{validation:me({},n)},!0)}else if(e.modelType==="Row"&&(e.insertType==="above"&&a===i-1||e.insertType==="below"&&e.index-1===i))for(var o=e.index;o<=a;o++)Ht(o,r,t,{validation:me({},n)},!0)},s.prototype.getModuleName=function(){return"workbookDataValidation"},s}(),x1=function(){return x1=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},x1.apply(this,arguments)},qP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(o1,this.find,this),this.parent.on(Bf,this.replace,this),this.parent.on(fd,this.replaceAll,this),this.parent.on(Ly,this.totalCount,this),this.parent.on(Jw,this.findAllValues,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(o1,this.find),this.parent.off(Bf,this.replace),this.parent.off(fd,this.replaceAll),this.parent.off(Ly,this.totalCount),this.parent.off(Jw,this.findAllValues))},s.prototype.find=function(e){var t=this.parent.sheets[e.sheetIndex],i=ee(t.activeCell),r={startRow:i[0],startCol:i[1],findVal:e.isCSen?e.value:e.value.toLowerCase(),activeCell:i};(e.searchBy==="By Row"?r.startRow>t.usedRange.rowIndex:r.startCol>t.usedRange.colIndex)?e.findOpt==="next"?r.startRow=r.startCol=0:(r.startRow=t.usedRange.rowIndex,r.startCol=t.usedRange.colIndex):e.searchBy==="By Row"?r.startCol>t.usedRange.colIndex&&(e.findOpt==="next"?(r.startRow++,r.startRow>t.usedRange.rowIndex&&(r.startRow=0),r.startCol=0):(r.startRow--,r.startRow<0&&(r.startRow=t.usedRange.rowIndex),r.startCol=t.usedRange.colIndex)):r.startRow>t.usedRange.rowIndex&&(e.findOpt==="next"?(r.startCol++,r.startCol>t.usedRange.colIndex&&(r.startRow=0),r.startRow=0):(r.startCol--,r.startCol<0&&(r.startCol=t.usedRange.colIndex),r.startRow=t.usedRange.colIndex)),e.mode==="Workbook"?(r.sheets=this.parent.sheets,r.sheetIdx=e.sheetIndex):(r.sheets=[t],r.sheetIdx=0);var n,a=e.showDialog&&this.parent.element&&this.parent.element.querySelector(".e-header-panel");a&&(n=(a.offsetHeight||(t.showHeaders?30:0))+1),e.findOpt==="next"?this.findNext(e,r):this.findPrevious(e,r),e.showDialog&&this.parent.notify(su,{findValue:e.value,isPublic:!0,headerHgt:n})},s.prototype.findNext=function(e,t){var i=this,r=function(a,o,l){for(var h,u,c=a;c<=o&&(h=t.sheets[c],c===t.sheetIdx?l?u=i.findNextOnSheet(e,t.startRow,t.startCol,t.findVal,h,void 0,t.activeCell):u=i.findNextOnSheet(e,0,0,t.findVal,h,e.searchBy==="By Row"?t.startRow:t.startCol):u=i.findNextOnSheet(e,0,0,t.findVal,h),!u);c++);return u},n=r(t.sheetIdx,t.sheets.length-1,!0);n||(n=r(0,t.sheetIdx)),n?this.parent.notify(_h,{address:n}):this.parent.notify(ky,null)},s.prototype.findNextOnSheet=function(e,t,i,r,n,a,o){var l,h,u;if(e.searchBy==="By Row"){a===void 0&&(a=n.rows.length-1);var c=void 0;for(h=t;h<=a;h++)if(!ct(n,h)){for(u=o&&h===t?i:0,c=n.rows[h]&&n.rows[h].cells&&n.rows[h].cells.length,u;u<c;u++)if(!Yt(n,u)&&(l=this.checkMatch(e,r,h,u,n,o),l))return l}}else{a===void 0&&(a=n.usedRange.colIndex);var d=n.rows&&n.rows.length-1;for(u=i;u<=a;u++)if(!Yt(n,u)){for(h=o&&u===i?t:0,h;h<=d;h++)if(!ct(n,h)&&(l=this.checkMatch(e,r,h,u,n,o),l))return l}}return l},s.prototype.findPrevious=function(e,t){var i=this,r=function(a,o,l){for(var h,u,c=a;c>=o&&(h=t.sheets[c],c===t.sheetIdx?l?u=i.findPrevOnSheet(e,t.startRow,t.startCol,0,0,t.findVal,h,t.activeCell):e.searchBy==="By Row"?u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,t.startRow,0,t.findVal,h):u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,0,t.startCol,t.findVal,h):u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,0,0,t.findVal,h),!u);c--);return u},n;n=r(t.sheetIdx,0,!0),n||(n=r(t.sheets.length-1,t.sheetIdx)),n?this.parent.notify(_h,{address:n}):this.parent.notify(ky,null)},s.prototype.findPrevOnSheet=function(e,t,i,r,n,a,o,l){var h,u,c;if(e.searchBy==="By Row"){for(c=t;c>=r;c--)if(!ct(o,c)){for(u=l&&c===t?i:o.rows[c]&&o.rows[c].cells&&o.rows[c].cells.length-1,u;u>=n;u--)if(!Yt(o,u)&&(h=this.checkMatch(e,a,c,u,o,l),h))return h}}else for(u=i;u>=n;u--)if(!Yt(o,u)){for(c=l&&u===i?t:o.rows&&o.rows.length-1,c;c>=r;c--)if(!ct(o,c)&&(h=this.checkMatch(e,a,c,u,o,l),h))return h}return h},s.prototype.checkMatch=function(e,t,i,r,n,a){if(a&&i===a[0]&&r===a[1])return null;var o=Y(i,r,n,!1,!0);if(n.isProtected&&!n.protectSettings.selectCells&&n.protectSettings.selectUnLockedCells&&Cn(o,oi(n,r)))return null;var l=this.parent.getDisplayText(o);if(l){if(e.isCSen||(l=l.toLowerCase()),e.isEMatch){if(l===t)return n.name+"!"+Je(i,r)}else if(l.includes(t))return n.name+"!"+Je(i,r)}return null},s.prototype.replace=function(e){var t=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=Pe(this.parent,e.sheetIndex);if(i.isProtected){this.parent.notify(i6,null);return}var r=e.address,n=ee(r||i.activeCell),a=this.parent.getDisplayText(Y(n[0],n[1],i,!1,!0)).toString(),o;e.value=e.value.toString(),e.isCSen||(o=e.value.toLowerCase());var l=this.getReplaceValue(e,a,o);if(!(!l&&(e.findOpt="next",this.find(e),n=xe(i.activeCell),a=this.parent.getDisplayText(Y(n[0],n[1],i)).toString(),l=this.getReplaceValue(e,a,o),!l))){var h={address:i.name+"!"+Je(n[0],n[1]),cancel:!1,compareValue:e.value,replaceValue:e.replaceValue,sheetIndex:t};if(e.isAction){if(this.parent.notify(li,{action:"beforeReplace",eventArgs:h}),h.cancel)return;delete h.cancel}Tn(this.parent,i,{cell:{value:l},rowIdx:n[0],colIdx:n[1],uiRefresh:!0,valChange:!0}),e.isAction&&this.parent.notify("actionComplete",{action:"replace",eventArgs:h})}},s.prototype.replaceAll=function(e){var t=this,i=e.mode==="Sheet"?e.sheetIndex:0,r=this.parent.sheets[i],n=r.usedRange.rowIndex,a=0,o=r.usedRange.colIndex,l=0,h=[],u=e.isAction,c=x1({addressCollection:h,cancel:!1},e),d=function(y,C){requestAnimationFrame?requestAnimationFrame(function(){if(!c.cancel&&c.addressCollection[C]){var x=xe(c.addressCollection[C].split("!")[1]),w=La(t.parent,c.addressCollection[C]);Tn(t.parent,t.parent.sheets[w],{cell:{value:y},rowIdx:x[0],uiRefresh:!0,colIdx:x[1],valChange:!0,skipFormatCheck:e.skipFormatCheck}),C===c.addressCollection.length-1&&u&&t.parent.notify("actionComplete",{action:"replaceAll",eventArgs:c})}}):t.parent.updateCell({value:y},c.addressCollection[C])},p,f,v;for(a;a<=n+1;a++){if(l>o&&a>n&&e.mode==="Workbook")if(i++,r=this.parent.sheets[i],r)l=0,a=0,o=r.usedRange.colIndex,n=r.usedRange.rowIndex;else break;if(f=r.rows[a],f){for(l===o+1&&(l=0),l;l<=o;l++)if(f&&f.cells&&f.cells[l]&&(p=this.parent.getDisplayText(r.rows[a].cells[l]).toString(),p))if(e.isCSen)e.isEMatch?p===e.value&&(d(e.replaceValue,h.length),h.push(r.name+"!"+Je(a,l))):p.indexOf(e.value)>-1&&(d(p.replace(e.value,e.replaceValue),h.length),h.push(r.name+"!"+Je(a,l)));else if(e.isEMatch)p.toLowerCase()===e.value&&(d(e.replaceValue,h.length),h.push(r.name+"!"+Je(a,l)));else{var g=p.toLowerCase();if(p===e.value||g.indexOf(e.value.toString().toLowerCase())>-1||g===e.value||p===e.value||g.indexOf(e.value)>-1){var b=RegExp;v=new b(e.value.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),d(p.replace(v,e.replaceValue),h.length),h.push(r.name+"!"+Je(a,l))}}}}h.length&&u?(this.parent.notify("actionBegin",{action:"beforeReplaceAll",eventArgs:c}),c.cancel||this.parent.notify(Oy,{count:c.addressCollection.length,replaceValue:c.replaceValue})):this.parent.notify(Oy,{count:c.addressCollection.length,replaceValue:c.replaceValue})},s.prototype.getReplaceValue=function(e,t,i){if(e.isCSen)return e.isEMatch?t===e.value&&e.replaceValue:t.indexOf(e.value)>-1&&t.replace(e.value,e.replaceValue);if(e.isEMatch)return t.toLowerCase()===i&&e.replaceValue;var r=RegExp;return t.toLowerCase().includes(i)&&t.replace(new r(e.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),e.replaceValue)},s.prototype.totalCount=function(e){var t=this,i=this.parent.sheets[e.sheetIndex],r=xe(i.activeCell),n=0,a=0,o,l=e.value.toLowerCase();i.rows.filter(function(u,c){return u&&u.cells&&!u.isFiltered&&!u.hidden&&u.cells.filter(function(d,p){d&&(d.value||d.value===0)&&!Yt(i,p)&&(!i.isProtected||i.protectSettings.selectCells||!Cn(d,oi(i,p)))&&(o=(d.format?t.parent.getDisplayText(d):d.value.toString()).toLowerCase(),o.includes(l)&&(n++,(c===r[0]&&p>=r[1]||c>r[0])&&a++))})}),a-=1;var h=n;n=h-a,n>h&&(n=h),n!==0&&!this.parent.getDisplayText(Y(r[0],r[1],i)).toLowerCase().includes(l)&&(n-=1),e.findCount=n+" of "+h},s.prototype.findAllValues=function(e){var t=e.sheetIndex,i=this.parent.sheets[t],r=i.usedRange.rowIndex,n=0,a=0,o,l=i.usedRange.colIndex,h=0,u=this.parent.sheets.length,c=e.sheetIndex;for(n;n<=r+1;n++){if(c!==1&&e.sheetIndex===u&&(t=1),n>r&&h>l&&e.mode==="Workbook"){if(t++,c===t)return void 0;t>u-1&&(t=0),i=this.parent.sheets[t],i&&(n=0,h=0,l=i.usedRange.colIndex,r=i.usedRange.rowIndex)}if(!m(i)&&i.rows[n]){var d=i.rows[n];for(h===l+2&&(h=0),h;h<=l+1;h++)if(d&&d.cells&&d.cells[h]){var p=i.rows[n].cells[h];if(p&&!m(p.value)&&p.value!==""&&(!i.isProtected||i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!Cn(p,oi(i,h)))){var f=p.format,v=void 0;if(f){var g=this.parent.getDisplayText(i.rows[n].cells[h]);v=g.toString()}else v=p.value.toString();if(e.isCSen&&e.isEMatch)v===e.value&&(o=i.name+"!"+Je(n,h),e.findCollection.push(o),a++);else if(e.isCSen&&!e.isEMatch){var b=v.indexOf(e.value)>-1;(v===e.value||b)&&(o=i.name+"!"+Je(n,h),e.findCollection.push(o),a++)}else if(!e.isCSen&&e.isEMatch){var y=v.toString().toLowerCase();y===e.value&&(o=i.name+"!"+Je(n,h),e.findCollection.push(o),a++)}else if(!e.isCSen&&!e.isEMatch){var y=v.toString().toLowerCase(),b=y.indexOf(e.value.toLowerCase())>-1;(y===e.value||v===e.value||b||v===e.value)&&(o=i.name+"!"+Je(n,h),e.findCollection.push(o),a++)}}}}}},s.prototype.getModuleName=function(){return"workbookfindAndReplace"},s}(),YP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.protectsheetHandler=function(e){var t=m(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=Pe(this.parent,t);this.parent.setSheetPropertyOnMute(i,"isProtected",!0),this.parent.setSheetPropertyOnMute(i,"protectSettings",{selectCells:e.protectSettings.selectCells,formatCells:e.protectSettings.formatCells,formatColumns:e.protectSettings.formatColumns,formatRows:e.protectSettings.formatRows,insertLink:e.protectSettings.insertLink,selectUnLockedCells:e.protectSettings.selectUnLockedCells}),this.parent.notify(u1,{sheetIndex:t,triggerEvent:e.triggerEvent}),this.parent.notify(kA,{props:"Protect"}),i.password=e.password?e.password:"",i.columns.forEach(function(r){r&&Re(r.isLocked)&&(r.isLocked=!0)})},s.prototype.unprotectsheetHandler=function(e){var t=this.parent.getActiveSheet();t.isImportProtected&&(t.isImportProtected=!1),e.sheet&&(t=this.parent.sheets[e.sheet]),t.protectSettings.formatCells=t.protectSettings.formatColumns=!1,t.protectSettings.formatRows=t.protectSettings.selectCells=!1,this.parent.setSheetPropertyOnMute(t,"isProtected",!1),this.parent.notify(u1,t.protectSettings),this.parent.notify(kA,{props:"Protect"})},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Hc,this.protectsheetHandler,this),this.parent.on(kP,this.unprotectsheetHandler,this),this.parent.on(Ry,this.lockCells,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Hc,this.protectsheetHandler),this.parent.off(Ry,this.lockCells),this.parent.off(Hc,this.unprotectsheetHandler))},s.prototype.lockCells=function(e){var t=this.parent.getAddressInfo(e.range),i=lt(t.indices),r=Pe(this.parent,t.sheetIndex),n=e.isLocked?e.isLocked:!1;if(i[0]===0&&i[2]===r.rowCount-1)for(var a=i[1];a<=i[3];a++)Td(r,a,{isLocked:e.isLocked});for(var a=i[0];a<=i[2];a++)for(var o=i[1];o<=i[3];o++)Ht(a,o,r,{isLocked:n},!0);e.triggerEvent&&this.parent.notify("actionComplete",{action:"lockCells",eventArgs:e})},s.prototype.getModuleName=function(){return"workbookProtectSheet"},s}(),QP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.merge=function(e){e.sheetIndex=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,e.isAction&&(this.parent.notify("actionBegin",{eventArgs:e,action:"merge"}),e.model||(e.model=[])),typeof e.range=="string"&&(e.range=ee(e.range)),e.range=lt(e.range),e.skipChecking||this.mergedRange(e),!e.merge||e.type==="All"?(this.mergeAll(e),e.refreshRibbon&&this.parent.notify(sa,null)):e.type==="Horizontally"?this.mergeHorizontally(e):e.type==="Vertically"&&this.mergeVertically(e),this.parent.setUsedRange(e.range[2],e.range[3]),e.isAction&&this.parent.notify("actionComplete",{eventArgs:e,action:"merge"}),e.sheetIndex===this.parent.activeSheetIndex&&(this.parent.notify("selectRange",{address:Pe(this.parent,e.sheetIndex).selectedRange,skipChecking:!0}),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(lu,{range:e.range}))},s.prototype.mergeAll=function(e){var t=0,i;e.range=e.range;for(var r,n,a,o=Re(e.sheetIndex)?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex),l,h=e.range[0];h<=e.range[2];h++){r=0,e.isAction&&e.model.push({cells:[]});for(var u=e.range[1];u<=e.range[3];u++){if(i=Y(h,u,o),i&&(i.value||i.formula)&&!n&&(n=i.formula||i.value),e.isAction&&e.merge&&(e.model[h-e.range[0]].cells[u-e.range[1]]={},me(e.model[h-e.range[0]].cells[u-e.range[1]],i,null,!0)),o.rows[h]&&o.rows[h].cells&&o.rows[h].cells[u]&&(delete o.rows[h].cells[u].rowSpan,delete o.rows[h].cells[u].colSpan,!e.merge&&!e.isAction&&e.model&&e.model[h-e.range[0]]&&e.model[h-e.range[0]].cells[u-e.range[1]]&&e.model[h-e.range[0]].cells[u-e.range[1]]!=={}&&Ht(h,u,o,e.model[h-e.range[0]].cells[u-e.range[1]])),e.merge)if(i=new Object,h===e.range[0]&&u===e.range[1]){e.range[3]-e.range[1]>0&&(i.colSpan=e.range[3]-e.range[1]+1),e.range[2]-e.range[0]>0&&(i.rowSpan=e.range[2]-e.range[0]+1),Ht(e.range[0],e.range[1],o,i,!0);continue}else h!==e.range[0]&&(i.rowSpan=-t),u!==e.range[1]&&(r++,i.colSpan=-r),o.rows[h]&&o.rows[h].cells&&o.rows[h].cells[u]&&(delete o.rows[h].cells[u].value,delete o.rows[h].cells[u].formula),a=Y(h,u,o)||{},Ht(h,u,o,Object.assign(i,a));e.preventRefresh||(this.parent.notify(yl,{rowIdx:h,colIdx:u}),l=this.isFormulaDependent(o,h,u,l))}t++}e.merge&&(i=this.getCellValue(e.range[0],e.range[1],n,o),Ht(e.range[0],e.range[1],o,i,!0),e.preventRefresh||(this.parent.notify(yl,{rowIdx:e.range[0],colIdx:e.range[1]}),this.refreshCF(o,e.range[0],e.range[1],l)))},s.prototype.isFormulaDependent=function(e,t,i,r){if(!r){var n={action:"dependentCellsAvailable",sheetId:e.id.toString(),address:Je(t,i)};return this.parent.notify(xt,n),n.isAvailable}return r},s.prototype.refreshCF=function(e,t,i,r){e.conditionalFormats&&e.conditionalFormats.length&&this.parent.notify(er,{indexes:[t,i],refreshAll:r,isAction:!0})},s.prototype.mergeHorizontally=function(e){var t;e.range=e.range;for(var i,r=Pe(this.parent,e.sheetIndex),n,a,o,l,h=e.range[0];h<=e.range[2];h++){t=0,e.isAction&&e.model.push({cells:[]});for(var u=e.range[1];u<=e.range[3];u++){if(o=Y(h,u,r),i=new Object,e.isAction&&(e.model[h-e.range[0]].cells[u-e.range[1]]={},Object.assign(e.model[h-e.range[0]].cells[u-e.range[1]],o)),u===e.range[1]){if(h===e.range[0])continue;a=h-1,r.rows[a]&&r.rows[a].cells&&r.rows[a].cells[u]&&delete r.rows[a].cells[u].rowSpan,i=this.getCellValue(a,u,n,r),e.range[3]-e.range[1]>0&&(i.colSpan=e.range[3]-e.range[1]+1),n=null,Ht(a,u,r,i,!0)}else o&&(o.value||o.formula)&&!n&&(n=o.formula||o.value),a=h,r.rows[a]&&r.rows[a].cells&&r.rows[a].cells[u]&&(delete r.rows[a].cells[u].rowSpan,delete r.rows[a].cells[u].value,delete r.rows[a].cells[u].formula),t++,i.colSpan=-t,Ht(a,u,r,i,!0);this.parent.notify(yl,{rowIdx:a,colIdx:u}),l=this.isFormulaDependent(r,a,u,l)}}r.rows[e.range[2]]&&r.rows[e.range[2]].cells&&r.rows[e.range[2]].cells[e.range[1]]&&delete r.rows[e.range[2]].cells[e.range[1]].rowSpan,i=this.getCellValue(e.range[2],e.range[1],n,r),e.range[3]-e.range[1]>0&&(i.colSpan=e.range[3]-e.range[1]+1),Ht(e.range[2],e.range[1],r,i,!0),this.parent.notify(yl,{rowIdx:e.range[2],colIdx:e.range[1]}),this.refreshCF(r,e.range[2],e.range[1],l)},s.prototype.getCellValue=function(e,t,i,r){var n=new Object,a=Y(e,t,r);return i&&(!a||!a.value&&!a.formula)&&(Bt(i)?n.formula=i:n.value=i),n},s.prototype.mergeVertically=function(e){var t=0;e.range=e.range;for(var i=Pe(this.parent,e.sheetIndex),r,n,a,o,l,h=e.range[1];h<=e.range[3];h++)for(var u=e.range[0];u<=e.range[2];u++){if(o=Y(u,h,i),e.isAction&&(e.model[u-e.range[0]]===void 0&&(e.model[u-e.range[0]]={cells:[]}),e.model[u-e.range[0]].cells[h-e.range[1]]={},Object.assign(e.model[u-e.range[0]].cells[h-e.range[1]],o)),u===e.range[0]){if(t=0,h===e.range[1])continue;a=h-1,i.rows[u]&&i.rows[u].cells&&i.rows[u].cells[a]&&delete i.rows[u].cells[a].colSpan,r=this.getCellValue(u,a,n,i),e.range[2]-e.range[0]>0&&(r.rowSpan=e.range[2]-e.range[0]+1),n=null,Ht(u,a,i,r,!0)}else r=new Object,o&&(o.value||o.formula)&&!n&&(n=o.formula||o.value),t++,a=h,i.rows[u]&&i.rows[u].cells&&i.rows[u].cells[a]&&(delete i.rows[u].cells[a].colSpan,delete i.rows[u].cells[a].value,delete i.rows[u].cells[a].formula),r.rowSpan=-t,Ht(u,a,i,r,!0);this.parent.notify(yl,{rowIdx:u,colIdx:a}),l=this.isFormulaDependent(i,h,a,l)}i.rows[e.range[0]]&&i.rows[e.range[0]].cells&&i.rows[e.range[0]].cells[e.range[3]]&&delete i.rows[e.range[0]].cells[e.range[3]].colSpan,r=this.getCellValue(e.range[0],e.range[1],n,i),e.range[2]-e.range[0]>0&&(r.rowSpan=e.range[2]-e.range[0]+1),Ht(e.range[0],e.range[3],i,r,!0),this.parent.notify(yl,{rowIdx:e.range[0],colIdx:e.range[3]}),this.refreshCF(i,e.range[0],e.range[3],l)},s.prototype.activeCellRange=function(e){e.range=e.range;var t=this.parent.getActiveSheet(),i=Y(e.range[0],e.range[1],t);i&&(!m(i.rowSpan)&&i.rowSpan<0&&(e.range[0]+=i.rowSpan,e.insertCount&&(e.range[0]-=e.insertCount)),!m(i.colSpan)&&i.colSpan<0&&(e.range[1]+=i.colSpan,e.insertCount&&(e.range[1]-=e.insertCount)),i=Y(e.range[0],e.range[1],t),i&&(i.rowSpan>1&&(e.range[0]+(i.rowSpan-1)>=e.range[2]||e.insertCount)&&(e.range[2]=e.range[0]+(i.rowSpan-1)),i.colSpan>1&&(e.range[1]+(i.colSpan-1)>=e.range[3]||e.insertCount)&&(e.range[3]=e.range[1]+(i.colSpan-1))))},s.prototype.mergedRange=function(e){typeof e.range=="string"&&(e.range=ee(e.range)),e.range[0]<=e.range[2]&&e.range[1]<=e.range[3]?this.forward(e):e.range[0]>=e.range[2]&&e.range[1]>=e.range[3]?this.reverse(e):e.range[0]<e.range[2]&&e.range[1]>e.range[3]?this.forwardReverse(e):e.range[0]>e.range[2]&&e.range[1]<e.range[3]&&this.reverseForward(e)},s.prototype.forward=function(e){e.range=e.range;var t=Re(e.sheetIndex)?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex),i=Y(e.range[0],e.range[1],t),r,n,a=r=e.range[0],o=n=e.range[1];if(i&&(!m(i.rowSpan)&&i.rowSpan<0&&(a=r=e.range[0]+i.rowSpan),!m(i.colSpan)&&i.colSpan<0&&(o=n=e.range[1]+i.colSpan),i=Y(a,o,t),i&&(i.rowSpan>1&&(r+=i.rowSpan-1,a+(i.rowSpan-1)>=e.range[2]&&(e.range[2]=e.range[0],e.range[2]=a+(i.rowSpan-1))),i.colSpan>1&&(n+=i.colSpan-1,o+(i.colSpan-1)>=e.range[3]&&(e.range[3]=e.range[1],e.range[3]=o+(i.colSpan-1))))),e.range[0]=a,e.range[1]=o,e.range[0]===a&&e.range[1]===o&&e.range[2]===r&&e.range[3]===n&&(e.isActiveCell=!0),!e.skipChecking){for(var l=e.range[1];l<=e.range[3];l++)i=Y(e.range[2],l,t),i&&(a=e.range[2],o=l,!m(i.colSpan)&&i.colSpan<0&&(o+=i.colSpan,o<e.range[1]&&(e.range[1]=o)),!m(i.rowSpan)&&i.rowSpan<0&&(a+=i.rowSpan,a<e.range[0]&&(e.range[0]=a)),i=Y(a,o,t),i&&(i.colSpan>1&&o+(i.colSpan-1)>e.range[3]&&(e.range[3]=o,e.range[3]=o+(i.colSpan-1)),i.rowSpan>1&&a+(i.rowSpan-1)>e.range[2]&&(e.range[2]=a,e.range[2]=a+(i.rowSpan-1))));for(var h,u,l=e.range[1];l<=e.range[3];l++)i=Y(e.range[0],l,t),i&&(u=l,h=e.range[0],!m(i.colSpan)&&i.colSpan<0&&(u+=i.colSpan,u<e.range[1]&&(e.range[1]=u)),!m(i.rowSpan)&&i.rowSpan<0&&(h+=i.rowSpan,h<e.range[0]&&(e.range[0]=h)));for(var l=e.range[0];l<=e.range[2];l++)i=Y(l,e.range[3],t),i&&(a=l,o=e.range[3],!m(i.rowSpan)&&i.rowSpan<0&&(a+=i.rowSpan,a<e.range[0]&&(e.range[0]=a)),!m(i.colSpan)&&i.colSpan<0&&(o+=i.colSpan,o<e.range[1]&&(e.range[1]=o)),i=Y(a,o,t),i&&(i.rowSpan>1&&a+(i.rowSpan-1)>e.range[2]&&(e.range[2]=a,e.range[2]=a+(i.rowSpan-1)),i.colSpan>1&&o+(i.colSpan-1)>e.range[3]&&(e.range[3]=o,e.range[3]=o+(i.colSpan-1))))}},s.prototype.forwardReverse=function(e){var t=this.parent.getActiveSheet();e.range=e.range;var i=e.range[1],r=Y(e.range[0],e.range[1],t),n=e.range[0];if(r&&(!m(r.colSpan)&&r.colSpan<0&&(i+=r.colSpan,e.range[3]>=i&&(e.range[3]=i)),!m(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<e.range[0]&&(e.range[0]=n)),r=Y(n,i,t),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=e.range[2]&&(e.range[2]=n+(r.rowSpan-1)),r.colSpan>1&&i+(r.colSpan-1)>=e.range[1]&&(e.range[1]=i+(r.colSpan-1)))),e.range[0]=n,!e.skipChecking){for(var a,o,l=e.range[3];l<=e.range[1];l++)r=Y(e.range[2],l,t),r&&(o=l,a=e.range[2],!m(r.rowSpan)&&r.rowSpan<0&&(a+=r.rowSpan,a<e.range[0]&&(e.range[0]=a)),!m(r.colSpan)&&r.colSpan<0&&(o+=r.colSpan,o<e.range[3]&&(e.range[3]=o)),r=Y(a,o,t),r&&(r.rowSpan>1&&a+(r.rowSpan-1)>e.range[2]&&(e.range[2]=a+(r.rowSpan-1)),r.colSpan>1&&o+(r.colSpan-1)>e.range[1]&&(e.range[1]=o+(r.colSpan-1))));for(var h,l=e.range[3];l<=e.range[1];l++)r=Y(e.range[0],l,t),r&&(o=l,h=e.range[0],!m(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[0]&&(e.range[0]=h)),!m(r.colSpan)&&r.colSpan<0&&(o+=r.colSpan),r=Y(h,o,t),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[2]&&(e.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&o+(r.colSpan-1)>e.range[1]&&(e.range[1]=o,e.range[1]=o+(r.colSpan-1))));for(var u,l=e.range[0];l<=e.range[2];l++)r=Y(l,e.range[3],t),r&&(h=l,u=e.range[3],!m(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[0]&&(e.range[0]=h)),!m(r.colSpan)&&r.colSpan<0&&(u+=r.colSpan,u<e.range[3]&&(e.range[3]=u)),r=Y(h,u,t),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[2]&&(e.range[2]=h,e.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&u+(r.colSpan-1)>e.range[1]&&(e.range[1]=u,e.range[1]=u+(r.colSpan-1))))}},s.prototype.reverse=function(e){e.range=e.range;var t=e.range[1],i=Re(e.sheetIndex)?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex),r=Y(e.range[0],e.range[1],i),n=e.range[0];r&&(!m(r.colSpan)&&r.colSpan<0&&(t+=r.colSpan),!m(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),e.range[2]>=n&&(e.range[2]=n,e.isActiveCell=!0),e.range[3]>=t?(e.range[3]=t,e.range[2]===n&&(e.isActiveCell=!0)):e.isActiveCell&&(e.isActiveCell=!1),r=Y(n,t,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&t+(r.colSpan-1)>=e.range[1]&&(e.range[1]=t,e.range[1]=t+(r.colSpan-1))));var a=e.range[3];if(!e.skipChecking){for(var o=e.range[3];o<=e.range[1];o++)r=Y(e.range[2],o,i),r&&(a=o,n=e.range[2],!m(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<e.range[2]&&(e.range[2]=n)),!m(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan,a<e.range[3]&&(e.range[3]=a)),r=Y(n,a,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&a+(r.colSpan-1)>e.range[1]&&(e.range[1]=a,e.range[1]=a+(r.colSpan-1))));a=e.range[3];for(var o=e.range[3];o<=e.range[1];o++)r=Y(e.range[0],o,i),r&&(a=o,n=e.range[0],!m(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan),!m(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),r=Y(n,a,i),r&&(r.colSpan>1&&a+(r.colSpan-1)>e.range[1]&&(e.range[1]=a,e.range[1]=a+(r.colSpan-1)),r.rowSpan>1&&n+(r.rowSpan-1)>e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1))));for(var l,h,o=e.range[2];o<=e.range[0];o++)r=Y(o,e.range[3],i),r&&(h=o,l=e.range[3],!m(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[2]&&(e.range[2]=h)),!m(r.colSpan)&&r.colSpan<0&&(l+=r.colSpan,l<e.range[3]&&(e.range[3]=l)),r=Y(h,l,i),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[0]&&(e.range[0]=h,e.range[0]=h+(r.rowSpan-1)),r.colSpan>1&&l+(r.colSpan-1)>e.range[1]&&(e.range[1]=l,e.range[1]=l+(r.colSpan-1))))}},s.prototype.reverseForward=function(e){e.range=e.range;var t=Re(e.sheetIndex)?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex),i=e.range[0],r=e.range[1],n=Y(e.range[0],e.range[1],t);if(n&&(!m(n.rowSpan)&&n.rowSpan<0&&(i+=n.rowSpan,e.range[2]>=i&&(e.range[2]=i)),!m(n.colSpan)&&n.colSpan<0&&(r+=n.colSpan),n=Y(i,r,t),n&&(n.rowSpan>1&&i+(n.rowSpan-1)>=e.range[0]&&(e.range[0]=i,e.range[0]=i+(n.rowSpan-1)),n.colSpan>1&&r+(n.colSpan-1)>=e.range[3]&&(e.range[3]=e.range[1],e.range[3]=r+(n.colSpan-1)))),!e.skipChecking){for(var a=e.range[3],o,l=e.range[1];l<=e.range[3];l++)n=Y(e.range[2],l,t),n&&(o=e.range[2],a=l,!m(n.rowSpan)&&n.rowSpan<0&&(o+=n.rowSpan,o<e.range[2]&&(e.range[2]=o)),!m(n.colSpan)&&n.colSpan<0&&(a+=n.colSpan,a<e.range[1]&&(e.range[1]=a)),n=Y(o,a,t),n&&(n.colSpan>1&&a+(n.colSpan-1)>e.range[3]&&(e.range[3]=a+(n.colSpan-1)),n.rowSpan>1&&n.rowSpan-1+o>e.range[0]&&(e.range[0]=n.rowSpan-1+o)));for(var h,u,l=e.range[1];l<=e.range[3];l++)n=Y(e.range[0],l,t),n&&(u=l,h=e.range[0],!m(n.colSpan)&&n.colSpan<0&&(u+=n.colSpan,u<e.range[1]&&(e.range[1]=u)),!m(n.rowSpan)&&n.rowSpan<0&&(h+=n.rowSpan),n=Y(h,u,t),n&&n.rowSpan>1&&h+(n.rowSpan-1)>e.range[0]&&(e.range[0]=h+(n.rowSpan-1)));for(var c,l=e.range[2];l<=e.range[0];l++)n=Y(l,e.range[3],t),n&&(o=l,c=e.range[3],!m(n.rowSpan)&&n.rowSpan<0&&(o+=n.rowSpan,o<e.range[2]&&(e.range[2]=o)),!m(n.colSpan)&&n.colSpan<0&&(c+=n.colSpan,c<e.range[1]&&(e.range[1]=c)),n=Y(o,c,t),n&&(n.rowSpan>1&&n.rowSpan-1+o>e.range[0]&&(e.range[0]=n.rowSpan-1+o),n.colSpan>1&&n.colSpan-1+c>e.range[3]&&(e.range[3]=c,e.range[3]=n.colSpan-1+c)))}},s.prototype.insertHandler=function(e){this.activeCellRange(e),e.range=e.range,e.insertModel==="Row"?e.range[2]+=e.insertCount:e.range[3]+=e.insertCount,e.preventRefresh=!0,e.merge=!0,this.mergeAll(e)},s.prototype.addEventListener=function(){this.parent.on(Fn,this.merge,this),this.parent.on(Vc,this.mergedRange,this),this.parent.on(cr,this.activeCellRange,this),this.parent.on(Fy,this.insertHandler,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Fn,this.merge),this.parent.off(Vc,this.mergedRange),this.parent.off(cr,this.activeCellRange),this.parent.off(Fy,this.insertHandler))},s.prototype.getModuleName=function(){return"workbookmerge"},s}(),GP=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(vd,this.setCFRule,this),this.parent.on(no,this.clearCFRule,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vd,this.setCFRule),this.parent.off(no,this.clearCFRule))},s.prototype.setCFRule=function(e){var t=e.cfModel,i=e.sheetIdx===void 0?La(this.parent,t.range):e.sheetIdx,r=Pe(this.parent,i);t.range=t.range||r.selectedRange;var n=lt(ee(t.range));if(t.range=je(n),e.isAction){var a={range:t.range,type:t.type,cancel:!1,cFColor:t.cFColor,value:t.value,sheetIdx:i};if(this.parent.notify(li,{eventArgs:a,action:"conditionalFormat"}),a.cancel)return;t.type=a.type,t.cFColor=a.cFColor,t.value=a.value,a.range!==t.range&&(t.range=a.range,n=lt(ee(a.range))),delete a.cancel}r.conditionalFormats||this.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]),r.conditionalFormats.push(t),i!==this.parent.activeSheetIndex?e.isUndoRedo&&!e.isFromUpdateAction&&this.parent.notify(_h,{address:r.name+"!"+t.range}):this.parent.notify(er,{cfModel:[t],isAction:!0}),this.parent.setUsedRange(n[2],n[3]),e.isAction&&this.parent.notify("actionComplete",{eventArgs:{range:t.range,type:t.type,cFColor:t.cFColor,value:t.value,sheetIdx:i},action:"conditionalFormat"})},s.prototype.clearCFRule=function(e){e.sheetIdx===void 0&&(e.sheetIdx=this.parent.activeSheetIndex);var t=Pe(this.parent,e.sheetIdx),i=t.conditionalFormats;if(e.isUndo){if(e.updatedCFModel){var r;e.updatedCFModel.forEach(function(w){r=i.indexOf(w),r>-1&&i.splice(r,1)})}i.splice.apply(i,[i.length,0].concat(e.oldCFModel)),this.parent.notify(er,{cfModel:e.oldCFModel,isAction:!0}),e.sheetIdx!==this.parent.activeSheetIndex&&this.parent.notify(_h,{address:t.name+"!"+e.range});return}if(!(!i||!i.length)){var n,a,o,l,h,u,c,d,p,f=e.range&&(typeof e.range=="string"?ee(e.range):e.range);e.oldCFModel=[],e.updatedCFModel=[];for(var v=[],g=[],b=[],y=0;y<i.length;y++){n=i[y],a=n.range.split(",");for(var C=0;C<a.length;C++){if(o=ee(a[C]),e.range)if(f[0]<=o[0]&&f[1]<=o[1]&&f[2]>=o[2]&&f[3]>=o[3])a.splice(C,1),C--;else if(c=f[0]>=o[0]&&f[0]<=o[2],d=f[2]>=o[0]&&f[2]<=o[2],h=f[1]>=o[1]&&f[1]<=o[3],u=f[3]>=o[1]&&f[3]<=o[3],l=[],c&&d?((h||u||f[1]<o[1]&&f[3]>o[3])&&(f[0]-o[0]>0&&l.push(je([o[0],o[1],f[0]-1,o[3]])),o[2]-f[2]>0&&l.push(je([f[2]+1,o[1],o[2],o[3]]))),h&&f[1]!==o[1]&&l.push(je([f[0],o[1],f[2],f[1]-1])),u&&f[3]!==o[3]&&l.push(je([f[0],f[3]+1,f[2],o[3]]))):h&&u?((c||d||f[0]<o[0]&&f[2]>o[2])&&(f[1]-o[1]>0&&l.push(je([o[0],o[1],o[2],f[1]-1])),o[3]-f[3]>0&&l.push(je([o[0],f[3]+1,o[2],o[3]]))),c?f[0]!==o[0]&&l.push(je([o[0],f[1],f[0]-1,f[3]])):d&&f[2]!==o[2]&&l.push(je([f[2]+1,f[1],o[2],f[3]]))):(c||d)&&(h?(f[1]!==o[1]&&l.push(je([o[0],o[1],o[2],f[1]-1])),f[0]-o[0]>0?l.push(je([o[0],f[1],f[0]-1,o[3]])):o[2]-f[2]>0&&l.push(je([f[2]+1,f[1],o[2],o[3]]))):u&&(f[3]!==o[3]&&l.push(je([o[0],f[3]+1,o[2],o[3]])),f[0]-o[0]>0?l.push(je([o[0],o[1],f[0]-1,f[3]])):o[2]-f[2]>0&&l.push(je([f[2]+1,o[1],o[2],f[3]])))),l.length)a[C]=l.join(",");else continue;else f=o,a.splice(C,1),C--;e.sheetIdx===this.parent.activeSheetIndex&&this.parent.notify(c1,{indexes:f})}if(p=a.join(","),p!==n.range){if(e.cfModel&&(e.cfModel.cFColor!==n.cFColor||e.cfModel.type!==n.type||e.cfModel.value!==n.value)){b.push(n);continue}g.push(n.range),p?(e.oldCFModel.push({type:n.type,cFColor:n.cFColor,format:n.format,range:n.range,value:n.value}),n.range=p,n.result&&(delete n.result,this.parent.notify(er,{cfModel:[n],isAction:!0})),e.updatedCFModel.push(n),v.push(n)):(e.oldCFModel.push(n),v.concat(i.splice(y,1)),y--)}}if(e.sheetIdx!==this.parent.activeSheetIndex?e.isUndoRedo&&!e.isFromUpdateAction&&this.parent.notify(_h,{address:t.name+"!"+e.range}):b.length&&this.parent.notify(er,{cfModel:b,isAction:!0}),(e.isAction||e.isClear)&&e.oldCFModel.length){var x={cFormats:v,oldRange:g,previousConditionalFormats:e.oldCFModel,sheetIdx:e.sheetIdx,selectedRange:e.range};e.updatedCFModel.length&&(x.conditionalFormats=e.updatedCFModel),e.isClear?e.cfClearActionArgs=x:this.parent.notify("actionComplete",{eventArgs:x,action:"clearCF"})}}},s.prototype.getModuleName=function(){return"workbookConditionalFormatting"},s}(),$P=function(){function s(e){this.uniqueOBracket="",this.uniqueCBracket="",this.uniqueDOperator="",this.uniqueModOperator="",this.uniqueCSeparator="",this.uniqueCOperator="",this.uniqueExpOperator="",this.uniqueGTOperator="",this.uniqueConcateOperator="",this.uniqueEqualOperator="",this.uniqueLTOperator="",this.uniqueMOperator="",this.uniquePOperator="",this.uniqueSOperator="",this.parent=e,this.addEventListener()}return s.prototype.getFillInfo=function(e){for(var t=this.parent.serviceLocator.getService(xI),i="",r=!0,n="CopyCells",a=[],o=["Down","Up"].indexOf(e.direction)>-1,l=this.getRangeData({range:e.dataRange,sheetIdx:this.parent.activeSheetIndex}),h=l.join().replace(/,/g,"").length,u=this.isRange(e.dataRange)&&h?l.length:1;u--;)if(i=l[u]&&!m(l[u].value)?l[u].value:"",He(i)||Bt(i)||He(i[i.length-1])){r=!1,n=this.parent.autoFillSettings.fillType;break}return(!h||r)&&(a.push(t.getConstant("FillSeries")),n=e.fillType==="FillSeries"?n:e.fillType),(!o||o&&e.dataRange[1]!==e.dataRange[3])&&a.push("Flash Fill"),{fillType:n,disableItems:a}},s.prototype.isRange=function(e){return e&&(e[0]!==e[2]||e[1]!==e[3])},s.prototype.autoFill=function(e){if(!(!e.dataRange||!e.fillRange||!e.direction||!this.parent.allowEditing||this.parent.getActiveSheet().isProtected&&e.isLockedCell)){var t={dataRange:null,fillRange:null,fillType:null,direction:null,sheetIndex:La(this.parent,e.dataRange)},i=lt(ee(e.dataRange)),r=lt(ee(e.fillRange));switch(this.fillInfo=this.getFillInfo({dataRange:i,fillRange:r,fillType:e.fillType,direction:e.direction}),t.dataRange=i,t.fillRange=r,t.direction=e.direction,t.fillType=e.fillType||this.fillInfo.fillType,this.fillInfo.fillType=e.isFillOptClick?e.fillType:this.fillInfo.fillType,e.fillType){case"FillSeries":case"FillWithoutFormatting":this.fillSeries(t);break;case"CopyCells":case"FillFormattingOnly":this.copyCells(t);break}}},s.prototype.fillSeries=function(e){for(var t,i,r,n,a,o,l,h,u,c,d,p,f,v,g,b,y,C,x,w,M,E={},T=0,D,N,A,L=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,k=Pe(this.parent,L),O=e.dataRange[0],R=e.dataRange[1],j=e.dataRange[2],P=e.dataRange[3],F=e.fillRange[0],z=e.fillRange[1],q=e.fillRange[2],X=e.fillRange[3],G=["Down","Up"].indexOf(e.direction)>-1,Z=["Up","Left"].indexOf(e.direction)>-1,se=G?P-R:j-O,oe=e.fillType==="FillSeries",fe,be,Ne=k.conditionalFormats&&k.conditionalFormats.length&&[].slice.call(k.conditionalFormats),we=[];T<=se;){if(a=this.updateFillValues(G,O,R,j,P,F,z,q,X,T),o=a.patternRange,l=a.fillRange,r=this.getPattern(o,{isReverseFill:Z,isVFill:G}),h=this.getRangeData({range:o,sheetIdx:L}),p=h.length,!r||!r.length)return;for(i=r.length,x=this.getSelectedRange(k,{rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]}),w=x.length,Z&&(x=x.reverse(),r=r.reverse(),r=this.ensurePattern(r),h=h.reverse()),f=0;f<w;){switch(M=x[f],n=r[f%i],He(n)&&(n=r[n]),g=f%p,n.type){case"number":case"date":if(n=n,n.isStartWithMonth&&p===1?(N=Nl(n.regVal.a),A=new Date(N),N.setMonth(N.getMonth()+n.regVal.b*n.i),A.getDate()>28&&A.getDate()!==N.getDate()&&(A.setDate(1),A.setMonth(A.getMonth()+n.regVal.b*n.i),A.setDate(new Date(A.getFullYear(),A.getMonth()+1,0).getDate()),N=A),t=Es(N).toString()):(t=this.round(n.regVal.a+n.regVal.b*n.i,5).toString(),n.val&&(c=typeof n.val[0]=="string"&&n.val[0].match(/^0+/),c&&(u=this.getNextFormattedValue(n.val[0],Number(t))))),n.dataVal){if(n.copy===void 0&&!c&&(n.copy=n.val.length>2,n.copy))for(var H=2;H<n.val.length&&(n.copy=Math.abs(this.round(n.regVal.a+n.regVal.b*H,5))!==n.val[H],!n.copy);H++);t=n.copy?h[g]&&!m(h[g].value)?h[g].value:"":n.start?Math.abs(Number(t))+n.dataVal:c?n.dataVal+u:n.dataVal+Math.abs(Number(t))}Z?n.i--:n.i++;break;case"string":var V=n.i%n.val.length;t=n.val[V],n.i++;break;case"formula":for(C=!1,t="=",v=0,b=n.val.length;v<b;)d=n.val[v],typeof d=="object"?(C=!0,y=this.round(d.a+d.b*n.i,5),y<1?t+="#REF!":t+=G?d.c+(d.b?y:"$"+y):(d.b?Ur(y):d.c.substring(0,d.c.search(/\d/))+"$"+Ur(y))+d.c.trim()):t+=d,v++;C&&Z?n.i--:n.i++;break;case"time":t=(n.regVal.a+n.regVal.b*n.i).toString(),Z?n.i--:n.i++;break}D=Y(M.rowIndex,M.colIndex,k,!1,!0),oe?Object.assign(E,h[g],null,!0):(E.style=D.style,E.format=D.format,E.wrap=D.wrap,E.rowSpan=D.rowSpan,E.colSpan=D.colSpan),E.value=t,Bt(t)&&(E.formula=t),fe={cell:E,rowIdx:M.rowIndex,colIdx:M.colIndex,valChange:!0,uiRefresh:!0,pvtExtend:!0,skipFormatCheck:!0},Tn(this.parent,k,fe),Ne&&!be&&(be=fe.isFormulaDependent,be||_f(Ne,we,M.rowIndex,M.colIndex)),E={},f++}T++}(we.length||be)&&this.parent.notify(er,{cfModel:!be&&we,refreshAll:be,isAction:!0,isEdit:!0})},s.prototype.copyCells=function(e){for(var t=0,i,r,n,a,o,l,h,u,c,d={},p,f=e.dataRange[0],v=e.dataRange[1],g=e.dataRange[2],b=e.dataRange[3],y=e.fillRange[0],C=e.fillRange[1],x=e.fillRange[2],w=e.fillRange[3],M=["Down","Up"].indexOf(e.direction)>-1,E=["Up","Left"].indexOf(e.direction)>-1,T=M?b-v:g-f,D=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,N=Pe(this.parent,D),A=e.fillType==="FillFormattingOnly",L,k,O,R=N.conditionalFormats&&N.conditionalFormats.length&&[].slice.call(N.conditionalFormats),j=[];t<=T;){for(o=this.updateFillValues(M,f,v,g,b,y,C,x,w,t),n=o.patternRange,a=o.fillRange,l=this.getRangeData({range:n,sheetIdx:D}),h=l.length,u=this.getSelectedRange(N,{rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]}),c=u.length,i=0,E&&(u=u.reverse());i<c;)r=i%h,p=u[i],A&&(L=Y(p.rowIndex,p.colIndex,N)),Object.assign(d,l[r],null,!0),A&&(d.value=L.value,d.formula=L.formula),O={cell:d,rowIdx:p.rowIndex,colIdx:p.colIndex,valChange:!0,uiRefresh:!0,pvtExtend:!0},Tn(this.parent,N,O),R&&!k&&(k=O.isFormulaDependent,k||_f(R,j,p.rowIndex,p.colIndex)),d={},i++;t++}(j.length||k)&&this.parent.notify(er,{cfModel:!k&&j,refreshAll:k,isAction:!0,isEdit:!0})},s.prototype.updateFillValues=function(e,t,i,r,n,a,o,l,h,u){var c,d,p,f;e?(c={rowIndex:t,colIndex:i+u},d={rowIndex:r,colIndex:i+u},p={rowIndex:a,colIndex:o+u},f={rowIndex:l,colIndex:o+u}):(c={rowIndex:t+u,colIndex:i},d={rowIndex:t+u,colIndex:n},p={rowIndex:a+u,colIndex:o},f={rowIndex:a+u,colIndex:h});var v=[c.rowIndex,c.colIndex,d.rowIndex,d.colIndex],g=[p.rowIndex,p.colIndex,f.rowIndex,f.colIndex];return{patternRange:v,fillRange:g}},s.prototype.getDataPattern=function(e){var t,i,r,n=0,a={val:null,type:null},o=[],l=this.getRangeData({range:e,sheetIdx:this.parent.activeSheetIndex}),h=l.length,u,c;if(h){for(var d=void 0,p=void 0,f=void 0,v=void 0,g=function(C){return!u&&C&&C[C.length-1]==="-"?C.slice(0,C.length-1):C};n<h;){if(c=!1,l[n])if(l[n].formula&&Bt(l[n].formula))t=l[n].formula,r="formula";else{t=m(l[n].value)?"":l[n].value;var b={};if(f=l[n].format,v=He(t),f&&yd(f,!0,b)){if(r=b.type,t&&!v){var y={value:t,updatedVal:t,cell:l[n]};this.parent.notify(yn,y),y.isDate||y.isTime?l[n].value=t=y.updatedVal:r="string"}c=r==="date"&&f.toLowerCase().startsWith("mmm")}else r=v?"number":"string"}else t="",r="string";if(p="",r==="string"){if(u=!1,He(t[0])){d=0;do d++;while(He(t[d]));t[d]===" "&&(u=!0,r="number",p=t.slice(d,t.length),t=Number(t.slice(0,d)))}if(t=t,!u&&He(t[t.length-1])){d=1;do d++;while(He(t[t.length-d]));r="number",d-=1,p=t.slice(0,t.length-d),i=t.slice(t.length-d,t.length),t=i.match(/^0+/)?i:Number(i),a.dataVal&&a.dataVal!==p&&a.dataVal===g(p)&&(p=a.dataVal)}}n===0?(a={val:[t],type:r,isStartWithMonth:c},p&&(a.dataVal=p,a.start=u)):r===a.type&&(!a.dataVal||g(a.dataVal)===g(p))?a.val.push(t):(o.push(a),a={val:[t],type:r},p&&(a.dataVal=p,a.start=u)),n++}return o.push(a),o}else return[{val:null,type:null}]},s.prototype.getPredictionValue=function(e,t){for(var i=0,r=0,n=0,a=0,o=0,l=0,h=0,u=e.length;i<u;)r=r+i,n=n+Number(e[i]),a=a+i*Number(e[i]),o=o+i*i,i++;return t?(l=(n*o-r*a)/(u*o-r*r),h=(u*a-r*n)/(u*o-r*r)):(l=this.round((n*o-r*a)/(u*o-r*r),5),h=this.round((u*a-r*n)/(u*o-r*r),5)),{a:l,b:h}},s.prototype.getPattern=function(e,t){var i,r,n,a,o,l,h=0,u=[],c=this.getDataPattern(e),d=c.length,p;if(c){for(;h<d;){switch(p=c[h],p.type){case"number":case"date":if(r=u.length,l=p.val.length,o=t.isReverseFill?-1:l,l===1){var f=parseFloat(p.val[0])+1;typeof p.val[0]=="string"&&p.val[0].match(/^0+/)?p.val.push(this.getNextFormattedValue(p.val[0],f)):p.val.push(f)}for(a=this.getPredictionValue(p.dataVal?p.val.slice(0,2):p.val),n={regVal:a,type:p.type,i:o,isStartWithMonth:p.isStartWithMonth},p.dataVal&&(n.dataVal=p.dataVal,n.val=p.val,n.start=p.start),u.push(n),i=1;i<l;)u.push(r),i++;break;case"string":for(r=u.length,n={val:p.val,type:p.type,i:0},u.push(n),i=1,l=p.val.length;i<l;)u.push(r),i++;break;case"formula":if(l=p.val.length,p=this.getFormulaPattern(p.val,t),o=t.isReverseFill?-1:l,p.isInPattern)for(r=u.length,n={val:p.val,type:"formula",i:o},u.push(n),i=1;i<l;)u.push(r),i++;else for(i=0,o=t.isReverseFill?-1:1;i<l;)u.push({val:p.val[i],type:"formula",i:o}),i++;break;case"time":if(r=u.length,l=p.val.length,o=t.isReverseFill?-1:1,l===1){var v=Nl(p.val[0]),g=Number(p.val[0]),b=g>0&&g<1,y=Es(new Date(v.getTime()+60*6e4),!0,b);p.val.push(y)}for(a=this.getPredictionValue(p.val,!0),n={regVal:a,type:p.type,i:o},u.push(n),i=1;i<l;)u.push(r),i++;break}h++}return u}else return[{regVal:null}]},s.prototype.getNextFormattedValue=function(e,t){return new _t().formatNumber(Math.abs(t),{minimumIntegerDigits:e.length,useGrouping:!1})},s.prototype.isCellReference=function(e){return/^[a-z]{1,3}\d{1,7}$/gi.test(e)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(e)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(e)?"mixed":!1},s.prototype.round=function(e,t){return+(Math.round(parseFloat(e+"e"+t))+"e-"+t)||Number(e)},s.prototype.getRangeData=function(e){for(var t=[],i=this.parent.getActiveSheet(),r=e.range[0],n=e.range[1],a=e.range[2],o=e.range[3],l=n,h;r<=a;){if(ct(i,r)){r++;continue}for(n=l;n<=o;){if(Yt(i,n)){n++;continue}h=Y(r,n,i),t.push(h),n++}r++}return t},s.prototype.getFormulaPattern=function(e,t){for(var i,r,n,a=[],o=0,l=e.length,h;o<l;)a.push(this.parseFormula(e[o])),o++;var u=this.isInPattern(a,t.isVFill);if(u){for(n=a[0],o=n.length;o--;)r=n[o],h=this.isCellReference(r),h&&h!=="absolute"&&(n[o]=this.getCellRefPrediction(r,t,null,h));return{isInPattern:u,val:n}}else{for(o=0;o<l;){for(n=a[o],i=n.length;i--;)r=n[i],h=this.isCellReference(r.trim()),h&&h!=="absolute"&&(a[o][i]=this.getCellRefPrediction(r,t,l,h));o++}return{isInPattern:u,val:a}}},s.prototype.generateColCount=function(e){for(var t=0,i=e.split("").reverse().join(""),r=i.length-1;r>=0;r--)t+=(e[r].charCodeAt(parseInt(i[r],10))-64)*Math.pow(26,r);return t},s.prototype.getCellRefPrediction=function(e,t,i,r){e=e.toUpperCase();var n="",a=new RegExp("[a-z$]","gi"),o=new RegExp("[0-9$]","g"),l=t.isVFill?e.replace(o,n):e.replace(a,n),h=t.isVFill?Number(e.replace(a,n)):this.generateColCount(e.replace(o,n).trim()),u=null,c=[h],d=e[0]==="$";if(!d&&e.includes("$")&&e.trim()[0]==="$"){for(var p=1;p<e.length;p++)if(e[p]==="$"){u=p,d=!0;break}}return i&&i!==1?c.push(h+i):c.push(h+1),h=this.getPredictionValue(c),r&&r==="mixed"&&(d===t.isVFill?u?l=l.substring(0,u)+"$"+l.substring(u):l="$"+l:h.b=0),h.c=l,h},s.prototype.isInPattern=function(e,t){var i,r,n,a,o,l,h,u,c="",d=0,p=1,f=e.length,v=new RegExp("[0-9$]","g"),g=new RegExp("[a-z$]","gi");if(f===1)return!1;for(;p<f;){if(i=e[d],n=e[p],r=i.length,a=n.length,r!==a)return!1;for(;r--;)if(o=i[r],l=n[r],this.isCellReference(o)===this.isCellReference(l)){if(t?(h=Number(o.replace(g,c)),u=Number(l.replace(g,c))):(h=this.generateColCount(o.replace(v,c)),u=this.generateColCount(l.replace(v,c))),h!==u-1)return!1}else if(o!==l)return!1;d++,p++}return!0},s.prototype.parseFormula=function(e){var t,i,r=0,n=[];e=this.markSpecialChar(e.replace("=","")),e=e.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g);for(var a=e.length;r<a;){if(t=e[r],!t){r++;continue}t.length===1?n.push(this.isUniqueChar(t)?this.getUniqueCharVal(t):t):(i=t[0],t.indexOf("!")>0?(this.isUniqueChar(i)&&(n.push(this.getUniqueCharVal(i)),t=t.substr(1)),i=t.indexOf("!")+1,n.push(t.substr(0,i)),n.push(t.substr(i))):this.isUniqueChar(i)?(n.push(this.getUniqueCharVal(i)),n.push(t.substr(1))):n.push(t)),r++}return n},s.prototype.getUniqueCharVal=function(e){switch(e){case this.uniqueSOperator:return"-";case this.uniqueOBracket:return"(";case this.uniqueCOperator:return":";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return",";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueModOperator:return"%";case this.uniquePOperator:return"+"}return""},s.prototype.isUniqueChar=function(e){var t=e.charCodeAt(parseInt(e,10));return t>=129&&t<=142},s.prototype.markSpecialChar=function(e){return e=e.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),e=e.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),e=e.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),e=e.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),e=e.replace(/&/g,"&"+this.uniqueConcateOperator),e=e.replace(/=/g,"="+this.uniqueEqualOperator),e=e.replace(/\^/g,"^"+this.uniqueExpOperator),e=e.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),e.replace(/%/g,"%"+this.uniqueModOperator)},s.prototype.ensurePattern=function(e){for(var t,i=-1,r=e.length;r--;)t=e[r],typeof t=="object"?(i=r,t.type==="string"&&(t.val=t.val.reverse())):e[r]=i;return e},s.prototype.getSelectedRange=function(e,t,i){var r,n,a,o=[],l=lt([t.rowIndex,t.colIndex,i.rowIndex,i.colIndex]);r=l[0];for(var h=l[2];r<=h;){if(Aa(e,r)){r++;continue}for(n=l[1],a=l[3];n<=a;)o.push({rowIndex:r,colIndex:n}),n++;r++}return o},s.prototype.getFillType=function(e){return e.fillType=this.fillInfo.fillType,e.disableItems=this.fillInfo.disableItems,e},s.prototype.addEventListener=function(){this.parent.on(gd,this.autoFill,this),this.parent.on(m1,this.getFillType,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(gd,this.autoFill),this.parent.off(m1,this.getFillType))},s.prototype.getModuleName=function(){return"workbookautofill"},s}();function XP(s,e){return e===void 0&&(e=[]),e.push({member:"workbookBasic",args:[]}),e.push({member:"workbookAll",args:[]}),e.push({member:"dataBind",args:[s]}),e.push({member:"workbookProtectSheet",args:[s]}),s.allowSave&&e.push({member:"workbookSave",args:[s]}),s.allowOpen&&e.push({member:"workbookOpen",args:[s]}),s.allowEditing&&(e.push({member:"workbookEdit",args:[s]}),e.push({member:"workbookFormula",args:[s]})),s.allowNumberFormatting&&e.push({member:"workbookNumberFormat",args:[s]}),s.allowCellFormatting&&e.push({member:"workbookcellformat",args:[s]}),s.allowSorting&&e.push({member:"workbookSort",args:[s]}),s.allowHyperlink&&e.push({member:"workbookHyperlink",args:[s]}),s.allowFiltering&&e.push({member:"workbookFilter",args:[s]}),s.allowFindAndReplace&&e.push({member:"workbookfindAndReplace",args:[s]}),s.allowInsert&&e.push({member:"workbookinsert",args:[s]}),s.allowDelete&&e.push({member:"workbookdelete",args:[s]}),s.allowDataValidation&&e.push({member:"workbookDataValidation",args:[s]}),s.allowMerge&&e.push({member:"workbookmerge",args:[s]}),s.allowCellFormatting&&e.push({member:"workbookConditionalFormatting",args:[s]}),s.allowImage&&e.push({member:"workbookImage",args:[s]}),s.allowChart&&e.push({member:"workbookChart",args:[s]}),s.allowAutoFill&&e.push({member:"workbookautofill",args:[s]}),e}var Yr=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ue=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},bI=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("Calibri")],e.prototype,"fontFamily",void 0),Ue([S("bottom")],e.prototype,"verticalAlign",void 0),Ue([S("left")],e.prototype,"textAlign",void 0),Ue([S("0pt")],e.prototype,"textIndent",void 0),Ue([S("#000000")],e.prototype,"color",void 0),Ue([S("#ffffff")],e.prototype,"backgroundColor",void 0),Ue([S("normal")],e.prototype,"fontWeight",void 0),Ue([S("normal")],e.prototype,"fontStyle",void 0),Ue([S("11pt")],e.prototype,"fontSize",void 0),Ue([S("none")],e.prototype,"textDecoration",void 0),Ue([S("")],e.prototype,"border",void 0),Ue([S("")],e.prototype,"borderTop",void 0),Ue([S("")],e.prototype,"borderBottom",void 0),Ue([S("")],e.prototype,"borderLeft",void 0),Ue([S("")],e.prototype,"borderRight",void 0),e}(ke);(function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S()],e.prototype,"sheetIndex",void 0),Ue([S()],e.prototype,"filterRange",void 0),Ue([S(!1)],e.prototype,"hasFilter",void 0),Ue([S()],e.prototype,"column",void 0),Ue([S()],e.prototype,"criteria",void 0),Ue([S()],e.prototype,"value",void 0),Ue([S()],e.prototype,"dataType",void 0),Ue([S()],e.prototype,"predicates",void 0),e})(ke);(function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S()],e.prototype,"sortRange",void 0),Ue([S()],e.prototype,"columnIndex",void 0),Ue([S()],e.prototype,"order",void 0),Ue([S()],e.prototype,"sheetIndex",void 0),e})(ke);var KP=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("")],e.prototype,"name",void 0),Ue([S("")],e.prototype,"scope",void 0),Ue([S("")],e.prototype,"comment",void 0),Ue([S("")],e.prototype,"refersTo",void 0),e}(ke),g6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(!1)],e.prototype,"selectCells",void 0),Ue([S(!1)],e.prototype,"selectUnLockedCells",void 0),Ue([S(!1)],e.prototype,"formatCells",void 0),Ue([S(!1)],e.prototype,"formatRows",void 0),Ue([S(!1)],e.prototype,"formatColumns",void 0),Ue([S(!1)],e.prototype,"insertLink",void 0),e}(ke);(function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("")],e.prototype,"address",void 0),e})(ke);(function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("WholeNumber")],e.prototype,"type",void 0),Ue([S("Between")],e.prototype,"operator",void 0),Ue([S("0")],e.prototype,"value1",void 0),Ue([S("0")],e.prototype,"value2",void 0),Ue([S(!0)],e.prototype,"ignoreBlank",void 0),Ue([S(!0)],e.prototype,"inCellDropDown",void 0),Ue([S(!1)],e.prototype,"isHighlighted",void 0),Ue([S("")],e.prototype,"address",void 0),e})(ke);var CI=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("General")],e.prototype,"format",void 0),Ue([Ee({},bI)],e.prototype,"style",void 0),Ue([S(!0)],e.prototype,"isLocked",void 0),e}(ke),y6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("GreaterThan")],e.prototype,"type",void 0),Ue([Ee({},CI)],e.prototype,"format",void 0),Ue([S("RedFT")],e.prototype,"cFColor",void 0),Ue([S("")],e.prototype,"value",void 0),Ue([S("")],e.prototype,"range",void 0),e}(ke),b6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(!0)],e.prototype,"visible",void 0),Ue([S("Auto")],e.prototype,"position",void 0),e}(ke),C6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(!1)],e.prototype,"visible",void 0),Ue([S("Auto")],e.prototype,"position",void 0),e}(ke),S6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("")],e.prototype,"color",void 0),Ue([S(1)],e.prototype,"width",void 0),e}(ke),x6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(!1)],e.prototype,"visible",void 0),Ue([S("Circle")],e.prototype,"shape",void 0),Ue([S(5)],e.prototype,"size",void 0),Ue([S(null)],e.prototype,"fill",void 0),Ue([S(!0)],e.prototype,"isFilled",void 0),Ue([Ee({},S6)],e.prototype,"border",void 0),e}(ke),w6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(0)],e.prototype,"width",void 0),e}(ke),M6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S(0)],e.prototype,"width",void 0),e}(ke),HA=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("")],e.prototype,"title",void 0),Ue([Ee({},w6)],e.prototype,"majorGridLines",void 0),Ue([Ee({},M6)],e.prototype,"minorGridLines",void 0),Ue([S(!0)],e.prototype,"visible",void 0),e}(ke),E6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("Line")],e.prototype,"type",void 0),Ue([S("Material")],e.prototype,"theme",void 0),Ue([S(!1)],e.prototype,"isSeriesInRows",void 0),Ue([Ee({},x6)],e.prototype,"markerSettings",void 0),Ue([S("")],e.prototype,"range",void 0),Ue([S("")],e.prototype,"id",void 0),Ue([S("")],e.prototype,"title",void 0),Ue([S(290)],e.prototype,"height",void 0),Ue([S(480)],e.prototype,"width",void 0),Ue([S(0)],e.prototype,"top",void 0),Ue([S(0)],e.prototype,"left",void 0),Ue([Ee({},b6)],e.prototype,"legendSettings",void 0),Ue([Ee({},HA)],e.prototype,"primaryXAxis",void 0),Ue([Ee({},HA)],e.prototype,"primaryYAxis",void 0),Ue([Ee({},C6)],e.prototype,"dataLabelSettings",void 0),e}(ke),I6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("")],e.prototype,"src",void 0),Ue([S("")],e.prototype,"id",void 0),Ue([S(300)],e.prototype,"height",void 0),Ue([S(400)],e.prototype,"width",void 0),Ue([S(0)],e.prototype,"top",void 0),Ue([S(0)],e.prototype,"left",void 0),e}(ke),T6=function(s){Yr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ue([S("FillSeries")],e.prototype,"fillType",void 0),Ue([S(!0)],e.prototype,"showFillOptions",void 0),e}(ke);function Bt(s,e){return s&&s[0]==="="&&(s.length>1||e)}function ur(s){var e=s;if(e=e.split("$").join(""),e.indexOf(":")>-1){var t=e.split(":");if(BC(t[0])&&BC(t[1]))return!0}else if(e.indexOf(":")<0&&BC(e))return!0;return!1}function ZP(s){return s.charCodeAt(0)>=65&&s.charCodeAt(0)<=90||s.charCodeAt(0)>=97&&s.charCodeAt(0)<=122}function JP(s,e){return e[1]===0&&e[3]===s.colCount-1}function D6(s,e){return e[0]===0&&e[2]===s.rowCount-1}function Sa(s,e,t){return s&&e>=s[0]&&e<=s[2]&&t>=s[1]&&t<=s[3]}function ez(s,e,t){for(var i,r,n=s.split(" "),a=0,o=n.length;a<o&&(i=ee(n[a]),r=Sa(i,e,t),!r);a++);return r}function Uf(s,e,t){var i=s[0]<=e[0]&&s[2]>=e[2]&&s[1]<=e[1]&&s[3]>=e[3];if(i)return!0;if(t){if(e[0]<s[0]&&e[2]<s[0]||e[0]>s[2]&&e[2]>s[2]||(e[0]<s[0]&&e[2]>s[0]&&(e[0]=s[0],i=!0),e[2]>s[2]&&(e[2]=s[2],i=!0),e[1]<s[1]&&e[3]<s[1]||e[1]>s[3]&&e[3]>s[3]))return!1;e[1]<s[1]&&e[3]>s[1]&&(e[1]=s[1],i=!0),e[3]>s[3]&&(e[3]=s[3],i=!0)}return i}function A6(s,e,t){var i=Ur(t+1);return s?s.split(" ").forEach(function(r){var n=ee(r);if(Uf(n,e))s=s.split(r).join(i+(n[0]+1)+":"+i+e[0]+" "+i+(e[2]+2)+":"+i+(n[2]+1));else if(Uf(n,e,!0)){var a=void 0;e[0]>n[0]?a=i+(n[0]+1)+":"+i+e[0]:a=i+(e[2]+2)+":"+i+(n[2]+1),s=s.split(r).join(a)}}):s=i+"1:"+i+e[0]+" "+i+(e[2]+2)+":"+i+"1048576",s}function Cn(s,e){return s||(s={}),s.isLocked?!0:s.isLocked===!1?!1:e&&e.isLocked?!0:!!(!s.isLocked&&e&&e.isLocked!==!1)}function BC(s){for(var e=s,t=0,i=0,r="",n=e.length,a=0;a<n;a++)ZP(e[a])&&i++;r=e.substring(t,i);var o=r.length;if(o!==n&&o<4&&n!==1&&isNaN(parseInt(e,10))){var l=N6(r);if(l>16384)return!1;var h=parseFloat(e.substring(i,n));if(h>0&&h<1048577)return!0}return!1}function N6(s){var e=0,t=0;if(s=s.toUpperCase(),e<s.length&&s[e]==="!"){for(e++;e<s.length&&s[e]!=="!";)e++;e++}for(;e<s.length&&ZP(s[e]);){var i=s[e].charCodeAt(0);t=t*26+i-64,e++}return t===0?-1:t}function ae(s,e,t,i,r){i===void 0&&(i="rows");var n;if(t)for(var a=e;a<1/0;a++)if(n=s[""+i],n[e]&&n[e].hidden)e++;else if(r)r--,e++;else break;else for(var a=e;a>-1&&(n=s[""+i],n[e]&&n[e].hidden);a--)e--;return e}function w1(s,e){var t=Object.keys(s);return(e?t.indexOf("fontSize")>-1:t.indexOf("fontSize")>-1&&Number(s.fontSize.split("pt")[0])>12)||t.indexOf("fontFamily")>-1||t.indexOf("borderTop")>-1||t.indexOf("borderBottom")>-1}function tz(s,e,t,i,r,n){var a,o;if(e&&(o=i||Y(e[0],e[1],t,!1,!0),a=o.formula||""),a){n&&r.notify(cd,{cellRef:Je(e[0],e[1])}),a.indexOf("=")===0&&(a=a.slice(1)),a=a.split("(").join(",").split(")").join(",");for(var l=["+","-","*","/",">=","<=","<>",">","<","=","%"],h=void 0,u=a,c=0;c<l.length;c++)h=u.split(l[c]),u=h.join(",");h=u.split(",");for(var d=[],p=void 0,f=void 0,v=void 0,g=void 0,b=void 0,y=0;y<h.length;y++)if(v=h[y].includes("!"),v?(g=h[y].split("!"),b=g[1].toUpperCase()):b=h[y].toUpperCase(),ur(b)){var C=ee(b),x=[s[0]-(e[0]-C[0]),s[1]-(e[1]-C[1]),s[0]-(e[0]-C[2]),s[1]-(e[1]-C[3])];x[1]<0||x[2]<0||x[3]<0||!n&&x[0]<0?p="#REF!":(n&&x[0]<0&&(x[0]=x[2]),p=Je(x[0],x[1]),b.includes(":")&&(p+=":"+Je(x[2],x[3])),p=ur(p)?p:"#REF!"),f={},v&&(p=g[0]+"!"+p),f[h[y]]=p,h[y].includes(":")?d.splice(0,0,f):d.push(f)}var w=void 0,M=void 0;a=o.formula;for(var E=a,y=0;y<d.length;y++){w=Object.keys(d[y])[0],M=d[y][""+w];for(var T=w.length,D=E.indexOf(w),N="",A=0;A<M.length;A++)N+=" ";a=a.slice(0,D)+M+a.slice(D+T),E=E.slice(0,D)+N+E.slice(D+T)}return a}else return null}function Tn(s,e,t){var i={cell:t.cell,rowIndex:t.rowIdx,colIndex:t.colIdx,cancel:!1,sheet:e.name};if(t.preventEvt||s.trigger(r6,i),!t.eventOnly&&!i.cancel)if(t.valChange){var r=Y(i.rowIndex,i.colIndex,e),n=!t.preventEvt&&s.getDisplayText(r),a=!!(r&&r.formula);Ht(i.rowIndex,i.colIndex,e,i.cell,!t.pvtExtend);var o=Y(i.rowIndex,i.colIndex,e,!1,!0),l={action:"updateCellValue",address:[i.rowIndex,i.colIndex],sheetIndex:gt(s,e.name),value:a&&!o.formula?o.value||(o.value===0?"0":""):o.formula||o.value||(o.value===0?"0":""),skipFormatCheck:t.skipFormatCheck,isRandomFormula:t.isRandomFormula};if(s.notify(au,l),t.isFormulaDependent=l.isFormulaDependent,t.requestType&&i.cell===null&&Ht(i.rowIndex,i.colIndex,e,i.cell,!t.pvtExtend),t.cellDelete&&(delete o.value,delete o.formula,delete o.hyperlink),t.uiRefresh&&s.serviceLocator.getService("cell").refresh(i.rowIndex,i.colIndex,t.lastCell,t.td,t.checkCF,t.checkWrap,t.skipFormatCheck,t.isRandomFormula),!t.preventEvt){var h=s.getDisplayText(o);if(h!==n){var u=Y(i.rowIndex,i.colIndex,e,!1,!0).value;u=u||(u===0?"0":"");var c={value:u,oldValue:n,formula:o.formula||"",address:e.name+"!"+Je(i.rowIndex,i.colIndex),displayText:h};t.requestType&&(c.requestType=t.requestType),s.trigger("cellSave",c)}}}else Ht(i.rowIndex,i.colIndex,e,i.cell,!t.pvtExtend);return i.cancel}function iz(s,e,t){for(var i=s,r=s,n=e,a=e,o=t.usedRange.rowIndex,l=t.usedRange.colIndex,h=function(d){for(var p=0;p<=l;p++)if(!Re(Y(d,p,t,null,!0).value))return!1;return!0},u=function(d){for(var p=i;p<=r;p++)if(!Re(Y(p,d,t,null,!0).value))return!1;return!0},c=i;c<=o&&!(Re(Y(c,e,t,null,!0).value)&&h(c));c++)r=c;for(var c=i;c>=0&&!(Re(Y(c,e,t,null,!0).value)&&h(c));c--)i=c;for(var c=n;c<=l&&!(Re(Y(s,c,t,null,!0).value)&&u(c));c++)a=c;for(var c=n;c>=0&&!(Re(Y(s,c,t,null,!0).value)&&u(c));c--)n=c;return[i,n,r,a]}function k6(s,e,t){var i=ee(s.model.selectedRange),r=0,n=0;return s.modelType==="Column"?(t&&(i=[0,s.start,0,s.end]),s.insertType==="before"?e[1]<=i[1]&&e[3]>=i[1]?(r=0,n=i[3]-i[1]+1):i[1]<e[1]&&(r=n=i[3]-i[1]+1):e[1]<=i[3]&&e[3]>=i[3]?(r=0,n=i[3]-i[1]+1):i[3]<e[3]&&(r=n=i[3]-i[1]+1),[e[0],e[1]+r,e[2],e[3]+n]):(t&&(i=[s.start,0,s.end,0]),s.insertType==="above"?e[0]<=i[0]&&e[2]>=i[0]?(r=0,n=i[2]-i[0]+1):i[0]<e[0]&&(r=n=i[2]-i[0]+1):e[0]<=i[2]&&e[2]>=i[2]?(r=0,n=i[2]-i[0]+1):i[2]<e[2]&&(r=n=i[2]-i[0]+1),[e[0]+r,e[1],e[2]+n,e[3]])}function L6(s,e){var t,i=0,r=0;return s.modelType==="Column"?(t=[0,s.start,s.model.usedRange.rowIndex,s.end],t[3]<e[1]?i=r=t[3]-t[1]+1:t[1]>=e[1]&&t[3]<=e[3]?r=t[3]-t[1]+1:t[1]>=e[1]&&t[1]<=e[3]?r=e[3]-t[1]+1:t[1]<e[1]&&t[3]>=e[1]?(i=e[1]-t[1],r=t[3]-t[1]+1):t[1]<e[1]&&t[3]<e[3]&&(i=t[3]-e[1]+(t[3]-t[1])+1,r=t[3]-t[1]+1),[e[0],e[1]-i,e[2],e[3]-r]):(t=[s.start,0,s.end,s.model.usedRange.colIndex],t[2]<e[0]?i=r=t[2]-t[0]+1:t[0]>=e[0]&&t[2]<=e[2]?r=t[2]-t[0]+1:t[0]>=e[0]&&t[0]<=e[2]?r=e[2]-t[0]+1:t[0]<e[0]&&t[2]>=e[0]?(i=e[0]-t[0],r=t[2]-t[0]+1):t[0]<e[0]&&t[2]<e[2]&&(i=t[2]-e[0]+(t[2]-t[0])+1,r=t[2]-t[0]+1),[e[0]-i,e[1],e[2]-r,e[3]])}function _f(s,e,t,i){for(var r,n,a=s.length-1;a>=0;a--){r=s[a].range.trim().split(",");for(var o=0;o<r.length;o++)if(n=ee(r[o].includes(":")?r[o]:r[o]+":"+r[o]),t>=n[0]&&i>=n[1]&&t<=n[2]&&i<=n[3]){e.push(s[a]),s.splice(a,1);break}}}function qy(s,e){for(var t=e.trim().split(","),i,r,n,a,o,l=function(u){for(var c=0;c<t.length;c++){if(o=ee(t[c].includes(":")?t[c]:t[c]+":"+t[c]),u[0]<=o[0]&&u[1]<=o[1]&&u[2]>=o[2]&&u[3]>=o[3])return!0;if(n=u[0]>=o[0]&&u[0]<=o[2],a=u[2]>=o[0]&&u[2]<=o[2],i=u[1]>=o[1]&&u[1]<=o[3],r=u[3]>=o[1]&&u[3]<=o[3],n&&a){if((i||r||u[1]<o[1]&&u[3]>o[3])&&(u[0]-o[0]>0||o[2]-u[2]>0)||i&&u[1]!==o[1]||r&&u[3]!==o[3])return!0}else if(i&&r){if((n||a||u[0]<o[0]&&u[2]>o[2])&&(u[1]-o[1]>0||o[3]-u[3]>0))return!0;if(n){if(u[0]!==o[0])return!0}else if(a&&u[2]!==o[2])return!0}else if(n||a){if(i){if(u[1]!==o[1]||u[0]-o[0]>0)return!0;if(o[2]-u[2]>0)return!0}else if(r){if(u[3]!==o[3]||u[0]-o[0]>0)return!0;if(o[2]-u[2]>0)return!0}else if(u[1]<o[1]&&u[3]>o[3])return!0}else if((i||r)&&u[0]<o[0]&&u[2]>o[2])return!0}return!1},h=0;h<s.length;h++)if(l(s[h]))return!0;return!1}function yb(s,e,t,i){var r,n;t||(t=ad(e,jd)),i||(i=Lo(e));for(var a=0;a<s.length;a++)r=s[a].toString().split(t).join(""),n=r.split(i.group),n.length===2&&yI(r,e,i.group,i.decimal)&&(r=n.join("")),i.decimal!=="."&&r.includes(i.decimal)&&(r=r.replace(i.decimal,".")),He(r)&&(s[a]=r);return s}function SI(s,e){var t=s.getActiveSheet(),i=[[e.topIndex+s.frozenRowCount(t),e.leftIndex+s.frozenColCount(t),e.bottomIndex,e.rightIndex]];if(t.frozenRows||t.frozenColumns){var r=s.frozenRowCount(t),n=s.frozenColCount(t),a=xe(t.topLeftCell);if(r&&n){i.push([a[0],a[1],r-1,n-1]);var o=xe(t.paneTopLeftCell);i.push([o[0],a[1],e.bottomIndex,n-1])}r&&i.push([a[0],e.leftIndex+n,r-1,e.rightIndex]),n&&i.push([e.topIndex+r,a[1],e.bottomIndex,n-1])}return i}function bb(s){if(ct(s.sheet,s.rowIdx)){var e=ae(s.sheet,s.rowIdx,!0);e<s.rowIdx+s.cell.rowSpan&&(s.rowIdx=e,s.isMergedHiddenCell=!0)}if(Yt(s.sheet,s.colIdx)){var e=ae(s.sheet,s.colIdx,!0,"columns");e<s.colIdx+s.cell.colSpan&&(s.colIdx=e,s.isMergedHiddenCell=!0)}}function rz(s){var e=new _t,t={};e.getNumberFormat(t);var i={intl:e,updateValue:!0,value:""},r={args:i,intl:e,currencySymbol:ad(s.locale,t.currency)};return function(n){!n.format&&n.value&&!He(n.value)&&(i.cell=n,i.value=n.value,s.notify(yn,i),!n.format&&(n.value.includes(r.currencySymbol)||n.value.includes("%"))&&(r.fResult=n.value,s.notify(e1,r)))}}var xI="spreadsheetLocale",O6={SortOutOfRangeError:"Select a cell or range inside the used range and try again."},en={currency:["$#,##0.00","$#,##0","$#,##0_);[Red]($#,##0)","$#,##0.00_);($#,##0.00)","$#,##0_);($#,##0)","$#,##0.00_);[Red]($#,##0.00)"],accounting:['_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)','_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)']};function $s(s,e,t,i,r,n,a,o,l,h,u,c,d){return l===void 0&&(l=!0),new Promise(function(p,f){p(function(){var v;e.indexOf("!")>-1?(v=gt(s,e.split("!")[0]),e=e.slice(e.indexOf("!")+1,e.length)):v=s.activeSheetIndex;var g=Pe(s,v),b=ir(h||e),y={sheet:g,indexes:b,formulaCellRef:a,sheetIndex:o,isFinite:s.scrollSettings&&s.scrollSettings.isFinite,promise:new Promise(function(C,x){C(function(){}())})};return s.notify(od,y),y.promise.then(function(){var C,x,w,M=b[0],E=s.frozenRowCount(g),T=s.frozenColCount(g),D=!!c;if(t){w=[];var N,A,L,k;e.split(",").forEach(function(Z,se){for(b=ee(Z),N=0,M=b[0];M<=b[2];){for(A=w[N]||{},x=sh(g,M),C=b[1];C<=b[3];){if(l&&ct(g,M)&&!n){M++;continue}L=Ur(C+1);var oe=x?Y(M,C,g):null;i?(k=M1(s,oe,M,C),typeof k=="string"&&He(k)&&(!oe.format||(L===d?oe.format==="General":oe.format!=="@"))&&(k=parseFloat(k)),A[""+L]=k,L===d&&(A.value=oe&&(oe.value||oe.value===0)?He(oe.value)?parseFloat(oe.value):oe.value:"")):(oe&&(oe.formula||!m(oe.value))||Object.keys(A).length)&&(C===u?(k=me({},oe,{value:M1(s,oe,M,C,!0)}),typeof k.value=="string"&&He(k.value)&&!(oe.format&&oe.format==="@")&&(k.value=parseFloat(k.value)),A[""+L]=k):A[""+L]=oe),C===b[3]&&Object.keys(A).length&&(A.__rowIndex=(M+1).toString(),w[N]=A,D&&se===0&&!Aa(g,M)&&c.push(A),N++),C++}M++}})}else{w=new Map;for(var O=!!(!i&&r&&r.length);M<=b[2];){if(O&&M>=E&&M<r[0]){M=r[0];continue}if(!i&&ct(g,M)){M++;continue}for(x=sh(g,M),C=b[1];C<=b[3];){var R={cell:Y(M,C,g),address:Je(M,C),rowIndex:M,colIndex:C};s.trigger(t6,R);var j=Y(M,C,g,!1,!0);if(j.formula&&j.formula.toUpperCase().includes("UNIQUE")&&s.notify("calculateFormula",{cell:j,rowIdx:M,colIdx:C,sheetIndex:s.activeSheetIndex,address:R.address}),j.colSpan>1&&j.rowSpan>1)for(var P=void 0,F=M,z=M+j.rowSpan;F<z;F++)for(var q=C,X=C+j.colSpan;q<X;q++)F===M&&q===C||(P=new Object,F!==M&&(P.rowSpan=M-F),q!==C&&(P.colSpan=C-q),g.rows[F]&&g.rows[F].cells&&g.rows[F].cells[q]&&(delete g.rows[F].cells[q].value,delete g.rows[F].cells[q].formula),Ht(F,q,g,P,!0));else if(j.colSpan>1)for(var F=C+1,z=C+j.colSpan;F<z;F++)Ht(M,F,g,{colSpan:C-F},!0),g.rows[M]&&g.rows[M].cells&&g.rows[M].cells[F]&&(delete g.rows[M].cells[F].value,delete g.rows[M].cells[F].formula);else if(j.rowSpan>1)for(var F=M+1,z=M+j.rowSpan;F<z;F++)Ht(F,C,g,{rowSpan:M-F},!0),g.rows[F]&&g.rows[F].cells&&g.rows[F].cells[C]&&(delete g.rows[F].cells[C].value,delete g.rows[F].cells[C].formula);if(!i&&Yt(g,C)){C++;continue}if(O&&C>=T&&C<r[1]){C=r[1];continue}if(j.style){var G={};Object.assign(G,j.style),j.style=G}w.set(R.address,j),C++}M++}}return w})}())})}function M1(s,e,t,i,r){if(e){if(m(e.value))return"";if(e.format){var n={value:e.value,formattedText:e.value,cell:e,format:e.format,checkDate:!r,rowIndex:t,colIndex:i,dataUpdate:!0};return s.notify(jn,n),n.dateObj&&n.dateObj.toString()!=="Invalid Date"?n.dateObj:r?n.value:n.formattedText}else return e.value}else return""}function Yy(s,e,t){for(var i,r=0,n,a=s.length,o=function(u){if(!m(s[u])&&!Re(s[u].index)&&(n=r=s[u].index-u,delete s[u].index),r>0){for(i=0;r--;)e?(t.createSheet(u+i),i++):s.splice(u,0,null);u+=n,a+=n}if(e){s[u].id<1&&(s[u].id=nz(t.sheets),s[u].properties&&(s[u].properties.id=s[u].id)),s[u].name||t.setSheetPropertyOnMute(s[u],"name","Sheet"+j6(t));var c=0;s[u].rows.forEach(function(d){c=Math.max(c,d&&d.cells&&d.cells.length-1||0)}),t.setSheetPropertyOnMute(s[u],"usedRange",{rowIndex:s[u].rows.length?s[u].rows.length-1:0,colIndex:c})}l=u},l,h=0;h<a;h++)o(h),h=l}var wI=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Di=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},R6=function(s){wI(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.setProperties=function(t,i){var r=this;if(this.parentObj.isComplexArraySetter&&this.controlParent&&this.controlParent.isAngular){if(Object.keys(t).length){this.parentObj.currRangeIdx===void 0?this.parentObj.currRangeIdx=0:this.parentObj.currRangeIdx+=1;var n=this.parentObj.ranges[this.parentObj.currRangeIdx];n&&n.info&&(this.info=n.info),setTimeout(function(){r.parentObj.currRangeIdx!==void 0&&delete r.parentObj.currRangeIdx})}else if(this.controlParent.tagObjects[0].instance&&this.controlParent.tagObjects[0].instance.hasChanges&&!this.controlParent.tagObjects[0].instance.isInitChanges){var a=this.controlParent.sheets.indexOf(this.parentObj);if(this.parentObj.changedRangeIdx===void 0){for(var o,l=this.controlParent.tagObjects[0].instance.list[a].tagObjects,h=0;h<l.length;h++)if(l[h].name==="ranges"){l[h].instance.list.forEach(function(u,c){u.hasChanges&&(o=c)});break}this.parentObj.changedRangeIdx=o}}}s.prototype.setProperties.call(this,t,i)},Di([S(null)],e.prototype,"dataSource",void 0),Di([S("A1")],e.prototype,"startCell",void 0),Di([S(null)],e.prototype,"query",void 0),Di([S(!0)],e.prototype,"showFieldAsHeader",void 0),Di([S("")],e.prototype,"template",void 0),Di([S("A1")],e.prototype,"address",void 0),e}(ke);(function(s){wI(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Di([S(0)],e.prototype,"rowIndex",void 0),Di([S(0)],e.prototype,"colIndex",void 0),e})(ke);var F6=function(s){wI(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Di([S(null)],e.prototype,"rows",void 0),Di([S(null)],e.prototype,"columns",void 0),Di([Ee({},g6)],e.prototype,"protectSettings",void 0),Di([ii([],R6)],e.prototype,"ranges",void 0),Di([ii([],y6)],e.prototype,"conditionalFormats",void 0),Di([S(0)],e.prototype,"index",void 0),Di([S("")],e.prototype,"name",void 0),Di([S(100)],e.prototype,"rowCount",void 0),Di([S(100)],e.prototype,"colCount",void 0),Di([S("A1:A1")],e.prototype,"selectedRange",void 0),Di([S("A1")],e.prototype,"activeCell",void 0),Di([S({})],e.prototype,"usedRange",void 0),Di([S("A1")],e.prototype,"topLeftCell",void 0),Di([S(!0)],e.prototype,"showHeaders",void 0),Di([S(!0)],e.prototype,"showGridLines",void 0),Di([S(!1)],e.prototype,"isProtected",void 0),Di([S("Visible")],e.prototype,"state",void 0),Di([S(0)],e.prototype,"frozenRows",void 0),Di([S(0)],e.prototype,"frozenColumns",void 0),Di([S("A1")],e.prototype,"paneTopLeftCell",void 0),Di([S("")],e.prototype,"password",void 0),e}(ke);function gt(s,e){for(var t,i=0;i<s.sheets.length;i++)if(s.sheets[i].name.toLowerCase()===e.toLowerCase()){t=i;break}return t}function Qn(s,e){for(var t,i=0;i<s.sheets.length;i++)if(s.sheets[i].id===e){t=i;break}return t}function Ms(s){return s.split("!")[0].replace(/\'/gi,"")}function P6(s,e,t){for(var i=t.length,r=0;r<i;r++)if(t[r].sheet.toUpperCase()===e.toUpperCase())return t[r].index;return-1}function Xp(s,e,t,i){t===void 0&&(t={}),s.setSheetPropertyOnMute(t,"selectedRange",i?t.selectedRange+" "+e:e)}function VA(s){return s&&s.selectedRange||"A1"}function z6(s){return s.selectedRange.split(" ")[0]}function Pe(s,e){return s.sheets[e]}function j6(s){var e=[];s.sheets.forEach(function(i){e.push(i.name.toLowerCase())});for(var t=0;t<e.length;t++)if(e.indexOf("sheet"+s.sheetNameCount)>-1)s.sheetNameCount++;else return s.sheetNameCount++;return s.sheetNameCount++}function nz(s){var e=0;return s.forEach(function(t){e=Math.max(t.id,e)}),e+1}function kp(s,e,t){var i=e||s.sheets;i.forEach(function(r){if(r.id=r.id||0,r.name=r.name||"",r.rowCount=Re(r.rowCount)?100:r.rowCount,r.colCount=Re(r.colCount)?100:r.colCount,r.topLeftCell=r.topLeftCell||"A1",r.activeCell=r.activeCell||"A1",r.selectedRange=r.selectedRange||r.activeCell+":"+r.activeCell,r.usedRange=r.usedRange||{rowIndex:0,colIndex:0},s.setSheetPropertyOnMute(r,"ranges",r.ranges?r.ranges:[]),s.setSheetPropertyOnMute(r,"rows",r.rows&&me([],r.rows,null,!0)||[]),s.setSheetPropertyOnMute(r,"columns",r.columns||[]),r.showHeaders=Re(r.showHeaders)?!0:r.showHeaders,r.showGridLines=Re(r.showGridLines)?!0:r.showGridLines,r.state=r.state||"Visible",r.maxHgts=r.maxHgts||[],r.isImportProtected=r.isProtected&&t,r.protectSettings=r.protectSettings||{selectCells:!1,formatCells:!1,formatRows:!1,formatColumns:!1,insertLink:!1},r.isProtected=r.isProtected||!1,!r.paneTopLeftCell||r.paneTopLeftCell==="A1"){r.frozenRows=r.frozenRows?r.frozenRows:0,r.frozenColumns=r.frozenColumns?r.frozenColumns:0;var n=xe(r.topLeftCell);s.setSheetPropertyOnMute(r,"paneTopLeftCell",Je(r.frozenRows?n[0]+r.frozenRows:n[0],r.frozenColumns?n[1]+r.frozenColumns:n[1]))}Yy(r.columns),B6(r.rows)}),Yy(i,!0,s)}function B6(s){s.forEach(function(e){e&&e.cells&&Yy(e.cells)}),Yy(s)}function Ns(s,e){return e===void 0&&(e=s.activeSheetIndex),Pe(s,e).name}function Qy(s,e,t,i,r){var n=!!t;t=t||[s.activeSheetIndex];var a=Ns(s);e=H6(s.sheets,e,s.activeSheetIndex>e);var o={action:"moveSheet",eventArgs:{position:e,sheetIndexes:t,cancel:!1}};i&&s.trigger("actionBegin",o),o.eventArgs.cancel||(t.forEach(function(l,h){s.sheets.splice(e+h,0,s.sheets.splice(l+(e>l?-1*h:0),1)[0])}),s.setProperties({activeSheetIndex:r?gt(s,a):e>t[0]?e-(t.length-1):e},!0),s.notify(jy,{refresh:n}),i&&(delete o.eventArgs.cancel,s.trigger("actionComplete",o)))}function MI(s,e,t,i){e=Re(e)?s.activeSheetIndex:e;var r={action:"duplicateSheet",eventArgs:{sheetIndex:e,cancel:!1}};if(t&&s.trigger("actionBegin",r),!r.eventArgs.cancel){var n=Pe(s,e),a=me({},n.properties?n.properties:n,{},!0);a.id=nz(s.sheets);var o=a.name;/^\(\d+\)$/.test("("+o.split(" (")[1])&&(o=o.split(" (")[0]);var l=[];s.sheets.forEach(function(u){l.push(u.name)});for(var h=2;;h++)if(l.indexOf(o+" ("+h+")")===-1){a.name=o+" ("+h+")";break}s.notify(g1,{sheetIndex:e,newSheetIndex:e+1}),s.createSheet(e+1,[a]),s.notify(xt,{action:"addSheet",sheetName:"Sheet"+a.id,visibleName:a.name,sheetId:a.id}),i||s.setProperties({activeSheetIndex:e+1},!0),s.notify(jy,{refresh:!0,isDuplicate:!0}),t&&(delete r.eventArgs.cancel,s.trigger("actionComplete",r))}}function H6(s,e,t){for(var i=e;t?i>=0:i<s.length;t?i--:i++)if(!(s[i].state==="Hidden"||s[i].state==="VeryHidden")){e=i;break}return e}var V6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ps=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},U6=function(s){V6(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ps([ii([],I6)],e.prototype,"image",void 0),ps([ii([],E6)],e.prototype,"chart",void 0),ps([S("")],e.prototype,"value",void 0),ps([S("")],e.prototype,"formula",void 0),ps([S(0)],e.prototype,"index",void 0),ps([S("General")],e.prototype,"format",void 0),ps([Ee({},bI)],e.prototype,"style",void 0),ps([S("")],e.prototype,"hyperlink",void 0),ps([S(!1)],e.prototype,"wrap",void 0),ps([S(!0)],e.prototype,"isLocked",void 0),ps([S("")],e.prototype,"validation",void 0),ps([S(1)],e.prototype,"colSpan",void 0),ps([S(1)],e.prototype,"rowSpan",void 0),e}(ke);function Y(s,e,t,i,r){var n=sh(t,s);if(!n||!n.cells)if(i)n?t.rows[s].cells=[]:t.rows[s]={cells:[]};else return r?{}:null;return t.rows[s].cells[e]||(r?{}:null)}function Ht(s,e,t,i,r){t.rows[s]?t.rows[s].cells||(t.rows[s].cells=[]):t.rows[s]={cells:[]},r&&t.rows[s].cells[e]?me(t.rows[s].cells[e],i,null,!0):t.rows[s].cells[e]=i}function EI(s,e){var t={fontFamily:"Calibri",verticalAlign:"bottom",textIndent:"0pt",backgroundColor:"#ffffff",color:"#000000",textAlign:"left",fontSize:"11pt",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",border:"",borderLeft:"",borderTop:"",borderRight:"",borderBottom:""},i={},r;return Object.keys(e?t:s).forEach(function(n){r=s[""+n],r!==t[""+n]&&(i[""+n]=r)}),i}function _c(s,e,t,i){e===void 0&&(e=!0);for(var r=t.getAddressInfo(s),n=r.indices,a=Pe(t,r.sheetIndex),o=r.sheetIndex===t.activeSheetIndex,l=!i,h=n[0];h<=n[2];h++)for(var u=n[1];u<=n[3];u++)l=Tn(t,a,{cell:{wrap:e},rowIdx:h,colIdx:u,preventEvt:i}),!l&&o&&t.notify(eh,{range:[h,u,h,u],wrap:e,sheet:a});t.setProperties({sheets:t.sheets},!0)}function ba(s){var e;if(s.indexOf("[")>-1){var t=s.split("[")[1].split("]")[0],i=E1();i.indexOf(t)>-1&&(e=t)}return e}function E1(){return["Black","Blue","Cyan","Green","Magenta","Red","White","Yellow"]}function yd(s,e,t,i){var r;return(s.includes("d")||s.includes("y"))&&!s.includes("#")&&!ba(s)&&(t&&(t.type="date"),i&&s.includes(" ")&&s.split(" ").length===2?s=s.split(" ")[1]:e=!1,r=!0),e&&(s.includes("h")||s.includes("m")||s.includes("s"))&&!s.includes("#")&&!ba(s)&&(t&&(t.type=t.type||"",t.type+="time"),r=!0),r}var sz=function(){function s(){this.services={}}return s.prototype.getService=function(e){if(m(this.services[""+e]))throw"The service "+e+" is not registered";return this.services[""+e]},s.prototype.register=function(e,t){m(this.services[""+e])&&(this.services[""+e]=t)},s}(),Wh="ribbon",Wf="formulaBar",Gy="sheetTabs",Wl="refreshSheetTabs",bd="isFormulaBarEdit",tn="contentLoaded",Qo="mouseDown",Dn="spreadsheetDestroyed",Jt="editOperation",Ho="formulaOperation",Po="formulaBarOperation",hu="click",Xn="keyUp",Ra="keyDown",qf="verticalScroll",Yf="horizontalScroll",I1="beforeContentLoaded",T1="beforeVirtualContentLoaded",wa="virtualContentLoaded",$y="cellNavigate",D1="mouseUpAfterSelection",uu="contextmenuBeforeOpen",A1="insertSheetTab",Xy="removeSheetTab",N1="renameSheetTab",Qf="ribboClick",nh="enableToolbarItems",k1="tabSwitch",cu="selectRange",L1="rangeSelectionByKeydown",du="cut",pu="copy",Ia="paste",Cd="clearCopy",_6="dataBound",W6="beforeDataBound",O1="addContextMenuItems",R1="removeContextMenuItems",F1="enableContextMenuItems",P1="enableFileMenuItems",z1="hideFileMenuItems",j1="addFileMenuItems",B1="hideRibbonTabs",H1="enableRibbonTabs",V1="addRibbonTabs",U1="addToolbarItems",_1="hideToolbarItems",W1="beforeRibbonCreate",an="rowHeightChanged",wn="colWidthChanged",q1="onContentScroll",Sd="deInitProperties",fu="activeSheetChanged",Ky="initiateCustomSort",vu="applySort",Y1="autoFitRowsColumns",Ah="updateToggleItem",Gf="initiateHyperlink",$f="editHyperlink",Q1="openHyperlink",Xf="removeHyperlink",G1="createHyperlinkElement",Zy="sheetNameUpdate",Jy="hideSheet",Fa="performUndoRedo",e0="updateUndoRedoCollection",t0="setActionData",HC="getBeforeActionData",mu="clearUndoRedoCollection",so="initiateFilterUI",Kp="renderFilterCell",i0="reapplyFilter",$1="filterByCellValue",Kf="clearFilter",r0="getFilteredColumn",yt="actionComplete",n0="filterCellKeyDown",xd="getFilterRange",X1="setAutoFit",K1="refreshFormulaDatasource",UA="setScrollEvent",Z1="initiatedatavalidation",Zf="invalidData",Wc="protectSheet",Lp="applyProtect",J1="protectCellFormat",eM="renderGotoDlgt",tM="renderFindDlg",Xd="findHandler",VC="created",Ta="editAlert",iM="setUndoRedo",rM="enableFormulaInput",s0="protectSelection",a0="hiddenMerge",nM="checkPrevMerge",o0="checkMerge",Jf="removeDataValidation",wd="showAggregate",sM="goToSheet",aM="showSheet",oM="renderCFDlg",ev="clearViewer",Nh="initiateFormulaReference",l0="initiateCur",lM="clearCellRef",h0="editValue",zh="addressHandle",hM="initiateEdit",Ec="forRefSelRender",uM="insertImage",cM="refreshOverlayElem",Md="refreshImgCellObj",lo="getRowIdxFromClientY",ho="getColIdxFromClientX",Da="createImageElement",Xs="deleteImage",gu="deleteChart",Ed="refreshChartCellObj",u0="refreshImagePosition",dM="updateTableWidth",Ic="focusBorder",pM="clearChartBorder",fM="insertChart",Tc="chartRangeSelection",c0="insertDesignChart",qh="removeDesignChart",Yh="chartDesignTab",_A="addChartEle",vM="undoRedoForChartDesign",d0="protectWorkbook",p0="unProtectWorkbook",WA="getPassWord",mM="setProtectWorkbook",gM="removeWorkbookProtection",yM="importProtectWorkbook",tv="selectionStatus",Zp="freeze",bM="overlayEleSize",f0="updateScroll",Pa="positionAutoFillElement",v0="hideAutoFillOptions",m0="performAutoFill",CM="selectAutoFillRange",ql="hideAutoFillElement",SM="unProtectSheetPassword",Qh="updateTranslate",xM="getUpdatedScrollPosition",g0="updateScrollValue",qA="beforeCheckboxfilterRenderer",YA="refreshCheckbox",wM="renderInsertDlg",y0="toggleProtect",q6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),MM=function(){return MM=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},MM.apply(this,arguments)},Pt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Y6=function(s){q6(e,s);function e(i){var r=s.call(this,i)||this;return r.isEdit=!1,r.sheetNameCount=1,r.dataValidationRange="",r.isOpen=!1,r.chartColl=[],r.customFormulaCollection=new Map,t.Inject(AP,LP,NP,FP,HP,VP,OP,PP,UP,zP,_P,qP,WP,YP,QP,GP,jP,BP,$P),r.commonCellStyle={},i&&i.cellStyle&&(r.commonCellStyle=i.cellStyle),r.getModuleName()==="workbook"&&(r.serviceLocator=new sz,r.initWorkbookServices(),r.dataBind(),r.initEmptySheet()),r}t=e,e.prototype.preRender=function(){Object.keys(this.commonCellStyle).length||(this.commonCellStyle=EI(this.cellStyle,!0)),this.getModuleName()==="spreadsheet"&&!this.refreshing&&this.initEmptySheet()},e.prototype.initWorkbookServices=function(){this.serviceLocator.register(xI,new In(this.getModuleName(),O6,this.locale))},e.prototype.render=function(){},e.prototype.requiredModules=function(){return XP(this)},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.cellFormat=function(i,r){var n=this.getActiveSheet();r=r||n.selectedRange,this.notify(Ri,{style:i,range:r,refreshRibbon:r.indexOf(n.activeCell)>-1})},e.prototype.lockCells=function(i,r){var n=this.getActiveSheet();i=i||n.selectedRange,this.notify(Ry,{range:i,isLocked:r,triggerEvent:!0})},e.prototype.getCellStyleValue=function(i,r){var n=this,a=Y(r[0],r[1],this.getActiveSheet()),o={};return i.forEach(function(l){o[""+l]=n.cellStyle[""+l],a&&a.style&&a.style[""+l]&&(o[""+l]=a.style[""+l])}),o},e.prototype.numberFormat=function(i,r){this.notify(Rf,{format:i,range:r}),this.notify(y1,{format:i})},e.prototype.createSheet=function(i,r){i===void 0&&(i=this.sheets.length),r===void 0&&(r=[{}]);var n;(n=this.sheets).splice.apply(n,[i,0].concat(r)),kp(this,r),this.notify(Ff,{sheetIndex:i||0,sheets:r}),this.notify(xt,{action:"registerSheet",sheetIndex:i||0,sheetCount:i+r.length})},e.prototype.removeSheet=function(i){this.sheets.splice(i,1)},e.prototype.destroy=function(){this.notify($W,null),s.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(i,r){for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];switch(o){case"cellStyle":bt(this.commonCellStyle,i.cellStyle);break;case"sheets":i.sheets===this.sheets?(this.notify(xt,{action:"unRegisterSheet",propertyChange:!0}),this.sheetNameCount=1,this.notify(Jl,{}),kp(this),this.notify(Ff,null),this.notify(xt,{action:"registerSheet"})):kp(this);break}}},e.prototype.appendTo=function(i){s.prototype.appendTo.call(this,i)},e.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var a=this.getActiveSheet(),o=i;o<=r;o++)Ts(a,o,{hidden:n})},e.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var a=this.getActiveSheet(),o=i;o<=r;o++)Td(a,o,{hidden:n})},e.prototype.setBorder=function(i,r,n,a){this.notify(Ri,{style:i,borderType:n,range:r||this.getActiveSheet().selectedRange,isUndoRedo:a})},e.prototype.insertRow=function(i,r,n){this.notify(Js,{model:this.getSheetModel(n),start:i,end:r,modelType:"Row",insertType:"below"})},e.prototype.insertColumn=function(i,r,n){this.notify(Js,{model:this.getSheetModel(n),start:i,end:r,modelType:"Column",insertType:"after"})},e.prototype.insertSheet=function(i,r){this.notify(Js,{model:this,start:i,end:r,modelType:"Sheet"})},e.prototype.delete=function(i,r,n,a){i=i||0;var o;if(!n||n==="Sheet")o=this;else if(o=this.getSheetModel(a),!o)return;this.notify(zf,{model:o,start:i,end:m(r)?i:r,modelType:n||"Sheet"})},e.prototype.moveSheet=function(i,r){Qy(this,i,r)},e.prototype.duplicateSheet=function(i){MI(this,i)},e.prototype.getSheetModel=function(i){if(m(i))return this.getActiveSheet();var r=typeof i=="string"?gt(this,i):i;return m(r)||r>=this.sheets.length?null:this.sheets[r]},e.prototype.merge=function(i,r){var n,a;i?(n=La(this,i),a=Pe(this,n)):(a=this.getActiveSheet(),i=a.selectedRange),this.notify(Fn,{merge:!0,range:i,type:r||"All",sheetIndex:n,refreshRibbon:i.indexOf(a.activeCell)>-1,preventRefresh:this.activeSheetIndex!==n})},e.prototype.unMerge=function(i){var r,n;i?(r=La(this,i),n=Pe(this,r)):(n=this.getActiveSheet(),i=n.selectedRange),this.notify(Fn,{merge:!1,range:i,sheetIndex:r,type:"All",refreshRibbon:i.indexOf(n.activeCell)>-1,preventRefresh:this.activeSheetIndex!==r})},e.prototype.computeExpression=function(i){var r={action:"computeExpression",formula:i,isFromComputeExpression:!0};return this.notify(xt,r),r.calcValue},e.prototype.initEmptySheet=function(){this.sheets.length?kp(this):this.createSheet()},e.prototype.getActiveSheet=function(){return this.sheets[this.activeSheetIndex]},e.prototype.skipHiddenSheets=function(i,r,n){return n===void 0&&(n=0),this.sheets[i]&&this.sheets[i].state!=="Visible"&&(r===void 0&&(r=i),i&&i+1===this.sheets.length?i=r-1:i=i<r?--i:++i,i=this.skipHiddenSheets(i,r,++n)),n===this.sheets.length?(this.setSheetPropertyOnMute(this.sheets[0],"state","Visible"),0):i},e.prototype.setUsedRange=function(i,r,n,a,o){if(n===void 0&&(n=this.getActiveSheet()),o){n.usedRange.rowIndex=i,n.usedRange.colIndex=r;return}i>n.usedRange.rowIndex&&(n.usedRange.rowIndex=i,n===this.getActiveSheet()&&!a&&this.notify(hd,{index:i,update:"row"})),r>n.usedRange.colIndex&&(n.usedRange.colIndex=r,n===this.getActiveSheet()&&!a&&this.notify(hd,{index:r,update:"col"}))},e.prototype.getData=function(i){return $s(this,i)},e.prototype.getModuleName=function(){return"workbook"},e.prototype.goTo=function(i){},e.prototype.getValueRowCol=function(i,r,n,a,o,l,h){var u={action:"getSheetInfo",sheetInfo:[]};if(this.notify(xt,u),P6(this,"Sheet"+i,u.sheetInfo)===-1){var c={action:"getReferenceError",refError:""};return this.notify(xt,c),c.refError}var d=Qn(this,i),p=Pe(this,d),f=Y(r-1,n-1,p);if(a&&a.includes("!")&&!f&&p.ranges&&p.ranges.length){var v;if(this.formulaRefCell&&this.formulaRefCell===a)return f&&f.value;if(p.ranges.forEach(function(b){if(!b.info||!b.info.loadedRange||!b.info.loadedRange.length){v=!0;return}}),v){if(this.formulaRefCell=a,d=Qn(this,Number(a.substring(a.lastIndexOf(",")+1,a.length))),m(d))return f&&f.value;a=a.substring(a.lastIndexOf("!")+1,a.lastIndexOf(",")),$s(this,p.name+"!A1:"+Je(r-1,n-1),null,null,null,null,a,d)}}else f&&f.formula&&(o||m(f.value))&&!l&&this.notify("calculateFormula",{cell:f,rowIdx:r-1,colIdx:n-1,sheetIndex:d,formulaRefresh:!0});if(f&&!He(f.value)&&!this.isEdit){var g={formattedText:f.value,value:f.value,format:f.format,cell:f,skipFormatCheck:!1};this.notify(jn,g),f=g.cell}return h&&f&&f.formula&&f.formula.includes("SUBTOTAL(")?f.formula:f&&f.value},e.prototype.setValueRowCol=function(i,r,n,a,o,l){this.notify(au,{action:"updateCellValue",address:[n-1,a-1],value:r,sheetIndex:Qn(this,i),isValueOnly:!0,formula:o,isRandomFormula:l})},e.prototype.open=function(i){this.notify(My,i)},e.prototype.openFromJson=function(i){this.isOpen=!0;var r=typeof i.file=="object"?JSON.stringify(i.file):i.file;this.notify(My,{jsonObject:r,triggerEvent:i.triggerEvent})},e.prototype.save=function(i){if(i===void 0&&(i={}),this.allowSave){var r={url:this.saveUrl,fileName:i.fileName||"Sample",saveType:"Xlsx"},n=MM({},r,i,{customParams:{},isFullPost:!0,needBlobData:!1,cancel:!1,autoDetectFormat:!1,pdfLayoutSettings:{fitSheetOnOnePage:!1,orientation:"Portrait"}});this.trigger("beforeSave",n),this.notify(li,{eventArgs:n,action:"beforeSave"}),n.cancel||this.notify(kf,{saveSettings:n,isFullPost:n.isFullPost,needBlobData:n.needBlobData,customParams:n.customParams,pdfLayoutSettings:n.pdfLayoutSettings})}},e.prototype.saveAsJson=function(){var i=this;return new Promise(function(r){i.on(n1,function(n){n.cancel=!0,i.off(n1),r({jsonObject:{Workbook:n.jsonObject}}),i.notify(Of,n)}),i.save()})},e.prototype.addHyperlink=function(i,r){var n={hyperlink:i,cell:r};this.notify(dd,n)},e.prototype.findHandler=function(i){this.notify(o1,i)},e.prototype.replaceHandler=function(i){i.replaceBy==="replace"?this.notify(Bf,i):this.notify(fd,i)},e.prototype.protectSheet=function(i,r,n){m(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=gt(this,i));var a=this.sheets[i];a&&(this.setSheetPropertyOnMute(a,"isProtected",!0),this.setSheetPropertyOnMute(a,"password",n||""),this.setSheetPropertyOnMute(a,"protectSettings",r||{}),this.notify(Hc,{protectSettings:a.protectSettings,password:a.password,sheetIndex:i}))},e.prototype.unprotectSheet=function(i){if(m(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=gt(this,i)),!!this.sheets[i]){var r={sheet:i};this.notify(kP,r)}},e.prototype.sort=function(i,r){if(!this.allowSorting)return Promise.reject();var n={range:r||this.getActiveSheet().selectedRange,sortOptions:i||{sortDescriptors:{}},cancel:!1},a=new Promise(function(l,h){l(function(){}())}),o={args:n,promise:a};return this.notify(Pf,o),o.promise},e.prototype.addDataValidation=function(i,r){i.type==="List"&&i.value1.length>256&&(i.value1=i.value1.substring(0,255)),this.notify(Yo,{rules:i,range:r||this.getActiveSheet().selectedRange})},e.prototype.removeDataValidation=function(i){this.notify(Yo,{range:i,isRemoveValidation:!0})},e.prototype.addInvalidHighlight=function(i){this.notify(pd,{range:i})},e.prototype.removeInvalidHighlight=function(i){this.notify(h1,{range:i})},e.prototype.isValidCell=function(i){var r=xe(i),n=Y(r[0],r[1],this.getActiveSheet());if(n&&n.validation){var a=n.value?n.value:"",o=this.activeSheetIndex,l={value:a,range:r,sheetIdx:o,isCell:!1,td:null,isValid:!0};return this.notify(jf,l),l.isValid}else return!0},e.prototype.conditionalFormat=function(i){i.range=i.range||this.getActiveSheet().selectedRange,this.notify(vd,{cfModel:i})},e.prototype.clearConditionalFormat=function(i){var r={};if(!i||!i.includes("!"))r.range=i||this.getActiveSheet().selectedRange,r.sheetIdx=this.activeSheetIndex;else{var n=i.split("!");r.range=n[1],r.sheetIdx=gt(this,n[0])}this.notify(no,r)},e.prototype.updateCell=function(i,r){var n,a;if(r||(r=this.getActiveSheet().activeCell),r.includes("!")){if(n=ir(r),a=gt(this,r.split("!")[0]),a===void 0)return}else n=ee(r),a=this.activeSheetIndex;var o=Pe(this,a);Tn(this,o,{cell:i,rowIdx:n[0],colIdx:n[1],preventEvt:!0});var l=m(i.value)?i.formula||null:i.value;if(l!==null&&this.notify(au,{action:"updateCellValue",address:n,value:l,sheetIndex:a}),a===this.activeSheetIndex){var h=void 0,u=Y(n[0],n[1],o,!1,!0),c={sheet:o,cell:u,rowIdx:n[0],colIdx:n[1]};(u.rowSpan>1||u.colSpan>1)&&(bb(c),h=this.getCell(c.rowIdx,c.colIdx)),this.serviceLocator.getService("cell").refresh(n[0],n[1],!0,h,l!==null),this.notify(sa,null),Sa(ee(o.activeCell),c.rowIdx,c.colIdx)&&this.notify(Po,{action:"refreshFormulabar",value:this.getDisplayText(i)||i.formula})}},e.prototype.getRowData=function(i,r){m(i)&&(i=0),m(r)&&(r=this.activeSheetIndex);var n={sheetIdx:r,startIndex:i,modelType:"Row",isDataRequest:!0};return this.notify(wg,n),n.data},e.prototype.updateRange=function(i,r){r=r?r-1:this.activeSheetIndex;var n=Pe(this,r),a=n.ranges;m(n)||(a.push(i),n.ranges=a)},e.prototype.wrap=function(i,r){r===void 0&&(r=!0),_c(i,r,this)},e.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(xt,r),r.isAdded},e.prototype.removeDefinedName=function(i,r){r===void 0&&(r="");var n={action:"removeDefinedName",isRemoved:!1,definedName:i,scope:r};return this.notify(xt,n),n.isRemoved},e.prototype.clearRange=function(i,r,n){},e.prototype.insertImage=function(i,r){this.notify(Py,{options:i,range:r||this.getActiveSheet().selectedRange})},e.prototype.autoFill=function(i,r,n,a){var o={dataRange:r||this.getActiveSheet().selectedRange,fillRange:i,direction:n||"Down",fillType:a||"FillSeries"};this.notify(gd,o)},e.prototype.insertChart=function(i){this.notify(th,{chart:i})},e.prototype.deleteChart=function(i){this.notify(gu,{id:i})},e.prototype.filter=function(i,r){if(!this.allowFiltering)return Promise.reject();var n={range:r||this.getActiveSheet().selectedRange,filterOptions:i,cancel:!1},a=new Promise(function(l,h){l(function(){}())}),o={args:n,promise:a};return this.notify(Ny,o),o.promise},e.prototype.addCustomFunction=function(i,r,n){r=r||(typeof i=="string"?i:i.name.replace("bound ",""));var a={action:"addCustomFunction",functionHandler:i,functionName:r,formulaDescription:n};this.notify(xt,a)},e.prototype.clear=function(i){this.notify(md,i)},e.prototype.getDisplayText=function(i){if(!i)return"";if(i.format&&!m(i.value)){var r={formattedText:i.value,value:i.value,format:i.format,cell:i,skipFormatCheck:!0};return this.notify(jn,r),r.formattedText}else return!i.value&&i.hyperlink?typeof i.hyperlink=="string"?i.hyperlink:i.hyperlink.address:i.value||typeof i.value=="number"?i.value.toString():""},e.prototype.freezePanes=function(i,r,n){i===void 0&&(i=1),r===void 0&&(r=1);var a=this.getSheetModel(n);!this.allowFreezePane||a.frozenRows===i&&a.frozenColumns===r||(this.setSheetPropertyOnMute(a,"frozenRows",i),this.setSheetPropertyOnMute(a,"frozenColumns",r),this.updateTopLeftCell(),a.id===this.getActiveSheet().id&&this.getModuleName()==="spreadsheet"&&this.renderModule.refreshSheet())},e.prototype.Unfreeze=function(i){this.freezePanes(0,0,i)},e.prototype.unfreezePanes=function(i){this.freezePanes(0,0,i)},e.prototype.updateTopLeftCell=function(i,r,n,a){a||(a=this.getActiveSheet());var o=xe(a.topLeftCell);a.frozenRows||a.frozenColumns?((m(i)||i<0)&&(i=a.frozenRows?0:o[0]),(m(r)||r<0)&&(r=a.frozenColumns?0:o[1]),i+=this.frozenRowCount(a),r+=this.frozenColCount(a),n&&(n==="row"?i=xe(a.paneTopLeftCell)[0]:r=xe(a.paneTopLeftCell)[1]),this.setSheetPropertyOnMute(a,"paneTopLeftCell",Je(i,r)),a.frozenRows&&(i=o[0]),a.frozenColumns&&(r=o[1])):(m(i)&&(i=o[0]),m(r)&&(r=o[1]),this.setSheetPropertyOnMute(a,"paneTopLeftCell",Je(i,r))),this.setSheetPropertyOnMute(a,"topLeftCell",Je(i,r))},e.prototype.getAddressInfo=function(i){return TP(this,i)},e.prototype.setSheetPropertyOnMute=function(i,r,n){this.isProtectedOnChange=!0,i[""+r]=n,this.isProtectedOnChange=!1},e.prototype.frozenRowCount=function(i){return i.frozenRows?i.topLeftCell==="A1"?i.frozenRows:xe(i.topLeftCell)[0]+i.frozenRows:0},e.prototype.frozenColCount=function(i){return i.frozenColumns?i.topLeftCell==="A1"?i.frozenColumns:xe(i.topLeftCell)[1]+i.frozenColumns:0},e.prototype.updateRangeOnInsertDelete=function(i,r,n){var a,o=!1;return i.isInsert?(a=i.endIndex-i.startIndex+1,i.modelType==="Row"?(i.startIndex<=r[0]&&(r[0]+=a,o=!0),(i.startIndex<=r[2]||n&&i.startIndex===r[2]+1)&&(r[2]+=a,o=!0)):(i.startIndex<=r[1]&&(r[1]+=a,o=!0),(i.startIndex<=r[3]||n&&i.startIndex===r[3]+1)&&(r[3]+=a,o=!0))):i.modelType==="Row"?(a=r[0]-i.startIndex,a>0&&(r[0]>i.endIndex?(a=i.endIndex-i.startIndex+1,a>0&&(r[0]-=a,o=!0)):(r[0]-=a,o=!0)),i.startIndex<=r[2]&&(i.endIndex<=r[2]?r[2]-=i.endIndex-i.startIndex+1:r[2]-=r[2]-i.startIndex+1,o=!0)):(a=r[1]-i.startIndex,a>0&&(r[1]>i.endIndex?(a=i.endIndex-i.startIndex+1,a>0&&(r[1]-=a,o=!0)):(r[1]-=a,o=!0)),i.startIndex<=r[3]&&(i.endIndex<=r[3]?r[3]-=i.endIndex-i.startIndex+1:r[3]-=r[3]-i.startIndex+1,o=!0)),o},e.prototype.getCell=function(i,r,n){return null},e.prototype.dateToInt=function(i,r){return Es(i,r)},e.prototype.setDateFormat=function(i,r,n){var a=Pe(this,Qn(this,i)),o=Y(r,n,a,null,!0).format;(!o||o==="General")&&Ht(r,n,a,{format:Ki("ShortDate")},!0)};var t;return Pt([ii([],F6)],e.prototype,"sheets",void 0),Pt([S(0)],e.prototype,"activeSheetIndex",void 0),Pt([S("100%")],e.prototype,"height",void 0),Pt([S(!0)],e.prototype,"allowFindAndReplace",void 0),Pt([S()],e.prototype,"filterCollection",void 0),Pt([S()],e.prototype,"sortCollection",void 0),Pt([S("100%")],e.prototype,"width",void 0),Pt([S(!0)],e.prototype,"showRibbon",void 0),Pt([S(!0)],e.prototype,"showFormulaBar",void 0),Pt([S(!0)],e.prototype,"showSheetTabs",void 0),Pt([S(!0)],e.prototype,"allowEditing",void 0),Pt([S(!0)],e.prototype,"allowOpen",void 0),Pt([S(!0)],e.prototype,"allowSave",void 0),Pt([S(!0)],e.prototype,"allowSorting",void 0),Pt([S(!0)],e.prototype,"allowFiltering",void 0),Pt([S(!0)],e.prototype,"allowNumberFormatting",void 0),Pt([S(!0)],e.prototype,"allowCellFormatting",void 0),Pt([S(!0)],e.prototype,"allowHyperlink",void 0),Pt([S(!0)],e.prototype,"allowInsert",void 0),Pt([S(!0)],e.prototype,"allowDelete",void 0),Pt([S(!0)],e.prototype,"allowMerge",void 0),Pt([S(!0)],e.prototype,"allowDataValidation",void 0),Pt([S(!0)],e.prototype,"allowImage",void 0),Pt([S(!0)],e.prototype,"allowChart",void 0),Pt([S(!0)],e.prototype,"allowAutoFill",void 0),Pt([Ee({},T6)],e.prototype,"autoFillSettings",void 0),Pt([S(!0)],e.prototype,"allowConditionalFormat",void 0),Pt([Ee({},bI)],e.prototype,"cellStyle",void 0),Pt([S("")],e.prototype,"openUrl",void 0),Pt([S("")],e.prototype,"saveUrl",void 0),Pt([S("")],e.prototype,"password",void 0),Pt([S(!1)],e.prototype,"isProtected",void 0),Pt([ii([],KP)],e.prototype,"definedNames",void 0),Pt([_()],e.prototype,"beforeOpen",void 0),Pt([_()],e.prototype,"openFailure",void 0),Pt([_()],e.prototype,"beforeSave",void 0),Pt([_()],e.prototype,"saveComplete",void 0),Pt([_()],e.prototype,"beforeCellFormat",void 0),Pt([_()],e.prototype,"queryCellInfo",void 0),Pt([_()],e.prototype,"beforeCellUpdate",void 0),Pt([S(!0)],e.prototype,"allowFreezePane",void 0),e=t=Pt([Ot],e),e}(Pi),Q6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bu=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};(function(s){Q6(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Bu([ii([],U6)],e.prototype,"cells",void 0),Bu([S(0)],e.prototype,"index",void 0),Bu([S(20)],e.prototype,"height",void 0),Bu([S(!1)],e.prototype,"customHeight",void 0),Bu([S(!1)],e.prototype,"hidden",void 0),Bu([Ee({},CI)],e.prototype,"format",void 0),e})(ke);function sh(s,e){return s.rows[e]}function Ts(s,e,t){s.rows[e]||(s.rows[e]={}),Object.keys(t).forEach(function(i){s.rows[e][""+i]=t[""+i]})}function ct(s,e){return s.rows[e]&&s.rows[e].hidden}function Aa(s,e){return s.rows[e]&&s.rows[e].isFiltered}function Wt(s,e,t,i){var r;if(s&&s.rows&&s.rows[e]){if(!i&&s.rows[e].hidden)return 0;r=s.rows[e].height===void 0?20:s.rows[e].height}else r=20;if(t&&window.devicePixelRatio%1>0){var n=r*window.devicePixelRatio%1;return r+(n?(n>.5?1-n:-1*n)/window.devicePixelRatio:0)}else return r}function Id(s,e,t){s&&s.rows&&(s.rows[e]||(s.rows[e]={}),s.rows[e].height=t)}function Ei(s,e,t,i,r){t===void 0&&(t=e);var n=0,a;e>t&&(a=e,e=t,t=a);for(var o=e;o<=t;o++)n+=Wt(s,o,i,r);return n}var G6=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),mh=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};(function(s){G6(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return mh([S(0)],e.prototype,"index",void 0),mh([S(64)],e.prototype,"width",void 0),mh([S(!1)],e.prototype,"customWidth",void 0),mh([S(!1)],e.prototype,"hidden",void 0),mh([Ee({},CI)],e.prototype,"format",void 0),mh([S(!0)],e.prototype,"isLocked",void 0),mh([S("")],e.prototype,"validation",void 0),e})(ke);function oi(s,e){return s.columns?s.columns[e]||(s.columns[e]={}):(s.columns=[],s.columns[e]={}),s.columns[e]}function Td(s,e,t){var i=oi(s,e);Object.keys(t).forEach(function(r){i[""+r]=t[""+r]})}function tr(s,e,t,i){var r;if(s&&s.columns&&s.columns[e]){if(!t&&s.columns[e].hidden)return 0;r=s.columns[e].width||s.columns[e].customWidth?s.columns[e].width:64}else r=64;if(i&&window.devicePixelRatio%1>0){var n=r*window.devicePixelRatio%1;return r+(n?(n>.5?1-n:-1*n)/window.devicePixelRatio:0)}else return r}function ci(s,e,t,i){t===void 0&&(t=e);var r=0;if(e>t){var n=e;e=t,t=n}for(var a=e;a<=t;a++)r+=tr(s,a,null,i);return r}function Yt(s,e){return s.columns[e]&&s.columns[e].hidden}function az(s,e,t){return!!(s&&s.validation&&(!s.validation.address||s.validation.address&&ez(s.validation.address,e,t)))}function $6(s){var e=[];return X6(s,e),XP(s,e),e}function X6(s,e){e.push({member:"basic",args:[]}),e.push({member:"all",args:[]}),s.showRibbon&&e.push({member:"ribbon",args:[s]}),s.showFormulaBar&&e.push({member:"formulaBar",args:[s]}),s.showSheetTabs&&e.push({member:"sheetTabs",args:[s]}),s.allowEditing&&(e.push({member:"edit",args:[s]}),e.push({member:"formula",args:[s]})),s.allowOpen&&e.push({member:"open",args:[s]}),s.allowSave&&e.push({member:"save",args:[s]}),s.enableContextMenu&&e.push({member:"contextMenu",args:[s]}),s.allowAutoFill&&e.push({member:"autofill",args:[s]}),s.selectionSettings.mode!=="None"&&e.push({member:"selection",args:[s]}),s.enableKeyboardNavigation&&e.push({member:"keyboardNavigation",args:[s]}),s.allowNumberFormatting&&e.push({member:"numberFormat",args:[s]}),s.enableKeyboardShortcut&&e.push({member:"keyboardShortcut",args:[s]}),s.enableClipboard&&e.push({member:"clipboard",args:[s]}),s.allowCellFormatting&&e.push({member:"cellformat",args:[s]}),s.allowSorting&&e.push({member:"sort",args:[s]}),s.allowResizing&&e.push({member:"resize",args:[s]}),e.push({member:"collaborativeEditing",args:[s]}),e.push({member:"protectSheet",args:[s]}),e.push({member:"workbookFormula",args:[s]}),e.push({member:"workbookEdit",args:[s]}),s.allowHyperlink&&e.push({member:"spreadsheetHyperlink",args:[s]}),s.allowUndoRedo&&e.push({member:"undoredo",args:[s]}),s.allowFiltering&&e.push({member:"filter",args:[s]}),s.allowWrap&&e.push({member:"wrapText",args:[s]}),s.allowInsert&&e.push({member:"insert",args:[s]}),s.allowDelete&&e.push({member:"delete",args:[s]}),s.allowDataValidation&&e.push({member:"dataValidation",args:[s]}),s.allowFindAndReplace&&e.push({member:"findAndReplace",args:[s]}),s.allowMerge&&e.push({member:"merge",args:[s]}),s.allowConditionalFormat&&e.push({member:"conditionalFormatting",args:[s]}),s.allowImage&&e.push({member:"spreadsheetImage",args:[s]}),s.allowChart&&e.push({member:"spreadsheetChart",args:[s]})}var QA="e-wraptext",de="spreadsheetLocale",At="dialog",K6="actionEvents",II="shape",Z6={Custom:["#ffffff","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},J6={Custom:["#ffffff","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},Cs={UP:38,DOWN:40,LEFT:37,RIGHT:39,FIRSTALPHABET:65,LASTALPHABET:90,SPACE:32,BACKSPACE:8,TAB:9,DELETE:46,ENTER:13,ESC:27},e7={FindValue:"Find value",ReplaceValue:"Replace value",FindReplaceTooltip:"Find & Replace",InsertingEmptyValue:"Reference value is not valid.",ReplaceAllEnd:" matches replaced with ",ByRow:"By Rows",ByColumn:"By Columns",MatchCase:"Match case",MatchExactCellElements:"Match entire cell contents",EnterCellAddress:"Enter cell address",FindAndReplace:"Find and Replace",FindNextBtn:"Find Next",FindPreviousBtn:"Find Previous",ReplaceBtn:"Replace",ReplaceAllBtn:"Replace All",GotoHeader:"Go To",Sheet:"Sheet",Workbook:"Workbook",NoElements:"We couldn't find what you were looking for.",FindWhat:"Find what",ReplaceWith:"Replace with",Cut:"Cut",Copy:"Copy",Paste:"Paste",PasteSpecial:"Paste Special",Link:"Link",Spreadsheet:"Spreadsheet",Hyperlink:"Hyperlink",EditHyperlink:"Edit Hyperlink",OpenHyperlink:"Open Hyperlink",RemoveHyperlink:"Remove Hyperlink",InvalidHyperlinkAlert:"The address of this site is not valid. Check the address and try again.",InsertLink:"Insert Link",EditLink:"Edit Link",All:"All",Values:"Values",Formats:"Formats",Bold:"Bold",Font:"Font",FontSize:"Font Size",Italic:"Italic",Underline:"Underline",Strikethrough:"Strikethrough",TextColor:"Text Color",FillColor:"Fill Color",HorizontalAlignment:"Horizontal Alignment",AlignLeft:"Align Left",AlignCenter:"Center",AlignRight:"Align Right",VerticalAlignment:"Vertical Alignment",AlignTop:"Align Top",AlignMiddle:"Align Middle",AlignBottom:"Align Bottom",WrapText:"Wrap Text",MergeCells:"Merge Cells",MergeAll:"Merge All",MergeHorizontally:"Merge Horizontally",MergeVertically:"Merge Vertically",Unmerge:"Unmerge",UnmergeCells:"Unmerge Cells",SelectMergeType:"Select Merge Type",MergeCellsAlert:"Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?",Borders:"Borders",TopBorders:"Top Borders",LeftBorders:"Left Borders",RightBorders:"Right Borders",BottomBorders:"Bottom Borders",AllBorders:"All Borders",HorizontalBorders:"Horizontal Borders",VerticalBorders:"Vertical Borders",OutsideBorders:"Outside Borders",InsideBorders:"Inside Borders",NoBorders:"No Borders",BorderColor:"Border Color",BorderStyle:"Border Style",InsertFunction:"Insert Function",Insert:"Insert",Delete:"Delete",DuplicateSheet:"Duplicate",MoveRight:"Move Right",MoveLeft:"Move Left",Rename:"Rename",Hide:"Hide",FileName:"File Name",PROPER:"Converts a text to proper case; first letter to uppercase and other letters to lowercase.",NameBox:"Name Box",ShowHeaders:"Show Headers",HideHeaders:"Hide Headers",ShowGridLines:"Show Gridlines",ExtendValidation:"The selection contains some cells without data validation. Do you want to extend validation to these cells?",Yes:"Yes",No:"No",HideGridLines:"Hide Gridlines",FreezePanes:"Freeze Panes",FreezeRows:"Freeze Rows",FreezeColumns:"Freeze Columns",UnfreezePanes:"Unfreeze Panes",UnfreezeRows:"Unfreeze Rows",UnfreezeColumns:"Unfreeze Columns",AddSheet:"Add Sheet",ListAllSheets:"List All Sheets",CollapseToolbar:"Collapse Toolbar",ExpandToolbar:"Expand Toolbar",CollapseFormulaBar:"Collapse Formula Bar",ExpandFormulaBar:"Expand Formula Bar",File:"File",Home:"Home",Formulas:"Formulas",View:"View",New:"New",Open:"Open",SaveAs:"Save As",Update:"Update",ExcelXlsx:"Microsoft Excel",ExcelXls:"Microsoft Excel 97-2003",CSV:"Comma-separated values",FormulaBar:"Formula Bar",Sort:"Sort",SortAscending:"Ascending",SortDescending:"Descending",CustomSort:"Custom Sort",AddColumn:"Add Column",ContainsHeader:"Data contains header",CaseSensitive:"Case sensitive",SortBy:"Sort by",ThenBy:"Then by",SelectAColumn:"Select a column",SortEmptyFieldError:"All sort criteria must have a column specified. Check the selected sort criteria and try again.",SortDuplicateFieldError:"  is being sorted by values more than once. Delete the duplicate sort criteria and try again.",SortOutOfRangeError:"Select a cell or range inside the used range and try again.",MultiRangeSortError:"This can't be done on a multiple range selection. Select a single range and try again.",SortAndFilter:"Sort & Filter",Filter:"Filter",ClearAllFilter:"Clear",ClearFilterFrom:"Clear Filter From ",ReapplyFilter:"Reapply",FilterCellValue:"Filter by Value of Selected Cell",FilterOutOfRangeError:"Select a cell or range inside the used range and try again.",HideRow:"Hide Row",HideRows:"Hide Rows",UnhideRows:"Unhide Rows",HideColumn:"Hide Column",HideColumns:"Hide Columns",UnhideColumns:"Unhide Columns",InsertRow:"Insert Row",InsertRows:"Insert Rows",Above:"Above",Below:"Below",InsertColumn:"Insert Column",InsertColumns:"Insert Columns",Before:"Before",After:"After",DeleteRow:"Delete Row",DeleteRows:"Delete Rows",DeleteColumn:"Delete Column",DeleteColumns:"Delete Columns",Ok:"OK",Close:"Close",MoreOptions:"More Options",Cancel:"Cancel",Apply:"Apply",MoreColors:"More Colors",StandardColors:"Standard Colors",General:"General",Number:"Number",Currency:"Currency",Accounting:"Accounting",ShortDate:"Short Date",LongDate:"Long Date",Time:"Time",Percentage:"Percentage",Fraction:"Fraction",Scientific:"Scientific",Text:"Text",Custom:"Custom",MobileFormulaBarPlaceHolder:"Enter value or Formula",NumberFormat:"Number Format",PasteAlert:"You can't paste this here, because the copy area and paste area aren't in the same size. Please try pasting in a different range.",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",SheetRenameInvalidAlert:"Sheet name contains invalid character.",SheetRenameEmptyAlert:"Sheet name cannot be empty.",SheetRenameAlreadyExistsAlert:"Sheet name already exists. Please enter another name.",DeleteSheetAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",DeleteSingleLastSheetAlert:"A Workbook must contain at least one visible worksheet.",PickACategory:"Pick a category",Description:"Description",UnsupportedFile:"Unsupported File",DataLimitExceeded:"File data is too large and it takes more time to process, do you want to continue?",FileSizeLimitExceeded:"File size is too large and it takes more time to process, do you want to continue?",InvalidUrl:"Invalid URL",SUM:"Adds a series of numbers and/or cells.",SUMIF:"Adds the cells based on specified condition.",SUMIFS:"Adds the cells based on specified conditions.",ABS:"Returns the value of a number without its sign.",RAND:"Returns a random number between 0 and 1.",RANDBETWEEN:"Returns a random integer based on specified values.",FLOOR:"Rounds a number down to the nearest multiple of a given factor.",CEILING:"Rounds a number up to the nearest multiple of a given factor.",PRODUCT:"Multiplies a series of numbers and/or cells.",INT:"Returns a number to the nearest integer.",ROUNDUP:"Rounds a number away from zero.",SUMPRODUCT:"Returns sum of the product of given ranges of arrays.",SORT:"Sorts a range of an array",T:"Checks whether a value is text or not and returns the text.",EXACT:"Checks whether a two text strings are exactly same and returns TRUE or FALSE.",LEN:"Returns a number of characters in a given string.",MOD:"Returns a remainder after a number is divided by divisor.",ODD:"Rounds a positive number up and negative number down to the nearest odd integer.",PI:"Returns the value of pi.",COUNTBLANK:"Returns the number of empty cells in a specified range of cells.",EVEN:"Rounds a positive number up and negative number down to the nearest even integer.",DECIMAL:"Converts a text representation of a number in a given base into a decimal number.",DEGREES:"Converts radians to degrees.",ADDRESS:"Returns a cell reference as text, given specified row and column numbers.",TIME:"Converts hours, minutes, seconds to the time formatted text.",CHAR:"Returns the character from the specified number.",CODE:"Returns the numeric code for the first character in a given string.",DOLLAR:"Converts the number to currency formatted text.",SMALL:"Returns the k-th smallest value in a given array.",LARGE:"Returns the k-th largest value in a given array.",FACT:"Returns the factorial of a number.",MEDIAN:"Returns the median of the given set of numbers.",EDATE:"Returns a date with given number of months before or after the specified date.",DATEVALUE:"Converts a date string into date value.",HOUR:"Returns the number of hours in a specified time string.",SECOND:"Returns the number of seconds in a specified time string.",MINUTE:"Returns the number of minutes in a specified time string.",NOW:"Returns the current date and time.",MONTH:"Returns the number of months in a specified date string.",TODAY:"Returns the current date as date value.",WEEKDAY:"Returns the day of the week corresponding to a date.",AVERAGE:"Calculates average for the series of numbers and/or cells excluding text.",AVERAGEIF:"Calculates average for the cells based on specified criterion.",AVERAGEIFS:"Calculates average for the cells based on specified conditions.",AVERAGEA:"Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.",COUNT:"Counts the cells that contain numeric values in a range.",COUNTIF:"Counts the cells based on specified condition.",COUNTIFS:"Counts the cells based on specified conditions.",COUNTA:"Counts the cells that contains values in a range.",MIN:"Returns the smallest number of the given arguments.",MAX:"Returns the largest number of the given arguments.",DATE:"Returns the date based on given year, month, and day.",DAY:"Returns the day from the given date.",DAYS:"Returns the number of days between two dates.",IF:"Returns value based on the given expression.",IFS:"Returns value based on the given multiple expressions.",CalculateAND:"Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.",CalculateOR:"Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.",IFERROR:"Returns value if no error found else it will return specified value.",CHOOSE:"Returns a value from list of values, based on index number.",INDEX:"Returns a value of the cell in a given range based on row and column number.",FIND:"Returns the position of a string within another string, which is case sensitive.",TEXT:"Converts a value to text in specified number format.",CONCATENATE:"Combines two or more strings together.",CONCAT:"Concatenates a list or a range of text strings.",SUBTOTAL:"Returns subtotal for a range using the given function number.",RADIANS:"Converts degrees into radians.",MATCH:"Returns the relative position of a specified value in given range.",LN:"Returns the natural logarithm of a number.",INTERCEPT:"Calculates the point of the Y-intercept line via linear regression.",UNIQUE:"Returns a unique values from a range or array",SLOPE:"Returns the slope of the line from linear regression of the data points.",LOOKUP:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range.",HLOOKUP:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify.",VLOOKUP:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row.",NOT:"Returns the inverse of a given logical expression.",EOMONTH:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date.",SQRT:"Returns the square root of a positive number.",ROUNDDOWN:"Rounds a number down, toward zero.",RSQ:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_y's and known_x's.",DefineNameExists:"This name already exists, try different name.",DefineNameInValid:"The name that you entered is not valid.",CircularReference:"When a formula refers to one or more circular references, this may result in an incorrect calculation.",OR:"OR",AND:"AND",CustomFilterDatePlaceHolder:"Choose a date",CustomFilterPlaceHolder:"Enter the value",CustomFilter:"Custom Filter",Between:"Between",DateTimeFilter:"DateTime Filters",Undo:"Undo",Redo:"Redo",DateFilter:"Date Filters",TextFilter:"Text Filters",NumberFilter:"Number Filters",ClearFilter:"Clear Filter",NoResult:"No Matches Found",FilterFalse:"False",FilterTrue:"True",Blanks:"Blanks",SelectAll:"Select All",GreaterThanOrEqual:"Greater Than Or Equal",GreaterThan:"Greater Than",LessThanOrEqual:"Less Than Or Equal",LessThan:"Less Than",NotEqual:"Not Equal",Equal:"Equal",Contains:"Contains",NotContains:"Does Not Contains",EndsWith:"Ends With",NotEndsWith:"Does Not End With",StartsWith:"Starts With",NotStartsWith:"Does Not Start With",IsEmpty:"Empty",IsNotEmpty:"Not Empty",ClearButton:"Clear",FilterButton:"Filter",CancelButton:"Cancel",OKButton:"OK",Search:"Search",ProtectSheet:"Protect Sheet",UnprotectSheet:"Unprotect Sheet",SelectCells:"Select locked cells",SelectUnlockedCells:"Select unlocked cells",FormatCells:"Format cells",FormatRows:"Format rows",FormatColumns:"Format columns",InsertLinks:"Insert links",ProtectContent:"Protect the contents of locked cells",ProtectAllowUser:" Allow all users of this worksheet to:",EditAlert:"The cell you're trying to change is protected. To make change, unprotect the sheet.",SearchWithin:"Search within",SearchBy:"Search by",Reference:"Reference",DataValidation:"Data Validation",CellRange:"Cell Range",Allow:"Allow",Data:"Data",Minimum:"Minimum",Maximum:"Maximum",IgnoreBlank:"Ignore blank",WholeNumber:"Whole Number",Decimal:"Decimal",Date:"Date",TextLength:"Text Length",List:"List",NotBetween:"Not Between",EqualTo:"Equal To",NotEqualTo:"Not Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThanOrEqualTo:"Less Than Or Equal To",InCellDropDown:"In-cell-dropdown",Sources:"Sources",Value:"Value",Retry:"Retry",DialogError:"The list source must be a reference to single row or column.",MinMaxError:"The Maximum must be greater than or equal to the Minimum.",MoreValidation:`This selection contains more than one validation. 
 Erase current settings and continue?`,FileNameError:`A file name can't contain characters like \\ / : * ? " < > [ ] |`,ListLengthError:"The list values allows only upto 256 characters",ValidationError:"This value doesn't match the data validation restrictions defined for the cell.",EmptyError:"You must enter a value",ClearHighlight:"Clear Highlight",HighlightInvalidData:"Highlight Invalid Data",ClearValidation:"Clear Validation",HighlightCellsRules:"Highlight Cells Rules",CFEqualTo:"Equal To",TextThatContains:"Text that Contains",Save:"Save",EmptyFileName:"File name cannot be empty.",LargeName:"The name is too long.",ADateOccuring:"A Date Occuring",DuplicateValues:"Duplicate Values",TopBottomRules:"Top/Bottom Rules",Directional:"Directional",Shapes:"Shapes",Indicators:"Indicators",Ratings:"Ratings",Top10Items:"Top 10 Items",Top10:"Top 10",Bottom10Items:"Bottom 10 Items",Bottom10:"Bottom 10",AboveAverage:"Above Average",BelowAverage:"Below Average",FormatCellsGreaterThan:"Format cells that are GREATER THAN:",FormatCellsLessThan:"Format cells that are LESS THAN:",FormatCellsBetween:"Format cells that are BETWEEN:",FormatCellsEqualTo:"Format cells that are EQUAL TO:",FormatCellsThatContainTheText:"Format cells that contain the text:",FormatCellsThatContainADateOccurring:"Format cells that contain a date occurring:",FormatCellsDuplicate:"Format cells that contain:",FormatCellsTop:"Format cells that rank in the TOP:",FormatCellsBottom:"Format cells that rank in the BOTTOM:",FormatCellsAbove:"Format cells that are ABOVE AVERAGE:",FormatCellsBelow:"Format cells that are BELOW AVERAGE:",With:"with",DataBars:"Data Bars",ColorScales:"Color Scales",IconSets:"Icon Sets",ClearRules:"Clear Rules",SelectedCells:"Clear Rules from Selected Cells",EntireSheet:"Clear Rules from Entire Sheet",ISNUMBER:"Returns true when the value parses as a numeric value.",ROUND:"Rounds a number to a specified number of digits.",GEOMEAN:"Returns the geometric mean of an array or range of positive data.",POWER:"Returns the result of a number raised to power",LOG:"Returns the logarithm of a number to the base that you specify.",TRUNC:"Returns the truncated value of a number to a specified number of decimal places.",EXP:"Returns e raised to the power of the given number.",Clear:"Clear",ClearContents:"Clear Contents",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearHyperlinks:"Clear Hyperlinks",LightRedFillWithDarkRedText:"Light Red Fill with Dark Red Text",YellowFillWithDarkYellowText:"Yellow Fill with Dark Yellow Text",GreenFillWithDarkGreenText:"Green Fill with Dark Green Text",RedFill:"Red Fill",RedText:"Red Text",Duplicate:"Duplicate",Unique:"Unique",And:"and",WebPage:"Web Page",ThisDocument:"This Document",DisplayText:"Display Text",Url:"URL",CellReference:"Cell Reference",DefinedNames:"Defined Names",EnterTheTextToDisplay:"Enter the text to display",EnterTheUrl:"Enter the URL",Image:"Image",ConditionalFormatting:"Conditional Formatting",BlueDataBar:"Blue Data Bar",GreenDataBar:"Green Data Bar",RedDataBar:"Red Data Bar",OrangeDataBar:"Orange Data Bar",LightBlueDataBar:"Light blue Data Bar",PurpleDataBar:"Purple Data Bar",GYRColorScale:"Green - Yellow - Red Color Scale",RYGColorScale:"Red - Yellow - Green Color Scale",GWRColorScale:"Green - White - Red Color Scale",RWGColorScale:"Red - White - Green Color Scale",BWRColorScale:"Blue - White - Red Color Scale",RWBColorScale:"Red - White - Blue Color Scale",WRColorScale:"White - Red Color Scale",RWColorScale:"Red - White Color Scale",GWColorScale:"Green - White Color Scale",WGColorScale:"White - Green Color Scale",GYColorScale:"Green - Yellow Color Scale",YGColorScale:"Yellow - Green Color Scale",ThreeArrowsColor:"3 Arrows (Colored)",ThreeArrowsGray:"3 Arrows (Gray)",ThreeTriangles:"3 Triangles",FourArrowsColor:"4 Arrows (Gray)",FourArrowsGray:"4 Arrows (Colored)",FiveArrowsColor:"5 Arrows (Gray)",FiveArrowsGray:"5 Arrows (Colored)",ThreeTrafficLights1:"3 Traffic Lights (Unrimmed)",ThreeTrafficLights2:"3 Traffic Lights (Rimmed)",ThreeSigns:"3 Signs",FourTrafficLights:"4 Traffic Lights",RedToBlack:"Red To Black",ThreeSymbols1:"3 Symbols (Circled)",ThreeSymbols2:"3 Symbols (Uncircled)",ThreeFlags:"3 Flags",ThreeStars:"3 Stars",FourRatings:"4 Ratings",FiveQuarters:"5 Quarters",FiveRatings:"5 Ratings",FiveBoxes:"5 Boxes",Chart:"Chart",Column:"Column",Bar:"Bar",Area:"Area",Pie:"Pie",Doughnut:"Doughnut",PieAndDoughnut:"Pie/Doughnut",Line:"Line",LineMarker:"Line with Markers",Radar:"Radar",Scatter:"Scatter",ChartDesign:"Chart Design",ClusteredColumn:"Clustered Column",StackedColumn:"Stacked Column",StackedColumn100:"100% Stacked Column",ClusteredBar:"Clustered Bar",StackedBar:"Stacked Bar",StackedBar100:"100% Stacked Bar",StackedArea:"Stacked Area",StackedArea100:"100% Stacked Area",StackedLine:"Stacked Line",StackedLineMarker:"Stacked Line with Markers",StackedLine100:"100% Stacked Line",StackedLine100Marker:"100% Stacked Line with Markers",AddChartElement:"Add Chart Element",Axes:"Axes",AxisTitle:"Axis Title",ChartTitle:"Chart Title",DataLabels:"Data Labels",Gridlines:"Gridlines",Legends:"Legends",PrimaryHorizontal:"Primary Horizontal",PrimaryVertical:"Primary Vertical",None:"None",AboveChart:"Above Chart",Center:"Center",InsideEnd:"Inside End",InsideBase:"Inside Base",OutsideEnd:"OutSide End",PrimaryMajorHorizontal:"Primary Major Horizontal",PrimaryMajorVertical:"Primary Major Vertical",PrimaryMinorHorizontal:"Primary Minor Horizontal",PrimaryMinorVertical:"Primary Minor Vertical",Right:"Right",Left:"Left",Bottom:"Bottom",Top:"Top",SwitchRowColumn:"Switch Row/Column",ChartTheme:"Chart Theme",ChartType:"Chart Type",Material:"Material",Fabric:"Fabric",Bootstrap:"Bootstrap",HighContrastLight:"HighContrast Light",MaterialDark:"Material Dark",FabricDark:"Fabric Dark",HighContrast:"HighContrast",BootstrapDark:"Bootstrap Dark",Bootstrap4:"Bootstrap4",Bootstrap5Dark:"Bootstrap5 Dark",Bootstrap5:"Bootstrap5",Tailwind:"Tailwind",TailwindDark:"Tailwind Dark",VerticalAxisTitle:"Vertical Axis Title",HorizontalAxisTitle:"Horizontal Axis Title",EnterTitle:"Enter Title",ProtectWorkbook:"Protect Workbook",Password:"Password (optional):",EnterThePassword:"Enter the password",ConfirmPassword:"Confirm Password",EnterTheConfirmPassword:"Re-enter your password",PasswordAlert:"Confirmation password is not identical",UnprotectWorkbook:"Unprotect Workbook",UnprotectPasswordAlert:"The password you supplied is not correct.",IncorrectPassword:"Unable to open the file or worksheet with the given password",PasswordAlertMsg:"Please enter the password",ConfirmPasswordAlertMsg:"Please enter the confirm password",IsProtected:"is protected",PDF:"PDF Document",AutoFillMergeAlertMsg:"To do this, all the merged cells need to be the same size.",FillSeries:"Fill Series",CopyCells:"Copy Cells",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",CustomFormat:"Custom Number Formats",CustomFormatPlaceholder:"Type or Select a custom format",CustomFormatTypeList:"Type",UnprotectWorksheet:"Unprotect Sheet",ReEnterPassword:"Re-enter password to proceed",SheetPassword:"Password to unprotect sheet:",Fluent:"Fluent",FluentDark:"Fluent Dark",Material3:"Material 3",Material3Dark:"Material 3 Dark",CellReferenceTypoError:"We found a typo in your cell reference. Do you want to correct this reference as follows?",InvalidFormulaError:"We found that you typed a formula which is invalid.",InvalidArguments:"We found that you typed a formula with an invalid arguments.",EmptyExpression:"We found that you typed a formula with an empty expression.",MismatchedParenthesis:"We found that you typed a formula with one or more missing opening or closing parenthesis.",ImproperFormula:"We found that you typed a formula which is improper.",WrongNumberOfArguments:"We found that you typed a formula with a wrong number of arguments.",Requires3Arguments:"We found that you typed a formula which requires 3 arguments.",MismatchedStringQuotes:"We found that you typed a formula with a mismatched quotes.",FormulaCircularRef:"We found that you typed a formula with a circular reference.",AddCurrentSelection:"Add current selection to filter",ExternalWorkbook:"An imported excel file contains an external workbook reference. Do you want to import that file?"};function Vi(s){requestAnimationFrame(function(){s()})}function b0(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function GA(s){var e=30;return s.toString().length>3&&(e=s.toString().length*10),e}var UC=null,t7=1.24;function oz(){if(UC!==null)return UC;var s=document.createElement("div"),e=0;return s.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(s),e=s.offsetWidth-s.clientWidth|0,document.body.removeChild(s),UC=e}var i7=["e-ribbon","e-formula-bar-panel","e-sheet-tab-panel","e-header-toolbar"];function lz(s,e){e===void 0&&(e=i7);var t=$A(s,"previous",e),i=$A(s,"next",e);return t+i}function $A(s,e,t){for(var i=s[e+"ElementSibling"],r=0;i;)t.some(function(n){return i.classList.contains(n)})&&(r+=i.offsetHeight),i=i[e+"ElementSibling"];return r}function hz(s,e,t){if(s.scrollSettings.enableVirtualization){var i=s.getActiveSheet(),r=s.frozenRowCount(i),n=s.frozenColCount(i),a=s.viewport.topIndex+r,o=s.viewport.leftIndex+n,l=s.viewport.bottomIndex,h=s.viewport.rightIndex;if(i.frozenRows||i.frozenColumns){if(s.insideViewport(e[0],e[1])||s.insideViewport(e[2],e[3]))return!0}else if(a<=e[0]&&l>=e[2]&&o<=e[1]&&h>=e[3])return!0;var u=!1;if(t){if(e[0]<a&&e[2]<a||e[0]>l&&e[2]>l||(e[0]<a&&e[2]>a&&e[0]>=r&&(e[0]=a,u=!0),e[2]>l&&(e[2]=l,u=!0),e[1]<o&&e[3]<o||e[1]>h&&e[3]>h))return!1;e[1]<o&&e[3]>o&&e[1]>=n&&(e[1]=o,u=!0),e[3]>h&&(e[3]=h,u=!0)}return u}else return!0}function Cb(s,e,t,i,r,n,a,o){var l,h={left:{idx:0,size:0},top:{idx:0,size:0}},u=h.top.size,c=h.left.size;for(l=h.top.idx;l<e[0];l++)t&&t-1<e[0]&&l<t||(u+=Wt(s,l,!o));for(l=h.left.idx;l<e[1];l++)i&&i-1<e[1]&&l<i||(c+=tr(s,l,null,!o));return t&&e[0]<t&&(s.showHeaders&&(u+=30),r&&(u-=r)),i&&e[1]<i&&(s.showHeaders&&(c+=a||30),n&&(c-=n)),{top:u,left:c}}function ws(s,e,t,i,r,n,a){i===void 0&&(i="e-selection");var o=s.getActiveSheet();if(o.frozenRows||o.frozenColumns){var l,h=s.frozenRowCount(o),u=s.frozenColCount(o);if(i==="e-active-cell"){if(t[0]<h||t[1]<u){e.style.display="none",l=t[0]<h&&t[1]<u?s.getSelectAllContent():t[0]<h?s.getColumnHeaderContent():s.getRowHeaderContent();var c=l.querySelector("."+i);c||(c=e.cloneNode(!0),l.appendChild(c)),e=c,fs(s,e,t,o,s.enableRtl,h,u,r,!0,s.viewport.beforeFreezeHeight,s.viewport.beforeFreezeWidth,s.sheetModule.colGroupWidth)}else fs(s,e,t,o,s.enableRtl,h,u,r);e.style.display&&(e.style.display=""),Ti(s.getSelectAllContent(),l,"e-active-cell"),Ti(s.getColumnHeaderContent(),l,"e-active-cell"),Ti(s.getRowHeaderContent(),l,"e-active-cell")}else if(i==="e-autofill"){var d=void 0,p=s.frozenRowCount(o),f=s.frozenColCount(o);if(t[0]<p||t[1]<f){e.style.display="none",d=t[0]<p&&t[1]<f?s.getSelectAllContent():t[0]<p?s.getColumnHeaderContent():s.getRowHeaderContent();var c=d.querySelector("."+i);c||(c=e.cloneNode(!0),d.appendChild(c)),e=c,fs(s,e,t,o,s.enableRtl,p,f,r,!0,s.viewport.beforeFreezeHeight,s.viewport.beforeFreezeWidth,s.sheetModule.colGroupWidth,"e-autofill")}else fs(s,e,t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-autofill");e.style.display&&(e.style.display=""),Ti(s.getSelectAllContent(),d,"e-autofill"),Ti(s.getColumnHeaderContent(),d,"e-autofill"),Ti(s.getRowHeaderContent(),d,"e-autofill")}else if(i==="e-filloption"){var d=void 0,p=s.frozenRowCount(o),f=s.frozenColCount(o);if(t[0]<p||t[1]<f)if(t[3]+1===f&&t[2]+1>p)fs(s,s.getMainContent().querySelector(".e-filloption"),t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4});else if(t[2]+1===p&&t[3]+1>f)fs(s,s.getMainContent().querySelector(".e-filloption"),t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4});else if(t[3]+1===f&&t[2]+1<p){d=s.getColumnHeaderContent();var v=d.querySelector("."+i);v||s.notify(By,{id:s.element.id+"_autofilloptionbtn",appendElem:d}),e=s.autofillModule.autoFillDropDown.element,fs(s,e,t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4})}else if(t[2]+1===p&&t[3]+1===f)fs(s,s.getMainContent().querySelector(".e-filloption"),t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4,left:-4});else{d=t[0]<p&&t[1]<f?s.getSelectAllContent():t[0]<p?s.getColumnHeaderContent():s.getRowHeaderContent();var c=d.querySelector("."+i);c||s.notify(By,{id:s.element.id+"_autofilloptionbtn",appendElem:d}),e=s.autofillModule.autoFillDropDown.element,fs(s,e,t,o,s.enableRtl,p,f,r,!0,s.viewport.beforeFreezeHeight,s.viewport.beforeFreezeWidth,s.sheetModule.colGroupWidth,"e-filloption",!0)}else fs(s,s.getMainContent().querySelector(".e-filloption"),t,o,s.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0);e.style.display&&(e.style.display=""),Ti(s.getSelectAllContent(),d,"e-filloption"),Ti(s.getColumnHeaderContent(),d,"e-filloption"),Ti(s.getRowHeaderContent(),d,"e-filloption")}else{var g=lt(t);if(g[0]<h||g[1]<u){e&&!e.classList.contains("e-multi-range")&&e.classList.add("e-hide");var b=[];g[0]<h&&g[1]<u?g[2]<h&&g[3]<u?(b.push(t),n||(Ti(s.getColumnHeaderContent(),l,i,!0),Ti(s.getRowHeaderContent(),l,i,!0))):g[2]>h-1?g[3]<u?(n||Ti(s.getColumnHeaderContent(),l,i,!0),b.push([g[0],g[1],h-1,g[3]]),b.push([h,g[1],g[2],g[3]])):(b.push([g[0],g[1],h-1,u-1]),b.push([h,g[1],g[2],u-1]),b.push([g[0],u,h-1,g[3]]),b.push([h,u,g[2],g[3]])):g[2]<h?(b.push([g[0],g[1],g[2],u-1]),b.push([g[0],u,g[2],g[3]]),n||Ti(s.getRowHeaderContent(),l,i,!0)):(b.push([h,g[1],g[2],u-1]),b.push([g[0],g[1],h-1,u-1]),b.push([h,u,g[2],g[3]]),b.push([g[0],u,h-1,g[3]])):g[0]<h?g[2]<h?(b.push(t),n||Ti(s.getRowHeaderContent(),l,i,!0)):(b.push([g[0],g[1],h-1,g[3]]),b.push([h,g[1],g[2],g[3]]),n||(Ti(s.getSelectAllContent(),l,i,!0),Ti(s.getRowHeaderContent(),l,i,!0))):g[3]<u?(b.push(t),n||Ti(s.getSelectAllContent(),l,i,!0)):(b.push([g[0],g[1],g[2],u-1]),b.push([g[0],u,g[2],g[3]]),n||(Ti(s.getSelectAllContent(),l,i,!0),Ti(s.getColumnHeaderContent(),l,i,!0)));var y;b.forEach(function(x){l=x[2]<h&&x[3]<u?s.getSelectAllContent():x[2]<h?s.getColumnHeaderContent():x[3]<u?s.getRowHeaderContent():s.getMainContent();var w;i==="e-copy-indicator"||i==="e-range-indicator"?(w=e.cloneNode(!0),l.appendChild(w),h&&(x[2]+1===h&&b.forEach(function(M){M!==x&&(y=w.getElementsByClassName("e-bottom")[0],y&&M[0]===h&&ne(y))}),x[0]===h&&l.parentElement.classList.contains("e-main-panel")&&b.forEach(function(M){M!==x&&(y=w.getElementsByClassName("e-top")[0],y&&M[2]+1===h&&ne(y))})),u&&(x[3]+1===u&&b.forEach(function(M){M!==x&&(y=w.getElementsByClassName("e-right")[0],y&&M[1]===u&&ne(y))}),x[1]===u&&(l.classList.contains("e-sheet-content")||l.classList.contains("e-column-header"))&&b.forEach(function(M){M!==x&&(y=w.getElementsByClassName("e-left")[0],y&&M[3]+1===u&&ne(y))}))):(w=l.querySelector("."+i),w||(w=e.cloneNode(!0),n&&!w.classList.contains("e-multi-range")&&w.classList.add("e-multi-range"),l.appendChild(w)),a&&w.classList.remove(i)),fs(s,w,x,o,s.enableRtl,h,u,r,!1,s.viewport.beforeFreezeHeight,s.viewport.beforeFreezeWidth,s.sheetModule.colGroupWidth),w.classList.contains("e-hide")&&w.classList.remove("e-hide")})}else n||(Ti(s.getSelectAllContent(),null,i,!0),Ti(s.getColumnHeaderContent(),null,i,!0),Ti(s.getRowHeaderContent(),null,i,!0)),fs(s,e,t,o,s.enableRtl,h,u,r),(i==="e-range-indicator"||!s.getMainContent().querySelector("."+i))&&s.getMainContent().appendChild(e),e.classList.contains("e-hide")&&e.classList.remove("e-hide"),a&&e.classList.remove(i)}}else{var C=fs(s,e,t,o,s.enableRtl,0,0,r);return e&&!s.getMainContent().querySelector("."+i)&&s.getMainContent().appendChild(e),C}}function Ti(s,e,t,i,r){if(i||s!==e)if(r)for(var n=s.querySelectorAll("."+t),a=0;a<n.length;)n[a].classList.remove(t),a++;else{var o=s.querySelector("."+t);o&&!o.classList.contains("e-multi-range")&&ne(o)}}function fs(s,e,t,i,r,n,a,o,l,h,u,c,d,p,f){var v=lt(t),g=Cb(i,v,n,a,h,u,c),b=[ae(i,0,!0),ae(i,0,!0,"columns")],y,C;s.scrollSettings.isFinite?(y=v[0]>=i.rowCount?0:Ei(i,v[0],v[2]<i.rowCount?v[2]:i.rowCount-1,!0),C=v[1]>=i.colCount?0:ci(i,v[1],v[3]<i.colCount?v[3]:i.colCount-1,!0)):(y=Ei(i,v[0],v[2],!0),C=ci(i,v[1],v[3],!0));var x=v[1]===0&&v[3]===i.colCount-1,w=v[0]===0&&v[2]===i.rowCount-1,M=0,E=-5,T=-5,D=0,N=6,A=6;if(m(d)){var L={top:(v[0]===b[0]?g.top:g.top-Mr(1))+"px",height:y&&y+(v[0]===b[0]?0:Mr(1))+"px",width:C&&C+(v[1]===b[1]?0:Mr(1))+(l&&a&&v[1]<a&&v[3]>=a?1:0)+"px"};if(L[r?"right":"left"]=(v[1]===b[1]?g.left:g.left-1)+"px",e){var k=_C([{element:e,attrs:L}],o);return k}}else{x&&(E=-5,T=-2,N=6,A=3),w&&(T=-5,E=0,N=1,A=6),w||(M+=y),x||(D+=C),M+=Math.round(g.top)+E,D+=Math.round(g.left)+T;var L={};p?(te([e],"e-hide"),M=f&&f.top?f.top:M,D=f&&f.left?f.left:D,L={top:M+N+"px"},L[r?"right":"left"]=D+A+"px",e&&_C([{element:e,attrs:L}],o)):(L={top:M+"px"},L[r?"right":"left"]=D+"px",e&&_C([{element:e,attrs:L}],o))}}function _C(s,e){var t=new Promise(function(i){var r=function(){s.forEach(function(n){tt(n.element,n.attrs),i()})};e?r():requestAnimationFrame(function(){return r()})});return t}function Dd(){return B.isPointer?"pointerdown":"mousedown touchstart"}function kl(){return B.isPointer?"pointermove":"mousemove touchmove"}function C0(){return B.isPointer?"pointerup":"mouseup touchend"}function Kd(s){return s.type==="touchstart"||s.type==="pointerdown"&&s.pointerType==="touch"}function S0(s){return s.type==="touchmove"||s.type==="pointermove"&&s.pointerType==="touch"}function WC(s){return s.type==="touchend"||s.type==="pointerup"&&s.pointerType==="touch"}function qC(s){return s&&(s.type==="mousedown"||s.type==="pointerdown")}function Zd(s){return s&&(s.type==="mousemove"||s.type==="pointermove")}function YC(s){return s&&(s.type==="mouseup"||s.type==="pointerup")}function Gh(s){return s===Cs.UP||s===Cs.DOWN||s===Cs.LEFT||s===Cs.RIGHT}function Ka(s){return s.changedTouches?s.changedTouches[0].clientX:s.clientX}function Za(s){return s.changedTouches?s.changedTouches[0].clientY:s.clientY}function r7(s){return s.changedTouches?s.changedTouches[0].pageX:s.pageX}function n7(s){return s.changedTouches?s.changedTouches[0].pageY:s.pageY}function Mr(s,e){if(window.devicePixelRatio%1>0){var t=s*window.devicePixelRatio%1;return s+(t?(t>.5||e?1-t:-1*t)/window.devicePixelRatio:0)}else return s}var s7={role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",busy:"aria-busy",colcount:"aria-colcount"};function ic(s,e){var t=Object.keys(e);t.forEach(function(i){s&&s.setAttribute(s7[""+i],e[""+i])})}function a7(s,e){if(s){var t=Ct(s,e);t&&t.destroy()}}function EM(s,e,t,i,r){var n,a,o,l,h,u,c,d,p,f=r.getActiveSheet(),v=r.frozenRowCount(f),g=r.frozenColCount(f);if(i){var b=s<g?r.getSelectAllContent():r.getColumnHeaderContent();n=b.getElementsByTagName("th")[e],a=b.getElementsByTagName("col")[e],o=(s<g?r.getRowHeaderContent():r.getMainContent()).getElementsByTagName("col")[e]}else{n=a=v||g?r.getRow(s,null,g-1):r.getRow(s,r.getRowHeaderTable()),a.style.height=parseInt(t,10)>0?Mr(parseInt(t,10))+"px":"2px",o=r.getRow(s,null,g),o.style.height=parseInt(t,10)>0?Mr(parseInt(t,10))+"px":"0px";var y=void 0;if(f.showHeaders){var C=r.getRowHeaderContent().getElementsByClassName("e-row"),x=[];x[0]=C[e].getElementsByTagName("td")[0].cloneNode(!0),y=XA(r.getRowHeaderTable(),x,!1,r)+1}for(var w=r.getMainContent().getElementsByClassName("e-row"),M=[],E=0;E<w[e].getElementsByTagName("td").length;E++)M[E]=w[e].getElementsByTagName("td")[E].cloneNode(!0);var T=XA(r.getContentTable(),M,!1,r)+1,D=y>=T?y:T;parseInt(o.style.height,10)<D||n&&n.classList.contains("e-reach-fntsize")&&parseInt(o.style.height,10)===D?(f.showHeaders&&(n.classList.add("e-reach-fntsize"),a.style.lineHeight=parseInt(t,10)>=4?parseInt(t,10)-4+"px":parseInt(t,10)>0?parseInt(t,10)-1+"px":"0px"),o.style.lineHeight=parseInt(t,10)>0?parseInt(t,10)-1+"px":"0px"):(a&&a.style.removeProperty("line-height"),o.style.removeProperty("line-height"),n&&n.classList.contains("e-reach-fntsize")&&n.classList.remove("e-reach-fntsize"))}if(u=o.previousElementSibling,p=o.nextElementSibling,u&&(f.showHeaders&&(l=n.previousElementSibling,h=a.previousElementSibling),u=o.previousElementSibling),p&&(f.showHeaders&&(c=n.nextElementSibling,d=a.nextElementSibling),p=o.nextElementSibling),parseInt(t,10)<=0&&!(o.classList.contains("e-zero")||o.classList.contains("e-zero-start"))){if(u&&p)if(i?(f.showHeaders&&(a.style.width="2px"),o.style.width="0px"):(f.showHeaders&&(a.style.height="2px"),o.style.height="0px"),u.classList.contains("e-zero-start")?(f.showHeaders&&n.classList.add("e-zero-start"),o.classList.add("e-zero-start")):(f.showHeaders&&n.classList.add("e-zero"),o.classList.add("e-zero")),c&&!c.classList.contains("e-zero")&&!c.classList.contains("e-zero-last")&&(f.showHeaders&&n.classList.add("e-zero-last"),o.classList.add("e-zero-last")),u.classList.contains("e-zero-last")&&(f.showHeaders&&l.classList.remove("e-zero-last"),u.classList.remove("e-zero-last")),f.showHeaders&&l.classList.contains("e-zero")?(n.classList.contains("e-zero-end"),Gr(h,-2,i)):f.showHeaders&&Gr(h,-1,i),f.showHeaders&&l.classList.contains("e-zero-start")&&Gr(a,-1,i),f.showHeaders&&c.classList.contains("e-zero"))if(n.classList.contains("e-zero-start"))for(;c;)if(c.classList.contains("e-zero")&&parseInt(d.style.height,10)!==0&&!i||parseInt(d.style.width,10)!==0&&i){i?(a.style.width=parseInt(a.style.width,10)-1+"px",d.style.width=parseInt(d.style.width,10)-1+"px"):(a.style.height=parseInt(a.style.height,10)-1+"px",d.style.height=parseInt(d.style.height,10)-1+"px"),c.classList.remove("e-zero"),c.classList.add("e-zero-start");break}else{var N=void 0;c.classList.remove("e-zero"),c.classList.add("e-zero-start"),i?(N=parseInt(c.getAttribute("aria-colindex"),10)-1,c=r.getColHeaderTable().getElementsByTagName("th")[N+1],d=r.getColHeaderTable().getElementsByTagName("col")[N+1]):(N=parseInt(c.getAttribute("aria-rowindex"),10)-1,c=r.getRowHeaderTable().getElementsByTagName("tr")[N+1],d=r.getRowHeaderTable().getElementsByTagName("tr")[N+1])}else Gr(a,-2,i);else f.showHeaders&&(c.classList.contains("e-zero-end")?i?a.style.width="0px":a.style.height="0px":Gr(d,-1,i));else if(u)i?(f.showHeaders&&(a.style.width="1px"),o.style.width="0px"):(f.showHeaders&&(a.style.height="1px"),o.style.height="0px"),f.showHeaders&&n.classList.add("e-zero-end"),o.classList.add("e-zero-end"),f.showHeaders&&n.classList.add("e-zero-last"),o.classList.add("e-zero-last"),f.showHeaders&&l.classList.contains("e-zero")?Gr(h,-2,i):Gr(h,-1,i);else if(c)if(n.classList.add("e-zero-start"),o.classList.add("e-zero-start"),c.classList.contains("e-zero")||(n.classList.add("e-zero-last"),o.classList.add("e-zero-last")),i?(a.style.width="1px",o.style.width="0px"):(a.style.height="1px",o.style.height="0px"),f.showHeaders&&c.classList.contains("e-zero"))for(;c;)if(c.classList.contains("e-zero")&&parseInt(d.style.width,10)!==0&&i||parseInt(d.style.height,10)!==0&&!i){i?(d.style.width=parseInt(d.style.width,10)-1+"px",a.style.width=parseInt(a.style.width,10)-1+"px"):(d.style.height=parseInt(d.style.height,10)-1+"px",a.style.height=parseInt(a.style.height,10)-1+"px"),c.classList.add("e-zero-start"),c.classList.remove("e-zero");break}else{var N=void 0;c.classList.add("e-zero-start"),c.classList.remove("e-zero"),i?(N=parseInt(c.getAttribute("aria-colindex"),10)-1,d=r.getColHeaderTable().getElementsByTagName("col")[N+1],c=r.getColHeaderTable().getElementsByTagName("th")[N+1]):(N=parseInt(c.getAttribute("aria-rowindex"),10)-1,d=r.getRowHeaderTable().getElementsByTagName("tr")[N+1],c=r.getRowHeaderTable().getElementsByTagName("tr")[N+1])}else f.showHeaders&&Gr(d,-1,i)}else if(parseInt(t,10)>0){var A=Mr(parseInt(t,10))+"px";i?(a.style.width=A,o.style.width=A):(a.style.height=A,o.style.height=A),f.showHeaders&&l&&c?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(h.style.width=parseInt(h.style.width,10)+2+"px",a.style.width=parseInt(a.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+2+"px",a.style.height=parseInt(a.style.height,10)-1+"px"):Gr(a,-1,i):n.classList.contains("e-zero")?Gr(h,1,i):n.classList.contains("e-zero-start")&&(i?(h.style.width=parseInt(h.style.width,10)+1+"px",a.style.width=parseInt(a.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+1+"px",a.style.height=parseInt(a.style.height,10)-1+"px")),c.classList.contains("e-zero")?Gr(a,-1,i):(n.classList.contains("e-zero")||n.classList.contains("e-zero-start"))&&Gr(d,1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),o.classList.contains("e-zero")&&o.classList.remove("e-zero"),o.classList.contains("e-zero-start")&&o.classList.remove("e-zero-start"),n.classList.contains("e-zero-last")&&n.classList.remove("e-zero-last"),o.classList.contains("e-zero-last")&&o.classList.remove("e-zero-last"),(l.classList.contains("e-zero")||l.classList.contains("e-zero-start"))&&(l.classList.add("e-zero-last"),u.classList.add("e-zero-last"))):f.showHeaders&&l?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(a.style.width=parseInt(a.style.width,10)-1+"px",h.style.width=parseInt(h.style.width,10)+2+"px"):(a.style.height=parseInt(a.style.height,10)-1+"px",h.style.height=parseInt(h.style.height,10)+2+"px"):Gr(a,-1,i):n.classList.contains("e-zero")?Gr(h,1,i):Gr(a,-1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-end")&&n.classList.remove("e-zero-end"),o.classList.contains("e-zero")&&o.classList.remove("e-zero"),o.classList.contains("e-zero-end")&&o.classList.remove("e-zero-end")):f.showHeaders&&c&&(c.classList.contains("e-zero")?Gr(a,-1,i):n.classList.contains("e-zero-start")&&(Gr(d,1,i),n.classList.remove("e-zero-start")),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),o.classList.contains("e-zero")&&o.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),o.classList.contains("e-zero-start")&&o.classList.remove("e-zero-start"))}}function Gr(s,e,t){t?s.style.width=parseInt(s.style.width,10)+e+"px":s.style.height=parseInt(s.style.height,10)+e+"px"}function XA(s,e,t,i,r,n){var a=i.createElement("div",{className:i.element.className,styles:"display: block"}),o=i.createElement("table",{className:s.className+"e-resizetable",styles:"width: auto;height: auto"}),l=i.createElement("tr");t?e.forEach(function(p){var f=l.cloneNode();f.appendChild(p),o.appendChild(f)}):(e.forEach(function(p){l.appendChild(p.cloneNode(!0))}),o.appendChild(l)),a.appendChild(o),document.body.appendChild(a);var h,u,c=o.getBoundingClientRect().width,d=o.getBoundingClientRect().height;return n?(t&&parseInt(r,10)>c?h=c:h=parseInt(r,10),!t&&parseInt(r,10)>d?u=d:u=parseInt(r,10)):(u=d,h=c),document.body.removeChild(a),Math.ceil(t?h:u)}function kr(s,e,t,i,r,n){var a=s.eventArgs,o,l,h,u,c,d,p,f,v,g,b,y,C,x=s.isFromUpdateAction||Re(t);if(s.isUndoRedo){x=s.isFromUpdateAction=!0,delete s.isUndoRedo,e.notify(Fa,s);return}if(x&&!n){var w=a.address||a.range||a.pastedRange||a.addressCollection&&a.addressCollection[0]||a.dataRange,M=Re(a.sheetIndex)?Re(a.sheetIdx)?Re(a.activeSheetIndex)?w?La(e,w):e.activeSheetIndex:a.activeSheetIndex:a.sheetIdx:a.sheetIndex;if(M!==e.activeSheetIndex){var E={sheet:Pe(e,M),resolveAfterFullDataLoaded:!0,indexes:[0,0,0,0],promise:new Promise(function(q){q(function(){}())})};e.notify(od,E),E.promise.then(function(){kr(s,e,t,i,r,!0)});return}}var T,D,N;switch(s.action){case"sorting":h={range:s.eventArgs.range,sortOptions:s.eventArgs.sortOptions,cancel:!1},u=new Promise(function(X,G){X(function(){}())}),c={args:h,promise:u},e.notify(Pf,c),c.promise.then(function(X){e.serviceLocator.getService("cell").refreshRange(ir(X.range))});break;case"cellSave":d=s.eventArgs,T={element:d.element,value:d.value,oldValue:d.oldValue,address:d.address,displayText:d.displayText,formula:d.formula,originalEvent:d.originalEvent},p=T.formula?{formula:T.formula}:{value:T.value},e.updateCell(p,T.address),t===!0&&e.trigger("cellSave",T);break;case"cellDelete":D=TP(e,s.eventArgs.address),dz(e,D.indices,D.sheetIndex);break;case"format":if(a.requestType==="CellFormat"){if(a.style&&a.style.border&&!m(a.borderType)){var A={};Object.assign(A,a.style,null,!0),a.style.border=void 0,e.notify(Ri,{style:a.style,refreshRibbon:!0,range:a.range}),a.style.border=A.border,e.setBorder(a.style,a.range,a.borderType),a.style=A}else e.notify(Ri,{style:a.style,refreshRibbon:!0,range:a.range});Vi(function(){return e.selectRange(e.getActiveSheet().selectedRange)})}else e.numberFormat(a.format,a.range);break;case"clipboard":f=new Promise(function(X){X(function(){}())}),C=e.getAddressInfo(a.copiedRange),e.notify(a.copiedInfo.isCut?du:pu,{range:C.indices,sId:Pe(e,C.sheetIndex).id,promise:u,invokeCopy:!0,isPublic:!0,isFromUpdateAction:!0}),f.then(function(){return e.notify(Ia,{range:ir(a.pastedRange),sIdx:gt(e,Ms(a.pastedRange)),type:a.type,isAction:!1,isInternal:!0,isFromUpdateAction:!0})});break;case"gridLines":e.setSheetPropertyOnMute(e.sheets[a.sheetIdx],"showGridLines",a.isShow),e.serviceLocator.getService("sheet").toggleGridlines(),e.notify(Oa,null);break;case"headers":e.setSheetPropertyOnMute(e.sheets[a.sheetIdx],"showHeaders",a.isShow),e.serviceLocator.getService("sheet").showHideHeaders(),e.notify(Oa,null);break;case"resize":case"resizeToFit":x&&(g=e.sheets[a.sheetIndex],b=oi(g,a.index),y=sh(g,a.index),(a.isCol&&b&&b.hidden||y&&y.hidden)&&e.notify(nn,{startIndex:a.index,endIndex:a.index,hide:!1,isCol:a.isCol,sheetIndex:a.sheetIndex})),a.isCol?a.hide===void 0?e.setColWidth(x&&!Re(t)?a.oldWidth:a.width,a.index,a.sheetIndex):e.hideColumn(a.index,a.index,a.hide):a.hide===void 0?e.setRowHeight(x&&!Re(t)?a.oldHeight:a.height,a.index,a.sheetIndex):e.hideRow(a.index,a.index,a.hide);break;case"renameSheet":var M=Qn(e,a.index);e.setSheetPropertyOnMute(e.sheets[M],"name",a.value),e.notify(Zy,{items:e.element.querySelector(".e-sheet-tabs-items"),value:a.value,idx:M});break;case"hideSheet":e.notify(Jy,{sheetIndex:a.sheetIndex});break;case"showSheet":e.notify(aM,a);break;case"removeSheet":e.notify(Xy,{index:a.index,isAction:!0,count:a.sheetCount,clicked:!0});break;case"gotoSheet":e.notify(sM,{selectedIndex:a.currentSheetIndex,previousIndex:a.previousSheetIndex});break;case"moveSheet":Qy(e,a.position,a.sheetIndexes,null,x);break;case"wrap":_c(s.eventArgs.address,s.eventArgs.wrap,e);break;case"hideShow":a.isCol?e.notify(nn,{startIndex:a.startIndex,endIndex:a.endIndex,isCol:!0,hide:t===!1?!a.hide:a.hide,sheetIndex:a.sheetIndex}):e.notify(nn,{startIndex:a.startIndex,endIndex:a.endIndex,hide:t===!1?!a.hide:a.hide,sheetIndex:a.sheetIndex});break;case"replace":e.notify(Bf,{value:a.compareValue,replaceValue:a.replaceValue,sheetIndex:a.sheetIndex,address:a.address});break;case"replaceAll":e.notify(fd,a);break;case"filter":u=new Promise(function(X,G){X(function(){}())}),t===!1?e.notify(so,{predicates:a.previousPredicates,range:a.range,sIdx:a.sheetIndex,promise:u,isInternal:!0}):e.notify(so,{predicates:a.predicates,range:a.range,sIdx:a.sheetIndex,promise:u,isInternal:!0,useFilterRange:a.useFilterRange}),r&&!x&&u.then(function(){e.notify(yt,me({isUndo:!t,isUndoRedo:!x},r))});break;case"insert":if(s.eventArgs.modelType==="Sheet")g=e;else if(g=Pe(e,s.eventArgs.activeSheetIndex),!g)break;t===!1?e.notify(zf,{model:g,start:s.eventArgs.index,isUndoRedo:!0,end:s.eventArgs.index+(s.eventArgs.model.length-1),modelType:s.eventArgs.modelType}):e.notify(Js,{model:g,start:s.eventArgs.index,end:s.eventArgs.index+(s.eventArgs.model.length-1),modelType:s.eventArgs.modelType,checkCount:t===void 0?s.eventArgs.sheetCount:null,activeSheetIndex:s.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:s.eventArgs.insertType,isFromUpdateAction:x});break;case"delete":if(s.eventArgs.modelType==="Sheet")g=e;else if(g=Pe(e,s.eventArgs.activeSheetIndex),!g)break;t===!1?e.notify(Js,{model:g,start:s.eventArgs.deletedModel,modelType:s.eventArgs.modelType,columnCellsModel:s.eventArgs.deletedCellsModel,definedNames:s.eventArgs.definedNames,activeSheetIndex:s.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:s.eventArgs.modelType==="Row"?"above":"before",conditionalFormats:s.eventArgs.conditionalFormats,prevAction:s.action}):e.notify(zf,{model:g,start:s.eventArgs.startIndex,checkCount:s.eventArgs.sheetCount,end:s.eventArgs.endIndex,modelType:s.eventArgs.modelType,isUndoRedo:!0,insertType:s.eventArgs.modelType==="Row"?"above":"before"});break;case"validation":t===!1?e.notify(Jf,{range:a.range}):e.notify(Yo,{rules:{type:a.type,operator:a.operator,value1:a.value1,value2:a.value2,ignoreBlank:a.ignoreBlank,inCellDropDown:a.inCellDropDown},range:a.range});break;case"removeHighlight":case"addHighlight":e.notify(Zf,{isRemoveHighlight:s.action==="removeHighlight"?t!==!1:t===!1,range:a.range,isPublic:!0});break;case"merge":s.eventArgs.isAction=!1,v=[];for(var L=0,k=a.model.length;L<k;L++){v.push({cells:[]});for(var O=0,R=a.model[L].cells.length;O<R;O++)v[L].cells[O]={},Object.assign(v[L].cells[O],a.model[L].cells[O])}e.notify(Fn,s.eventArgs),a.model=v;break;case"clear":N={options:s.eventArgs,isFromUpdateAction:x},e.notify(ev,N),!x&&N.cfClearActionArgs&&(a.cfClearActionArgs.previousConditionalFormats=N.cfClearActionArgs.previousConditionalFormats,a.cfClearActionArgs.conditionalFormats=N.cfClearActionArgs.conditionalFormats);break;case"conditionalFormat":t===!1?e.notify(no,{range:a.range,cfModel:{type:a.type,cFColor:a.cFColor,value:a.value},sheetIdx:a.sheetIdx,isUndoRedo:!a.cancel,isFromUpdateAction:x}):e.notify(vd,{cfModel:{type:a.type,cFColor:a.cFColor,value:a.value,range:a.range},sheetIdx:a.sheetIdx,isUndoRedo:!0,isFromUpdateAction:x});break;case"clearCF":if(t===!1)e.notify(no,{oldCFModel:a.previousConditionalFormats,updatedCFModel:a.conditionalFormats,range:a.selectedRange,isUndo:!0,sheetIdx:a.sheetIdx});else{var j={range:a.selectedRange,sheetIdx:a.sheetIdx,isUndoRedo:!0,isFromUpdateAction:x};e.notify(no,j),x||(a.previousConditionalFormats=j.oldCFModel,j.updatedCFModel.length?a.conditionalFormats=j.updatedCFModel:delete a.conditionalFormats)}break;case"insertImage":t===!1?e.notify(Xs,{id:s.eventArgs.id,sheetIdx:s.eventArgs.sheetIndex+1,range:s.eventArgs.range,preventEventTrigger:!0}):e.notify(Da,{options:{src:s.eventArgs.imageData,height:s.eventArgs.imageHeight,width:s.eventArgs.imageWidth,imageId:s.eventArgs.id},range:s.eventArgs.range,isPublic:!1,isUndoRedo:!0});break;case"deleteImage":t===!1?e.notify(Da,{options:{src:s.eventArgs.imageData,height:s.eventArgs.imageHeight,width:s.eventArgs.imageWidth,imageId:s.eventArgs.id},range:s.eventArgs.address,isPublic:!1,isUndoRedo:!0}):e.notify(Xs,{id:s.eventArgs.id,range:s.eventArgs.address,preventEventTrigger:!0});break;case"imageRefresh":l=document.getElementById(s.eventArgs.id),t===!1?e.notify(Md,{prevTop:s.eventArgs.currentTop,prevLeft:s.eventArgs.currentLeft,currentTop:s.eventArgs.prevTop,currentLeft:s.eventArgs.prevLeft,id:s.eventArgs.id,currentHeight:s.eventArgs.prevHeight,currentWidth:s.eventArgs.prevWidth,requestType:"imageRefresh",prevHeight:s.eventArgs.currentHeight,prevWidth:s.eventArgs.currentWidth,isUndoRedo:!0}):(s.eventArgs.isUndoRedo=!0,e.notify(Md,s.eventArgs)),l&&(l.style.height=t===!1?s.eventArgs.prevHeight+"px":s.eventArgs.currentHeight+"px",l.style.width=t===!1?s.eventArgs.prevWidth+"px":s.eventArgs.currentWidth+"px",l.style.top=t===!1?s.eventArgs.prevTop+"px":s.eventArgs.currentTop+"px",l.style.left=t===!1?s.eventArgs.prevLeft+"px":s.eventArgs.currentLeft+"px");break;case"insertChart":if(t===!1)e.notify(gu,{id:a.id,range:a.range,isUndoRedo:!0});else{var P=[{type:a.type,theme:a.theme,markerSettings:a.markerSettings,isSeriesInRows:a.isSeriesInRows,range:a.range,id:a.id,height:a.height,width:a.width}];e.notify(th,{chart:P,isUndoRedo:!1,range:a.posRange})}break;case"deleteChart":if(t===!1){var F=[{type:a.type,theme:a.theme,markerSettings:a.markerSettings,isSeriesInRows:a.isSeriesInRows,range:a.range,id:a.id,height:a.height,width:a.width,top:a.top,left:a.left}];e.notify(th,{chart:F,isUndoRedo:!1,range:a.posRange})}else e.notify(gu,{id:a.id,range:a.range,isUndoRedo:!0});break;case"chartRefresh":o=document.getElementById(s.eventArgs.id),o&&(o.style.height=t===!1?s.eventArgs.prevHeight+"px":s.eventArgs.currentHeight+"px",o.style.width=t===!1?s.eventArgs.prevWidth+"px":s.eventArgs.currentWidth+"px",o.style.top=t===!1?s.eventArgs.prevTop+"px":s.eventArgs.currentTop+"px",o.style.left=t===!1?s.eventArgs.prevLeft+"px":s.eventArgs.currentLeft+"px"),t===!1?(e.notify(Ed,me({},s.eventArgs,{currentColIdx:s.eventArgs.prevColIdx,currentHeight:s.eventArgs.prevHeight,currentLeft:s.eventArgs.prevLeft,currentRowIdx:s.eventArgs.prevRowIdx,currentTop:s.eventArgs.prevTop,currentWidth:s.eventArgs.prevWidth,prevColIdx:s.eventArgs.currentColIdx,prevHeight:s.eventArgs.currentHeight,prevLeft:s.eventArgs.currentLeft,prevRowIdx:s.eventArgs.currentRowIdx,prevTop:s.eventArgs.currentTop,prevWidth:s.eventArgs.currentWidth,isUndoRedo:!0})),e.notify(Al,{height:s.eventArgs.prevHeight.toString(),width:s.eventArgs.prevWidth.toString(),overlayEle:o})):(s.eventArgs.isUndoRedo=!0,e.notify(Ed,s.eventArgs),e.notify(Al,{height:s.eventArgs.currentHeight.toString(),width:s.eventArgs.currentWidth.toString(),overlayEle:o}));break;case"chartDesign":e.notify(Yh,s.eventArgs);break;case"autofill":x&&a.undoArgs&&(a.undoArgs.isFromUpdateAction=a.undoArgs.isUndo=a.undoArgs.preventEvt=!0,a.undoArgs.isPublic=!0,e.notify(Fa,a.undoArgs)),e.notify(gd,{fillRange:s.eventArgs.fillRange,dataRange:s.eventArgs.dataRange,fillType:s.eventArgs.fillType,direction:s.eventArgs.direction});break;case"removeValidation":t!==!1&&e.notify(Jf,{range:a.range,isCol:a.isColSelected});break;case"addDefinedName":if(t===!1)e.notify(xt,{action:"removeDefinedName",isRemoved:!1,definedName:a.name,scope:a.scope,isEventTrigger:!0});else{var z={name:a.name,refersTo:a.refersTo,scope:a.scope,comment:a.comment};e.notify(xt,{action:"addDefinedName",isAdded:!1,definedName:z,isEventTrigger:!0})}break;case"hyperlink":e.notify(dd,{hyperlink:a.hyperlink,cell:a.address,displayText:a.displayText,triggerEvt:!1}),e.serviceLocator.getService("cell").refreshRange(ir(a.address),!1,!1,!1,!1,ea(e));break;case"removeHyperlink":e.notify(Xf,{range:a.address,preventEventTrigger:!0});break;case"freezePanes":e.freezePanes(a.row,a.column,a.sheetIndex);break;case"duplicateSheet":MI(e,a.sheetIndex,null,x);break;case"protectSheet":a.isProtected?e.notify(Hc,a):(e.setSheetPropertyOnMute(Pe(e,a.sheetIndex),"password",""),e.notify(Lp,{isActive:!0,sheetIndex:a.sheetIndex}));break;case"protectWorkbook":a.isProtected?e.notify(mM,a):e.notify(gM,null);break;case"lockCells":e.notify(Ry,a)}}function uz(s,e,t,i){for(var r=s.sheets[i],n=r.ranges,a,o=0,l=n.length;o<l;o++)if(n[o].template&&(a=ee(n[o].address.length?n[o].address:n[o].startCell),a[0]<=e&&a[1]<=t&&a[2]>=e&&a[3]>=t))return!0;return!1}function Ja(s,e,t,i,r,n,a){a===void 0&&(a=!0);var o=Wt(e,i,!0),l=s.frozenColCount(e),h=Mr(t);if(r=r||(e.frozenRows?s.getRow(i,null,l):s.getRow(i)),r&&(r.style.height=h+"px"),e.frozenColumns)n=n||s.getRow(i,null,l-1);else{var u=s.frozenRowCount(e);n=n||s.getRow(i,i<u?s.sheetModule.getSelectAllTable():s.getRowHeaderTable())}n&&(n.style.height=h+"px"),Id(e,i,t),s.setProperties({sheets:s.sheets},!0),a&&s.notify(an,{rowIdx:i,threshold:h-o})}function IM(s,e,t,i){t===void 0&&(t=1);var r=e&&e.fontSize||s.cellStyle.fontSize,n=r.indexOf("pt")>-1?parseInt(r,10)/.75:parseInt(r,10),a=n*(i||TI(e&&e.fontFamily?e:s.cellStyle))*t;return Math.ceil(a%1>.9?a+1:a)}function TI(s){var e=t7;return s&&(s.fontFamily==="Arial Black"||s.fontFamily==="Comic Sans MS"?e=1.44:s.fontFamily==='"Segoe UI", sans-serif'&&(e=1.36)),e}function _r(s,e,t,i){e||(e=t);var r=document.createElement("canvas"),n=r.getContext("2d");return n.font=(e.fontStyle||t.fontStyle)+" "+(e.fontWeight||t.fontWeight)+" "+(e.fontSize||t.fontSize)+" "+(e.fontFamily||t.fontFamily),i?n.measureText(s).width:Mr(n.measureText(s).width,!0)}function iv(s,e,t,i){var r,n,a,o,l=0,h=s.toString().split(" "),u=_r(" ",t,i),c,d,p=0,f=0,v=0,g=function(y,C){l&&p++,r/e>=1&&(y.split("").forEach(function(x){o=_r(x,t,i,!0),a+=o,a>e&&(p++,a=o)}),r=Mr(a,!0)),C||b(r),l=r},b=function(y){r+=(y+u)/e>=1?0:u};return h.forEach(function(y){a=0,o=0,r=_r(y,t,i),d=(l+r)/e,d>1?(n=y.split("-"),n.length>1?n.forEach(function(C){a=0,o=0,c||(c=_r("-",t,i)),r=_r(C,t,i),n[n.length-1]!==C&&(r+=c),d=(l+r)/e,d>=1?g(C,n[n.length-1]!==C):(n[n.length-1]===C&&h[h.length-1]!==y&&b(l+r),l+=r)}):g(y,!1)):(b(l+r),l+=r)}),l&&(f=(l-u)/e,v=parseFloat(f.toString().split(".")[0]),p+=f+.05>=v+1?Math.ceil(f)+1:Math.ceil(f)),p}function o7(s,e,t){var i=0,r=Y(s,e,t,null,!0),n=Y(s,e+1,t,null,!0);return r.style&&(r.style.border?i=(e===0?2:1)*parseFloat(r.style.border.split("px")[0]):(e===0&&r.style.borderLeft&&(i=parseFloat(r.style.borderLeft.split("px")[0])),r.style.borderRight&&(i+=parseFloat(r.style.borderRight.split("px")[0])))),!(r.style&&(r.style.border||r.style.borderRight))&&n.style&&n.style.borderLeft&&(i+=parseFloat(n.style.borderLeft.split("px")[0])),i>0&&i<1?1:i}function cz(s,e,t){var i=0,r=Y(s,e,t,null,!0);r.style&&(r.style.border?i=(s===0?2:1)*parseFloat(r.style.border.split("px")[0]):(s===0&&r.style.borderTop&&(i=parseFloat(r.style.borderTop.split("px")[0])),r.style.borderBottom&&(i+=parseFloat(r.style.borderBottom.split("px")[0]))));var n=Y(s+1,e,t,null,!0);return!(r.style&&(r.style.border||r.style.borderBottom))&&n.style&&n.style.borderTop&&(i+=parseFloat(n.style.borderTop.split("px")[0])),Math.ceil(i)||1}function Ad(s,e,t,i){return i===void 0&&(i=t),ci(s,t,i,!0)-Mr(4+(o7(e,t,s)||1))}function qc(s,e,t,i,r,n,a){return IM(s,r,n,a)+cz(e,t,i)}function Yl(s,e,t,i){s.maxHgts[e]||(s.maxHgts[e]={}),s.maxHgts[e][t]=i}function eo(s,e){var t=0,i=s.maxHgts[e];return i&&Object.keys(i).forEach(function(r){i[""+r]>t&&(t=i[""+r])}),t}function Fe(s){if(!document.activeElement.classList.contains("e-text-findNext-short"))if(B.isIE){var e=window.scrollX,t=window.scrollY;s.focus(),window.scrollTo(e,t)}else{if(s.classList.contains("e-input")){var i=s,r=i.value.length;i.setSelectionRange(r,r)}s.focus({preventScroll:!0})}}function ah(s,e){for(var t=s.getActiveSheet(),i,r=m(e)?lt(ee(t.selectedRange)):e,n=r[0];n<=r[2];n++)for(var a=r[1];a<=r[3];a++){var o=Y(n,a,t);if(Cn(o,oi(t,a))){i=!0;break}}return i}function TM(s){return s.includes(" ")}function dz(s,e,t){for(var i=Pe(s,t),r,n,a,o,l,h=t===s.activeSheetIndex,u,c=i.conditionalFormats&&i.conditionalFormats.length&&[].slice.call(i.conditionalFormats),d=[],p=e[0],f=e[2];p<=f;p++)if(!Aa(i,p))for(var v=e[1],g=e[3];v<=g;v++){var b={cellIdx:[p,v],isUnique:!1,uniqueRange:""};if(s.notify(ou,b),r=!1,b.uniqueRange!==""){var y=ir(b.uniqueRange);r=Y(y[0],y[1],i).value==="#SPILL!"}if((!b.isUnique||r)&&(n=Y(p,v,i),n)){a={},n.formula&&(a.formula=""),(n.value||n.value===0)&&(a.value=""),n.hyperlink&&(a.hyperlink="");var C={sheet:i,cell:n,rowIdx:p,colIdx:v};if((n.colSpan>1||n.rowSpan>1)&&bb(C),o=s.getCell(C.rowIdx,C.colIdx),l={cell:a,rowIdx:p,colIdx:v,valChange:!0,uiRefresh:h,td:o,cellDelete:!0},!Object.keys(a).length||Tn(s,i,l))continue;c&&!u&&(u=l.isFormulaDependent,u||_f(c,d,p,v)),o&&(o.querySelector(".e-cf-databar")&&o.removeChild(o.querySelector(".e-cf-databar")),o.querySelector(".e-iconsetspan")&&o.removeChild(o.querySelector(".e-iconsetspan")))}}(d.length||u)&&h&&s.notify(er,{cfModel:!u&&d,refreshAll:u,isAction:!0})}function ea(s){return s.allowOpen&&s.openModule.preventFormatCheck}function Yc(s,e){for(var t=0,i=s.getActiveSheet(),r=(i.frozenRows?s.viewport.height-s.sheetModule.getColHeaderHeight(i,!0):s.viewport.height)-17||20,n=e;;n++)if(t+=Wt(i,n,!0),t>=r)return{index:n,height:t}}function Eg(s,e){for(var t=0,i=s.getActiveSheet(),r=s.getMainContent().parentElement.offsetWidth-s.sheetModule.getRowHeaderWidth(i)-s.sheetModule.getScrollSize(),n=e;;n++)if(t+=tr(i,n,null,!0),t>=r)return n}function oh(s){if(window.devicePixelRatio%1>0){var e=s*window.devicePixelRatio%1;return s+(e?(e>.5?1-e:-1*e)/window.devicePixelRatio:0)}return s}var l7=function(s,e,t,i){return new(t||(t=Promise))(function(r,n){function a(h){try{l(i.next(h))}catch(u){n(u)}}function o(h){try{l(i.throw(h))}catch(u){n(u)}}function l(h){h.done?r(h.value):new t(function(u){u(h.value)}).then(a,o)}l((i=i.apply(s,e||[])).next())})},h7=function(s,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,r=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(s,t)}catch(u){h=[6,u],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},u7=function(){function s(e){this.parent=e,this.init(),this.addEventListener()}return s.prototype.init=function(){this.parent.element.appendChild(this.parent.createElement("input",{className:"e-clipboard",attrs:{contenteditable:"true",tabindex:"-1","aria-hidden":"true"}}))},s.prototype.addEventListener=function(){var e=this.getClipboardEle();this.parent.on(du,this.cut,this),this.parent.on(pu,this.copy,this),this.parent.on(Ia,this.paste,this),this.parent.on(Cd,this.clearCopiedInfo,this),this.parent.on(k1,this.tabSwitchHandler,this),this.parent.on(uu,this.cMenuBeforeOpenHandler,this),this.parent.on(Qf,this.ribbonClickHandler,this),this.parent.on(tn,this.initCopyIndicator,this),this.parent.on(an,this.rowHeightChanged,this),this.parent.on(wn,this.colWidthChanged,this),this.parent.on(Uy,this.refreshOnInsertDelete,this),I.add(e,"cut",this.cut,this),I.add(e,"copy",this.copy,this),I.add(e,"paste",this.paste,this)},s.prototype.removeEventListener=function(){var e=this.getClipboardEle();this.parent.isDestroyed||(this.parent.off(du,this.cut),this.parent.off(pu,this.copy),this.parent.off(Ia,this.paste),this.parent.off(Cd,this.clearCopiedInfo),this.parent.off(k1,this.tabSwitchHandler),this.parent.off(uu,this.cMenuBeforeOpenHandler),this.parent.off(Qf,this.ribbonClickHandler),this.parent.off(tn,this.initCopyIndicator),this.parent.off(an,this.rowHeightChanged),this.parent.off(wn,this.colWidthChanged),this.parent.off(Uy,this.refreshOnInsertDelete)),I.remove(e,"cut",this.cut),I.remove(e,"copy",this.copy),I.remove(e,"paste",this.paste)},s.prototype.ribbonClickHandler=function(e){var t=this.parent.element.id;switch(e.item.id){case t+"_cut":this.cut({invokeCopy:!0});break;case t+"_copy":this.copy({invokeCopy:!0});break}},s.prototype.tabSwitchHandler=function(e){e.activeTab===0&&!this.copiedInfo&&!this.copiedShapeInfo&&this.hidePaste()},s.prototype.cMenuBeforeOpenHandler=function(e){var t=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(de),r=[],n=[],a=[],o=[],l=t.activeCell,h=xe(l),u=Y(h[0],h[1],t),c=t.isProtected&&Cn(u,oi(t,h[1]));(e.target==="Content"||e.target==="RowHeader"||e.target==="ColumnHeader"||e.target==="SelectAll")&&(this.parent.enableContextMenuItems([i.getConstant("Paste"),i.getConstant("PasteSpecial")],!!(this.copiedInfo||this.copiedShapeInfo&&!c)),this.parent.enableContextMenuItems([i.getConstant("Cut")],!c)),e.target==="Content"&&(c?this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Filter"),i.getConstant("Sort"),i.getConstant("Hyperlink")],!1):t.isProtected&&!t.protectSettings.insertLink&&this.parent.enableContextMenuItems([i.getConstant("Hyperlink")],!1)),t.isProtected&&(e.target==="ColumnHeader"&&(a=[i.getConstant("DeleteColumn"),i.getConstant("DeleteColumns"),i.getConstant("InsertColumn"),i.getConstant("InsertColumns")],o=[i.getConstant("HideColumn"),i.getConstant("HideColumns"),i.getConstant("UnhideColumns")],this.parent.enableContextMenuItems(a,!1),this.parent.enableContextMenuItems(o,t.protectSettings.formatColumns)),e.target==="RowHeader"&&(r=[i.getConstant("DeleteRow"),i.getConstant("DeleteRows"),i.getConstant("InsertRow"),i.getConstant("InsertRows")],n=[i.getConstant("HideRow"),i.getConstant("HideRows"),i.getConstant("UnhideRows")],this.parent.enableContextMenuItems(r,!1),this.parent.enableContextMenuItems(n,t.protectSettings.formatRows)))},s.prototype.rowHeightChanged=function(e){if(this.copiedInfo){var t=this.getCopyIndicator();t&&(this.copiedInfo.range[0]>e.rowIdx?t.style.top=parseFloat(t.style.top)+e.threshold+"px":Sa(this.copiedInfo.range,e.rowIdx,this.copiedInfo.range[1])&&(t.style.height=parseFloat(t.style.height)+e.threshold+"px"))}},s.prototype.colWidthChanged=function(e){if(this.copiedInfo){var t=this.getCopyIndicator();t&&(this.copiedInfo.range[1]>e.colIdx?t.style.left=parseFloat(t.style.left)+e.threshold+"px":Sa(this.copiedInfo.range,this.copiedInfo.range[0],e.colIdx)&&(t.style.width=parseFloat(t.style.width)+e.threshold+"px"))}},s.prototype.cut=function(e){this.setCopiedInfo(e,!0)},s.prototype.copy=function(e){this.setCopiedInfo(e,!1)},s.prototype.paste=function(e){if(this.parent.isEdit||this.parent.element.getElementsByClassName("e-dlg-overlay").length>0){var t=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0];t.style.height="auto";return}var i,r=e&&e.clipboardData||window.clipboardData;if(!(r&&e.clipboardData&&e.clipboardData.getData("isInternalCut").length&&!this.copiedInfo))if(r||this.copiedShapeInfo||e.isInternal&&this.copiedInfo){e.isInternal=!r;var n=void 0,a=this.getCopiedIdx();e.isAction=!!r||e.isAction;var o=e&&e.sIdx>-1?e.sIdx:this.parent.activeSheetIndex,l=Pe(this.parent,o),h=lt(e&&e.range||ee(l.selectedRange)),u=void 0,c=void 0;if(r){if(u=this.getExternalCells(e),c=u.model,!e.isInternal&&u.internal&&(r=!1,!this.copiedInfo))return;if(!c||!c.length)if(u.file){this.parent.notify(uM,{file:u.file});return}else if(this.copiedInfo)r=!1;else return}u=u;var d=Object.assign({isExternal:r},this.copiedInfo),p=void 0,f=void 0,v=void 0,g=void 0,b=void 0,y=void 0,C=void 0,x=void 0,w=void 0;r?(f=o,C=Pe(this.parent,f),v={},y=u.selection,b=y!=="Sheet"&&(h[2]-h[0]+1)%u.rowCount===0&&(h[3]-h[1]+1)%u.colCount===0,p=[0,0,u.usedRowIndex,u.usedColIndex]):(p=lt(this.copiedShapeInfo?ee(l.selectedRange):this.copiedInfo.range),f=a,v=oi(l,p[1]),g=Af(p)&&this.isRangeMerged(h,l),C=Pe(this.parent,f),b=!g&&(h[2]-h[0]+1)%(p[2]-p[0]+1)===0&&(h[3]-h[1]+1)%(p[3]-p[1]+1)===0,C&&(x=p[1]===0&&p[3]===C.colCount-1,w=p[0]===0&&p[2]===C.rowCount-1,x?w?(y="Sheet",p[2]=C.usedRange.rowIndex,p[3]=C.usedRange.colIndex):(y="Row",p[3]=C.usedRange.colIndex):w&&(y="Column",p[2]=C.usedRange.rowIndex))),i=b?h:[h[0],h[1]].concat([h[0]+p[2]-p[0],h[1]+p[3]-p[1]||h[1]]),y&&((y==="Sheet"||y==="Column")&&i[2]<l.usedRange.rowIndex&&(i[2]=l.usedRange.rowIndex),(y==="Sheet"||y==="Row")&&i[3]<l.usedRange.colIndex&&(i[3]=l.usedRange.colIndex));var M=e&&e.type||"All";if(e.isAction&&!this.copiedShapeInfo){var E={requestType:"paste",copiedInfo:this.copiedInfo,copiedRange:je(p),pastedRange:je(i),type:M,cancel:!1};if(this.parent.notify(li,{eventArgs:E,action:"clipboard"}),E.cancel)return;h=ee(E.pastedRange),r?b=u.selection!=="Sheet"&&(h[2]-h[0]+1)%u.rowCount===0&&(h[3]-h[1]+1)%u.colCount===0:b=!g&&(h[2]-h[0]+1)%(p[2]-p[0]+1)===0&&(h[3]-h[1]+1)%(p[3]-p[1]+1)===0,i=b?h:[h[0],h[1]].concat([h[0]+p[2]-p[0],h[1]+p[3]-p[1]||h[1]]),M=E.type}var T=void 0;y?(T=[].concat(i),(y==="Sheet"||y==="Column")&&(i[2]<l.usedRange.rowIndex&&(i[2]=l.usedRange.rowIndex),p[2]<l.usedRange.rowIndex&&(p[2]+=l.usedRange.rowIndex-p[2]),T[2]<l.rowCount&&(T[2]=l.rowCount-1)),(y==="Sheet"||y==="Row")&&(i[3]<l.usedRange.colIndex&&(p[3]+=l.usedRange.colIndex-i[3],i[3]=l.usedRange.colIndex),p[3]<l.usedRange.colIndex&&(p[3]+=l.usedRange.colIndex-p[3]),T[3]<l.colCount&&(T[3]=l.colCount-1))):T=i;var D=void 0,N=void 0,A=void 0,L=h[0],k=[];if(l.isProtected&&ah(this.parent,i)){this.parent.notify(Ta,null);return}if(this.copiedShapeInfo&&!this.copiedInfo){var O=this.copiedShapeInfo.pictureElem;O.classList.contains("e-datavisualization-chart")?(this.copiedShapeInfo.chartInfo.top=null,this.copiedShapeInfo.chartInfo.left=null,this.parent.notify(th,{chart:[this.copiedShapeInfo.chartInfo],isInitCell:!0,isUndoRedo:!0,isPaste:!0,dataSheetIdx:this.copiedShapeInfo.sheetIdx,isCut:this.copiedShapeInfo.isCut,range:e.range||l.selectedRange,sheetId:l.id})):this.parent.notify(Da,{options:{src:O.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:this.copiedShapeInfo.height,width:this.copiedShapeInfo.width,imageId:this.copiedShapeInfo.isCut?O.id:""},range:je([L,h[1],L,h[1]]),isPublic:!1,isUndoRedo:!0});var R=Y(L,h[1],l);if(R&&!m(R.image)&&R.image.length>0){var j={requestType:"imagePaste",copiedShapeInfo:this.copiedShapeInfo,pasteSheetIndex:this.parent.activeSheetIndex,pastedRange:Ns(this.parent)+"!"+je([L,h[1],L,h[1]]),pastedPictureElement:document.getElementById(R.image[R.image.length-1].id)};this.parent.notify(yt,{eventArgs:j,action:"clipboard"})}}else{var P=[],F=this.isInRange(p,h,a),z=!1,q=!1,X=0,G=[];!b&&M!=="Values"&&this.setCF(p,i,C,l,G);for(var Z=void 0,se=void 0,oe=!1,fe=[],be={sheet:l,isExternal:!!r},Ne=this.setCell(be),we=!r&&this.copiedInfo.isCut&&this.setCell({sheet:C}),H=p[0],V=0;H<=p[2];H++,V++){if(!r&&!d.isCut&&Aa(C,H)){V--,X++;continue}F&&(P[h[0]+V]={cells:[]});for(var re=p[1],he=0;re<=p[3];re++,he++){if(F&&(P[h[0]+V].cells[h[1]+he]=Y(h[0]+V,h[1]+he,C,!1,!0)),D=r?c[H]&&c[H].cells[re]||{}:me({},F&&P[H]&&P[H].cells[re]?P[H].cells[re]:Y(H,re,C),null,!0),!D.validation&&v.validation&&(D.validation=v.validation),x||w){if(D&&D.rowSpan){if(D.rowSpan>0)D.rowSpan+H-1<=p[2]?z=!0:D={};else if(!z)D={};else if(D.rowSpan<0){var Ie=D.rowSpan,Te=D.colSpan?D.colSpan:0,rt=Y(L+Ie,h[1]+he+Te,l);rt&&!rt.rowSpan&&(D={})}}D&&D.colSpan&&(D.colSpan>0?D.colSpan+re-1<=p[3]?q=!0:D={}:q||(D={}))}if(D&&M){var Tt=void 0;switch(M){case"Formats":Tt={format:D.format,style:D.style},this.copiedInfo&&!this.copiedInfo.isCut&&(D.rowSpan&&(Tt.rowSpan=D.rowSpan),D.colSpan&&(Tt.colSpan=D.colSpan)),D=Tt;break;case"Values":if(D={value:D.value},D.value&&D.value.toString().indexOf(`
`)>-1){var si=this.parent.getCell(h[0],h[1]);si.classList.add("e-alt-unwrap")}break}N=["Formats","Values"].indexOf(M)>-1}if(!this.parent.scrollSettings.isFinite&&(p[2]-p[0]>1048575-h[0]||p[3]-p[1]>16383-h[1])||this.parent.scrollSettings.isFinite&&(p[2]-p[0]>l.rowCount-1-h[0]||p[3]-p[1]>l.colCount-1-h[1])){this.showDialog();return}if(b){for(var K=h[0];K<=h[2];K+=p[2]-p[0]+1)if(!(!d.isCut&&!X&&Aa(l,K+V)))for(var ue=h[1];ue<=h[3];ue+=p[3]-p[1]+1){if(H===p[0]&&re===p[1]&&(Z===void 0||Z.length)&&M!=="Values"&&(Z=this.setCF(p,[K,ue,K+(p[2]-p[0]),ue+(p[3]-p[1])],C,l,G,Z)),A=Y(K+V,ue+he,l,!1,!0),!r&&(!m(A.colSpan)||!m(A.rowSpan))){if(x||w)continue;var Me={range:[K+V,ue+he,K+V,ue+he],merge:!1,isAction:!1,type:"All",sheetIndex:o,preventRefresh:o!==this.parent.activeSheetIndex};k.push(Me),this.parent.notify(Fn,Me)}var Ae=ue+he;if(D=me({},D||{},null,!0),!N&&this.copiedInfo&&!this.copiedInfo.isCut&&D.formula){var Be=tz([K+V,Ae],[H,re],C,F?D:null);m(Be)||(D.formula=Be)}l.isProtected&&D&&D.isLocked!==!1&&(D.isLocked=A.isLocked),A&&A.formula&&A.formula.indexOf("=UNIQUE(")>-1&&this.parent.notify(ud,null);var _e={cellIdx:[H,re],isUnique:!1,uniqueRange:"",sheetName:C.name};this.parent.notify(ou,_e),_e.isUnique&&(D.value=null),oe=!1,D&&D.formula&&D.formula.indexOf("=UNIQUE(")>-1&&(oe=!0,fe.push([K,Ae]),D.value=null),se=Ne(K+V,Ae,D,Ae===h[3],N,oe),!se&&D.formula&&this.copiedInfo&&this.copiedInfo.isCut&&this.parent.notify(cd,{cellRef:je([H,re,H,re])})}}else(r||!uz(this.parent,H,re,a))&&(g?Ne(L,h[1]+he,{value:D.value},re===p[3],!0):Ne(L,h[1]+he,D,re===p[3],N));if(!r&&this.copiedInfo.isCut&&!(Sa(h,H,re)&&a===this.parent.activeSheetIndex)){var it=Y(H,re,C);if(it)if(it.isLocked||m(it.isLocked))if((x||w)&&(it.rowSpan!==void 0||it.colSpan!==void 0))if(it.rowSpan>1||it.colSpan>1)this.parent.notify(Fn,{merge:!1,range:[H,re,H,re],type:"All"}),it=null;else continue;else it=null;else it.isLocked===!1&&(C.isProtected?it={isLocked:!1}:it=null);we(H,re,it,re===p[3])}}L++}if(fe.length)for(var H=0;H<fe.length;H++)this.parent.serviceLocator.getService("cell").refresh(fe[H][0],fe[H][1]);be.isRandFormula&&this.parent.notify(xt,{action:"refreshRandomFormula"}),this.parent.notify(Oa,null);var Si=i[2]-X,vr=T[2]-X;i[2]=Si,T[2]=vr,this.parent.setUsedRange(i[2],i[3]);var ds=je(T);o===this.parent.activeSheetIndex&&!e.isFromUpdateAction&&this.parent.notify(cu,{address:ds}),!r&&this.copiedInfo.isCut&&(n=this.copiedInfo.isCut,a===this.parent.activeSheetIndex&&this.parent.serviceLocator.getService("cell").refreshRange(p),this.clearCopiedInfo()),(r||F)&&this.copiedInfo&&this.clearCopiedInfo();var Fs=void 0;if(n){Z&&Z.length&&M!=="Values"&&(Fs={range:p,sheetIdx:f,isClear:!0},this.parent.notify(no,Fs)),Yl(C,p[0],p[1],(this.parent.getRow(p[0],null,this.parent.frozenColCount(C))||{offsetHeight:20}).offsetHeight);var Bd=eo(C,p[0]);Ja(this.parent,C,Bd,p[0])}G.length&&o===this.parent.activeSheetIndex&&this.parent.notify(er,{cfModel:G,isAction:!0});var Lu=Pe(this.parent,a);if(!r&&p[0]===p[2]&&y==="Row"){for(var Bd=Lu.rows[p[0]].height,H=h[0];H<=h[2];H++)Ja(this.parent,this.parent.getActiveSheet(),Bd,H);n&&Ja(this.parent,Lu,20,p[0])}if(e.isAction){var j={requestType:"paste",copiedInfo:d,mergeCollection:k,pasteSheetIndex:this.parent.activeSheetIndex,copiedRange:C.name+"!"+(d.range?je(d.range):C.selectedRange),pastedRange:l.name+"!"+je(i),type:M||"All",selectedRange:ds};X&&(j.skipFilterCheck=!0),Fs&&Fs.cfClearActionArgs&&(j.cfClearActionArgs=Fs.cfClearActionArgs),G.length&&(j.cfActionArgs={cfModel:G,sheetIdx:o}),this.parent.notify(yt,{eventArgs:j,action:"clipboard"})}e.focus&&Fe(this.parent.element)}}else this.getClipboardEle().select()},s.prototype.setCF=function(e,t,i,r,n,a){var o=this,l,h,u=function(p){l=[t[0]+(h[0]<=e[0]?0:h[0]-e[0]),t[1]+(h[1]<=e[1]?0:h[1]-e[1]),t[2]-(h[2]>=e[2]?0:e[2]-h[2]),t[3]-(h[3]>=e[3]?0:e[3]-h[3])],r.conditionalFormats||o.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]);var f={range:je(l),type:p.type,cFColor:p.cFColor,value:p.value,format:p.format};r.conditionalFormats.push(f),n.push(f)};if(a)for(var c=0,d=a.length;c<d;c++)h=ee(a[c].range),u(a[c]);else if(a=[],i.conditionalFormats)for(var c=0,d=i.conditionalFormats.length;c<d;c++)h=ee(i.conditionalFormats[c].range),qy([e],i.conditionalFormats[c].range)&&(a.push(i.conditionalFormats[c]),u(i.conditionalFormats[c]));return a},s.prototype.isRangeMerged=function(e,t){var i=Y(e[0],e[1],t);if(i&&(i.colSpan>1||i.rowSpan>1)){var r={range:e.slice(2,4).concat(e.slice(2,4))};return this.parent.notify(cr,r),r.range[0]===e[0]&&r.range[1]===e[1]&&r.range[2]===e[2]&&r.range[3]===e[3]}return!1},s.prototype.updateFilter=function(e,t){var i,r;this.parent.notify(Qp,null);for(var n=0;n<this.parent.sheets.length;n++)if(this.parent.filterCollection&&this.parent.filterCollection[n]&&this.parent.filterCollection[n].sheetIndex===Qn(this.parent,e.sId)){var a=e.range,o=ee(this.parent.filterCollection[n].filterRange);a=lt(a),o[0]===a[0]&&o[2]===a[2]&&o[1]===a[1]&&o[3]===a[3]&&(i=!0,r=[Math.abs(a[0]-o[0]),Math.abs(a[1]-o[1]),Math.abs(a[2]-o[2]),Math.abs(a[3]-o[3])])}var l=this.parent.getCell(e.range[0],e.range[1]);l=l&&(l.querySelector(".e-filter-icon")?l:this.parent.getCell(e.range[2],e.range[3]));var h=l&&l.querySelector(".e-sortasc-filter"),u=l&&l.querySelector(".e-sortdesc-filter");if(i)for(var c=0;c<this.parent.filterCollection.length;c++){var d=this.parent.filterCollection[c],p=e&&e.sId?Qn(this.parent,e.sId):this.parent.activeSheetIndex;if(d.sheetIndex===p&&this.parent.notify(so,{predicates:null,range:d.filterRange,sIdx:p,isCut:!0}),d.sheetIndex===p&&p===this.parent.activeSheetIndex&&(r=[t[0]+r[0],t[1]+r[1],Math.abs(t[2]-r[2]),Math.abs(t[3]-r[3])],this.parent.notify(so,{predicates:null,range:je(r),sIdx:null,isCut:!0}),e.range[3]===e.range[1])){var f=this.parent.getCell(t[0],t[1]);h&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"),u&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter")}}},s.prototype.isInRange=function(e,t,i){var r=this.parent.activeSheetIndex;return Sa(e,t[0],t[1])&&i===r||Sa(e,t[2],t[3])&&i===r},s.prototype.setCell=function(e){var t=this,i=e.sheet,r=i.name===this.parent.getActiveSheet().name;return function(n,a,o,l,h,u){o&&o.formula&&(o.formula.indexOf("RANDBETWEEN(")>-1||o.formula.indexOf("RAND(")>-1||o.formula.indexOf("NOW(")>-1)&&(e.isRandFormula=!0);var c=Tn(t.parent,i,{cell:o,rowIdx:n,colIdx:a,pvtExtend:!h,valChange:!u,lastCell:l,uiRefresh:r,requestType:"paste",skipFormatCheck:!e.isExternal,isRandomFormula:e.isRandFormula});if(!c&&o){if(o.validation){var d=Je(n,a);t.parent.dataValidationRange+=d+":"+d+","}if(o.style&&e.isExternal){var p=qc(t.parent,n,a,i,o.style||t.parent.cellStyle,o.wrap?iv(t.parent.getDisplayText(o),Ad(i,n,a),o.style,t.parent.cellStyle):1);p=Math.round(p),p<20&&(p=20),Yl(i,n,a,p);var f=Ei(i,n),v=eo(i,n),g=v>f;g&&Ja(t.parent,i,v,n)}}return c}},s.prototype.getCopiedIdx=function(){if(this.copiedInfo){for(var e=0;e<this.parent.sheets.length;e++)if(this.parent.sheets[e].id===this.copiedInfo.sId)return e;this.clearCopiedInfo()}return-1},s.prototype.setCopiedInfo=function(e,t){var i=this;if(!this.parent.isEdit){var r=new xa;e.promise=r.promise;var n=this.parent.getActiveSheet(),a;if(e&&e.range){var o=e.range[1]===0&&e.range[3]===n.colCount-1,l=e.range[0]===0&&e.range[2]===n.rowCount-1,h={range:e.range};o||l||this.parent.notify(Vc,h),a=h.range}else a=ee(n.selectedRange);if(e&&!e.isPublic&&!e.clipboardData){var u={copiedRange:n.name+"!"+je(a),cancel:!1,action:t?"cut":"copy"};if(this.parent.notify(li,u),u.cancel)return}var c={sheet:n,indexes:[0,0,n.rowCount-1,n.colCount-1],isFinite:this.parent.scrollSettings.isFinite,promise:new Promise(function(f,v){f(function(){}())})},d=document.getElementsByClassName("e-ss-overlay-active"),p=d.length;n.isLocalData&&!(e&&e.clipboardData)&&a[0]===0&&a[2]===n.rowCount-1&&!p&&(this.parent.showSpinner(),this.parent.notify("updateSheetFromDataSource",c)),this.checkForUncalculatedFormula(a,e&&e.sId?e.sId:n.id),c.promise.then(function(){if(p>0){var f={clientY:d[0].offsetTop,isImage:!0};i.parent.notify(lo,f);var v={clientX:d[0].offsetLeft,isImage:!0};if(i.parent.notify(ho,v),i.copiedShapeInfo={sId:e&&e.sId?e.sId:n.id,sheetIdx:n.index,isCut:t,pictureElem:d[0],copiedRange:je([f.clientY,v.clientX,f.clientY,v.clientX]),height:d[0].offsetHeight,width:d[0].offsetWidth,chartInfo:i.getChartElemInfo(d[0])},!d[0].classList.contains("e-datavisualization-chart")){var g=window.getComputedStyle(d[0]).backgroundImage.slice(5,-2);i.addImgToClipboard(g,i.copiedShapeInfo.height,i.copiedShapeInfo.width)}i.hidePaste(!0),t&&(d[0].classList.contains("e-datavisualization-chart")?i.parent.deleteChart(i.copiedShapeInfo.chartInfo.id):i.parent.notify(Xs,{id:i.copiedShapeInfo.pictureElem.id,sheetIdx:i.copiedShapeInfo.sId,range:i.copiedShapeInfo.copiedRange}))}else e&&e.clipboardData||(i.copiedInfo&&i.clearCopiedInfo(),i.copiedInfo={range:a,sId:e&&e.sId?e.sId:n.id,isCut:t},i.hidePaste(!0),e.isFromUpdateAction||i.initCopyIndicator(),B.isIE||i.getClipboardEle().select(),e&&e.invokeCopy&&document.execCommand(t?"cut":"copy"),i.parent.hideSpinner());B.isIE&&i.setExternalCells(e,t),r.resolve()}),e&&e.clipboardData&&(this.setExternalCells(e,t),this.getClipboardEle().setAttribute("aria-label",n.selectedRange+" "+this.parent.serviceLocator.getService(de).getConstant(t?"Cut":"Copy")))}},s.prototype.imageToCanvas=function(e,t,i){return new Promise(function(r){var n=document.createElement("canvas"),a=n.getContext("2d"),o=new Image;o.src=e,o.crossOrigin="anonymous",o.onload=function(){n.width=i,n.height=t,a.drawImage(o,0,0,i,t),n.toBlob(function(l){r(l)},"image/png")}})},s.prototype.addImgToClipboard=function(e,t,i){return l7(this,void 0,void 0,function(){var r,n,a;return h7(this,function(o){switch(o.label){case 0:return n=window.navigator,[4,this.imageToCanvas(e,t,i)];case 1:return a=o.sent(),[4,n.clipboard.write([new ClipboardItem((r={},r[a.type]=a,r))])];case 2:return o.sent(),[2]}})})},s.prototype.checkForUncalculatedFormula=function(e,t){for(var i,r=Qn(this.parent,t),n=Pe(this.parent,r),a=e[0];a<=e[2];a++)for(var o=e[1];o<=e[3];o++)i=Y(a,o,n,null,!0),i.formula&&Re(i.value)&&this.parent.notify(xt,{action:"refreshCalculate",value:i.formula,rowIndex:a,colIndex:o,isFormula:Bt(i.formula),sheetIndex:r})},s.prototype.getChartElemInfo=function(e){var t=this.parent.chartColl;if(e.classList.contains("e-datavisualization-chart")){for(var i=e.getElementsByClassName("e-control")[0].id,r=0;r<t.length;r++)if(t[r].id===i){var n=t[r];return n}}return null},s.prototype.clearCopiedInfo=function(){this.copiedInfo&&(this.parent.getActiveSheet().id===this.copiedInfo.sId&&(this.removeIndicator(this.parent.getSelectAllContent()),this.removeIndicator(this.parent.getColumnHeaderContent()),this.removeIndicator(this.parent.getRowHeaderContent()),this.removeIndicator(this.parent.getMainContent())),this.copiedInfo=null,this.hidePaste()),this.copiedShapeInfo&&(this.copiedShapeInfo=null,this.hidePaste())},s.prototype.removeIndicator=function(e){if(e){var t=e.getElementsByClassName("e-copy-indicator")[0];t&&ne(t)}},s.prototype.initCopyIndicator=function(){if(this.copiedInfo&&this.parent.getActiveSheet().id===this.copiedInfo.sId){var e=this.parent.createElement("div",{className:"e-copy-indicator"});e.appendChild(this.parent.createElement("div",{className:"e-top"})),e.appendChild(this.parent.createElement("div",{className:"e-bottom"})),e.appendChild(this.parent.createElement("div",{className:"e-left"})),e.appendChild(this.parent.createElement("div",{className:"e-right"})),ws(this.parent,e,this.copiedInfo.range,"e-copy-indicator")}},s.prototype.showDialog=function(){var e=this;this.parent.serviceLocator.getService(At).show({header:"Spreadsheet",height:205,width:340,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(de).getConstant("PasteAlert"),beforeOpen:function(t){var i={dialogName:"PasteDialog",element:t.element,target:t.target,cancel:t.cancel};e.parent.trigger("dialogBeforeOpen",i),i.cancel&&(t.cancel=!0)}})},s.prototype.hidePaste=function(e){this.parent.getActiveSheet().isProtected&&(e=!1),this.parent.notify(nh,[{items:[this.parent.element.id+"_paste"],enable:e||!1}])},s.prototype.setExternalCells=function(e,t){var i,r,n="",a,o=this.parent.getActiveSheet(),l=lt(this.copiedInfo.range),h=l[1]===0&&l[3]===o.colCount-1,u=l[0]===0&&l[2]===o.rowCount-1,c='<html><body><table class="e-spreadsheet" xmlns="http://www.w3.org/1999/xhtml"';(h||u)&&(c+=' aria-rowcount="'+o.usedRange.rowIndex+'" aria-colcount="'+o.usedRange.colIndex+'"',c+=' aria-label="'+(h&&u?"Sheet":h?"Row":"Column")+'"'),c+="><tbody>";for(var d=l[0];d<=l[2];d++)if(!(!t&&Aa(o,d))){c+="<tr>";for(var p=l[1];p<=l[3];p++)if(i=Y(d,p,o,!1,!0),!(i.colSpan<0||i.rowSpan<0)){if(c+="<td",i.colSpan&&(c+=' colspan="'+i.colSpan+'"'),i.rowSpan&&(c+=' rowspan="'+i.rowSpan+'"'),i.style?(a="",i.style.whiteSpace||(a+="white-space:"+(i.wrap?"normal":"nowrap")+";"),i.style.verticalAlign||(a+="vertical-align:bottom;"),Object.keys(i.style).forEach(function(v){var g=v.match(/[A-Z]/);a+=(v==="backgroundColor"?"background":g?v.replace(g[0],"-"+g[0].toLowerCase()):v)+":"+(v==="backgroundColor"||v==="color"?i.style[""+v].slice(0,7):i.style[""+v])+";"}),c+=a.includes('"')?" style='"+a+"'":' style="'+a+'"'):c+=' style="white-space:'+(i.wrap?"normal":"nowrap")+';vertical-align:bottom;"',m(i.value))c+="></td>";else{if(r=i.value,i.format&&i.format!=="General"){c+=i.value.toString().includes('"')?" cell-value='"+r+"'":' cell-value="'+i.value+'"',c+=i.format.includes('"')?" num-format='"+i.format+"'":' num-format="'+i.format+'"';var f={formattedText:r,value:r,format:i.format,cell:i,rowIndex:d,colIndex:p};this.parent.notify(jn,f),r=f.formattedText}c+=">",c+=r,n+=r,c+="</td>"}n+=p===l[3]?"":"	"}c+="</tr>",n+=d===l[2]?"":`
`}c+="</tbody></table></body></html>",B.isIE?(window.clipboardData.setData("text",n),t&&window.clipboardData.setData("isInternalCut",n)):(e.clipboardData.setData("text/html",c),e.clipboardData.setData("text/plain",n),t&&e.clipboardData.setData("isInternalCut",n),e.preventDefault())},s.prototype.getExternalCells=function(e){var t=this,i,r,n=[],a={model:n},o=this.parent.createElement("span"),l=function(){return setTimeout(function(){t.getClipboardEle().innerHTML=""},0)};if(B.isIE)r=window.clipboardData.getData("text");else{if(i=e.clipboardData.getData("text/html"),r=e.clipboardData.getData("text/plain"),this.copiedInfo&&i.includes('<table class="e-spreadsheet"')){var h=!1;if(!this.copiedInfo.isCut){var u=this.parent.filterCollection;if(u)for(var c=0;c<u.length;c++){var d=ee(u[c].filterRange),p=this.copiedInfo.range;if(d[0]===p[0]&&d[1]===p[1]&&d[2]===p[2]&&d[3]===p[3]){h=!0;break}}}if(!h)return l(),{internal:!0}}o.innerHTML=i}if(o.querySelector("table"))this.generateCells(o,a);else if(o.querySelector("img")){var f=o.querySelector("img");this.parent.notify(Da,{options:{src:f.src,height:f.height,width:f.width},isPublic:!0})}else if(r){var v=[],g,b,y;i&&(b=[].slice.call(o.children));var C=this.cellStyle(o);a.colCount=1,r.split(`
`).forEach(function(x){g=null,i&&(y=b.filter(function(w){return w.textContent&&w.textContent.replace(/(\r\n|\n|\r|\s)/gm," ").trim()===x.trim()})[0],y&&(g=C(y),b.splice(b.indexOf(y),1))),x.split("	").forEach(function(w,M){(w||g)&&(v[M]={},g&&(g.whiteSpace&&g.whiteSpace!=="nowrap"?(v[M].wrap=!0,delete g.whiteSpace,Object.keys(g).length&&(v[M].style=g)):v[M].style=g),w&&(Bt(w)?v[M].formula=w:v[M].value=Uc(w.trim())))}),n.push({cells:v}),a.colCount=Math.max(a.colCount,v.length),v=[]}),a.rowCount=n.length,a.usedRowIndex=n.length-1,a.usedColIndex=a.colCount-1}else if(e.clipboardData.files&&e.clipboardData.files[0]&&e.clipboardData.files[0].type.includes("image"))return l(),{file:e.clipboardData.files[0]};return l(),a},s.prototype.generateCells=function(e,t){var i=t.model,r=e.querySelector("table"),n=r.classList.contains("e-spreadsheet");t.usedRowIndex=r.rows.length-1,t.rowCount=r.rows.length,n&&(t.selection=r.getAttribute("aria-label"),t.selection&&(t.selection==="Sheet"?(t.usedRowIndex=Number(r.getAttribute("aria-rowcount")),t.usedColIndex=Number(r.getAttribute("aria-colcount"))):t.selection==="Row"?t.usedColIndex=Number(r.getAttribute("aria-colcount")):t.usedRowIndex=Number(r.getAttribute("aria-rowcount"))));var a=this.cellStyle(e,n),o,l,h,u,c=1,d,p,f;t.colCount=1;for(var v=0,g=t.usedRowIndex;v<=g;v++){o=r.rows[v],i[v]||(i[v]={cells:[]}),l=i[v].cells,t.colCount=Math.max(t.colCount,o.cells.length),d=t.usedColIndex<o.cells.length?t.usedColIndex:o.cells.length-1;for(var b=0;b<=d;b++){if(u=o.cells[b],f=b,l[b]&&(b=this.getNewIndex(l,b)),l[b]={},h=a(u),u.textContent=u.textContent.replace(/(\r\n|\n|\r)/gm,""),u.textContent=u.textContent.replace(/\s+/g," "),h.whiteSpace&&h.whiteSpace!=="nowrap"&&(l[b].wrap=!0,delete h.whiteSpace),Object.keys(h).length&&(h.border&&(["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(E){h[""+E]=h.border}),delete h.border),l[b].style=h),u.textContent&&(l[b].value=Uc(u.textContent.trim())),p=n?"num-format":"number-format",u.getAttribute(p)&&(l[b].format=u.getAttribute(p),l[b].value&&u.getAttribute("cell-value")&&(l[b].value=Uc(u.getAttribute("cell-value").trim()))),u.getAttribute("colspan")&&parseInt(u.getAttribute("colspan"),10)>1&&(l[b].colSpan=parseInt(u.getAttribute("colspan"),10)),u.getAttribute("rowspan")&&parseInt(u.getAttribute("rowspan"),10)>1&&(l[b].rowSpan=parseInt(u.getAttribute("rowspan"),10)),l[b].colSpan>1&&l[b].rowSpan>1)for(var y=void 0,C=v,x=v+l[b].rowSpan;C<x;C++)for(var w=b,M=b+l[b].colSpan;w<M;w++)C===v&&w===b||(y=l[b].style?{style:me({},l[b].style)}:{},C!==v&&(y.rowSpan=v-C),w!==b&&(y.colSpan=b-w),i[C]||(i[C]={cells:[]}),i[C].cells[w]=y);else if(l[b].colSpan>1)for(var C=b+1,x=b+l[b].colSpan;C<x;C++)l[C]={colSpan:b-C,style:me({},h)};else if(l[b].rowSpan>1)for(var C=v+1,x=v+l[b].rowSpan;C<x;C++)i[C]||(i[C]={cells:[]}),i[C].cells[b]={rowSpan:v-C,style:me({},h)};b=f}c=Math.max(c,l.length)}t.usedColIndex=c-1},s.prototype.getNewIndex=function(e,t){return e[t]&&(t++,t=this.getNewIndex(e,t)),t},s.prototype.cellStyle=function(e,t){var i,r;if(!t){i=e.querySelector("style")&&e.querySelector("style").innerHTML;var n=Object.keys(this.parent.commonCellStyle);if(n&&n.length&&i){var a=i.includes("td")?i.split("td")[1]:i;a=a.includes("{")?a.split("{")[1].split("}")[0]:a.split("}")[0],r={};for(var o=0;o<n.length;o++){var l=n[o],h=l.match(/[A-Z]/);h&&(l=l.replace(h[0],"-"+h[0].toLowerCase())),a.indexOf(l)>-1&&(r[n[o]]=a.split(l+":")[1].split(";")[0].trim())}}}return function(u){var c={},d;if(t)if(u.getAttribute("style"))d=u.getAttribute("style").split(";");else return c;else{if(d=[],i&&u.className&&i.includes(u.classList[0])){var p=i.split(u.classList[0]);d.push(p[p.length-1].split("{")[1].split("}")[0])}var f=[].slice.call(u.querySelectorAll("*"));f.unshift(u),f.forEach(function(T){T.getAttribute("style")&&d.push(T.getAttribute("style")),T.tagName==="B"&&d.push("font-weight:bold"),T.tagName==="I"&&d.push("font-style:italic"),T.tagName==="U"&&d.push("text-decoration:underline")}),Object.assign(c,r)}if(d.length){var v,g,b,y,C,x=["font-family","vertical-align","text-align","text-indent","color","white-space","font-weight","font-style","font-size","text-decoration","background"],w=["fontFamily","verticalAlign","textAlign","textIndent","color","whiteSpace","fontWeight","fontStyle","fontSize","textDecoration","backgroundColor"],M=["border-bottom","border-top","border-right","border-left","border"],E=["borderBottom","borderTop","borderRight","borderLeft","border"];d.forEach(function(T){T.split(";").forEach(function(D){if(g=D.split(":")[0].trim(),v=x.indexOf(g),v>-1)g=D.split(":")[1].trim(),c[w[v]]=g;else if(v=M.indexOf(g),v>-1){if(g=D.split(":")[1].trim(),g==="none")g=void 0;else if(g.includes("pt")){b=g.split("pt"),y=b[0].split(" ");for(var N=0;N<y.length;N++)if(C=parseFloat(y[N]),C){y.splice(N,1),y.unshift((C/.75).toFixed(2)+"px"),b[0]=y.join(" ");break}g=b.join("")}c[E[v]]=g}})})}return u.querySelector("S")&&(c.textDecoration=c.textDecoration?"underline line-through":"line-through"),c.textDecoration&&["underline","line-through","underline line-through","none"].indexOf(c.textDecoration)===-1&&(c.textDecoration="none"),c.textAlign&&["left","center","right"].indexOf(c.textAlign)===-1&&(c.textAlign="left"),c.verticalAlign&&["bottom","middle","top"].indexOf(c.verticalAlign)===-1&&(c.verticalAlign="bottom"),c.fontSize&&(c.fontSize=Math.round(parseFloat(c.fontSize.indexOf("px")>-1?(parseFloat(c.fontSize)*.75).toString():c.fontSize))+"pt"),c.fontWeight&&["bold","normal"].indexOf(c.fontWeight)===-1&&(c.fontWeight=c.fontWeight>"599"?"bold":"normal"),c}},s.prototype.refreshOnInsertDelete=function(e){if(this.copiedInfo){if(e.model.id!==this.copiedInfo.sId)return;var t=this.copiedInfo.range;if(e.isInsert){if(e.modelType==="Column"){if(e.start<=t[3]){if(e.start<=t[1]){var i=e.end-e.start+1;t[1]+=i,t[3]+=i}else t[3]=t[1]+(e.start-t[1]-1);this.performAction()}}else if(e.start<=t[2]){if(e.start<=t[0]){var i=e.end-e.start+1;t[0]+=i,t[2]+=i}else t[2]=t[1]+(e.start-t[1]-1);this.performAction()}}else this.clearCopiedInfo()}},s.prototype.performAction=function(){var e=this.getCopyIndicator();e&&ws(this.parent,e,this.copiedInfo.range,"e-copy-indicator")},s.prototype.getClipboardEle=function(){return this.parent.element.getElementsByClassName("e-clipboard")[0]},s.prototype.getCopyIndicator=function(){return this.parent.element.getElementsByClassName("e-copy-indicator")[0]},s.prototype.getModuleName=function(){return"clipboard"},s.prototype.destroy=function(){this.removeEventListener();var e=this.getClipboardEle();ne(e),this.parent=null},s}(),c7=function(){function s(e){this.editorElem=null,this.editCellData={},this.isEdit=!1,this.isCellEdit=!0,this.isNewValueEdit=!0,this.isAltEnter=!1,this.validCharacters=["+","-","*","/",",","(","=","&",":"],this.formulaBarCurStartPos=null,this.curEndPos=null,this.curStartPos=null,this.selectionStart=null,this.selectionEnd=null,this.uniqueColl="",this.uniqueActCell="",this.isSpill=!1,this.keyCodes={BACKSPACE:8,SPACE:32,TAB:9,DELETE:46,ESC:27,ENTER:13,FIRSTALPHABET:65,LASTALPHABET:90,FIRSTNUMBER:48,LASTNUMBER:59,FIRSTNUMPAD:96,LASTNUMPAD:111,SYMBOLSETONESTART:186,SYMBOLSETONEEND:192,SYMBOLSETTWOSTART:219,SYMBOLSETTWOEND:222,FIREFOXEQUALPLUS:61,FIREFOXMINUS:173,F2:113},this.formulaErrorStrings=["mismatched parentheses","requires 3 arguments","improper formula","empty expression","mismatched string quotes","wrong number of arguments","invalid arguments"],this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.isEdit&&this.cancelEdit(!0,!1),this.removeEventListener(),this.parent=null,this.editorElem=null},s.prototype.addEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?I.add(this.parent.element,"touchend",this.tapHandler,this):I.add(this.parent.element,"dblclick",this.dblClickHandler,this),this.parent.on(Qo,this.mouseDownHandler,this),this.parent.on(Xn,this.keyUpHandler,this),this.parent.on(Ra,this.keyDownHandler,this),this.parent.on(Jt,this.performEditOperation,this),this.parent.on(l0,this.initiateCurPosition,this),this.parent.on(h0,this.updateFormulaBarValue,this),this.parent.on(zh,this.addressHandler,this),this.parent.on(hM,this.initiateRefSelection,this),this.parent.on(Ec,this.refSelectionRender,this),this.parent.on(ou,this.checkUniqueRange,this),this.parent.on(Dy,this.reApplyFormula,this),this.parent.on(fu,this.sheetChangeHandler,this)},s.prototype.removeEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?I.remove(this.parent.element,"touchend",this.tapHandler):I.remove(this.parent.element,"dblclick",this.dblClickHandler),this.parent.isDestroyed||(this.parent.off(Qo,this.mouseDownHandler),this.parent.off(Xn,this.keyUpHandler),this.parent.off(Ra,this.keyDownHandler),this.parent.off(Jt,this.performEditOperation),this.parent.off(l0,this.initiateCurPosition),this.parent.off(h0,this.updateFormulaBarValue),this.parent.off(zh,this.addressHandler),this.parent.off(hM,this.initiateRefSelection),this.parent.off(Ec,this.refSelectionRender),this.parent.off(ou,this.checkUniqueRange),this.parent.off(Dy,this.reApplyFormula),this.parent.off(fu,this.sheetChangeHandler))},s.prototype.getModuleName=function(){return"edit"},s.prototype.performEditOperation=function(e){var t=e.action;switch(t){case"renderEditor":if(this.renderEditor(),e.initLoad&&B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)){var i=this.parent.createElement("div",{className:"e-ss-focus-edit",attrs:{contentEditable:"true",inputmode:"none",tabindex:"-1"}}),r=this.parent.element.querySelector(".e-sheet-panel");r&&(r.style.position="relative",r.appendChild(i)),this.parent.element.onfocus=function(){Fe(i)}}break;case"refreshEditor":this.refreshEditor(e.value,e.refreshFormulaBar,e.refreshEditorElem,e.isAppend,e.trigEvent),e.refreshCurPos&&this.setCursorPosition();break;case"startEdit":if(!this.isEdit)this.isNewValueEdit=e.isNewValueEdit,this.startEdit(e.address,e.value,e.refreshCurPos);else{var n=!1,a={isEdit:n};this.parent.notify(bd,a),a.isEdit&&(this.isNewValueEdit=e.isNewValueEdit,this.startEdit(e.address,e.value,e.refreshCurPos))}break;case"endEdit":this.isEdit&&this.endEdit(e.refreshFormulaBar,null,e.isPublic);break;case"cancelEdit":this.isEdit&&this.cancelEdit(e.refreshFormulaBar);break;case"getCurrentEditValue":e.editedValue=this.editCellData.value,e.endFormulaRef!==void 0&&(e.endFormulaRef=this.endFormulaRef);break;case"refreshDependentCellValue":this.refreshDependentCellValue(e.rowIdx,e.colIdx,e.sheetIdx);break;case"getElement":e.element=this.getEditElement(this.parent.getActiveSheet());break;case"focusEditorElem":this.editorElem.focus();break;case"getCurrentEditSheetIdx":e.sheetIndex=this.editCellData.sheetIndex;break}},s.prototype.keyUpHandler=function(e){if(this.isEdit){var t=this.getEditElement(this.parent.getActiveSheet());e.altKey&&e.keyCode===13?(t.focus(),this.altEnter(),this.isAltEnter=!0):this.isCellEdit&&this.editCellData.value!==t.textContent&&e.keyCode!==16&&(!e.shiftKey||e.shiftKey&&!Gh(e.keyCode))&&this.refreshEditor(t.textContent,this.isCellEdit);var i=Bt(this.editCellData.value,!0);if(i&&(!e||e.keyCode!==16&&(!e.shiftKey||e.shiftKey&&!Gh(e.keyCode)))&&(this.updateFormulaReference(t),this.endFormulaRef)){var r=this.getCurPosition();r.end&&this.validCharacters.indexOf(this.editCellData.value[r.end-1])>-1&&(this.endFormulaRef=!1)}}},s.prototype.updateFormulaReference=function(e){var t=this.parent.element.querySelector(".e-formularef-indicator");t&&t.parentElement.removeChild(t),this.editCellData.value!==e.textContent&&this.refreshEditor(e.textContent,!0);var i=this.editCellData.sheetIndex,r=this.editCellData.value;this.parent.notify(Nh,{range:r,formulaSheetIdx:i})},s.prototype.keyDownHandler=function(e){var t=e.target,i=e.keyCode,r=this.parent.getActiveSheet(),n=xe(r.activeCell),a=Y(n[0],n[1],r,!1,!0);if(!U(t,".e-spreadsheet .e-dialog")){if(!r.isProtected||t.classList.contains("e-sheet-rename")||!Cn(a,oi(r,n[1]))||t.classList.contains("e-formula-bar")&&!t.disabled){if(this.isEdit){var o=this.getEditElement(r),l=Bt(this.editCellData.value,!0);if((this.isCellEdit||l&&this.editCellData.value!==o.textContent&&e.keyCode!==16)&&(n[1]<this.parent.frozenColCount(r)&&(!r.frozenRows||n[0]>=this.parent.frozenRowCount(r))&&o&&o.style.height!=="auto"&&_r(o.textContent,a.style,this.parent.cellStyle)>parseInt(o.style.maxWidth,10)&&(o.style.height="auto"),_r(o.textContent,a.style,this.parent.cellStyle)>parseInt(o.style.maxWidth,10)-5&&(o.style.height="auto"),n[0]<this.parent.frozenRowCount(r)&&o&&!o.style.overflow&&_r(o.textContent,a.style,this.parent.cellStyle)>parseInt(o.style.maxWidth,10)&&(o.style.overflow="auto"),(!e.shiftKey||e.shiftKey&&!Gh(e.keyCode))&&this.refreshEditor(o.textContent,this.isCellEdit,!1,!1,!1)),!e.altKey)switch(i){case this.keyCodes.ENTER:if(B.isWindows&&e.preventDefault(),this.isAltEnter){var h=o.textContent;h&&h.indexOf(`
`)>-1&&(_c(this.parent.getActiveSheet().selectedRange,!0,this.parent,!0),this.refreshEditor(o.textContent,this.isCellEdit,!1,!1,!1),this.isAltEnter=!1)}if(!l)this.endEdit(!1,e);else{var u=this.parent.element.querySelector(".e-formularef-indicator");u&&u.parentElement.removeChild(u),Pe(this.parent,this.editCellData.sheetIndex).id===r.id?this.endEdit(!1,e):(this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,e))}break;case this.keyCodes.TAB:this.hasFormulaSuggSelected()||this.endEdit(!1,e);break;case this.keyCodes.ESC:this.cancelEdit(!0,!0,e);break}}else if(t.classList.contains("e-spreadsheet")||U(t,".e-sheet-panel")){i===13&&t.contentEditable==="true"&&e.preventDefault();var c=String.fromCharCode(i),d=i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||c.toLowerCase()!==c.toUpperCase()&&!(i>=112&&i<=123),p=i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER,f=i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD,v=i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND;v||(v=i>=this.keyCodes.SYMBOLSETTWOSTART&&i<=this.keyCodes.SYMBOLSETTWOEND);var g=i===this.keyCodes.FIREFOXEQUALPLUS||i===this.keyCodes.FIREFOXMINUS,b=!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&i===this.keyCodes.F2,y=i===this.keyCodes.BACKSPACE,C=/(Macintosh|MacIntel|MacPPC|Mac68K|Mac|Mac OS|iPod|iPad)/i.test(navigator.userAgent)&&y;if(!e.ctrlKey&&!e.metaKey&&!e.altKey&&(!e.shiftKey&&i===this.keyCodes.SPACE||d||p||f||v||B.info.name==="mozilla"&&g)||b||y){b&&(this.isNewValueEdit=!1);var x=this.parent.element.getElementsByClassName("e-ss-overlay-active");x.length?y&&!C&&this.editingHandler("delete"):(this.startEdit(null,null,!0,!0),Fe(this.getEditElement(r)))}if(i===this.keyCodes.DELETE||C){var w=r.isProtected&&ah(this.parent);w?this.parent.notify(Ta,null):(this.editingHandler("delete"),this.parent.notify(sa,null))}}}else if((i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER||i===this.keyCodes.DELETE||i===this.keyCodes.BACKSPACE||i===this.keyCodes.SPACE||i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD||i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND||i>=219&&i<=222||!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&i===this.keyCodes.F2)&&i!==67&&i!==89&&i!==90){if(r.protectSettings.insertLink&&i===75)return;!e.ctrlKey&&e.keyCode!==70&&!this.parent.element.querySelector(".e-editAlert-dlg")&&!t.parentElement.classList.contains("e-unprotectpwd-content")&&!t.parentElement.classList.contains("e-password-content")&&!t.parentElement.classList.contains("e-sheet-password-content")&&!t.parentElement.classList.contains("e-unprotectsheetpwd-content")&&!t.parentElement.classList.contains("e-reenterpwd-content")&&this.parent.notify(Ta,null)}}},s.prototype.renderEditor=function(){if(!this.editorElem||!$("#"+this.parent.element.id+"_edit",this.parent.element)){var e=this.parent.createElement("div",{id:this.parent.element.id+"_edit",className:"e-spreadsheet-edit",attrs:{contentEditable:"true",role:"textbox",spellcheck:"false","aria-multiline":"true"}});this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0]&&this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0].remove();var t=this.parent.element.querySelector(".e-sheet-content");if(!t)return;t.appendChild(e),this.editorElem=e}this.parent.notify(Ho,{action:"renderAutoComplete"})},s.prototype.refreshEditor=function(e,t,i,r,n){n===void 0&&(n=!0),r?e=this.editCellData.value=this.editCellData.value+e:this.editCellData.value=e;var a=this.getEditElement(this.parent.getActiveSheet());i&&a&&(a.textContent=e),t&&this.parent.notify(Po,{action:"refreshFormulabar",value:e}),this.parent.isEdit&&a&&n&&this.editCellData.value===a.textContent&&this.triggerEvent("cellEditing").cancel&&this.cancelEdit()},s.prototype.startEdit=function(e,t,i,r){i===void 0&&(i=!0),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true");var n=this.parent.getActiveSheet(),a=xe(n.activeCell),o=Y(a[0],a[1],n,!1,!0);if(uz(this.parent,a[0],a[1],this.parent.activeSheetIndex)){var l=this.parent.getCell(a[0],a[1]),h=!1,u=l.innerHTML;if(l&&u.indexOf("<")>-1&&u.indexOf(">")>-1&&u.indexOf("input")>-1&&(h=!0),h)return}var c=this.updateEditCellDetail(e,t);this.initiateEditor(i,c),this.positionEditor(),this.parent.isEdit=this.isEdit=!0,this.parent.notify(Cd,null),this.parent.notify(nh,[{enable:!1}]),o.formula&&!r&&this.parent.notify(Nh,{range:o.formula,formulaSheetIdx:this.editCellData.sheetIndex})},s.prototype.setCursorPosition=function(){var e=this.getEditElement(this.parent.getActiveSheet()),t=e.textContent.length;if(t){var i=document.getSelection(),r=document.createRange();r.setStart(e.firstChild,t),r.collapse(!0),i.removeAllRanges(),i.addRange(r)}e.focus()},s.prototype.hasFormulaSuggSelected=function(){var e=document.getElementById(this.parent.element.id+"_ac_popup");return e&&e.style.visibility==="visible"&&e.querySelectorAll(".e-item-focus").length>0},s.prototype.editingHandler=function(e){var t=document.getElementsByClassName("e-ss-overlay-active"),i=t.length,r;switch(e){case"delete":if(i>0)t[0].classList.contains("e-datavisualization-chart")?this.parent.notify(gu,{id:t[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.parent.notify(Xs,{id:t[0].id,sheetIdx:this.parent.activeSheetIndex+1});else{var n=this.parent.getActiveSheet(),a=n.selectedRange,o=ir(a);o=o[0]>o[2]||o[1]>o[3]?lt(o):o,a=je(o);var l={address:n.name+"!"+a,cancel:!1};if(this.parent.notify(li,{action:"cellDelete",eventArgs:l}),l.cancel)return;a=nu(l.address),o=ee(a),dz(this.parent,o,this.parent.activeSheetIndex),this.parent.notify(Gs,{}),o[0]===0&&o[1]===0&&o[2]>=n.usedRange.rowIndex&&o[3]>=n.usedRange.colIndex&&this.parent.setUsedRange(0,0,n,!1,!0);var h={cellIdx:o,isUnique:!1};if(this.checkUniqueRange(h),h.isUnique){var u=ee(this.uniqueColl),c=Y(u[0],u[1],this.parent.getActiveSheet());c&&c.value&&(r=c.value.toString().indexOf("#SPILL!")>-1)}if(h.isUnique&&this.uniqueColl.split(":")[0]===a.split(":")[0]){for(var d=ee(this.uniqueColl),p=d[0];p<=d[2];p++)for(var f=d[1];f<=d[3];f++)this.parent.updateCell({value:"",formula:""},je([p,f]));this.parent.notify(ud,null),this.uniqueColl=""}else if(h.isUnique){var v=ee(this.uniqueColl);if(Y(v[0],v[1],n).value==="#SPILL!"){for(var g=!1,f=v[0];f<=v[2];f++)for(var b=v[1];b<=v[3];b++){var c=Y(f,b,n);f===v[0]&&b===v[1]?g=!1:c&&!m(c.value)&&c.value!==""&&(g=!0)}g||this.reApplyFormula()}}h.isUnique?this.parent.notify(yt,{action:"cellDelete",eventArgs:{address:n.name+"!"+a,isSpill:r}}):this.parent.notify(yt,{action:"cellDelete",eventArgs:{address:n.name+"!"+a}})}break}},s.prototype.getCurPosition=function(){var e={},t=window.getSelection();if(this.editorElem.textContent===this.editCellData.value&&(e.start=t.anchorOffset,e.end=t.focusOffset,e.start>e.end)){var i=e.start;e.start=e.end,e.end=i}if(t&&t.focusNode&&t.focusNode.classList&&t.focusNode.classList.contains("e-formula-bar-panel")&&this.editorElem.textContent===this.editCellData.value){var r=t.focusNode.getElementsByClassName("e-formula-bar e-css")[0];e.start=r.selectionStart,e.end=r.selectionEnd}return e},s.prototype.mouseDownHandler=function(e){if(!U(e.target,".e-findtool-dlg")&&!U(e.target,".e-validation-error-dlg")&&this.isEdit){var t=this.getCurPosition();t.start&&(this.curStartPos=this.selectionStart=t.start),t.end&&(this.curEndPos=this.selectionEnd=t.end);var i=e.target,r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-formularef-indicator");this.isCellEdit=i.classList.contains("e-spreadsheet-edit");var a=Bt(this.editCellData.value,!0),o=this.getEditElement(r);if(i.classList.contains("e-cell")||i.classList.contains("e-header-cell")||i.classList.contains("e-selectall")||U(i,".e-toolbar-item.e-active")||U(i,".e-table")){if(this.isAltEnter){var l=o.textContent;l&&l.indexOf(`
`)>-1&&(this.isAltEnter=!1,_c(this.parent.getActiveSheet().selectedRange,!0,this.parent),this.refreshEditor(o.textContent,this.isCellEdit))}if(!a||this.endFormulaRef)this.endFormulaRef=!1,this.endEdit(!1,e);else{var h=this.selectionEnd,u=xe(r.activeCell),c=Y(u[0],u[1],r);if(this.selectionStart!==this.selectionEnd&&this.editCellData.value===o.textContent&&this.validCharacters.indexOf(o.textContent.substring(this.selectionStart-1,this.selectionStart))!==-1&&ur(o.textContent.substring(this.selectionStart,this.selectionEnd))&&o.textContent.indexOf(":")!==this.selectionEnd&&(this.editCellData.value=o.textContent.substring(0,this.selectionStart)+o.textContent.substring(this.selectionEnd,o.textContent.length)),this.editCellData.value===o.textContent&&o.textContent.indexOf("(")!==o.textContent.length-1&&o.textContent.indexOf("(")!==-1&&this.selectionStart===this.selectionEnd){if(this.editCellData.sheetIndex!==gt(this.parent,r.name)){var d=this.parent.element.querySelector(".e-formula-bar");if(o.textContent.substring(d.selectionEnd-1,d.selectionEnd)!==","&&!e.shiftKey){n&&n.parentElement.removeChild(n),this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,e);return}}else if(this.validCharacters.indexOf(o.textContent.substring(h-1,h))===-1){n&&n.parentElement.removeChild(n),this.endEdit(!1,e);return}}if(!c)return;if(a=c.formula?Bt(Y(u[0],u[1],r).formula)||this.editCellData.value&&this.editCellData.value.toString().indexOf("=")===0:!1,a&&this.parent.isEdit){var p=this.selectionEnd;this.editCellData.value.length===p?(this.editCellData.value.substring(this.editCellData.value.length-1)===")"||He(this.editCellData.value.substring(this.editCellData.value.length-1)))&&(n&&n.parentElement.removeChild(n),this.endEdit(!1,e)):this.editCellData.value===o.textContent&&(this.validCharacters.indexOf((this.editCellData.value+r.selectedRange).substring(p-1,p))===-1?(n&&n.parentElement.removeChild(n),this.endEdit(!1,e)):(this.validCharacters.indexOf(o.textContent.substring(p-1,p))===-1||o.textContent.substring(p,p+1)!==")"&&this.validCharacters.indexOf(o.textContent.substring(p,p+1))===-1)&&(n&&n.parentElement.removeChild(n),this.endEdit(!1,e)))}}}else if(a&&this.editCellData.value===o.textContent&&o.textContent.indexOf("(")!==o.textContent.length-1&&!this.isCellEdit&&this.validCharacters.indexOf(this.editCellData.value.substring(this.selectionStart-1,this.selectionStart))===-1&&Pe(this.parent,this.editCellData.sheetIndex).id===r.id){var h=window.getSelection().focusOffset;if(this.validCharacters.indexOf(o.textContent.substring(h-1,h))===-1){n&&n.parentElement.removeChild(n),this.parent.goTo(this.editCellData.fullAddr),this.isEdit&&this.endEdit(!1,e);return}}}},s.prototype.tapHandler=function(e){var t=this;if(!this.tapedTwice){this.tapedTwice=!0,setTimeout(function(){if(t.tapedTwice=!1,!t.parent.isEdit&&e.target.classList.contains("e-cell")){var i=t.parent.element.querySelector(".e-ss-focus-edit");i&&Fe(i)}},300);return}e.preventDefault(),this.dblClickHandler(e)},s.prototype.dblClickHandler=function(e){var t=e.target;if(!U(t,".e-datavisualization-chart")&&!t.classList.contains("e-ss-overlay")&&(t.classList.contains("e-active-cell")||t.classList.contains("e-cell")||t.classList.contains("e-wrap-content")||U(t,".e-sheet-content")||t.classList.contains("e-table"))){var i=this.parent.getActiveSheet(),r=xe(i.activeCell),n=Y(r[0],r[1],i,!1,!0);if(!i.isProtected||!Cn(n,oi(i,r[1])))if(this.isEdit){if(!t.classList.contains("e-spreadsheet-edit"))if(Bt(this.editCellData.value)){var a=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));this.parent.getActiveSheet().name===a&&this.endEdit()}else this.endEdit()}else this.isNewValueEdit=!1,this.startEdit(),Fe(this.getEditElement(i));else this.parent.notify(Ta,null)}},s.prototype.updateEditCellDetail=function(e,t){var i,r,n;if(m(this.editCellData.sheetIndex)?e&&e.split("!").length>1?i=gt(this.parent,Ms(e)):i=this.parent.activeSheetIndex:i=this.editCellData.sheetIndex,this.editCellData.addr?Bt(this.editCellData.value,!0)&&(r=Pe(this.parent,i),this.isNewValueEdit=!1):(r=Pe(this.parent,i),e?e=nu(e):e=r.activeCell),e){var a=ee(e),o=a[0],l=a[1],h=Y(o,l,r,!1,!0);if(h.colSpan>1||h.rowSpan>1){var u={sheet:r,cell:h,rowIdx:o,colIdx:l};bb(u),o=u.rowIdx,l=u.colIdx,n=u.isMergedHiddenCell}var c=this.parent.getCell(o,l),d=Cb(r,a,this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth);this.editCellData={addr:e,fullAddr:Ns(this.parent,i)+"!"+e,rowIndex:o,colIndex:l,sheetIndex:i,element:c,value:t||"",position:d}}return n},s.prototype.initiateEditor=function(e,t){var i=this;$s(this.parent,this.editCellData.fullAddr,!1,t).then(function(r){i.parent&&r.forEach(function(n){var a,o=function(){var h={cell:n,value:n?n.value:"",showFormattedText:i.editCellData.showFormattedText};i.parent.notify(Iy,h),a=n?n.formula||h.value:"",i.editCellData.oldValue=a};o();var l=i.triggerEvent("cellEdit",null,a);if(l.cancel){i.cancelEdit(!0,!1);return}l.showFormattedText&&(i.editCellData.showFormattedText=!0,o()),i.editCellData.value?a=i.editCellData.value:i.editCellData.value=a,i.isNewValueEdit?a="":i.isNewValueEdit=!0,Re(a)||i.refreshEditor(a,!1,!0,!1,!1),e&&i.setCursorPosition()})})},s.prototype.positionEditor=function(e){var t=this.editCellData.element,i=!1,r,n={isEdit:i};if(this.parent.notify(bd,n),n.isEdit&&m(t)&&(r=this.parent.getCell(this.editCellData.rowIndex,this.editCellData.colIndex),t=r,this.editCellData.element=r),t){t.classList.add("e-ss-edited");var a=this.parent.getActiveSheet(),o=Y(this.editCellData.rowIndex,this.editCellData.colIndex,a,!1,!0),l=this.editCellData.position.left+1,h=this.editCellData.position.top+1,u={range:[this.editCellData.rowIndex,this.editCellData.colIndex,this.editCellData.rowIndex,this.editCellData.colIndex]};this.parent.notify(cr,u);var c=Ei(a,u.range[0],u.range[2])-3,d=ci(a,u.range[1],u.range[3])-3,p=this.parent.getMainContent(),f=p.parentElement,v=void 0,g=this.parent.frozenColCount(a),b=void 0,y=void 0,C=this.parent.frozenRowCount(a),x=void 0;if(this.editCellData.colIndex<g)v=Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl?"left":"right"]-t.getBoundingClientRect()[this.parent.enableRtl?"right":"left"])-1,this.editCellData.rowIndex<C?this.parent.getRowHeaderContent().style.zIndex==="2"&&(b="3"):_r(o.value,o.style,this.parent.cellStyle)>v&&(x=!0);else{v=f.offsetWidth-(l-p.scrollLeft)-28-this.parent.sheetModule.getRowHeaderWidth(a);var w=t.getBoundingClientRect(),M=f.getBoundingClientRect(),E=this.parent.enableRtl?w.left:w.right,T=this.parent.enableRtl?M.left:M.right,D=this.parent.getScrollElement(),N=this.parent.sheetModule.getScrollSize();this.parent.enableRtl?T+N>E&&(D.scrollLeft-=w.width):T-N<E&&(D.scrollLeft+=w.width)}this.editCellData.rowIndex<C&&(y=!0);var A=!y&&(o&&o.wrap||t&&e||x)?"auto;":c+"px;",L="display:block;top:"+h+"px;"+(this.parent.enableRtl?"right:":"left:")+l+"px;min-width:"+d+"px;max-width:"+(o&&o.wrap?d:v)+"px;height:"+A+(o&&o.wrap?"width:"+d+"px;":"")+"min-height:"+c+"px;"+(b?"z-index: "+b+";":"")+(y&&(o&&!o.wrap||t&&e)&&(_r(o.value,o.style,this.parent.cellStyle)>v||t&&e)?"overflow: auto;":"");L+=t.style.cssText;var k=this.getEditElement(a,!0);k.setAttribute("style",L),_r(k.textContent,o.style,this.parent.cellStyle)>v&&(k.style.height="auto");var O=this.parent.element.querySelector(".e-active-cell");O&&(O.style.height=c+4+"px"),t.classList.contains("e-right-align")?k.classList.add("e-right-align"):t.classList.contains("e-center-align")&&k.classList.add("e-center-align")}},s.prototype.updateEditedValue=function(e,t,i,r){var n=this,a=this.editCellData.oldValue;t&&(this.editCellData.value=t);var o=this.editCellData.value;this.parent.notify(t0,{args:{action:"beforeCellSave",eventArgs:{address:this.editCellData.addr}}});var l=!0;if(this.parent.allowDataValidation){var h=this.parent.getActiveSheet(),u=ee(h.activeCell),c=Y(u[0],u[1],h,!1,!0),d=oi(h,u[1]);if(c.validation||az(d,u[0],u[1])){var p=yb([this.editCellData.value||this.getEditElement(h).innerText],this.parent.locale)[0],f=!0,v=this.parent.activeSheetIndex,g=typeof this.editCellData.addr=="string"?ee(this.editCellData.addr):this.editCellData.addr,b={value:p,range:g,sheetIdx:v,isCell:f,td:null,isValid:!0};this.parent.notify(jf,b),l=b.isValid,l?(c.format&&p!==b.value||!this.editCellData.value&&b.value)&&(this.editCellData.value=b.value):this.isCellEdit=!0}}if(!r&&Bt(this.editCellData.value)){var y={formula:this.editCellData.value};if(this.parent.notify(b1,y),y.isInvalid){var C;this.isCellEdit=!0,l=!1;var x=this.parent.serviceLocator.getService(de),w=this.parent.serviceLocator.getService(At);w.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg",content:x.getConstant("CellReferenceTypoError")+"<br>"+y.formula,beforeOpen:function(){return n.editCellData.element.focus()},buttons:[{buttonModel:{content:x.getConstant("Yes"),isPrimary:!0},click:function(){C=!0,w.hide()}},{buttonModel:{content:x.getConstant("No")},click:function(){return w.hide()}}],close:function(){if(C)t=n.editCellData.value=y.formula,n.updateCell(a,e,t,o,i),n.parent.notify(Po,{action:"refreshFormulabar",value:y.formula});else{var M=n.getEditElement(n.parent.getActiveSheet());M.innerText&&window.getSelection().selectAllChildren(M)}}},!1)}}l?this.updateCell(a,e,t,o,i):i&&i.preventDefault()},s.prototype.updateCell=function(e,t,i,r,n){var a=e?e.toString().toUpperCase():"";if(e!==this.editCellData.value||a.indexOf("=NOW()")>-1||a.indexOf("NOW()")>-1||a.indexOf("=RAND()")>-1||a.indexOf("RAND()")>-1||a.indexOf("=RANDBETWEEN(")>-1||a.indexOf("RANDBETWEEN(")>-1){var o=this.parent.getActiveSheet(),l=ee(o.activeCell);e&&e.toString().indexOf("=UNIQUE(")>-1&&this.editCellData.value===""&&this.parent.notify(ud,null);var h={cellIdx:l,isUnique:!1};this.checkUniqueRange(h);var u=h.isUnique;if(u&&e!==""&&this.editCellData.value===""){var c=ee(this.uniqueColl);if(Y(c[0],c[1],o).value.toString().indexOf("#SPILL!")===-1)return}e&&e.toString().indexOf("UNIQUE")>-1&&this.editCellData.value&&this.editCellData.value.toString().indexOf("UNIQUE")>-1&&u&&this.updateUniqueRange("");var d={action:"updateCellValue",address:this.editCellData.addr,value:this.editCellData.value,skipCellFormat:this.editCellData.showFormattedText};this.parent.notify(au,d);var p=Y(l[0],l[1],o,!0),f=void 0;m(p)||(f=p.value.toString());var v=this.formulaErrorStrings.indexOf(f)>-1||f&&f.includes("circular reference:");if(v){if(delete p.value,delete p.formula,n){var g=n.target,b=["e-toolbar-item","e-tab-wrap","e-text-wrap","e-tab-text","e-caret"],y=["e-scroller","e-main-panel","e-autofill"];(!b.some(function(N){return g.classList.contains(N)})||!U(g,".e-ribbon"))&&!y.some(function(N){return g.classList.contains(N)})&&this.showFormulaAlertDlg(f),n.preventDefault()}return}var C=void 0;d.isFormulaDependent&&(C=SI(this.parent,this.parent.viewport)),this.parent.notify(lu,{cell:null,rIdx:this.editCellData.rowIndex,cIdx:this.editCellData.colIndex,viewportIndexes:C}),o.conditionalFormats&&o.conditionalFormats.length&&this.parent.notify(er,{indexes:[this.editCellData.rowIndex,this.editCellData.colIndex],isAction:!0,refreshAll:d.isFormulaDependent,isEdit:!0});var x=Y(l[0],l[1],o,!0),w=this.getRefreshNodeArgs(x,this.editCellData.element,this.editCellData.rowIndex,this.editCellData.colIndex);if(this.editCellData.value=w.value,x&&x.formula&&(this.editCellData.formula=x.formula),x&&x.wrap&&this.parent.notify(eh,{range:l,wrap:!0,sheet:o}),t&&this.parent.refreshNode(this.editCellData.element,w),x&&x.hyperlink&&this.parent.serviceLocator.getService("cell").refreshRange(l),u){var c=ee(this.uniqueColl);if(Y(c[0],c[1],o).value.toString().indexOf("#SPILL!")>-1&&(this.isSpill=!0),e!==""&&this.editCellData.value===""||this.editCellData.formula&&this.editCellData.formula.length>1&&e!==this.editCellData.formula){for(var M=!1,E=c[0];E<=c[2];E++)for(var T=c[1];T<=c[3];T++){var D=Y(E,T,o);E===c[0]&&T===c[1]?M=!1:D&&!m(D.value)&&D.value!==""&&(M=!0)}M||this.reApplyFormula()}else this.updateUniqueRange(r)}}this.triggerEvent("cellSave",n,i),this.resetEditState(),this.focusElement(n),this.parent.showSheetTabs&&!this.parent.isProtected&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled")},s.prototype.checkUniqueRange=function(e){var t={range:[]};this.parent.notify(i1,t);var i=t.range;e.sheetName||(e.sheetName=this.parent.getActiveSheet().name);for(var r=0;r<i.length;r++)if(i[r].split("!")[0]===e.sheetName){for(var n=ee(i[r]),a=n[0];a<=n[2];a++)for(var o=n[1];o<=n[3];o++)if(e.cellIdx[0]===a&&e.cellIdx[1]===o){e.isUnique=!0,this.uniqueCell=!0;var l=this.uniqueColl!==""?ee(this.uniqueColl):[0,0,0,0],h=ee(i[r]);if(l[0]===h[0]&&l[1]===h[1]){var u=[l[0],h[1],l[0],h[1]];u[2]=l[2]>h[2]?l[2]:h[2],u[3]=l[3]>h[3]?l[3]:h[3],this.uniqueColl=je(u),e.uniqueRange=je(u)}else this.uniqueColl=i[r],e.uniqueRange=i[r]}}},s.prototype.updateUniqueRange=function(e){var t=ee(this.uniqueColl),i=!1;Y(t[0],t[1],this.parent.getActiveSheet()).value!=="#SPILL!"&&(i=!0);for(var r=t[0];r<=t[2];r++)for(var n=t[1];n<=t[3];n++)i&&(r===t[0]&&n===t[1]?this.parent.updateCell({value:"#SPILL!"},je([r,n])):je([r,n]).split(":")[0]===this.editCellData.addr?this.parent.updateCell({value:e},je([r,n])):this.parent.updateCell({value:""},je([r,n])))},s.prototype.reApplyFormula=function(){var e=ee(this.uniqueColl),t=Y(e[0],e[1],this.parent.getActiveSheet());this.parent.updateCell({value:""},je([e[0],e[1]]));for(var i=this.parent.sheets,r=t.formula,n=0;n<i.length;n++)r.indexOf(i[n].name)>-1&&(r=r.replace(i[n].name,"!"+n));this.parent.notify(xt,{action:"computeExpression",formula:r}),this.uniqueCell=!1,this.uniqueActCell!==""&&(this.editCellData.value=this.uniqueActCell,this.uniqueActCell="")},s.prototype.refreshDependentCellValue=function(e,t,i){if(e&&t&&(e--,t--,(this.editCellData.rowIndex!==e||this.editCellData.colIndex!==t)&&this.parent.activeSheetIndex===i||this.uniqueCell&&this.parent.activeSheetIndex===i)){var r=Pe(this.parent,i),n=void 0;if(!ct(r,e)&&!Yt(r,t)&&(n=this.parent.getCell(e,t)),n){if(n.parentElement){var a=n.parentElement.getAttribute("aria-rowindex");if(a&&Number(a)-1!==e)return}var o=Y(e,t,r),l=ee(r.activeCell);l[0]===e&&l[1]===t&&(this.uniqueActCell=o.value);var h=this.getRefreshNodeArgs(o,n,e,t);this.parent.refreshNode(n,h)}}},s.prototype.getRefreshNodeArgs=function(e,t,i,r){e=e||{};var n={value:e.value,format:e.format,formattedText:"",isRightAlign:!1,type:"General",cell:e,rowIndex:i,td:t,colIndex:r,refresh:!0,isEdit:!0};return this.parent.notify(jn,n),{isRightAlign:n.isRightAlign,type:n.type,value:n.value,result:this.parent.allowNumberFormatting?n.formattedText:n.value,curSymbol:n.curSymbol,isRowFill:n.isRowFill,rowIndex:i,colIndex:r}},s.prototype.endEdit=function(e,t,i){e===void 0&&(e=!1),e&&this.refreshEditor(this.editCellData.oldValue,!1,!0,!1,!1);var r=this.triggerEvent("beforeCellSave");if(r.cancel){this.parent.isEdit&&t&&t.preventDefault();return}r.value&&r.value.toString().indexOf(`
`)>-1&&(_c(this.parent.getActiveSheet().selectedRange,!0,this.parent),this.refreshEditor(r.value,this.isCellEdit,!1,!1,!1)),this.updateEditedValue(!0,r.value,t,i)},s.prototype.cancelEdit=function(e,t,i){e===void 0&&(e=!0),t===void 0&&(t=!0),this.refreshEditor(this.editCellData.oldValue,e,!1,!1,!1),t&&this.triggerEvent("cellSave",i),this.resetEditState(),this.focusElement()},s.prototype.focusElement=function(e){if(e&&e.keyCode===9&&document.activeElement.classList.contains("e-formula-bar")){var t=this.parent.element.querySelector(".e-formula-bar-panel "+(e.shiftKey?".e-insert-function":".e-combobox"));t&&Fe(t)}else Fe(this.parent.element);this.parent.notify(nh,[{enable:!0}])},s.prototype.triggerEvent=function(e,t,i){var r=this.parent.getActiveSheet(),n=Y(this.editCellData.rowIndex,this.editCellData.colIndex,r),a={element:this.editCellData.element,value:i||this.editCellData.value,oldValue:this.editCellData.oldValue,address:this.editCellData.fullAddr,displayText:this.parent.getDisplayText(n)};if(a.address){var o=ee(a.address),l={cellIdx:o,isUnique:!1};this.checkUniqueRange(l),l.isUnique&&(a.isSpill=this.isSpill)}if(a.value!==a.oldValue){if(e!=="cellSave"&&(a.cancel=!1),e==="beforeCellSave"){this.parent.notify(li,{eventArgs:a,action:"cellSave",preventAction:!0}),n=Bt(a.value)?{formula:a.value}:{value:a.value};var h=Tn(this.parent,r,{cell:n,rowIdx:this.editCellData.rowIndex,colIdx:this.editCellData.colIndex,eventOnly:!0});if(h)return this.cancelEdit(!1,!1),a.cancel=!0,a}this.parent.trigger(e,a),e==="cellSave"&&(this.editCellData.formula&&(a.formula=this.editCellData.formula),a.originalEvent=t,this.parent.notify(yt,{eventArgs:a,action:"cellSave"}))}else e!=="cellSave"&&e!=="beforeCellSave"&&this.parent.trigger(e,a);return a},s.prototype.altEnter=function(){this.positionEditor(!0);var e=window.getSelection(),t=e.anchorNode,i,r=document.createRange();i=t.nodeType===3?e.anchorOffset:t.textContent.length,i===0&&t.textContent.length>0&&(i=t.textContent.length);var n=t.textContent,a=n.slice(0,i),o=n.slice(i)||" ";t.textContent=a+`
`+o,r=document.createRange(),t.nodeType===3?(r.setStart(t,i+1),r.setEnd(t,i+1)):t.nodeType===1&&(r.setStart(t.firstChild,i+1),r.setEnd(t.firstChild,i+1)),e.removeAllRanges(),e.addRange(r)},s.prototype.resetEditState=function(e){if(e===void 0&&(e=!0),e){var t=this.getEditElement(this.parent.getActiveSheet());(Bt(t.textContent)||t.textContent==="")&&this.parent.notify(lM,null),this.editCellData.element&&(this.editCellData.element.classList.remove("e-ss-edited"),this.editorElem.textContent="",t===this.editorElem?(this.editorElem.removeAttribute("style"),this.editorElem.classList.remove("e-right-align")):ne(t))}this.editCellData={},this.parent.isEdit=this.isEdit=!1,this.isCellEdit=!0,this.parent.notify(Ho,{action:"endEdit"})},s.prototype.refSelectionRender=function(){var e=this.getEditElement(this.parent.getActiveSheet());e&&Bt(e.textContent)&&this.parent.notify(Nh,{range:e.textContent,formulaSheetIdx:this.editCellData.sheetIndex})},s.prototype.initiateRefSelection=function(){var e=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!")),t=this.editCellData.value;this.parent.getActiveSheet().name===e&&Bt(this.editCellData.value,!0)?(this.startEdit(this.editCellData.addr,t,!1),this.parent.notify(Nh,{range:this.editCellData.value,formulaSheetIdx:this.editCellData.sheetIndex}),this.getEditElement(this.parent.getActiveSheet()).textContent=t,this.initiateCurPosition()):this.initiateCurPosition()},s.prototype.addressHandler=function(e){var t=this.parent.serviceLocator.getService(At).dialogInstance;if(t&&t.element&&t.element.classList.contains("e-validation-error-dlg")){e.isAlertDlgOpen=!0;return}var i=window.getSelection();if(this.selectionStart=i.anchorOffset,this.selectionEnd=i.focusOffset,this.selectionStart>this.selectionEnd){var r=this.selectionStart;this.selectionStart=this.selectionEnd,this.selectionEnd=r}if(i&&i.focusNode&&i.focusNode.classList&&i.focusNode.classList.contains("e-formula-bar-panel")){var n=i.focusNode.getElementsByClassName("e-formula-bar e-css")[0];this.selectionStart=n.selectionStart,this.selectionEnd=n.selectionEnd}var a={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,a);var o=e.range,l=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!")),h=this.editCellData.sheetIndex,u=this.getEditElement(this.parent.getActiveSheet());if(this.parent.getActiveSheet().name!==l&&(o="'"+this.parent.getActiveSheet().name+"'!"+o),e.isSelect)this.parent.notify(Nh,{range:a.editedValue+o,formulaSheetIdx:h});else{var c=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));if(this.parent.getActiveSheet().name===c){var d=a.editedValue;this.selectionStart!==this.selectionEnd?(this.formulaBarCurStartPos=this.selectionStart,this.curStartPos=this.selectionStart,this.curEndPos=this.selectionStart+o.length,u.textContent=d.substring(0,this.selectionStart)+o+d.substring(this.selectionStart)):d.indexOf(")")===d.length-1&&this.selectionEnd===d.length?(u.textContent=d.substring(0,d.length-1)+o+d.substring(d.length-1),this.curEndPos=u.textContent.length-1):d.indexOf(")")!==d.length-1?(u.textContent=d+o,this.curEndPos=u.textContent.length):u.textContent!==d?(u.textContent=d.substring(0,this.curStartPos)+o+d.substring(this.curStartPos),this.curEndPos=this.curStartPos+o.length):this.selectionStart===this.selectionEnd&&this.validCharacters.indexOf(d.substring(this.selectionStart-1,this.selectionEnd))!==-1&&(this.validCharacters.indexOf(d.substring(this.selectionStart,this.selectionEnd+1))!==-1||d.substring(this.selectionStart,this.selectionEnd+1)===")")&&(u.textContent=d.substring(0,this.selectionStart)+o+d.substring(this.selectionEnd),this.curStartPos=this.selectionStart,this.curEndPos=this.selectionStart+o.length,this.formulaBarCurStartPos=this.curStartPos)}}},s.prototype.updateFormulaBarValue=function(){var e=window.getSelection(),t=this.editCellData.value,i=this.parent.getActiveSheet().selectedRange;i=Af(ir(i))?i.split(":")[0]:i;var r=this.parent.element.querySelector(".e-formula-bar");if(t&&Bt(t,!0)){var n=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));this.parent.getActiveSheet().name!==n&&(i="'"+this.parent.getActiveSheet().name+"'!"+i),m(this.formulaBarCurStartPos)?t.indexOf(")")===t.length-1&&e.focusOffset===t.length?r.value=t.substring(0,t.length-1)+i+t.substring(t.length-1):t.indexOf(")")!==t.length-1?r.value=t+i:r.value!==t&&(r.value=t.substring(0,this.curStartPos)+i+t.substring(this.curStartPos)):r.value=t.substring(0,this.formulaBarCurStartPos)+i+t.substring(this.formulaBarCurStartPos),this.curEndPos=this.curStartPos+i.length}},s.prototype.setFormulaBarCurPosition=function(e,t,i){e.setSelectionRange&&(e.focus(),e.selectionStart=t,e.selectionEnd=t,e.setSelectionRange(t,i))},s.prototype.initiateCurPosition=function(e){e===void 0&&(e={isCellEdit:!1});var t=this.getEditElement(this.parent.getActiveSheet(),!0);if(e.isCellEdit){var i=this.getCurPosition();!this.endFormulaRef&&i.start===i.end&&(this.updateFormulaReference(t),i.end&&this.validCharacters.indexOf(this.editCellData.value[i.end-1])===-1&&(this.endFormulaRef=!0));return}var r=t.innerText,n=window.getSelection();if(n&&n.focusNode&&n.focusNode.classList&&n.focusNode.classList.contains("e-formula-bar-panel")){var a=this.parent.element.querySelector(".e-formula-bar");this.setFormulaBarCurPosition(a,this.curEndPos,this.curEndPos);return}if(r){var o=document.createRange();r.indexOf(")")===r.length-1?(o.setStart(t.childNodes[0],this.curEndPos),o.setEnd(t.childNodes[0],this.curEndPos)):(o.setStart(t.childNodes[0],this.curEndPos),o.setEnd(t.childNodes[0],this.curEndPos)),n.removeAllRanges(),n.addRange(o)}var l=this.editCellData.sheetIndex;if(l!==this.parent.getActiveSheet().id-1){var h=this.parent.element.querySelector(".e-formula-bar");if(h.value){var u=h.value.length;h.value.indexOf(")")===u-1?this.setFormulaBarCurPosition(h,u-1,u-1):this.setFormulaBarCurPosition(h,u,u)}}},s.prototype.getEditElement=function(e,t){if((this.isEdit||t)&&(e.frozenRows||e.frozenColumns)){var i=this.parent.frozenRowCount(e),r=this.parent.frozenColCount(e),n=xe(e.activeCell),a=void 0;if(n[0]<i&&n[1]<r)a=this.parent.getSelectAllContent();else if(n[0]<i)a=this.parent.getColumnHeaderContent();else if(n[1]<r)a=this.parent.getRowHeaderContent();else return this.editorElem;var o=a.getElementsByClassName("e-spreadsheet-edit")[0];return!o&&t&&(o=a.appendChild(this.editorElem.cloneNode())),o}return this.editorElem},s.prototype.sheetChangeHandler=function(){this.isEdit||(this.editCellData.value=null)},s.prototype.showFormulaAlertDlg=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.serviceLocator.getService("dialog"),n,a=this.getFormulaErrorKey(e);r.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg",content:i.getConstant(a),beforeOpen:function(){if(window.getSelection().rangeCount>0){var o=window.getSelection().getRangeAt(0);n=o.endOffset}},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){r.hide()}}],close:function(){var o=t.getEditElement(t.parent.getActiveSheet()),l=document.getSelection(),h=document.createRange();h.setStart(o.firstChild,n),h.collapse(!0),l.removeAllRanges(),l.addRange(h),o.focus()}},!1)},s.prototype.getFormulaErrorKey=function(e){var t;switch(e){case"invalid arguments":t="InvalidArguments";break;case"improper formula":t="ImproperFormula";break;case"empty expression":t="EmptyExpression";break;case"mismatched parentheses":t="MismatchedParenthesis";break;case"mismatched string quotes":t="MismatchedStringQuotes";break;case"wrong number of arguments":t="WrongNumberOfArguments";break;case"requires 3 arguments":t="Requires3Arguments";break;default:e.includes("circular reference")?t="FormulaCircularRef":t="InvalidFormulaError"}return t},s}(),d7=function(){function s(e){this.uniqueOBracket="",this.uniqueCBracket="",this.uniqueCSeparator="",this.uniqueCOperator="",this.uniquePOperator="",this.uniqueSOperator="",this.uniqueMOperator="",this.uniqueDOperator="",this.uniqueModOperator="",this.uniqueConcateOperator="",this.uniqueEqualOperator="",this.uniqueExpOperator="",this.uniqueGTOperator="",this.uniqueLTOperator="",this.invalidOperators=["%"],this.formulaRange=[],this.tableRangesFormula={},this.parent=e,this.addEventListener(),this.mouseMoveEvt=this.mouseMoveHandler.bind(this)}return s.prototype.addEventListener=function(){this.parent.on(tn,this.init,this),this.parent.on(Qo,this.mouseDownHandler,this),this.parent.on(wa,this.virtualContentLoadedHandler,this),this.parent.on($y,this.cellNavigateHandler,this),this.parent.on(cu,this.selectRange,this),this.parent.on(an,this.rowHeightChanged,this),this.parent.on(wn,this.colWidthChanged,this),this.parent.on(s0,this.protectHandler,this),this.parent.on(Nh,this.initiateFormulaSelection,this),this.parent.on(lM,this.clearBorder,this),this.parent.on(lo,this.getRowIdxFromClientY,this),this.parent.on(ho,this.getColIdxFromClientX,this),this.parent.on(Ic,this.chartBorderHandler,this),this.parent.on(tv,this.isTouchSelectionStarted,this),this.parent.on(L1,this.selectionByKeydown,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tn,this.init),this.parent.off(Qo,this.mouseDownHandler),this.parent.off(wa,this.virtualContentLoadedHandler),this.parent.off($y,this.cellNavigateHandler),this.parent.off(cu,this.selectRange),this.parent.off(an,this.rowHeightChanged),this.parent.off(wn,this.colWidthChanged),this.parent.off(s0,this.protectHandler),this.parent.off(Nh,this.initiateFormulaSelection),this.parent.off(lM,this.clearBorder),this.parent.off(lo,this.getRowIdxFromClientY),this.parent.off(ho,this.getColIdxFromClientX),this.parent.off(Ic,this.chartBorderHandler),this.parent.off(tv,this.isTouchSelectionStarted),this.parent.off(L1,this.selectionByKeydown))},s.prototype.isTouchSelectionStarted=function(e){e.touchSelectionStarted=this.touchSelectionStarted},s.prototype.selectionByKeydown=function(e){this.selectRangeByIdx(e.range,e.e,!1,!1,!1,!1,void 0,!1)},s.prototype.rowHeightChanged=function(e){var t=this;e.threshold&&Vi(function(){if(t.parent){var i=t.parent.getActiveSheet(),r=t.getActiveCell();if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){t.selectRange({address:i.selectedRange});return}var n=lt(ee(i.selectedRange)),a={range:n,isActiveCell:!1,skipChecking:!0},o;if(r){var l=xe(i.activeCell)[0];if(t.parent.notify(Vc,a),a.isActiveCell){var h=Y(n[0],n[1],i,!1,!0);o=h.rowSpan>1&&n[0]<=e.rowIdx&&n[2]>=e.rowIdx}l===e.rowIdx||o?r.style.height=parseFloat(r.style.height)+e.threshold+"px":l>e.rowIdx&&(r.style.top=parseFloat(r.style.top)+e.threshold+"px")}if(r=t.getSelectionElement(),r){if(o||n[0]===n[2]&&n[1]===n[3])return;var u=n[0],c=n[2];u<=e.rowIdx&&c>=e.rowIdx&&r?r.style.height=parseFloat(r.style.height)+e.threshold+"px":u>e.rowIdx&&r&&(r.style.top=parseFloat(r.style.top)+e.threshold+"px")}}})},s.prototype.colWidthChanged=function(e){var t=this;e.threshold&&Vi(function(){if(t.parent){var i=t.parent.getActiveSheet(),r=t.getActiveCell(),n=t.parent.enableRtl;if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){t.selectRange({address:i.selectedRange});return}var a=lt(ee(i.selectedRange)),o={range:a,isActiveCell:!1,skipChecking:!0},l;if(r){t.parent.notify(Vc,o);var h=xe(i.activeCell)[1];if(o.isActiveCell){var u=Y(a[0],a[1],i,!1,!0);l=u.rowSpan>1||u.colSpan>1}h===e.colIdx||l?r.style.width=parseFloat(r.style.width)+e.threshold+"px":h>e.colIdx&&(n?r.style.right=parseFloat(r.style.right)+e.threshold+"px":r.style.left=parseFloat(r.style.left)+e.threshold+"px")}if(r=t.getSelectionElement(),!(!r||l||a[0]===a[2]&&a[1]===a[3])){var c=a[1],d=a[3];c<=e.colIdx&&d>=e.colIdx&&r?r.style.width=parseFloat(r.style.width)+e.threshold+"px":c>e.colIdx&&r&&(n?r.style.right=parseFloat(r.style.right)+e.threshold+"px":r.style.left=parseFloat(r.style.left)+e.threshold+"px")}}})},s.prototype.selectRange=function(e){e.address=this.parent.selectionSettings.mode==="Single"?je(xe(e.address)):e.address,this.selectMultiRange(e.address,null,null,e.skipChecking)},s.prototype.init=function(){this.createSelectionElement();var e=this.parent.getActiveSheet(),t=lt(ee(e.selectedRange)),i=xe(e.activeCell),r=t[0]<=i[0]&&t[2]>=i[0]&&t[1]<=i[1]&&t[3]>=i[1];this.selectMultiRange(e.selectedRange,!0,r)},s.prototype.selectMultiRange=function(e,t,i,r){var n=this,a=this.parent.activeSheetIndex;e.indexOf("!")>-1&&(a=gt(this.parent,Ms(e)),e=e.split("!")[1]),this.parent.activeSheetIndex===a?e.split(" ").forEach(function(o,l){n.selectRangeByIdx(ee(o),{type:"mousedown",ctrlKey:l!==0},null,i,t,r)}):Xp(this.parent,e,this.parent.sheets[a])},s.prototype.createSelectionElement=function(){var e=this.parent.getMainContent(),t=this.parent.createElement("div",{className:"e-selection"});e.appendChild(t),t=this.parent.createElement("div",{className:"e-active-cell"}),e.appendChild(t)},s.prototype.mouseDownHandler=function(e){if(!(U(e.target,".e-scrollbar")||e.target.classList.contains("e-main-panel")||e.target.classList.contains("e-sheet"))){var t={action:"getCurrentEditValue",editedValue:""},i=this.parent.getActiveSheet();this.parent.notify(Jt,t);var r=Bt(t.editedValue,!0);if(!this.parent.isEdit||r){var n=document.getElementById(this.parent.element.id+"_overlay");if(typeof e.target.className=="string"){if(e.target.className.indexOf("e-ss-overlay")>-1)return}else n&&n.classList.remove("e-ss-overlay-active");if(U(e.target,".e-datavisualization-chart")||i.isProtected&&!i.protectSettings.selectCells&&!i.protectSettings.selectUnLockedCells)return;if(!U(e.target,".e-findtool-dlg")&&this.getSheetElement().contains(e.target)&&!e.target.classList.contains("e-colresize")&&!e.target.classList.contains("e-rowresize")){var a=this.parent.getActiveSheet(),o=this.parent.selectionSettings.mode,l=this.getRowIdxFromClientY({clientY:Za(e),target:e.target}),h=this.getColIdxFromClientX({clientX:Ka(e),target:e.target}),u=xe(a.activeCell);Y(l,h,a);var c=void 0,d=void 0;if(a.showHeaders){var p=e.target;if(a.frozenColumns||a.frozenRows){var f=this.parent.getSelectAllContent().querySelector("thead");f?d=(this.parent.getColumnHeaderContent().contains(p)||f.contains(p))&&p.classList.contains("e-header-cell"):d=this.parent.getColumnHeaderContent().contains(p)&&p.classList.contains("e-header-cell"),f=this.parent.getSelectAllContent().querySelector("tbody"),f?c=(this.parent.getRowHeaderContent().contains(p)||f.contains(p))&&p.classList.contains("e-header-cell"):c=this.parent.getRowHeaderContent().contains(p)&&p.classList.contains("e-header-cell")}else c=this.parent.getRowHeaderContent().contains(e.target),d=this.parent.getColumnHeaderContent().contains(e.target)}if(e.which===3&&this.isSelected(l,h))return;if(e.target.classList.contains("e-autofill")){this.isautoFillClicked=!0;var v=e.target.parentElement.querySelector(".e-dragfill-ddb");(!v||v.classList.contains("e-hide"))&&(this.dAutoFillCell=a.selectedRange)}var g=ee(a.topLeftCell),b=void 0;if(c?(this.isRowSelected=!0,(!e.shiftKey||o==="Single")&&(this.startCell=[l,0]),b=[this.startCell[0],a.frozenColumns?g[1]:0,l,a.colCount-1]):d?(this.isColSelected=!0,(!e.shiftKey||o==="Single")&&(this.startCell=[0,h]),b=[a.frozenRows?g[0]:0,this.startCell[1],a.rowCount-1,h]):U(e.target,".e-select-all-cell")?(this.startCell=[a.frozenRows?g[0]:0,a.frozenColumns?g[1]:0],b=[].concat(this.startCell,[a.rowCount-1,a.colCount-1])):e.target.classList.contains("e-sheet-content")||((!e.shiftKey||o==="Single")&&(this.startCell=[l,h]),!this.isautoFillClicked&&!U(e.target,".e-filloption")&&(b=[].concat(this.startCell?this.startCell:xe(a.activeCell),[l,h]))),Kd(e)&&!(c||d)&&b){var y=this.isRowColSelected(b);this.isRowSelected=y.isRowSelected,this.isColSelected=y.isColSelected}var C=e.ctrlKey&&b&&a.selectedRange.includes(je(b));if(!C&&o==="Multiple"&&(!WC(e)&&(!Kd(e)||Kd(e)&&u[0]===l&&u[1]===h)||d||c)?(document.addEventListener(kl().split(" ")[0],this.mouseMoveEvt),B.isPointer||(B.isIos&&Kd(e)&&e.target&&e.target.classList.contains("e-cell")&&e.preventDefault(),document.addEventListener(kl().split(" ")[1],this.mouseMoveEvt,{passive:!1})),this.touchSelectionStarted=!0):this.touchSelectionStarted=!1,!C&&!WC(e)&&I.add(document,C0(),this.mouseUpHandler,this),Kd(e)&&!(d||c)){this.touchEvt=e;return}b&&this.selectRangeByIdx(b,e),this.parent.isMobileView()&&(this.parent.element.classList.add("e-mobile-focused"),this.parent.renderModule.setSheetPanelSize())}}if(r&&(e.target.classList.contains("e-cell")||e.target.classList.contains("e-wrap-content")||e.target.classList.contains("e-header-cell"))&&this.parent.isEdit){var b=this.parent.getActiveSheet().selectedRange;b=Af(ir(b))?b.split(":")[0]:b,this.parent.notify(zh,{range:b,isSelect:!1})}}},s.prototype.mouseMoveHandler=function(e){var t=this,i=this.parent.getActiveSheet();S0(e)&&e.preventDefault();var r={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,r);var n=Bt(r.editedValue,!0),a=this.parent.getMainContent().parentElement,o=this.parent.element.getElementsByClassName("e-scroller")[0],l=a.getBoundingClientRect(),h=this.parent.frozenColCount(i),u=l.left+this.parent.sheetModule.getRowHeaderWidth(i),c=l.top,d=l.right-oz(),p=l.bottom,f=Ka(e),v=Za(e),g=this.isRowSelected?i.colCount-1:this.getColIdxFromClientX({clientX:f,target:e.target}),b=this.isColSelected?i.rowCount-1:this.getRowIdxFromClientY({clientY:v,target:e.target}),y,C;if(e.ctrlKey){var x=i.selectedRange.split(" ");y=ee(x[x.length-1])}else y=ee(i.selectedRange);if(B.isDevice){var w=screen.availWidth;d>=w-40&&(d-=40-(w-d)),!i.showHeaders&&u<40&&(u+=40-u)}var M={range:[b,g,b,g]};if(this.parent.notify(cr,M),!(M.range[2]===y[2]&&M.range[3]===y[3]&&v<=p&&v>=c&&f<=d&&f>=u)){var E=this.parent.frozenRowCount(i),T=v>p&&b<i.rowCount,D=v<c&&b>=0&&!this.isColSelected&&!!a.scrollTop;E>b&&(T=!1,D=!1);var N=f>d&&g<i.colCount,A=f<u&&g>=0&&!this.isRowSelected&&!!o.scrollLeft;h>g&&(N=!1,A=!1),this.clearInterval();var L,k;if(!n&&!this.isColSelected&&!this.isRowSelected&&(y=xe(i.activeCell)),T||D||N||A){(D||A)&&(L=b,k=g);var O=function(){if((T||D)&&!t.isColSelected){if(b=t.getRowIdxFromClientY({clientY:T?p:c}),b>=i.rowCount){t.clearInterval();return}a.scrollTop+=(T?1:-1)*Wt(i,b)}if((N||A)&&!t.isRowSelected){if(g=t.getColIdxFromClientX({clientX:N?d:u}),g>=i.colCount){t.clearInterval();return}o.scrollLeft+=(N?1:-1)*tr(i,g)}if(D&&i.frozenRows&&!a.scrollTop||A&&i.frozenColumns&&!o.scrollLeft){t.selectRangeByIdx([].concat(y[0],y[1],[L,k]),e),t.clearInterval();return}t.selectRangeByIdx([].concat(y[0],y[1],[b,g]),e)};O(),this.scrollInterval=setInterval(function(){O(),t.clearInterval(),t.scrollInterval=setInterval(O,100)})}else{var R=[].concat(y[0],y[1],[b,g]);if(E&&R[0]<E&&R[2]>=E&&a.scrollTop&&(a.scrollTop=0,R[2]=E),h&&R[1]<h&&R[3]>=h&&o.scrollLeft&&(o.scrollLeft=0,R[3]=h),this.isautoFillClicked){e.target.classList.contains("e-autofill")&&(this.dAutoFillCell=i.selectedRange);var j={e,indexes:null};this.parent.notify(CM,j),R=j.indexes,C=R}this.selectRangeByIdx(R,e)}if(n&&this.parent.isEdit&&!U(e.target,"#"+this.parent.element.id+"_edit")){var P=void 0;this.isautoFillClicked?P=je(C):P=this.parent.getActiveSheet().selectedRange,this.parent.notify(zh,{range:P,isSelect:!1})}}},s.prototype.mouseUpHandler=function(e){var t=this.getRowIdxFromClientY({clientY:Za(e),target:e.target}),i=this.getColIdxFromClientX({clientX:Ka(e),target:e.target});this.clearInterval(),WC(e)&&!(this.isColSelected||this.isRowSelected)&&this.getRowIdxFromClientY({clientY:Za(this.touchEvt),target:e.target})===t&&this.getColIdxFromClientX({clientX:Ka(this.touchEvt),target:e.target})===i&&this.mouseDownHandler(e),document.removeEventListener(kl().split(" ")[0],this.mouseMoveEvt),B.isPointer||document.removeEventListener(kl().split(" ")[1],this.mouseMoveEvt),I.remove(document,C0(),this.mouseUpHandler);var r=this.parent.getActiveSheet();if((r.frozenRows||r.frozenColumns)&&Ti(this.parent.element,null,"e-cur-selection",!0,!0),this.parent.notify(D1,e),this.isautoFillClicked){var n=this.parent.getActiveSheet(),a=ee(n.selectedRange);!(this.isColSelected&&a[1]===i)&&!(this.isRowSelected&&a[0]===t)&&this.parent.notify(m0,{event:e,dAutoFillCell:this.dAutoFillCell}),this.isautoFillClicked=!1}else!e.ctrlKey&&!TM(VA(this.parent.getActiveSheet()))?this.parent.notify(Pa,null):this.parent.notify(ql,null);var o={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,o);var l=Bt(o.editedValue)||o.editedValue&&o.editedValue.toString().indexOf("=")===0;this.parent.isEdit&&l&&this.parent.notify(l0,{isCellEdit:e.target.classList.contains("e-spreadsheet-edit")})},s.prototype.isSelected=function(e,t){for(var i=!1,r,n=this.parent.getActiveSheet().selectedRange.split(" "),a=0;a<n.length;a++)if(r=lt(ee(n[a])),r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]){i=!0;break}return i},s.prototype.virtualContentLoadedHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r,n,a;i.selectedRange.split(" ").forEach(function(o,l){if(r=ee(o),a=r[1]===0&&r[3]===e.prevRowColCnt.colCount-1,n=r[0]===0&&r[2]===e.prevRowColCnt.rowCount-1,a||n)n&&a?r=[0,0,i.rowCount-1,i.colCount-1]:n?r=[0,r[1],i.rowCount-1,r[3]]:r=[r[0],0,r[2],i.colCount-1],i.frozenRows||i.frozenColumns?t.selectRangeByIdx(r,{type:"mousedown",ctrlKey:l!==0},!1,!1,!1,!1,void 0,!0):t.selectRangeByIdx(r,null,!0,null,null,null,l);else{r=ee(o);var h=t.parent.viewport.topIndex+t.parent.frozenRowCount(i),u=t.parent.viewport.leftIndex+t.parent.frozenColCount(i);t.highlightHdr(r,l!==0,r[0]>=h||r[2]>=h,r[1]>=u||r[3]>=u)}})},s.prototype.clearInterval=function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null)},s.prototype.getScrollLeft=function(){return this.parent.scrollModule?this.parent.scrollModule.prevScroll.scrollLeft:0},s.prototype.cellNavigateHandler=function(e){var t=this.parent.getActiveSheet();t.isProtected&&!t.protectSettings.selectCells&&!t.protectSettings.selectUnLockedCells||this.selectRangeByIdx(e.range.concat(e.range),void 0,!1,!1,!1,!1,void 0,e.preventAnimation)},s.prototype.getColIdxFromClientX=function(e){var t=0,i=this.parent.getActiveSheet(),r=0;if(e.isImage)r=e.clientX;else{var n=document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect();if(this.parent.enableRtl?r=n.right-this.parent.sheetModule.getRowHeaderWidth(i,!0)-1-e.clientX:r=e.clientX-(n.left+this.parent.sheetModule.getRowHeaderWidth(i,!0)+1),r+=this.parent.viewport.beforeFreezeWidth,!e.target||!U(e.target,".e-row-header")&&!U(e.target,".e-selectall-container")||this.isScrollableArea(e.clientX,e.target,!0))if(this.parent.frozenColCount(i)){var a=this.parent.element.querySelector(".e-frozen-column");r=parseInt(a.style.left,10)>r?r:r+this.getScrollLeft()}else r+=this.getScrollLeft()}for(var o,l=0;;l++)if(o=t+=tr(i,l,null,!e.isImage),r<(e.isImage?Number(oh(o).toFixed(2)):o)||this.parent.scrollSettings.isFinite&&l===i.colCount-1)return e.isImage||(e.size=r),e.clientX=l,l},s.prototype.isScrollableArea=function(e,t,i){return t.classList.contains("e-table")?i?e>this.parent.getMainContent().getBoundingClientRect().left:e>this.parent.getMainContent().parentElement.getBoundingClientRect().top:!1},s.prototype.getRowIdxFromClientY=function(e){var t=0,i=this.parent.getActiveSheet(),r=0;if(e.isImage)r=e.clientY;else{var n=document.getElementById(this.parent.element.id+"_sheet");r=e.clientY+this.parent.viewport.beforeFreezeHeight-(n.getBoundingClientRect().top+(i.showHeaders?31:0)),(!e.target||!U(e.target,".e-header-panel")||this.isScrollableArea(e.clientY,e.target))&&(r+=this.parent.getMainContent().parentElement.scrollTop)}for(var a,o=0;;o++)if(a=t+=Wt(i,o,!e.isImage),r<(e.isImage?Number(oh(a).toFixed(2)):a)||this.parent.scrollSettings.isFinite&&o===i.rowCount-1)return e.isImage||(e.size=r),e.clientY=o,o},s.prototype.initFormulaReferenceIndicator=function(e){if(this.parent.isEdit){var t=this.parent.createElement("div",{className:"e-formularef-indicator"});t.appendChild(this.parent.createElement("div",{className:"e-top"})),t.appendChild(this.parent.createElement("div",{className:"e-bottom"})),t.appendChild(this.parent.createElement("div",{className:"e-left"})),t.appendChild(this.parent.createElement("div",{className:"e-right"})),this.parent.getMainContent().appendChild(t),ws(this.parent,t,e,"e-formularef-indicator")}},s.prototype.isMouseEvent=function(e){return qC(e)||YC(e)||Zd(e)},s.prototype.selectRangeByIdx=function(e,t,i,r,n,a,o,l){var h=this,u=t&&this.isMouseEvent(t);if(!(t&&t.target&&u&&U(t.target,"#"+this.parent.element.id+"_edit"))){var c={action:"getCurrentEditValue",editedValue:"",endFormulaRef:!1};this.parent.notify(Jt,c);var d=(this.parent.isEdit?Bt(c.editedValue,!0):!1)&&!c.endFormulaRef,p=t&&t.ctrlKey&&qC(t),f;p||(f=this.getSelectionElement(t,o));var v=this.parent.getActiveSheet(),g=ee(v.topLeftCell),b=this.parent.element.querySelector(".e-formularef-indicator"),y={range:[].slice.call(e),isActiveCell:!1,skipChecking:a},C,x=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active"),w=this.isRowColSelected(e);!w.isColSelected&&!w.isRowSelected&&this.parent.notify(Vc,y),e!==y.range&&(C=!0),e=y.range;var M=new Promise(function(F){F(function(){}())}),E={range:je(e),cancel:!1};if(v.isProtected){var T=Y(e[2],e[3],v);if(v.protectSettings.selectUnLockedCells&&!v.protectSettings.selectCells)if(m(T)){if(!v.protectSettings.selectCells)return}else{if(T.isLocked===!0||m(T.isLocked))return;var D=this.parent.element.getElementsByClassName("e-sheet-panel")[0];D&&D.classList.contains("e-protected")&&D.classList.remove("e-protected")}}if(this.parent.trigger("beforeSelect",E),!E.cancel){if(d&&b&&b.parentElement.removeChild(b),this.parent.notify(v0,null),(Af(e)||y.isActiveCell)&&!p){if(f&&(f.classList.contains("e-multi-range")||f.classList.add("e-hide"),v.frozenRows||v.frozenColumns)){var N=Zd(t)?"e-cur-selection":"e-selection";Ti(this.parent.getSelectAllContent(),null,N,!0),Ti(this.parent.getColumnHeaderContent(),null,N,!0),Ti(this.parent.getRowHeaderContent(),null,N,!0)}if(!v.frozenColumns&&!v.frozenRows&&f&&ws(this.parent,f,e),d&&t&&t.target&&(!u||!t.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var A={range:je(e).split(":")[0],isSelect:!0};if(this.parent.notify(zh,A),A.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(e)}}else{if(p)if(o===void 0){var L=je(e);if(v.selectedRange.includes(L)){var k=v.selectedRange.split(" ");k.length>1?(k.splice(k.indexOf(L),1),L=k.join(" ")):L=v.activeCell+":"+v.activeCell,this.selectRange({address:L});return}else f=this.getSelectionElement(t,o)}else f=this.getSelectionElement(t,o);if(d&&this.parent.isEdit){if(t&&t.target&&(!u||!t.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var A={range:je(e),isSelect:!0};if(this.parent.notify(zh,A),A.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(e)}}else{var N=void 0;f&&(f.classList.remove("e-hide"),(v.frozenRows||v.frozenColumns)&&((t&&t.target||p)&&(N="e-cur-selection",Zd(t)&&f.classList.contains("e-cur-selection")?f.classList.add("e-hide"):f.classList.add(N)),!p&&(this.isColSelected||this.isRowSelected)&&qC(t)&&(Ti(this.parent.getSelectAllContent(),null,"e-selection"),Ti(this.parent.getColumnHeaderContent(),null,"e-selection"),Ti(this.parent.getRowHeaderContent(),null,"e-selection"))));var O=this.isColSelected&&this.isRowSelected?void 0:this.getOffset(e[2],e[3]);C&&O&&(O.left={idx:0,size:0}),M=ws(this.parent,f,e,N,l,p,p&&!t.target)||M}}var R={action:"getCurrentEditSheetIdx",sheetIndex:null};this.parent.notify(Jt,R),v.frozenColumns&&e[1]>0&&e[1]===g[1]&&e[3]===v.colCount-1&&(e[1]=0),v.frozenRows&&e[0]>0&&e[0]===g[0]&&e[2]===v.rowCount-1&&(e[0]=0);var j=je(e);if(t&&t.ctrlKey&&(Zd(t)||YC(t)))j=v.selectedRange.slice(0,v.selectedRange.lastIndexOf(" "))+" "+j;else if(o>-1){var k=v.selectedRange.split(" ");k[o]=j,j=k.join(" ")}if(!d&&!this.isautoFillClicked){var P=!1;v.selectedRange!==j&&(P=!0),Xp(this.parent,j,v,p),P&&M.then(function(){h.parent.trigger("select",{range:h.parent.getActiveSheet().selectedRange})})}else!n&&!this.isautoFillClicked&&Xp(this.parent,j,v,p);w=this.isRowColSelected(e),this.isRowSelected=w.isRowSelected,this.isColSelected=w.isColSelected,this.highlightHdr(e,t&&t.ctrlKey),!i&&!(t&&(t.type==="mousemove"||S0(t)))&&(d?R.sheetIndex===this.parent.getActiveSheet().id-1&&n?(r=!0,this.updateActiveCell(r?ee(v.activeCell):e,n,l)):this.parent.isEdit||this.updateActiveCell(r?ee(v.activeCell):e,n,l):this.updateActiveCell(r?ee(v.activeCell):e,n,l)),m(t)&&(t={type:"mousedown"}),d?n||this.parent.notify(Gs,t):this.parent.notify(Gs,t),!p&&!TM(VA(this.parent.getActiveSheet()))?this.parent.notify(Pa,{preventAnimation:l}):this.parent.notify(ql,null),this.parent.showAggregate&&this.parent.notify(wd,{}),this.parent.notify(cM,{}),x&&this.parent.notify(qh,{}),this.parent.notify(pM,{})}}},s.prototype.isRowColSelected=function(e){var t=this.parent.getActiveSheet();return{isRowSelected:e[1]===0&&e[3]===t.colCount-1,isColSelected:e[0]===0&&e[2]===t.rowCount-1}},s.prototype.updateActiveCell=function(e,t,i){var r=this.parent.getActiveSheet(),n=ee(r.topLeftCell),a,o,l;this.isColSelected?(a=n[0],o=e[1],this.isRowSelected&&(o=n[1])):(a=e[0],o=e[1],this.isRowSelected&&(o=n[1]));var h={range:[a,o].concat([a,o])};if(this.parent.notify(cr,h),e!==h.range&&(l=!0),e=h.range,r.activeCell!==Je(e[0],e[1])||t){if(this.parent.setSheetPropertyOnMute(r,"activeCell",Je(e[0],e[1])),r.isProtected){var u=this.parent.element.querySelector(".e-formula-bar"),c=Y(e[0],e[1],r),d=Cn(c,oi(r,e[1]));d&&u&&!u.disabled?u.disabled=!0:!d&&u&&u.disabled&&(u.disabled=!1)}if(this.getActiveCell()){var p=this.getOffset(e[2],e[3]);l&&(p.left={idx:0,size:0}),ws(this.parent,this.getActiveCell(),e,"e-active-cell",i)}this.parent.notify(sa,null)}else ws(this.parent,this.getActiveCell(),e,"e-active-cell",i)},s.prototype.getOffset=function(e,t){var i={left:{idx:0,size:0},top:{idx:0,size:0}};return this.parent.scrollModule&&(t>=this.parent.scrollModule.offset.left.idx&&(i.left=this.parent.scrollModule.offset.left),e>=this.parent.scrollModule.offset.top.idx&&(i.top=this.parent.scrollModule.offset.top)),i},s.prototype.getSelectionElement=function(e,t){var i=this.parent.getActiveSheet();if(e&&e.ctrlKey)if(YC(e)||Zd(e))if(i.frozenColumns||i.frozenRows){var r=this.parent.getMainContent().querySelector(".e-cur-selection");return r||(r=this.parent.element.querySelector(".e-multi-range"),r&&r.cloneNode())}else return this.parent.getMainContent().querySelector(".e-selection:last-child");else{var n=this.parent.getMainContent().getElementsByClassName("e-selection")[0],r=n.cloneNode();return r.classList.add("e-multi-range"),i.frozenColumns||i.frozenRows?(i.selectedRange.includes(" ")||(n.classList.remove("e-hide"),ws(this.parent,n,lt(ee(i.selectedRange)),void 0,!1,!0)),!this.parent.getMainContent().querySelector(".e-multi-range")&&n.classList.contains("e-hide")?n:r):(n.classList.remove("e-hide"),this.parent.getMainContent().appendChild(r))}else{if(t>-1)return i.frozenRows||i.frozenColumns?this.parent.element.querySelector(".e-sheet").getElementsByClassName("e-selection")[t]:this.parent.getMainContent().getElementsByClassName("e-selection")[t];var a=[].slice.call(this.parent.element.getElementsByClassName("e-multi-range"));return a.forEach(function(o){pt(o)}),this.parent.getMainContent().getElementsByClassName("e-selection")[0]}},s.prototype.getActiveCell=function(){return this.parent.getMainContent().getElementsByClassName("e-active-cell")[0]},s.prototype.getSheetElement=function(){return document.getElementById(this.parent.element.id+"_sheet")},s.prototype.highlightHdr=function(e,t,i,r){var n=this;i===void 0&&(i=!0),r===void 0&&(r=!0);var a=this.parent.getActiveSheet();if(a.showHeaders){t||(te(this.getSheetElement().querySelectorAll(".e-highlight"),"e-highlight"),te(this.getSheetElement().querySelectorAll(".e-prev-highlight"),"e-prev-highlight"));var o=this.parent.element.getElementsByClassName("e-select-all-cell")[0];o&&te([o],["e-prev-highlight-right","e-prev-highlight-bottom"]);var l=[],h=[],u=lt(e);this.isRowSelected&&(u[1]=ae(a,u[1],!0,"columns")),this.isColSelected&&(u[0]=ae(a,u[0],!0));var c=[0,0,0,0],d=[0,0,0,0],p=xe(a.topLeftCell),f,v,g=function(x,w,M){var E,T;if(x&&u[f]<x){p[f]=ae(a,p[f],!0,w);var D=ae(a,u[f],!0,w);D===p[f]&&(u[f]=D),T=n.parent.hiddenCount(p[f],u[f]-1,w,a),c[f]=u[f]-T-p[f],E=u[v]<x?u[v]:x-1,c[v]=E-n.parent.hiddenCount(u[f],E,w,a)-T-p[f]+1,E=n.parent.viewport[""+M]+x,u[v]>=E&&(d[f]=0,d[f]-=n.parent.hiddenCount(E,E,w,a),d[v]=u[v]-n.parent.hiddenCount(E,u[v],w,a)-E+1)}else{E=ae(a,n.parent.viewport[""+M]+x,!0,w);var D=ae(a,u[f],!0,w);E===D&&(u[f]=E),T=n.parent.hiddenCount(E,u[f]-1,w,a),d[f]=u[f]-T-E,d[v]=u[v]-n.parent.hiddenCount(u[f],u[v],w,a)-T-E+1}},b=function(x,w,M){for(var E=[].slice.call(w.getElementsByClassName("e-header-cell")),T=x[f];T<x[v];T++)E[T]&&M.push(E[T])};if(i){if(f=0,v=2,g(this.parent.frozenRowCount(a),"rows","topIndex"),a.frozenRows){var y=this.parent.getSelectAllContent().querySelector("tbody");y&&b(c,y,l)}b(d,this.parent.getRowHeaderContent(),l)}if(r){if(f=1,v=3,g(this.parent.frozenColCount(a),"columns","leftIndex"),a.frozenColumns){var C=this.parent.getSelectAllContent().querySelector("thead");C&&b(c,C,h)}b(d,this.parent.getColumnHeaderContent(),h)}a.isProtected&&!a.protectSettings.selectCells?te([].concat(l,h),"e-highlight"):Q([].concat(l,h),"e-highlight"),l.length&&l[0].parentElement.previousElementSibling&&l[0].parentElement.previousElementSibling.classList.add("e-prev-highlight"),h.length&&h[0].previousElementSibling&&h[0].previousElementSibling.classList.add("e-prev-highlight"),this.isRowSelected&&this.isColSelected&&(a.isProtected&&!a.protectSettings.selectCells?document.getElementById(this.parent.element.id+"_select_all").classList.remove("e-highlight"):document.getElementById(this.parent.element.id+"_select_all").classList.add("e-highlight")),o&&(ae(a,u[0],!0)===ae(a,0,!0)&&o.classList.add("e-prev-highlight-bottom"),ae(a,u[1],!0,"columns")===ae(a,0,!0,"columns")&&o.classList.add("e-prev-highlight-right"))}},s.prototype.protectHandler=function(){var e=ee(this.parent.getActiveSheet().selectedRange),t=lt(e),i=xe(this.parent.getActiveSheet().activeCell),r=t[0]<=i[0]&&t[2]>=i[0]&&t[1]<=i[1]&&t[3]>=i[1];this.selectRangeByIdx(e,null,null,r)},s.prototype.initiateFormulaSelection=function(e){this.processFormulaEditRange(e.range,e.formulaSheetIdx)},s.prototype.processFormulaEditRange=function(e,t){var i,r=t,n=0,a=this.parseFormula(e),o=a.length,l=0,h=[["e-vborderright","e-vborderbottom"],["e-pborderright","e-pborderbottom"],["e-cborderright","e-cborderbottom"],["e-gborderright","e-gborderbottom"],["e-oborderright","e-oborderbottom"],["e-bborderright","e-bborderbottom"]];this.clearBorder();for(var u=this.parent.getActiveSheet().id-1;n<o&&(i=a[n],!(this.invalidOperators.indexOf(i)>-1));){if(ur(i.toUpperCase())){if(i=i.replace(/\$/g,""),n>0&&a[n-1].indexOf("!")===a[n-1].length-1){var c=a[n-1].split("!");r=gt(this.parent,c[0].substring(1,c[0].length-1))}a[n+1]===":"&&(n++,a[n+1]&&ur(a[n+1].toUpperCase())&&(i=i+":"+a[n+1],n++)),u===r&&this.updateFormulaEditRange(i,l,h),r=t,l++}n++}},s.prototype.updateFormulaEditRange=function(e,t,i){var r=ee(e);this.formulaRange[t]=e,this.dStartCell={rowIndex:r[0],colIndex:r[1]},this.dEndCell={rowIndex:r[2],colIndex:r[3]},this.focusBorder(this.dStartCell,this.dEndCell,i[t%6])},s.prototype.chartBorderHandler=function(e){this.focusBorder(e.startcell,e.endcell,e.classes,!0)},s.prototype.focusBorder=function(e,t,i,r){r=m(r)?!1:r;var n=lt([e.rowIndex,e.colIndex,t.rowIndex,t.colIndex]),a=this.parent.getActiveSheet();if(a.frozenRows||a.frozenColumns){var o=this.parent.createElement("div",{className:r?"e-range-indicator e-chart-range":"e-range-indicator e-formuala-range"});o.appendChild(this.parent.createElement("div",{className:"e-top"})),o.appendChild(this.parent.createElement("div",{className:"e-bottom"})),o.appendChild(this.parent.createElement("div",{className:"e-left"})),o.appendChild(this.parent.createElement("div",{className:"e-right"})),ws(this.parent,o,n,"e-range-indicator");return}var l=n[0],h=n[1],u=n[2],c=n[3];l&&this.getEleFromRange([l-1,h,l-1,c]).forEach(function(d){d&&(d.classList.add(i[1]),r||d.classList.add("e-formularef-selection"))}),this.getEleFromRange([l,c,u,c]).forEach(function(d){d&&(d.classList.add(i[0]),r||d.classList.add("e-formularef-selection"))}),this.getEleFromRange([u,h,u,c]).forEach(function(d){d&&(d.classList.add(i[1]),r||d.classList.add("e-formularef-selection"))}),h&&this.getEleFromRange([l,h-1,u,h-1]).forEach(function(d){d&&(d.classList.add(i[0]),r||d.classList.add("e-formularef-selection"))})},s.prototype.getEleFromRange=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],a,o,l,h=[],u,c=[];if(t>r&&(l=t,t=r,r=l),i>n&&(l=i,i=n,n=l),this.parent.scrollSettings.enableVirtualization){for(a=t;a<=r;a++)if(o=a,o>-1){var d=this.parent.getRow(o,null);d&&(u=d.getElementsByClassName("e-cell"),h=n===i?[u[n]]:this.getRowCells(u,i,n+1),this.merge(c,h))}}return c},s.prototype.getRowCells=function(e,t,i){var r=[];for(t;t<i;t++)e[t]&&r.push(e[t]);return r},s.prototype.merge=function(e,t){!e||!t||Array.prototype.push.apply(e,t)},s.prototype.clearBorder=function(){var e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var t=[].slice.call(this.parent.element.getElementsByClassName("e-formuala-range"));t.forEach(function(l){ne(l)});return}for(var i=this.parent.element.getElementsByClassName("e-formularef-selection"),r=i.length-1;r>=0;r--)for(var n=i[r],a=["e-vborderright","e-vborderbottom","e-pborderright","e-pborderbottom","e-cborderright","e-cborderbottom","e-gborderright","e-gborderbottom","e-oborderright","e-oborderbottom","e-bborderright","e-bborderbottom","e-formularef-selection"],o=0;o<a.length;o++)n.classList.remove(a[o])},s.prototype.parseFormula=function(e){var t,i,r=0,n=[];e=this.markSpecialChar(e.replace("=",""));for(var a=e.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g),o=a.length;r<o;){if(t=a[r],!t){r++;continue}if(t.length===1)n.push(this.isUniqueChar(t)?this.getUniqueCharVal(t):t);else if(i=t[0],t.indexOf("!")>0){this.isUniqueChar(i)&&(n.push(this.getUniqueCharVal(i)),t=t.substr(1));var l=t.indexOf("!")+1;n.push(t.substr(0,l)),n.push(t.substr(l))}else this.isUniqueChar(i)?(n.push(this.getUniqueCharVal(i)),n.push(t.substr(1))):n.push(t);r++}return n},s.prototype.isUniqueChar=function(e){var t=e.charCodeAt(e.charAt[0]);return t>=129&&t<=142},s.prototype.getUniqueCharVal=function(e){switch(e){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCOperator:return":";case this.uniqueSOperator:return"-";case this.uniquePOperator:return"+";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueCSeparator:return",";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueLTOperator:return"<";case this.uniqueGTOperator:return">"}return""},s.prototype.markSpecialChar=function(e){return e=e.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),e=e.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),e=e.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),e=e.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),e=e.replace(/&/g,"&"+this.uniqueConcateOperator),e=e.replace(/=/g,"="+this.uniqueEqualOperator),e=e.replace(/\^/g,"^"+this.uniqueExpOperator),e=e.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),e.replace(/%/g,"%"+this.uniqueModOperator)},s.prototype.getModuleName=function(){return"selection"},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s}(),p7=function(){function s(e){this.clientX=0,this.isKeyScroll=!0,this.parent=e,this.addEventListener(),this.initProps()}return s.prototype.onContentScroll=function(e){if(this.parent){var t=this.parent.getMainContent().parentElement,i=e.scrollLeft,r=e.scrollTop||t.scrollTop,n=i&&this.parent.enableRtl?this.initScrollValue-i:i,a,o;if(this.parent.allowAutoFill){var l=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn-popup"),h=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(l){var u=Ct(h,"dropdown-btn");u.toggle()}}if(!m(i)&&this.prevScroll.scrollLeft!==n){var c=n>this.prevScroll.scrollLeft;o=this.offset.left.size,this.offset.left=this.getColOffset(n,c,e.skipHidden),e.preventScroll||(this.parent.getColumnHeaderContent().scrollLeft=i,this.parent.getMainContent().scrollLeft=i,e.scrollLeft=i),a={cur:this.offset.left,prev:{idx:this.leftIndex,size:o},increase:c,preventScroll:e.preventScroll},this.updateTopLeftCell(c,!0),this.parent.notify(Yf,a),!this.parent.scrollSettings.enableVirtualization&&c&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualCols(),this.leftIndex=a.prev.idx,this.prevScroll.scrollLeft=n}if(Math.round(this.prevScroll.scrollTop)!==Math.round(r)){e.skipRowVirualScroll&&(this.prevScroll.scrollTop=0,this.offset.top={idx:0,size:0});var d=r>this.prevScroll.scrollTop;o=this.offset.top.size,this.offset.top=this.getRowOffset(r,d),a={cur:this.offset.top,prev:{idx:this.topIndex,size:o},increase:d,preventScroll:e.preventScroll},this.updateTopLeftCell(d),e.preventScroll&&this.offset.top.idx<=this.parent.getThreshold("row")?this.offset.top={idx:0,size:0}:e.skipRowVirualScroll?a.prev.idx=a.cur.idx:this.parent.notify(qf,a),!this.parent.scrollSettings.enableVirtualization&&d&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualRows(),this.topIndex=a.prev.idx,this.prevScroll.scrollTop=r}var p=!1,f={isEdit:p};if(this.parent.notify(bd,f),f.isEdit){var v=this.parent.element.querySelector(".e-formula-bar");v.focus()}this.isKeyScroll=!0}},s.prototype.updateScrollValue=function(e){e.scrollLeft!==void 0&&(this.prevScroll.scrollLeft=e.scrollLeft+(this.prevScroll.scrollLeft-this.offset.left.size),this.offset.left.size=e.scrollLeft),e.scrollTop!==void 0&&(this.prevScroll.scrollTop=e.scrollTop+(this.prevScroll.scrollTop-this.offset.top.size),this.offset.top.size=e.scrollTop)},s.prototype.updateNonVirtualRows=function(){var e=this.parent.getActiveSheet(),t=this.parent.getThreshold("row");this.offset.top.idx>e.rowCount-(this.parent.viewport.rowCount+t)&&(this.parent.renderModule.refreshUI({rowIndex:e.rowCount,colIndex:0,direction:"first",refresh:"RowPart"},Je(e.rowCount,0)+":"+Je(e.rowCount+t-1,e.colCount-1)),this.parent.setSheetPropertyOnMute(e,"rowCount",e.rowCount+t),this.parent.viewport.bottomIndex=e.rowCount-1)},s.prototype.updateNonVirtualCols=function(){var e=this.parent.getActiveSheet(),t=this.parent.getThreshold("col");this.offset.left.idx>e.colCount-(this.parent.viewport.colCount+t)&&(this.parent.renderModule.refreshUI({rowIndex:0,colIndex:e.colCount,direction:"first",refresh:"ColumnPart"},Je(0,e.colCount)+":"+Je(e.rowCount-1,e.colCount+t-1)),this.parent.setSheetPropertyOnMute(e,"colCount",e.colCount+t),this.parent.viewport.rightIndex=e.colCount-1)},s.prototype.updateTopLeftCell=function(e,t){var i=this.parent.getActiveSheet(),r=this.offset.top.idx,n=this.offset.left.idx;if(!e){var a=this.parent.frozenRowCount(i);r=ae(i,r+a,!0)-a;var o=this.parent.frozenColCount(i);n=ae(i,n+o,!0,"columns")-o}t?this.parent.updateTopLeftCell(null,n,"row"):this.parent.updateTopLeftCell(r,null,"col")},s.prototype.getRowOffset=function(e,t){var i=this.offset.top.size,r=this.parent.getActiveSheet(),n=t?this.offset.top.idx+1:this.offset.top.idx?this.offset.top.idx-1:0,a=this.parent.frozenRowCount(r),o=this.parent.scrollSettings.isFinite?r.rowCount:1/0;for(e=Math.round(e);n<o;)if(t){if(i+=Wt(r,n-1+a,!0),Math.abs(Math.round(i)-e)<=1)return{idx:ae(r,n+a,!0)-a,size:i};if(Math.round(i)>e)return{idx:n-1,size:i-Wt(r,n-1+a,!0)};n++}else{if(i-=Wt(r,n+a,!0),i<=0)return{idx:0,size:0};if(Math.abs(Math.round(i)-e)<=1)return{idx:n,size:i};if(Math.round(i)<e)return i+=Wt(r,n+a,!0),Math.round(i)>e?{idx:n,size:i-Wt(r,n+a,!0)<0?0:i-Wt(r,n+a,!0)}:{idx:ae(r,n+1+a,!0)-a,size:i};n--}return{idx:this.offset.top.idx,size:this.offset.top.size}},s.prototype.getColOffset=function(e,t,i){for(var r=this.offset.left.size,n=this.parent.getActiveSheet(),a=t?this.offset.left.idx+1:this.offset.left.idx?this.offset.left.idx-1:0,o=this.parent.frozenColCount(n),l=this.parent.scrollSettings.isFinite?n.colCount:1/0;a<l;)if(t){if(r+=tr(n,a-1+o,i,!0),Math.abs(Math.round(r)-e)<=1)return{idx:ae(n,a+o,!0,"columns")-o,size:r};if(Math.round(r)>e)return{idx:a-1,size:r-tr(n,a-1+o,i,!0)};a++}else{if(r-=tr(n,a+o,i,!0),r<=0)return{idx:0,size:0};if(Math.abs(Math.round(r)-e)<=1)return{idx:a,size:r};if(Math.round(r)<e)return r+=tr(n,a+o,i,!0),Math.round(r)>e?(r=r-tr(n,a+o,i,!0),{idx:a,size:r<0?0:r}):{idx:ae(n,a+1+o,!0,"columns")-o,size:r};a--}return{idx:this.offset.left.idx,size:this.offset.left.size}},s.prototype.contentLoaded=function(e){if(!this.parent.scrollSettings.enableVirtualization){var t=this.parent.createElement("div",{className:"e-virtualtrack"});this.updateNonVirualScrollWidth({scrollTrack:t}),this.parent.getScrollElement().appendChild(t)}e.left&&(this.parent.getScrollElement().scrollLeft=e.left),this.setScrollEvent(),this.parent.enableRtl&&(this.initScrollValue=this.parent.getScrollElement().scrollLeft)},s.prototype.updateNonVirualScrollWidth=function(e){e.scrollTrack||(e.scrollTrack=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0]),e.scrollTrack.style.width=Math.abs(this.parent.getContentTable().getBoundingClientRect().width+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0))+"px"},s.prototype.onHeaderWheel=function(e){e.preventDefault(),this.parent.getMainContent().parentElement.scrollTop+=e.deltaY,this.parent.getScrollElement().scrollLeft+=e.deltaX},s.prototype.onContentWheel=function(e){e.deltaX!==0&&(e.preventDefault(),this.parent.getScrollElement().scrollLeft+=e.deltaX)},s.prototype.scrollHandler=function(e){this.onContentScroll({scrollLeft:e.target.scrollLeft})},s.prototype.updateScroll=function(e){m(e.left)?this.parent.sheetModule.contentPanel.scrollTop=e.top:this.parent.getScrollElement().scrollLeft=e.left},s.prototype.setScrollEvent=function(e){e===void 0&&(e={set:!0}),e.set?(I.add(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll,this),I.add(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel,this),I.add(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel,this),I.add(this.parent.getMainContent(),"wheel",this.onContentWheel,this),I.add(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel,this),I.add(this.parent.getScrollElement(),"scroll",this.scrollHandler,this)):(I.remove(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll),I.remove(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel),I.remove(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel),I.remove(this.parent.getMainContent(),"wheel",this.onContentWheel),I.remove(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel),I.remove(this.parent.getScrollElement(),"scroll",this.scrollHandler))},s.prototype.initProps=function(){this.topIndex=0,this.leftIndex=0,this.prevScroll={scrollLeft:0,scrollTop:0},this.offset={left:{idx:0,size:0},top:{idx:0,size:0}}},s.prototype.setPadding=function(e){this.parent.sheetModule.contentPanel.style.overflowY="scroll";var t=oz();if(t>0){var i=this.parent.getColumnHeaderContent(),r=this.parent.enableRtl?{margin:"marginLeft",border:"borderLeftWidth"}:{margin:"marginRight",border:"borderRightWidth"};i.parentElement.style[r.margin]=t+"px",i.style[r.border]="1px"}e&&(this.initScrollValue=0)},s.prototype.setClientX=function(e){if(!(e.type==="mousedown"||e.pointerType==="mouse")){var t={touchSelectionStarted:!1};if(this.parent.notify(tv,t),!(t.touchSelectionStarted||t.isOverlayClicked)){this.clientX=this.getPointX(e);var i=document.getElementById(this.parent.element.id+"_sheet");I.add(i,B.isPointer?"pointermove":"touchmove",this.onTouchScroll,this),I.add(i,B.isPointer?"pointerup":"touchend",this.pointerUpHandler,this)}}},s.prototype.getPointX=function(e){var t=0;return e.touches&&e.touches.length?t=e.touches[0].clientX:t=e.clientX,t},s.prototype.onTouchScroll=function(e){if(e.pointerType!=="mouse"){var t=this.getPointX(e),i=this.clientX-t,r=this.parent.element.getElementsByClassName("e-scroller")[0];(i>10||i<-10)&&r.scrollLeft+i>=0&&(e.preventDefault(),this.clientX=t,Vi(function(){r.scrollLeft+=i}))}},s.prototype.pointerUpHandler=function(){var e=document.getElementById(this.parent.element.id+"_sheet");I.remove(e,B.isPointer?"pointermove":"touchmove",this.onTouchScroll),I.remove(e,B.isPointer?"pointerup":"touchend",this.pointerUpHandler)},s.prototype.addEventListener=function(){this.parent.on(tn,this.contentLoaded,this),this.parent.on(q1,this.onContentScroll,this),this.parent.on(f0,this.updateScroll,this),this.parent.on(Sd,this.initProps,this),this.parent.on(Dn,this.destroy,this),this.parent.on(UA,this.setScrollEvent,this),this.parent.on(Qo,this.setClientX,this),this.parent.on(g0,this.updateScrollValue,this),this.parent.scrollSettings.enableVirtualization||(this.parent.on(wa,this.updateNonVirualScrollWidth,this),this.parent.on(wn,this.updateNonVirualScrollWidth,this))},s.prototype.destroy=function(){this.removeEventListener();var e=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(e){var t=Ct(e,"dropdown-btn");t&&t.destroy()}this.parent=null},s.prototype.removeEventListener=function(){this.parent.off(tn,this.contentLoaded),this.parent.off(q1,this.onContentScroll),this.parent.off(f0,this.updateScroll),this.parent.off(Sd,this.initProps),this.parent.off(Dn,this.destroy),this.parent.off(UA,this.setScrollEvent),this.parent.off(Qo,this.setClientX),this.parent.off(g0,this.updateScrollValue),this.parent.scrollSettings.enableVirtualization||(this.parent.off(wa,this.updateNonVirualScrollWidth),this.parent.off(wn,this.updateNonVirualScrollWidth))},s}(),f7=function(){function s(e){this.scroll=[],this.parent=e,this.addEventListener()}return s.prototype.createVirtualElement=function(e){var t=this.parent.getActiveSheet(),i=this.parent.getMainContent();this.content=this.parent.createElement("div",{className:"e-virtualable"}),this.content.appendChild(i.querySelector(".e-table")),i.appendChild(this.content);var r=i.appendChild(this.parent.createElement("div",{className:"e-virtualtrack"})),n=0,a;this.parent.sheets.length>this.scroll.length&&this.initScroll();var o=this.parent.viewport.bottomIndex;t.rowCount>o+1||t.usedRange.rowIndex>o?(!this.parent.scrollSettings.isFinite&&t.rowCount<=t.usedRange.rowIndex&&this.parent.setSheetPropertyOnMute(t,"rowCount",t.usedRange.rowIndex+1),this.setScrollCount(t.rowCount,"row")):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(t,"rowCount",o+1),this.scroll[this.parent.activeSheetIndex].rowCount=t.rowCount);var l=this.parent.frozenRowCount(t),h=xe(t.topLeftCell);e.top&&(n=e.top,t.frozenRows&&(n+=Ei(t,h[0],l-1,!0)),l=xe(t.paneTopLeftCell)[0]),n+=Ei(t,l,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0),o=this.parent.viewport.rightIndex;var u=0,c=this.parent.frozenColCount(t);e.left?(u=e.left,c&&(u+=ci(t,h[1],c-1,!0)),l=xe(t.paneTopLeftCell)[1]):l=c,t.colCount>o+1||t.usedRange.colIndex>o?(!this.parent.scrollSettings.isFinite&&t.colCount<=t.usedRange.colIndex&&this.parent.setSheetPropertyOnMute(t,"colCount",t.usedRange.colIndex+1),u+=ci(t,l,o,!0),this.setScrollCount(t.colCount,"col"),a=u+ci(t,o+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0)):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(t,"colCount",o+1),u+=ci(t,l,t.colCount-1,!0),this.scroll[this.parent.activeSheetIndex].colCount=t.colCount,a=u),m(this.parent.viewport.leftIndex)&&(this.parent.viewport.leftIndex=0),m(this.parent.viewport.topIndex)&&(this.parent.viewport.topIndex=0),e.left&&(u=ci(t,this.parent.viewport.leftIndex+c,o,!0)),m(this.translateX)&&(this.translateX=0),m(this.translateY)&&(this.translateY=0),i=this.parent.getRowHeaderContent(),this.rowHeader=this.content.cloneNode(),this.rowHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.rowHeader);var d=i.appendChild(r.cloneNode());this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)",i=this.parent.getColumnHeaderContent(),this.colHeader=this.content.cloneNode(),this.colHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.colHeader);var p=i.appendChild(r.cloneNode());if(this.colHeader.style.width=u+"px",d.style.height=n+"px",p.style.width=a+"px",this.colHeader.style.transform="translate("+this.translateX+"px, 0px)",this.content.style.transform="translate("+this.translateX+"px, "+this.translateY+"px)",this.content.style.width=u+"px",r.style.height=n+"px",r.style.width=a+"px",this.parent.allowScrolling){var f=p.cloneNode(!0);f.style.width=a+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0)+"px",this.parent.getScrollElement().appendChild(f)}},s.prototype.initScroll=function(){for(var e=0;e<this.parent.sheets.length;)this.scroll[e]||this.scroll.push({rowCount:0,colCount:0}),e++},s.prototype.setScrollCount=function(e,t){var i=this.parent.activeSheetIndex;(!this.scroll[i][t+"Count"]||this.scroll[i][t+"Count"]!==e)&&(this.scroll[i][t+"Count"]=e)},s.prototype.getRowAddress=function(e){var t=this.parent.getActiveSheet();return je([e[0],t.frozenColumns?xe(t.topLeftCell)[1]:this.parent.viewport.leftIndex,e[1],this.parent.viewport.rightIndex])},s.prototype.getColAddress=function(e){var t=this.parent.getActiveSheet();return je([t.frozenRows?xe(t.topLeftCell)[0]:this.parent.viewport.topIndex,e[0],this.parent.viewport.bottomIndex,e[1]])},s.prototype.updateScrollCount=function(e,t,i){i===void 0&&(i=e);var r=this.parent.getActiveSheet(),n=e+this.parent.viewport[t+"Count"]+1+i,a=this.scroll[this.parent.activeSheetIndex][t+"Count"];if(n<a){if(r[t+"Count"]===a)return;n=a}this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(r,t+"Count",n)},s.prototype.onVerticalScroll=function(e){var t=e.cur.idx,i=e.cur.size,r=e.prev.idx,n=Math.abs(t-r),a=this.parent.getThreshold("row");if(n>Math.round(a/2)){var o=void 0,l=void 0,h=void 0,u=this.parent.getActiveSheet();if(t<=a&&!e.increase){if(this.translateY&&r>a){this.translateY=0;var c=this.parent.frozenColCount(u),d=this.parent.frozenRowCount(u);if(e.preventScroll)this.parent.viewport.topIndex=r-(a-d);else{var p=c?xe(u.topLeftCell)[1]:this.parent.viewport.leftIndex,f=c?[d,this.parent.viewport.leftIndex+c]:[];if(n<this.parent.viewport.rowCount+a){o=ae(u,d,!0),l=ae(u,this.parent.viewport.topIndex+d-1,!1),this.parent.viewport.topIndex=o-d;var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-o+1-this.hiddenCount(o,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=ae(u,v,!1),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:o,direction:"last",refresh:"RowPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getRowAddress([o,ae(u,l,!1)]))}else{var g=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:0,colIndex:p,refresh:"Row",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),c&&(this.parent.viewport.leftIndex=g),this.translate({refresh:"Row"})}Fe(this.parent.element),t=0}}this.updateScrollCount(a,"row")}if(r<a&&(n=Math.abs(t-a)),!e.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===ae(u,u.rowCount-1,!1)){var d=this.parent.frozenRowCount(u),b=this.parent.viewport.topIndex+d+ee(u.paneTopLeftCell)[0]-1;if(t+d>b){e.prev.idx=t;return}n=b-(t+d)}if(t>a){if(h=this.parent.viewport.topIndex,this.parent.viewport.topIndex=t-a,e.increase&&h>this.parent.viewport.topIndex){this.parent.viewport.topIndex=h;return}var d=this.parent.frozenRowCount(u);if(e.preventScroll)this.setThresholdHeight(i,a,d),this.translate({refresh:"Row"});else{var c=this.parent.frozenColCount(u),p=void 0,y=[];if(c?(p=xe(u.topLeftCell)[1],y.push(d),y.push(this.parent.viewport.leftIndex+c)):p=this.parent.viewport.leftIndex,n<this.parent.viewport.rowCount+a)if(e.increase){if(o=this.parent.viewport.bottomIndex+1,l=this.parent.viewport.bottomIndex+(this.parent.viewport.topIndex-h),l-=this.hiddenCount(h+d,this.parent.viewport.topIndex-1+d),l<=this.parent.viewport.bottomIndex||this.parent.scrollSettings.isFinite&&o>ae(u,u.rowCount-1,!1,"rows")){this.parent.viewport.topIndex=h;return}var C=this.parent.skipHidden(o,l,"rows",!1),x=this.checkLastIdx(C[1],"row");o=C[0],l=x.index;var w=this.parent.viewport.topIndex+d;if(x.diff){var M=l-o+1-this.hiddenCount(o,l);w=ae(u,h,!0,"rows",M)+d}this.parent.viewport.topIndex=ae(u,w,!x.diff)-d,this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d,!!x.diff,h===ae(u,d,!0)),this.parent.viewport.bottomIndex=l,this.parent.renderModule.refreshUI({colIndex:p,rowIndex:o,direction:"first",refresh:"RowPart",frozenIndexes:y},this.getRowAddress([o,l]))}else{if(o=ae(u,this.parent.viewport.topIndex+d,!1),o<d&&(o=d,o=ae(u,o,!0)),this.parent.viewport.topIndex=o-d,l=ae(u,h+d-1,!1),l<d||l<o){this.parent.viewport.topIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-o+1-this.hiddenCount(o,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=ae(u,v,!1),this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:o,direction:"last",refresh:"RowPart",frozenIndexes:y},this.getRowAddress([o,l]))}else h=this.parent.viewport.leftIndex,this.parent.viewport.topIndex=ae(u,this.parent.viewport.topIndex+d,!1)-d,this.parent.viewport.topIndex<0&&(this.parent.viewport.topIndex=ae(u,d,!0)-d),this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:p,refresh:"Row",frozenIndexes:y,skipTranslate:!0}),c&&(this.parent.viewport.leftIndex=h),this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d,this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===ae(u,u.rowCount-1,!1)),this.translate({refresh:"Row"});this.updateScrollCount(t,"row",a),this.focusSheet()}}e.prev.idx=t}},s.prototype.skipHiddenLastIdx=function(e,t,i){i===void 0&&(i="rows");for(var r=this.parent.getActiveSheet(),n=0,a=e;a<=t;a++)r[""+i][a]&&r[""+i][a].hidden&&n++;return n&&(e=this.skipHiddenLastIdx(e-n,e-1,i)),e},s.prototype.hiddenCount=function(e,t,i){i===void 0&&(i="rows");for(var r=0,n=this.parent.getActiveSheet(),a=e;a<=t;a++)n[""+i][a]&&n[""+i][a].hidden&&r++;return r},s.prototype.checkLastIdx=function(e,t){var i=0;if(this.parent.scrollSettings.isFinite){var r=this.parent.getActiveSheet(),n=ae(r,r[t+"Count"]-1,!1);e>n&&(i=e-n,e=n)}return{index:e,diff:i}},s.prototype.onHorizontalScroll=function(e){var t=e.cur.idx,i=e.cur.size,r=e.prev.idx,n=Math.abs(t-r),a=this.parent.getThreshold("col");if(n>Math.round(a/2)){var o=void 0,l=void 0,h=void 0,u=this.parent.getActiveSheet();if(t<=a&&!e.increase){if(this.translateX&&r>a){this.translateX=0;var c=this.parent.frozenColCount(u),d=this.parent.frozenRowCount(u);if(e.preventScroll)this.parent.viewport.leftIndex=r-(a-c);else{var p=d?xe(u.topLeftCell)[0]:this.parent.viewport.topIndex,f=d?[this.parent.viewport.topIndex+d,c]:[];if(n<this.parent.viewport.colCount+a){o=ae(u,c,!0,"columns"),l=ae(u,this.parent.viewport.leftIndex+c-1,!1,"columns"),this.parent.viewport.leftIndex=o-c;var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-o+1-this.hiddenCount(o,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=ae(u,v,!1,"columns"),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:o,direction:"last",refresh:"ColumnPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getColAddress([o,ae(u,l,!1,"columns")]))}else{var g=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({rowIndex:p,colIndex:0,refresh:"Column",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=g),this.translate({refresh:"Column"})}Fe(this.parent.element),t=0}}this.updateScrollCount(a,"col")}if(r<a&&(n=Math.abs(t-a)),!e.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===ae(u,u.colCount-1,!1,"columns")){var c=this.parent.frozenColCount(u),b=this.parent.viewport.leftIndex+c+ee(u.paneTopLeftCell)[1]-1;if(b+=this.hiddenCount(this.parent.viewport.leftIndex+c,b),t+c>b){e.prev.idx=t;return}n=b-(t+c)}if(t>a){if(h=this.parent.viewport.leftIndex,this.parent.viewport.leftIndex=t-a,e.increase&&h>this.parent.viewport.leftIndex){this.parent.viewport.leftIndex=h;return}var c=this.parent.frozenColCount(u);if(e.preventScroll)this.setThresholdWidth(i,a,c),this.translate({refresh:"Column"});else{var d=this.parent.frozenRowCount(u),p=d?xe(u.topLeftCell)[0]:this.parent.viewport.topIndex,y=[];if(d&&(y=[d+this.parent.viewport.topIndex,c]),n<this.parent.viewport.colCount+a)if(e.increase){if(o=this.parent.viewport.rightIndex+1,l=this.parent.viewport.rightIndex+(this.parent.viewport.leftIndex-h),l-=this.hiddenCount(h+c,this.parent.viewport.leftIndex-1+c,"columns"),l<=this.parent.viewport.rightIndex||this.parent.scrollSettings.isFinite&&o>ae(u,u.colCount-1,!1,"columns")){this.parent.viewport.leftIndex=h;return}var C=this.parent.skipHidden(o,l,"columns",!1),x=this.checkLastIdx(C[1],"col");o=C[0],l=x.index,this.parent.viewport.leftIndex=ae(u,this.parent.viewport.leftIndex-x.diff+c,!x.diff,"columns")-c,this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c,!!x.diff,h===ae(u,c,!0,"columns")),this.parent.viewport.rightIndex=l,this.parent.renderModule.refreshUI({rowIndex:p,colIndex:o,direction:"first",refresh:"ColumnPart",frozenIndexes:y},this.getColAddress([o,l]))}else{if(o=ae(u,this.parent.viewport.leftIndex+c,!1,"columns"),o<c&&(o=c,o=ae(u,o,!0,"columns")),this.parent.viewport.leftIndex=o-c,l=ae(u,h+c-1,!1,"columns"),l<c||l<o){this.parent.viewport.leftIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-o+1-this.hiddenCount(o,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=ae(u,v,!1,"columns"),this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:o,direction:"last",refresh:"ColumnPart",frozenIndexes:y},this.getColAddress([o,l]))}else h=this.parent.viewport.topIndex,this.parent.viewport.leftIndex=ae(u,this.parent.viewport.leftIndex+c,!1,"columns")-c,this.parent.viewport.leftIndex<0&&(this.parent.viewport.leftIndex=ae(u,c,!0,"columns")-c),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:y,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=h),this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c,this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===ae(u,u.colCount-1,!1,"columns")),this.translate({refresh:"Column"});this.updateScrollCount(t,"col",a),this.focusSheet()}}e.prev.idx=t}},s.prototype.focusSheet=function(){(!document.activeElement.classList.contains("e-text-findNext-short")||!U(document.activeElement,"#"+this.parent.element.id))&&Fe(this.parent.element)},s.prototype.setThresholdHeight=function(e,t,i,r,n){var a=this.parent.getActiveSheet(),o=this.parent.viewport.topIndex+i,l=o+t-1;r||n||l<o?this.translateY=o<=i?0:Ei(a,i,o-1,!0):this.translateY=e-Ei(a,o,l,!0)},s.prototype.setThresholdWidth=function(e,t,i,r,n){var a=this.parent.getActiveSheet(),o=this.parent.viewport.leftIndex+i,l=o+t-1;r||n||l<o?this.translateX=o<=i?0:ci(a,i,o-1,!0):this.translateX=e-ci(a,o,l,!0)},s.prototype.translate=function(e){if(!(e.skipTranslate||!this.content)){var t=this.translateX||0;t=this.parent.enableRtl?-t:t,(e.refresh==="Row"||e.refresh==="RowPart")&&(this.content.style.transform="translate("+t+"px, "+this.translateY+"px)",this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)"),(e.refresh==="Column"||e.refresh==="ColumnPart")&&(this.content.style.transform="translate("+t+"px, "+this.translateY+"px)",this.colHeader.style.transform="translate("+t+"px, 0px)")}},s.prototype.updateColumnWidth=function(e){if(e.refresh==="Column"){this.content.style.width="";var t=this.parent.getActiveSheet(),i=ci(t,this.parent.viewport.leftIndex+this.parent.frozenColCount(t),this.parent.viewport.rightIndex,!0);if(this.colHeader.style.width=i+"px",this.content.style.width=i+"px",!this.parent.scrollSettings.isFinite||e.isUpdate){var r=this.parent.element.querySelector(".e-scroller .e-virtualtrack");if(!r)return;var n=parseInt(r.style.width,10),a=i+this.translateX+this.parent.viewport.beforeFreezeWidth;if(a>n){var o=a-n;r.style.width=n+o+"px"}else{var o=n-a,l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];n-o<parseInt(l.style.width,10)&&(r.style.width=l.style.width)}}}else if(!this.parent.scrollSettings.isFinite){var l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0],h=parseInt(l.style.height,10),u=this.content.getBoundingClientRect().height,c=u+this.translateY+this.parent.viewport.beforeFreezeHeight;if(c>h){var o=c-h;l.style.height=h+o+"px"}else{var o=h-c,d=this.parent.getRowHeaderContent().getElementsByClassName("e-virtualtrack")[0];h-o<parseInt(d.style.height,10)&&(l.style.height=d.style.height)}}},s.prototype.updateRowColCount=function(e){if(this.scroll.length){var t=this.parent.getActiveSheet();if(e.update==="row"){if(e.index!==this.scroll[this.parent.activeSheetIndex].rowCount-1){var i=this.getVTrackHeight("height"),r=i;if(e.index>=this.scroll[this.parent.activeSheetIndex].rowCount?e.start===void 0?r+=Ei(t,this.scroll[this.parent.activeSheetIndex].rowCount,e.index,!0):r+=Ei(t,e.start,e.end,!0):e.start===void 0?r-=Ei(t,e.index+1,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0):r-=Ei(t,e.start,e.end,!0),!e.isDelete&&r<i)return;this.scroll[this.parent.activeSheetIndex].rowCount=e.index+1,this.updateVTrack(this.rowHeader,r,"height"),this.scroll[this.parent.activeSheetIndex].rowCount>t.rowCount&&this.parent.setSheetPropertyOnMute(t,"rowCount",this.scroll[this.parent.activeSheetIndex].rowCount)}}else if(e.index!==this.scroll[this.parent.activeSheetIndex].colCount-1){var n=this.getVTrackHeight("width"),a=n;if(e.index>=this.scroll[this.parent.activeSheetIndex].colCount?e.start===void 0?a+=ci(t,this.scroll[this.parent.activeSheetIndex].colCount,e.index,!0):a+=ci(t,e.start,e.end,!0):e.start===void 0?a-=ci(t,e.index+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0):a-=ci(t,e.start,e.end,!0),!e.isDelete&&a<n)return;this.scroll[this.parent.activeSheetIndex].colCount=e.index+1,this.updateVTrack(this.colHeader,a,"width"),this.scroll[this.parent.activeSheetIndex].colCount>t.colCount&&this.parent.setSheetPropertyOnMute(t,"colCount",this.scroll[this.parent.activeSheetIndex].colCount)}}},s.prototype.getVTrackHeight=function(e){var t=this.content.nextElementSibling.style[""+e];if(t.includes("e+")){t=t.split("px")[0];var i=t.split("e+");return Number(i[0])*Math.pow(10,Number(i[1]))}else return parseFloat(t)},s.prototype.updateVTrackHeight=function(e){var t=this.parent.frozenRowCount(this.parent.getActiveSheet());if(e.rowIdx<this.scroll[this.parent.activeSheetIndex].rowCount&&this.updateVTrack(this.rowHeader,this.getVTrackHeight("height")+e.threshold,"height"),e.rowIdx>=t&&e.rowIdx<this.parent.viewport.topIndex+t){var i=this.parent.element.getElementsByClassName("e-main-panel")[0];this.parent.scrollModule.prevScroll.scrollTop=i.scrollTop+e.threshold,this.parent.scrollModule.offset.top.size+=e.threshold,i.scrollTop+=e.threshold,this.translateY+=e.threshold,this.translate({refresh:"Row"})}},s.prototype.updateVTrackWidth=function(e){if(!Yt(this.parent.getActiveSheet(),e.colIdx)){var t=this.parent.frozenColCount(this.parent.getActiveSheet());if(e.colIdx>=this.parent.viewport.leftIndex+t&&e.colIdx<=this.parent.viewport.rightIndex){var i=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualtrack")[0];i.style.width=parseFloat(i.style.width)+e.threshold+"px";var r=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];r.style.width=parseFloat(r.style.width)+e.threshold+"px";var n=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0];n.style.width=parseFloat(n.style.width)+e.threshold+"px";var a=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualable")[0];a.style.width=parseFloat(a.style.width)+e.threshold+"px";var o=this.parent.getMainContent().getElementsByClassName("e-virtualable")[0];o.style.width=parseFloat(o.style.width)+e.threshold+"px"}else e.colIdx>=t&&e.colIdx<this.parent.viewport.leftIndex+t&&(this.parent.scrollModule.offset.left.size+=e.threshold,this.translateX+=e.threshold,this.translate({refresh:"Column"}))}},s.prototype.updateVTrack=function(e,t,i){e.nextElementSibling.style[""+i]=t+"px",this.content.nextElementSibling.style[""+i]=t+"px",i==="width"&&this.parent.allowScrolling&&(this.parent.getScrollElement().firstElementChild.style.width=t+"px")},s.prototype.deInitProps=function(){this.parent.viewport.leftIndex=null,this.parent.viewport.topIndex=null,this.parent.viewport.bottomIndex=null,this.translateX=null,this.translateY=null},s.prototype.updateScrollProps=function(e){var t=this;e===void 0&&(e={sheetIndex:0,sheets:this.parent.sheets}),this.scroll.length===0?this.initScroll():e.sheets.forEach(function(){t.scroll.splice(e.sheetIndex,0,{rowCount:0,colCount:0})})},s.prototype.sliceScrollProps=function(e){m(e.sheetIndex)?this.scroll.length=0:this.scroll.splice(e.sheetIndex,1)},s.prototype.updateTranslate=function(e){if(e.height){if(e.isRender)this.translateY-=e.height;else{var t=parseInt(this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0].style.height,10);e.isHide?(this.updateVTrack(this.rowHeader,t-e.height,"height"),this.setThresholdHeight(this.translateY,e.prevSize-1-this.parent.viewport.topIndex+1,this.parent.frozenRowCount(this.parent.getActiveSheet()))):(this.updateVTrack(this.rowHeader,t+e.height,"height"),this.translateY=this.translateY+e.size)}this.translate({refresh:"Row"})}e.width&&(this.translateX-=e.width,this.translate({refresh:"Column"}))},s.prototype.addEventListener=function(){this.parent.on(I1,this.createVirtualElement,this),this.parent.on(T1,this.translate,this),this.parent.on(wa,this.updateColumnWidth,this),this.parent.on(dM,this.updateColumnWidth,this),this.parent.on(qf,this.onVerticalScroll,this),this.parent.on(Yf,this.onHorizontalScroll,this),this.parent.on(hd,this.updateRowColCount,this),this.parent.on(an,this.updateVTrackHeight,this),this.parent.on(wn,this.updateVTrackWidth,this),this.parent.on(Sd,this.deInitProps,this),this.parent.on(Jl,this.sliceScrollProps,this),this.parent.on(Ff,this.updateScrollProps,this),this.parent.on(Qh,this.updateTranslate,this),this.parent.on(Dn,this.destroy,this)},s.prototype.destroy=function(){this.removeEventListener(),this.rowHeader=null,this.colHeader=null,this.content=null,this.parent=null,this.scroll.length=0,this.translateX=null,this.translateY=null},s.prototype.removeEventListener=function(){this.parent.off(I1,this.createVirtualElement),this.parent.off(T1,this.translate),this.parent.off(wa,this.updateColumnWidth),this.parent.off(dM,this.updateColumnWidth),this.parent.off(qf,this.onVerticalScroll),this.parent.off(Yf,this.onHorizontalScroll),this.parent.off(hd,this.updateRowColCount),this.parent.off(an,this.updateVTrackHeight),this.parent.off(wn,this.updateVTrackWidth),this.parent.off(Jl,this.sliceScrollProps),this.parent.off(Ff,this.updateScrollProps),this.parent.off(Qh,this.updateTranslate),this.parent.off(Dn,this.destroy)},s}(),v7=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(Ra,this.keyDownHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Ra,this.keyDownHandler)},s.prototype.keyDownHandler=function(e){var t=this,i=e.target;if(e.altKey&&e.keyCode===38&&this.parent.element.lastElementChild.classList.contains("e-filter-popup")){this.parent.notify(n0,{closePopup:!0});return}var r=this.parent.serviceLocator.getService(At).dialogInstance,n=i.id===this.parent.element.id+"_name_box";if(this.parent.selectionSettings.mode==="None"||r||this.parent.isEdit||i.classList.contains("e-ss-ddb")&&e.keyCode!==117&&e.keyCode!==9||n&&e.keyCode!==117||i.classList.contains("e-sheet-rename")||i.id===this.parent.element.id+"_SearchBox"||i.classList.contains("e-chk-hidden")||i.classList.contains("e-ddl")&&i.classList.contains("e-input-focus")){if(r){if(e.keyCode===13)r.element.classList.contains("e-spreadsheet-function-dlg")&&(i.classList.contains("e-formula-list")||i.classList.contains("e-list-item"))&&Fe(r.element.querySelector(".e-footer-content .e-primary"));else if(e.keyCode===9){if(r.element.classList.contains("e-find-dlg")){var a=r.element.querySelectorAll(".e-footer-content .e-btn:not(:disabled)"),o=a.length?a[a.length-1].className:"e-findnreplace-checkmatch";if(e.shiftKey){if(document.activeElement.classList.contains("e-dlg-closeicon-btn"))if(e.preventDefault(),a.length)Fe(a[a.length-1]);else{var l=r.element.querySelector(".e-findnreplace-exactmatchcheckbox");l&&(Fe(l.querySelector(".e-findnreplace-checkmatch")),l.classList.add("e-focus"))}}else document.activeElement.className.includes(o)&&Fe(r.element)}else if(r.element.classList.contains("e-protect-dlg")){if(e.shiftKey?document.activeElement.classList.contains("e-primary"):document.activeElement.id===this.parent.element.id+"_protect_check"){var h=r.element.querySelector(".e-protect-option-list");if(h&&!h.querySelector(".e-list-item.e-focused")){var u=h.querySelector(".e-list-item");u&&u.classList.add("e-focused")}}}else if(r.element.classList.contains("e-custom-format-dlg"))if(e.shiftKey){if(document.activeElement.className.includes("e-list-item e-active")){var h=U(document.activeElement,".e-custom-listview");h&&Fe(h)}}else if(document.activeElement.classList.contains("e-btn")&&document.activeElement.parentElement.classList.contains("e-custom-dialog")){var h=r.element.querySelector(".e-custom-listview"),c=Ct(h,"listview");if(h){var u=h.querySelector(".e-list-item.e-active");if(!u)if(u=h.querySelector(".e-list-item"),u)c.selectItem(u);else return;e.preventDefault(),u.focus()}}else document.activeElement.classList.contains("e-list-item")&&Fe(r.element);else if(r.element.classList.contains("e-spreadsheet-function-dlg")){if(e.shiftKey&&document.activeElement.className.includes("e-list-item e-active")){var h=U(document.activeElement,".e-formula-list");h&&Fe(h)}}else if(r.element.classList.contains("e-goto-dlg"))if(e.shiftKey){if(document.activeElement.className.includes("e-dlg-closeicon-btn")){var d=r.element.querySelector(".e-footer-content .e-btn");d&&(e.preventDefault(),Fe(d))}}else document.activeElement.className.includes("e-btn-goto-ok")&&Fe(r.element)}}else n&&e.keyCode===9&&e.shiftKey&&this.focusEle(e,".e-formula-bar",!1,!0);var p={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,p);var f=Bt(p.editedValue,!0);this.parent.isEdit&&f&&e.shiftKey&&!e.ctrlKey&&Gh(e.keyCode)&&this.shiftSelection(e);return}var v=this.parent.getActiveSheet(),g=xe(v.activeCell);if(e.altKey){if(e.keyCode===40){if(i.classList.contains("e-dropdown-btn")||i.classList.contains("e-split-btn"))return;var b={e,isFilterCell:!1};if(this.parent.notify(n0,b),b.isFilterCell)return}if(e.keyCode===40&&!document.getElementById(this.parent.element.id+"listValid_popup")){var y=this.parent.getCell(g[0],g[1]);if(y){var C=y.querySelector(".e-validation-list .e-ddl");if(C){Fe(C);var x=C.querySelector(".e-dropdownlist")||C,c=Ct(x,"dropdownlist");c&&c.showPopup();return}}}}i.id===this.parent.element.id+"_File"&&Fe(this.parent.element);var w=i.classList.contains("e-add-sheet-tab")||i.classList.contains("e-sheets-list")||i.classList.contains("e-tab-wrap")&&!!U(i,".e-sheet-tabs-items")||i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-nav");[9,37,38,39,40,33,34,35,36].indexOf(e.keyCode)>-1&&!w&&e.preventDefault();var M,E=ee(v.selectedRange);if(e.keyCode===36){var T=this.parent.frozenColCount(v),D=void 0;if(e.ctrlKey||e.metaKey){var N=ae(v,this.parent.frozenRowCount(v),!0);e.shiftKey?D=[g[0],g[1],N,ae(v,T,!0,"columns")]:(D=[N,ae(v,T,!0,"columns"),N],D[3]=D[1]);var A=this.parent.element.querySelector(".e-main-panel");A.scrollTop&&(A.scrollTop=0);var L=this.parent.getScrollElement();L.scrollLeft&&(L.scrollLeft=0)}else if(e.shiftKey){var k=ae(v,T,!0,"columns");v.frozenColumns&&ae(v,g[1],!0,"columns")===k?D=[E[0],g[1],E[2],ae(v,0,!0,"columns")]:D=[E[0],g[1],E[2],k],this.scrollNavigation([D[2],D[3]],!0)}else{var k=ae(v,T,!0,"columns");v.frozenColumns&&(k===g[1]||T===g[1])&&(k=ae(v,0,!0,"columns")),D=[g[0],k,g[0],k],this.scrollNavigation([D[0],D[1]],!0)}this.updateSelection(v,D)}else if(e.ctrlKey||e.metaKey){if(e.keyCode===35){e.preventDefault();var O=ae(v,v.usedRange.rowIndex,!1);O=O>-1?O:v.usedRange.rowIndex;var R=ae(v,v.usedRange.colIndex,!1,"columns");R=R>-1?R:v.usedRange.colIndex,e.shiftKey||(g[0]=O,g[1]=R),g[2]=O,g[3]=R,this.updateSelection(v,g),this.scrollNavigation([O,R],!0)}else e.keyCode===32&&!e.shiftKey&&(E[0]=0,E[2]=v.rowCount-1,this.updateSelection(v,E));if(e.keyCode===40||e.keyCode===39||e.keyCode===38||e.keyCode===37)e.shiftKey?(e.keyCode===40?E[2]=this.getNextNonEmptyCell(E[2],g[1],"down"):e.keyCode===39?E[3]=this.getNextNonEmptyCell(g[0],E[3],"right"):e.keyCode===38?E[2]=this.getNextNonEmptyCell(E[2],g[1],"top"):E[3]=this.getNextNonEmptyCell(g[0],E[3],"left"),this.updateSelection(v,E),this.scrollNavigation([E[2],E[3]],!0)):(e.keyCode===37?g[1]=this.getNextNonEmptyCell(g[0],g[1],"left"):e.keyCode===38?g[0]=this.getNextNonEmptyCell(g[0],g[1],"top"):e.keyCode===39?g[1]=this.getNextNonEmptyCell(g[0],g[1],"right"):g[0]=this.getNextNonEmptyCell(g[0],g[1],"down"),this.parent.selectRange(je(g)),this.scrollNavigation([g[0],g[1]],!0));else if(e.keyCode===117){var j=document.activeElement;j.classList.contains("e-spreadsheet")||U(j,".e-sheet")?this.setFocus("Sheet",e,!0):w?this.setFocus("SheetTabs",e):U(j,".e-ribbon")?this.setFocus("Ribbon",e):(n||j.classList.contains("e-insert-function"))&&this.setFocus("FormulaBar",e)}}else{if(e.shiftKey){if(e.keyCode===32&&(e.preventDefault(),E[1]=0,E[3]=v.colCount-1,this.updateSelection(v,E)),this.shiftSelection(e),(e.keyCode===34||e.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var P=0,A=this.parent.element.querySelector(".e-main-panel"),F=ae(v,xe(v.paneTopLeftCell)[0],!0),z=Yc(this.parent,F).height;if(e.keyCode===34){if(P=z+this.parent.scrollModule.offset.top.size,!this.parent.scrollSettings.isFinite){var q=this.parent.getMainContent().querySelector(".e-virtualtrack");q&&parseFloat(q.style.height)<P+z&&(q.style.height=P+z+"px")}}else if(P=this.parent.scrollModule.offset.top.size-z,Math.round(P)<0)if(A.scrollTop)P=0;else{this.parent.selectRange(je([E[0],E[1],F,E[3]]));return}var X=ae(v,ee(v.selectedRange)[2],!0),G=F>X?0:X-F;this.parent.scrollModule&&A.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),A.scrollTop=P,Vi(function(){e.keyCode===34?(E[2]=ae(v,xe(v.paneTopLeftCell)[0]+G,!0),t.parent.scrollSettings.isFinite&&E[2]>v.rowCount-1&&(E[2]=ae(v,v.rowCount-1,!1),E[2]=E[2]<0?0:E[2])):(E[2]=ae(v,xe(v.paneTopLeftCell)[0]+G,!1),E[2]=E[2]<0?0:E[2]),t.updateSelection(v,E)})}}else if(e.keyCode===9||(this.parent.enableRtl?e.keyCode===37:e.keyCode===39)){var y=Y(g[0],g[1],v);if(y&&y.colSpan>1&&(g[1]+=y.colSpan-1),g[1]<v.colCount-1&&(!v.isProtected||v.protectSettings.selectCells))g[1]+=1,M=!0;else if(v.protectSettings.selectUnLockedCells){var Z=this.getNextUnlockedCell("right",g);M=g[1]!==Z[1]||g[0]!==Z[0],g[1]=Z[1],g[0]=Z[0]}}else if(e.keyCode===13||e.keyCode===40){var y=Y(g[0],g[1],v);if(y&&y.rowSpan>1&&(g[0]+=y.rowSpan-1),g[0]<v.rowCount-1&&(!v.isProtected||v.protectSettings.selectCells))M=!0,g[0]+=1;else if(v.protectSettings.selectUnLockedCells){var Z=this.getNextUnlockedCell("down",g);M=g[0]!==Z[0]||g[1]!==Z[1],g[1]=Z[1],g[0]=Z[0]}}else if((e.keyCode===34||e.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var A=this.parent.element.querySelector(".e-main-panel"),P=0,se=ae(v,xe(v.paneTopLeftCell)[0],!0),oe=ae(v,xe(v.activeCell)[0],!0),z=Yc(this.parent,se).height;if(e.keyCode===34){if(P=this.parent.scrollModule.offset.top.size+z,!this.parent.scrollSettings.isFinite){var q=this.parent.getMainContent().querySelector(".e-virtualtrack");q&&parseFloat(q.style.height)<P+z&&(q.style.height=P+z+"px")}}else{if(P=this.parent.scrollModule.offset.top.size-z,v.frozenRows&&g[0]<this.parent.frozenRowCount(v)){this.parent.selectRange(je([se,E[1],se,E[1]]));return}if(Math.round(P)<0)if(A.scrollTop)P=0;else return}var fe=se>oe?0:oe-se;this.parent.scrollModule&&A.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),A.scrollTop=P,Vi(function(){var Ae;e.keyCode===34?(Ae=ae(v,xe(v.paneTopLeftCell)[0]+fe,!0),t.parent.scrollSettings.isFinite&&Ae>v.rowCount-1&&(Ae=ae(v,v.rowCount-1,!1),Ae=Ae<0?0:Ae)):(Ae=xe(v.paneTopLeftCell)[0]+fe,Ae-=t.parent.hiddenCount(se,oe),Ae=ae(v,Ae,!1),Ae=Ae<0?0:Ae),t.parent.notify($y,{range:[Ae,g[1]],preventAnimation:!0})})}if(e.shiftKey?e.keyCode===9:this.parent.enableRtl?e.keyCode===39:e.keyCode===37){if(g[1]>0&&(!v.isProtected||v.protectSettings.selectCells))g[1]-=1,M=!0;else if(v.protectSettings.selectUnLockedCells){var Z=this.getNextUnlockedCell("left",g);M=g[1]!==Z[1]||g[0]!==Z[0],g[1]=Z[1],g[0]=Z[0]}if(g[1]<=0){var be=this.parent.getMainContent();g[1]===0&&be.scrollLeft&&!this.parent.enableRtl&&(be.scrollLeft=0)}}else if((e.shiftKey?e.keyCode===13:e.keyCode===38)&&!this.parent.element.querySelector(".e-find-toolbar")){if(g[0]>0&&(!v.isProtected||v.protectSettings.selectCells))g[0]-=1,M=!0;else if(v.protectSettings.selectUnLockedCells){var Ne=this.getNextUnlockedCell("up",g);M=g[0]!==Ne[0]||g[1]!==Ne[1],g[1]=Ne[1],g[0]=Ne[0]}if(g[0]<=0){var we=this.parent.getMainContent().parentElement;g[0]===0&&we.scrollTop&&(we.scrollTop=0)}}}if(M&&(!this.parent.scrollModule||this.parent.scrollModule.isKeyScroll)&&!w&&!U(document.activeElement,".e-ribbon")&&!i.classList.contains("e-insert-function")&&(!i.classList.contains("e-formula-bar")||i.classList.contains("e-formula-bar")&&i.nodeName==="TEXTAREA"&&e.keyCode===13)){if(e.keyCode===40||e.keyCode===38||e.keyCode===13){for(;ct(v,g[0]);)if((e.keyCode===40||!e.shiftKey&&e.keyCode===13)&&(g[0]=g[0]+1),(e.keyCode===38||e.shiftKey&&e.keyCode===13)&&(g[0]=g[0]-1,g[0]<0))return}if(e.keyCode===37||e.keyCode===39||e.keyCode===9){for(;Yt(v,g[1]);)if((e.keyCode===39||!e.shiftKey&&e.keyCode===9)&&(g[1]=g[1]+1),(e.keyCode===37||e.shiftKey&&e.keyCode===9)&&(g[1]=g[1]-1,g[1]<0))return}this.scrollNavigation(g);var H=je(g),V=function(K){if(H!==v.selectedRange){t.parent.setSheetPropertyOnMute(v,"activeCell",H),t.parent.notify($y,{range:g,preventAnimation:K});var ue;B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)&&(ue=t.parent.element.querySelector(".e-ss-focus-edit")),ue=ue||t.parent.getCell(g[0],g[1]),ue&&Fe(ue)}};if(this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){if(H===v.selectedRange)return;Vi(V.bind(this,!0))}else V()}else if(e.keyCode===9){var re=this.parent.showRibbon&&U(document.activeElement,".e-ribbon");if(re)U(document.activeElement,".e-tab-header")?e.shiftKey||re.classList.contains("e-collapsed")?this.focusEle(e,".e-ribbon .e-drop-icon"):this.focusEle(e,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay) .e-btn"):U(document.activeElement,".e-content")?e.shiftKey?this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.focusEle(e,".e-ribbon .e-drop-icon"):document.activeElement.classList.contains("e-drop-icon")&&(e.shiftKey&&!re.classList.contains("e-collapsed")?this.focusEle(e,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay) .e-btn"):this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0));else if(i.classList.contains("e-insert-function"))e.shiftKey?this.focusEle(e,".e-formula-bar-panel .e-combobox"):this.focusEle(e,".e-formula-bar",!1,!0);else if(w)if(e.shiftKey){var he=i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-left-nav");if(i.classList.contains("e-add-sheet-tab")||he||i.classList.contains("e-sheets-list")&&i.previousElementSibling&&i.previousElementSibling.disabled){var Ie=!he&&this.parent.element.querySelector(".e-aggregate-list");if(Ie)this.focusEle(e,null,!1,!1,Ie);else if(!i.classList.contains("e-scroll-left-nav")&&this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-right-nav",!0);else{var Te=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item"));Te[Te.length-1]&&this.focusEle(e,null,!0,!1,Te[Te.length-1].querySelector(".e-tab-wrap"))}}else if(i.classList.contains("e-scroll-right-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-left-nav",!0);else if(i.classList.contains("e-tab-wrap")){var Te=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),Z=Te.indexOf(i.parentElement);Z===0?this.focusEle(e,".e-sheet-tab-panel .e-sheets-list"):this.focusEle(e,null,!0,!1,Te[Z-1].querySelector(".e-tab-wrap"))}}else{var rt=!!this.parent.element.querySelector(".e-aggregate-list");if(i.classList.contains("e-aggregate-list")||!rt&&i.classList.contains("e-scroll-right-nav"))this.focusEle(e,".e-sheet-tab-panel .e-icon-btn:not(:disabled)");else if(i.classList.contains("e-sheets-list"))this.focusEle(e,".e-sheet-tab-panel .e-toolbar-item .e-tab-wrap",!0);else if(i.classList.contains("e-scroll-left-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-right-nav",!0);else if(i.classList.contains("e-tab-wrap")){var Te=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),Tt=Te.indexOf(i.parentElement);if(Tt===Te.length-1){var si=!!this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav");(si||!rt)&&this.focusEle(e,".e-sheet-tab-panel ."+(si?"e-scroll-nav":"e-icon-btn:not(:disabled)"),si)}else this.focusEle(e,null,!0,!1,Te[Tt+1].querySelector(".e-tab-wrap"))}}}},s.prototype.setFocus=function(e,t,i){e==="Sheet"?t.shiftKey?this.parent.showFormulaBar?this.focusEle(t,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",t,i):this.parent.showSheetTabs?this.focusEle(t,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):this.setFocus("SheetTabs",t,i):e==="SheetTabs"?t.shiftKey?i||this.focusEle(t,".e-selectall"):this.parent.showRibbon?this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",t,i):e==="Ribbon"?t.shiftKey?this.parent.showSheetTabs?this.focusEle(t,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):i||this.focusEle(t,".e-selectall"):this.parent.showFormulaBar?this.focusEle(t,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",t,i):e==="FormulaBar"&&(t.shiftKey?this.parent.showRibbon?this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",t,i):i||this.focusEle(t,".e-selectall"))},s.prototype.focusEle=function(e,t,i,r,n){if(n=n||this.parent.element.querySelector(t),i&&!n){var a=this.parent.element.querySelector(".e-ribbon .e-tab"),o=a&&Ct(a,"tab").selectedItem||0;n=this.parent.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[o],n=n&&n.querySelector(".e-tab-wrap")}if(n)if(e.preventDefault(),r)n.click(),Fe(n),n.setSelectionRange(n.value.length,n.value.length);else if(i){if(n.setAttribute("tabindex","0"),n.parentElement.classList.contains("e-active")&&n.parentElement.classList.contains("e-toolbar-item")){var a=this.parent.element.querySelector(".e-sheet-tab-panel .e-sheet-tab");!a&&a.classList.contains("e-focused")&&a.classList.add("e-focused")}n.focus()}else Fe(n)},s.prototype.updateSelection=function(e,t){e.isProtected&&!e.protectSettings.selectCells&&e.protectSettings.selectUnLockedCells?ah(this.parent,lt(t))||this.parent.selectRange(je(t)):this.parent.selectRange(je(t))},s.prototype.getNextNonEmptyCell=function(e,t,i){var r=this.parent.getActiveSheet(),n=function(b,y){var C=Y(b,y,r,null,!0).value;return!m(C)&&C!==""},a,o;if(i==="down"){var l=ae(r,e+1,!0);a=n(l,t);for(var h=ae(r,r.rowCount-1,!1),u=l;u<r.rowCount;u++){if(u===h)return u;if(a){if(!n(ae(r,u,!0),t))return ae(r,u-1,!1)}else if(o=ae(r,u+1,!0),n(o,t))return o}return e}else if(i==="top"){var l=ae(r,e-1,!1);a=n(l,t);for(var c=ae(r,0,!0),d=l;d>=0;d--){if(d===c)return d;if(a){if(!n(ae(r,d,!1),t))return ae(r,d+1,!0)}else if(o=ae(r,d-1,!1),n(o,t))return o}return e}else if(i==="right"){var p=ae(r,t+1,!0,"columns");a=n(e,p);for(var f=ae(r,r.colCount-1,!1,"columns"),v=p;v<r.colCount;v++){if(v===f)return v;if(a){if(!n(e,ae(r,v,!0,"columns")))return ae(r,v-1,!1,"columns")}else if(o=ae(r,v+1,!0,"columns"),n(e,o))return o}return t}else{var p=ae(r,t-1,!1,"columns");a=n(e,p);for(var c=ae(r,0,!0,"columns"),g=p;g>=0;g--){if(g===c)return g;if(a){if(!n(e,ae(r,g,!1,"columns")))return ae(r,g+1,!0,"columns")}else if(o=ae(r,g-1,!1,"columns"),n(e,o))return o}return t}},s.prototype.getNextUnlockedCell=function(e,t){var i=this.parent.getActiveSheet(),r,n;if(e==="right")for(var a=t[0],o=void 0,l=void 0,h=i.usedRange.rowIndex,u=i.usedRange.colIndex;a<=h;){for(o=o===void 0?t[1]+1:0,l&&a===t[0]&&(u=t[1]-1),o;o<=u;o++)if(r=Y(a,o,i),n=oi(i,o)||{},!Cn(r,n)&&!n.hidden&&!ct(i,a))return[a,o];a===i.usedRange.rowIndex&&!l?(a=0,h=t[0],l=!0):a++}else if(e==="left")for(var a=t[0],o=void 0,l=void 0,h=0,u=0;a>=h;){for(o=o===void 0?t[1]-1:i.usedRange.colIndex,l&&a===t[0]&&(u=t[1]+1),o;o>=u;o--)if(r=Y(a,o,i),n=oi(i,o)||{},!Cn(r,n)&&!n.hidden&&!ct(i,a))return[a,o];a===0&&!l?(a=i.usedRange.rowIndex,h=t[0],l=!0):a--}else if(e==="down")for(var o=t[1],a=void 0,l=void 0,u=i.usedRange.colIndex,h=i.usedRange.rowIndex;o<=u;){for(a=a===void 0?t[0]+1:0,l&&o===t[1]&&(h=t[0]-1),a;a<=h;a++)if(r=Y(a,o,i),n=oi(i,o)||{},!Cn(r,n)&&!n.hidden&&!ct(i,a))return[a,o];o===i.usedRange.colIndex&&!l?(o=0,u=t[1],l=!0):o++}else for(var o=t[1],a=void 0,l=void 0,u=0,h=0;o>=u;){for(a=a===void 0?t[0]-1:i.usedRange.rowIndex,l&&o===t[1]&&(h=t[0]+1),a;a>=h;a--)if(r=Y(a,o,i),n=oi(i,o)||{},!Cn(r,n)&&!n.hidden&&!ct(i,a))return[a,o];o===0&&!l?(o=i.usedRange.colIndex,u=t[1],l=!0):o--}return t},s.prototype.shiftSelection=function(e){var t=this.parent.getActiveSheet(),i=ee(t.selectedRange),r=lt(i),n=!0;if(e.keyCode===38){for(var a=r[1];a<=r[3];a++){var o=Y(i[2],a,t);if(!m(o)&&o.rowSpan&&o.rowSpan<0){i[2]=ae(t,i[2]-(Math.abs(o.rowSpan)+1),!1),n=!1;break}}if(n&&(i[2]=ae(t,i[2]-1,!1)),i[2]<0)return}if(e.keyCode===40){for(var a=r[1];a<=r[3];a++){var o=Y(i[2],a,t);if(!m(o)&&o.rowSpan&&o.rowSpan>0){i[2]=ae(t,i[2]+Math.abs(o.rowSpan),!0),n=!1;break}}if(n&&(i[2]=ae(t,i[2]+1,!0)),i[2]>=t.rowCount&&(i[2]=ae(t,t.rowCount-1,!1),i[2]<0))return}if(e.keyCode===39){for(var a=r[0];a<=r[2];a++){var o=Y(a,i[3],t);if(!m(o)&&o.colSpan&&o.colSpan>0){i[3]=ae(t,i[3]+Math.abs(o.colSpan),!0,"columns"),n=!1;break}}if(n&&(i[3]=ae(t,i[3]+1,!0,"columns")),i[3]>=t.colCount&&(i[3]=ae(t,t.colCount-1,!1,"columns"),i[3]<0))return}if(e.keyCode===37){for(var a=r[0];a<=r[2];a++){var o=Y(a,i[3],t);if(!m(o)&&o.colSpan&&o.colSpan<0){i[3]=ae(t,i[3]-(Math.abs(o.colSpan)+1),!1,"columns"),n=!1;break}}if(n&&(i[3]=ae(t,i[3]-1,!1,"columns")),i[3]<0)return}if(e.shiftKey&&e.ctrlKey&&!this.parent.scrollSettings.enableVirtualization){var l=[t.usedRange.rowIndex,t.usedRange.colIndex];if(e.keyCode===37&&(i[3]<=l[1]?i[3]=ae(t,0,!0,"columns"):i[3]=ae(t,l[1],!0,"columns")),e.keyCode===38&&(i[2]<=l[0]?i[2]=ae(t,0,!0):i[2]=ae(t,l[0],!0)),e.keyCode===39&&(i[3]<=l[1]?i[3]=ae(t,l[1],!1,"columns"):i[3]=ae(t,t.colCount,!1,"columns"),i[3]<0)||e.keyCode===40&&(i[2]<=l[0]?i[2]=ae(t,l[0],!1):i[2]=ae(t,t.rowCount,!1),i[2]<0))return}if(e.keyCode===37||e.keyCode===39||e.keyCode===38||e.keyCode===40){var h=xe(t.activeCell);this.parent.isEdit&&e.shiftKey?(e.preventDefault(),this.parent.notify(L1,{range:i,e}),this.parent.notify(zh,{range:je(lt(i)),isSelect:!1}),this.parent.notify(l0,{})):this.parent.selectRange(je(i)),this.scrollNavigation([D6(t,i)?h[0]:i[2],JP(t,i)?h[1]:i[3]])}},s.prototype.scrollNavigation=function(e,t){if(this.parent.allowScrolling){var i=this.parent.enableRtl?-1:1,r=this.parent.getMainContent().parentElement,n=this.parent.getScrollElement(),a=this.parent.getActiveSheet(),o=lt(ee(a.selectedRange)),l=xe(a.topLeftCell),h=this.parent.frozenRowCount(a),u=this.parent.frozenColCount(a),c=xe(a.paneTopLeftCell),d=ae(a,e[0]<h?l[0]:c[0],!0),p=this.parent.scrollModule.offset.top.size;if(r.scrollTop){if(h&&e[0]!==o[2]){if(e[0]===h){r.scrollTop=0;return}e[0]===h-1&&(r.scrollTop=0)}else if(e[0]===ae(a,0,!0)){r.scrollTop=0;return}}if(n&&n.scrollLeft){if(u&&e[1]!==o[3]){if(e[1]===u){n.scrollLeft=0;return}e[1]===u-1&&(n.scrollLeft=0)}else if(e[1]===ae(a,0,!0,"columns")){n.scrollLeft=0;return}}var f=Yc(this.parent,d).index;if(f<=e[0]){if(e[0]>=h)if(t){var v=r.getBoundingClientRect().height,g=Ei(a,c[0],e[0],!0);g>v*2?r.scrollTop=p+g-v:r.scrollTop=p+g-Wt(a,e[0],!0),Fe(this.parent.element)}else r.scrollTop=p+Ei(a,f,e[0],!0)}else d>e[0]&&(r.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),r.scrollTop=p-Math.ceil(Ei(a,e[0],d-1,!0)),t&&Fe(this.parent.element));var b=Eg(this.parent,c[1]);if(b<=e[1]&&n){if(e[1]>=u)if(t){var y=n.getBoundingClientRect().width,C=ci(a,c[1],e[1],!0);C>y*2?n.scrollLeft=(this.parent.scrollModule.offset.left.size+C-y)*i:n.scrollLeft=(this.parent.scrollModule.offset.left.size+(C-tr(a,e[0],null,!0)))*i,Fe(this.parent.element)}else n.scrollLeft=(this.parent.scrollModule.offset.left.size+ci(a,b,e[1],!0))*i}else c[1]>e[1]&&n&&(n.scrollLeft&&(this.parent.scrollModule.isKeyScroll=!1),n.scrollLeft=(this.parent.scrollModule.offset.left.size-ci(a,e[1],c[1]-1,!0))*i,t&&Fe(this.parent.element))}},s.prototype.getModuleName=function(){return"keyboardNavigation"},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s}(),m7=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(Ra,this.keyDownHandler,this),this.parent.on(Xn,this.keyUpHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ra,this.keyDownHandler),this.parent.off(Xn,this.keyUpHandler))},s.prototype.isTrgtNotInput=function(e){var t=e.target;return!U(t,".e-filter-popup")&&!U(t,".e-find-dlg")&&!U(t,".e-hyperlink-dlg")&&!U(t,".e-sheet-tab")&&!U(t,".e-name-box")&&!U(t,".e-link-dialog")},s.prototype.ribbonShortCuts=function(e){if(this.parent.showRibbon&&e.altKey&&!e.ctrlKey&&!e.shiftKey){var t=Ct(this.parent.element.querySelector(".e-ribbon .e-tab"),"tab"),i=void 0;if(e.keyCode===72)i=1;else if(e.keyCode===78)i=2;else if(e.keyCode===65)i=4;else if(e.keyCode===87)i=5;else if(e.keyCode===77)i=3;else if(e.keyCode===70)e.preventDefault(),$("#"+this.parent.element.id+"_File",this.parent.element).click();else if(e.keyCode===18){e.preventDefault();var r=xe(this.parent.getActiveSheet().activeCell),n={sheetIdx:this.parent.activeSheetIndex};if(this.parent.notify(xd,n),!(n.hasFilter&&n.filterRange&&n.filterRange[0]===r[0]&&n.filterRange[1]<=r[1]&&n.filterRange[3]>=r[1])){var a=document.activeElement;if(!a.classList.contains("e-spreadsheet-edit")&&!a.classList.contains("e-sheet-rename")&&a.id!==this.parent.element.id+"_name_box"&&!U(a,".e-dropdown-btn")&&!U(a,".e-split-btn")&&!U(a,".e-popup-open")){var o=this.parent.getCell(r[0],r[1]);if(o&&o.querySelector(".e-validation-list"))return;if(U(a,".e-ribbon")){Fe(this.parent.element);return}for(var l=0;l<=this.parent.ribbonModule.ribbon.items.length;l++)if(l===this.parent.ribbonModule.ribbon.selectedTab){var h=this.parent.element.querySelector(".e-toolbar-items").children[l+2].children[0];h.setAttribute("tabindex","0"),Fe(h);return}}}}i&&(!t.items[i].disabled&&!t.items[i].cssClass.includes("e-hide")?(e.preventDefault(),t.select(i,Object.assign(e,{isShortcut:!0}))):Fe(this.parent.element))}},s.prototype.keyUpHandler=function(e){if(e.keyCode===37||e.keyCode===39){var t=document.activeElement;if(t.classList.contains("e-colorpicker-wrapper")||t.classList.contains("e-split-btn-wrapper")){var i=t.querySelector(".e-split-btn");i&&Fe(i)}}else if(e.keyCode===13){var r=e.target;if(r.classList.contains("e-scroll-nav")){var n=function(){r.getAttribute("tabindex")||(r.setAttribute("tabindex","0"),Fe(r)),I.remove(r,"blur",n)};I.add(r,"blur",n,this)}}},s.prototype.keyDownHandler=function(e){var t=this.parent.selectionSettings.mode==="None";this.ribbonShortCuts(e);var i=this.parent.getActiveSheet(),r=e.target;if((e.ctrlKey||e.metaKey)&&this.isTrgtNotInput(e)){!U(r,".e-find-dlg")&&!t&&([79,83].indexOf(e.keyCode)>-1||e.keyCode===65&&!this.parent.isEdit)&&e.preventDefault();var n=xe(i.activeCell);if(e.keyCode===79)this.parent.allowOpen&&this.parent.openUrl&&$("#"+this.parent.element.id+"_fileUpload",this.parent.element).click();else if(e.keyCode===83)this.parent.saveUrl&&this.parent.allowSave&&this.parent.notify(Lf,null);else if(e.keyCode===67&&!t)this.parent.notify(pu,{promise:Promise});else if(e.keyCode===75&&!t){var a=i.rows[n[0]],o=void 0;e.preventDefault(),m(a)||(o=a.cells[n[1]]),m(o)&&Ht(n[0],n[1],i,o,!1),o&&o.hyperlink?this.parent.notify($f,null):this.parent.notify(Gf,null)}else if(e.keyCode===90&&!t)this.parent.isEdit||(e.preventDefault(),this.parent.notify(Fa,{isUndo:!0}));else if(e.keyCode===89&&!t)this.parent.isEdit||(e.preventDefault(),this.parent.notify(Fa,{isUndo:!1}));else if((e.keyCode===82||e.keyCode===68)&&!t){e.preventDefault();var l=lt(ee(i.selectedRange)),h={colIndex:l[1],rowIndex:l[0]},u=void 0,c=void 0;if(e.keyCode===68?(l[0]===l[2]?h.rowIndex=l[0]-1:l[0]+=1,c=je([h.rowIndex,h.colIndex,h.rowIndex,l[3]]),u="Down"):(l[1]===l[3]?h.colIndex=l[1]-1:l[1]+=1,u="Right",c=je([h.rowIndex,h.colIndex,l[2],h.colIndex])),h.rowIndex<0||h.colIndex<0)return;this.parent.notify(m0,{fillType:Y(h.rowIndex,h.colIndex,i,!1,!0).formula?"FillSeries":"CopyCells",dAutoFillCell:c,rangeInfo:{direction:u,startCell:h,endCell:{rowIndex:l[2],colIndex:l[3]},fillRange:l}}),this.parent.notify(Gs,{type:"mousedown"}),this.parent.notify(Oa,null)}var d=i.isProtected&&Cn(Y(n[0],n[1],i),oi(i,n[1]));if(e.keyCode===70&&!t&&this.parent.allowFindAndReplace&&(e.preventDefault(),this.parent.notify(su,{})),(!d||!i.isProtected||e.keyCode===86)&&e.keyCode!==70&&!t&&(e.keyCode===71?(e.preventDefault(),this.parent.notify(eM,null)):e.keyCode===72?(e.preventDefault(),this.parent.notify(tM,null)):e.keyCode===88?this.parent.notify(du,{promise:Promise}):e.keyCode===86&&this.parent.notify(Ia,{isAction:!0}),e.shiftKey&&e.keyCode===76&&!this.parent.isEdit&&!i.isProtected&&(e.preventDefault(),this.parent.notify(so,{}))),!t&&(!i.isProtected||i.protectSettings.formatCells))if(e.keyCode===66){e.preventDefault();var p=this.parent.getCellStyleValue(["fontWeight"],n).fontWeight;p=p==="bold"?"normal":"bold",this.parent.notify(Ri,{style:{fontWeight:p},onActionUpdate:!0,refreshRibbon:!0})}else if(e.keyCode===73){e.preventDefault();var p=this.parent.getCellStyleValue(["fontStyle"],n).fontStyle;p=p==="italic"?"normal":"italic",this.parent.notify(Ri,{style:{fontStyle:p},onActionUpdate:!0,refreshRibbon:!0})}else e.ctrlKey&&e.keyCode===85&&!e.shiftKey?(e.preventDefault(),this.parent.notify(ld,{style:{textDecoration:"underline"},refreshRibbon:!0})):e.ctrlKey&&e.keyCode===53&&!e.shiftKey&&(e.preventDefault(),this.parent.notify(ld,{style:{textDecoration:"line-through"},refreshRibbon:!0}))}if(e.keyCode===27&&this.parent.notify(Cd,null),((e.ctrlKey||e.metaKey)&&e.keyCode===119||e.keyCode===13&&r.classList.contains("e-drop-icon"))&&this.parent.showRibbon){e.preventDefault();var f=this.parent.element.querySelector(".e-drop-icon");f&&f.click()}if((e.ctrlKey||e.metaKey)&&!t){if(e.keyCode===57){if(!i.isProtected||i.protectSettings.formatColumns){e.preventDefault();var n=ee(i.selectedRange);this.parent.notify(nn,{startIndex:n[0],endIndex:n[2],hide:!e.shiftKey,isCol:!1,actionUpdate:!0})}}else if(e.keyCode===48&&(!i.isProtected||i.protectSettings.formatRows)){var n=ee(i.selectedRange);this.parent.notify(nn,{startIndex:n[1],endIndex:n[3],hide:!e.shiftKey,isCol:!0,actionUpdate:!0})}}if(e.shiftKey&&!t){if(e.keyCode===114)e.preventDefault(),this.parent.notify(wM,null);else if(e.keyCode===116&&this.parent.allowFindAndReplace)e.preventDefault(),this.parent.notify(su,{});else if(e.keyCode===121){var v=document.activeElement.className;["e-spreadsheet","e-cell","e-header-cell","e-clipboard"].some(function(x){return v.includes(x)})&&this.focusTarget(i)}}if(e.altKey&&!t&&((e.ctrlKey||e.metaKey)&&e.keyCode===78?(e.preventDefault(),this.parent.refresh(!0)):e.keyCode===113&&this.parent.saveUrl&&(e.preventDefault(),this.parent.notify(Lf,null))),(e.ctrlKey||e.metaKey)&&e.shiftKey&&!t){if(!i.isProtected||i.protectSettings.formatCells){var g=i.selectedRange,b=void 0;if(e.keyCode===192)b=Ki("General");else if(e.keyCode===52)b="$#,##0.00;[Red]($#,##0.00)";else if(e.keyCode===53)b="0%";else if(e.keyCode===54)b=Ki("Scientific");else if(e.keyCode===51)b="dd-mmm-yy";else if(e.keyCode===50)b="h:mm AM/PM";else if(e.keyCode===49)b=Ki("Number");else if(e.keyCode===55){e.preventDefault();var y="1px solid #000000";this.parent.notify(Ri,{style:{border:y},onActionUpdate:!0,borderType:"Outer"})}b&&(this.parent.notify(Rf,{format:b,range:g}),this.parent.notify(Gs,{type:"mousedown"}),this.parent.notify(Oa,null))}if(e.keyCode===85){e.preventDefault();var C=this.parent.element.querySelector(".e-formula-bar-panel .e-drop-icon");C&&C.click()}}e.keyCode===122&&e.shiftKey&&!e.ctrlKey&&!this.parent.isProtected&&this.parent.notify(Js,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1}),e.shiftKey&&e.altKey&&e.keyCode===75&&this.parent.showSheetTabs&&this.parent.element.querySelector(".e-sheets-list").click()},s.prototype.focusTarget=function(e){var t=lt(ee(e.selectedRange)),i=t[1]===0&&t[3]===e.colCount-1,r=t[0]===0&&t[2]===e.rowCount-1,n;if(i&&r)n=this.parent.element.querySelector(".e-selectall");else if(i){var a=this.parent.frozenRowCount(e);if(t[0]<a){var o=this.parent.getRow(t[0],this.parent.sheetModule.getSelectAllTable());n=o&&o.cells[0]}else{t[0]=ae(e,t[0],!0);var l=ae(e,ee(e.paneTopLeftCell)[0],!0),h=Yc(this.parent,l).index,u=void 0;t[0]>l&&t[0]<h?u=this.parent.getRow(t[0],this.parent.getRowHeaderTable()):t[0]>=h?u=this.parent.getRow(h-1,this.parent.getRowHeaderTable()):u=this.parent.getRow(l+1,this.parent.getRowHeaderTable()),n=u&&u.cells[0]}}else if(r){var c=this.parent.frozenColCount(e);if(t[1]<c){var o=this.parent.element.querySelector(".e-selectall-container .e-header-row");n=o&&this.parent.getCell(0,t[1],o)}else{t[1]=ae(e,t[1],!0,"columns");var d=ae(e,ee(e.paneTopLeftCell)[1],!0,"columns"),p=Eg(this.parent,d),u=this.parent.element.querySelector(".e-column-header .e-header-row");t[1]>d&&t[1]<p?n=u&&this.parent.getCell(0,t[1],u):t[1]>=p?n=u&&this.parent.getCell(0,p-1,u):n=u&&this.parent.getCell(0,d+1,u)}}else{var f=ee(e.paneTopLeftCell);n=this.parent.getCell(t[0],t[1]);var a=this.parent.frozenRowCount(e),c=this.parent.frozenColCount(e);if(t[0]<a&&t[1]<c)n=this.parent.getCell(t[0],t[1]);else if(t[0]<a){var d=ee(e.paneTopLeftCell)[1],p=Eg(this.parent,d);t[1]>d&&t[1]<p?n=this.parent.getCell(t[0],t[1]):t[1]>=p?n=this.parent.getCell(t[0],p-1):n=this.parent.getCell(t[0],d+1)}else if(t[1]<c){var l=ee(e.paneTopLeftCell)[0],h=Yc(this.parent,l).index;t[0]>l&&t[0]<h?n=this.parent.getCell(t[0],t[1]):t[0]>=h?n=this.parent.getCell(h-1,t[1]):n=this.parent.getCell(l+1,t[1])}else{var l=ee(e.paneTopLeftCell)[0],h=Yc(this.parent,l).index,d=ee(e.paneTopLeftCell)[1],p=Eg(this.parent,d);t[0]>l&&t[0]<h?t[1]>d&&t[1]<p?n=this.parent.getCell(t[0],t[1]):t[1]>=p?n=this.parent.getCell(t[0],p-1):n=this.parent.getCell(t[0],d+1):t[0]>=h?t[1]>d&&t[1]<p?n=this.parent.getCell(h-1,t[1]):t[1]>=p?n=this.parent.getCell(h-1,p-1):n=this.parent.getCell(h-1,d+1):t[1]>d&&t[1]<p?n=this.parent.getCell(l+1,t[1]):t[1]>=p?n=this.parent.getCell(l+1,p-1):n=this.parent.getCell(l+1,d+1)}n||(n=this.parent.getCell(f[0]+1,f[1]+1))}n&&Fe(n)},s.prototype.getModuleName=function(){return"keyboardShortcut"},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s}(),g7=function(){function s(e){this.checkHeight=!1,this.parent=e,this.addEventListener()}return s.prototype.applyCellFormat=function(e){if(e.checkHeight){this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e.rowIdx,e.colIdx,e.lastCell,e.onActionUpdate,e.outsideViewport);return}var t=Object.keys(e.style),i=this.parent.getActiveSheet();if(!(e.lastCell&&eo(i,e.rowIdx)<=20&&!t.length)){var r=e.td||this.parent.getCell(e.rowIdx,e.colIdx);if(r){if(this.updateMergeBorder(e,i),e.formatColor&&r.style.color===e.formatColor&&delete e.style.color,e.style.border!==void 0||e.style.borderTop!==void 0||e.style.borderLeft!==void 0){var n={};Object.keys(e.style).forEach(function(u){n[""+u]=e.style[""+u]}),n.border!==void 0&&(Object.assign(r.style,{borderRight:e.style.border,borderBottom:e.style.border}),this.setLeftBorder(e.style.border,r,e.rowIdx,e.colIdx,e.row,e.onActionUpdate,e.first,i),this.setTopBorder(e.style.border,r,e.rowIdx,e.colIdx,e.pRow,e.pHRow,e.onActionUpdate,e.first,e.lastCell,e.manualUpdate,i),delete n.border),n.borderTop!==void 0&&(this.setTopBorder(e.style.borderTop,r,e.rowIdx,e.colIdx,e.pRow,e.pHRow,e.onActionUpdate,e.first,e.lastCell,e.manualUpdate,i),delete n.borderTop),n.borderLeft!==void 0&&(this.setLeftBorder(e.style.borderLeft,r,e.rowIdx,e.colIdx,e.row,e.onActionUpdate,e.first,i),delete n.borderLeft),Object.keys(n).length&&(n.borderBottom!==void 0&&this.setThickBorderHeight(n.borderBottom,e.rowIdx,e.colIdx,r,e.row,e.hRow,e.onActionUpdate,e.lastCell,e.manualUpdate),Object.assign(r.style,n))}else{e.style.borderBottom!==void 0&&this.setThickBorderHeight(e.style.borderBottom,e.rowIdx,e.colIdx,r,e.row,e.hRow,e.onActionUpdate,e.lastCell,e.manualUpdate),Object.assign(r.style,e.style);var a=Y(e.rowIdx,e.colIdx,i);if(a&&(a.rowSpan||a.colSpan)&&r.offsetHeight>0){var o=IM(this.parent,a.style||this.parent.cellStyle);o>r.offsetHeight&&Ja(this.parent,i,r.offsetHeight,e.rowIdx)}}var l=Y(e.rowIdx,e.colIdx,i,null,!0);if(!i.rows[e.rowIdx]||!i.rows[e.rowIdx].customHeight){if(e.isHeightCheckNeeded){if(e.manualUpdate)this.checkHeight||(this.checkHeight=w1(e.style,e.onActionUpdate)),r&&r.children[0]&&r.children[0].className==="e-cf-databar"&&e.style.fontSize&&(r.children[0].querySelector(".e-databar-value").style.fontSize=e.style.fontSize),this.updateRowHeight(e.rowIdx,e.colIdx,e.lastCell,e.onActionUpdate),l.wrap&&(e.style.fontSize||e.style.fontFamily)&&(r.style.lineHeight=parseFloat(l.style&&l.style.fontSize||this.parent.cellStyle.fontSize)*TI(l.style&&l.style.fontFamily?l.style:this.parent.cellStyle)+"pt");else if(!l.wrap&&w1(e.style)&&Yl(i,e.rowIdx,e.colIdx,qc(this.parent,e.rowIdx,e.colIdx,i,e.style)),e.lastCell){var o=eo(i,e.rowIdx);o>20&&o>Wt(i,e.rowIdx)&&Ja(this.parent,i,o,e.rowIdx,e.row,e.hRow,this.parent.scrollSettings.isFinite)}}}else if(!l.wrap&&(e.style.fontSize||e.style.fontFamily)){var h=Wt(i,e.rowIdx,!0)-cz(e.rowIdx,e.colIdx,i);h<IM(this.parent,l.style)?r.style.lineHeight=h+"px":r.style.lineHeight&&(r.style.lineHeight="")}}else this.updateRowHeight(e.rowIdx,e.colIdx,!0,e.onActionUpdate)}},s.prototype.updateRowHeight=function(e,t,i,r,n){if(this.checkHeight){var a=this.parent.getActiveSheet(),o=Y(e,t,a,null,!0);if(!o.rowSpan){var l=0;l=qc(this.parent,e,t,a,o.style||this.parent.cellStyle,o.wrap?iv(this.parent.getDisplayText(o),Ad(a,e,t),o.style,this.parent.cellStyle):1);var h=o.value&&o.value.toString();if(h&&h.indexOf(`
`)>-1){var u=void 0,c=h.split(`
`),d=0,p=c.length;for(u=0;u<p;u++){var f=iv(c[u],Ad(a,e,t),o.style,this.parent.cellStyle);f===0&&(f=1),d=d+f}l=qc(this.parent,e,t,a,o.style||this.parent.cellStyle,d)}if(l<20&&(l=20),Yl(a,e,t,l),!n){var v=this.parent.getCell(e,t);v&&v.children[0]&&v.children[0].className==="e-cf-databar"&&(v.children[0].style.height="100%",v.children[0].firstElementChild.nextElementSibling.style.height="100%")}if(i){this.checkHeight=!1;var g=eo(a,e),b=Wt(a,e);(r?g!==b:g>b)&&(n?(b=Mr(b),Id(a,e,g),this.parent.setProperties({sheets:this.parent.sheets},!0),this.parent.notify(an,{rowIdx:e,threshold:Mr(g)-b})):Ja(this.parent,a,g,e,null,null,!0))}}}},s.prototype.updateMergeBorder=function(e,t){var i=Y(e.rowIdx,e.colIdx,t,null,!0),r={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};if(this.parent.notify(cr,r),i.rowSpan>1&&!e.style.borderBottom){var n=Y(r.range[2],r.range[1],t,null,!0);n.style&&n.style.borderBottom&&(e.style.borderBottom=n.style.borderBottom)}if(i.colSpan>1&&!e.style.borderRight){var a=Y(r.range[0],r.range[3],t,null,!0);a.style&&a.style.borderRight&&(e.style.borderRight=a.style.borderRight)}},s.prototype.setLeftBorder=function(e,t,i,r,n,a,o,l){if(!(o&&o.includes("Column"))){var h=this.parent.enableRtl,u=h?this.parent.getCell(i,r+1,n):this.parent.getCell(i,r-1,n);if(u){var c=Y(i,r-1,l,!1,!0);if(c.rowSpan&&c.rowSpan!==1||c.colSpan&&c.colSpan!==1){var d={range:[i,r-1,i,r-1]};if(this.parent.notify(cr,d),c=Y(d.range[0],d.range[1],l,!1,!0),c.style&&c.style.borderRight&&c.style.borderRight!=="none")return;if(c=Y(d.range[0],d.range[3],l,null,!0),c.style&&c.style.borderRight&&c.style.borderRight!=="none")return;t.style.borderLeft=e}else a&&e!==""&&r===this.parent.viewport.leftIndex&&(this.parent.getMainContent().scrollLeft-=this.getBorderSize(e)),u.style.borderRight=e==="none"?u.style.borderRight:e}else t.style.borderLeft=e}},s.prototype.setTopBorder=function(e,t,i,r,n,a,o,l,h,u,c){if(!(l&&l.includes("Row"))){var d=r,p=Y(i,r,c,!1,!0);p.colSpan>1&&Yt(c,r)&&(d=ae(c,r,!0,"columns"),d>r+p.colSpan-1&&(d=r));var f=this.parent.getCell(i-1,d,n);if(f)if(p=Y(i-1,r,c,!1,!0),p.rowSpan&&p.rowSpan!==1||p.colSpan&&p.colSpan!==1){var v={range:[i-1,r,i-1,r]};if(this.parent.notify(cr,v),p=Y(v.range[0],v.range[1],c,!1,!0),p.style&&p.style.borderBottom&&p.style.borderBottom!=="none")return;if(p=Y(v.range[2],v.range[1],c,null,!0),p.style&&p.style.borderBottom&&p.style.borderBottom!=="none")return;t.style.borderTop=e}else{if(ct(c,i-1)){var g=[Number(f.parentElement.getAttribute("aria-rowindex"))-1,r];if(this.parent.getCellStyleValue(["bottomPriority"],g).bottomPriority)return}o&&e!==""&&c.topLeftCell.includes(""+(i+1))&&(this.parent.getMainContent().parentElement.scrollTop-=this.getBorderSize(e)),this.setThickBorderHeight(e,i-1,r,f,n,a,o,h,u),f.style.borderBottom=e==="none"?f.style.borderBottom:e}else t.style.borderTop=e}},s.prototype.setThickBorderHeight=function(e,t,i,r,n,a,o,l,h){var u=e?this.getBorderSize(e):1,c=this.parent.getActiveSheet();if(u>2&&(!c.rows[t]||!c.rows[t].customHeight))if(h)this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t,i,l,o);else{var d=Wt(c,t),p=Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(["fontFamily","fontSize"],[t,i]),1,3));p>d&&(Ja(this.parent,c,p,t,n,a,!1),this.parent.notify(an,{rowIdx:t,threshold:p-20}))}o&&(l||!this.checkHeight)&&u<3&&(!c.rows[t]||!c.rows[t].customHeight)&&(this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t,i,l,o))},s.prototype.getBorderSize=function(e){var t=e.split(" ")[0];return t==="thin"?1:t==="medium"?2:t==="thick"?3:parseInt(t,10)?parseInt(t,10):1},s.prototype.clearObj=function(e){var t=this,i=e.options,r=i.range?i.range.indexOf("!")>0?i.range.split("!")[1]:i.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,n=i.range&&i.range.indexOf("!")>0?gt(this.parent,i.range.split("!")[0]):this.parent.activeSheetIndex,a=lt(ee(r)),o=this.parent.sheets[n],l=a[0],h=a[2],u,c,d=this.parent.element.getElementsByClassName("e-ss-overlay-active"),p=d.length>0,f,v={range:r,type:i.type,requestType:"clear",sheetIndex:n},g=function(){e.isAction&&t.parent.notify(li,{action:"beforeClear",eventArgs:v})},b=function(){e.isAction&&(v={range:o.name+"!"+r,type:i.type,sheetIndex:n},f&&(v.cfClearActionArgs=f.cfClearActionArgs),t.parent.notify(yt,{eventArgs:v,action:"clear"}))};if(p)d[0].classList.contains("e-datavisualization-chart")?(i.type==="Clear Contents"||i.type==="Clear All")&&(g(),this.parent.notify(gu,{id:d[0].id,sheetIdx:this.parent.activeSheetIndex+1}),b()):i.type==="Clear All"&&(g(),this.parent.notify(Xs,{id:d[0].id,sheetIdx:this.parent.activeSheetIndex+1}),b());else{if(g(),i.type==="Clear Formats"||i.type==="Clear All")for(f={range:r,sheetIdx:n,isClear:!0},this.parent.notify(no,f),e.cfClearActionArgs=f.cfClearActionArgs,i.type==="Clear All"&&(this.parent.notify(Yo,{range:r,isRemoveValidation:!0,viewport:this.parent.viewport}),l===0&&a[1]===0&&h>=o.usedRange.rowIndex&&a[3]>=o.usedRange.colIndex&&this.parent.setUsedRange(l,a[1],o,!1,!0)),l;l<=h;l++)for(u=a[1],c=a[3],u;u<=c;u++){var y=Y(l,u,o),C=this.parent.getCell(l,u);y&&(y.formula&&this.parent.notify(cd,{cellRef:je([l,u,l,u])}),y.wrap&&this.parent.notify(eh,{range:[l,u,l,u],wrap:!1,sheet:o}),y.hyperlink&&(C&&te(C.querySelectorAll(".e-hyperlink"),"e-hyperlink-style"),i.type==="Clear All"&&this.parent.removeHyperlink(o.name+"!"+je([l,u,l,u]))))}i.type==="Clear Hyperlinks"&&this.parent.removeHyperlink(o.name+"!"+r),this.parent.notify(md,{range:o.name+"!"+r,type:i.type}),this.parent.serviceLocator.getService("cell").refreshRange(lt(ee(r)),!1,!1,!1,!1,ea(this.parent)),this.parent.notify(pd,{range:r,isclearFormat:!0}),e.isFromUpdateAction||this.parent.notify(cu,{address:r}),this.parent.notify(sa,null),b()}},s.prototype.addEventListener=function(){this.parent.on(dr,this.applyCellFormat,this),this.parent.on(ev,this.clearObj,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(dr,this.applyCellFormat),this.parent.off(ev,this.clearObj))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.checkHeight=null},s.prototype.getModuleName=function(){return"cellformat"},s}(),uo,kh,wl,rv,DI=!1;function pz(s,e){var t=!1,i={left:0,top:0},r=s;if(!s||!e)return i;for(m(e.offsetParent)&&e.style.position==="fixed"&&(t=!0);(e.offsetParent||t)&&s&&e.offsetParent!==s;)i.left+=s.offsetLeft,i.top+=s.offsetTop,s=s.offsetParent;for(s=r;(e.offsetParent||t)&&s&&e.offsetParent!==s;)i.left-=s.scrollLeft,i.top-=s.scrollTop,s=s.parentElement;return i}function Fr(s,e,t,i,r){if(kh=void 0,kh=r,DI=!!i,!s)return{left:0,top:0};e||(e="left"),t||(t="top"),rv=s.ownerDocument,wl=s;var n={left:0,top:0};return y7(e.toLowerCase(),t.toLowerCase(),n)}function mo(s,e){e.left=s}function go(s,e){e.top=s}function y7(s,e,t){switch(uo=wl.getBoundingClientRect(),e+s){case"topcenter":mo(XC(),t),go(Ig(),t);break;case"topright":mo($C(),t),go(Ig(),t);break;case"centercenter":mo(XC(),t),go(GC(),t);break;case"centerright":mo($C(),t),go(GC(),t);break;case"centerleft":mo(Tg(),t),go(GC(),t);break;case"bottomcenter":mo(XC(),t),go(QC(),t);break;case"bottomright":mo($C(),t),go(QC(),t);break;case"bottomleft":mo(Tg(),t),go(QC(),t);break;default:case"topleft":mo(Tg(),t),go(Ig(),t);break}return wl=null,t}function fz(){return rv.documentElement.scrollTop||rv.body.scrollTop}function vz(){return rv.documentElement.scrollLeft||rv.body.scrollLeft}function QC(){return DI?uo.bottom:uo.bottom+fz()}function GC(){return Ig()+uo.height/2}function Ig(){return DI?uo.top:uo.top+fz()}function Tg(){return uo.left+vz()}function $C(){var s=wl&&(wl.classList.contains("e-date-wrapper")||wl.classList.contains("e-datetime-wrapper")||wl.classList.contains("e-date-range-wrapper")||wl.classList.contains("e-multiselect"))?kh?kh.width:0:kh&&uo.width>=kh.width?kh.width:0;return uo.right+vz()-s}function XC(){return Tg()+uo.width/2}var yu,ks;function AI(s,e,t,i){if(e===void 0&&(e=null),t===void 0&&(t={X:!1,Y:!1}),!t.Y&&!t.X)return{left:0,top:0};var r=s.getBoundingClientRect();if(ks=e,yu=s.ownerDocument,i||(i=Fr(s,"left","top")),t.X){var n=ks?Cz():Ez(),a=LI(),o=OI(),l=a-i.left,h=i.left+r.width-o;r.width>n?l>0&&h<=0?i.left=o-r.width:h>0&&l<=0?i.left=a:i.left=l>h?o-r.width:a:l>0?i.left+=l:h>0&&(i.left-=h)}if(t.Y){var u=ks?Sz():Mz(),c=kI(),d=RI(),p=c-i.top,f=i.top+r.height-d;r.height>u?p>0&&f<=0?i.top=d-r.height:f>0&&p<=0?i.top=c:i.top=p>f?d-r.height:c:p>0?i.top+=p:f>0&&(i.top-=f)}return i}function Qa(s,e,t,i){e===void 0&&(e=null);var r=Fr(s,"left","top");t&&(r.left=t),i&&(r.top=i);var n=[];ks=e,yu=s.ownerDocument;var a=s.getBoundingClientRect(),o=r.top,l=r.left,h=r.left+a.width,u=r.top+a.height,c=bz(o,u),d=mz(l,h);return c.topSide&&n.push("top"),d.rightSide&&n.push("right"),d.leftSide&&n.push("left"),c.bottomSide&&n.push("bottom"),n}function b7(s,e,t,i,r,n,a,o,l){if(a===void 0&&(a=null),o===void 0&&(o={X:!0,Y:!0}),!(!e||!s||!r||!n||!o.X&&!o.Y)){var h={TL:null,TR:null,BL:null,BR:null},u={TL:null,TR:null,BL:null,BR:null},c;if(window.getComputedStyle(s).display==="none"){var d=s.style.visibility;s.style.visibility="hidden",s.style.display="block",c=s.getBoundingClientRect(),s.style.removeProperty("display"),s.style.visibility=d}else c=s.getBoundingClientRect();var p={posX:r,posY:n,offsetX:t,offsetY:i,position:{left:0,top:0}};ks=a,yu=e.ownerDocument,S7(e,h,p,l,c),NI(u,p,c),o.X&&gz(e,u,h,p,c,!0),o.Y&&h.TL.top>-1&&yz(e,u,h,p,c,!0),C7(s,p,c)}}function C7(s,e,t){var i=0,r=0;if(s.offsetParent!=null&&(getComputedStyle(s.offsetParent).position==="absolute"||getComputedStyle(s.offsetParent).position==="relative")){var n=Fr(s.offsetParent,"left","top",!1,t);i=n.left,r=n.top}var a=1,o=1;if(s.offsetParent){var l=getComputedStyle(s.offsetParent).transform;if(l!=="none"){var h=new DOMMatrix(l);a=h.a,o=h.d}}s.style.top=e.position.top/o+e.offsetY-r+"px",s.style.left=e.position.left/a+e.offsetX-i+"px"}function S7(s,e,t,i,r){t.position=Fr(s,t.posX,t.posY,i,r),e.TL=Fr(s,"left","top",i,r),e.TR=Fr(s,"right","top",i,r),e.BR=Fr(s,"left","bottom",i,r),e.BL=Fr(s,"right","bottom",i,r)}function NI(s,e,t){s.TL={top:e.position.top+e.offsetY,left:e.position.left+e.offsetX},s.TR={top:s.TL.top,left:s.TL.left+t.width},s.BL={top:s.TL.top+t.height,left:s.TL.left},s.BR={top:s.TL.top+t.height,left:s.TL.left+t.width}}function mz(s,e){var t=!1,i=!1;return s-w0()<LI()&&(t=!0),e>OI()&&(i=!0),{leftSide:t,rightSide:i}}function gz(s,e,t,i,r,n){var a=mz(e.TL.left,e.TR.left);t.TL.left-w0()<=LI()&&(a.leftSide=!1),t.TR.left>OI()&&(a.rightSide=!1),(a.leftSide&&!a.rightSide||!a.leftSide&&a.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=Fr(s,i.posX,i.posY,!1),NI(e,i,r),n&&gz(s,e,t,i,r,!1))}function yz(s,e,t,i,r,n){var a=bz(e.TL.top,e.BL.top);t.TL.top-x0()<=kI()&&(a.topSide=!1),t.BL.top>=RI()&&s.getBoundingClientRect().bottom<window.innerHeight&&(a.bottomSide=!1),(a.topSide&&!a.bottomSide||!a.topSide&&a.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=Fr(s,i.posX,i.posY,!1,r),NI(e,i,r),n&&yz(s,e,t,i,r,!1))}function bz(s,e){var t=!1,i=!1;return s-x0()<kI()&&(t=!0),e>RI()&&(i=!0),{topSide:t,bottomSide:i}}function Cz(){return ks.getBoundingClientRect().width}function Sz(){return ks.getBoundingClientRect().height}function xz(){return ks.getBoundingClientRect().left}function wz(){return ks.getBoundingClientRect().top}function kI(){return ks?wz():0}function LI(){return ks?xz():0}function OI(){return ks?w0()+xz()+Cz():w0()+Ez()}function RI(){return ks?x0()+wz()+Sz():x0()+Mz()}function x0(){return yu.documentElement.scrollTop||yu.body.scrollTop}function w0(){return yu.documentElement.scrollLeft||yu.body.scrollLeft}function Mz(){return window.innerHeight}function Ez(){var s=window.innerWidth,e=document.documentElement.getBoundingClientRect(),t=m(document.documentElement)?0:e.width;return s-(s-t)}var Iz=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Cr=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Tz=function(s){Iz(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Cr([S("left")],e.prototype,"X",void 0),Cr([S("top")],e.prototype,"Y",void 0),e}(ke),jr={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},za=function(s){Iz(e,s);function e(t,i){return s.call(this,i,t)||this}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"width":tt(this.element,{width:qe(t.width)});break;case"height":tt(this.element,{height:qe(t.height)});break;case"zIndex":tt(this.element,{zIndex:t.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":var o=t.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+o).toString()+"px";break;case"offsetY":var l=t.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+l).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":t.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},e.prototype.getModuleName=function(){return"popup"},e.prototype.resolveCollision=function(){this.checkCollision()},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(jr.ROOT,jr.RTL,jr.OPEN,jr.CLOSE),this.content=null,this.relateTo=null,s.prototype.destroy.call(this)},e.prototype.render=function(){this.element.classList.add(jr.ROOT);var t={};this.zIndex!==1e3&&(t.zIndex=this.zIndex),this.width!=="auto"&&(t.width=qe(this.width)),this.height!=="auto"&&(t.height=qe(this.height)),tt(this.element,t),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},e.prototype.wireEvents=function(){B.isDevice&&I.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},e.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];I.add(r,"scroll",this.scrollRefresh,this)}},e.prototype.unwireEvents=function(){B.isDevice&&I.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},e.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];I.remove(r,"scroll",this.scrollRefresh)}},e.prototype.getRelateToElement=function(){var t=this.relateTo===""||m(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:t},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},e.prototype.scrollRefresh=function(t){if(this.actionOnScroll==="reposition"?!m(this.element)&&!(this.element.offsetParent===t.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&t.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),t.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},e.prototype.isElementOnViewport=function(t,i){for(var r=this.getScrollableParent(t),n=0;n<r.length;n++)if(!this.isElementVisible(t,r[n]))return!1;return!0},e.prototype.isElementVisible=function(t,i){var r=this.checkGetBoundingClientRect(t);if(!r.height||!r.width)return!1;if(m(this.checkGetBoundingClientRect(i))){var a=window,o={top:a.scrollY,left:a.scrollX,right:a.scrollX+a.outerWidth,bottom:a.scrollY+a.outerHeight},l=Fr(t),h={top:l.top,left:l.left,right:l.left+r.width,bottom:l.top+r.height},u={top:o.bottom-h.top,left:o.right-h.left,bottom:h.bottom-o.top,right:h.right-o.left};return u.top>0&&u.left>0&&u.right>0&&u.bottom>0}else{var n=i.getBoundingClientRect();return!(r.bottom<n.top)&&!(r.bottom>n.bottom)&&!(r.right>n.right)&&!(r.left<n.left)}},e.prototype.preRender=function(){},e.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(jr.RTL):this.element.classList.remove(jr.RTL)},e.prototype.setContent=function(){if(!m(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var t=this.getRelateToElement(),i=this.content.props;(!t.classList.contains("e-dropdown-btn")||m(i))&&this.element.appendChild(this.content)}},e.prototype.orientationOnChange=function(){var t=this;setTimeout(function(){t.refreshPosition()},200)},e.prototype.refreshPosition=function(t,i){m(t)||this.checkFixedParent(t),this.reposition(),i||this.checkCollision()},e.prototype.reposition=function(){var t,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")t={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var n=void 0,a=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?t={left:i.left,top:this.position.Y}:t={left:this.position.X,top:i.top},this.element.style.display=a,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(r){var o=this.element.clientHeight,a=this.element.style.display;this.element.style.display="block",t=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,o),this.element.style.display=a}else t={left:0,top:0};m(t)||(this.element.style.left=t.left+"px",this.element.style.top=t.top+"px")},e.prototype.checkGetBoundingClientRect=function(t){var i;try{return i=t.getBoundingClientRect(),i}catch{return null}},e.prototype.getAnchorPosition=function(t,i,r,n,a,o){o===void 0&&(o=0);var l=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(t);if(m(l)||m(h))return null;var u=t,c={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&t.tagName==="BODY"?c=Fr(t):(i.classList.contains("e-dlg-modal")&&u.tagName!=="BODY"&&(i=i.parentElement),c=pz(u,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.left+=window.innerWidth/2-l.width/2:this.targetType==="container"?c.left+=h.width/2-l.width/2:c.left+=h.width/2;break;case"right":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.left+=window.innerWidth-l.width:this.targetType==="container"?c.left+=h.width-l.width:c.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight/2-l.height/2:this.targetType==="container"?c.top+=h.height/2-l.height/2:c.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight-l.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?c.top+=h.height-l.height:this.targetType==="container"&&i.classList.contains("e-dialog")?c.top+=h.height-o:c.top+=h.height;break}return c.left+=n,c.top+=a,c},e.prototype.callFlip=function(t){var i=this.getRelateToElement();b7(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,t,this.fixedParent)},e.prototype.callFit=function(t){if(Qa(this.element,this.viewPortElement).length!==0)if(m(this.viewPortElement)){var i=AI(this.element,this.viewPortElement,t);t.X&&(this.element.style.left=i.left+"px"),t.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),n=this.checkGetBoundingClientRect(this.viewPortElement);if(m(r)||m(n))return null;t&&t.Y===!0&&(n.top>r.top?this.element.style.top="0px":n.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-n.bottom)+"px")),t&&t.X===!0&&(n.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-n.right)+"px":n.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-r.left)+"px"))}},e.prototype.checkCollision=function(){var t=this.collision.X,i=this.collision.Y;t==="none"&&i==="none"||(t==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):t==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(t==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),t==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},e.prototype.show=function(t,i){var r=this,n=this.getRelateToElement();if(n.classList.contains("e-filemanager")&&(this.fmDialogContainer=this.element.getElementsByClassName("e-file-select-wrap")[0]),this.wireEvents(),!m(this.fmDialogContainer)&&B.isIos&&(this.fmDialogContainer.style.display="block"),this.zIndex===1e3||!m(i)){var a=m(i)?this.element:i;this.zIndex=bu(a),tt(this.element,{zIndex:this.zIndex})}t=!m(t)&&typeof t=="object"?t:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(te([this.element],jr.CLOSE),Q([this.element],jr.OPEN),this.checkCollision(),te([this.element],jr.OPEN),Q([this.element],jr.CLOSE)),m(t)?(te([this.element],jr.CLOSE),Q([this.element],jr.OPEN),this.trigger("open")):(t.begin=function(){r.isDestroyed||(te([r.element],jr.CLOSE),Q([r.element],jr.OPEN))},t.end=function(){r.isDestroyed||r.trigger("open")},new ri(t).animate(this.element))},e.prototype.hide=function(t){var i=this;t=!m(t)&&typeof t=="object"?t:this.hideAnimation,m(t)?(te([this.element],jr.OPEN),Q([this.element],jr.CLOSE),this.trigger("close")):(t.end=function(){i.isDestroyed||(te([i.element],jr.OPEN),Q([i.element],jr.CLOSE),i.trigger("close"))},new ri(t).animate(this.element)),this.unwireEvents()},e.prototype.getScrollableParent=function(t){return this.checkFixedParent(t),DM(t,this.fixedParent)},e.prototype.checkFixedParent=function(t){for(var i=t.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);r.position==="fixed"&&!m(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?qe(window.scrollY-parseInt(this.element.style.top,10)):qe(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!m(this.element)&&m(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},Cr([S("auto")],e.prototype,"height",void 0),Cr([S("auto")],e.prototype,"width",void 0),Cr([S(null)],e.prototype,"content",void 0),Cr([S("container")],e.prototype,"targetType",void 0),Cr([S(null)],e.prototype,"viewPortElement",void 0),Cr([S({X:"none",Y:"none"})],e.prototype,"collision",void 0),Cr([S("")],e.prototype,"relateTo",void 0),Cr([Ee({},Tz)],e.prototype,"position",void 0),Cr([S(0)],e.prototype,"offsetX",void 0),Cr([S(0)],e.prototype,"offsetY",void 0),Cr([S(1e3)],e.prototype,"zIndex",void 0),Cr([S(!1)],e.prototype,"enableRtl",void 0),Cr([S("reposition")],e.prototype,"actionOnScroll",void 0),Cr([S(null)],e.prototype,"showAnimation",void 0),Cr([S(null)],e.prototype,"hideAnimation",void 0),Cr([_()],e.prototype,"open",void 0),Cr([_()],e.prototype,"close",void 0),Cr([_()],e.prototype,"targetExitViewport",void 0),e=Cr([Ot],e),e}(Pi);function DM(s,e){for(var t=getComputedStyle(s),i=[],r=/(auto|scroll)/,n=s.parentElement;n&&n.tagName!=="HTML";){var a=getComputedStyle(n);!(t.position==="absolute"&&a.position==="static")&&r.test(a.overflow+a.overflowY+a.overflowX)&&i.push(n),n=n.parentElement}return e||i.push(document),i}function bu(s){for(var e=s.parentElement,t=[];e&&e.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(e,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&t.push(i),e=e.parentElement}for(var n=[],a=0;a<document.body.children.length;a++)if(!s.isEqualNode(document.body.children[a])){var i=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}n.push("999");var o=[];if(!m(s.parentElement)&&s.parentElement.tagName!=="BODY"){for(var l=[].slice.call(s.parentElement.children),a=0;a<l.length;a++)if(!s.isEqualNode(l[a])){var i=document.defaultView.getComputedStyle(l[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(l[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&o.push(i)}}var h=t.concat(n,o),u=Math.max.apply(Math,h)+1;return u>2147483647?2147483647:u}function Dz(s,e,t,i,r,n){var a=i;if(i.tagName===e){var o=ie("ej2_instances",i);a=s("input",{attrs:{type:t}});for(var l=["change","cssClass","label","labelPosition","id"],h=0,u=i.attributes.length;h<u;h++)l.indexOf(i.attributes[h].nodeName)===-1&&a.setAttribute(i.attributes[h].nodeName,i.attributes[h].nodeValue);De(i,{class:r}),i.appendChild(a),kt("ej2_instances",o,a),dI(i,"ej2_instances")}return a}function x7(s){for(var e,t=s.childNodes,i=0;i<t.length;i++)if(e=t[i],e.nodeType===3)return e;return null}function M0(s,e,t){e===void 0&&(e=!1),t===void 0&&(t={});var i=s("div",{className:"e-checkbox-wrapper e-css"});if(t.cssClass&&Q([i],t.cssClass.split(" ")),t.enableRtl&&i.classList.add("e-rtl"),e){var r=s("span",{className:"e-ripple-container"});yr(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var n=s("span",{className:"e-frame e-icons"});if(t.checked&&n.classList.add("e-check"),i.appendChild(n),t.label){var a=s("span",{className:"e-label"});t.disableHtmlEncode?a.textContent=t.label:a.innerHTML=t.label,i.appendChild(a)}return i}function $h(s,e){if(e){var t=document.createEvent("MouseEvents");t.initEvent(s.type,!1,!0),e.dispatchEvent(t)}}function w7(s,e){s.element.getAttribute("ejs-for")&&e.appendChild(s.createElement("input",{attrs:{name:s.name||s.element.name,value:"false",type:"hidden"}}))}var M7=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),la=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},KA;(function(s){s.Left="Left",s.Right="Right",s.Top="Top",s.Bottom="Bottom"})(KA||(KA={}));var Ps={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},Ql=function(s){M7(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){},e.prototype.render=function(){this.initialize(),this.removeRippleEffect=yr(this.element,{selector:"."+Ps.BUTTON}),this.renderComplete()},e.prototype.initialize=function(){this.cssClass&&Q([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPrimary&&this.element.classList.add(Ps.PRIMARY);{if(this.content){var t=this.enableHtmlSanitizer?Fi.sanitize(this.content):this.content;this.element.innerHTML=t}this.setIconCss()}this.enableRtl&&this.element.classList.add(Ps.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},e.prototype.controlStatus=function(t){this.element.disabled=t},e.prototype.setIconCss=function(){if(this.iconCss){var t=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(t.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(Ps.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(t,i):this.element.appendChild(t)}},e.prototype.wireEvents=function(){this.isToggle&&I.add(this.element,"click",this.btnClickHandler,this)},e.prototype.unWireEvents=function(){this.isToggle&&I.remove(this.element,"click",this.btnClickHandler)},e.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},e.prototype.destroy=function(){var t=[Ps.PRIMARY,Ps.RTL,Ps.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(t=t.concat(this.cssClass.split(" "))),s.prototype.destroy.call(this),te([this.element],t),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&ne(i),this.unWireEvents(),Zl&&this.removeRippleEffect()},e.prototype.getModuleName=function(){return"btn"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.Inject=function(){},e.prototype.onPropertyChanged=function(t,i){for(var r=this.element.querySelector("span.e-btn-icon"),n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"isPrimary":t.isPrimary?this.element.classList.add(Ps.PRIMARY):this.element.classList.remove(Ps.PRIMARY);break;case"disabled":this.controlStatus(t.disabled);break;case"iconCss":{r=this.element.querySelector("span.e-btn-icon"),r?t.iconCss?(r.className="e-btn-icon "+t.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):ne(r):this.setIconCss();break}case"iconPosition":te([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&ne(r),this.setIconCss();break;case"cssClass":i.cssClass&&te([this.element],i.cssClass.split(" ")),t.cssClass&&Q([this.element],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?this.element.classList.add(Ps.RTL):this.element.classList.remove(Ps.RTL);break;case"content":{var l=x7(this.element);l||this.element.classList.remove(Ps.ICONBTN),this.enableHtmlSanitizer&&(t.content=Fi.sanitize(t.content)),this.element.innerHTML=t.content,this.setIconCss();break}case"isToggle":t.isToggle?I.add(this.element,"click",this.btnClickHandler,this):(I.remove(this.element,"click",this.btnClickHandler),te([this.element],["e-active"]));break}}},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()},la([S("Left")],e.prototype,"iconPosition",void 0),la([S("")],e.prototype,"iconCss",void 0),la([S(!1)],e.prototype,"disabled",void 0),la([S(!1)],e.prototype,"isPrimary",void 0),la([S("")],e.prototype,"cssClass",void 0),la([S("")],e.prototype,"content",void 0),la([S(!1)],e.prototype,"isToggle",void 0),la([S()],e.prototype,"locale",void 0),la([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),la([_()],e.prototype,"created",void 0),e=la([Ot],e),e}(Pi),E7=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),vs=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},KC="e-check",ZA="e-checkbox-disabled",Jd="e-frame",ZC="e-stop",JC="e-label",ep="e-ripple-container",eS="e-ripple-check",tS="e-ripple-stop",iS="e-rtl",rS="e-checkbox-wrapper",I7=["title","class","style","disabled","readonly","name","value","id"],Vo=function(s){E7(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.isFocused=!1,r.isMouseClick=!1,r.clickTriggered=!1,r.validCheck=!0,r}return e.prototype.changeState=function(t,i){var r,n=this.getWrapper().getElementsByClassName(Jd)[0];Zl&&(r=this.getWrapper().getElementsByClassName(ep)[0]),t==="check"?(n&&(n.classList.remove(ZC),n.classList.add(KC)),r&&(r.classList.remove(tS),r.classList.add(eS)),this.element.checked=!0,(this.element.required||U(this.element,"form")&&U(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i?(this.element.checked=!1,this.validCheck=!1):(this.element.required||U(this.element,"form")&&U(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):t==="uncheck"?(n&&te([n],[KC,ZC]),r&&te([r],[eS,tS]),this.element.checked=!1,(this.element.required||U(this.element,"form")&&U(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i?(this.element.checked=!0,this.validCheck=!1):(this.element.required||U(this.element,"form")&&U(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):(n&&(n.classList.remove(KC),n.classList.add(ZC)),r&&(r.classList.remove(eS),r.classList.add(tS)),this.element.indeterminate=!0,this.indeterminate=!0)},e.prototype.clickHandler=function(t){if(t.target.tagName==="INPUT"&&this.clickTriggered){this.isVue&&this.changeState(this.checked?"check":"uncheck"),this.clickTriggered=!1;return}(t.target.tagName==="SPAN"||t.target.tagName==="LABEL")&&(this.clickTriggered=!0),this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck"),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck"),this.checked=!1):(this.changeState("check"),this.checked=!0);var i={checked:this.updateVueArrayModel(!1),event:t};this.trigger("change",i),t.stopPropagation()},e.prototype.destroy=function(){var t=this,i=this.getWrapper();s.prototype.destroy.call(this),this.wrapper&&(i=this.wrapper,this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(this.getWrapper()&&i.parentNode&&i.parentNode.insertBefore(this.element,i),ne(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(r){t.element.removeAttribute(r)})):(["class"].forEach(function(r){i.removeAttribute(r)}),i.innerHTML="",this.element=i,this.refreshing&&(["e-control","e-checkbox","e-lib"].forEach(function(r){t.element.classList.add(r)}),kt("ej2_instances",[this],this.element))))},e.prototype.focusHandler=function(){this.isFocused=!0},e.prototype.focusOutHandler=function(){var t=this.getWrapper();t&&t.classList.remove("e-focus"),this.isFocused=!1},e.prototype.getModuleName=function(){return"checkbox"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},e.prototype.getWrapper=function(){return this.element&&this.element.parentElement?this.element.parentElement.parentElement:null},e.prototype.getLabel=function(){return this.element?this.element.parentElement:null},e.prototype.initialize=function(){m(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.value&&(this.element.setAttribute("value",this.value),this.isVue&&typeof this.value=="boolean"&&this.value===!0&&this.setProperties({checked:!0},!0)),this.checked&&this.changeState("check",!0),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains(rS)||(t=this.createElement("div",{className:rS}),this.element.parentNode.insertBefore(t,this.element));var i=this.createElement("label",{attrs:{for:this.element.id}}),r=this.createElement("span",{className:"e-icons "+Jd});if(t.classList.add("e-wrapper"),this.enableRtl&&t.classList.add(iS),this.cssClass&&Q([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),t.appendChild(i),i.appendChild(this.element),w7(this,i),i.appendChild(r),Zl){var n=this.createElement("span",{className:ep});this.labelPosition==="Before"?i.appendChild(n):i.insertBefore(n,r),yr(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},e.prototype.keyUpHandler=function(){this.isFocused&&this.getWrapper().classList.add("e-focus")},e.prototype.labelMouseDownHandler=function(t){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(ep)[0];$h(t,i)},e.prototype.labelMouseLeaveHandler=function(t){var i=this.getLabel().getElementsByClassName(ep)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=r.length-1;n>0;n--)i.removeChild(i.childNodes[n]);$h(t,i)}},e.prototype.labelMouseUpHandler=function(t){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(ep)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=0;n<r.length-1;n++)i.removeChild(i.childNodes[n]);$h(t,i)}},e.prototype.onPropertyChanged=function(t,i){for(var r=this.getWrapper(),n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(t.checked?"check":"uncheck");break;case"indeterminate":t.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":t.disabled?(this.setDisabled(),this.wrapper=this.getWrapper(),this.unWireEvents()):(this.element.disabled=!1,r.classList.remove(ZA),r.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":i.cssClass&&te([r],i.cssClass.split(" ")),t.cssClass&&Q([r],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?r.classList.add(iS):r.classList.remove(iS);break;case"label":this.setText(t.label);break;case"labelPosition":{var l=r.getElementsByClassName(JC)[0],h=r.getElementsByTagName("label")[0];ne(l),t.labelPosition==="After"?h.appendChild(l):h.insertBefore(l,r.getElementsByClassName(Jd)[0]);break}case"name":this.element.setAttribute("name",t.name);break;case"value":if(this.isVue&&typeof t.value=="object")break;this.element.setAttribute("value",t.value);break;case"htmlAttributes":this.updateHtmlAttributeToWrapper();break}}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=Dz(this.createElement,"EJS-CHECKBOX","checkbox",t,rS),this.element=t,this.element.getAttribute("type")!=="checkbox"&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=mi("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.updateHtmlAttributeToWrapper(),this.updateVueArrayModel(!0),this.renderComplete(),this.wrapper=this.getWrapper()},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add(ZA),t.setAttribute("aria-disabled","true")},e.prototype.setText=function(t){var i=this.getWrapper();if(i){var r=i.getElementsByClassName(JC)[0];if(r)r.textContent=t;else{t=this.enableHtmlSanitizer?Fi.sanitize(t):t,r=this.createElement("span",{className:JC,innerHTML:t});var n=i.getElementsByTagName("label")[0];this.labelPosition==="Before"?n.insertBefore(r,i.getElementsByClassName(Jd)[0]):n.appendChild(r)}}},e.prototype.changeHandler=function(t){t.stopPropagation()},e.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.element.checked=this.initialCheckedValue},e.prototype.unWireEvents=function(){var t=this.wrapper;I.remove(t,"click",this.clickHandler),I.remove(this.element,"keyup",this.keyUpHandler),I.remove(this.element,"focus",this.focusHandler),I.remove(this.element,"focusout",this.focusOutHandler);var i=t.getElementsByTagName("label")[0];I.remove(i,"mousedown",this.labelMouseDownHandler),I.remove(i,"mouseup",this.labelMouseUpHandler),I.remove(i,"mouseleave",this.labelMouseLeaveHandler);var r=U(this.element,"form");r&&I.remove(r,"reset",this.formResetHandler),this.tagName==="EJS-CHECKBOX"&&I.remove(this.element,"change",this.changeHandler)},e.prototype.wireEvents=function(){var t=this.getWrapper();I.add(t,"click",this.clickHandler,this),I.add(this.element,"keyup",this.keyUpHandler,this),I.add(this.element,"focus",this.focusHandler,this),I.add(this.element,"focusout",this.focusOutHandler,this);var i=t.getElementsByTagName("label")[0];I.add(i,"mousedown",this.labelMouseDownHandler,this),I.add(i,"mouseup",this.labelMouseUpHandler,this),I.add(i,"mouseleave",this.labelMouseLeaveHandler,this);var r=U(this.element,"form");r&&I.add(r,"reset",this.formResetHandler,this),this.tagName==="EJS-CHECKBOX"&&I.add(this.element,"change",this.changeHandler,this)},e.prototype.updateVueArrayModel=function(t){if(this.isVue&&typeof this.value=="object"){var i=this.element.value;if(i&&this.value)if(t)for(var r=0;r<this.value.length;r++)i===this.value[r]&&(this.changeState("check"),this.setProperties({checked:!0},!0));else{var n=this.value.indexOf(i);return this.checked?n<0&&this.value.push(i):n>-1&&this.value.splice(n,1),this.value}}return this.validCheck?this.element.checked:!this.element.checked},e.prototype.updateHtmlAttributeToWrapper=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t],n=this.getWrapper();if(I7.indexOf(r)>-1)if(r==="class")Q([n],this.htmlAttributes[""+r].split(" "));else if(r==="title")n.setAttribute(r,this.htmlAttributes[""+r]);else if(r==="style"){var a=this.getWrapper().getElementsByClassName(Jd)[0];a.setAttribute(r,this.htmlAttributes[""+r])}else r==="disabled"?(this.htmlAttributes[""+r]==="true"&&this.setDisabled(),this.element.setAttribute(r,this.htmlAttributes[""+r])):this.element.setAttribute(r,this.htmlAttributes[""+r]);else n.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()},vs([_()],e.prototype,"change",void 0),vs([_()],e.prototype,"created",void 0),vs([S(!1)],e.prototype,"checked",void 0),vs([S("")],e.prototype,"cssClass",void 0),vs([S(!1)],e.prototype,"disabled",void 0),vs([S(!1)],e.prototype,"indeterminate",void 0),vs([S("")],e.prototype,"label",void 0),vs([S("After")],e.prototype,"labelPosition",void 0),vs([S("")],e.prototype,"name",void 0),vs([S("")],e.prototype,"value",void 0),vs([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),vs([S({})],e.prototype,"htmlAttributes",void 0),e=vs([Ot],e),e}(Pi),T7=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),zs=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},nS="e-label",im="e-ripple-container",sS="e-rtl",aS="e-radio-wrapper",D7=["title","class","style","disabled","readonly","name","value","id"],E0=function(s){T7(e,s);function e(i,r){var n=s.call(this,i,r)||this;return n.isFocused=!1,n}t=e,e.prototype.changeHandler=function(i){this.checked=!0,this.dataBind();var r=this.element.getAttribute("value");r=this.isVue&&r?this.element.value:this.value;var n=typeof this.value;this.isVue&&n==="boolean"&&(r=r==="true"),this.trigger("change",{value:r,event:i}),this.isAngular&&i.stopPropagation()},e.prototype.updateChange=function(){for(var i,r,n=this.getRadioGroup(),a=0;a<n.length;a++)i=n[a],i!==this.element&&(r=Ln(i,t),r.checked=!1,this.tagName==="EJS-RADIOBUTTON"&&(r.angularValue=this.value))},e.prototype.destroy=function(){var i=this,r=this.wrapper;s.prototype.destroy.call(this),r&&(this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(r.parentNode&&r.parentNode.insertBefore(this.element,r),ne(r),this.element.checked=!1,["name","value","disabled"].forEach(function(n){i.element.removeAttribute(n)})):(["role","aria-checked","class"].forEach(function(n){r.removeAttribute(n)}),r.innerHTML="",this.element=this.wrapper,this.refreshing&&(["e-control","e-radio","e-lib"].forEach(function(n){i.element.classList.add(n)}),kt("ej2_instances",[this],this.element))))},e.prototype.focusHandler=function(){this.isFocused=!0},e.prototype.focusOutHandler=function(){var i=this.getLabel();i&&i.classList.remove("e-focus")},e.prototype.getModuleName=function(){return"radio"},e.prototype.getSelectedValue=function(){for(var i,r=this.getRadioGroup(),n=0,a=r.length;n<a;n++)if(i=r[n],i.checked)return i.value;return""},e.prototype.getRadioGroup=function(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getWrapper=function(){return this.element?this.element.parentElement:null},e.prototype.getLabel=function(){return this.element?this.element.nextElementSibling:null},e.prototype.initialize=function(){m(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.updateHtmlAttribute(),this.name&&this.element.setAttribute("name",this.name);var i=this.element.getAttribute("value"),r=typeof this.value;this.isVue&&r==="boolean"&&(i=i==="true"),(this.isVue?this.value&&r!=="boolean"&&!i:this.value)&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var i,r=this.element.parentElement;r.classList.contains(aS)||(r=this.createElement("div",{className:aS}),this.element.parentNode.insertBefore(r,this.element));var n=this.createElement("label",{attrs:{for:this.element.id}});r.appendChild(this.element),r.appendChild(n),Zl&&(i=this.createElement("span",{className:im}),n.appendChild(i),yr(i,{duration:400,isCenterRipple:!0})),r.classList.add("e-wrapper"),this.enableRtl&&n.classList.add(sS),this.cssClass&&Q([r],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.label&&this.setText(this.label)},e.prototype.keyUpHandler=function(){this.isFocused&&this.getLabel().classList.add("e-focus")},e.prototype.labelMouseDownHandler=function(i){var r=this.getLabel().getElementsByClassName(im)[0];$h(i,r)},e.prototype.labelMouseLeaveHandler=function(i){var r=this.getLabel().getElementsByClassName(im)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),a=n.length-1;a>0;a--)r.removeChild(r.childNodes[a]);$h(i,r)}},e.prototype.labelMouseUpHandler=function(i){var r=this.getLabel().getElementsByClassName(im)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),a=n.length-1;a>0;a--)r.removeChild(r.childNodes[a]);$h(i,r)}},e.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&De(this.element,{checked:"true"})},e.prototype.onPropertyChanged=function(i,r){for(var n=this.getWrapper(),a=this.getLabel(),o=0,l=Object.keys(i);o<l.length;o++){var h=l[o];switch(h){case"checked":i.checked&&this.updateChange(),this.element.checked=i.checked;break;case"disabled":i.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":r.cssClass&&te([n],r.cssClass.split(" ")),i.cssClass&&Q([n],i.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":i.enableRtl?a.classList.add(sS):a.classList.remove(sS);break;case"label":this.setText(i.label);break;case"labelPosition":i.labelPosition==="Before"?a.classList.add("e-right"):a.classList.remove("e-right");break;case"name":this.element.setAttribute("name",i.name);break;case"value":var u=typeof this.htmlAttributes.value;if(!m(this.htmlAttributes)&&(this.htmlAttributes.value||u==="boolean"&&!this.htmlAttributes.value))break;this.element.setAttribute("value",i.value);break;case"htmlAttributes":this.updateHtmlAttribute();break}}},e.prototype.preRender=function(){var i=this.element;if(this.formElement=U(this.element,"form"),this.tagName=this.element.tagName,i=Dz(this.createElement,"EJS-RADIOBUTTON","radio",i,aS),this.element=i,this.element.getAttribute("type")!=="radio"&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=mi("e-"+this.getModuleName())),this.tagName==="EJS-RADIOBUTTON"){var r=this.element.getAttribute("formcontrolname");r&&(this.setProperties({name:r},!0),this.element.setAttribute("name",r))}},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete(),this.wrapper=this.getWrapper()},e.prototype.setDisabled=function(){this.element.disabled=!0},e.prototype.setText=function(i){var r=this.getLabel(),n=r.getElementsByClassName(nS)[0];n?n.textContent=i:(i=this.enableHtmlSanitizer?Fi.sanitize(i):i,n=this.createElement("span",{className:nS,innerHTML:i}),r.appendChild(n)),this.labelPosition==="Before"?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},e.prototype.updateHtmlAttribute=function(){if(!m(this.htmlAttributes))for(var i=0,r=Object.keys(this.htmlAttributes);i<r.length;i++){var n=r[i],a=this.element.parentElement;D7.indexOf(n)>-1?n==="class"?Q([a],this.htmlAttributes[""+n].replace(/\s+/g," ").trim().split(" ")):n==="title"||n==="style"?a.setAttribute(n,this.htmlAttributes[""+n]):this.element.setAttribute(n,this.htmlAttributes[""+n]):a.setAttribute(n,this.htmlAttributes[""+n])}},e.prototype.unWireEvents=function(){var i=this.wrapper;I.remove(this.element,"change",this.changeHandler),I.remove(this.element,"focus",this.focusHandler),I.remove(this.element,"focusout",this.focusOutHandler),I.remove(this.element,"keyup",this.keyUpHandler);var r=i.getElementsByTagName("label")[0];r&&(I.remove(r,"mousedown",this.labelMouseDownHandler),I.remove(r,"mouseup",this.labelMouseUpHandler),I.remove(r,"mouseleave",this.labelMouseLeaveHandler)),this.formElement&&I.remove(this.formElement,"reset",this.formResetHandler)},e.prototype.wireEvents=function(){var i=this.getLabel();I.add(this.element,"change",this.changeHandler,this),I.add(this.element,"keyup",this.keyUpHandler,this),I.add(this.element,"focus",this.focusHandler,this),I.add(this.element,"focusout",this.focusOutHandler,this);var r=i.getElementsByClassName(nS)[0];r&&(I.add(r,"mousedown",this.labelMouseDownHandler,this),I.add(r,"mouseup",this.labelMouseUpHandler,this),I.add(r,"mouseleave",this.labelMouseLeaveHandler,this)),this.formElement&&I.add(this.formElement,"reset",this.formResetHandler,this)},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()};var t;return zs([_()],e.prototype,"change",void 0),zs([_()],e.prototype,"created",void 0),zs([S(!1)],e.prototype,"checked",void 0),zs([S("")],e.prototype,"cssClass",void 0),zs([S(!1)],e.prototype,"disabled",void 0),zs([S("")],e.prototype,"label",void 0),zs([S("After")],e.prototype,"labelPosition",void 0),zs([S("")],e.prototype,"name",void 0),zs([S("")],e.prototype,"value",void 0),zs([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),zs([S({})],e.prototype,"htmlAttributes",void 0),e=t=zs([Ot],e),e}(Pi),oS=["north-west","north","north-east","west","east","south-west","south","south-east"],Iv="e-resize-handle",Gl="e-focused-handle",A7="e-dlg-resizable",JA=["e-restrict-left"],Az="e-resize-viewport",N7=["north","west","east","south"],Ci,Wa,FI=0,PI=0,Nz=0,kz=0,nv=0,sv=0,Qc,Ll,zI,zo,$t,av=null,AM=null,NM=null,il,I0=!0,eN=0,lS=!0,lh;function k7(s){av=s.resizeBegin,AM=s.resizing,NM=s.resizeComplete,Ci=tN(s.element),$t=tN(s.boundary);for(var e=s.direction.split(" "),t=0;t<e.length;t++)if(N7.indexOf(e[t])>=0&&e[t])L7(e[t]);else if(e[t].trim()!==""){var i=St("div",{className:"e-icons "+Iv+" e-"+e[t]});Ci.appendChild(i)}Qc=s.minHeight,zI=s.minWidth,zo=s.maxWidth,Ll=s.maxHeight,s.proxy&&s.proxy.element&&s.proxy.element.classList.contains("e-dialog")?iN(s.proxy):iN()}function L7(s){jI();var e=St("span",{attrs:{unselectable:"on",contenteditable:"false"}});e.setAttribute("class","e-dialog-border-resize e-"+s),s==="south"&&(e.style.height="2px",e.style.width="100%",e.style.bottom="0px",e.style.left="0px"),s==="north"&&(e.style.height="2px",e.style.width="100%",e.style.top="0px",e.style.left="0px"),s==="east"&&(e.style.height="100%",e.style.width="2px",e.style.right="0px",e.style.top="0px"),s==="west"&&(e.style.height="100%",e.style.width="2px",e.style.left="0px",e.style.top="0px"),Ci.appendChild(e)}function tN(s){var e;return m(s)||(typeof s=="string"?e=document.querySelector(s):e=s),e}function iN(s){m(s)&&(s=this);for(var e=Ci.querySelectorAll("."+Iv),t=0;t<e.length;t++){Wa=e[t],I.add(Wa,"mousedown",rN,s);var i=B.info.name==="msie"?"pointerdown":"touchstart";I.add(Wa,i,nN,s)}var r=Ci.querySelectorAll(".e-dialog-border-resize");if(!m(r))for(var t=0;t<r.length;t++){Wa=r[t],I.add(Wa,"mousedown",rN,s);var i=B.info.name==="msie"?"pointerdown":"touchstart";I.add(Wa,i,nN,s)}}function Lz(s){return s.indexOf("mouse")>-1?"mouse":"touch"}function rN(s){if(s.preventDefault(),Ci=s.target.parentElement,jI(),nv=s.pageX,sv=s.pageY,s.target.classList.add(Gl),!(!m(av)&&(lh=this,av(s,lh)===!0))){this.targetEle&&Ci&&Ci.querySelector("."+A7)&&($t=this.target==="body"?null:this.targetEle,zo=this.targetEle.clientWidth,Ll=this.targetEle.clientHeight);var e=m($t)?document:$t;I.add(e,"mousemove",Jp,this),I.add(document,"mouseup",T0,this);for(var t=0;t<JA.length;t++)Ci.classList.contains(JA[t])?I0=!1:I0=!0}}function T0(s){var e=B.info.name==="msie"?"pointermove":"touchmove",t=B.info.name==="msie"?"pointerup":"touchend",i=m($t)?document:$t,r=B.info.name==="msie"?"pointerdown":"touchstart";I.remove(i,"mousemove",Jp),I.remove(i,e,Jp),I.remove(i,r,Jp),m(document.body.querySelector("."+Gl))||document.body.querySelector("."+Gl).classList.remove(Gl),m(NM)||(lh=this,NM(s,lh)),I.remove(document,"mouseup",T0),I.remove(document,t,T0)}function jI(){FI=parseFloat(getComputedStyle(Ci,null).getPropertyValue("width").replace("px","")),PI=parseFloat(getComputedStyle(Ci,null).getPropertyValue("height").replace("px","")),Nz=Ci.getBoundingClientRect().left,kz=Ci.getBoundingClientRect().top}function nN(s){Ci=s.target.parentElement,jI();var e=Ci.classList.contains("e-dialog");(s.target.classList.contains(Iv)||s.target.classList.contains("e-dialog-border-resize"))&&e&&s.target.classList.add(Gl);var t=s.touches?s.changedTouches[0]:s;if(nv=t.pageX,sv=t.pageY,!(!m(av)&&(lh=this,av(s,lh)===!0))){var i=B.info.name==="msie"?"pointermove":"touchmove",r=B.info.name==="msie"?"pointerup":"touchend",n=m($t)?document:$t;I.add(n,i,Jp,this),I.add(document,r,T0,this)}}function Jp(s){if(s.target.classList.contains(Iv)&&s.target.classList.contains(Gl)?Wa=s.target:m(document.body.querySelector("."+Gl))||(Wa=document.body.querySelector("."+Gl)),!m(Wa)){for(var e="",t=0;t<oS.length;t++)Wa.classList.contains("e-"+oS[t])&&(e=oS[t]);switch(m(AM)||(lh=this,AM(s,lh)),e){case"south":hS(s);break;case"north":uS(s);break;case"west":cS(s);break;case"east":dS(s);break;case"south-east":hS(s),dS(s);break;case"south-west":hS(s),cS(s);break;case"north-east":uS(s),dS(s);break;case"north-west":uS(s),cS(s);break}}}function hh(s){return s.getBoundingClientRect()}function hS(s){var e=document.documentElement.clientHeight,t=!1,i=s.touches?s.changedTouches[0]:s,r=i.pageY,n=hh(Ci),a;m($t)||(a=hh($t)),m($t)?m($t)&&(e-r>=0||n.top<0)&&(t=!0):t=!0;var o=PI+(r-sv);o=o>Qc?o:Qc;var l=0;m($t)||(l=a.top);var h=m($t)?0:$t.offsetHeight-$t.clientHeight,u=n.top-l-h/2;if(u=u<0?0:u,n.top>0&&u+o>Ll){if(t=!1,Ci.classList.contains(Az))return;Ci.style.height=Ll-parseInt(u.toString(),10)+"px";return}var c=0;if(t){n.top<0&&e+(n.height+n.top)>0&&(c=n.top,o+c<=30&&(o=n.height-(n.height+n.top)+30)),o+n.top>=Ll&&(Ci.style.height=n.height+(e-(n.height+n.top))+"px");var d=m($t)?c:u;o>=Qc&&o+d<=Ll&&(Ci.style.height=o+"px")}}function uS(s){var e=!1,t,i=Lz(s.type)==="mouse"?s.pageY:s.touches[0].pageY,r=hh(Ci);m($t)||(t=hh($t)),(!m($t)&&r.top-t.top>0||m($t)&&i>0)&&(e=!0);var n=PI-(i-sv);if(e&&n>=Qc&&n<=Ll){var a=0;m($t)||(a=t.top);var o=kz-a+(i-sv);o=o>0?o:1,Ci.style.height=n+"px",Ci.style.top=o+"px"}}function cS(s){var e=document.documentElement.clientWidth,t=!1,i;m($t)||(i=hh($t));var r=Lz(s.type)==="mouse"?s.pageX:s.touches[0].pageX,n=hh(Ci),a=m($t)?0:$t.offsetWidth-$t.clientWidth,o=m($t)?0:i.left,l=m($t)?0:i.width;m(il)&&(m($t)?il=e:(il=n.left-o-a/2+n.width,il=il+(l-a-il))),(!m($t)&&Math.floor(n.left-i.left+n.width+(i.right-n.right))-a<=zo||m($t)&&r>=0)&&(t=!0);var h=FI-(r-nv);if(I0&&(h=h>il?il:h),t&&h>=zI&&h<=zo){var u=0;m($t)||(u=i.left);var c=Nz-u+(r-nv);c=c>0?c:1,h!==eN&&lS&&(Ci.style.width=h+"px"),I0&&(Ci.style.left=c+"px",c===1?lS=!1:lS=!0)}eN=h}function dS(s){var e=document.documentElement.clientWidth,t=!1,i;m($t)||(i=hh($t));var r=s.touches?s.changedTouches[0]:s,n=r.pageX,a=hh(Ci);(!m($t)&&(a.left-i.left+a.width<=zo||a.right-i.left>=a.width)||m($t)&&e-n>0)&&(t=!0);var o=FI+(n-nv),l=0;if(m($t)||(l=i.left),a.left-l+o>zo){if(t=!1,Ci.classList.contains(Az))return;Ci.style.width=zo-(a.left-l)+"px"}t&&o>=zI&&o<=zo&&(Ci.style.width=o+"px")}function O7(s){Qc=s}function R7(s){zo=s}function F7(s){Ll=s}function sN(){for(var s=Ci.querySelectorAll("."+Iv),e=0;e<s.length;e++)ne(s[e]);var t=Ci.querySelectorAll(".e-dialog-border-resize");if(!m(t))for(var e=0;e<t.length;e++)ne(t[e])}var BI=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Rt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},P7=function(s){BI(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Rt([S(!0)],e.prototype,"isFlat",void 0),Rt([S()],e.prototype,"buttonModel",void 0),Rt([S("Button")],e.prototype,"type",void 0),Rt([_()],e.prototype,"click",void 0),e}(ke),z7=function(s){BI(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Rt([S("Fade")],e.prototype,"effect",void 0),Rt([S(400)],e.prototype,"duration",void 0),Rt([S(0)],e.prototype,"delay",void 0),e}(ke),rm="e-dialog",pS="e-rtl",fS="e-dlg-header-content",aN="e-dlg-header",tp="e-footer-content",nm="e-dlg-modal",j7="e-dlg-content",oN="e-icon-dlg-close",B7="e-dlg-overlay",Ba="e-dlg-target",H7="e-dlg-container",ha="e-scroll-disabled",V7="e-primary",U7="e-icons",_7="e-popup",lN="e-device",sm="e-dlg-fullscreen",hN="e-dlg-closeicon-btn",W7="e-popup-close",uN="e-popup-open",cN="Information",dN="e-scroll-disabled",Oz="e-alert-dialog",Rz="e-confirm-dialog",vS="e-dlg-resizable",am="e-restrict-left",pN="e-resize-viewport",q7="e-dlg-ref-element",mS="user action",Y7="close icon",Q7="escape",G7="overlayClick",$7="e-draggable",Tv=function(s){BI(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.needsID=!0,r}return e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.width==="100%"&&(this.element.style.width=""),this.minHeight!==""&&(this.element.style.minHeight=qe(this.minHeight)),this.enableResize&&(this.setResize(),this.animationSettings.effect==="None"&&this.getMinHeight()),this.renderComplete()},e.prototype.initializeValue=function(){this.dlgClosedBy=mS},e.prototype.preRender=function(){var t=this;this.initializeValue(),this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(n){t.dlgClosedBy=Y7,t.hide(n)},this.dlgOverlayClickEventHandler=function(n){t.dlgClosedBy=G7,n.preventFocus=!1,t.trigger("overlayClick",n,function(a){a.preventFocus||t.focusContent(),t.dlgClosedBy=mS})};var i={close:"Close"};if(this.l10n=new In("dialog",i,this.locale),this.checkPositionData(),m(this.target)){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=r}},e.prototype.updatePersistData=function(){this.enablePersistence&&this.setProperties({width:parseFloat(this.element.style.width),height:parseFloat(this.element.style.height),position:{X:parseFloat(this.dragObj.element.style.left),Y:parseFloat(this.dragObj.element.style.top)}},!0)},e.prototype.isNumberValue=function(t){var i=/^[-+]?\d*\.?\d+$/.test(t);return i},e.prototype.checkPositionData=function(){if(!m(this.position)){if(!m(this.position.X)&&typeof this.position.X!="number"){var t=this.isNumberValue(this.position.X);if(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=i}}if(!m(this.position.Y)&&typeof this.position.Y!="number"){var t=this.isNumberValue(this.position.Y);if(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=i}}}},e.prototype.getEle=function(t,i){for(var r=void 0,n=0;n<t.length;n++)if(t[n].classList.contains(i)){r=t[n];break}return r},e.prototype.getMinHeight=function(){var t="0px",i="0px";m(this.element.querySelector("."+fS))||(t=getComputedStyle(this.headerContent).height);var r=this.getEle(this.element.children,tp);m(r)||(i=getComputedStyle(r).height);var n=parseInt(t.slice(0,t.indexOf("p")),10),a=parseInt(i.slice(0,i.indexOf("p")),10);return O7(n+30+(isNaN(a)?0:a)),n+30+a},e.prototype.onResizeStart=function(t,i){return i.trigger("resizeStart",t),t.cancel},e.prototype.onResizing=function(t,i){i.trigger("resizing",t)},e.prototype.onResizeComplete=function(t,i){i.trigger("resizeStop",t),this.updatePersistData()},e.prototype.setResize=function(){if(this.enableResize){if(this.isBlazorServerRender()&&!m(this.element.querySelector(".e-icons.e-resize-handle")))return;this.element.classList.add(vS);for(var t=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth,r="",n=0;n<this.resizeHandles.length;n++)if(this.resizeHandles[n]==="All"){r="south north east west north-east north-west south-east south-west";break}else{var a="";switch(this.resizeHandles[n].toString()){case"SouthEast":a="south-east";break;case"SouthWest":a="south-west";break;case"NorthEast":a="north-east";break;case"NorthWest":a="north-west";break;default:a=this.resizeHandles[n].toString();break}r+=a.toLocaleLowerCase()+" "}this.enableRtl&&r.trim()==="south-east"?r="south-west":this.enableRtl&&r.trim()==="south-west"&&(r="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(am):this.isModal&&this.target===document.body&&this.element.classList.add(pN),k7({element:this.element,direction:r,minHeight:parseInt(t.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else sN(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove(am):this.element.classList.remove(pN),this.element.classList.remove(vS)},e.prototype.getFocusElement=function(t){var i='input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]',r=t.querySelectorAll(i);return{element:r[r.length-1]}},e.prototype.keyDown=function(t){var i=this;if(t.keyCode===9&&this.isModal){var r=void 0;m(this.btnObj)||(r=this.btnObj[this.btnObj.length-1]),m(this.btnObj)&&!m(this.ftrTemplateContent)&&(r=this.getFocusElement(this.ftrTemplateContent)),m(this.btnObj)&&m(this.ftrTemplateContent)&&!m(this.contentEle)&&(r=this.getFocusElement(this.contentEle)),!m(r)&&document.activeElement===r.element&&!t.shiftKey&&(t.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&t.shiftKey&&(t.preventDefault(),m(r)||r.element.focus())}var n=document.activeElement,a=["input","textarea"].indexOf(n.tagName.toLowerCase())>-1,o=!1;if(a||(o=n.hasAttribute("contenteditable")&&n.getAttribute("contenteditable")==="true"),t.keyCode===27&&this.closeOnEscape){this.dlgClosedBy=Q7;var l=document.querySelector(".e-popup-open:not(.e-dialog)");!m(l)&&!l.classList.contains("e-toolbar-pop")||this.hide(t)}if(t.keyCode===13&&!t.ctrlKey&&n.tagName.toLowerCase()!=="textarea"&&a&&!m(this.primaryButtonEle)||t.keyCode===13&&t.ctrlKey&&(n.tagName.toLowerCase()==="textarea"||o)&&!m(this.primaryButtonEle)){var h,u=this.buttons.some(function(c,d){h=d;var p=c.buttonModel;return!m(p)&&p.isPrimary===!0});u&&typeof this.buttons[h].click=="function"&&setTimeout(function(){i.buttons[h].click.call(i,t)})}},e.prototype.initialize=function(){m(this.target)||(this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target),this.isBlazorServerRender()||Q([this.element],rm),B.isDevice&&Q([this.element],lN),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()},e.prototype.initRender=function(){var t=this;if(this.initialRender=!0,this.isBlazorServerRender()||De(this.element,{role:"dialog"}),this.zIndex===1e3?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.isBlazorServerRender()&&m(this.headerContent)&&(this.headerContent=this.element.getElementsByClassName("e-dlg-header-content")[0]),this.isBlazorServerRender()&&m(this.contentEle)&&(this.contentEle=this.element.querySelector("#"+this.element.id+"_dialog-content")),this.isBlazorServerRender()||(this.setTargetContent(),this.header!==""&&!m(this.header)&&this.setHeader(),this.renderCloseIcon(),this.setContent(),this.footerTemplate!==""&&!m(this.footerTemplate)?this.setFooterTemplate():m(this.buttons[0].buttonModel)||this.setButton()),this.isBlazorServerRender()&&!m(this.buttons[0].buttonModel)&&this.footerTemplate===""&&this.setButton(),this.allowDragging&&!m(this.headerContent)&&this.setAllowDragging(),this.isBlazorServerRender()||(De(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal()),this.isBlazorServerRender()&&m(this.dlgContainer)){this.dlgContainer=this.element.parentElement;for(var i=0,r=this.dlgContainer.children;i<r.length;i++)r[i].classList.contains("e-dlg-overlay")&&(this.dlgOverlay=r[i])}if(this.element.classList.contains(Oz)!==!0&&this.element.classList.contains(Rz)!==!0&&!m(this.element.parentElement)){var n=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:q7}),n.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}if(m(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new za(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:function(l){var h={container:t.isModal?t.dlgContainer:t.element,element:t.element,target:t.target,preventFocus:!1};t.enableResize&&t.resetResizeIcon(),t.trigger("open",h,function(u){u.preventFocus||t.focusContent()})},close:function(l){t.isModal&&Q([t.dlgOverlay],"e-fade"),t.unBindEvent(t.element),t.isModal&&(t.dlgContainer.style.display="none"),t.trigger("close",t.closeArgs);var h=document.activeElement;!m(h)&&!m(h.blur)&&h.blur(),!m(t.storeActiveElement)&&!m(t.storeActiveElement.focus)&&t.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(Q([this.element],W7),this.isModal&&this.setOverlayZindex()),this.visible){if(this.show(),this.isModal){var a=this.getTargetContainer(this.target);if(a instanceof Element){var o=window.getComputedStyle(a);o.getPropertyValue("direction")==="rtl"&&this.setPopupPosition()}}}else this.isModal&&(this.dlgOverlay.style.display="none");this.initialRender=!1},e.prototype.getTargetContainer=function(t){var i=null;if(typeof t=="string")if(t.startsWith("#"))i=document.getElementById(t.substring(1));else if(t.startsWith(".")){var r=document.getElementsByClassName(t.substring(1));i=r.length>0?r[0]:null}else!(t instanceof HTMLElement)&&t!==document.body&&(i=document.querySelector(t));else t instanceof HTMLElement&&(i=t);return i},e.prototype.resetResizeIcon=function(){var t=this.getMinHeight();if(this.targetEle.offsetHeight<t){var i=this.enableRtl?"e-south-west":"e-south-east",r=this.element.querySelector("."+i);m(r)||(r.style.bottom="-"+t.toString()+"px")}},e.prototype.setOverlayZindex=function(t){var i;m(t)?i=parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:i=t,this.dlgOverlay.style.zIndex=(i-1).toString(),this.dlgContainer.style.zIndex=i.toString()},e.prototype.positionChange=function(){this.isModal?!isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},e.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},e.prototype.setAllowDragging=function(){var t=this,i="."+fS;this.element.classList.contains($7)||(this.dragObj=new vI(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:i,dragStart:function(r){t.trigger("dragStart",r,function(n){})},dragStop:function(r){if(t.isModal){m(t.position)||t.dlgContainer.classList.remove("e-dlg-"+t.position.X+"-"+t.position.Y);var n=t.getTargetContainer(t.target);if(n instanceof Element){var a=window.getComputedStyle(n);a.getPropertyValue("direction")==="rtl"?t.element.style.position="absolute":t.element.style.position="relative"}else t.element.style.position="relative"}t.trigger("dragStop",r),t.element.classList.remove(am),t.updatePersistData()},drag:function(r){t.trigger("drag",r)}}),m(this.targetEle)||(this.dragObj.dragArea=this.targetEle))},e.prototype.setButton=function(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(var t=0;t<this.buttons.length;t++){var i=m(this.buttons[t].type)?"button":this.buttons[t].type.toLowerCase(),r=this.createElement("button",{className:this.cssClass,attrs:{type:i}});this.buttonContent.push(r.outerHTML)}this.setFooterTemplate()}for(var n,t=0,a=this.element.children;t<a.length;t++)a[t].classList.contains(tp)&&(n=a[t].querySelectorAll("button"));for(var t=0;t<this.buttons.length;t++)this.isBlazorServerRender()||(this.btnObj[t]=new Ql(this.buttons[t].buttonModel)),this.isBlazorServerRender()&&(this.ftrTemplateContent=this.element.querySelector("."+tp)),!m(this.ftrTemplateContent)&&n.length>0&&(typeof this.buttons[t].click=="function"&&I.add(n[t],"click",this.buttons[t].click,this),typeof this.buttons[t].click=="object"&&I.add(n[t],"click",this.buttonClickHandler.bind(this,t),this)),!this.isBlazorServerRender()&&!m(this.ftrTemplateContent)&&(this.btnObj[t].appendTo(this.ftrTemplateContent.children[t]),this.buttons[t].isFlat&&this.btnObj[t].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0])},e.prototype.buttonClickHandler=function(t){this.trigger("buttons["+t+"].click",{})},e.prototype.setContent=function(){this.contentEle=this.createElement("div",{className:j7,id:this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(!m(this.content)&&this.content!==""||!this.initialRender)&&(typeof this.content=="string"&&!Qs()?this.setTemplate(this.content,this.contentEle,"content"):this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content")),m(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),this.height==="auto"&&(!this.isBlazorServerRender()&&B.isIE&&this.element.style.width===""&&!m(this.width)&&(this.element.style.width=qe(this.width)),this.setMaxHeight())},e.prototype.setTemplate=function(t,i,r){var n,a;i.classList.contains(aN)?a=this.element.id+"header":i.classList.contains(tp)?a=this.element.id+"footerTemplate":a=this.element.id+"content",m(t.outerHTML)?(typeof t=="string"||typeof t!="string"||Qs())&&(typeof t=="string"&&(t=this.sanitizeHelper(t)),this.isVue||typeof t!="string"?n=pi(t):i.innerHTML=t):i.appendChild(t);var o=[];if(!m(n)){for(var l=!0,h=0,u=n({},this,r,a,l);h<u.length;h++){var c=u[h];o.push(c)}Ut([].slice.call(o),i)}},e.prototype.sanitizeHelper=function(t){if(this.enableHtmlSanitizer){var i=Fi.beforeSanitize(),r={cancel:!1,helper:null};me(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!m(i.helper)?t=i.helper(t):i.cancel||(t=Fi.serializeValue(i,t))}return t},e.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var t=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!m(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=t,B.isIE&&this.height==="auto"&&!m(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},e.prototype.setEnableRTL=function(){this.isBlazorServerRender()||(this.enableRtl?Q([this.element],pS):te([this.element],pS)),m(this.element.querySelector(".e-resize-handle"))||(sN(),this.setResize())},e.prototype.setTargetContent=function(){var t=this;if(m(this.content)||this.content===""){var i=this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"")!=="";(this.element.children.length>0||i)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(function(r){r.nodeType!==8&&t.innerContentElement.appendChild(r)}))}},e.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:aN}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),De(this.element,{"aria-labelledby":this.element.id+"_title"}),this.element.insertBefore(this.headerContent,this.element.children[0]),this.allowDragging&&!m(this.headerContent)&&this.setAllowDragging()},e.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:tp}),this.footerTemplate!==""&&!m(this.footerTemplate)?this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"):this.ftrTemplateContent.innerHTML=this.buttonContent.join(""),this.element.appendChild(this.ftrTemplateContent)},e.prototype.createHeaderContent=function(){m(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:fS}))},e.prototype.renderCloseIcon=function(){this.showCloseIcon&&(this.closeIcon=this.createElement("button",{className:hN,attrs:{type:"button"}}),this.closeIconBtnObj=new Ql({cssClass:"e-flat",iconCss:oN+" "+U7}),this.closeIconTitle(),m(this.headerContent)?(this.createHeaderContent(),xs([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):xs([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon))},e.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var t=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",t),this.closeIcon.setAttribute("aria-label",t)},e.prototype.setCSSClass=function(t){t&&(te([this.element],t.split(" ")),this.isModal&&!m(this.dlgContainer)&&te([this.dlgContainer],t.split(" "))),this.cssClass&&(Q([this.element],this.cssClass.split(" ")),this.isModal&&!m(this.dlgContainer)&&Q([this.dlgContainer],this.cssClass.split(" ")))},e.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:H7}),this.setCSSClass(),this.element.classList.remove(uN),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),Q([this.element],nm),this.dlgOverlay=this.createElement("div",{className:B7}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},e.prototype.getValidFocusNode=function(t){for(var i,r=0;r<t.length;r++){if(i=t[r],(i.clientHeight>0||i.tagName.toLowerCase()==="a"&&i.hasAttribute("href"))&&i.tabIndex>-1&&!i.disabled&&!this.disableElement(i,'[disabled],[aria-disabled="true"],[type="hidden"]'))return i;i=null}return i},e.prototype.focusableElements=function(t){if(!m(t)){var i='input,select,textarea,button,a,[contenteditable="true"],[tabindex]',r=t.querySelectorAll(i);return this.getValidFocusNode(r)}return null},e.prototype.getAutoFocusNode=function(t){var i=t.querySelector("."+hN),r="[autofocus]",n=t.querySelectorAll(r),a=this.getValidFocusNode(n);if(!m(a))i=a;else if(a=this.focusableElements(this.contentEle),m(a)){if(!m(this.primaryButtonEle))return this.element.querySelector("."+V7)}else return i=a;return i},e.prototype.disableElement=function(t,i){var r=t?t.matches||t.webkitMatchesSelector||t.msGetRegionContent:null;if(r){for(;t;t=t.parentNode)if(t instanceof Element&&r.call(t,i))return t}return null},e.prototype.focusContent=function(){var t=this.getAutoFocusNode(this.element),i=m(t)?this.element:t,r=B.userAgent;(r.indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&this.element.focus(),i.focus(),this.unBindEvent(this.element),this.bindEvent(this.element)},e.prototype.bindEvent=function(t){I.add(t,"keydown",this.keyDown,this)},e.prototype.unBindEvent=function(t){I.remove(t,"keydown",this.keyDown)},e.prototype.updateSanitizeContent=function(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))},e.prototype.isBlazorServerRender=function(){return Qs()},e.prototype.getModuleName=function(){return"dialog"},e.prototype.onPropertyChanged=function(t,i){if(this.element.classList.contains(rm))for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"content":!m(this.content)&&this.content!==""?(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),!m(this.contentEle)&&this.contentEle.getAttribute("role")!=="dialog"?(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),typeof this.content=="function"?(this.clearTemplate(["content"]),ne(this.contentEle),this.contentEle=null,this.setContent()):typeof this.content=="string"?this.isBlazorServerRender()&&this.contentEle.innerText===""?this.contentEle.insertAdjacentHTML("beforeend",this.sanitizeHelper(this.content)):this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()):(!this.isBlazorServerRender()||m(this.element.querySelector(".e-dlg-content")))&&this.setContent()):m(this.contentEle)||(ne(this.contentEle),this.contentEle=null);break;case"header":this.header===""||m(this.header)?this.headerEle&&(ne(this.headerEle),this.headerEle=null):(!this.isBlazorServerRender()||m(this.element.querySelector(".e-dlg-header-content")))&&this.setHeader();break;case"footerTemplate":if(this.footerTemplate===""||m(this.footerTemplate)){if(!this.ftrTemplateContent)return;ne(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else(!this.isBlazorServerRender()||m(this.element.querySelector(".e-footer-content")))&&this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(oN).length>0?!this.showCloseIcon&&(this.header===""||m(this.header))?(ne(this.headerContent),this.headerContent=null):this.showCloseIcon?this.isBlazorServerRender()&&this.wireEvents():ne(this.closeIcon):(this.isBlazorServerRender()||this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":tt(this.element,{height:qe(t.height)}),this.updatePersistData();break;case"width":tt(this.element,{width:qe(t.width)}),this.updatePersistData();break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(i.cssClass);break;case"buttons":{var o=this.buttons.length;!m(this.ftrTemplateContent)&&!this.isBlazorServerRender()&&(ne(this.ftrTemplateContent),this.ftrTemplateContent=null);for(var l=0;l<o;l++)m(this.buttons[l].buttonModel)||(this.footerTemplate="",this.setButton());break}case"allowDragging":this.allowDragging&&!m(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(t.target);break;case"position":if(this.checkPositionData(),this.isModal){var h=!m(i.position)&&!m(i.position.X)?i.position.X:this.position.X,u=!m(i.position)&&!m(i.position.Y)?i.position.Y:this.position.Y;this.dlgContainer.classList.contains("e-dlg-"+h+"-"+u)&&this.dlgContainer.classList.remove("e-dlg-"+h+"-"+u)}this.positionChange(),this.updatePersistData();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize();break;case"minHeight":this.minHeight!==""&&(this.element.style.minHeight=qe(this.minHeight));break}}},e.prototype.setTarget=function(t){this.popupObj.relateTo=t,this.target=t,this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize()},e.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)m(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",m(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for(te([this.element],nm),te([document.body],[Ba,ha]),ne(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&I.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.setzIndex=function(t,i){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0;var n=bu(t);this.zIndex=n>this.zIndex?n:this.zIndex,this.isProtectedOnChange=r,i&&(this.popupObj.zIndex=this.zIndex)},e.prototype.windowResizeHandler=function(){R7(this.targetEle.clientWidth),F7(this.targetEle.clientHeight),this.setMaxHeight()},e.prototype.getPersistData=function(){return this.addOnPersist(["width","height","position"])},e.prototype.destroy=function(){if(!this.isDestroyed){var t=[pS,nm,vS,am,sm,lN],i=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];if(te([this.targetEle],[Ba,ha]),!m(this.element)&&this.element.classList.contains(sm)&&te([document.body],[Ba,ha]),this.isModal&&te([m(this.targetEle)?document.body:this.targetEle],ha),this.unWireEvents(),!m(this.btnObj))for(var r=0;r<this.btnObj.length;r++)this.btnObj[r].destroy();if(m(this.closeIconBtnObj)||this.closeIconBtnObj.destroy(),m(this.dragObj)||this.dragObj.destroy(),!m(this.popupObj.element)&&this.popupObj.element.classList.contains(_7)&&this.popupObj.destroy(),te([this.element],t),!m(this.cssClass)&&this.cssClass!==""&&te([this.element],this.cssClass.split(" ")),!m(this.refElement)&&!m(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),ne(this.refElement),this.refElement=void 0),this.isModal&&!this.isBlazorServerRender()&&(ne(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),ne(this.dlgContainer)),this.isBlazorServerRender()||(this.element.innerHTML=this.clonedEle.innerHTML),this.isBlazorServerRender()&&!m(this.element.children))for(var r=0;r<=this.element.children.length;r++)r=r-r,ne(this.element.children[r]);for(var r=0;r<i.length;r++)this.element.removeAttribute(i[r]);this.ftrTemplateContent=null,this.headerContent=null,this.contentEle=null,this.isBlazorServerRender()?this.isDestroyed=!0:s.prototype.destroy.call(this),this.isReact&&this.clearTemplate()}},e.prototype.wireWindowResizeEvent=function(){window.addEventListener("resize",this.windowResizeHandler.bind(this))},e.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))},e.prototype.wireEvents=function(){this.isBlazorServerRender()&&this.showCloseIcon&&(this.closeIcon=this.element.getElementsByClassName("e-dlg-closeicon-btn")[0]),this.showCloseIcon&&I.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&I.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.unWireEvents=function(){if(this.showCloseIcon&&I.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&I.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),this.buttons.length>0&&!m(this.buttons[0].buttonModel)&&this.footerTemplate==="")for(var t=0;t<this.buttons.length;t++)typeof this.buttons[t].click=="function"&&I.remove(this.ftrTemplateContent.children[t],"click",this.buttons[t].click)},e.prototype.refreshPosition=function(){this.popupObj.refreshPosition(),this.element.classList.contains(nm)&&this.positionChange()},e.prototype.getDimension=function(){var t=this.element.offsetWidth,i=this.element.offsetHeight;return{width:t,height:i}},e.prototype.show=function(t){var i=this;if(this.element.classList.contains(rm)){if(!this.element.classList.contains(uN)||!m(t)){m(t)||this.fullScreen(t);var r={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(i.element.style.maxHeight!==r.maxHeight&&(i.allowMaxHeight=!1,i.element.style.maxHeight=r.maxHeight),i.storeActiveElement=document.activeElement,i.element.tabIndex=-1,i.isModal&&!m(i.dlgOverlay))if(i.dlgOverlay.style.display="block",i.dlgContainer.style.display="flex",te([i.dlgOverlay],"e-fade"),m(i.targetEle))Q([document.body],[Ba,ha]);else{i.targetEle===document.body?i.dlgContainer.style.position="fixed":i.dlgContainer.style.position="absolute",i.dlgOverlay.style.position="absolute";var a=i.getTargetContainer(i.target);if(a instanceof Element){var o=window.getComputedStyle(a);o.getPropertyValue("direction")==="rtl"?i.element.style.position="absolute":i.element.style.position="relative"}else i.element.style.position="relative";Q([i.targetEle],[Ba,ha])}var l={name:i.animationSettings.effect==="None"&&vi==="Enable"?"ZoomIn":i.animationSettings.effect+"In",duration:i.animationSettings.duration,delay:i.animationSettings.delay},h=i.isModal?i.element.parentElement:i.element;i.calculatezIndex&&(i.setzIndex(h,!0),tt(i.element,{zIndex:i.zIndex}),i.isModal&&i.setOverlayZindex(i.zIndex)),i.animationSettings.effect==="None"&&vi==="Enable"?i.popupObj.show(l):i.animationSettings.effect==="None"?i.popupObj.show():i.popupObj.show(l),i.dialogOpen=!0;var u=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!0,i.preventVisibility=!0,i.isProtectedOnChange=u}})}this.isReact&&this.renderReactTemplates()}},e.prototype.hide=function(t){var i=this;if(this.element.classList.contains(rm)&&this.preventVisibility){var r={cancel:!1,isInteracted:!!t,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:t,closedBy:this.dlgClosedBy};this.closeArgs=r,this.trigger("beforeClose",r,function(n){if(!n.cancel){i.isModal&&(m(i.targetEle)||te([i.targetEle],[Ba,ha])),document.body.classList.contains(Ba)&&document.body.classList.contains(ha)&&te([document.body],[Ba,ha]);var a={name:i.animationSettings.effect==="None"&&vi==="Enable"?"ZoomOut":i.animationSettings.effect+"Out",duration:i.animationSettings.duration,delay:i.animationSettings.delay};i.animationSettings.effect==="None"&&vi==="Enable"?i.popupObj.hide(a):i.animationSettings.effect==="None"?i.popupObj.hide():i.popupObj.hide(a),i.dialogOpen=!1;var o=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!1,i.preventVisibility=!1,i.isProtectedOnChange=o}i.dlgClosedBy=mS})}},e.prototype.fullScreen=function(t){if(this.element.offsetTop,this.element.offsetLeft,t){this.element.style.top=document.scrollingElement.scrollTop+"px",Q([this.element],sm);var i=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=m(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=i,Q([document.body],[Ba,ha]),this.allowDragging&&!m(this.dragObj)&&this.dragObj.destroy()}else te([this.element],sm),te([document.body],[Ba,ha]),this.allowDragging&&!m(this.headerContent)&&this.setAllowDragging();return t},e.prototype.getButtons=function(t){return m(t)?this.btnObj:this.btnObj[t]},Rt([S("")],e.prototype,"content",void 0),Rt([S(!0)],e.prototype,"enableHtmlSanitizer",void 0),Rt([S(!1)],e.prototype,"enablePersistence",void 0),Rt([S(!1)],e.prototype,"showCloseIcon",void 0),Rt([S(!1)],e.prototype,"isModal",void 0),Rt([S("")],e.prototype,"header",void 0),Rt([S(!0)],e.prototype,"visible",void 0),Rt([S(!1)],e.prototype,"enableResize",void 0),Rt([S(["South-East"])],e.prototype,"resizeHandles",void 0),Rt([S("auto")],e.prototype,"height",void 0),Rt([S("")],e.prototype,"minHeight",void 0),Rt([S("100%")],e.prototype,"width",void 0),Rt([S("")],e.prototype,"cssClass",void 0),Rt([S(1e3)],e.prototype,"zIndex",void 0),Rt([S(null)],e.prototype,"target",void 0),Rt([S("")],e.prototype,"footerTemplate",void 0),Rt([S(!1)],e.prototype,"allowDragging",void 0),Rt([ii([{}],P7)],e.prototype,"buttons",void 0),Rt([S(!0)],e.prototype,"closeOnEscape",void 0),Rt([Ee({},z7)],e.prototype,"animationSettings",void 0),Rt([Ee({X:"center",Y:"center"},Tz)],e.prototype,"position",void 0),Rt([_()],e.prototype,"created",void 0),Rt([_()],e.prototype,"open",void 0),Rt([_()],e.prototype,"beforeSanitizeHtml",void 0),Rt([_()],e.prototype,"beforeOpen",void 0),Rt([_()],e.prototype,"close",void 0),Rt([_()],e.prototype,"beforeClose",void 0),Rt([_()],e.prototype,"dragStart",void 0),Rt([_()],e.prototype,"dragStop",void 0),Rt([_()],e.prototype,"drag",void 0),Rt([_()],e.prototype,"overlayClick",void 0),Rt([_()],e.prototype,"resizeStart",void 0),Rt([_()],e.prototype,"resizing",void 0),Rt([_()],e.prototype,"resizeStop",void 0),Rt([_()],e.prototype,"destroyed",void 0),e=Rt([Ot],e),e}(Pi),fN;(function(s){function e(u){var c=St("div",{className:Oz});document.body.appendChild(c);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return typeof u=="string"?d=i({content:u,position:{X:"center",Y:"top"},isModal:!0,header:cN,buttons:p},c):d=i(r(u),c),d.close=function(){u&&u.close&&u.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(dN)):d.element.remove()},d}s.alert=e;function t(u){var c=St("div",{className:Rz});document.body.appendChild(c);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}];return typeof u=="string"?d=i({position:{X:"center",Y:"top"},content:u,isModal:!0,header:cN,buttons:p},c):d=i(n(u),c),d.close=function(){u&&u.close&&u.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(dN)):d.element.remove()},d}s.confirm=t;function i(u,c){var d=new Tv(u);return d.appendTo(c),d}function r(u){var c={};return c.buttons=[],c=a(c,u),c=o(c,u),c}function n(u){var c={};return c.buttons=[],c=a(c,u),c=l(c,u),c}function a(u,c){return u.header=m(c.title)?null:c.title,u.content=m(c.content)?"":c.content,u.isModal=m(c.isModal)?!0:c.isModal,u.showCloseIcon=m(c.showCloseIcon)?!1:c.showCloseIcon,u.allowDragging=m(c.isDraggable)?!1:c.isDraggable,u.closeOnEscape=m(c.closeOnEscape)?!1:c.closeOnEscape,u.position=m(c.position)?{X:"center",Y:"top"}:c.position,u.animationSettings=m(c.animationSettings)?{effect:"Fade",duration:400,delay:0}:c.animationSettings,u.cssClass=m(c.cssClass)?"":c.cssClass,u.zIndex=m(c.zIndex)?1e3:c.zIndex,u.open=m(c.open)?null:c.open,u.width=m(c.width)?"auto":c.width,u.height=m(c.height)?"auto":c.height,u}function o(u,c){var d=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return m(c.okButton)?u.buttons=d:u.buttons[0]=h(u.buttons[0],c.okButton,d[0]),u}function l(u,c){var d={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},p={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return m(c.okButton)?u.buttons[0]=d:u.buttons[0]=h(u.buttons[0],c.okButton,d),m(c.cancelButton)?u.buttons[1]=p:u.buttons[1]=h(u.buttons[1],c.cancelButton,p),u}function h(u,c,d){var p=d;return m(c.text)||(p.buttonModel.content=c.text),m(c.icon)||(p.buttonModel.iconCss=c.icon),m(c.cssClass)||(p.buttonModel.cssClass=c.cssClass),m(c.click)||(p.click=c.click),m(c.isFlat)||(p.isFlat=c.isFlat),p}})(fN||(fN={}));var Fz=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},X7=1500,K7=500,vN=0,mN=8,Z7=2,Ha=2,gS="e-tooltip",gN="e-rtl",J7="e-bigger",yN="e-icons",bN="e-tooltip-close",yS="e-tooltip-wrap",CN="e-tip-content",Hu="e-arrow-tip",SN="e-arrow-tip-outer",om="e-arrow-tip-inner",ip="e-tip-bottom",bS="e-tip-top",xN="e-tip-left",CS="e-tip-right",SS="e-popup",lm="e-popup-open",xS="e-popup-close",hm="e-lib",e9="e-hidden",wN="e-tooltip-popup-container",t9=function(s){Fz(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return yi([S({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),yi([S({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e}(ke),D0=function(s){Fz(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return e.prototype.initialize=function(){this.formatPosition(),Q([this.element],gS)},e.prototype.formatPosition=function(){var t,i;this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(t=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=t[0],this.tooltipPositionX=t[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1])},e.prototype.renderArrow=function(){this.setTipClass(this.position);var t=this.createElement("div",{className:Hu+" "+this.tipClass});t.appendChild(this.createElement("div",{className:SN+" "+this.tipClass})),t.appendChild(this.createElement("div",{className:om+" "+this.tipClass})),this.tooltipEle.appendChild(t)},e.prototype.setTipClass=function(t){t.indexOf("Right")===0?this.tipClass=xN:t.indexOf("Bottom")===0?this.tipClass=bS:t.indexOf("Left")===0?this.tipClass=CS:this.tipClass=ip},e.prototype.renderPopup=function(t){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(t);this.tooltipEle.classList.remove(hm),this.popupObj=new za(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},e.prototype.getScalingFactor=function(t){if(!t)return{x:1,y:1};var i={x:1,y:1},r=t.closest('[style*="transform: scale"]');if(r&&r!=this.tooltipEle&&r.contains(this.tooltipEle)){var n=window.getComputedStyle(r),a=n.getPropertyValue("transform"),o=a.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=o[0],i.y=o[3]}return i},e.prototype.getTooltipPosition=function(t){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=Fr(t,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),n=this.getScalingFactor(t),a=this.calculateTooltipOffset(this.position,n.x,n.y),o=this.calculateElementPosition(r,a),l=o[0],h=o[1],u=this.collisionFlipFit(t,l,h);return u.left=u.left/n.x,u.top=u.top/n.y,this.tooltipEle.style.display="",u},e.prototype.windowResize=function(){this.reposition(this.findTarget())},e.prototype.reposition=function(t){if(this.popupObj&&t){var i=this.getTooltipPosition(t);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},e.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},e.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear(),this.trigger("afterClose",this.tooltipEventArgs),this.tooltipEventArgs=null},e.prototype.calculateTooltipOffset=function(t,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var n={top:0,left:0},a,o,l,h,u,c,d,p;if(i!=1||r!=1){var f=this.tooltipEle.getBoundingClientRect(),v=void 0;l=Math.round(f.width),h=Math.round(f.height),u=$("."+Hu,this.tooltipEle),u&&(v=u.getBoundingClientRect()),a=u?Math.round(v.width):0,o=u?Math.round(v.height):0,c=this.showTipPointer?vN:mN,d=o/2+Ha+(h-this.tooltipEle.clientHeight*r),p=a/2+Ha+(l-this.tooltipEle.clientWidth*i)}else l=this.tooltipEle.offsetWidth,h=this.tooltipEle.offsetHeight,u=$("."+Hu,this.tooltipEle),a=u?u.offsetWidth:0,o=u?u.offsetHeight:0,c=this.showTipPointer?vN:mN,d=o/2+Ha+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),p=a/2+Ha+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(c+=Z7),t){case"RightTop":n.left+=a+c,n.top-=h-d;break;case"RightCenter":n.left+=a+c,n.top-=h/2;break;case"RightBottom":n.left+=a+c,n.top-=d;break;case"BottomRight":n.top+=o+c,n.left-=p;break;case"BottomCenter":n.top+=o+c,n.left-=l/2;break;case"BottomLeft":n.top+=o+c,n.left-=l-p;break;case"LeftBottom":n.left-=a+l+c,n.top-=d;break;case"LeftCenter":n.left-=a+l+c,n.top-=h/2;break;case"LeftTop":n.left-=a+l+c,n.top-=h-d;break;case"TopLeft":n.top-=h+o+c,n.left-=l-p;break;case"TopRight":n.top-=h+o+c,n.left-=p;break;default:n.top-=h+o+c,n.left-=l/2;break}return n.left+=this.offsetX,n.top+=this.offsetY,n},e.prototype.updateTipPosition=function(t){var i=ze("."+Hu+",."+SN+",."+om,this.tooltipEle),r=[ip,bS,xN,CS];te(i,r),this.setTipClass(t),Q(i,this.tipClass)},e.prototype.adjustArrow=function(t,i,r,n){var a=$("."+Hu,this.tooltipEle);if(!(this.showTipPointer===!1||a===null)){this.updateTipPosition(i);var o,l;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,u=this.tooltipEle.clientHeight,c=$("."+om,this.tooltipEle),d=a.offsetWidth,p=a.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===ip||this.tipClass===bS){if(this.tipClass===ip?(l="99.9%",c.style.top="-"+(p-2)+"px"):(l=-(p-1)+"px",c.style.top="-"+(p-6)+"px"),t){var f=r!=="Center"||h>t.offsetWidth||this.mouseTrail;f&&r==="Left"||!f&&this.tipPointerPosition==="End"?o=h-d-Ha+"px":f&&r==="Right"||!f&&this.tipPointerPosition==="Start"?o=Ha+"px":f&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?o=this.tipPointerPosition==="End"?t.offsetWidth+(this.tooltipEle.offsetWidth-t.offsetWidth)/2-d/2-Ha+"px":(this.tooltipEle.offsetWidth-t.offsetWidth)/2-d/2+Ha+"px":o=h/2-d/2+"px"}}else{this.tipClass===CS?(o="99.9%",c.style.left="-"+(d-2)+"px"):(o=-(d-1)+"px",c.style.left=-d+(d-2)+"px");var f=n!=="Center"||u>t.offsetHeight||this.mouseTrail;f&&n==="Top"||!f&&this.tipPointerPosition==="End"?l=u-p-Ha+"px":f&&n==="Bottom"||!f&&this.tipPointerPosition==="Start"?l=Ha+"px":l=u/2-p/2+"px"}a.style.top=l,a.style.left=o}},e.prototype.renderContent=function(t){var i=$("."+CN,this.tooltipEle);if(this.cssClass&&Q([this.tooltipEle],this.cssClass.split(" ")),t&&!m(t.getAttribute("title"))&&(t.setAttribute("data-content",t.getAttribute("title")),t.removeAttribute("title")),m(this.content))t&&!m(t.getAttribute("data-content"))&&(i.innerHTML=t.getAttribute("data-content"));else if(i.innerHTML="",this.content instanceof HTMLElement)i.appendChild(this.content);else if(typeof this.content=="string")if(this.enableHtmlSanitizer&&this.setProperties({content:Fi.sanitize(this.content)},!0),this.enableHtmlParse){var r=pi(this.content),n=r({},this,"content",this.element.id+"content",void 0,void 0,i,this.root);n&&Ut(n,i)}else i.textContent=this.content;else{var a=pi(this.content),n=a({},this,"content",this.element.id+"content",void 0,void 0,i);n&&Ut(n,i),this.renderReactTemplates()}},e.prototype.renderCloseIcon=function(){if(!this.isSticky){var t=this.tooltipEle.querySelector("."+yN+"."+bN);t&&pt(t);return}var i=this.createElement("div",{className:yN+" "+bN});this.tooltipEle.appendChild(i),I.add(i,B.touchStartEvent,this.onStickyClose,this)},e.prototype.addDescribedBy=function(t,i){var r=(t.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),De(t,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},e.prototype.removeDescribedBy=function(t){var i=t.getAttribute("data-tooltip-id"),r=(t.getAttribute("aria-describedby")||"").split(/\s+/),n=r.indexOf(i);n!==-1&&r.splice(n,1),t.removeAttribute("data-tooltip-id");var a=r.join(" ").trim();a?t.setAttribute("aria-describedby",a):t.removeAttribute("aria-describedby")},e.prototype.tapHoldHandler=function(t){clearTimeout(this.autoCloseTimer),this.targetHover(t.originalEvent)},e.prototype.touchEndHandler=function(t){var i=this;if(!this.isSticky){var r=function(){i.close()};this.autoCloseTimer=setTimeout(r,X7)}},e.prototype.targetClick=function(t){var i;this.target?i=U(t.target,this.target):i=this.element,!m(i)&&(i.getAttribute("data-tooltip-id")===null?this.targetHover(t):this.isSticky||this.hideTooltip(this.animation.close,t,i))},e.prototype.targetHover=function(t){var i;if(this.target?i=U(t.target,this.target):i=this.element,!(m(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){for(var r=[].slice.call(ze('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),n=0,a=r;n<a.length;n++){var o=a[n];this.restoreElement(o)}this.showTooltip(i,this.animation.open,t)}},e.prototype.mouseMoveBeforeOpen=function(t){this.mouseMoveEvent=t},e.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&I.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},e.prototype.showTooltip=function(t,i,r){var n=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=t,I.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:t,event:r||null,element:this.tooltipEle,isInteracted:!m(r)};var a=function(o){n.beforeRenderCallback(o,t,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,a.bind(this))},e.prototype.beforeRenderCallback=function(t,i,r,n){t.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,m(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?mi(this.element.getAttribute("id")):mi("tooltip"),this.tooltipEle=this.createElement("div",{className:yS+" "+SS+" "+hm,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+qe(this.width)+";height:"+qe(this.height)+";position:absolute;"}),this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,n,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),ri.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,n,this)))},e.prototype.appendContainer=function(t){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=$(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||Q([this.containerElement],wN),this.containerElement.appendChild(t.tooltipEle)},e.prototype.tooltipBeforeRender=function(t,i){t&&(B.isDevice&&Q([i.tooltipEle],J7),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=qe(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:CN})),this.appendContainer(i),te([i.tooltipEle],e9),i.addDescribedBy(t,i.ctrlId+"_content"),i.renderContent(t),Q([i.tooltipEle],lm),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(t),i.adjustArrow(t,i.position,i.tooltipPositionX,i.tooltipPositionY),ri.stop(i.tooltipEle),i.reposition(t))},e.prototype.tooltipAfterRender=function(t,i,r,n){if(t){te([n.tooltipEle],lm),Q([n.tooltipEle],xS),n.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:t,event:i||null,element:n.tooltipEle,isInteracted:!m(i)},n.needTemplateReposition()&&!n.mouseTrail&&(n.tooltipEle.style.display="none");var a=function(o){n.beforeOpenCallback(o,t,r,i)};n.trigger("beforeOpen",n.tooltipEventArgs,a.bind(n))}},e.prototype.beforeOpenCallback=function(t,i,r,n){var a=this;if(t.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var o={name:r.effect==="None"&&vi==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(o=void 0),this.openDelay>0){var l=function(){a.mouseTrail&&I.add(i,"mousemove touchstart mouseenter",a.onMouseMove,a),a.popupObj&&(a.popupObj.show(o,i),a.mouseMoveEvent&&a.mouseTrail&&a.onMouseMove(a.mouseMoveEvent))};this.showTimer=setTimeout(l,this.openDelay)}else this.popupObj&&this.popupObj.show(o,i)}n&&this.wireMouseEvents(n,i)},e.prototype.needTemplateReposition=function(){var t=this;return!m(t.viewContainerRef)&&typeof t.viewContainerRef!="string"||this.isReact},e.prototype.checkCollision=function(t,i,r){var n={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},a=Qa(this.tooltipEle,this.checkCollideTarget(),i,r);return a.length>0&&(n.horizontal=a.indexOf("left")>=0?"Right":a.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=a.indexOf("top")>=0?"Bottom":a.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},e.prototype.calculateElementPosition=function(t,i){return[this.isBodyContainer?t.left+i.left:t.left-this.containerElement.offsetLeft+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?t.top+i.top:t.top-this.containerElement.offsetTop+i.top+window.pageYOffset+this.containerElement.scrollTop]},e.prototype.collisionFlipFit=function(t,i,r){var n=this.checkCollision(t,i,r),a=n.position;if(this.tooltipPositionY!==n.vertical&&(a=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(a.indexOf("Left")===0&&(n.vertical=a==="LeftTop"||a==="LeftCenter"?"Top":"Bottom",a=n.vertical+"Left"),a.indexOf("Right")===0&&(n.vertical=a==="RightTop"||a==="RightCenter"?"Top":"Bottom",a=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:t,event:null,element:this.tooltipEle,collidedPosition:a},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)a=this.position;else{var o=n.vertical,l=n.horizontal;if(n.position!==a){var h=Fr(t,l,o,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(t,a,l,o);var u=this.getScalingFactor(t),c=this.calculateTooltipOffset(a,u.x,u.y);c.top-=this.getOffSetPosition("TopBottom",a,this.offsetY),c.left-=this.getOffSetPosition("RightLeft",a,this.offsetX),n.position=a;var d=this.calculateElementPosition(h,c);n.left=d[0],n.top=d[1]}else this.adjustArrow(t,a,l,o)}var p={left:n.left,top:n.top},f=this.isBodyContainer?AI(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},p):p;this.tooltipEle.style.display="block";var v=$("."+Hu,this.tooltipEle);if(this.showTipPointer&&v!=null&&(a.indexOf("Bottom")===0||a.indexOf("Top")===0)){var g=parseInt(v.style.left,10)-(f.left-n.left);g<0?g=0:g+v.offsetWidth>this.tooltipEle.clientWidth&&(g=this.tooltipEle.clientWidth-v.offsetWidth),v.style.left=g.toString()+"px"}return this.tooltipEle.style.display="",p.left=f.left,p.top=f.top,p},e.prototype.getOffSetPosition=function(t,i,r){return t.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&t.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},e.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},e.prototype.hideTooltip=function(t,i,r){var n=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var a=function(){n.closeDelay&&n.tooltipEle&&n.isTooltipOpen||n.tooltipHide(t,i,r)};this.hideTimer=setTimeout(a,this.closeDelay)}else this.tooltipHide(t,i,r)},e.prototype.tooltipHide=function(t,i,r){var n=this,a;i?a=this.target?r||i.target:this.element:a=$('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:a,event:i||null,element:this.tooltipEle,isInteracted:!m(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(o){o.cancel?n.isHidden=!1:(n.mouseMoveBeforeRemove(),n.popupHide(t,a))}),this.tooltipEventArgs=null},e.prototype.popupHide=function(t,i){i&&this.restoreElement(i),this.isHidden=!0;var r={name:t.effect==="None"&&vi==="Enable"?"FadeOut":this.animation.close.effect,duration:t.duration,delay:t.delay,timingFunction:"easeIn"};t.effect==="None"&&(r=void 0),this.popupObj&&this.popupObj.hide(r)},e.prototype.restoreElement=function(t){this.unwireMouseEvents(t),m(t.getAttribute("data-content"))||(t.setAttribute("title",t.getAttribute("data-content")),t.removeAttribute("data-content")),this.removeDescribedBy(t)},e.prototype.clear=function(){this.tooltipEle&&(te([this.tooltipEle],xS),Q([this.tooltipEle],lm)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&pt(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},e.prototype.tooltipHover=function(t){this.tooltipEle&&(this.isTooltipOpen=!0)},e.prototype.tooltipMouseOut=function(t){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,t,this.findTarget())},e.prototype.onMouseOut=function(t){var i=t.relatedTarget;if(i&&!this.mouseTrail){var r=U(i,"."+yS+"."+hm+"."+SS);r?I.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,t,this.findTarget()),this.closeDelay===0&&this.clear())}else this.hideTooltip(this.animation.close,t,this.findTarget()),this.clear()},e.prototype.tooltipElementMouseOut=function(t){this.hideTooltip(this.animation.close,t,this.findTarget()),I.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},e.prototype.onStickyClose=function(t){this.close()},e.prototype.onMouseMove=function(t){var i=0,r=0;t.type.indexOf("touch")>-1?(t.preventDefault(),i=t.touches[0].pageX,r=t.touches[0].pageY):(i=t.pageX,r=t.pageY),ri.stop(this.tooltipEle),te([this.tooltipEle],xS),Q([this.tooltipEle],lm),this.adjustArrow(t.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.getScalingFactor(t.target),a=this.calculateTooltipOffset(this.position,n.x,n.y),o=i+a.left+this.offsetX,l=r+a.top+this.offsetY,h=this.checkCollision(t.target,o,l);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var u=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=u,this.adjustArrow(t.target,h.position,h.horizontal,h.vertical);var c=this.calculateTooltipOffset(h.position,n.x,n.y);h.left=i+c.left-this.offsetX,h.top=r+c.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"},e.prototype.keyDown=function(t){this.tooltipEle&&t.keyCode===27&&this.close()},e.prototype.touchEnd=function(t){this.tooltipEle&&U(t.target,"."+gS)===null&&!this.isSticky&&this.close()},e.prototype.scrollHandler=function(t){this.tooltipEle&&!this.isSticky&&(U(t.target,"."+yS+"."+hm+"."+SS)||this.close())},e.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},e.prototype.preRender=function(){this.tipClass=ip,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},e.prototype.wireEvents=function(t){for(var i=this.getTriggerList(t),r=0,n=i;r<n.length;r++){var a=n[r];if(a==="Custom")return;a==="Focus"&&this.wireFocusEvents(),a==="Click"&&I.add(this.element,B.touchStartEvent,this.targetClick,this),a==="Hover"&&(B.isDevice?(this.touchModule=new Pn(this.element,{tapHoldThreshold:K7,tapHold:this.tapHoldHandler.bind(this)}),I.add(this.element,B.touchEndEvent,this.touchEndHandler,this)):I.add(this.element,"mouseover",this.targetHover,this))}I.add(document,"touchend",this.touchEnd,this),I.add(document,"scroll wheel",this.scrollHandler,this),I.add(window,"resize",this.windowResize,this),I.add(document,"keydown",this.keyDown,this)},e.prototype.getTriggerList=function(t){return t==="Auto"&&(t=B.isDevice?"Hover":"Hover Focus"),t.split(" ")},e.prototype.wireFocusEvents=function(){if(m(this.target))I.add(this.element,"focusin",this.targetHover,this);else{var t=[].slice.call(ze(this.target,this.element));this.targetsList=t;for(var i=0,r=t;i<r.length;i++){var n=r[i];I.add(n,"focus",this.targetHover,this)}}},e.prototype.wireMouseEvents=function(t,i){this.tooltipEle&&(this.isSticky||(t.type==="focus"&&I.add(i,"blur",this.onMouseOut,this),t.type==="focusin"&&I.add(i,"focusout",this.onMouseOut,this),t.type==="mouseover"&&I.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(I.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),I.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&I.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},e.prototype.unwireEvents=function(t){for(var i=this.getTriggerList(t),r=0,n=i;r<n.length;r++){var a=n[r];if(a==="Custom")return;a==="Focus"&&this.unwireFocusEvents(),a==="Click"&&I.remove(this.element,B.touchStartEvent,this.targetClick),a==="Hover"&&(B.isDevice?(this.touchModule&&this.touchModule.destroy(),I.remove(this.element,B.touchEndEvent,this.touchEndHandler)):I.remove(this.element,"mouseover",this.targetHover))}I.remove(document,"touchend",this.touchEnd),I.remove(document,"scroll wheel",this.scrollHandler),I.remove(window,"resize",this.windowResize),I.remove(document,"keydown",this.keyDown)},e.prototype.unwireFocusEvents=function(){if(m(this.target))I.remove(this.element,"focusin",this.targetHover);else for(var t=[].slice.call(ze(this.target,this.element)),i=0,r=t;i<r.length;i++){var n=r[i];I.remove(n,"focus",this.targetHover)}},e.prototype.unwireMouseEvents=function(t){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,n=i;r<n.length;r++){var a=n[r];a==="Focus"&&(I.remove(t,"blur",this.onMouseOut),I.remove(t,"focusout",this.onMouseOut)),a==="Hover"&&!B.isDevice&&I.remove(t,"mouseleave",this.onMouseOut)}this.closeDelay&&(I.remove(t,"mouseenter",this.tooltipHover),I.remove(t,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&I.remove(t,"mousemove touchstart mouseenter",this.onMouseMove)},e.prototype.findTarget=function(){var t=$('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return t},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,i){for(var r=this.findTarget(),n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=qe(t.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=qe(t.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(t.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var l=$("."+om,this.tooltipEle);l&&(l.style.top=l.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var h=t.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+h).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var u=t.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+u).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&te([this.tooltipEle],i.cssClass.split(" ")),t.cssClass&&Q([this.tooltipEle],t.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?Q([this.tooltipEle],gN):te([this.tooltipEle],gN));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":m(this.containerElement)||te([this.containerElement],wN),this.container=t.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},e.prototype.open=function(t,i){m(i)&&(i=this.animation.open),m(t)&&(t=this.element),t.style.display!=="none"&&this.showTooltip(t,i)},e.prototype.close=function(t){t||(t=this.animation.close),this.hideTooltip(t)},e.prototype.refresh=function(t){if(this.tooltipEle&&this.renderContent(t),this.popupObj&&t&&this.reposition(t),!m(this.targetsList)&&!m(this.target)){var i=ze(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.tooltipEle&&pt(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),te([this.element],gS),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var t=ze('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=t;i<r.length;i++){var n=r[i];this.restoreElement(n)}},yi([S("auto")],e.prototype,"width",void 0),yi([S("auto")],e.prototype,"height",void 0),yi([S()],e.prototype,"content",void 0),yi([S("body")],e.prototype,"container",void 0),yi([S()],e.prototype,"target",void 0),yi([S("TopCenter")],e.prototype,"position",void 0),yi([S(0)],e.prototype,"offsetX",void 0),yi([S(0)],e.prototype,"offsetY",void 0),yi([S(!0)],e.prototype,"showTipPointer",void 0),yi([S(!0)],e.prototype,"enableHtmlParse",void 0),yi([S(!1)],e.prototype,"windowCollision",void 0),yi([S("Auto")],e.prototype,"tipPointerPosition",void 0),yi([S("Auto")],e.prototype,"opensOn",void 0),yi([S(!1)],e.prototype,"mouseTrail",void 0),yi([S(!1)],e.prototype,"isSticky",void 0),yi([Ee({},t9)],e.prototype,"animation",void 0),yi([S(0)],e.prototype,"openDelay",void 0),yi([S(0)],e.prototype,"closeDelay",void 0),yi([S()],e.prototype,"cssClass",void 0),yi([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),yi([S("")],e.prototype,"htmlAttributes",void 0),yi([_()],e.prototype,"beforeRender",void 0),yi([_()],e.prototype,"beforeOpen",void 0),yi([_()],e.prototype,"afterOpen",void 0),yi([_()],e.prototype,"beforeClose",void 0),yi([_()],e.prototype,"afterClose",void 0),yi([_()],e.prototype,"beforeCollision",void 0),yi([_()],e.prototype,"created",void 0),yi([_()],e.prototype,"destroyed",void 0),e=yi([Ot],e),e}(Pi),rn={},i9=30,r9=30,MN=30,n9=30,s9=30,a9=36,o9=36,wS="e-spin-show",Dg="e-spin-hide",EN="e-spin-material",IN="e-spin-material3",TN="e-spin-fabric",DN="e-spin-fluent",AN="e-spin-tailwind",l9="e-spin-bootstrap",NN="e-spin-bootstrap4",kN="e-spin-bootstrap5",LN="e-spin-high-contrast",kM="e-spinner-pane",HI="e-spinner-inner",Sb="e-path-circle",h9="e-path-arc",u9="e-spin-label",LM="e-spin-template",ON=null,c9=null;function Nd(s,e){var t;if(s.target){var i,r=m(e)?St:e,n=L9(s.target,r);if(!m(s.cssClass)){var a=s.cssClass.split(" ").filter(function(u){return u.trim()!==""});(t=n.wrap.classList).add.apply(t,a)}if(!m(s.template)||!m(ON)){var o=m(s.template)?ON:s.template;n.wrap.classList.add(LM),A9(n.wrap,o,c9)}else{var l=m(s.type)?x9(n.wrap):s.type,h=m(s.width)?void 0:s.width;i=N9(h,l),w9(l,n.wrap,i,r),m(s.label)||d9(n.inner_wrap,s.label,r)}n.wrap.classList.add(Dg),n=null}}function d9(s,e,t){var i=t("div",{});return i.classList.add(u9),i.innerHTML=e,s.appendChild(i),i}function p9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Material",radius:e},wb(s,i,t,EN),Mb(e,s,"Material",EN)}function f9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Material3",radius:e},wb(s,i,t,IN),Mb(e,s,"Material3",IN)}function v9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Bootstrap4",radius:e},wb(s,i,t,NN),Mb(e,s,"Bootstrap4",NN)}function m9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Bootstrap5",radius:e},wb(s,i,t,kN),Mb(e,s,"Bootstrap5",kN)}function g9(s,e,t){var i={},r=0;rn[""+e].timeOut=0,i[""+e]=k9(e,t,0,0);var n={uniqueID:e,container:s,globalInfo:i,timeOutVar:r};Pz(n)}function y9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Fabric",radius:e},xb(s,i,TN),Eb(e,s,TN)}function b9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Fluent",radius:e},xb(s,i,DN),Eb(e,s,DN)}function C9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Tailwind",radius:e},xb(s,i,AN),Eb(e,s,AN)}function S9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"HighContrast",radius:e},xb(s,i,LN),Eb(e,s,LN)}function x9(s){var e=window.getComputedStyle(s,":after").getPropertyValue("content");return e.replace(/['"]+/g,"")}function w9(s,e,t,i){var r=e.querySelector("."+HI),n=r.querySelector("svg");switch(m(n)||r.removeChild(n),s){case"Material":p9(r,t,i);break;case"Material3":f9(r,t,i);break;case"Fabric":y9(r,t);break;case"Fluent":b9(r,t);break;case"Bootstrap":M9(r,t);break;case"HighContrast":S9(r,t);break;case"Bootstrap4":v9(r,t,i);break;case"Bootstrap5":m9(r,t,i);break;case"Tailwind":case"Tailwind-dark":C9(r,t);break}}function M9(s,e,t){var i=Ko();rn[""+i]={timeOut:0,type:"Bootstrap",radius:e},E9(s,i),I9(s,e)}function E9(s,e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,n=32,a=2;i.setAttribute("id",e),i.setAttribute("class",l9),i.setAttribute("viewBox","0 0 "+r+" "+r),s.insertBefore(i,s.firstChild);for(var o=0;o<=7;o++){var l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("class",Sb+"_"+o),l.setAttribute("r",a+""),l.setAttribute("transform","translate("+n+","+n+")"),i.appendChild(l)}}function I9(s,e){var t=s.querySelector("svg.e-spin-bootstrap"),i=0,r=0,n=24;t.style.width=t.style.height=e+"px";for(var a=90,o=0;o<=7;o++){var l=OM(i,r,n,a),h=t.querySelector("."+Sb+"_"+o);h.setAttribute("cx",l.x+""),h.setAttribute("cy",l.y+""),a=a>=360?0:a,a=a+45}}function T9(s,e){var t=[],i=s,r=e,n=!1,a=1;o(i);function o(l){t.push(l),(l!==r||a===1)&&(l<=i&&l>1&&!n?l=parseFloat((l-.2).toFixed(2)):l===1?(l=7,l=parseFloat((l+.2).toFixed(2)),n=!0):l<8&&n?(l=parseFloat((l+.2).toFixed(2)),l===8&&(n=!1)):l<=8&&!n&&(l=parseFloat((l-.2).toFixed(2))),++a,o(l))}return t}function D9(s){for(var e=s.querySelector("svg.e-spin-bootstrap"),t=e.getAttribute("id"),i=1;i<=8;i++){var r=s.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];n(r,i,i,T9(i,i),t)}function n(a,o,l,h,u){var c=0;d(o);function d(p){rn[""+u].isAnimate&&(++c,a.setAttribute("r",p+""),c>=h.length&&(c=0),rn[u].timeOut=setTimeout(d.bind(null,h[c]),18))}}}function A9(s,e,t){m(t)||s.classList.add(t);var i=s.querySelector(".e-spinner-inner");i.innerHTML=e}function N9(s,e){var t;switch(e){case"Material":t=i9;break;case"Material3":t=r9;break;case"Fabric":t=MN;break;case"Tailwind":case"Tailwind-dark":t=MN;break;case"Fluent":t=n9;break;case"Bootstrap4":t=a9;break;case"Bootstrap5":t=o9;break;default:t=s9}return s=s?parseFloat(s+""):t,e==="Bootstrap"?s:s/2}function k9(s,e,t,i){return{radius:e,count:t,previousId:i}}function Ko(){for(var s="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<5;t++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}function xb(s,e,t,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",e),r.setAttribute("class",t);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",Sb);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("class",h9),s.insertBefore(r,s.firstChild),r.appendChild(n),r.appendChild(a)}function wb(s,e,t,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",e),n.setAttribute("class",Sb),s.insertBefore(r,s.firstChild),r.appendChild(n)}function L9(s,e){var t=e("div",{}),i=e("div",{});return t.classList.add(kM),i.classList.add(HI),i.setAttribute("aria-disabled","true"),s.appendChild(t),t.appendChild(i),{wrap:t,inner_wrap:i}}function Pz(s){var e=1,t=149,i=1333,r=75;O9(e,t,P9,i,s.globalInfo[s.uniqueID].count,r,s),s.globalInfo[s.uniqueID].count=++s.globalInfo[s.uniqueID].count%4}function O9(s,e,t,i,r,n,a){var o=++a.globalInfo[a.uniqueID].previousId,l=new Date().getTime(),h=e-s,u=R9(a.globalInfo[a.uniqueID].radius*2+""),c=zz(u),d=-90*(a.globalInfo[a.uniqueID].count||0);p(a);function p(v){var g=Math.max(0,Math.min(new Date().getTime()-l,i));f(t(g,s,h,i),v.container),o===v.globalInfo[v.uniqueID].previousId&&g<i?rn[v.uniqueID].timeOut=setTimeout(p.bind(null,v),1):Pz(v)}function f(v,g){if(!m(g.querySelector("svg.e-spin-material"))||!m(g.querySelector("svg.e-spin-material3"))){var b=void 0;if(!m(g.querySelector("svg.e-spin-material"))&&!m(g.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))?b=g.querySelector("svg.e-spin-material"):!m(g.querySelector("svg.e-spin-material3"))&&!m(g.querySelector("svg.e-spin-material3").querySelector("path.e-path-circle"))&&(b=g.querySelector("svg.e-spin-material3")),!m(b)){var y=b.querySelector("path.e-path-circle");y.setAttribute("stroke-dashoffset",jz(u,c,v,n)+""),y.setAttribute("transform","rotate("+d+" "+u/2+" "+u/2+")")}}}}function Mb(s,e,t,i){var r=s*2,n=e.querySelector("svg."+i),a=n.querySelector("path.e-path-circle"),o=zz(r),l=r/2+"px";n.setAttribute("viewBox","0 0 "+r+" "+r),n.style.width=n.style.height=r+"px",n.style.transformOrigin=l+" "+l+" "+l,a.setAttribute("d",F9(r,o)),(t==="Material"||t==="Material3")&&(a.setAttribute("stroke-width",o+""),a.setAttribute("stroke-dasharray",(r-o)*Math.PI*.75+""),a.setAttribute("stroke-dashoffset",jz(r,o,1,75)+""))}function R9(s){var e=parseFloat(s);return e}function F9(s,e){var t=s/2,i=e/2;return"M"+t+","+i+"A"+(t-i)+","+(t-i)+" 0 1 1 "+i+","+t}function zz(s){return 10/100*s}function jz(s,e,t,i){return(s-e)*Math.PI*(3*i/100-t/100)}function P9(s,e,t,i){var r=(s/=i)*s,n=r*s;return e+t*(6*n*r+-15*r*r+10*n)}function Eb(s,e,t){var i=s,r=s,n=s*2,a=315,o=45,l=e.querySelector("."+t),h=l.querySelector(".e-path-circle"),u=l.querySelector(".e-path-arc"),c=n/2+"px";h.setAttribute("d",j9(i,r,s)),u.setAttribute("d",z9(i,r,s,a,o)),l.setAttribute("viewBox","0 0 "+n+" "+n),l.style.transformOrigin=c+" "+c+" "+c,l.style.width=l.style.height=n+"px"}function OM(s,e,t,i){var r=(i-90)*Math.PI/180;return{x:s+t*Math.cos(r),y:e+t*Math.sin(r)}}function z9(s,e,t,i,r){var n=OM(s,e,t,r),a=OM(s,e,t,i),o=["M",n.x,n.y,"A",t,t,0,0,0,a.x,a.y].join(" ");return o}function j9(s,e,t){var i=["M",s,e,"m",-t,0,"a",t,t,0,1,0,t*2,0,"a",t,t,0,1,0,-t*2,0].join(" ");return i}function Ol(s){Bz(s,!1),s=null}function Bz(s,e){var t;if(s)if(s.classList.contains(kM))t=s;else{var i=s.querySelectorAll("."+kM);if(B.isIE){for(var r=0;r<i.length;r++)if(i[r].parentElement&&i[r].parentElement===s){t=i[r];break}}else t=Array.from(i).find(function(h){return h.parentElement===s})||null}if(s&&t){var n=t.querySelector("."+HI),a=void 0;if(a=e?!t.classList.contains(LM)&&!t.classList.contains(Dg):!t.classList.contains(LM)&&!t.classList.contains(wS),a){var o=t.querySelector("svg");if(m(o))return;var l=o.getAttribute("id");switch(rn[""+l].isAnimate=!e,rn[""+l].type){case"Material":case"Material3":e?clearTimeout(rn[l].timeOut):g9(n,l,rn[l].radius);break;case"Bootstrap":e?clearTimeout(rn[l].timeOut):D9(n);break}}e?br(t,[Dg],[wS]):br(t,[wS],[Dg]),s=null}}function kd(s){Bz(s,!0),s=null}var B9=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(tn,this.wireEvents,this),this.parent.on(Y1,this.autoFit,this),this.parent.on(X1,this.setAutoFitHandler,this)},s.prototype.autoFit=function(e){for(var t=e.isRow?this.parent.getRowHeaderTable():this.parent.getColHeaderTable().rows[0],i=e.startIndex;i<=e.endIndex;i++)this.trgtEle=e.isRow?this.parent.getRow(i,t):this.parent.getCell(null,i,t),this.setAutofit(i,!e.isRow)},s.prototype.wireEvents=function(){var e=this.parent.getRowHeaderContent(),t=this.parent.element.getElementsByClassName("e-header-panel")[0];t&&(I.add(t,"dblclick",this.dblClickHandler,this),I.add(e,"dblclick",this.dblClickHandler,this),I.add(t,"mousedown",this.mouseDownHandler,this),I.add(e,"mousedown",this.mouseDownHandler,this),this.wireResizeCursorEvent(e,t))},s.prototype.wireResizeCursorEvent=function(e,t){I.add(e,"mousemove",this.setTarget,this),I.add(t,"mousemove",this.setTarget,this)},s.prototype.unWireResizeCursorEvent=function(){I.remove(this.parent.getRowHeaderContent(),"mousemove",this.setTarget);var e=this.parent.element.getElementsByClassName("e-header-panel")[0];e&&I.remove(e,"mousemove",this.setTarget)},s.prototype.unwireEvents=function(){I.remove(this.parent.getColumnHeaderContent(),"dblclick",this.dblClickHandler),I.remove(this.parent.getRowHeaderContent(),"dblclick",this.dblClickHandler),I.remove(this.parent.getColumnHeaderContent(),"mousedown",this.mouseDownHandler),I.remove(this.parent.getRowHeaderContent(),"mousedown",this.mouseDownHandler),this.unWireResizeCursorEvent()},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tn,this.wireEvents),this.parent.off(Y1,this.autoFit),this.parent.off(X1,this.setAutoFitHandler))},s.prototype.mouseMoveHandler=function(e){var t=this.parent.element.getElementsByClassName("e-colresize-handler")[0],i=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(this.resizeTooltip(null,!0,e),t||i){this.isMouseMoved=!0;var r=this.parent.enableRtl;t?(r?e.x<this.trgtEle.parentElement.firstChild.getBoundingClientRect().right:e.x>this.trgtEle.parentElement.firstChild.getBoundingClientRect().left)&&(t.style.left=e.clientX-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().left+"px"):i&&e.y>=this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top&&(i.style.top=e.clientY-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().top+"px")}},s.prototype.mouseDownHandler=function(e){if(U(e.target,".e-header-cell")){if(this.event=e,this.trgtEle=e.target,this.trgtEle.parentElement.classList.contains("e-hide-end")||this.trgtEle.classList.contains("e-hide-end")){var t=this.trgtEle.offsetHeight,i=e.offsetY;(t>=10&&i<5||t-2<8&&i<Math.ceil((i-2)/2))&&this.trgtEle.classList.add("e-skip-resize")}this.updateTarget(e,this.trgtEle);var r=this.trgtEle,n=r.classList.contains("e-colresize")?"e-colresize-handler":r.classList.contains("e-rowresize")?"e-rowresize-handler":"";this.createResizeHandler(r,n),this.unWireResizeCursorEvent(),I.add(this.parent.element,"mousemove",this.mouseMoveHandler,this),I.add(document,"mouseup",this.mouseUpHandler,this)}},s.prototype.mouseUpHandler=function(e){var t=this.parent.element.getElementsByClassName("e-resize-handle")[0];this.resizeOn(e),this.isMouseMoved=null;var i=document.querySelector(".e-header-tooltip");t&&(ne(t),this.updateCursor()),i&&i.remove(),I.remove(document,"mouseup",this.mouseUpHandler),I.remove(this.parent.element,"mousemove",this.mouseMoveHandler);var r=this.parent.element.getElementsByClassName("e-header-panel")[0];r&&this.wireResizeCursorEvent(this.parent.getRowHeaderContent(),r),this.parent.notify(Pa,null),this.parent.notify(v0,null)},s.prototype.dblClickHandler=function(e){if(U(e.target,".e-header-cell")){if(this.trgtEle=e.target,this.updateTarget(e,this.trgtEle),this.trgtEle.classList.contains("e-colresize")){var t=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1,i=tr(this.parent.getActiveSheet(),t)+"px";this.trgtEle.classList.contains("e-unhide-column")?this.showHiddenColumns(t-1):this.setAutofit(t,!0,i)}else if(this.trgtEle.classList.contains("e-rowresize")){var r=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,n=Wt(this.parent.getActiveSheet(),r)+"px";this.setAutofit(r,!1,n)}this.parent.notify(Pa,null)}},s.prototype.setTarget=function(e){if(U(e.target,".e-header-cell")){var t=e.target,i=this.parent.getActiveSheet();if(!(i.isProtected&&(!i.protectSettings.formatColumns||!i.protectSettings.formatRows)&&(!i.protectSettings.formatRows&&!i.protectSettings.formatColumns||i.protectSettings.formatRows&&U(t,".e-colhdr-table")||i.protectSettings.formatColumns&&U(t,".e-rowhdr-table")))){var r,n,a,o;if(U(t,".e-header-row")){n=t.offsetWidth,o="e-colresize",a=this.parent.enableRtl?n-e.offsetX:e.offsetX;var l=this.getColPrevSibling(t);l&&!l.classList.contains("e-select-all-cell")?r=l:Number(t.getAttribute("aria-colindex"))>1&&(r=t)}else if(U(t,".e-row")){a=e.offsetY,n=t.offsetHeight,o="e-rowresize";var l=this.getRowPrevSibling(t);l?r=l.firstElementChild:Number(t.parentElement.getAttribute("aria-rowindex"))>1&&(r=t)}if(n-2<8&&a!==Math.ceil((n-2)/2))a<Math.ceil((n-2)/2)?(t.classList.add(o),r.classList.add(o)):a>Math.ceil((n-2)/2)&&t.classList.add(o);else if(n-5<a&&a<=n&&n>=10)t.classList.add(o);else if(a<5&&r&&n>=10)t.classList.add(o),r.classList.add(o);else for(var h=this.parent.element.getElementsByClassName(o),u=0;u<h.length;u++)h[u].classList.remove(o)}}},s.prototype.getColPrevSibling=function(e){var t=this.parent.frozenColCount(this.parent.getActiveSheet());return e.previousElementSibling||(t&&U(e,".e-column-header")?this.parent.getSelectAllContent().querySelector(".e-header-row").lastElementChild:null)},s.prototype.getRowPrevSibling=function(e){var t=this.parent.frozenRowCount(this.parent.getActiveSheet());return e.parentElement.previousElementSibling||(t&&U(e,".e-row-header")?this.parent.getSelectAllContent().querySelector("tbody").lastElementChild:null)},s.prototype.updateTarget=function(e,t){if(U(t,".e-header-row")){var i=this.parent.enableRtl?t.offsetWidth-e.offsetX:e.offsetX;if(t.offsetWidth<10&&i<Math.ceil((t.offsetWidth-2)/2)||i<5&&t.offsetWidth>=10&&t.classList.contains("e-colresize")){var r=this.parent.getActiveSheet(),n=Number(this.trgtEle.getAttribute("aria-colindex"))-2,a=this.getColPrevSibling(t);a&&!Yt(r,n)?this.trgtEle=a:n>-1&&this.trgtEle.classList.add("e-unhide-column")}}else if(t.offsetHeight<10&&e.offsetY<Math.ceil((t.offsetHeight-2)/2)||e.offsetY<5&&t.offsetHeight>=10&&t.classList.contains("e-rowresize")){var r=this.parent.getActiveSheet(),n=Number(t.parentElement.getAttribute("aria-rowindex"))-2,a=this.getRowPrevSibling(t);if(a||ct(r,n))if(e.type==="dblclick"&&ct(r,n)){var o=lt(ee(r.selectedRange)),l=void 0;n<=o[2]&&n>o[0]&&JP(r,o)?l={startIndex:o[0],endIndex:o[2],hide:!1,autoFit:!0}:l={startIndex:n,endIndex:n,hide:!1,autoFit:!0},this.parent.notify(nn,l)}else ct(r,n)||(this.trgtEle=a.getElementsByClassName("e-header-cell")[0])}},s.prototype.setAutoFitHandler=function(e){e.isCol&&Yt(this.parent.getActiveSheet(),e.idx)?this.showHiddenColumns(e.idx):this.setAutofit(e.idx,e.isCol)},s.prototype.getWrapText=function(e,t,i){var r=this,n=e.toString().split(" "),a=_r(" ",i,this.parent.cellStyle),o,l=0,h=0,u=e,c="",d=function(){var p=parseInt(h.toString(),10);(p>l||p===l&&_r(c.trim(),i,r.parent.cellStyle)>_r(u,i,r.parent.cellStyle))&&(u=c.trim(),l=p)};return n.forEach(function(p,f){o=_r(p,i,r.parent.cellStyle),(h+o)/t>1?(d(),c="",h=o):(o+=(h+o+a)/t>=1?0:a,h+=o),c+=p+" ",f===n.length-1&&d()}),u},s.prototype.setAutofit=function(e,t,i){var r=this.parent.getActiveSheet(),n,a,o,l,h,u=this.parent.createElement("table",{className:this.parent.getContentTable().className+" e-resizetable",styles:"height: auto"}),c=this.parent.createElement("tbody"),d=this.parent.createElement("tr",{className:"e-row"}),p=this.parent.createElement("td",{className:"e-cell"});if(t){var f=void 0;u.style.width="auto";for(var v=0,g=r.rows.length;v<g;v++)a=Y(v,e,r),a&&(o=p.cloneNode(),a.wrap?(h=!0,o.textContent=this.getWrapText(this.parent.getDisplayText(a),Ad(r,e,e,a.colSpan>1?e+a.colSpan-1:e),a.style)):o.textContent=this.parent.getDisplayText(a),o.style.fontFamily=a.style&&a.style.fontFamily||this.parent.cellStyle.fontFamily,o.style.fontSize=a.style&&a.style.fontSize||this.parent.cellStyle.fontSize,f=d.cloneNode(),f.appendChild(o),c.appendChild(f));n=tr(r,e)}else{var b=r.rows[e]&&r.rows[e].cells?r.rows[e].cells.length:0;l=this.parent.createElement("colgroup");for(var y=0;y<b;y++)a=Y(e,y,r),a&&(o=p.cloneNode(),a.wrap&&o.classList.add("e-wraptext"),o.textContent=this.parent.getDisplayText(a),o.style.fontFamily=a.style&&a.style.fontFamily||this.parent.cellStyle.fontFamily,o.style.fontSize=a.style&&a.style.fontSize||this.parent.cellStyle.fontSize,d.appendChild(o),l.appendChild(this.parent.createElement("col",{styles:"width:"+tr(r,y,!1,!0)+"px"})));u.appendChild(l),c.appendChild(d),n=Wt(r,e)}u.appendChild(c);var C=this.parent.createElement("div",{className:this.parent.element.className,styles:"display: block"});C.appendChild(u),document.body.appendChild(C);var x=u.getBoundingClientRect();document.body.removeChild(C);var w=Math.ceil(t?x.width:x.height),M=(t?this.getFloatingElementWidth(w+(h?1:0),e):w)||n,E;if(t){M>0?E=-(n-M):E=-n;var T=this.parent.frozenColCount(r);T&&e>=ee(r.topLeftCell)[1]&&e<T||e>=this.parent.viewport.leftIndex+T&&e<=this.parent.viewport.rightIndex?(oi(r,e).width=M>0?M:0,this.resizeStart(e,this.parent.getViewportIndex(e,!0),M+"px",t,!0,i),this.parent.notify(wn,{threshold:E,colIdx:e})):(this.parent.notify(wn,{threshold:E,colIdx:e}),oi(r,e).width=M>0?M:0)}else{var D=this.parent.frozenRowCount(r);M=M>20?M:20,E=-(n-M),D&&e>=ee(r.topLeftCell)[0]&&e<D||e>=this.parent.viewport.topIndex+D&&e<=this.parent.viewport.bottomIndex?(Id(r,e,M),Ts(r,e,{customHeight:!1}),this.resizeStart(e,this.parent.getViewportIndex(e),M+"px",t,!0,i),this.parent.notify(an,{threshold:E,rowIdx:e})):(this.parent.notify(an,{threshold:E,rowIdx:e}),Id(r,e,M))}this.parent.selectRange(r.selectedRange)},s.prototype.createResizeHandler=function(e,t){var i=this.parent.createElement("div",{className:t});i.classList.add("e-resize-handle");var r=document.getElementById(this.parent.element.id+"_sheet");e.classList.contains("e-colresize")?(i.style.height=this.parent.getMainContent().parentElement.clientHeight+this.parent.getColumnHeaderContent().offsetHeight+"px",i.style.left=this.event.clientX-r.getBoundingClientRect().left+"px",i.style.top="0px"):e.classList.contains("e-rowresize")&&(i.style.width=this.parent.getMainContent().parentElement.clientWidth+"px",i.style.left="0px",i.style.top=this.event.clientY-r.getBoundingClientRect().top+"px"),r.appendChild(i),this.resizeTooltip(e,!1),this.updateCursor()},s.prototype.resizeTooltip=function(e,t,i){if(t){var r=this.parent.enableRtl,n=document.querySelector(".e-header-tooltip"),a=this.parent.element.getElementsByClassName("e-colresize-handler")[0],o=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(a){var l=r?Math.round(this.trgtEle.getBoundingClientRect().right)-i.clientX:i.clientX-Math.round(this.trgtEle.getBoundingClientRect().left);n&&(n.firstChild.textContent=l>0?"Width:("+l.toString()+" pixels)":"Width: 0.00")}else if(o){var h=i.clientY-Math.round(this.trgtEle.getBoundingClientRect().top);n&&(n.firstChild.textContent=h>0?"Height:("+h.toString()+" pixels)":"Height: 0.00")}}else{var u=e.classList.contains("e-colresize"),c=e.classList.contains("e-rowresize");if(u||c){var d=u?"e-colresize-handler":"e-rowresize-handler",p=new D0({cssClass:"e-header-tooltip",showTipPointer:!1});u?p.content="Width:("+Math.round(e.getBoundingClientRect().width).toString()+" pixels)":c&&(p.content="Height:("+Math.round(e.getBoundingClientRect().height).toString()+" pixels)",p.offsetX=-(this.parent.getMainContent().parentElement.clientWidth/2-Math.round(e.getBoundingClientRect().width))),p.appendTo("."+d),p.open(),p.refresh()}}},s.prototype.setColWidth=function(e,t,i,r){var n=this.parent.getActiveSheet(),a=Mr(i)-r;if(a<0&&r<-a&&(a=-r),i>0){if(this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")){this.showHiddenColumns(e,i),this.parent.notify(yt,{eventArgs:{index:e,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!1},action:"resize"});return}this.resizeStart(e,t,i+"px",!0,!1,r+"px"),Td(n,e,{width:i,customWidth:!0}),this.parent.notify(wn,{threshold:a,colIdx:e,checkWrapCell:!0})}else this.isMouseMoved&&(this.parent.hideColumn(e),this.showHideCopyIndicator(),this.parent.notify(yt,{eventArgs:{index:e,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!0},action:"resize"}))},s.prototype.showHideCopyIndicator=function(){var e=this.parent.element.getElementsByClassName("e-copy-indicator")[0],t=!1;e&&(ne(e),this.parent.notify(ql,null),t=!0),t&&this.parent.notify(tn,{})},s.prototype.showHiddenColumns=function(e,t){var i=this,r=this.parent.getActiveSheet(),n=ee(r.selectedRange),a,o,l;if(e>=n[1]&&e<=n[3]&&n[2]===r.rowCount-1&&xe(r.activeCell)[0]===xe(r.topLeftCell)[0]?(a=n[1],o=n[3],l=this.parent.getMainContent().querySelector("colgroup")):a=o=e,t!==void 0)for(var h=a;h<=o;h++)Td(r,h,{width:t,customWidth:!0}),h>=this.parent.viewport.leftIndex&&h<=this.parent.viewport.rightIndex&&!Yt(r,h)&&(l.children[this.parent.getViewportIndex(h,!0)].style.width=t+"px");this.trgtEle&&this.trgtEle.classList.remove("e-unhide-column");var u={startIndex:a,endIndex:o,hide:!1,isCol:!0,autoFit:!0};if(this.parent.notify(nn,u),this.showHideCopyIndicator(),t===void 0)if(u.autoFit)this.autoFit({isRow:!1,startIndex:a,endIndex:o});else{var c=function(){i.parent.off(tn,c),i.autoFit({isRow:!1,startIndex:a,endIndex:o})};this.parent.on(tn,c,this)}},s.prototype.setRowHeight=function(e,t,i,r){var n=this.parent.getActiveSheet(),a=this.parent.frozenColCount(n),o=parseInt(this.parent.getRow(e,null,a).style.height,10),l=i,h=Mr(parseInt(l,10))-o;h<0&&o<-h&&(h=-o),this.resizeStart(e,t,l,!1,!1,r),Ts(n,e,{height:parseInt(l,10)>0?parseInt(l,10):0,customHeight:!0}),this.parent.notify(an,{threshold:h,rowIdx:e,isCustomHgt:!0})},s.prototype.resizeOn=function(e){var t=this,i,r,n=this.parent.getActiveSheet(),a=ee(n.activeCell),o=Y(a[0],a[1],n);if(this.trgtEle.classList.contains("e-rowresize")){var l=Number(this.trgtEle.parentElement.getAttribute("aria-rowindex"))-2;if(this.isMouseMoved&&ct(n,l)&&this.trgtEle.classList.contains("e-skip-resize")&&e.clientY>this.trgtEle.getBoundingClientRect().top){this.trgtEle.classList.remove("e-skip-resize");var h={startIndex:l,endIndex:l,hide:!1,skipAppend:!0};this.parent.notify(nn,h);var u=this.parent.getRowHeaderTable().tBodies[0],c=this.parent.getContentTable().tBodies[0];h.hdrRow.style.display="none",h.row.style.display="none",u.insertBefore(h.hdrRow,u.children[h.insertIdx]),c.insertBefore(h.row,c.children[h.insertIdx]),this.trgtEle=h.hdrRow.firstElementChild,h.hdrRow.nextElementSibling.classList.remove("e-hide-end"),h.mergeCollection.forEach(function(x){t.parent.notify(Fn,x)})}else if(this.trgtEle.classList.contains("e-skip-resize")){if(this.trgtEle.classList.remove("e-skip-resize"),!this.isMouseMoved&&ct(n,l)||!this.trgtEle.parentElement.previousElementSibling)return;this.trgtEle=this.trgtEle.parentElement.previousElementSibling.getElementsByClassName("e-header-cell")[0]}r=i=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,i=this.parent.getViewportIndex(r);var d=this.parent.frozenColCount(n),p=this.parent.getRow(r,null,d).style.height,f=e.clientY-this.event.clientY+parseInt(p,10);if(f<=0){this.parent.hideRow(r),this.showHideCopyIndicator(),Ts(n,r,{height:0,customHeight:!0}),this.parent.notify(yt,{eventArgs:{index:r,height:"0px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"});return}if(this.setRowHeight(r,i,f+"px",p),this.trgtEle.parentElement.style.display==="none"){var v=this.parent.getActiveSheet(),g=lt(ee(v.selectedRange));if(r<=g[2]&&r>g[0]){f=Wt(v,r);for(var b=void 0,y=g[0];y<=g[2];y++)y!==r&&(p=Wt(v,y)+"px",Ts(v,y,{customHeight:!0,height:f}),ct(v,y)?b||(b=y):(this.parent.getRow(y).style.height=f+"px",v.showHeaders&&(this.parent.getRow(y,this.parent.getRowHeaderTable()).style.height=f+"px")),this.parent.notify(yt,{eventArgs:{index:y,height:f+"px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"}));this.parent.hideRow(g[0],r-1,!1),this.showHideCopyIndicator(),i+=Math.abs(r-b)}else i!==0&&!ct(v,r-1)?this.trgtEle.parentElement.previousElementSibling.classList.remove("e-hide-start"):i!==0&&this.trgtEle.parentElement.classList.add("e-hide-end"),this.parent.selectRange(v.selectedRange);this.trgtEle.parentElement.style.display="",this.parent.getContentTable().rows[i].style.display=""}}else if(this.trgtEle.classList.contains("e-colresize")){this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")&&e.clientX<this.trgtEle.getBoundingClientRect().left&&(this.trgtEle.classList.remove("e-unhide-column"),this.trgtEle.previousElementSibling&&(this.trgtEle=this.trgtEle.previousElementSibling)),i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1;var C=void 0;this.trgtEle.classList.contains("e-unhide-column")?(i-=1,C=0):C=tr(this.parent.getActiveSheet(),i),this.setColWidth(i,this.parent.getViewportIndex(i,!0),(this.parent.enableRtl?this.event.clientX-e.clientX:e.clientX-this.event.clientX)+C,C)}o&&o.format&&o.format.includes("*")&&this.parent.notify(jn,{value:o.value,format:o.format,cell:o,formattedText:o.value,rowIndex:a[0],colIndex:a[1]})},s.prototype.resizeStart=function(e,t,i,r,n,a){EM(e,t,i,r,this.parent);var o=n?"resizeToFit":"resize",l,h;r?(l={index:e,width:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldWidth:a},h=a!==i):(l={index:e,height:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldHeight:a},h=a!==i),h&&this.parent.notify(yt,{eventArgs:l,action:o})},s.prototype.updateCursor=function(){this.parent.element.getElementsByClassName("e-colresize-handler")[0]?this.parent.element.classList.add("e-col-resizing"):this.parent.element.classList.contains("e-col-resizing")&&this.parent.element.classList.remove("e-col-resizing"),this.parent.element.getElementsByClassName("e-rowresize-handler")[0]?this.parent.element.classList.add("e-row-resizing"):this.parent.element.classList.contains("e-row-resizing")&&this.parent.element.classList.remove("e-row-resizing")},s.prototype.getFloatingElementWidth=function(e,t){var i=e,r={filterRange:[],hasFilter:!1};return this.parent.notify(xd,r),r.hasFilter&&r.filterRange&&r.filterRange[1]<=t&&r.filterRange[3]>=t&&(i=e+22),i},s.prototype.destroy=function(){this.unwireEvents(),this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"resize"},s}(),H9=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.hideShow=function(e){var t=this,i=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=Pe(this.parent,i);if(e.startIndex>e.endIndex){var n=e.startIndex;e.startIndex=e.endIndex,e.endIndex=n}var a;if(e.actionUpdate){if(e.sheetIndex=i,a={eventArgs:e,action:"hideShow"},this.parent.notify(li,a),e.cancel)return;delete e.cancel}var o=function(c){e.isCol?(t.hideCol(e),c&&t.parent.sheetModule.colWidthChanged({colIdx:e.startIndex,isHideShow:!0})):(t.hideRow(e),c&&t.parent.sheetModule.rowHeightChanged({rowIdx:e.startIndex,isHideShow:!0}))},l=e.isCol?this.parent.frozenColCount(r):this.parent.frozenRowCount(r);if(l&&e.startIndex<l){var h=void 0;if(e.freezePane=!0,e.endIndex>=l&&(h=e.endIndex,e.endIndex=l-1),o(!0),delete e.freezePane,h!==void 0){var u=e.startIndex;e.endIndex=h,e.startIndex=l,o(),e.startIndex=u}}else o();e.actionUpdate&&(this.updateIndexOnlyForHiddenColumnsAndRows(e,r),this.parent.notify(yt,a),Fe(this.parent.element))},s.prototype.updateIndexOnlyForHiddenColumnsAndRows=function(e,t){for(var i=e.startIndex,r=e.endIndex,n,a=e.startIndex;a<=r;a++)if(n=e.isCol?oi(t,a):sh(t,a)||{},n.hidden===!1){e.startIndex=a;break}for(var o=e.endIndex;o>=i;o--)if(n=e.isCol?oi(t,o):sh(t,o)||{},n.hidden===!1){e.endIndex=o;break}},s.prototype.hideRow=function(e){var t=this,i=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=Pe(this.parent,i),n,a=0,o,l,h,u,c=Object.assign({},e),d=this.parent.scrollSettings.isFinite&&!c.freezePane,p;if(d){if(c.startIndex>=r.rowCount)return;c.endIndex>=r.rowCount&&(c.endIndex=r.rowCount-1),p=0}var f=this.parent.frozenRowCount(r);if(c.hide){for(var v=void 0,g,b=void 0,y=d&&c.endIndex===ae(r,r.rowCount-1,!1),C=c.startIndex;C<=c.endIndex;C++)if(!ct(r,C)&&(o===void 0&&(c.freezePane?(g=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(g=this.parent.getRowHeaderTable(),v=this.parent.getContentTable()),o=this.parent.getViewportIndex(C),a=0),u={hidden:!0},c.isFiltering&&(u.isFiltered=!0),Ts(r,C,u),i===this.parent.activeSheetIndex))if(d&&(p+=Wt(r,C,!0,!0)),this.refreshChart(C,"rows"),b=v&&v.rows[o],b){if(!h){for(var x=0;x<=r.usedRange.colIndex;x++)if(n=Y(C,x,r)||{},(n.colSpan||n.rowSpan)&&(c.startIndex>=this.parent.viewport.topIndex||this.parent.scrollSettings.enableVirtualization)){h=!0;break}}if(h)continue;if(g.rows[o]&&ne(g.rows[o]),ne(b),a++,b=v.rows[o],b&&C===c.endIndex){var w=void 0;l=ae(r,C+1,!0);for(var M=l!==ae(r,0,!0)&&l===(this.parent.viewport.topIndex>=c.startIndex?c.endIndex+1:this.parent.viewport.topIndex)?"Row":"",x=this.parent.viewport.leftIndex;x<=this.parent.viewport.rightIndex;x++){var E=this.parent.getCellStyleValue(["borderTop"],[l,x]).borderTop;E!==""&&(w=b.cells[x],this.parent.notify(dr,{onActionUpdate:!1,rowIdx:l,colIdx:x,style:{borderTop:E},row:b,pRow:b.previousElementSibling,first:M,td:w}))}}}else C<=this.parent.viewport.bottomIndex?a++:a--;if(c.refreshUI)return;if(h&&(c.startIndex>=this.parent.viewport.topIndex||!this.parent.scrollSettings.enableVirtualization)){c.isFiltering?e.refreshUI=!0:(this.parent.selectRange(r.selectedRange),r.frozenRows||r.frozenColumns?(this.parent.renderModule.refreshSheet(!1,!1,!0),e.refreshUI=!0):this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:this.parent.viewport.leftIndex,refresh:"Row"}));return}if(!a)return;this.parent.selectRange(r.selectedRange);var T=function(){if(r.showHeaders){var he=c.freezePane?1:0;o===he?g.rows[he]&&g.rows[he].classList.add("e-hide-end"):(g&&g.rows[o-1]&&g.rows[o-1].classList.add("e-hide-start"),g&&g.rows[o]&&g.rows[o].classList.add("e-hide-end"))}};if(!c.freezePane&&this.parent.scrollSettings.enableVirtualization){var D=c.startIndex,N=c.startIndex;if(c.startIndex<xe(r.paneTopLeftCell)[0]||a>this.parent.viewport.rowCount){if(c.isFiltering){e.refreshUI=!0;return}this.parent.updateTopLeftCell(ae(r,c.startIndex-1<f?f:c.startIndex-1,!0)-f,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0)}else{D=this.parent.viewport.bottomIndex+1,N=D+a-1;var A=this.parent.skipHidden(D,N,"rows",!1);if(D=A[0],N=A[1],d)if(D>=r.rowCount){this.parent.viewport.topIndex+f===ae(r,f,!0)?(T(),this.parent.notify(Qh,{isHide:!0,height:p}),y&&(this.parent.viewport.bottomIndex=ae(r,r.rowCount-1,!1))):this.parent.renderModule.refreshSheet(!1,!1,!0);return}else if(N>=r.rowCount){this.parent.renderModule.refreshSheet(!1,!1,!0);return}else this.parent.notify(Qh,{isHide:!0,height:p});this.parent.viewport.bottomIndex=N;var L=void 0,k=this.parent.frozenColCount(r),O=[];k?(O.push(f),O.push(this.parent.viewport.leftIndex+k),L=xe(r.topLeftCell)[1]):L=this.parent.viewport.leftIndex,this.parent.renderModule.refreshUI({colIndex:L,rowIndex:D,direction:"",refresh:"RowPart",frozenIndexes:O},Je(D,L)+":"+Je(N,this.parent.viewport.rightIndex))}}T()}else{var R=void 0,j=void 0,P=void 0,b=void 0,F=void 0,z=void 0,v=void 0,q=void 0,X=void 0,G=c.startIndex-1,Z=[],se=c.freezePane,oe="lastElementChild",fe=0;if(d){var be=ae(r,r.rowCount-1,!1);if(this.parent.viewport.bottomIndex===be)if(this.parent.viewport.topIndex+f===ae(r,f,!0))se=!0;else{var Ne=ee(r.paneTopLeftCell)[0],we=r.rowCount-1-Ne+1-this.parent.hiddenCount(Ne,r.rowCount-1);we<this.parent.viewport.rowCount+Math.round(this.parent.getThreshold("row")/2)&&(oe="firstElementChild")}}for(var C=c.startIndex,H=c.endIndex;C<=H;C++){if(!ct(r,C)){if(c.startIndex===c.endIndex)return;o===void 0?G++:F=C;continue}if(F!==void 0){H=C;continue}if(u={hidden:!1},c.isFiltering&&(u.isFiltered=!1),!se&&C>this.parent.viewport.bottomIndex){if(Ts(r,C,u),X===void 0)return;continue}if(X===void 0&&(X=C),Ts(r,C,u),i===this.parent.activeSheetIndex){d&&(p+=Wt(r,C,!0,!0)),this.refreshChart(C,"rows"),o===void 0&&(R=document.createDocumentFragment(),j=document.createDocumentFragment(),z=this.parent.serviceLocator.getService("row"),c.freezePane?(q=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(q=this.parent.getRowHeaderTable(),v=this.parent.getContentTable(),C<this.parent.viewport.topIndex+f&&(this.parent.viewport.topIndex=C-f)),o=this.parent.getViewportIndex(C)),G++,P=z.refresh(C,null,null,!0,!0),R.appendChild(P),q&&q.rows.length&&!se&&ne(q.tBodies[0][""+oe]),b=j.appendChild(z.refresh(C,b,P)),v&&v.rows.length&&!se&&(ne(v.tBodies[0][""+oe]),oe==="firstElementChild"&&(o!==void 0&&o-1>-1&&(o-=1),fe+=Wt(r,this.parent.viewport.topIndex,!0),this.parent.viewport.topIndex=ae(r,this.parent.viewport.topIndex+1,!0)));for(var x=this.parent.viewport.leftIndex;x<=this.parent.viewport.rightIndex;x++)if(n=Y(C,x,r)||{},n.rowSpan!==void 0||n.colSpan!==void 0){var V={range:[C,x,C,x],isAction:!1,merge:!0,type:"All",skipChecking:!0};this.parent.notify(cr,V),(!Z.length||V.range[1]!==Z[Z.length-1].range[1]||V.range[0]!==Z[Z.length-1].range[0])&&Z.push(V)}}}if(o===void 0)return;if(!c.freezePane){if(c.isFiltering&&c.startIndex<xe(r.paneTopLeftCell)[0]&&(e.refreshUI=!0,F===void 0||F===c.endIndex))return;this.parent.viewport.bottomIndex=this.parent.viewport.topIndex+f+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,a=this.parent.hiddenCount(this.parent.viewport.topIndex+f,c.startIndex)+this.parent.hiddenCount(c.endIndex+1,this.parent.viewport.bottomIndex),this.parent.viewport.bottomIndex+=a,d&&this.parent.viewport.bottomIndex>=r.rowCount&&(this.parent.viewport.bottomIndex=ae(r,r.rowCount-1,!1))}if(c.insertIdx=e.insertIdx=o,c.row=e.row=j.querySelector(".e-row"),c.mergeCollection=e.mergeCollection=Z,r.showHeaders&&(e.hdrRow=c.hdrRow=R.querySelector(".e-row"),o!==0&&!ct(r,G-1)&&q.rows[o-1]&&q.rows[o-1].classList.remove("e-hide-start"),c.startIndex!==0&&ct(r,c.startIndex-1)&&c.hdrRow.classList.add("e-hide-end"),ct(r,G+1)?R.lastElementChild.classList.add("e-hide-start"):q.rows[o]&&q.rows[o].classList.remove("e-hide-end")),b&&v&&v.rows[o]){l=ae(r,G+1,!0);for(var C=this.parent.viewport.leftIndex;C<=this.parent.viewport.rightIndex;C++){var E=this.parent.getCellStyleValue(["borderTop"],[l,C]).borderTop;if(E!==""){this.parent.notify(dr,{onActionUpdate:!1,rowIdx:l,colIdx:C,style:{borderTop:E},pRow:b,td:v.rows[o].cells[C],first:""});var re=ae(r,X-1,!1);re>-1?v.rows[o-1]&&!this.parent.getCellStyleValue(["borderBottom"],[re,C]).borderBottom&&!this.parent.getCellStyleValue(["borderTop"],[X,C]).borderTop&&(v.rows[o-1].cells[C].style.borderBottom=""):v.rows[o].cells[C].style.borderTop=""}}}if(c.skipAppend)return;d&&this.parent.notify(Qh,{height:p,size:fe}),Math.abs(G-X)>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2?this.parent.renderModule.refreshSheet(!1,!1,!0):(q&&(q.tBodies[0].rows.length?q.tBodies[0].insertBefore(R,q.rows[o]):q.tBodies[0].appendChild(R)),v&&v.tBodies[0]&&(v.tBodies[0].rows.length?v.tBodies[0].insertBefore(j,v.rows[o]):v.tBodies[0].appendChild(j)),this.parent.selectRange(r.selectedRange),c.autoFit&&r.showHeaders&&this.parent.notify(Y1,{startIndex:c.startIndex,endIndex:c.endIndex,isRow:!0}),Z.forEach(function(Te){t.parent.notify(Fn,Te)}),F!==void 0&&F!==c.endIndex&&(c.startIndex=F,this.hideRow(c)))}},s.prototype.hideCol=function(e){for(var t=this,i=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=Pe(this.parent,i),n=[],a=[],o=xe(r.paneTopLeftCell),l=this.parent.frozenColCount(r),h=this.parent.frozenRowCount(r),u=this.parent.viewport.leftIndex+l,c,d=e.startIndex;d<=e.endIndex;d++)if(!(e.hide?Yt(r,d):!Yt(r,d))){if(Td(r,d,{hidden:e.hide}),this.refreshChart(d,"columns"),this.parent.scrollSettings.enableVirtualization&&!e.freezePane&&(d<u||d>this.parent.viewport.rightIndex)){d<u&&a.push(d);continue}n.push(d),e.hide&&d<=o[1]&&(c=!0)}if(!(!a.length&&!n.length)&&i===this.parent.activeSheetIndex){var p=xe(r.topLeftCell),f,v,g=function(){var N;return t.parent.scrollSettings.enableVirtualization?N=[h?p[0]:t.parent.viewport.topIndex,t.parent.viewport.bottomIndex]:N=[0,r.rowCount-1],e.freezePane?(f=t.parent.getRowHeaderTable(),v=t.parent.sheetModule.getSelectAllTable()):(f=t.parent.getContentTable(),v=t.parent.getColHeaderTable()),N};if(e.hide){if(!n.length)return;if((n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||e.freezePane)&&this.removeCell(r,n,g(),f,v),!e.freezePane&&this.parent.scrollSettings.enableVirtualization){if(c){this.parent.updateTopLeftCell(null,ae(r,n[0]-1<l?l:n[0]-1,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);return}var b=[],y=this.parent.viewport.topIndex,C=h?p[0]:y;if(h&&(b=[h+y,l]),this.parent.scrollSettings.isFinite){var x=ae(r,r.colCount-1,!1,"columns"),w=this.parent.viewport.leftIndex+l,M=this.parent.viewport.rightIndex;if(M+n.length>=x){var E=ae(r,w-(M+n.length-x),!1,"columns");E>=l&&(this.parent.viewport.leftIndex=E,this.parent.viewport.leftIndex-=this.parent.hiddenCount(M,x)),this.parent.viewport.rightIndex=x,w!==this.parent.viewport.leftIndex+l||M!==this.parent.viewport.rightIndex?(this.parent.renderModule.refreshUI({colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:b,rowIndex:C,skipUpdateOnFirst:this.parent.viewport.leftIndex+l===ae(r,l,!0,"columns")}),h&&(this.parent.viewport.topIndex=y)):this.parent.notify(dM,{refresh:"Column",isUpdate:!0}),this.parent.selectRange(r.selectedRange);return}}if(n.length<=this.parent.getThreshold("col")){var T=this.parent.skipHidden(this.parent.viewport.rightIndex+1,this.parent.viewport.rightIndex+n.length,"columns");this.parent.viewport.rightIndex=T[1],this.parent.renderModule.refreshUI({rowIndex:C,colIndex:T[0],direction:"",refresh:"ColumnPart",frozenIndexes:b},""+je([C,T[0],this.parent.viewport.bottomIndex,T[1]]))}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+l===ae(r,l,!0,"columns"),rowIndex:C,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:b}),h&&(this.parent.viewport.topIndex=y)}this.parent.selectRange(r.selectedRange)}else{if(a.length&&this.parent.scrollSettings.enableVirtualization){a.sort(function(N,A){return N-A});var D=a[0]-1<l?l:a[0]-1;this.parent.updateTopLeftCell(null,ae(r,D,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0),e.autoFit&&(e.autoFit=!1);return}if(n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||e.freezePane)this.appendCell(r,n,g(),f,v,e.freezePane),this.parent.scrollSettings.enableVirtualization&&!e.freezePane&&this.parent.notify(wa,{refresh:"Column",prevRowColCnt:{rowCount:r.rowCount,colCount:r.colCount}});else{var y=this.parent.viewport.topIndex,C=h?p[0]:y;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+l===ae(r,l,!0,"columns"),rowIndex:C,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:h?[h+y,l]:[]}),h&&(this.parent.viewport.topIndex=y),e.autoFit&&(e.autoFit=!1)}this.parent.selectRange(r.selectedRange)}}},s.prototype.removeCell=function(e,t,i,r,n){var a=this,o=i[0],l=i[1],h=0,u=t.length-1,c=this.parent.frozenRowCount(e),d=r.getElementsByTagName("colgroup")[0],p=this.parent.getViewportIndex(t[0],!0)+1,f=ae(e,c-1,!1),v,g,b,y,C;for(e.showHeaders&&(b=n.getElementsByTagName("colgroup")[0],v=n.rows[0]);o<=l;){if(ct(e,o)){o++;continue}g=c&&o<c?n.rows[h+1]:r.rows[h],t.forEach(function(x,w){if(h===0&&o>=c&&(e.showHeaders&&(ne(b.children[p]),ne(v.cells[p])),ne(d.children[p])),ne(g.cells[p]),w===0&&(y=Y(o,x,e,!1,!0),(y.colSpan!==void 0&&(y.rowSpan===void 0||y.colSpan>1)||y.rowSpan<0&&o-1>-1&&ct(e,o-1)&&Math.abs(y.rowSpan)===a.parent.hiddenCount(o+y.rowSpan,o,"rows",e))&&a.parent.notify(a0,{rowIdx:o,colIdx:x,model:"col",start:t[0],end:t[u]})),w===u){C=ae(e,x+1,!0,"columns");var M=a.parent.getCellStyleValue(["borderLeft"],[h,C]).borderLeft;M!==""&&a.parent.notify(dr,{onActionUpdate:!1,rowIdx:h,colIdx:C,style:{borderLeft:M},row:g,first:""}),y=Y(o,x,e)||{},(y.colSpan!==void 0&&(y.rowSpan===void 0||y.colSpan>1)||y.rowSpan<0&&o-1>-1&&ct(e,o-1)&&Math.abs(y.rowSpan)===a.parent.hiddenCount(o+y.rowSpan,o,"rows",e))&&a.parent.notify(a0,{rowIdx:o,colIdx:x,model:"col",start:t[0],end:t[u],isEnd:!0})}}),c&&o===f?(h=0,o=this.parent.viewport.topIndex+c):(h++,o++)}p-1>-1&&e.showHeaders&&v.cells[p-1]&&v.cells[p-1].classList.add("e-hide-start"),e.showHeaders&&v.cells[p]&&v.cells[p].classList.add("e-hide-end")},s.prototype.appendCell=function(e,t,i,r,n,a){var o=this,l=i[0],h=i[1],u=0,c=t.length-1,d,p,f,v,g=this.parent.frozenRowCount(e),b=r.getElementsByTagName("colgroup")[0];e.showHeaders&&(f=n.getElementsByTagName("colgroup")[0],d=n.rows[0]);var y=this.parent.serviceLocator.getService("cell");t.sort(function(N,A){return N-A});for(var C=[],x=[],w,M,E,T=ae(e,g-1,!1),D;l<=h;){if(ct(e,l)){l++;continue}p=g&&l<g?n.rows[u+1]:r.rows[u],t.forEach(function(N,A){if(u===0&&(x[A]=o.parent.getViewportIndex(N,!0),e.showHeaders&&(M=d.cells[x[A]],M&&(A===0&&t[A]&&!Yt(e,t[A]-1)&&M.previousSibling&&M.previousElementSibling.classList.remove("e-hide-start"),A===c&&M.classList.remove("e-hide-end"))),l>=g&&(b.children[x[A]]?(b.insertBefore(o.parent.sheetModule.updateCol(e,N),b.children[x[A]]),e.showHeaders&&y.renderColHeader(N,d,M)):(b.appendChild(o.parent.sheetModule.updateCol(e,N)),e.showHeaders&&y.renderColHeader(N,d)),a||(ne(b.lastChild),e.showHeaders&&ne(d.lastChild)),e.showHeaders&&A===c&&(ne(f),n.insertBefore(b.cloneNode(!0),n.tHead)))),a||ne(p.lastChild),M=p.cells[x[A]],D={rowIdx:l,colIdx:N,cell:Y(l,N,e),row:p,address:Je(l,N),lastCell:N===c,isHeightCheckNeeded:!0,first:N!==ae(e,0,!0,"columns")&&N===o.parent.viewport.leftIndex?"Column":"",checkNextBorder:A===c?"Column":"",checkCF:!0},M&&(D.refChild=M),w=y.render(D),A===0&&w.previousSibling){var L=o.parent.getCellStyleValue(["borderLeft"],[u,ae(e,t[t.length-1]+1,!0,"columns")]).borderLeft;L!==""&&(v=ae(e,t[0]-1,!1,"columns"),v>-1&&!o.parent.getCellStyleValue(["borderRight"],[u,v]).borderRight&&!o.parent.getCellStyleValue(["borderLeft"],[u,t[0]]).borderLeft&&(w.previousSibling.style.borderRight=""))}if(E=Y(l,N,e)||{},E.colSpan!==void 0&&(E.rowSpan===void 0||E.colSpan>1)||E.rowSpan<0&&l-1>-1&&ct(e,l-1)&&Math.abs(E.rowSpan)===o.parent.hiddenCount(l+E.rowSpan,l,"rows",e)){var k={range:[l,N,l,N],isAction:!1,merge:!0,type:"All",skipChecking:!0};o.parent.notify(cr,k),(!C.length||k.range[1]!==C[C.length-1].range[1]||k.range[0]!==C[C.length-1].range[0])&&C.push(k)}}),g&&l===T?(l=this.parent.viewport.topIndex+g,u=0):(l++,u++)}C.forEach(function(N){o.parent.notify(Fn,N)}),this.parent.viewport.rightIndex=ae(e,this.parent.viewport.rightIndex-t.length,!1,"columns")},s.prototype.refreshChart=function(e,t){this.parent.notify(lu,{rIdx:e,showHide:t})},s.prototype.addEventListener=function(){this.parent.on(nn,this.hideShow,this),this.parent.on(Dn,this.destroy,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.off(nn,this.hideShow),this.parent.off(Dn,this.destroy)},s}(),V9=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),RN=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},U9="e-hscroll",rl="e-rtl",nl="e-overlay",_9="e-hscroll-bar",W9="e-hscroll-content",rp="e-nav-arrow",np="e-nav-right-arrow",um="e-nav-left-arrow",gh="e-scroll-nav",MS="e-scroll-right-nav",FN="e-scroll-left-nav",PN="e-scroll-device",cm="e-scroll-overlay",ES="e-scroll-right-overlay",IS="e-scroll-left-overlay",zN=40,A0=function(s){V9(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){this.browser=B.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=B.isDevice,this.customStep=!0;var t=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),t.id===""&&(t.id=mi("hscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add(rl)},e.prototype.render=function(){this.touchModule=new Pn(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),I.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add(PN),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},e.prototype.setScrollState=function(){m(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},e.prototype.initialize=function(){var t=this.createElement("div",{className:W9}),i=this.createElement("div",{className:_9});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),a=0,o=n;a<o.length;a++){var l=o[a];t.appendChild(l)}i.appendChild(t),r.appendChild(i),i.style.overflowX="hidden",this.scrollEle=i,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"hScroll"},e.prototype.destroy=function(){var t=this.element;t.style.display="",t.classList.remove(U9),t.classList.remove(PN),t.classList.remove(rl);var i=ze(".e-"+t.id+"_nav."+gh,t),r=ze("."+cm,t);[].slice.call(r).forEach(function(l){ne(l)});for(var n=0,a=[].slice.call(this.scrollItems.children);n<a.length;n++){var o=a[n];t.appendChild(o)}this.uniqueId&&this.element.removeAttribute("id"),ne(this.scrollEle),i.length>0&&(ne(i[0]),m(i[1])||ne(i[1])),I.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,s.prototype.destroy.call(this)},e.prototype.disable=function(t){var i=ze(".e-scroll-nav:not(."+nl+")",this.element);t?this.element.classList.add(nl):this.element.classList.remove(nl),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createOverlay=function(t){var i=t.id.concat("_nav"),r=this.createElement("div",{className:cm+" "+ES}),n="e-"+t.id.concat("_nav "+gh+" "+MS),a=this.createElement("div",{id:i.concat("_right"),className:n}),o=this.createElement("div",{className:np+" "+rp+" e-icons"});a.appendChild(o);var l=this.createElement("div",{className:cm+" "+IS});this.ieCheck&&a.classList.add("e-ie-align"),t.appendChild(r),t.appendChild(a),t.insertBefore(l,t.firstChild),this.eventBinding([a])},e.prototype.createNavIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+gh+" "+MS),n={role:"button",id:i.concat("_right"),"aria-label":"Scroll right"},a=this.createElement("div",{className:r,attrs:n});a.setAttribute("aria-disabled","false");var o=this.createElement("div",{className:np+" "+rp+" e-icons"}),l="e-"+t.id.concat("_nav "+gh+" "+FN),h={role:"button",id:i.concat("_left"),"aria-label":"Scroll left"},u=this.createElement("div",{className:l+" "+nl,attrs:h});u.setAttribute("aria-disabled","true");var c=this.createElement("div",{className:um+" "+rp+" e-icons"});u.appendChild(c),a.appendChild(o),t.appendChild(a),t.insertBefore(u,t.firstChild),this.ieCheck&&(a.classList.add("e-ie-align"),u.classList.add("e-ie-align")),this.eventBinding([a,u])},e.prototype.onKeyPress=function(t){var i=this;if(t.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,t.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},e.prototype.onKeyUp=function(t){t.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var i=this;[].slice.call(t).forEach(function(r){new Pn(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),I.add(r,"click",i.clickEventHandler,i)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var i=this,r=t.originalEvent.target;r=this.contains(r,gh)?r.firstElementChild:r;var n=10,a=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){a()},50)},e.prototype.contains=function(t,i){return t.classList.contains(i)},e.prototype.eleScrolling=function(t,i,r){var n=this.element,a=i.classList;a.contains(gh)&&(a=i.querySelector("."+rp).classList),this.contains(n,rl)&&this.browserCheck&&(t=-t),!this.contains(n,rl)||this.browserCheck||this.ieCheck?a.contains(np)?this.frameScrollRequest(t,"add",r):this.frameScrollRequest(t,"",r):a.contains(um)?this.frameScrollRequest(t,"add",r):this.frameScrollRequest(t,"",r)},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target,!1)},e.prototype.swipeHandler=function(t){var i=this.scrollEle,r;t.velocity<=1?r=t.distanceX/(t.velocity*10):r=t.distanceX/t.velocity;var n=.5,a=function(){var o=Math.sin(n);o<=0?window.cancelAnimationFrame(o):(t.swipeDirection==="Left"?i.scrollLeft+=r*o:t.swipeDirection==="Right"&&(i.scrollLeft-=r*o),n-=.5,window.requestAnimationFrame(a))};a()},e.prototype.scrollUpdating=function(t,i){i==="add"?this.scrollEle.scrollLeft+=t:this.scrollEle.scrollLeft-=t,this.enableRtl&&this.scrollEle.scrollLeft>0&&(this.scrollEle.scrollLeft=0)},e.prototype.frameScrollRequest=function(t,i,r){var n=this,a=10;if(r){this.scrollUpdating(t,i);return}this.customStep||[].slice.call(ze("."+cm,this.element)).forEach(function(l){t-=l.offsetWidth});var o=function(){var l,h;n.contains(n.element,rl)&&n.browserCheck?(l=-t,h=-a):(l=t,h=a),l<a?window.cancelAnimationFrame(h):(n.scrollUpdating(h,i),t-=h,window.requestAnimationFrame(o))};o()},e.prototype.touchHandler=function(t){var i=this.scrollEle,r=t.distanceX;this.ieCheck&&this.contains(this.element,rl)&&(r=-r),t.scrollDirection==="Left"?i.scrollLeft=i.scrollLeft+r:t.scrollDirection==="Right"&&(i.scrollLeft=i.scrollLeft-r)},e.prototype.arrowDisabling=function(t,i){if(this.isDevice){var r=m(t)?i:t,n=r.querySelector("."+rp);m(t)?br(n,[np],[um]):br(n,[um],[np])}else t&&i&&(t.classList.add(nl),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),i.classList.remove(nl),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0"));this.repeatScroll()},e.prototype.scrollHandler=function(t){var i=t.target,r=i.offsetWidth;this.element;var n=this.element.querySelector("."+FN),a=this.element.querySelector("."+MS),o=this.element.querySelector("."+IS),l=this.element.querySelector("."+ES),h=i.scrollLeft;if(h<=0&&(h=-h),this.isDevice&&(this.enableRtl&&!(this.browserCheck||this.ieCheck)&&(o=this.element.querySelector("."+ES),l=this.element.querySelector("."+IS)),h<zN?o.style.width=h+"px":o.style.width="40px",i.scrollWidth-Math.ceil(r+h)<zN?l.style.width=i.scrollWidth-Math.ceil(r+h)+"px":l.style.width="40px"),h===0)this.arrowDisabling(n,a);else if(Math.ceil(r+h+.1)>=i.scrollWidth)this.arrowDisabling(a,n);else{var u=this.element.querySelector("."+gh+"."+nl);u&&(u.classList.remove(nl),u.setAttribute("aria-disabled","false"),u.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"scrollStep":this.setScrollState();break;case"enableRtl":t.enableRtl?this.element.classList.add(rl):this.element.classList.remove(rl);break}}},RN([S(null)],e.prototype,"scrollStep",void 0),e=RN([Ot],e),e}(Pi),q9=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jN=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Y9="e-vscroll",dm="e-rtl",sl="e-overlay",Q9="e-vscroll-bar",G9="e-vscroll-content",sp="e-nav-arrow",pm="e-nav-up-arrow",ap="e-nav-down-arrow",yh="e-scroll-nav",BN="e-scroll-up-nav",TS="e-scroll-down-nav",HN="e-scroll-device",fm="e-scroll-overlay",VN="e-scroll-up-overlay",UN="e-scroll-down-overlay",_N=40,Dc=function(s){q9(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){this.browser=B.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=B.isDevice,this.customStep=!0;var t=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),t.id===""&&(t.id=mi("vscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add(dm)},e.prototype.render=function(){this.touchModule=new Pn(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),I.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add(HN),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),I.add(this.element,"wheel",this.wheelEventHandler,this)},e.prototype.setScrollState=function(){m(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},e.prototype.initialize=function(){var t=St("div",{className:G9}),i=St("div",{className:Q9});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),a=0,o=n;a<o.length;a++){var l=o[a];t.appendChild(l)}i.appendChild(t),r.appendChild(i),i.style.overflow="hidden",this.scrollEle=i,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"vScroll"},e.prototype.destroy=function(){var t=this.element;t.style.display="",te([this.element],[Y9,HN,dm]);var i=ze(".e-"+t.id+"_nav."+yh,t),r=ze("."+fm,t);[].slice.call(r).forEach(function(l){ne(l)});for(var n=0,a=[].slice.call(this.scrollItems.children);n<a.length;n++){var o=a[n];t.appendChild(o)}this.uniqueId&&this.element.removeAttribute("id"),ne(this.scrollEle),i.length>0&&(ne(i[0]),m(i[1])||ne(i[1])),I.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,s.prototype.destroy.call(this)},e.prototype.disable=function(t){var i=ze(".e-scroll-nav:not(."+sl+")",this.element);t?this.element.classList.add(sl):this.element.classList.remove(sl),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createOverlayElement=function(t){var i=t.id.concat("_nav"),r=St("div",{className:fm+" "+UN}),n="e-"+t.id.concat("_nav "+yh+" "+TS),a=St("div",{id:i.concat("down"),className:n}),o=St("div",{className:ap+" "+sp+" e-icons"});a.appendChild(o);var l=St("div",{className:fm+" "+VN});this.ieCheck&&a.classList.add("e-ie-align"),t.appendChild(r),t.appendChild(a),t.insertBefore(l,t.firstChild),this.eventBinding([a])},e.prototype.createNavIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+yh+" "+TS),n=St("div",{id:i.concat("_down"),className:r});n.setAttribute("aria-disabled","false");var a=St("div",{className:ap+" "+sp+" e-icons"}),o="e-"+t.id.concat("_nav "+yh+" "+BN),l=St("div",{id:i.concat("_up"),className:o+" "+sl});l.setAttribute("aria-disabled","true");var h=St("div",{className:pm+" "+sp+" e-icons"});l.appendChild(h),n.appendChild(a),n.setAttribute("tabindex","0"),t.appendChild(n),t.insertBefore(l,t.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),l.classList.add("e-ie-align")),this.eventBinding([n,l])},e.prototype.onKeyPress=function(t){var i=this;if(t.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,t.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},e.prototype.onKeyUp=function(t){t.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var i=this;[].slice.call(t).forEach(function(r){new Pn(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),I.add(r,"click",i.clickEventHandler,i)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var i=this,r=t.originalEvent.target;r=this.contains(r,yh)?r.firstElementChild:r;var n=10,a=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){a()},50)},e.prototype.contains=function(t,i){return t.classList.contains(i)},e.prototype.eleScrolling=function(t,i,r){var n=i.classList;n.contains(yh)&&(n=i.querySelector("."+sp).classList),n.contains(ap)?this.frameScrollRequest(t,"add",r):n.contains(pm)&&this.frameScrollRequest(t,"",r)},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target,!1)},e.prototype.wheelEventHandler=function(t){t.preventDefault(),this.frameScrollRequest(this.scrollStep,t.deltaY>0?"add":"",!1)},e.prototype.swipeHandler=function(t){var i=this.scrollEle,r;t.velocity<=1?r=t.distanceY/(t.velocity*10):r=t.distanceY/t.velocity;var n=.5,a=function(){var o=Math.sin(n);o<=0?window.cancelAnimationFrame(o):(t.swipeDirection==="Up"?i.scrollTop+=r*o:t.swipeDirection==="Down"&&(i.scrollTop-=r*o),n-=.02,window.requestAnimationFrame(a))};a()},e.prototype.scrollUpdating=function(t,i){i==="add"?this.scrollEle.scrollTop+=t:this.scrollEle.scrollTop-=t},e.prototype.frameScrollRequest=function(t,i,r){var n=this,a=10;if(r){this.scrollUpdating(t,i);return}this.customStep||[].slice.call(ze("."+fm,this.element)).forEach(function(l){t-=l.offsetHeight});var o=function(){t<a?window.cancelAnimationFrame(a):(n.scrollUpdating(a,i),t-=a,window.requestAnimationFrame(o))};o()},e.prototype.touchHandler=function(t){var i=this.scrollEle,r=t.distanceY;t.scrollDirection==="Up"?i.scrollTop=i.scrollTop+r:t.scrollDirection==="Down"&&(i.scrollTop=i.scrollTop-r)},e.prototype.arrowDisabling=function(t,i){if(this.isDevice){var r=m(t)?i:t,n=r.querySelector("."+sp);m(t)?br(n,[ap],[pm]):br(n,[pm],[ap])}else t.classList.add(sl),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),i.classList.remove(sl),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0");this.repeatScroll()},e.prototype.scrollEventHandler=function(t){var i=t.target,r=i.offsetHeight,n=this.element.querySelector("."+BN),a=this.element.querySelector("."+TS),o=this.element.querySelector("."+VN),l=this.element.querySelector("."+UN),h=i.scrollTop;if(h<=0&&(h=-h),this.isDevice&&(h<_N?o.style.height=h+"px":o.style.height="40px",i.scrollHeight-Math.ceil(r+h)<_N?l.style.height=i.scrollHeight-Math.ceil(r+h)+"px":l.style.height="40px"),h===0)this.arrowDisabling(n,a);else if(Math.ceil(r+h+.1)>=i.scrollHeight)this.arrowDisabling(a,n);else{var u=this.element.querySelector("."+yh+"."+sl);u&&(u.classList.remove(sl),u.setAttribute("aria-disabled","false"),u.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"scrollStep":this.setScrollState();break;case"enableRtl":t.enableRtl?this.element.classList.add(dm):this.element.classList.remove(dm);break}}},jN([S(null)],e.prototype,"scrollStep",void 0),e=jN([Ot],e),e}(Pi);function yo(s,e,t,i,r,n){var a,o,l=e.parentElement;if(i==="vscroll"?(a=n||e.getBoundingClientRect().height,o=t.getBoundingClientRect().height):(a=e.getBoundingClientRect().width,o=t.getBoundingClientRect().width),a<o)return WN(s,e,t,i,r,n);if(l){var h=l.getBoundingClientRect().width;return h<a&&i==="hscroll"?(o=h,e.style.maxWidth=h+"px",WN(s,e,t,i,r,n)):t}else return t}function WN(s,e,t,i,r,n){var a=s("div",{className:"e-menu-"+i});e.appendChild(a),a.appendChild(t),n?(a.style.overflow="hidden",a.style.height=n+"px"):(a.style.maxHeight=e.style.maxHeight,e.style.overflow="hidden");var o;return i==="vscroll"?(o=new Dc({enableRtl:r},a),o.scrollStep=$(".e-"+i+"-bar",e).offsetHeight/2):(o=new A0({enableRtl:r},a),o.scrollStep=$(".e-"+i+"-bar",e).offsetWidth),a}function Vu(s,e,t){if(s){var i=$(".e-menu-parent",e);i?(!t||t===i)&&(s.destroy(),e.parentElement.appendChild(i),ne(e)):(s.destroy(),ne(e))}}var Xt={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"},Et;(function(s){s.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};var e={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},t={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:s.defaultMappedFields,ariaAttributes:e,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function i(A,L,k,O,R){var j=me({},t,k),P=me({},e,j.ariaAttributes),F=f(L).typeof;return F==="string"||F==="number"?r(A,L,O,k,R):o(A,L,k,P.level,O,R)}s.createList=i;function r(A,L,k,O,R){var j=n(A,L,k,O,R);return D(A,j,null,O)}s.createListFromArray=r;function n(A,L,k,O,R){var j=[],P=me({},t,O);Xt=M(P.moduleName);for(var F=C(),z=0;z<L.length;z++)if(!m(L[z])){var q=void 0;if(P.itemCreating&&typeof P.itemCreating=="function"){var X={dataSource:L,curData:L[z],text:L[z],options:P};P.itemCreating(X)}if(k?q=w(A,L[z],void 0,null,null,[],null,F,z,O):q=T(A,L[z],void 0,null,null,O,R),P.itemCreated&&typeof P.itemCreated=="function"){var X={dataSource:L,curData:L[z],text:L[z],item:q,options:P};P.itemCreated(X)}j.push(q)}return j}s.createListItemFromArray=n;function a(A,L,k,O,R,j){var P=me({},t,k);Xt=M(P.moduleName);var F=j&&(j.getModuleName()==="listview"||j.getModuleName()==="multiselect")?P.fields:me({},s.defaultMappedFields,P.fields),z=me({},e,P.ariaAttributes),q,X=[];O&&(z.level=O);var G=[],Z,se;L&&L.length&&!m(f(L).item)&&!f(L).item.hasOwnProperty(F.id)&&(q=C());for(var oe=0;oe<L.length;oe++){var fe=Kr(L[oe],F);if(!m(L[oe])){if(P.itemCreating&&typeof P.itemCreating=="function"){var be={dataSource:L,curData:L[oe],text:fe[F.text],options:P,fields:F};P.itemCreating(be)}var Ne=L[oe];P.itemCreating&&typeof P.itemCreating=="function"&&(fe=Kr(L[oe],F)),fe.hasOwnProperty(F.id)&&!m(fe[F.id])&&(q=fe[F.id]);var we=[];if(P.showCheckBox&&(P.itemNavigable&&(fe[F.url]||fe[F.urlAttributes])?X.push(A("input",{className:Xt.check,attrs:{type:"checkbox"}})):we.push(A("input",{className:Xt.check,attrs:{type:"checkbox"}}))),R===!0)P.showIcon&&fe.hasOwnProperty(F.iconCss)&&!m(fe[F.iconCss])&&we.push(A("span",{className:Xt.icon+" "+fe[F.iconCss]})),Z=w(A,Ne,fe,F,P.itemClass,we,!!(Ne.hasOwnProperty("isHeader")&&Ne.isHeader),q,oe,k),se=Z.querySelector("."+Xt.anchorWrap),P.itemNavigable&&X.length&&xs(X,Z.firstElementChild);else{if(Z=T(A,Ne,fe,F,P.itemClass,k,j),Z.classList.add(Xt.level+"-"+z.level),Z.setAttribute("aria-level",z.level.toString()),(z.groupItemRole==="presentation"||z.itemRole==="presentation")&&Z.removeAttribute("aria-level"),se=Z.querySelector("."+Xt.anchorWrap),fe.hasOwnProperty(F.tooltip)){var H=fe[F.tooltip];if(k&&k.enableHtmlSanitizer)H=Fi.sanitize(H);else{var V=A("span",{innerHTML:H});H=V.innerText,V=null}Z.setAttribute("title",H)}if(fe.hasOwnProperty(F.htmlAttributes)&&fe[F.htmlAttributes]){var re=fe[F.htmlAttributes];re.hasOwnProperty("class")&&typeof re.class=="string"&&re.class.trim()===""&&delete re.class,v(Z,re)}if(fe.hasOwnProperty(F.enabled)&&fe[F.enabled]===!1&&Z.classList.add(Xt.disabled),fe.hasOwnProperty(F.isVisible)&&fe[F.isVisible]===!1&&(Z.style.display="none"),fe.hasOwnProperty(F.imageUrl)&&!m(fe[F.imageUrl])&&!P.template){var he={src:fe[F.imageUrl]};bt(he,fe[F.imageAttributes]);var Ie=A("img",{className:Xt.image,attrs:he});se?se.insertAdjacentElement("afterbegin",Ie):xs([Ie],Z.firstElementChild)}if(P.showIcon&&fe.hasOwnProperty(F.iconCss)&&!m(fe[F.iconCss])&&!P.template){var Te=A("div",{className:Xt.icon+" "+fe[F.iconCss]});se?se.insertAdjacentElement("afterbegin",Te):xs([Te],Z.firstElementChild)}we.length&&xs(we,Z.firstElementChild),P.itemNavigable&&X.length&&xs(X,Z.firstElementChild),x(A,fe,F,L,P,Z,z.level)}if(se&&Q([Z],[Xt.navigable]),P.itemCreated&&typeof P.itemCreated=="function"){var be={dataSource:L,curData:L[oe],text:fe[F.text],item:Z,options:P,fields:F};P.itemCreated(be)}X=[],G.push(Z)}}return G}s.createListItemFromJson=a;function o(A,L,k,O,R,j){var P=me({},t,k),F=a(A,L,k,O,R,j);return D(A,F,P.listClass,k)}s.createListFromJson=o;function l(A,L,k){if(Xt=M(t.moduleName),!(!A||!A.length)){var O,R,j=Array.prototype.slice.call(A);for(L?R=h(L,j):R=k===!0?j.length:-1,O=j[R+(k===!0?-1:1)];O&&(!or(O)||O.classList.contains(Xt.disabled));)R=R+(k===!0?-1:1),O=j[R];return O}}s.getSiblingLI=l;function h(A,L){if(!(!L||!A)){var k=L;return k=Array.prototype.slice.call(L),k.indexOf(A)}}s.indexOf=h;function u(A,L,k){k===void 0&&(k="None");var O=me({},s.defaultMappedFields,L),R=new $e().group(O.groupBy);R=c(k,"key",R);var j=d(A,R);A=[];for(var P=0;P<j.length;P++){var F=j[P].items,z={},q="isHeader";z[O.text]=j[P].key,z[""+q]=!0;var X=O.text;X==="id"&&(X="text",z[""+X]=j[P].key),z._id="group-list-item-"+(j[P].key?j[P].key.toString().trim():"undefined"),z.items=F,A.push(z);for(var G=0;G<F.length;G++)A.push(F[G])}return A}s.groupDataSource=u;function c(A,L,k){if(k===void 0&&(k=new $e),A==="Ascending")k.sortBy(L,"ascending",!0);else if(A==="Descending")k.sortBy(L,"descending",!0);else for(var O=0;O<k.queries.length;O++)k.queries[O].fn==="onSortBy"&&k.queries.splice(O,1);return k}s.addSorting=c;function d(A,L){return new ge(A).executeLocal(L)}s.getDataSource=d;function p(A,L){var k=me({},t,L),O=me({},s.defaultMappedFields,k.fields),R=A.cloneNode(!0),j=[];R.classList.add("json-parent");var P=R.querySelectorAll(".json-parent>li");R.classList.remove("json-parent");for(var F=0;F<P.length;F++){for(var z=P[F],q=z.querySelector("a"),X=z.querySelector("ul"),G={},Z=q?q.childNodes:z.childNodes,se=Object.keys(Z),oe=0;oe<Z.length;oe++)Z[Number(se[oe])].hasChildNodes()||(G[O.text]=Z[Number(se[oe])].textContent);var fe=g(z);fe.id?(G[O.id]=fe.id,delete fe.id):G[O.id]=C(),Object.keys(fe).length&&(G[O.htmlAttributes]=fe),q&&(fe=g(q),Object.keys(fe).length&&(G[O.urlAttributes]=fe)),X&&(G[O.child]=p(X,L)),j.push(G)}return j}s.createJsonFromElement=p;function f(A){for(var L={typeof:null,item:null},k=0;k<A.length;k++)if(!m(A[k]))return L={typeof:typeof A[k],item:A[k]};return L}function v(A,L){var k={};bt(k,L),k.class&&(Q([A],k.class.split(" ")),delete k.class),De(A,k)}function g(A){for(var L={},k=A.attributes,O=0;O<k.length;O++)L[k[O].nodeName]=k[O].nodeValue;return L}function b(A,L,k,O,R,j){Xt=M(t.moduleName);for(var P=A("ul",{className:Xt.ul,attrs:{role:"presentation"}}),F=me({},t,R),z=me({},s.defaultMappedFields,O),q=vm(L),X=[],G,Z=C(),se=0;se<k.length;se++){var oe=Kr(k[se],z),fe=k[se],be=fe.isHeader;if(typeof k[se]=="string"||typeof k[se]=="number"?G=fe:G=oe[z.value],F.itemCreating&&typeof F.itemCreating=="function"){var Ne={dataSource:k,curData:fe,text:G,options:F,fields:z};F.itemCreating(Ne)}F.itemCreating&&typeof F.itemCreating=="function"&&(oe=Kr(k[se],z),typeof k[se]=="string"||typeof k[se]=="number"?G=fe:G=oe[z.value]);var we=A("li",{id:Z+"-"+se,className:be?Xt.group:Xt.li,attrs:{role:"presentation"}});if(be)typeof k[se]=="string"||typeof k[se]=="number"?we.innerText=fe:we.innerText=oe[z.text];else{var H=be?F.groupTemplateID:F.templateID;if(be)if(j&&j.getModuleName()!=="listview"){var V=q(fe,j,"headerTemplate",H,!!F.isStringTemplate,null,we);V&&Ut(V,we)}else Ut(q(fe,j,"headerTemplate",H,!!F.isStringTemplate),we);else if(j&&j.getModuleName()!=="listview"){var V=q(fe,j,"template",H,!!F.isStringTemplate,null,we);V&&Ut(V,we)}else Ut(q(fe,j,"template",H,!!F.isStringTemplate),we);we.setAttribute("data-value",m(G)?"null":G),we.setAttribute("role","option")}if(F.itemCreated&&typeof F.itemCreated=="function"){var Ne={dataSource:k,curData:fe,text:G,item:we,options:F,fields:z};F.itemCreated(Ne)}X.push(we)}return Ut(X,P),P}s.renderContentTemplate=b;function y(A,L,k,O,R,j){for(var P=vm(A),F=me({},s.defaultMappedFields,k),z=me({},t,R),q=F.groupBy,X=0,G=O;X<G.length;X++){var Z=G[X],se={};if(se[""+q]=Z.textContent,Z.innerHTML="",j&&j.getModuleName()!=="listview"){var oe=P(se,j,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate,null,Z);oe&&Ut(oe,Z)}else Ut(P(se,j,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate),Z)}return O}s.renderGroupTemplate=y;function C(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}s.generateId=C;function x(A,L,k,O,R,j,P){var F=L[k.child]||[],z=L[k.hasChildren];if(F.length&&(z=!0,j.classList.add(Xt.hasChild),R.processSubChild)){var q=o(A,F,R,++P);j.appendChild(q)}if(R.expandCollapse&&z&&!R.template){j.firstElementChild.classList.add(Xt.iconWrapper);var X=R.expandIconPosition==="Left"?xs:Ut;X([A("div",{className:"e-icons "+R.expandIconClass})],j.querySelector("."+Xt.textContent))}}function w(A,L,k,O,R,j,P,F,z,q){var X=me({},t,q),G=me({},e,X.ariaAttributes),Z=L,se=L,oe;typeof L!="string"&&typeof L!="number"&&typeof L!="boolean"&&(oe=L,Z=typeof k[O.text]=="boolean"||typeof k[O.text]=="number"?k[O.text]:k[O.text]||"",se=k[O.value]);var fe;!m(oe)&&!m(k[O.id])&&k[O.id]!==""?fe=F:fe=F+"-"+z;var be=A("li",{className:(P===!0?Xt.group:Xt.li)+" "+(m(R)?"":R),id:fe,attrs:G.groupItemRole!==""&&G.itemRole!==""?{role:P===!0?G.groupItemRole:G.itemRole}:{}});return oe&&k.hasOwnProperty(O.enabled)&&k[O.enabled].toString()==="false"&&be.classList.add(Xt.disabled),P?be.innerText=Z:(be.setAttribute("data-value",m(se)?"null":se),be.setAttribute("role","option"),oe&&k.hasOwnProperty(O.htmlAttributes)&&k[O.htmlAttributes]&&v(be,k[O.htmlAttributes]),j.length&&!X.itemNavigable&&Ut(j,be),oe&&(k[O.url]||k[O.urlAttributes]&&k[O.urlAttributes].href)?be.appendChild(E(A,oe,O,Z,j,X.itemNavigable)):(j.length&&X.itemNavigable&&Ut(j,be),be.appendChild(document.createTextNode(Z)))),be}function M(A){return{li:"e-"+A+"-item",ul:"e-"+A+"-parent e-ul",group:"e-"+A+"-group-item",icon:"e-"+A+"-icon",text:"e-"+A+"-text",check:"e-"+A+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+A+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+A+"-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function E(A,L,k,O,R,j){var P=Kr(L,k),F={href:P[k.url]};P.hasOwnProperty(k.urlAttributes)&&P[k.urlAttributes]&&(bt(F,P[k.urlAttributes]),F.href=P[k.url]?P[k.url]:P[k.urlAttributes].href);var z;if(!j)z=A("a",{className:Xt.text+" "+Xt.url,innerHTML:O});else{z=A("a",{className:Xt.text+" "+Xt.url});var q=A("div",{className:Xt.anchorWrap});R&&R.length&&Ut(R,q),q.appendChild(document.createTextNode(O)),Ut([q],z)}return v(z,F),z}function T(A,L,k,O,R,j,P){var F=me({},t,j),z=me({},e,F.ariaAttributes),q=L,X,G,Z;typeof L!="string"&&typeof L!="number"&&(Z=L,q=k[O.text]||"",X=m(k._id)?k[O.id]:k._id,G=!!(L.hasOwnProperty("isHeader")&&L.isHeader)),j&&j.enableHtmlSanitizer&&(q=q);var se=A("li",{className:(G===!0?Xt.group:Xt.li)+" "+(m(R)?"":R),attrs:z.groupItemRole!==""&&z.itemRole!==""?{role:G===!0?z.groupItemRole:z.itemRole}:{}});if(m(X)?se.setAttribute("data-uid",C()):se.setAttribute("data-uid",X),G&&j&&j.groupTemplate){var oe=vm(j.groupTemplate);if(P&&P.getModuleName()!=="listview"){var fe=oe(L,P,"groupTemplate",F.groupTemplateID,!!F.isStringTemplate,null,se);fe&&Ut(fe,se)}else Ut(oe(L,P,"groupTemplate",F.groupTemplateID,!!F.isStringTemplate),se)}else if(!G&&j&&j.template){var oe=vm(j.template);if(P&&P.getModuleName()!=="listview"){var fe=oe(L,P,"template",F.templateID,!!F.isStringTemplate,null,se);fe&&Ut(fe,se)}else Ut(oe(L,P,"template",F.templateID,!!F.isStringTemplate),se)}else{var be=A("div",{className:Xt.textContent,attrs:z.wrapperRole!==""?{role:z.wrapperRole}:{}});if(Z&&(k[O.url]||k[O.urlAttributes]&&k[O.urlAttributes].href))be.appendChild(E(A,Z,O,q,null,F.itemNavigable));else{var Ne=A("span",{className:Xt.text,attrs:z.itemText!==""?{role:z.itemText}:{}});j&&j.enableHtmlSanitizer?Ne.innerText=Fi.sanitize(q):Ne.innerHTML=q,be.appendChild(Ne)}se.appendChild(be)}return se}function D(A,L,k,O){var R=me({},t,O),j=me({},e,R.ariaAttributes);Xt=M(R.moduleName);var P=A("ul",{className:Xt.ul+" "+(m(k)?"":k),attrs:j.listRole!==""?{role:j.listRole}:{}});return Ut(L,P),P}s.generateUL=D;function N(A,L,k,O){var R=me({},t,O);Xt=M(R.moduleName);var j=R.expandIconPosition==="Left"?xs:Ut;return j([A("div",{className:"e-icons "+R.expandIconClass+" "+(m(k)?"":k)})],L.querySelector("."+Xt.textContent)),L}s.generateIcon=N})(Et||(Et={}));function Kr(s,e){var t={};if(m(s)||typeof s=="string"||typeof s=="number"||!m(s.isHeader))return s;for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],a=e[""+n],o=!m(a)&&typeof a=="string"?ie(a,s):void 0;m(o)||(t[""+a]=o)}return t}function vm(s){if(s)try{return typeof s!="function"&&document.querySelector(s)?pi(document.querySelector(s).innerHTML.trim()):pi(s)}catch{return pi(s)}}var Hz=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},qN={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},$9={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},ve={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",container:"e-list-container",icon:"e-icons",backIcon:"e-icon-back",backButton:"e-back-button",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist",virtualElementContainer:"e-list-virtualcontainer"},YN="Template",QN="GroupTemplate",X9="HeaderTemplate",K9=.5,Z9=function(s){Hz(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Gt([S("id")],e.prototype,"id",void 0),Gt([S("text")],e.prototype,"text",void 0),Gt([S("isChecked")],e.prototype,"isChecked",void 0),Gt([S("isVisible")],e.prototype,"isVisible",void 0),Gt([S("enabled")],e.prototype,"enabled",void 0),Gt([S("iconCss")],e.prototype,"iconCss",void 0),Gt([S("child")],e.prototype,"child",void 0),Gt([S("tooltip")],e.prototype,"tooltip",void 0),Gt([S("groupBy")],e.prototype,"groupBy",void 0),Gt([S("text")],e.prototype,"sortBy",void 0),Gt([S("htmlAttributes")],e.prototype,"htmlAttributes",void 0),Gt([S("tableName")],e.prototype,"tableName",void 0),e}(ke),Ib=function(s){Hz(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.previousSelectedItems=[],r.hiddenItems=[],r.enabledItems=[],r.disabledItems=[],r}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(i.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1,"header");break;case"query":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"showHeader":this.header(this.headerTitle,!1,"header");break;case"enableVirtualization":m(this.contentContainer)||ne(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"template":this.enableVirtualization||this.refresh();break;case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList());break}}},e.prototype.setHTMLAttribute=function(){Object.keys(this.htmlAttributes).length&&De(this.element,this.htmlAttributes)},e.prototype.setCSSClass=function(t){this.cssClass&&Q([this.element],this.cssClass.split(" ").filter(function(i){return i})),t&&te([this.element],t.split(" ").filter(function(i){return i}))},e.prototype.setSize=function(){this.element.style.height=qe(this.height),this.element.style.width=qe(this.width),this.isWindow=!this.element.clientHeight},e.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},e.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},e.prototype.enableElement=function(t,i){i?t.classList.remove(ve.disable):t.classList.add(ve.disable)},e.prototype.header=function(t,i,r){if(this.headerEle===void 0&&this.showHeader){this.headerEle=this.createElement("div",{className:ve.header});var n=this.createElement("span",{className:ve.headerText});this.enableHtmlSanitizer?(this.setProperties({headerTitle:Fi.sanitize(this.headerTitle)},!0),n.innerText=this.headerTitle):n.innerHTML=this.headerTitle;var a=this.createElement("div",{className:ve.text,innerHTML:n.outerHTML}),o=this.createElement("div",{className:ve.icon+" "+ve.backIcon+" "+ve.backButton,attrs:{style:"display:none;"}});if(this.headerEle.appendChild(o),this.headerEle.appendChild(a),this.headerTemplate){var l=pi(this.headerTemplate),h=this.createElement("div",{className:ve.headerTemplateText}),u=l({},this,r,this.LISTVIEW_HEADERTEMPLATE_ID,null,null,this.headerEle);u&&Ut(u,h),Ut([h],this.headerEle),this.isReact&&this.renderReactTemplates()}this.headerTemplate&&this.headerTitle&&a.classList.add("header"),this.element.classList.add("e-has-header"),xs([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var a=this.headerEle.querySelector("."+ve.headerText),o=this.headerEle.querySelector("."+ve.backIcon);this.enableHtmlSanitizer&&(t=Fi.sanitize(t)),a.innerHTML=t,this.headerTemplate&&i&&(a.parentElement.classList.remove("header"),this.headerEle.querySelector("."+ve.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!i&&(a.parentElement.classList.add("header"),this.headerEle.querySelector("."+ve.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+ve.headerTemplateText).classList.add("header")),i===!0?o.style.display="":o.style.display="none"}else this.headerEle.style.display="none"},e.prototype.switchView=function(t,i,r){var n=this;if(t&&i){var a=t.style.position,o=this.element.style.overflow!=="hidden"?this.element.style.overflow:"";t.style.position="absolute",t.classList.add("e-view");var l=void 0,h=this.animation.duration;if(this.animation.effect)l=this.enableRtl?$9[this.animation.effect]:qN[this.animation.effect];else{var u="SlideLeft";l=qN[""+u],r=this.enableRtl,h=0}this.element.style.overflow="hidden",this.aniObj.animate(t,{name:r===!0?l[0]:l[1],duration:h===0&&vi==="Enable"?400:h,timingFunction:this.animation.easing,end:function(c){t.style.display="none",n.element.style.overflow=o,t.style.position=a,t.classList.remove("e-view")}}),i.style.display="",this.aniObj.animate(i,{name:r===!0?l[2]:l[3],duration:h===0&&vi==="Enable"?400:h,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=i}},e.prototype.preRender=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&this.setProperties({template:document.querySelector(this.template).innerHTML.trim()},!0)}catch{pi(this.template)}this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"listitem",listRole:"list",itemText:"",groupItemRole:"presentation",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this),templateID:""+this.element.id+YN,groupTemplateID:""+this.element.id+QN,enableHtmlSanitizer:this.enableHtmlSanitizer},this.initialization()},e.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=this.enablePersistence?this.selectedId:[],this.LISTVIEW_TEMPLATE_ID=""+this.element.id+YN,this.LISTVIEW_GROUPTEMPLATE_ID=""+this.element.id+QN,this.LISTVIEW_HEADERTEMPLATE_ID=""+this.element.id+X9,this.aniObj=new ri(this.animateOptions),this.removeElement(this.curUL),this.removeElement(this.ulElement),this.removeElement(this.headerEle),this.removeElement(this.contentContainer),this.curUL=this.ulElement=this.liCollection=this.headerEle=this.contentContainer=void 0},e.prototype.renderCheckbox=function(t){var i=this;if(t.item.classList.contains(ve.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&this.isValidLI(t.item)){var r=void 0,n;r=M0(this.createElement,!1,{checked:!1,enableRtl:this.enableRtl,cssClass:ve.listviewCheckbox}),r.setAttribute("role","checkbox");var a=r.querySelector("."+ve.checkboxIcon);if(t.item.classList.add(ve.itemCheckList),t.item.firstElementChild.classList.add(ve.checkbox),typeof this.dataSource[0]!="string"&&typeof this.dataSource[0]!="number")if(n=Kr(t.curData,this.listBaseOption.fields),this.enablePersistence&&!m(this.selectedId)){var o=this.selectedId.findIndex(function(l){return l===n[i.listBaseOption.fields.id].toString()});o!==-1&&this.checkInternally(t,r)}else n[this.listBaseOption.fields.isChecked]&&this.checkInternally(t,r);else(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")&&this.selectedData.indexOf(t.text)!==-1&&this.checkInternally(t,r);r.setAttribute("aria-checked",a.classList.contains(ve.checked)?"true":"false"),r.setAttribute("aria-label",t.text),this.checkBoxPosition==="Left"?(r.classList.add(ve.checkboxLeft),t.item.firstElementChild.classList.add(ve.checkboxLeft),t.item.firstElementChild.insertBefore(r,t.item.firstElementChild.childNodes[0])):(r.classList.add(ve.checkboxRight),t.item.firstElementChild.classList.add(ve.checkboxRight),t.item.firstElementChild.appendChild(r)),this.currentLiElements.push(t.item),this.checkBoxPosition==="Left"?this.virtualCheckBox=t.item.firstElementChild.children[0]:this.virtualCheckBox=t.item.firstElementChild.lastElementChild}},e.prototype.checkInternally=function(t,i){t.item.classList.add(ve.selected),i.querySelector("."+ve.checkboxIcon).classList.add(ve.checked),i.setAttribute("aria-checked","true")},e.prototype.checkItem=function(t){this.toggleCheckBase(t,!0)},e.prototype.toggleCheckBase=function(t,i){if(this.showCheckBox){var r=t;if(t instanceof Object&&t.constructor!==HTMLLIElement&&(r=this.getLiFromObjOrElement(t)),!m(r)){var n=r.querySelector("."+ve.checkboxIcon);i===!0?r.classList.add(ve.selected):r.classList.remove(ve.selected),i===!0?n.classList.add(ve.checked):n.classList.remove(ve.checked),n.parentElement.setAttribute("aria-checked",i?"true":"false")}this.setSelectedItemData(r),this.updateSelectedId()}},e.prototype.uncheckItem=function(t){this.toggleCheckBase(t,!1)},e.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},e.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},e.prototype.toggleAllCheckBase=function(t){if(this.showCheckBox){for(var i=0;i<this.liCollection.length;i++){var r=this.liCollection[i].querySelector("."+ve.checkboxIcon);r&&(t?r.classList.contains(ve.checked)||this.checkItem(this.liCollection[i]):r.classList.contains(ve.checked)&&this.uncheckItem(this.liCollection[i]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(t),this.updateSelectedId()}},e.prototype.setCheckbox=function(){if(this.showCheckBox)for(var t=Array.prototype.slice.call(this.element.querySelectorAll("."+ve.listItem)),i={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""},r=0;r<t.length;r++){var n=t[r];i.item=n,i.curData=this.getItemData(n),n.querySelector("."+ve.checkboxWrapper)&&this.removeElement(n.querySelector("."+ve.checkboxWrapper)),this.renderCheckbox(i),i.item.classList.contains(ve.selected)&&this.checkInternally(i,i.item.querySelector("."+ve.checkboxWrapper))}else{for(var t=Array.prototype.slice.call(this.element.querySelectorAll("."+ve.itemCheckList)),r=0;r<t.length;r++){var n=t[r];n.classList.remove(ve.selected),n.firstElementChild.classList.remove(ve.checkbox),this.removeElement(n.querySelector("."+ve.checkboxWrapper))}this.selectedItems&&this.selectedItems.item.classList.add(ve.selected)}},e.prototype.refreshItemHeight=function(){this.virtualizationModule&&this.virtualizationModule.refreshItemHeight()},e.prototype.clickHandler=function(t){if(!(Array.isArray(this.dataSource)&&this.dataSource.length===0)){var i=t.target;this.targetElement=i;var r=i.classList,n;if(r.contains(ve.backIcon)||r.contains(ve.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var a=U(i.parentNode,"."+ve.listItem);if(a===null&&(a=i),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(a))if(t.target.classList.contains(ve.checkboxIcon)){if(a.classList.add(ve.focused),m(a.querySelector("."+ve.checked))){var o={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:a};this.checkInternally(o,o.item.querySelector("."+ve.checkboxWrapper))}else this.uncheckItem(a),a.classList.add(ve.focused);if(this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(a,t),t){var l=this.selectEventData(a,t),h=a.querySelector("."+ve.checkboxIcon);bt(l,{isChecked:h.classList.contains(ve.checked)}),this.trigger("select",l)}}else a.classList.contains(ve.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(a),this.setSelectLI(a,t),a.classList.remove(ve.selected)):(this.setCheckboxLI(a,t),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i));else this.setSelectLI(a,t),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i);n=U(t.target,"li"),m(n)||n.classList.contains("e-has-child")&&!t.target.parentElement.classList.contains("e-listview-checkbox")&&n.classList.add(ve.disable)}this.updateSelectedId()}},e.prototype.removeElement=function(t){return t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.hoverHandler=function(t){var i=U(t.target.parentNode,"."+ve.listItem);this.setHoverLI(i)},e.prototype.leaveHandler=function(t){this.removeHover()},e.prototype.homeKeyHandler=function(t,i){if(t.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var r=this.curUL.querySelectorAll("."+ve.listItem),n=this.curUL.querySelector("."+ve.focused)||this.curUL.querySelector("."+ve.selected);n&&(n.classList.remove(ve.focused),this.showCheckBox||n.classList.remove(ve.selected));var a=i?r.length-1:0;r[a].classList.contains(ve.hasChild)||this.showCheckBox?r[a].classList.add(ve.focused):this.setSelectLI(r[a],t),r[a]?this.element.setAttribute("aria-activedescendant",r[a].id.toString()):this.element.removeAttribute("aria-activedescendant")}},e.prototype.onArrowKeyDown=function(t,i){var r,n,a=!m(this.curUL.querySelector("."+ve.hasChild));return a||this.showCheckBox?(n=this.curUL.querySelector("."+ve.focused)||this.curUL.querySelector("."+ve.selected),r=Et.getSiblingLI(this.curUL.querySelectorAll("."+ve.listItem),n,i),m(r)||(n&&(n.classList.remove(ve.focused),this.showCheckBox||n.classList.remove(ve.selected)),r.classList.contains(ve.hasChild)||this.showCheckBox?r.classList.add(ve.focused):this.setSelectLI(r,t))):(n=this.curUL.querySelector("."+ve.selected),r=Et.getSiblingLI(this.curUL.querySelectorAll("."+ve.listItem),n,i),this.setSelectLI(r,t)),r?this.element.setAttribute("aria-activedescendant",r.id.toString()):this.element.removeAttribute("aria-activedescendant"),r},e.prototype.arrowKeyHandler=function(t,i){var r=this;if(t.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(t,i),a=this.element.getBoundingClientRect().top,o=this.element.getBoundingClientRect().height,l=this.curUL.querySelector("."+ve.listItem).getBoundingClientRect(),h=void 0,u=void 0;if(this.fields.groupBy&&(u=this.curUL.querySelector("."+ve.groupListItem).getBoundingClientRect()),n){var c=n.getBoundingClientRect().top,d=n.getBoundingClientRect().height;if(i)h=this.isWindow?c:c-a,h<0&&(this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop+h);else{var p=this.isWindow?window.innerHeight:o;h=this.isWindow?c+d:c-a+d,h>p&&(this.isWindow===!0?window.scroll(0,pageYOffset+(h-p)):this.element.scrollTop=this.element.scrollTop+(h-p))}}else if(this.enableVirtualization&&i&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){r.onArrowKeyDown(t,i),r.onUIScrolled=void 0},h=this.virtualizationModule.listItemHeight,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=this.element.scrollTop-h;else if(i)if(this.showHeader&&this.headerEle){var f=u?u.top:l.top,v=this.headerEle.getBoundingClientRect();h=v.top<0?v.height-f:0,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=0}else this.fields.groupBy&&(h=this.isWindow?u.top<0?u.top:0:a-l.top+u.height,this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop-h)}},e.prototype.enterKeyHandler=function(t){if(Object.keys(this.dataSource).length&&this.curUL){var i=!m(this.curUL.querySelector("."+ve.hasChild)),r=this.curUL.querySelector("."+ve.focused);i&&r&&(r.classList.remove(ve.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(r),this.removeHover()),this.setSelectLI(r,t))}},e.prototype.spaceKeyHandler=function(t){if(t.preventDefault(),this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){var i=this.curUL.querySelector("."+ve.focused),r=void 0,n=void 0;if(!m(i)&&m(i.querySelector("."+ve.checked))){var a={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:i};r=a.item.querySelector("."+ve.checkboxWrapper),this.checkInternally(a,r),n=r.querySelector("."+ve.checkboxIcon+"."+ve.icon)}else this.uncheckItem(i);var o=this.selectEventData(i,t);bt(o,{isChecked:n?n.classList.contains(ve.checked):!1}),this.trigger("select",o),this.updateSelectedId()}},e.prototype.keyActionHandler=function(t){switch(t.keyCode){case 36:this.homeKeyHandler(t);break;case 35:this.homeKeyHandler(t,!0);break;case 40:this.arrowKeyHandler(t);break;case 38:this.arrowKeyHandler(t,!0);break;case 13:this.enterKeyHandler(t);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 32:(m(this.targetElement)||!this.targetElement.classList.contains("e-focused"))&&this.spaceKeyHandler(t);break}},e.prototype.swipeActionHandler=function(t){t.swipeDirection==="Right"&&t.velocity>K9&&t.originalEvent.type==="touchend"&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},e.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var t=this.curUL.querySelector("."+ve.focused);t&&(t.classList.remove(ve.focused),!this.showCheckBox&&!m(this.selectedLI)&&this.selectedLI.classList.add(ve.selected))}},e.prototype.wireEvents=function(){I.add(this.element,"keydown",this.keyActionHandler,this),I.add(this.element,"click",this.clickHandler,this),I.add(this.element,"mouseover",this.hoverHandler,this),I.add(this.element,"mouseout",this.leaveHandler,this),I.add(this.element,"focusout",this.focusout,this),this.touchModule=new Pn(this.element,{swipe:this.swipeActionHandler.bind(this)}),m(this.scroll)||I.add(this.element,"scroll",this.onListScroll,this)},e.prototype.unWireEvents=function(){I.remove(this.element,"click",this.clickHandler),I.remove(this.element,"mouseover",this.hoverHandler),I.remove(this.element,"mouseout",this.leaveHandler),I.remove(this.element,"mouseover",this.hoverHandler),I.remove(this.element,"mouseout",this.leaveHandler),m(this.scroll)||I.remove(this.element,"scroll",this.onListScroll),this.touchModule.destroy(),this.touchModule=null},e.prototype.removeFocus=function(){for(var t=this.element.querySelectorAll("."+ve.focused),i=0,r=t;i<r.length;i++){var n=r[i];n.classList.remove(ve.focused)}},e.prototype.removeHover=function(){var t=this.element.querySelector("."+ve.hover);t&&t.classList.remove(ve.hover)},e.prototype.removeSelect=function(t){if(m(t))for(var i=this.element.querySelectorAll("."+ve.selected),r=0,n=i;r<n.length;r++){var a=n[r];this.showCheckBox&&a.querySelector("."+ve.checked)||a.classList.remove(ve.selected)}else t.classList.remove(ve.selected)},e.prototype.isValidLI=function(t){return t&&t.classList.contains(ve.listItem)&&!t.classList.contains(ve.groupListItem)&&!t.classList.contains(ve.disable)},e.prototype.setCheckboxLI=function(t,i){if(this.isValidLI(t)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+ve.focused)&&this.curUL.querySelector("."+ve.focused).classList.remove(ve.focused);var r=t.querySelector("textarea")||t.querySelector("input");t.classList.add(ve.focused),m(i)||i.target===r&&r.classList.add("e-focused");var n=t.querySelector("."+ve.checkboxWrapper),a=n.querySelector("."+ve.checkboxIcon+"."+ve.icon);this.removeHover(),a.classList.contains(ve.checked)?(a.classList.remove(ve.checked),t.classList.remove(ve.selected)):(a.classList.add(ve.checked),t.classList.add(ve.selected)),n.setAttribute("aria-checked",a.classList.contains(ve.checked)?"true":"false");var o=this.selectEventData(t,i);bt(o,{isChecked:a.classList.contains(ve.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(t,i),this.trigger("select",o),this.setSelectedItemData(t),this.renderSubList(t)}},e.prototype.selectEventData=function(t,i){var r=this.getItemData(t),n=Kr(r,this.listBaseOption.fields),a;!m(r)&&typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number"?a={item:t,text:t&&t.innerText.trim(),data:this.dataSource}:a={item:t,text:n&&n[this.listBaseOption.fields.text],data:r};var o={};return bt(o,a),i&&bt(o,{isInteracted:!0,event:i,cancel:!1,index:this.curUL&&Array.prototype.indexOf.call(this.curUL.children,t)}),o},e.prototype.setSelectedItemData=function(t){var i=this.getItemData(t),r=Kr(i,this.listBaseOption.fields);!m(i)&&(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")?this.selectedItems={item:t,text:t&&t.innerText.trim(),data:this.dataSource}:this.selectedItems={item:t,text:r&&r[this.listBaseOption.fields.text],data:i}},e.prototype.setSelectLI=function(t,i){var r=this;if(this.isValidLI(t)&&!t.classList.contains(ve.selected)&&this.enable){this.showCheckBox||this.removeSelect(),t.classList.add(ve.selected),this.removeHover(),this.setSelectedItemData(t),this.enableVirtualization&&this.virtualizationModule.setSelectLI(t,i);var n=this.selectEventData(t,i);this.trigger("select",n,function(a){a.cancel||(r.selectedLI=t,r.renderSubList(t))})}},e.prototype.setHoverLI=function(t){if(this.isValidLI(t)&&!t.classList.contains(ve.hover)&&this.enable){var i=this.element.querySelectorAll("."+ve.hover);i&&i.length&&te(i,ve.hover),(!t.classList.contains(ve.selected)||this.showCheckBox)&&t.classList.add(ve.hover)}},e.prototype.getSubDS=function(){var t=this.curDSLevel;if(t.length){for(var i=this.localData,r=0,n=t;r<n.length;r++){var a=n[r],o={};o[this.fields.id]=a,this.curDSJSON=this.findItemFromDS(i,o);var l=Kr(this.curDSJSON,this.listBaseOption.fields);i=this.curDSJSON?l[this.fields.child]:i}return i}return this.localData},e.prototype.getItemData=function(t){var i=this.dataSource instanceof ge?this.localData:this.dataSource,r=this.getElementUID(t),n;return m(this.element.querySelector("."+ve.hasChild))&&this.fields.groupBy?n=this.curViewDS:n=i,this.findItemFromDS(n,r)},e.prototype.findItemFromDS=function(t,i,r){var n=this,a;return t&&t.length&&i?t.some(function(o){var l=Kr(o,n.listBaseOption.fields);if((i[n.fields.id]||i[n.fields.text])&&(!i[n.fields.id]||(!m(l[n.fields.id])&&l[n.fields.id].toString())===i[n.fields.id].toString())&&(!i[n.fields.text]||l[n.fields.text]===i[n.fields.text]))a=r?t:o;else if(typeof o!="object"&&t.indexOf(o)!==-1)a=r?t:o;else if(!m(i[n.fields.id])&&m(l[n.fields.id])){var h=n.element.querySelector('[data-uid="'+i[n.fields.id]+'"]');h&&h.innerText.trim()===l[n.fields.text]&&(a=o)}else l.hasOwnProperty(n.fields.child)&&l[n.fields.child].length&&(a=n.findItemFromDS(l[n.fields.child],i,r));return!!a}):a=t,a},e.prototype.getQuery=function(){var t=[],i=this.query?this.query:new $e;if(!this.query){for(var r=0,n=Object.keys(this.fields.properties);r<n.length;r++){var a=n[r];a!=="tableName"&&this.fields[""+a]&&this.fields[""+a]!==Et.defaultMappedFields[""+a]&&t.indexOf(this.fields[""+a])===-1&&t.push(this.fields[""+a])}i.select(t),this.fields.properties.hasOwnProperty("tableName")&&i.from(this.fields.tableName)}return i},e.prototype.setViewDataSource=function(t){t===void 0&&(t=this.localData);var i=m(this.fields.sortBy)?this.fields.text:this.fields.sortBy,r=Et.addSorting(this.sortOrder,i);t&&this.fields.groupBy?this.sortOrder!=="None"?this.curViewDS=Et.groupDataSource(Et.getDataSource(t,r),this.listBaseOption.fields,this.sortOrder):this.curViewDS=Et.groupDataSource(t,this.listBaseOption.fields,this.sortOrder):t&&this.sortOrder!=="None"?this.curViewDS=Et.getDataSource(t,r):this.curViewDS=t},e.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},e.prototype.renderRemoteLists=function(t,i){this.isDestroyed||(this.localData=t.result,i.removeElement(i.contentContainer),this.renderList(),this.trigger("actionComplete",t))},e.prototype.triggerActionFailure=function(t){this.isDestroyed||this.trigger("actionFailure",t)},e.prototype.setLocalData=function(){var t=this;this.trigger("actionBegin");var i=this;if(this.dataSource instanceof ge)this.dataSource.ready?this.dataSource.ready.then(function(n){t.isOffline=t.dataSource.dataSource.offline,t.dataSource instanceof ge&&t.isOffline&&t.renderRemoteLists(n,i)}).catch(function(n){t.triggerActionFailure(n)}):this.dataSource.executeQuery(this.getQuery()).then(function(n){t.renderRemoteLists(n,i)}).catch(function(n){t.triggerActionFailure(n)});else if(!this.dataSource||!this.dataSource.length){var r=this.element.querySelector("ul");r&&(pt(r),this.setProperties({dataSource:Et.createJsonFromElement(r)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}else this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData})},e.prototype.reRender=function(){this.removeElement(this.headerEle),this.removeElement(this.ulElement),this.removeElement(this.contentContainer),this.isReact&&this.clearTemplate(),Object.keys(window).indexOf("ejsInterop")===-1&&(this.element.innerHTML=""),this.headerEle=this.ulElement=this.liCollection=void 0,this.header(),this.setLocalData()},e.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},e.prototype.setAttributes=function(t){for(var i=0;i<t.length;i++){var r=t[i];r.classList.contains("e-list-item")&&(r.setAttribute("id",this.element.id+"_"+r.getAttribute("data-uid")),r.setAttribute("tabindex","-1"))}},e.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=Et.createList(this.createElement,this.curViewDS,this.listBaseOption,null,this),this.liCollection=this.curUL.querySelectorAll("."+ve.listItem),this.setAttributes(this.liCollection)},e.prototype.exceptionEvent=function(t){this.trigger("actionFailure",t)},e.prototype.UpdateCurrentUL=function(){this.ulElement=this.curUL=this.element.querySelector("."+ve.parentItem),this.curUL&&(this.liCollection=this.curUL.querySelectorAll("."+ve.listItem))},e.prototype.renderSubList=function(t){this.liElement=t;var i=t.getAttribute("data-uid");if(t.classList.contains(ve.hasChild)&&i){var r=U(t.parentNode,"."+ve.parentItem),n=this.element.querySelector("[pid='"+i+"']");if(this.curDSLevel.push(i),this.setViewDataSource(this.getSubDS()),!n){var a=this.curViewDS;n=Et.createListFromJson(this.createElement,a,this.listBaseOption,this.curDSLevel.length,null,this),this.isReact&&this.renderReactTemplates();var o=n.querySelectorAll("."+ve.listItem);this.setAttributes(o),n.setAttribute("pID",i),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(r,n),this.liCollection=this.curUL.querySelectorAll("."+ve.listItem),this.selectedItems){var l=Kr(this.selectedItems.data,this.listBaseOption.fields);this.header(l[this.listBaseOption.fields.text],!0,"header")}this.selectedLI=void 0}},e.prototype.renderIntoDom=function(t){this.contentContainer.appendChild(t)},e.prototype.renderList=function(t){this.setViewDataSource(t),this.enableVirtualization?(Object.keys(this.dataSource).length&&(this.template||this.groupTemplate)&&!this.virtualizationModule.isNgTemplate()&&(this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=this.createElement("div",{className:ve.container}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement),this.isReact&&this.renderReactTemplates())},e.prototype.getElementUID=function(t){var i={};return t instanceof Element?i[this.fields.id]=t.getAttribute("data-uid"):i=t,i},e.prototype.render=function(){this.element.classList.add(ve.root),De(this.element,{tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=yr(this.element,{selector:"."+ve.listItem}),this.renderComplete(),this.previousScrollTop=this.element.scrollTop},e.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unWireEvents();var t=[ve.root,ve.disable,"e-rtl","e-has-header","e-lib"].concat(this.cssClass.split(" ").filter(function(i){return i}));te([this.element],t),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,this.element.innerHTML="",this.contentContainer=null,this.selectedItems=null,this.selectedLI=null,this.liElement=null,this.targetElement=null,this.currentLiElements=null,this.virtualCheckBox=null,s.prototype.destroy.call(this)},e.prototype.back=function(){var t=this.curDSLevel[this.curDSLevel.length-1];if(!(t===void 0||this.isInAnimation())){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS());var i=this.element.querySelector("[data-uid='"+t+"']"),r=this.curUL;i?i=i.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),i=this.curUL);var n=Kr(this.curDSJSON,this.listBaseOption.fields),a=n[this.fields.text];this.switchView(r,i,!0),this.removeFocus();var o=this.element.querySelector("[data-uid='"+t+"']");o.classList.remove(ve.disable),o.classList.add(ve.focused),this.showCheckBox&&o.querySelector("."+ve.checkboxIcon).classList.contains(ve.checked)||o.classList.remove(ve.selected),this.liCollection=this.curUL.querySelectorAll("."+ve.listItem),this.enableHtmlSanitizer&&this.setProperties({headerTitle:Fi.sanitize(this.headerTitle)},!0),this.header(this.curDSLevel.length?a:this.headerTitle,!!this.curDSLevel.length,"header")}},e.prototype.selectItem=function(t){this.enableVirtualization?this.virtualizationModule.selectItem(t):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(t)):m(t)===!0?this.removeSelect():this.setSelectLI(this.getLiFromObjOrElement(t))},e.prototype.getLiFromObjOrElement=function(t){var i,r=this.dataSource instanceof ge?this.localData:this.dataSource;if(!m(t))if(typeof r[0]=="string"||typeof r[0]=="number")if(t instanceof Element){for(var n=t.getAttribute("data-uid").toString(),a=0;a<this.liCollection.length;a++)if(this.liCollection[a].getAttribute("data-uid").toString()===n){i=this.liCollection[a];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+ve.listItem),function(u){return u.innerText.trim()===t.toString()?(i=u,!0):!1});else{var o=this.getItemData(t),l=Kr(o,this.listBaseOption.fields);if(o&&(i=this.element.querySelector('[data-uid="'+l[this.fields.id]+'"]'),!this.enableVirtualization&&m(i)))for(var h=this.element.querySelectorAll("."+ve.listItem),a=0;a<h.length;a++)h[a].innerText.trim()===l[this.fields.text]&&(i=h[a])}return i},e.prototype.selectMultipleItems=function(t){if(!m(t))for(var i=0;i<t.length;i++)m(t[i])||this.selectItem(t[i])},e.prototype.getParentId=function(){var t=[];if(this.isNestedList)for(var i=this.curDSLevel.length-1;i>=0;i--)t.push(this.curDSLevel[i]);return t},e.prototype.updateSelectedId=function(){this.selectedId=[];for(var t=this.curUL.getElementsByClassName(ve.selected),i=0;i<t.length;i++){var r=this.getItemData(t[i]);!m(r)&&r[this.listBaseOption.fields.id]&&this.selectedId.push(r[this.listBaseOption.fields.id])}},e.prototype.getSelectedItems=function(){var t,i=!1;this.selectedId=[];var r=this.dataSource instanceof ge?this.localData:this.dataSource;if(this.enableVirtualization&&!i)t=this.virtualizationModule.getSelectedItems(),i=!0;else if(this.showCheckBox&&!i){var n=this.curUL.getElementsByClassName(ve.selected),a=[],o=[];this.selectedId=[];for(var l=[],h=0;h<n.length;h++)if(typeof r[0]=="string"||typeof r[0]=="number")a.push(n[h].innerText.trim());else{var u=this.getItemData(n[h]),c=Kr(u,this.listBaseOption.fields);this.isNestedList?l.push({data:u,parentId:this.getParentId()}):o.push(u),c?(a.push(c[this.listBaseOption.fields.text]),this.selectedId.push(c[this.listBaseOption.fields.id])):(a.push(void 0),this.selectedId.push(void 0))}(typeof r[0]=="string"||typeof r[0]=="number")&&!i&&(t={item:n,data:r,text:a},i=!0),this.isNestedList&&!i?(t={item:n,data:l,text:a},i=!0):i||(t={item:n,data:o,text:a},i=!0)}else if(!i){var d=this.element.getElementsByClassName(ve.selected)[0],c=Kr(this.getItemData(d),this.listBaseOption.fields);(typeof r[0]=="string"||typeof r[0]=="number")&&!i?(t=m(d)?void 0:{item:d,data:r,text:d.innerText.trim()},i=!0):i||(m(c)||m(d)?(t=void 0,i=!0):(this.selectedId.push(c[this.listBaseOption.fields.id]),t={text:c[this.listBaseOption.fields.text],item:d,data:this.getItemData(d)},i=!0))}return t},e.prototype.findItem=function(t){return this.getItemData(t)},e.prototype.enableItem=function(t){this.setItemState(t,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(t)},e.prototype.disableItem=function(t){this.setItemState(t,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(t)},e.prototype.setItemState=function(t,i){var r=this.getItemData(t),n=Kr(r,this.listBaseOption.fields);if(r){var a=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');i?(a&&a.classList.remove(ve.disable),delete r[this.fields.enabled]):i||(a&&a.classList.add(ve.disable),r[this.fields.enabled]=!1)}},e.prototype.showItem=function(t){this.showHideItem(t,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(t)},e.prototype.hideItem=function(t){this.showHideItem(t,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(t)},e.prototype.showHideItem=function(t,i,r){var n=this.getItemData(t),a=Kr(n,this.listBaseOption.fields);if(n){var o=this.element.querySelector('[data-uid="'+a[this.fields.id]+'"]');o&&(o.style.display=r),i?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},e.prototype.addItem=function(t,i,r){i===void 0&&(i=void 0);var n=this.dataSource instanceof ge?this.localData:this.dataSource;this.addItemInternally(t,i,n,r)},e.prototype.addItemInternally=function(t,i,r,n){if(t instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(t,i,r,n);else{var a=this.findItemFromDS(r,i),o=void 0;if(a){var l=Kr(a,this.listBaseOption.fields);o=l[this.fields.child],o||(o=[]),o=o.concat(t)}if(a instanceof Array){for(var h=0;h<t.length;h++){r=this.addItemAtIndex(n,r,t[h]),this.setViewDataSource(r);var u=this.contentContainer?this.contentContainer.children[0]:null;this.contentContainer&&u?this.addItemIntoDom(t[h],u,this.curViewDS):this.reRender()}this.liCollection=this.curUL.querySelectorAll("."+ve.listItem)}else a&&(a[this.fields.child]=o,this.addItemInNestedList(a,t))}},e.prototype.addItemAtIndex=function(t,i,r){var n=!m(t)&&t>=0&&t<i.length&&m(this.listBaseOption.fields.groupBy);return n?i.splice(t,0,r):i.push(r),i},e.prototype.addItemInNestedList=function(t,i){var r=t[this.fields.id],n=t[this.fields.child],a=this.element.querySelector("[pid='"+r+"']"),o=this.element.querySelector("[data-uid='"+r+"']"),l=a||(o?U(o,"ul"):null),h=a?n:[t],u=o?!o.classList.contains(ve.hasChild):!1;if(u){var c=Et.createListItemFromJson(this.createElement,h,this.listBaseOption,null,null,this);this.setAttributes(c),l.insertBefore(c[0],o),ne(o)}if(a&&i)for(var d=0;d<i.length;d++)h.push(i[d]),this.addItemIntoDom(i[d],l,h)},e.prototype.addItemIntoDom=function(t,i,r){var n=r.indexOf(t);this.addListItem(t,n,i,r);var a=r[n-1];a&&a.isHeader&&a.items.length===1&&this.addListItem(a,n-1,i,r)},e.prototype.addListItem=function(t,i,r,n){var a=this.getLiFromObjOrElement(n[i+1])||this.getLiFromObjOrElement(n[i+2])||null,o=Et.createListItemFromJson(this.createElement,[t],this.listBaseOption,null,null,this);if(this.setAttributes(o),this.template&&this.isReact&&this.renderReactTemplates(),this.fields.groupBy&&n[i+1]&&n[i+1].isHeader){var l=this.getLiFromObjOrElement(n[i-1]);l&&(a=l.nextElementSibling)}r.insertBefore(o[0],a)},e.prototype.removeItem=function(t){var i=this.dataSource instanceof ge?this.localData:this.dataSource;this.enableVirtualization?this.virtualizationModule.removeItem(t):this.removeItemFromList(t,i)},e.prototype.removeItemFromList=function(t,i){var r=this,n=this.curViewDS,a=t instanceof Element?this.getElementUID(t):t,o;if(o=this.findItemFromDS(i,a,!0),o){var l;l=this.findItemFromDS(o,a);var h=n.indexOf(l),u=this.getLiFromObjOrElement(t),c=void 0;this.validateNestedView(u),this.fields.groupBy&&this.curViewDS[h-1]&&n[h-1].isHeader&&n[h-1].items.length===1&&u&&u.previousElementSibling.classList.contains(ve.groupListItem)&&(m(u.nextElementSibling)||u.nextElementSibling&&u.nextElementSibling.classList.contains(ve.groupListItem))&&(c=u.previousElementSibling),u&&ne(u),c&&ne(c);var d=o.length-1<=0?this.findParent(this.localData,this.fields.id,function(g){return g===l[r.fields.id]},null):null,p=o.indexOf(l);if(o.splice(p,1),this.setViewDataSource(i),d&&d.parent&&Array.isArray(d.parent[this.fields.child])&&d.parent[this.fields.child].length<=0){var f=this.getLiFromObjOrElement(d.parent);if(f){var v=Et.createListItemFromJson(this.createElement,[d.parent],this.listBaseOption,null,null,this);this.setAttributes(v),f.parentElement.insertBefore(v[0],f),f.parentElement.removeChild(f)}}o.length<=0&&this.back(),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+ve.listItem))}},e.prototype.validateNestedView=function(t){var i=t?t.getAttribute("data-uid").toString().toLowerCase():null;if(i&&this.curDSLevel&&this.curDSLevel.length>0)for(;this.curDSLevel.some(function(r){return r.toString().toLowerCase()===i});)this.back()},e.prototype.removeMultipleItems=function(t){if(t.length)for(var i=0;i<t.length;i++)this.removeItem(t[i])},e.prototype.findParent=function(t,i,r,n){if(t.hasOwnProperty(i)&&r(t[i])===!0)return me({},t);for(var a=0;a<Object.keys(t).length;a++)if(t[Object.keys(t)[a]]&&typeof t[Object.keys(t)[a]]=="object"){var o=this.findParent(t[Object.keys(t)[a]],i,r,t);if(o!=null)return o.parent||(o.parent=n),o}return null},e.prototype.getModuleName=function(){return"listview"},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"virtualization"}),t},e.prototype.onListScroll=function(t){var i={originalEvent:t,scrollDirection:"Bottom",distanceY:this.element.scrollHeight-this.element.scrollTop},r=this.element.scrollTop;r>this.previousScrollTop?(i.scrollDirection="Bottom",i.distanceY=this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop,this.trigger("scroll",i)):this.previousScrollTop>r&&(i.scrollDirection="Top",i.distanceY=this.element.scrollTop,this.trigger("scroll",i)),this.previousScrollTop=r},e.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition","selectedId"])},Gt([S("")],e.prototype,"cssClass",void 0),Gt([S(!1)],e.prototype,"enableVirtualization",void 0),Gt([S({})],e.prototype,"htmlAttributes",void 0),Gt([S(!0)],e.prototype,"enable",void 0),Gt([S([])],e.prototype,"dataSource",void 0),Gt([S()],e.prototype,"query",void 0),Gt([Ee(Et.defaultMappedFields,Z9)],e.prototype,"fields",void 0),Gt([S({effect:"SlideLeft",duration:400,easing:"ease"})],e.prototype,"animation",void 0),Gt([S("None")],e.prototype,"sortOrder",void 0),Gt([S(!1)],e.prototype,"showIcon",void 0),Gt([S(!1)],e.prototype,"showCheckBox",void 0),Gt([S("Left")],e.prototype,"checkBoxPosition",void 0),Gt([S("")],e.prototype,"headerTitle",void 0),Gt([S(!1)],e.prototype,"showHeader",void 0),Gt([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),Gt([S("")],e.prototype,"height",void 0),Gt([S("")],e.prototype,"width",void 0),Gt([S(null)],e.prototype,"template",void 0),Gt([S(null)],e.prototype,"headerTemplate",void 0),Gt([S(null)],e.prototype,"groupTemplate",void 0),Gt([_()],e.prototype,"select",void 0),Gt([_()],e.prototype,"actionBegin",void 0),Gt([_()],e.prototype,"actionComplete",void 0),Gt([_()],e.prototype,"actionFailure",void 0),Gt([_()],e.prototype,"scroll",void 0),e=Gt([Ot],e),e}(Pi),Tb=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ai=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},mm="enter",DS="escape",Qi="e-focused",gm="e-menu-header",ki="e-selected",ym="e-separator",Uu="uparrow",ua="downarrow",bh="leftarrow",bo="rightarrow",_u="home",bm="end",Cm="tab",GN="e-caret",Wu="e-menu-item",AS="e-disabled",Sm="e-menu-hide",$N="e-icons",NS="e-rtl",qu="e-menu-popup",J9="Template",Vz=function(s){Tb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ai([S("id")],e.prototype,"itemId",void 0),ai([S("parentId")],e.prototype,"parentId",void 0),ai([S("text")],e.prototype,"text",void 0),ai([S("iconCss")],e.prototype,"iconCss",void 0),ai([S("url")],e.prototype,"url",void 0),ai([S("separator")],e.prototype,"separator",void 0),ai([S("items")],e.prototype,"children",void 0),e}(ke),ef=function(s){Tb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ai([S(null)],e.prototype,"iconCss",void 0),ai([S("")],e.prototype,"id",void 0),ai([S(!1)],e.prototype,"separator",void 0),ai([ii([],e)],e.prototype,"items",void 0),ai([S("")],e.prototype,"text",void 0),ai([S("")],e.prototype,"url",void 0),e}(ke),eq=function(s){Tb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ai([S("SlideDown")],e.prototype,"effect",void 0),ai([S(400)],e.prototype,"duration",void 0),ai([S("ease")],e.prototype,"easing",void 0),e}(ke),Uz=function(s){Tb(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.navIdx=[],r.animation=new ri({}),r.isTapHold=!1,r.tempItem=[],r.showSubMenuOn="Auto",r}return e.prototype.preRender=function(){if(!this.isMenu){var t=void 0;if(this.element.tagName==="EJS-CONTEXTMENU"){t=this.createElement("ul",{id:mi(this.getModuleName()),className:"e-control e-lib e-"+this.getModuleName()});var i=ie("ej2_instances",this.element);te([this.element],["e-control","e-lib","e-"+this.getModuleName()]),this.clonedElement=this.element,this.element=t,kt("ej2_instances",i,this.element)}else{t=this.createElement("ul",{id:mi(this.getModuleName())}),Ut([].slice.call(this.element.cloneNode(!0).children),t);var r=this.element.nextElementSibling;r?this.element.parentElement.insertBefore(t,r):this.element.parentElement.appendChild(t),this.clonedElement=t}this.clonedElement.style.display="none"}if(this.element.tagName==="EJS-MENU"){for(var n=this.element,a=ie("ej2_instances",n),t=this.createElement("ul"),o=this.createElement("EJS-MENU",{className:"e-"+this.getModuleName()+"-wrapper"}),l=0,h=n.attributes.length;l<h;l++)t.setAttribute(n.attributes[l].nodeName,n.attributes[l].nodeValue);n.parentNode.insertBefore(o,n),ne(n),n=t,o.appendChild(n),kt("ej2_instances",a,n),this.clonedElement=o,this.element=n,this.element.id||(this.element.id=mi(this.getModuleName()))}},e.prototype.render=function(){var t=this;this.initialize(),this.renderItems(),this.wireEvents(),this.renderComplete();var i=this.getWrapper();this.template&&this.enableScrolling&&(this.isReact||this.isAngular)&&requestAnimationFrame(function(){yo(t.createElement,i,t.element,"hscroll",t.enableRtl)})},e.prototype.initialize=function(){var t=this.getWrapper();t||(t=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.isMenu?this.element.parentElement.insertBefore(t,this.element):document.body.appendChild(t)),this.cssClass&&Q([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.enableRtl&&t.classList.add(NS),t.appendChild(this.element),this.isMenu&&this.hamburgerMode&&(this.target||this.createHeaderContainer(t)),this.defaultOption=this.showItemOnClick},e.prototype.renderItems=function(){if(!this.items.length){var t=Et.createJsonFromElement(this.element,{fields:{child:"items"}});this.setProperties({items:t},!0),this.element.innerHTML=""}var i=this.createItems(this.items);if(Ut(Array.prototype.slice.call(i.children),this.element),this.element.classList.add("e-menu-parent"),this.isMenu){if(!this.hamburgerMode&&this.element.classList.contains("e-vertical")&&this.setBlankIconStyle(this.element),this.enableScrolling){var r=this.getWrapper();this.element.classList.contains("e-vertical")?yo(this.createElement,r,this.element,"vscroll",this.enableRtl):yo(this.createElement,r,this.element,"hscroll",this.enableRtl)}}else this.element.parentElement.setAttribute("role","dialog"),this.element.parentElement.setAttribute("aria-label","context menu")},e.prototype.wireEvents=function(){var t=this.getWrapper();if(this.target){for(var i=void 0,r=ze(this.target),n=0,a=r.length;n<a;n++)i=r[n],this.isMenu?I.add(i,"click",this.menuHeaderClickHandler,this):B.isIos?new Pn(i,{tapHold:this.touchHandler.bind(this)}):I.add(i,"contextmenu",this.cmenuHandler,this);if(this.targetElement=i,!this.isMenu){I.add(this.targetElement,"mousewheel DOMMouseScroll",this.scrollHandler,this);for(var o=0,l=DM(this.targetElement);o<l.length;o++){var h=l[o];I.add(h,"mousewheel DOMMouseScroll",this.scrollHandler,this)}}}B.isDevice||(this.delegateMoverHandler=this.moverHandler.bind(this),this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),I.add(this.isMenu?document:t,"mouseover",this.delegateMoverHandler,this),I.add(document,"mousedown",this.delegateMouseDownHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),I.add(document,"click",this.delegateClickHandler,this),this.wireKeyboardEvent(t),this.rippleFn=yr(t,{selector:"."+Wu})},e.prototype.wireKeyboardEvent=function(t){var i={downarrow:ua,uparrow:Uu,enter:mm,leftarrow:bh,rightarrow:bo,escape:DS};this.isMenu&&(i.home=_u,i.end=bm,i.tab=Cm),new wr(t,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:i})},e.prototype.mouseDownHandler=function(t){U(t.target,".e-"+this.getModuleName()+"-wrapper")!==this.getWrapper()&&!U(t.target,".e-"+this.getModuleName()+"-popup")&&this.closeMenu(this.isMenu?null:this.navIdx.length,t)},e.prototype.keyHandler=function(t){(t.keyCode===38||t.keyCode===40)&&t.target&&(t.target.classList.contains("e-contextmenu")||t.target.classList.contains("e-menu-item"))&&t.preventDefault()},e.prototype.keyBoardHandler=function(t){var i="",r=t.target,n=this.isMenu&&!this.hamburgerMode&&!this.element.classList.contains("e-vertical")&&this.navIdx.length<1;if(t.preventDefault(),this.enableScrolling&&t.keyCode===13&&r.classList.contains("e-scroll-nav")&&this.removeLIStateByClass([Qi,ki],[U(r,".e-"+this.getModuleName()+"-wrapper")]),n)switch(t.action){case bo:i=bo,t.action=ua;break;case bh:i=bh,t.action=Uu;break;case ua:i=ua,t.action=bo;break;case Uu:i=Uu,t.action="";break}else if(this.enableRtl)switch(t.action){case bh:n=!0,i=bh,t.action=bo;break;case bo:n=!0,i=bo,t.action=bh;break}switch(t.action){case ua:case Uu:case bm:case _u:case Cm:this.upDownKeyHandler(t);break;case bo:this.rightEnterKeyHandler(t);break;case bh:this.leftEscKeyHandler(t);break;case mm:this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(t):this.rightEnterKeyHandler(t);break;case DS:this.leftEscKeyHandler(t);break}n&&(t.action=i)},e.prototype.upDownKeyHandler=function(t){var i=this.getUlByNavIdx(),r=t.action===ua||t.action===_u||t.action===Cm?0:i.childElementCount-1,n=r,a=this.getLIByClass(i,Qi);a&&(t.action!==bm&&t.action!==_u&&(n=this.getIdx(i,a)),a.classList.remove(Qi),t.action!==bm&&t.action!==_u&&(t.action===ua?n++:n--,n===(t.action===ua?i.childElementCount:-1)&&(n=r)));var o=i.children[n];n=this.isValidLI(o,n,t.action),i.children[n].classList.add(Qi),i.children[n].focus()},e.prototype.isValidLI=function(t,i,r){var n=this.getUlByNavIdx(),a=r===ua||r===_u||r===Cm?0:n.childElementCount-1;return(t.classList.contains(ym)||t.classList.contains(AS)||t.classList.contains(Sm))&&(r===ua&&i===n.childElementCount-1||r===Uu&&i===0?i=a:r===ua||r===bo?i++:i--),t=n.children[i],(t.classList.contains(ym)||t.classList.contains(AS)||t.classList.contains(Sm))&&(i=this.isValidLI(t,i,r)),i},e.prototype.getUlByNavIdx=function(t){var i=this;if(t===void 0&&(t=this.navIdx.length),this.isMenu){var r=[this.getWrapper()].concat([].slice.call(ze("."+qu)))[t],n=[],a=ze("."+qu);return a.forEach(function(o){(i.element.id===o.id.split("-")[2]||o.id.split("-")[2]+"-"+o.id.split("-")[3])&&n.push(o)}),r=[this.getWrapper()].concat([].slice.call(n))[t],m(r)?null:$(".e-menu-parent",r)}else return this.getWrapper().children[t]},e.prototype.rightEnterKeyHandler=function(t){var i,r=this.getUlByNavIdx(),n=this.getLIByClass(r,Qi);if(n){var a=this.getIdx(r,n),o=this.navIdx.concat(a),l=this.getItem(o);if(l.items.length)this.navIdx.push(a),this.keyType="right",this.action=t.action,this.openMenu(n,l,-1,-1,t);else if(t.action===mm){this.isMenu&&this.navIdx.length===0?this.removeLIStateByClass([ki],[this.getWrapper()]):n.classList.remove(Qi),n.classList.add(ki),i={element:n,item:l,event:t},this.trigger("select",i);var h=n.querySelector(".e-menu-url");if(l.url&&h)switch(h.getAttribute("target")){case"_blank":window.open(l.url,"_blank");break;case"_parent":window.parent.location.href=l.url;break;default:window.location.href=l.url}this.closeMenu(null,t);var u=this.getLIByClass(this.getUlByNavIdx(),ki);u&&(u.classList.add(Qi),u.focus())}}},e.prototype.leftEscKeyHandler=function(t){this.navIdx.length?(this.keyType="left",this.closeMenu(this.navIdx.length,t)):t.action===DS&&this.closeMenu(null,t)},e.prototype.scrollHandler=function(t){this.closeMenu(null,t)},e.prototype.touchHandler=function(t){this.isTapHold=!0,this.cmenuHandler(t.originalEvent)},e.prototype.cmenuHandler=function(t){t.preventDefault(),this.currentTarget=t.target,this.isCMenu=!0,this.pageX=t.changedTouches?t.changedTouches[0].pageX+1:t.pageX+1,this.pageY=t.changedTouches?t.changedTouches[0].pageY+1:t.pageY+1,this.closeMenu(null,t),this.isCMenu&&(this.canOpen(t.target)&&this.openMenu(null,null,this.pageY,this.pageX,t),this.isCMenu=!1)},e.prototype.closeMenu=function(t,i,r){var n=this;if(t===void 0&&(t=0),i===void 0&&(i=null),this.isMenuVisible()){var a=void 0,o,l=this.getWrapper(),h=void 0,u,c=this.getPopups(),d=!1,p=this.isMenu?c.length+1:l.childElementCount,f=this.isMenu&&p!==1?$(".e-ul",c[p-2]):ze(".e-menu-parent",l)[p-1];if(this.isMenu&&f.classList.contains("e-menu")&&(a=this.getLIByClass(f,ki),a&&a.classList.remove(ki),d=!0),!d){var v=i&&i.target&&this.getLI(i.target);v?this.cli=v:this.cli=f.children[0],o=this.navIdx.length?this.getItem(this.navIdx):null,u=o?o.items:this.items,h={element:f,parentItem:o,items:u,event:i,cancel:!1,isFocused:!0},this.trigger("beforeClose",h,function(g){var b,y,C="",x,w=!g.cancel;(w||n.isCMenu)&&(n.isMenu?(b=U(f,"."+qu),n.hamburgerMode&&(b.parentElement.style.minHeight="",U(f,".e-menu-item").setAttribute("aria-expanded","false")),n.unWireKeyboardEvent(b),Vu(Ln(b.children[0],Dc),b.children[0]),x=Ln(b,za),x.hide(),C=b.id,x.destroy(),ne(b)):n.toggleAnimation(f,!1),y={element:f,parentItem:o,items:u},n.trigger("onClose",y),n.navIdx.pop(),n.navIdx.length===0&&(n.showSubMenu=!1),n.isMenu||(I.remove(f,"keydown",n.keyHandler),n.keyType==="right"&&(n.keyType=""))),n.updateReactTemplate();var M,E,T,D=n.getWrapper()&&n.getUlByNavIdx();n.isCMenu&&(n.canOpen(i.target)&&n.openMenu(null,null,n.pageY,n.pageX,i),n.isCMenu=!1),n.isMenu&&D&&C.length?(M=new RegExp("(.*)-ej2menu-"+n.element.id+"-popup").exec(C)[1],E=D.querySelector('[id="'+M+'"]'),T=v&&D.querySelector('[id="'+v.id+'"]')):D&&(E=D.querySelector(".e-menu-item.e-selected"),T=v&&D.querySelector('[id="'+v.id+'"]'));var N=v&&v.querySelectorAll(".e-menu-item");if(w&&n.hamburgerMode&&t&&!N.length)n.afterCloseMenu(i);else if(w&&!n.hamburgerMode&&E&&!T&&n.keyType!=="left"&&(n.navIdx.length||!n.isMenu&&n.navIdx.length===0)){var A=i&&(i.target.classList.contains("e-vscroll")||i.target.classList.contains("e-scroll-nav"))?U(i.target,".e-menu-wrapper"):null;A?(A=A.querySelector(".e-menu-item"),(n.showItemOnClick||A&&n.getIndex(A.id,!0).length<=n.navIdx.length)&&n.closeMenu(n.navIdx[n.navIdx.length-1],i,!0)):i&&i.target.classList.contains("e-nav-arrow")||n.closeMenu(n.navIdx[n.navIdx.length-1],i)}else if(w&&!r&&!t&&(n.hamburgerMode&&n.navIdx.length||n.navIdx.length===1&&v&&D!==v.parentElement))n.closeMenu(null,i);else if(w&&m(t)&&n.navIdx.length)n.closeMenu(null,i);else if(w&&!n.isMenu&&!t&&n.navIdx.length===0&&!n.isMenusClosed)n.isMenusClosed=!0,n.closeMenu(0,i);else if(w&&n.isMenu&&i&&i.target&&n.navIdx.length!==0&&U(i.target,".e-menu-parent.e-control"))n.closeMenu(0,i);else if(w&&!n.isMenu&&ze(".e-menu-parent",l)[t-1]&&i.which===3)n.closeMenu(null,i);else{if(w&&(n.keyType==="right"||n.keyType==="click"))n.afterCloseMenu(i);else{var L=n.getUlByNavIdx(),k=n.getLIByClass(L,ki);if(k&&(k.setAttribute("aria-expanded","false"),k.classList.remove(ki),(g.isFocused&&v||n.keyType==="left")&&(k.classList.add(Qi),(!i.target||!i.target.classList.contains("e-edit-template"))&&k.focus())),!w&&n.hamburgerMode&&v&&v.getAttribute("aria-expanded")==="false"&&v.getAttribute("aria-haspopup")==="true"){U(v,".e-menu-parent.e-control")?n.navIdx=[]:n.navIdx.pop(),n.navIdx.push(n.cliIdx);var O=n.getItem(n.navIdx);v.setAttribute("aria-expanded","true"),n.openMenu(v,O,-1,-1,i)}}n.navIdx.length<1&&(n.showSubMenuOn==="Hover"||n.showSubMenuOn==="Click")&&(n.showItemOnClick=n.defaultOption,n.showSubMenuOn="Auto")}n.removeStateWrapper()})}}},e.prototype.updateReactTemplate=function(){if(this.isReact&&this.template&&this.navIdx.length===0){var t=this.portals.splice(0,this.items.length);this.clearTemplate(["template"]),this.portals=t,this.renderReactTemplates()}},e.prototype.getMenuItemModel=function(t,i){if(m(t))return null;m(i)&&(i=0);var r=this.getFields(i);return{text:t[r.text],id:t[r.id],items:t[r.child],separator:t[r.separator],iconCss:t[r.iconCss],url:t[r.url]}},e.prototype.getPopups=function(){var t=this,i=[];return[].slice.call(document.querySelectorAll("."+qu)).forEach(function(r){!m(r.querySelector("."+Wu))&&t.getIndex(r.querySelector("."+Wu).id,!0).length&&i.push(r)}),i},e.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&or(this.element).valueOf()},e.prototype.canOpen=function(t){var i=!0;if(this.filter){i=!1;for(var r=this.filter.split(" "),n=0,a=r.length;n<a;n++)if(U(t,"."+r[n])){i=!0;break}}return i},e.prototype.openMenu=function(t,i,r,n,a,o){var l=this;r===void 0&&(r=0),n===void 0&&(n=0),a===void 0&&(a=null),o===void 0&&(o=this.targetElement);var h=this.getWrapper();this.lItem=t;var u=this.element.id!==""?this.element.id:"menu";if(this.isMenusClosed=!1,m(r)&&(r=-1),m(n)&&(n=-1),t){if(this.uList=this.createItems(i[this.getField("children",this.navIdx.length-1)]),!this.isMenu&&B.isDevice){h.lastChild.style.display="none";var c={text:i[this.getField("text")].toString(),iconCss:$N+" e-previous"},d=new ef(this.items[0],"items",c,!0),p=this.createItems([d]).children[0];p.classList.add(gm),this.uList.insertBefore(p,this.uList.children[0])}this.isMenu?(this.popupWrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper "+qu,id:t.id+"-ej2menu-"+u+"-popup"}),this.hamburgerMode?(r=t.offsetHeight,t.appendChild(this.popupWrapper)):document.body.appendChild(this.popupWrapper),this.isNestedOrVertical=this.element.classList.contains("e-vertical")||this.navIdx.length!==1,this.popupObj=this.generatePopup(this.popupWrapper,this.uList,t,this.isNestedOrVertical),this.template&&this.renderReactTemplates(),this.hamburgerMode?this.calculateIndentSize(this.uList,t):(this.cssClass&&Q([this.popupWrapper],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.popupObj.hide()),!this.hamburgerMode&&!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(t,l.uList,i,a,0,0,"menu")},this.hoverDelay)):this.triggerBeforeOpen(t,this.uList,i,a,0,0,"menu")):(this.uList.style.zIndex=this.element.style.zIndex,h.appendChild(this.uList),!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(t,l.uList,i,a,r,n,"none")},this.hoverDelay)):this.triggerBeforeOpen(t,this.uList,i,a,r,n,"none"))}else if(this.uList=this.element,this.uList.style.zIndex=bu(o||this.element).toString(),m(a)){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!1);var v=this.copyObject(f,{});v.target=v.srcElement=o,v.currentTarget=o,this.triggerBeforeOpen(t,this.uList,i,v,r,n,"none")}else this.triggerBeforeOpen(t,this.uList,i,a,r,n,"none")},e.prototype.copyObject=function(t,i){for(var r in t)i[""+r]=t[""+r];return i},e.prototype.calculateIndentSize=function(t,i){var r=getComputedStyle(i),n=parseInt(r.textIndent,10);this.navIdx.length<2&&!i.classList.contains("e-blankicon")?n*=2:n+=n/4,t.style.textIndent=n+"px";var a=t.querySelectorAll(".e-blankicon");if(a&&a.length)for(var o=t.querySelector(".e-menu-icon"),l=getComputedStyle(o),h=parseInt(l.marginRight,10)+o.offsetWidth+n,u=0;u<a.length;u++)a[u].style.textIndent=h+"px"},e.prototype.generatePopup=function(t,i,r,n){var a=this,o=new za(t,{actionOnScroll:this.hamburgerMode?"none":"reposition",relateTo:r,collision:this.hamburgerMode?{X:"none",Y:"none"}:{X:n||this.enableRtl?"none":"flip",Y:"fit"},position:n&&!this.hamburgerMode?{X:"right",Y:"top"}:{X:"left",Y:"bottom"},targetType:"relative",enableRtl:this.enableRtl,content:i,open:function(){var l=$(".e-menu-vscroll",o.element);l&&(l.style.height="inherit",l.style.maxHeight="");var h=$(".e-ul",o.element);o.element.style.maxHeight="",h.focus(),a.triggerOpen(h)}});return o},e.prototype.createHeaderContainer=function(t){t=t||this.getWrapper();var i=this.createElement("span",{className:"e-"+this.getModuleName()+"-header"}),r=this.enableHtmlSanitizer?Fi.sanitize(this.title):this.title,n=this.createElement("span",{className:"e-"+this.getModuleName()+"-title",innerHTML:r}),a=this.createElement("span",{className:"e-icons e-"+this.getModuleName()+"-icon",attrs:{tabindex:"0"}});i.appendChild(n),i.appendChild(a),t.insertBefore(i,this.element)},e.prototype.openHamburgerMenu=function(t){this.hamburgerMode&&this.triggerBeforeOpen(null,this.element,null,t,0,0,"hamburger")},e.prototype.closeHamburgerMenu=function(t){var i=this,r={element:this.element,parentItem:null,event:t,items:this.items,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.closeMenu(null,t),i.element.classList.add("e-hide-menu"),i.trigger("onClose",{element:i.element,parentItem:null,items:i.items}))})},e.prototype.callFit=function(t,i,r,n,a){return AI(t,null,{X:i,Y:r},{top:n,left:a})},e.prototype.triggerBeforeOpen=function(t,i,r,n,a,o,l){var h=this,u=t?r[this.getField("children",this.navIdx.length-1)]:this.items,c={element:i,items:u,parentItem:r,event:n,cancel:!1,top:a,left:o,showSubMenuOn:"Auto"},d=l;this.trigger("beforeOpen",c,function(p){switch(d){case"menu":h.hamburgerMode||(p.showSubMenuOn!=="Auto"&&(h.showItemOnClick=!h.defaultOption,h.showSubMenuOn=p.showSubMenuOn),h.top=p.top,h.left=p.left),h.popupWrapper.style.display="block",h.hamburgerMode||(h.popupWrapper.style.maxHeight=h.popupWrapper.getBoundingClientRect().height+"px",h.enableScrolling&&yo(h.createElement,h.popupWrapper,h.uList,"vscroll",h.enableRtl),h.checkScrollOffset(n)),!h.hamburgerMode&&!h.left&&!h.top?(h.popupObj.refreshPosition(h.lItem,!0),h.left=parseInt(h.popupWrapper.style.left,10),h.top=parseInt(h.popupWrapper.style.top,10),h.enableRtl&&(h.left=h.isNestedOrVertical?h.left-h.popupWrapper.offsetWidth-h.lItem.parentElement.offsetWidth+2:h.left-h.popupWrapper.offsetWidth+h.lItem.offsetWidth),h.template&&(h.isReact||h.isAngular)?requestAnimationFrame(function(){h.collision(),h.popupWrapper.style.display=""}):(h.collision(),h.popupWrapper.style.display="")):(h.popupObj.collision={X:"none",Y:"none"},h.popupWrapper.style.display="");break;case"none":h.top=p.top,h.left=p.left;break;case"hamburger":p.cancel||(h.element.classList.remove("e-hide-menu"),h.triggerOpen(h.element));break}if(d!=="hamburger")if(p.cancel)h.isMenu?(h.popupObj.destroy(),ne(h.popupWrapper)):i.className.indexOf("e-ul")>-1&&ne(i),h.navIdx.pop();else if(h.isMenu)if(h.hamburgerMode)h.popupWrapper.style.top=h.top+"px",h.popupWrapper.style.left="0px",h.toggleAnimation(h.popupWrapper);else{h.setBlankIconStyle(h.popupWrapper),h.wireKeyboardEvent(h.popupWrapper),yr(h.popupWrapper,{selector:"."+Wu}),h.popupWrapper.style.left=h.left+"px",h.popupWrapper.style.top=h.top+"px";var f=h.animationSettings.effect!=="None"?{name:h.animationSettings.effect,duration:h.animationSettings.duration,timingFunction:h.animationSettings.easing}:null;h.popupObj.show(f,h.lItem)}else h.setBlankIconStyle(h.uList),h.setPosition(h.lItem,h.uList,h.top,h.left),h.toggleAnimation(h.uList);if(h.keyType==="right"){var v=h.getUlByNavIdx();if(t.classList.remove(Qi),h.isMenu&&h.navIdx.length===1&&h.removeLIStateByClass([ki],[h.getWrapper()]),t.classList.add(ki),h.action===mm){var g={element:t,item:r,event:n};h.trigger("select",g)}t.focus(),v=h.getUlByNavIdx();var b=h.isValidLI(v.children[0],0,h.action);v.children[b].classList.add(Qi),v.children[b].focus()}})},e.prototype.collision=function(){var t;if(t=Qa(this.popupWrapper,null,this.left,this.top),(this.isNestedOrVertical||this.enableRtl)&&(t.indexOf("right")>-1||t.indexOf("left")>-1)){this.popupObj.collision.X="none";var i=U(this.lItem,".e-"+this.getModuleName()+"-wrapper").offsetWidth;this.left=this.enableRtl?Fr(this.lItem,this.isNestedOrVertical?"right":"left","top").left:this.left-this.popupWrapper.offsetWidth-i+2}t=Qa(this.popupWrapper,null,this.left,this.top),(t.indexOf("left")>-1||t.indexOf("right")>-1)&&(this.left=this.callFit(this.popupWrapper,!0,!1,this.top,this.left).left),this.popupWrapper.style.left=this.left+"px"},e.prototype.setBlankIconStyle=function(t){var i=[].slice.call(t.getElementsByClassName("e-blankicon"));if(i.length){var r=t.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)");if(r){var n=r.querySelector(".e-menu-icon");if(n){var a=this.enableRtl?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},o=getComputedStyle(n),l=parseInt(o.fontSize,10);parseInt(o.width,10)&&parseInt(o.width,10)>l&&(l=parseInt(o.width,10));var h=l+parseInt(o[a.margin],10)+parseInt(getComputedStyle(r)[a.padding],10)+"px";i.forEach(function(u){u.style[a.padding]=h})}}}},e.prototype.checkScrollOffset=function(t){var i=this.getWrapper();if(i.children[0].classList.contains("e-menu-hscroll")&&this.navIdx.length===1){var r=m(t)?this.element:U(t.target,"."+Wu),n=$(".e-hscroll-bar",i);n.scrollLeft>r.offsetLeft&&(n.scrollLeft-=n.scrollLeft-r.offsetLeft);var a=n.scrollLeft+n.offsetWidth,o=r.offsetLeft+r.offsetWidth;a<o&&(n.scrollLeft+=o-a)}},e.prototype.setPosition=function(t,i,r,n){var a="px";if(this.toggleVisiblity(i),i===this.element||n>-1&&r>-1){var o=Qa(i,null,n,r);if(o.indexOf("right")>-1&&(n=n-i.offsetWidth),o.indexOf("bottom")>-1){var l=this.callFit(i,!1,!0,r,n);if(r=l.top-20,r<0){var h=pageYOffset+document.documentElement.clientHeight-i.getBoundingClientRect().height;h>-1&&(r=h)}}if(o=Qa(i,null,n,r),o.indexOf("left")>-1){var l=this.callFit(i,!0,!1,r,n);n=l.left}}else if(B.isDevice)r=Number(this.element.style.top.replace(a,"")),n=Number(this.element.style.left.replace(a,""));else{var u=this.enableRtl?"left":"right",l=Fr(t,u,"top");r=l.top,n=l.left;var o=Qa(i,null,this.enableRtl?n-i.offsetWidth:n,r),c=o.indexOf("left")>-1||o.indexOf("right")>-1;c&&(l=Fr(t,this.enableRtl?"right":"left","top"),n=l.left),(this.enableRtl||c)&&(n=this.enableRtl&&c?n:n-i.offsetWidth),o.indexOf("bottom")>-1&&(l=this.callFit(i,!1,!0,r,n),r=l.top)}this.toggleVisiblity(i,!1),i.style.top=r+a,i.style.left=n+a},e.prototype.toggleVisiblity=function(t,i){i===void 0&&(i=!0),t.style.visibility=i?"hidden":"",t.style.display=i?"block":"none"},e.prototype.createItems=function(t){var i=this,r=this.navIdx?this.navIdx.length:0,n=this.getFields(r),a=this.hasField(t,this.getField("iconCss",r)),o={showIcon:a,moduleName:"menu",fields:n,template:this.template,itemNavigable:!0,itemCreating:function(h){h.curData[h.fields[n.id]]||(h.curData[h.fields[n.id]]=mi("menuitem")),m(h.curData.htmlAttributes)&&(h.curData.htmlAttributes={}),B.isIE?(h.curData.htmlAttributes.role="menuitem",h.curData.htmlAttributes.tabindex="-1"):Object.assign(h.curData.htmlAttributes,{role:"menuitem",tabindex:"-1"}),i.isMenu&&!h.curData[i.getField("separator",r)]&&(h.curData.htmlAttributes["aria-label"]=h.curData[h.fields.text]?h.curData[h.fields.text]:h.curData[h.fields.id]),h.curData[h.fields[n.iconCss]]===""&&(h.curData[h.fields[n.iconCss]]=null)},itemCreated:function(h){if(h.curData[i.getField("separator",r)]&&(h.item.classList.add(ym),h.item.setAttribute("role","separator")),a&&!h.curData[h.fields.iconCss]&&!h.curData[i.getField("separator",r)]&&h.item.classList.add("e-blankicon"),h.curData[h.fields.child]&&h.curData[h.fields.child].length){var u=i.createElement("span",{className:$N+" "+GN});h.item.appendChild(u),h.item.setAttribute("aria-haspopup","true"),h.item.setAttribute("aria-expanded","false"),h.item.classList.add("e-menu-caret-icon")}i.isMenu&&i.template&&(h.item.setAttribute("id",h.curData[h.fields.id].toString()),h.item.removeAttribute("data-uid"),h.item.classList.contains("e-level-1")&&h.item.classList.remove("e-level-1"),h.item.classList.contains("e-has-child")&&h.item.classList.remove("e-has-child"),h.item.removeAttribute("aria-level"));var c={item:h.curData,element:h.item};i.trigger("beforeItemRender",c)}};this.setProperties({items:this.items},!0),this.isMenu&&(o.templateID=this.element.id+J9);var l=Et.createList(this.createElement,t,o,!this.template,this);return l.setAttribute("tabindex","0"),this.isMenu?l.setAttribute("role","menu"):l.setAttribute("role","menubar"),l},e.prototype.moverHandler=function(t){var i=t.target;this.liTrgt=i;var r=this.getLI(i),n=r?U(r,".e-"+this.getModuleName()+"-wrapper"):this.getWrapper(),a=this.getWrapper(),o=new RegExp("-ej2menu-(.*)-popup"),l,h=!1;if(n){if(n.id!==""?l=o.exec(n.id)[1]:l=n.querySelector("ul").id,l!==this.element.id)if(this.removeLIStateByClass([Qi,ki],[this.getWrapper()]),this.navIdx.length)h=!0;else return;r&&U(r,".e-"+this.getModuleName()+"-wrapper")&&!h?(this.removeLIStateByClass([Qi],this.isMenu?[n].concat(this.getPopups()):[n]),this.removeLIStateByClass([Qi],this.isMenu?[a].concat(this.getPopups()):[a]),r.classList.add(Qi),this.showItemOnClick||this.clickHandler(t)):this.isMenu&&this.showItemOnClick&&!h&&this.removeLIStateByClass([Qi],[n].concat(this.getPopups())),this.isMenu&&(!this.showItemOnClick&&i.parentElement!==n&&!U(i,".e-"+this.getModuleName()+"-popup")&&(!r||r&&!this.getIndex(r.id,!0).length)&&this.showSubMenuOn!=="Hover"?(this.removeLIStateByClass([Qi],[n]),this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,t))):h&&!this.showItemOnClick&&this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,t)),this.isClosed||this.removeStateWrapper(),this.isClosed=!1)}},e.prototype.removeStateWrapper=function(){if(this.liTrgt){var t=U(this.liTrgt,".e-menu-vscroll");this.liTrgt.tagName==="DIV"&&t&&this.removeLIStateByClass([Qi,ki],[t])}},e.prototype.removeLIStateByClass=function(t,i){for(var r,n=function(o){t.forEach(function(l){r=$("."+l,i[o]),r&&r.classList.remove(l)})},a=0;a<i.length;a++)n(a)},e.prototype.getField=function(t,i){i===void 0&&(i=0);var r=this.fields[""+t];return typeof r=="string"?r:r[i]?r[i].toString():r[r.length-1].toString()},e.prototype.getFields=function(t){return t===void 0&&(t=0),{id:this.getField("itemId",t),iconCss:this.getField("iconCss",t),text:this.getField("text",t),url:this.getField("url",t),child:this.getField("children",t),separator:this.getField("separator",t)}},e.prototype.hasField=function(t,i){for(var r=0,n=t.length;r<n;r++)if(t[r][""+i])return!0;return!1},e.prototype.menuHeaderClickHandler=function(t){U(t.target,".e-menu-wrapper").querySelector("ul.e-menu-parent").id===this.element.id&&(this.element.className.indexOf("e-hide-menu")>-1?this.openHamburgerMenu(t):this.closeHamburgerMenu(t))},e.prototype.clickHandler=function(t){if(this.isTapHold)this.isTapHold=!1;else{var i=this.getWrapper(),r=t.target,n=this.cli=this.getLI(r),a=new RegExp("-ej2menu-(.*)-popup"),o=n?U(n,".e-"+this.getModuleName()+"-wrapper"):null,l=n&&o&&(this.isMenu?this.getIndex(n.id,!0).length>0:i.firstElementChild.id===o.firstElementChild.id);if(B.isDevice&&this.isMenu&&(this.removeLIStateByClass([Qi],[i].concat(this.getPopups())),this.mouseDownHandler(t)),n&&o&&this.isMenu){var h=o.id?a.exec(o.id)[1]:o.querySelector(".e-menu-parent").id;if(this.element.id!==h)return}if(l&&t.type==="click"&&!n.classList.contains(gm)){this.setLISelected(n);var u=this.getIndex(n.id,!0),c=this.getItem(u),d={element:n,item:c,event:t};this.trigger("select",d)}if(l&&(t.type==="mouseover"||B.isDevice||this.showItemOnClick)){var p=void 0;if(n.classList.contains(gm)){p=i.children[this.navIdx.length-1],this.toggleAnimation(p);var f=this.getLIByClass(p,ki);f&&f.classList.remove(ki),ne(n.parentNode),this.navIdx.pop()}else if(!n.classList.contains(ym)){this.showSubMenu=!0;var v=n.parentNode;if(m(v))return;if(this.cliIdx=this.getIdx(v,n),this.isMenu||!B.isDevice){var g=this.isMenu?Array.prototype.indexOf.call([i].concat(this.getPopups()),U(v,".e-"+this.getModuleName()+"-wrapper")):this.getIdx(i,v);if(this.navIdx[g]===this.cliIdx&&(this.showSubMenu=!1),g!==this.navIdx.length&&(t.type!=="mouseover"||this.showSubMenu)){var f=this.getLIByClass(v,ki);f&&f.classList.remove(ki),this.isClosed=!0,this.keyType="click",this.showItemOnClick&&this.setLISelected(n),this.closeMenu(g+1,t),this.showItemOnClick&&this.setLISelected(n)}}this.isClosed||this.afterCloseMenu(t),this.isClosed=!1}}else if(this.isMenu&&r.tagName==="DIV"&&this.navIdx.length&&U(r,".e-menu-vscroll")){var b=U(r,"."+qu),y=Array.prototype.indexOf.call(this.getPopups(),b)+1;y<this.navIdx.length&&(this.closeMenu(y+1,t),b&&this.removeLIStateByClass([Qi,ki],[b]))}else this.isMenu&&this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(t):(r.tagName!=="UL"||(this.isMenu?r.parentElement.classList.contains("e-menu-wrapper")&&!this.getIndex(r.querySelector("."+Wu).id,!0).length:r.parentElement!==i))&&(n||this.removeLIStateByClass([ki],[i]),(!n||!n.querySelector("."+GN))&&this.closeMenu(null,t))}},e.prototype.afterCloseMenu=function(t){if(!m(t)){var i;if(this.showSubMenu){this.showItemOnClick&&this.navIdx.length===0?i=U(t.target,".e-menu-parent.e-control"):i=U(this.element,".e-menu-parent.e-control");var r=this.navIdx.concat(this.cliIdx),n=this.getItem(r);if(n&&n[this.getField("children",r.length-1)]&&n[this.getField("children",r.length-1)].length?((t.type==="mouseover"||B.isDevice&&this.isMenu)&&this.setLISelected(this.cli),(!this.hamburgerMode&&i||this.hamburgerMode&&this.cli.getAttribute("aria-expanded")==="false")&&(this.cli.setAttribute("aria-expanded","true"),this.navIdx.push(this.cliIdx),this.openMenu(this.cli,n,null,null,t))):t.type!=="mouseover"&&this.closeMenu(null,t),!i){var a=this.getUlByNavIdx(),o=this.getLIByClass(a,ki);o&&(o.setAttribute("aria-expanded","false"),o.classList.remove(ki))}}this.keyType=""}},e.prototype.setLISelected=function(t){var i=this.getLIByClass(t.parentElement,ki);i&&i.classList.remove(ki),this.isMenu||t.classList.remove(Qi),t.classList.add(ki)},e.prototype.getLIByClass=function(t,i){for(var r=0,n=t.children.length;r<n;r++)if(t.children[r].classList.contains(i))return t.children[r];return null},e.prototype.getItemIndex=function(t,i){var r;typeof t=="string"?r=t:r=t.id;var n=i!==!1,a=this.getIndex(r,n);return a},e.prototype.setItem=function(t,i,r){var n;r?n=i||t.id:n=i||t.text;var a=this.getIndex(n,r),o=this.getItem(a);Object.assign(o,t)},e.prototype.getItem=function(t){t=t.slice();var i=t.pop(),r=this.getItems(t);return r[i]},e.prototype.getItems=function(t){for(var i=this.items,r=0;r<t.length;r++)i=i[t[r]][this.getField("children",r)];return i},e.prototype.setItems=function(t,i){var r=this.getItems(i);r.splice(0,r.length);for(var n=0;n<t.length;n++)r.splice(n,0,t[n])},e.prototype.getIdx=function(t,i,r){r===void 0&&(r=!0);var n=Array.prototype.indexOf.call(t.children,i);return r&&t.children[0].classList.contains(gm)&&n--,n},e.prototype.getLI=function(t){return t.tagName==="LI"&&t.classList.contains("e-menu-item")?t:U(t,"li.e-menu-item")},e.prototype.updateItemsByNavIdx=function(){for(var t=this.items,i=0,r=0;r<this.navIdx.length&&(t=t[r].items,!!t);r++){i++;var n=this.getUlByNavIdx(i);if(!n)break;this.updateItem(n,t)}},e.prototype.removeChildElement=function(t){for(;t.firstElementChild;)t.removeChild(t.firstElementChild);return t},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=this.getWrapper(),a=function(c){switch(c){case"cssClass":i.cssClass&&te([n],i.cssClass.split(" ")),t.cssClass&&Q([n],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":o.enableRtl?n.classList.add(NS):n.classList.remove(NS);break;case"showItemOnClick":o.unWireEvents(),o.showItemOnClick=t.showItemOnClick,o.wireEvents();break;case"enableScrolling":if(t.enableScrolling){var d;o.element.classList.contains("e-vertical")?yo(o.createElement,n,o.element,"vscroll",o.enableRtl):yo(o.createElement,n,o.element,"hscroll",o.enableRtl),o.getPopups().forEach(function(x){d=$(".e-ul",x),yo(r.createElement,x,d,"vscroll",r.enableRtl)})}else{var p=n.children[0];o.element.classList.contains("e-vertical")?Vu(Ln(p,Dc),p):Vu(Ln(p,A0),p),n.style.overflow="",n.appendChild(o.element),o.getPopups().forEach(function(x){p=x.children[0],Vu(Ln(p,Dc),p),x.style.overflow=""})}break;case"items":{var f=void 0,v=void 0,g=void 0;if(o.isReact&&o.template&&o.clearTemplate(["template"]),Object.keys(i.items).length)for(var C=Object.keys(t.items),b=0;b<C.length;b++)v=o.getChangedItemIndex(t,[],Number(C[b])),v.length<=o.getWrapper().children.length&&(f=v.pop(),g=o.getItems(v),o.insertAfter([g[f]],g[f].text),o.removeItem(g,v,f),o.setItems(g,v)),v.length=0;else{if(o.updateItem(o.element,o.items),o.enableScrolling&&o.element.parentElement.classList.contains("e-custom-scroll")&&(o.element.classList.contains("e-vertical")?yo(o.createElement,n,o.element,"vscroll",o.enableRtl):yo(o.createElement,n,o.element,"hscroll",o.enableRtl)),!o.hamburgerMode)for(var b=1,y=n.childElementCount;b<y;b++)ne(n.lastElementChild);o.navIdx=[]}break}}},o=this,l=0,h=Object.keys(t);l<h.length;l++){var u=h[l];a(u)}},e.prototype.updateItem=function(t,i){{if(this.enableScrolling){var r=this.getWrapper(),n=r.children[0];this.element.classList.contains("e-vertical")?Vu(Ln(n,Dc),n):Vu(Ln(n,A0),n)}t.innerHTML=""}var a=[].slice.call(this.createItems(i).children);a.forEach(function(o){t.appendChild(o)})},e.prototype.getChangedItemIndex=function(t,i,r){i.push(r);var n=Object.keys(t.items[r]).pop();if(n==="items"){var a=t.items[r],o=Object.keys(a.items).pop();o&&this.getChangedItemIndex(a,i,Number(o))}else n==="isParentArray"&&i.length>1&&i.pop();return i},e.prototype.removeItem=function(t,i,r){t.splice(r,1);var n=this.getWrapper().children;i.length<n.length&&ne(n[i.length].children[r])},e.prototype.unWireEvents=function(t){t===void 0&&(t=this.target);var i=this.getWrapper();if(t){for(var r=void 0,n=void 0,a=ze(t),o=0,l=a.length;o<l;o++)r=a[o],this.isMenu?I.remove(r,"click",this.menuHeaderClickHandler):B.isIos?(n=Ln(r,Pn),n&&n.destroy()):I.remove(r,"contextmenu",this.cmenuHandler);if(!this.isMenu){I.remove(this.targetElement,"mousewheel DOMMouseScroll",this.scrollHandler);for(var h=0,u=DM(this.targetElement);h<u.length;h++){var c=u[h];I.remove(c,"mousewheel DOMMouseScroll",this.scrollHandler)}}}B.isDevice||(I.remove(this.isMenu?document:i,"mouseover",this.delegateMoverHandler),I.remove(document,"mousedown",this.delegateMouseDownHandler)),I.remove(document,"click",this.delegateClickHandler),this.unWireKeyboardEvent(i),this.rippleFn()},e.prototype.unWireKeyboardEvent=function(t){var i=Ln(t,wr);i&&i.destroy()},e.prototype.toggleAnimation=function(t,i){var r=this;i===void 0&&(i=!0);var n,a;this.animationSettings.effect==="None"||!i?this.end(t,i):this.animation.animate(t,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(o){r.hamburgerMode?(a=o.element.parentElement,o.element.style.position="absolute",n=a.offsetHeight,o.element.style.maxHeight=o.element.offsetHeight+"px",a.style.maxHeight=""):(o.element.style.display="block",o.element.style.maxHeight=o.element.getBoundingClientRect().height+"px")},progress:function(o){r.hamburgerMode&&(a.style.minHeight=n+o.element.offsetHeight+"px")},end:function(o){r.hamburgerMode?(o.element.style.position="",o.element.style.maxHeight="",a.style.minHeight="",o.element.style.top="0px",o.element.children[0].focus(),r.triggerOpen(o.element.children[0])):r.end(o.element,i)}})},e.prototype.triggerOpen=function(t){var i=this.navIdx.length?this.getItem(this.navIdx):null,r={element:t,parentItem:i,items:i?i.items:this.items};this.trigger("onOpen",r),this.isMenu||I.add(t,"keydown",this.keyHandler,this)},e.prototype.end=function(t,i){if(i)if(t.style.display="block",t.style.maxHeight="",this.triggerOpen(t),t.querySelector("."+Qi))t.querySelector("."+Qi).focus();else{var r=this.getWrapper().children[this.getIdx(this.getWrapper(),t)-1];this.currentTarget?this.currentTarget.classList.contains("e-numerictextbox")||this.currentTarget.classList.contains("e-textbox")||this.currentTarget.tagName==="INPUT"||(r?r.querySelector("."+ki).focus():this.element.focus()):r?r.querySelector("."+ki).focus():this.element.focus()}else if(t===this.element){var n=this.getLIByClass(this.element,Qi);n&&n.classList.remove(Qi);var a=this.getLIByClass(this.element,ki);a&&a.classList.remove(ki),t.style.display="none"}else ne(t)},e.prototype.getPersistData=function(){return""},e.prototype.getWrapper=function(){return U(this.element,".e-"+this.getModuleName()+"-wrapper")},e.prototype.getIndex=function(t,i,r,n,a,o){r===void 0&&(r=this.items),n===void 0&&(n=[]),a===void 0&&(a=!1),o===void 0&&(o=0);var l;o=a?o+1:0;for(var h=0,u=r.length;h<u;h++)if(l=r[h],(i?l[this.getField("itemId",o)]:l[this.getField("text",o)])===t){n.push(h);break}else if(l[this.getField("children",o)]&&l[this.getField("children",o)].length)if(n=this.getIndex(t,i,l[this.getField("children",o)],n,!0,o),n[n.length-1]===-1)h!==u-1&&n.pop();else{n.unshift(h);break}else h===u-1&&n.push(-1);return!a&&n[0]===-1?[]:n},e.prototype.enableItems=function(t,i,r){i===void 0&&(i=!0);for(var n,a,o,l=AS,h,u=0;u<t.length;u++){if(o=this.getIndex(t[u],r),this.navIdx.length){if(o.length!==1){h=!1;for(var c=0,d=o.length-1;c<d;c++)if(o[c]!==this.navIdx[c]){h=!0;break}if(h)continue}}else if(o.length!==1)continue;a=o.pop(),n=this.getUlByNavIdx(o.length),n&&!m(a)&&(i?this.isMenu?(n.children[a].classList.remove(l),n.children[a].removeAttribute("aria-disabled")):B.isDevice&&!n.classList.contains("e-contextmenu")?n.children[a+1].classList.remove(l):n.children[a].classList.remove(l):this.isMenu?(n.children[a].classList.add(l),n.children[a].setAttribute("aria-disabled","true")):B.isDevice&&!n.classList.contains("e-contextmenu")?n.children[a+1].classList.add(l):n.children[a].classList.add(l))}},e.prototype.showItems=function(t,i){this.showHideItems(t,!1,i)},e.prototype.hideItems=function(t,i){this.showHideItems(t,!0,i)},e.prototype.showHideItems=function(t,i,r){for(var n,a,o,l,h=0;h<t.length;h++)if(o=this.getIndex(t[h],r),a=o.pop(),n=this.getUlByNavIdx(o.length),l=this.getItems(o),n){var u=r?n.children[a].id:l[a].text.toString();i&&u===t[h]?n.children[a].classList.add(Sm):!i&&u===t[h]&&n.children[a].classList.remove(Sm)}},e.prototype.removeItems=function(t,i){for(var r,n,a,o=0;o<t.length;o++)n=this.getIndex(t[o],i),r=n.pop(),a=this.getItems(n),m(r)||this.removeItem(a,n,r)},e.prototype.insertAfter=function(t,i,r){this.insertItems(t,i,r)},e.prototype.insertBefore=function(t,i,r){this.insertItems(t,i,r,!1)},e.prototype.insertItems=function(t,i,r,n){n===void 0&&(n=!0);for(var a,o,l,h,u,c=0;c<t.length;c++){l=this.getIndex(i,r),o=l.pop(),h=this.getItems(l),u=new ef(h[0],"items",t[c],!0),h.splice(n?o+1:o,0,u);var d=this.isMenu?[this.getWrapper()].concat(this.getPopups()):[].slice.call(this.getWrapper().children);if(!m(o)&&l.length<d.length){o=n?o+1:o,a=this.createItems(h).children[o];var p=this.isMenu?$(".e-menu-parent",d[l.length]):d[l.length];p.insertBefore(a,p.children[o])}}},e.prototype.removeAttributes=function(){var t=this;["top","left","display","z-index"].forEach(function(i){t.element.style.removeProperty(i)}),["role","tabindex","class","style"].forEach(function(i){i==="class"&&t.element.classList.contains("e-menu-parent")&&t.element.classList.remove("e-menu-parent"),(["class","style"].indexOf(i)===-1||!t.element.getAttribute(i))&&t.element.removeAttribute(i),t.isMenu&&i==="class"&&t.element.classList.contains("e-vertical")&&t.element.classList.remove("e-vertical")})},e.prototype.destroy=function(){var t=this.getWrapper();if(t){if(this.unWireEvents(),this.isMenu)this.closeMenu(),this.element.innerHTML="",this.removeAttributes(),t.parentNode.insertBefore(this.element,t),this.clonedElement=null;else{if(this.clonedElement.style.display="",this.clonedElement.tagName==="EJS-CONTEXTMENU")Q([this.clonedElement],["e-control","e-lib","e-"+this.getModuleName()]),this.element=this.clonedElement;else if(this.refreshing&&this.clonedElement.childElementCount&&this.clonedElement.children[0].tagName==="LI"&&this.setProperties({items:[]},!0),document.getElementById(this.clonedElement.id)){var i=this.clonedElement.nextElementSibling;i&&i!==t?this.clonedElement.parentElement.insertBefore(this.element,i):this.clonedElement.parentElement.appendChild(this.element),this.element.innerHTML="",Ut([].slice.call(this.clonedElement.children),this.element),ne(this.clonedElement),this.removeAttributes()}this.clonedElement=null}this.isMenu&&this.clonedElement?(ne(this.element),t.style.display="",t.classList.remove("e-"+this.getModuleName()+"-wrapper"),t.removeAttribute("data-ripple")):ne(t),s.prototype.destroy.call(this),this.template&&this.clearTemplate(["template"])}this.rippleFn=null},ai([_()],e.prototype,"beforeItemRender",void 0),ai([_()],e.prototype,"beforeOpen",void 0),ai([_()],e.prototype,"onOpen",void 0),ai([_()],e.prototype,"beforeClose",void 0),ai([_()],e.prototype,"onClose",void 0),ai([_()],e.prototype,"select",void 0),ai([_()],e.prototype,"created",void 0),ai([S("")],e.prototype,"cssClass",void 0),ai([S(0)],e.prototype,"hoverDelay",void 0),ai([S(!1)],e.prototype,"showItemOnClick",void 0),ai([S("")],e.prototype,"target",void 0),ai([S("")],e.prototype,"filter",void 0),ai([S(null)],e.prototype,"template",void 0),ai([S(!1)],e.prototype,"enableScrolling",void 0),ai([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),ai([Ee({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},Vz)],e.prototype,"fields",void 0),ai([ii([],ef)],e.prototype,"items",void 0),ai([Ee({duration:400,easing:"ease",effect:"SlideDown"},eq)],e.prototype,"animationSettings",void 0),e=ai([Ot],e),e}(Pi),_z=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},kS="e-vertical",Li="e-toolbar-items",zi="e-toolbar-item",Va="e-rtl",Gi="e-separator",xm="e-popup-up-icon",op="e-popup-down-icon",XN="e-popup-open",KN="e-template",Vn="e-overlay",ZN="e-toolbar-text",LS="e-popup-text",ca="e-overflow-show",wm="e-overflow-hide",tq="e-tbar-btn",es="e-hor-nav",JN="e-scroll-nav",iq="e-toolbar-right",rq="e-toolbar-left",ek="e-toolbar-center",da="e-tbar-pos",nq="e-hscroll-content",sq="e-vscroll-content",OS="e-hscroll-bar",aq="e-hor-nav",lp="e-toolbar-pop",al="e-toolbar-popup",oq="e-tbar-btn-text",hp="e-nav-active",up="e-ignore",RS="e-popup-alone",Co="e-hidden",tk="e-toolbar-multirow",ik="e-multirow-pos",FS="e-multirow-separator",PS="e-extended-separator",rk="e-extended-toolbar",Mm="e-toolbar-extended",lq="e-expended-nav",zS="e-tbar-extended",VI=function(s){_z(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return bi([S("")],e.prototype,"id",void 0),bi([S("")],e.prototype,"text",void 0),bi([S("auto")],e.prototype,"width",void 0),bi([S("")],e.prototype,"cssClass",void 0),bi([S(!1)],e.prototype,"showAlwaysInPopup",void 0),bi([S(!1)],e.prototype,"disabled",void 0),bi([S("")],e.prototype,"prefixIcon",void 0),bi([S("")],e.prototype,"suffixIcon",void 0),bi([S(!0)],e.prototype,"visible",void 0),bi([S("None")],e.prototype,"overflow",void 0),bi([S("")],e.prototype,"template",void 0),bi([S("Button")],e.prototype,"type",void 0),bi([S("Both")],e.prototype,"showTextOn",void 0),bi([S(null)],e.prototype,"htmlAttributes",void 0),bi([S("")],e.prototype,"tooltipText",void 0),bi([S("Left")],e.prototype,"align",void 0),bi([_()],e.prototype,"click",void 0),bi([S(-1)],e.prototype,"tabIndex",void 0),e}(ke),ov=function(s){_z(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.resizeContext=r.resize.bind(r),r.orientationChangeContext=r.orientationChange.bind(r),r.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},r}return e.prototype.destroy=function(){var t=this;(this.isReact||this.isAngular)&&this.clearTemplate();var i=this.element.querySelectorAll(".e-control.e-btn");for([].slice.call(i).forEach(function(r){!m(r)&&!m(r.ej2_instances)&&!m(r.ej2_instances[0])&&!r.ej2_instances[0].isDestroyed&&r.ej2_instances[0].destroy()}),this.unwireEvents(),this.tempId.forEach(function(r){m(t.element.querySelector(r))||(document.body.appendChild(t.element.querySelector(r)).style.display="none")}),this.destroyItems();this.element.lastElementChild;)this.element.removeChild(this.element.lastElementChild);this.trgtEle&&(this.element.appendChild(this.ctrlTem),this.trgtEle=null,this.ctrlTem=null),this.popObj&&(this.popObj.destroy(),ne(this.popObj.element)),this.activeEle&&(this.activeEle=null),this.popObj=null,this.tbarAlign=null,this.tbarItemsCol=[],this.remove(this.element,"e-toolpop"),this.cssClass&&te([this.element],this.cssClass.split(" ")),this.element.removeAttribute("style"),["aria-disabled","aria-orientation","role"].forEach(function(r){return t.element.removeAttribute(r)}),s.prototype.destroy.call(this)},e.prototype.preRender=function(){var t={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",t),this.enableCollision=t.enableCollision,this.scrollStep=t.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains(kS),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,Va)},e.prototype.wireEvents=function(){I.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),window.addEventListener("orientationchange",this.orientationChangeContext),this.allowKeyboard&&this.wireKeyboardEvent()},e.prototype.wireKeyboardEvent=function(){this.keyModule=new wr(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),I.add(this.element,"keydown",this.docKeyDown,this),this.updateTabIndex("0")},e.prototype.updateTabIndex=function(t){var i=this.element.querySelector("."+zi+":not(."+Vn+" ):not(."+Gi+" ):not(."+Co+" )");if(!m(i)&&!m(i.firstElementChild)){var r=i.firstElementChild.getAttribute("data-tabindex");r&&r==="-1"&&i.firstElementChild.tagName!=="INPUT"&&i.firstElementChild.setAttribute("tabindex",t)}},e.prototype.unwireKeyboardEvent=function(){this.keyModule&&(I.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},e.prototype.docKeyDown=function(t){if(t.target.tagName!=="INPUT"){var i=!m(this.popObj)&&or(this.popObj.element)&&this.overflowMode!=="Extended";t.keyCode===9&&t.target.classList.contains("e-hor-nav")===!0&&i&&this.popObj.hide({name:"FadeOut",duration:100});var r=t.keyCode===40||t.keyCode===38||t.keyCode===35||t.keyCode===36;r&&t.preventDefault()}},e.prototype.unwireEvents=function(){I.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),window.removeEventListener("orientationchange",this.orientationChangeContext),I.remove(document,"scroll",this.docEvent),I.remove(document,"click",this.docEvent)},e.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},e.prototype.docEvent=function(t){var i=U(t.target,".e-popup");this.popObj&&or(this.popObj.element)&&!i&&this.overflowMode==="Popup"&&this.popObj.hide({name:"FadeOut",duration:100})},e.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,da),this.scrollModule.destroy(),this.scrollModule=null)},e.prototype.destroyItems=function(){if(this.element&&[].slice.call(this.element.querySelectorAll("."+zi)).forEach(function(i){ne(i)}),this.tbarAlign){var t=this.element.querySelector("."+Li);[].slice.call(t.children).forEach(function(i){ne(i)}),this.tbarAlign=!1,this.remove(t,da)}this.clearProperty()},e.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,Va),this.destroyScroll()),this.remove(this.element,zS),this.remove(this.element,rk);var t=this.element.querySelector(".e-toolbar-multirow");t&&this.remove(t,tk),this.popObj&&this.popupRefresh(this.popObj.element,!0)},e.prototype.add=function(t,i){t.classList.add(i)},e.prototype.remove=function(t,i){t.classList.remove(i)},e.prototype.elementFocus=function(t){var i=t.firstElementChild;i?(i.focus(),this.activeEleSwitch(t)):t.focus()},e.prototype.clstElement=function(t,i){var r;return t&&this.popObj&&or(this.popObj.element)?r=this.popObj.element.querySelector("."+zi):this.element===i||t?r=this.element.querySelector("."+zi+":not(."+Vn+" ):not(."+Gi+" ):not(."+Co+" )"):r=U(i,"."+zi),r},e.prototype.keyHandling=function(t,i,r,n,a){var o=this.popObj,l=this.element,h={name:"FadeOut",duration:100},u=i.action==="moveUp"?"previous":"next",c,d;switch(i.action){case"moveRight":if(this.isVertical)return;l===r?this.elementFocus(t):n||this.eleFocus(t,"next");break;case"moveLeft":if(this.isVertical)return;n||this.eleFocus(t,"previous");break;case"home":case"end":if(t){var p=U(t,".e-popup"),f=this.element.querySelector("."+Mm);this.overflowMode==="Extended"&&f&&f.classList.contains("e-popup-open")&&(p=i.action==="end"?f:null),p?or(this.popObj.element)&&(d=[].slice.call(p.children),i.action==="home"?c=this.focusFirstVisibleEle(d):c=this.focusLastVisibleEle(d)):(d=this.element.querySelectorAll("."+Li+" ."+zi+":not(."+Gi+")"),i.action==="home"?c=this.focusFirstVisibleEle(d):c=this.focusLastVisibleEle(d)),c&&this.elementFocus(c)}break;case"moveUp":case"moveDown":if(this.isVertical)i.action==="moveUp"?this.eleFocus(t,"previous"):this.eleFocus(t,"next");else if(o&&U(r,".e-popup")){var v=o.element,g=v.firstElementChild;u==="previous"&&g===t?v.lastElementChild.firstChild.focus():u==="next"&&v.lastElementChild===t?g.firstChild.focus():this.eleFocus(t,u)}else i.action==="moveDown"&&o&&or(o.element)&&this.elementFocus(t);break;case"tab":if(!a&&!n){var b=t.firstElementChild;l===r&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(b),b.focus()))}break;case"popupClose":o&&this.overflowMode!=="Extended"&&o.hide(h);break;case"popupOpen":if(!n)return;o&&!or(o.element)?(o.element.style.top=l.offsetHeight+"px",o.show({name:"FadeIn",duration:100})):o.hide(h);break}},e.prototype.keyActionHandler=function(t){var i=t.target;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||this.element.classList.contains(Vn))){t.preventDefault();var r=i.classList.contains(es),n=i.classList.contains(JN),a=this.clstElement(r,i);(a||n)&&this.keyHandling(a,t,i,r,n)}},e.prototype.disable=function(t){var i=this.element;t?i.classList.add(Vn):i.classList.remove(Vn),this.activeEle&&this.activeEle.setAttribute("tabindex",this.activeEle.getAttribute("data-tabindex")),this.scrollModule&&this.scrollModule.disable(t),this.popObj&&(or(this.popObj.element)&&this.overflowMode!=="Extended"&&this.popObj.hide(),i.querySelector("#"+i.id+"_nav").setAttribute("tabindex",t?"-1":"0"))},e.prototype.eleContains=function(t){return t.classList.contains(Gi)||t.classList.contains(Vn)||t.getAttribute("disabled")||t.classList.contains(Co)||!or(t)||!t.classList.contains(zi)},e.prototype.focusFirstVisibleEle=function(t){for(var i,r=0;r<t.length;){var n=t[parseInt(r.toString(),10)];if(!n.classList.contains(Co)&&!n.classList.contains(Vn))return n;r++}return i},e.prototype.focusLastVisibleEle=function(t){for(var i,r=t.length-1;r>=0;){var n=t[parseInt(r.toString(),10)];if(!n.classList.contains(Co)&&!n.classList.contains(Vn))return n;r--}return i},e.prototype.eleFocus=function(t,i){var r=Object(t)[i+"ElementSibling"];if(r){var n=this.eleContains(r);if(n){this.eleFocus(r,i);return}this.elementFocus(r)}else if(this.tbarAlign){var a=Object(t.parentElement)[i+"ElementSibling"];if(!m(a)&&a.children.length===0&&(a=Object(a)[i+"ElementSibling"]),!m(a)&&a.children.length>0)if(i==="next"){var o=a.querySelector("."+zi);this.eleContains(o)?this.eleFocus(o,i):(o.firstElementChild.focus(),this.activeEleSwitch(o))}else{var o=a.lastElementChild;this.eleContains(o)?this.eleFocus(o,i):this.elementFocus(o)}}else if(!m(t)){var l=this.element.querySelectorAll("."+Li+" ."+zi+":not(."+Gi+"):not(."+Vn+"):not(."+Co+")");i==="next"&&l?this.elementFocus(l[0]):i==="previous"&&l&&this.elementFocus(l[l.length-1])}},e.prototype.clickHandler=function(t){var i=this,r=t.target,n=this.element,a=!m(U(r,"."+lp)),o=r.classList,l=U(r,"."+es);l||(l=r),!n.children[0].classList.contains("e-hscroll")&&!n.children[0].classList.contains("e-vscroll")&&o.contains(es)&&(o=r.querySelector(".e-icons").classList),(o.contains(xm)||o.contains(op))&&this.popupClickHandler(n,l,Va);var h,u=U(t.target,"."+zi);if(!((m(u)||u.classList.contains(Vn))&&!l.classList.contains(es))){if(u){var c=this.items[this.tbarEle.indexOf(u)];h=c}var d={originalEvent:t,item:h};h&&!m(h.click)&&this.trigger("items["+this.tbarEle.indexOf(u)+"].click",d),d.cancel||this.trigger("clicked",d,function(p){!m(i.popObj)&&a&&!p.cancel&&i.overflowMode==="Popup"&&p.item&&p.item.type!=="Input"&&i.popObj.hide({name:"FadeOut",duration:100})})}},e.prototype.popupClickHandler=function(t,i,r){var n=this.popObj;or(n.element)?(i.classList.remove(hp),n.hide({name:"FadeOut",duration:100})):(t.classList.contains(r)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),n.offsetX===0&&!t.classList.contains(r)&&(n.enableRtl=!1,n.position={X:"right",Y:"top"}),n.dataBind(),n.refreshPosition(),n.element.style.top=this.getElementOffsetY()+"px",this.overflowMode==="Extended"&&(n.element.style.minHeight="0px"),i.classList.add(hp),n.show({name:"FadeIn",duration:100}))},e.prototype.render=function(){var t=this;this.initialize(),this.renderControl(),this.wireEvents(),this.renderComplete(),this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){t.refreshOverflow()})},e.prototype.initialize=function(){var t=qe(this.width),i=qe(this.height);(B.info.name!=="msie"||this.height!=="auto"||this.overflowMode==="MultiRow")&&tt(this.element,{height:i}),tt(this.element,{width:t});var r={role:"toolbar","aria-disabled":"false","aria-orientation":this.isVertical?"vertical":"horizontal"};De(this.element,r),this.cssClass&&Q([this.element],this.cssClass.split(" "))},e.prototype.renderControl=function(){var t=this.element;this.trgtEle=t.children.length>0?t.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},e.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},e.prototype.itemsAlign=function(t,i){var r,n;this.tbarEle||(this.tbarEle=[]);for(var a=0;a<t.length;a++)r=this.renderSubComponent(t[parseInt(a.toString(),10)],a),this.tbarEle.indexOf(r)===-1&&this.tbarEle.push(r),this.tbarAlign||this.tbarItemAlign(t[parseInt(a.toString(),10)],i,a),n=i.querySelector(".e-toolbar-"+t[parseInt(a.toString(),10)].align.toLowerCase()),n?(t[parseInt(a.toString(),10)].showAlwaysInPopup&&t[parseInt(a.toString(),10)].overflow!=="Show"||this.tbarAlgEle[(t[parseInt(a.toString(),10)].align+"s").toLowerCase()].push(r),n.appendChild(r)):i.appendChild(r);if(this.isReact){var o="portals";this.notify("render-react-toolbar-template",this[""+o]),this.renderReactTemplates()}},e.prototype.changeOrientation=function(){var t=this.element;this.isVertical?(t.classList.remove(kS),this.isVertical=!1,(this.height==="auto"||this.height==="100%")&&(t.style.height=this.height),t.setAttribute("aria-orientation","horizontal")):(t.classList.add(kS),this.isVertical=!0,t.setAttribute("aria-orientation","vertical"),tt(this.element,{height:qe(this.height),width:qe(this.width)})),this.destroyMode(),this.refreshOverflow()},e.prototype.initScroll=function(t,i){if(!this.scrollModule&&this.checkOverflow(t,i[0])){this.tbarAlign&&this.element.querySelector("."+Li+" ."+ek).removeAttribute("style"),this.isVertical?this.scrollModule=new Dc({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]):this.scrollModule=new A0({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]),this.cssClass&&Q([i[0]],this.cssClass.split(" "));var r=this.scrollModule.element.querySelector("."+OS+", .e-vscroll-bar");r&&r.removeAttribute("tabindex"),this.remove(this.scrollModule.element,da),tt(this.element,{overflow:"hidden"})}},e.prototype.itemWidthCal=function(t){var i=this,r=0,n;return[].slice.call(ze("."+zi,t)).forEach(function(a){or(a)&&(n=window.getComputedStyle(a),r+=i.isVertical?a.offsetHeight:a.offsetWidth,r+=parseFloat(i.isVertical?n.marginTop:n.marginRight),r+=parseFloat(i.isVertical?n.marginBottom:n.marginLeft))}),r},e.prototype.getScrollCntEle=function(t){var i=this.isVertical?".e-vscroll-content":".e-hscroll-content";return t.querySelector(i)},e.prototype.checkOverflow=function(t,i){if(m(t)||m(i)||!or(t))return!1;var r=this.isVertical?t.offsetHeight:t.offsetWidth,n=this.isVertical?i.offsetHeight:i.offsetWidth;(this.tbarAlign||this.scrollModule||r===n)&&(n=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(i):i));var a=t.querySelector("."+es),o=t.querySelector("."+JN),l=0;return a?l=this.isVertical?a.offsetHeight:a.offsetWidth:o&&(l=this.isVertical?o.offsetHeight*2:o.offsetWidth*2),n>r-l},e.prototype.refreshOverflow=function(){this.resize()},e.prototype.toolbarAlign=function(t){this.tbarAlign&&(this.add(t,da),this.itemPositioning())},e.prototype.renderOverflowMode=function(){var t=this.element,i=t.querySelector("."+Li),r=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,this.remove(this.element,"e-toolpop"),B.info.name==="msie"&&this.height==="auto"&&(t.style.height=""),this.overflowMode){case"Scrollable":m(this.scrollModule)&&this.initScroll(t,[].slice.call(t.getElementsByClassName(Li)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(t,i)||r)&&this.setOverflowAttributes(t),this.toolbarAlign(i);break;case"MultiRow":this.add(i,tk),this.checkOverflow(t,i)&&this.tbarAlign&&(this.removePositioning(),this.add(i,ik)),t.style.overflow==="hidden"&&(t.style.overflow=""),(B.info.name==="msie"||t.style.height!=="auto")&&(t.style.height="auto");break;case"Extended":this.add(this.element,rk),(this.checkOverflow(t,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(t)),this.toolbarAlign(i)}},e.prototype.setOverflowAttributes=function(t){this.createPopupEle(t,[].slice.call(ze("."+Li+" ."+zi,t)));var i={tabindex:"0",role:"button","aria-haspopup":"true","aria-label":"overflow"};De(this.element.querySelector("."+es),i)},e.prototype.separator=function(){var t=this.element,i=[].slice.call(t.querySelectorAll("."+Gi)),r=t.querySelector("."+FS),n=t.querySelector("."+PS),a=this.overflowMode==="MultiRow"?r:n;a!==null&&(this.overflowMode==="MultiRow"?a.classList.remove(FS):this.overflowMode==="Extended"&&a.classList.remove(PS));for(var o=0;o<=i.length-1;o++)i[parseInt(o.toString(),10)].offsetLeft<30&&i[parseInt(o.toString(),10)].offsetLeft!==0&&(this.overflowMode==="MultiRow"?i[parseInt(o.toString(),10)].classList.add(FS):this.overflowMode==="Extended"&&i[parseInt(o.toString(),10)].classList.add(PS))},e.prototype.createPopupEle=function(t,i){var r=t.querySelector("."+es),n=this.isVertical;r||this.createPopupIcon(t),r=t.querySelector("."+es);var a=n?r.offsetHeight:r.offsetWidth,o=(n?t.offsetHeight:t.offsetWidth)-a;this.element.classList.remove("e-rtl"),tt(this.element,{direction:"initial"}),this.checkPriority(t,i,o,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},e.prototype.pushingPoppedEle=function(t,i,r,n,a){var o=t.element,l=[].slice.call(ze("."+al,o.querySelector("."+Li))),h=ze("."+ca,r),u=0,c=0;l.forEach(function(v,g){h=ze("."+ca,r),v.classList.contains(ca)&&h.length>0?t.tbResize&&h.length>g?(r.insertBefore(v,h[parseInt(g.toString(),10)]),++c):(r.insertBefore(v,r.children[h.length]),++c):v.classList.contains(ca)||t.tbResize&&v.classList.contains(wm)&&r.children.length>0&&h.length===0?(r.insertBefore(v,r.firstChild),++c):v.classList.contains(wm)?i.push(v):t.tbResize?(r.insertBefore(v,r.childNodes[u+c]),++u):r.appendChild(v),v.classList.contains(Gi)?tt(v,{display:"",height:a+"px"}):tt(v,{display:"",height:n+"px"})}),i.forEach(function(v){r.appendChild(v)});for(var d=ze("."+zi,o.querySelector("."+Li)),p=d.length-1;p>=0;p--){var f=d[parseInt(p.toString(),10)];if(f.classList.contains(Gi)&&this.overflowMode!=="Extended")tt(f,{display:"none"});else break}},e.prototype.createPopup=function(){var t=this.element,i,r;this.overflowMode==="Extended"&&(r=t.querySelector("."+Gi),i=t.style.height==="auto"||t.style.height===""?null:r&&r.offsetHeight);var n=t.querySelector("."+zi+":not(."+Gi+"):not(."+al+")"),a=t.style.height==="auto"||t.style.height===""?null:n&&n.offsetHeight,o,l=[];if($("#"+t.id+"_popup."+lp,t))o=$("#"+t.id+"_popup."+lp,t);else{var h=this.createElement("div",{id:t.id+"_popup",className:lp+" "+Mm}),u=this.createElement("div",{id:t.id+"_popup",className:lp});o=this.overflowMode==="Extended"?h:u}this.pushingPoppedEle(this,l,o,a,i),this.popupInit(t,o)},e.prototype.getElementOffsetY=function(){return this.overflowMode==="Extended"&&window.getComputedStyle(this.element).getPropertyValue("box-sizing")==="border-box"?this.element.clientHeight:this.element.offsetHeight},e.prototype.popupInit=function(t,i){if(this.popObj){var o=this.popObj.element;tt(o,{maxHeight:"",display:"block"}),tt(o,{maxHeight:o.offsetHeight+"px",display:""})}else{t.appendChild(i),this.cssClass&&Q([i],this.cssClass.split(" ")),tt(this.element,{overflow:""});var r=window.getComputedStyle(this.element),n=new za(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(this.overflowMode==="Extended"&&(n.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)*2,n.offsetX=0),n.appendTo(i),I.add(document,"scroll",this.docEvent.bind(this)),I.add(document,"click ",this.docEvent.bind(this)),n.element.style.maxHeight=n.element.offsetHeight+"px",this.isVertical&&(n.element.style.visibility="hidden"),this.isExtendedOpen){var a=this.element.querySelector("."+es);a.classList.add(hp),br(a.firstElementChild,[xm],[op]),this.element.querySelector("."+Mm).classList.add(XN)}else n.hide();this.popObj=n}},e.prototype.tbarPopupHandler=function(t){this.overflowMode==="Extended"&&(t?this.add(this.element,zS):this.remove(this.element,zS))},e.prototype.popupOpen=function(t){var i=this.popObj;this.isVertical||(i.offsetY=this.getElementOffsetY(),i.dataBind());var r=this.popObj.element,n=this.popObj.element.parentElement,a=n.querySelector("."+es);a.setAttribute("aria-expanded","true"),tt(i.element,{height:"auto",maxHeight:""}),i.element.style.maxHeight=i.element.offsetHeight+"px",this.overflowMode==="Extended"&&(i.element.style.minHeight="");var o=r.offsetTop+r.offsetHeight+Fr(n).top,l=a.firstElementChild;a.classList.add(hp),br(l,[xm],[op]),this.tbarPopupHandler(!0);var h=m(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+h<o&&this.element.offsetTop<r.offsetHeight){var u=r.offsetHeight-(o-window.innerHeight-h+5);i.height=u+"px";for(var c=0;c<=r.childElementCount;c++){var d=r.children[parseInt(c.toString(),10)];if(d.offsetTop+d.offsetHeight>u){u=d.offsetTop;break}}tt(i.element,{maxHeight:u+"px"})}else if(this.isVertical){var p=this.element.getBoundingClientRect();tt(i.element,{maxHeight:p.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(i){var f=r.getBoundingClientRect();f.right>document.documentElement.clientWidth&&f.width>n.getBoundingClientRect().width&&(i.collision={Y:"none"},i.dataBind()),i.refreshPosition()}},e.prototype.popupClose=function(t){var i=this.element,r=i.querySelector("."+es);r.setAttribute("aria-expanded","false");var n=r.firstElementChild;r.classList.remove(hp),br(n,[op],[xm]),this.tbarPopupHandler(!1)},e.prototype.checkPriority=function(t,i,r,n){for(var a=this.popupPriCount>0,o=i.length,l=r,h,u,c=0,d=0,p=0,f=function(M,E){var T=!1;return E.forEach(function(D){M.classList.contains(D)&&(T=!0)}),T},v=o-1;v>=0;v--){var g=void 0,b=window.getComputedStyle(i[parseInt(v.toString(),10)]);this.isVertical?(g=parseFloat(b.marginTop),g+=parseFloat(b.marginBottom)):(g=parseFloat(b.marginRight),g+=parseFloat(b.marginLeft));var y=i[parseInt(v.toString(),10)]===this.tbarEle[0];y&&(this.tbarEleMrgn=g),h=this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth;var C=y?h+g:h;if(f(i[parseInt(v.toString(),10)],[RS])&&a&&(i[parseInt(v.toString(),10)].classList.add(al),this.isVertical?tt(i[parseInt(v.toString(),10)],{display:"none",minHeight:C+"px"}):tt(i[parseInt(v.toString(),10)],{display:"none",minWidth:C+"px"}),p++),this.isVertical?u=i[parseInt(v.toString(),10)].offsetTop+i[parseInt(v.toString(),10)].offsetHeight+g>r:u=i[parseInt(v.toString(),10)].offsetLeft+i[parseInt(v.toString(),10)].offsetWidth+g>r,u){if(i[parseInt(v.toString(),10)].classList.contains(Gi)){if(this.overflowMode==="Extended"){var x=i[parseInt(v.toString(),10)];f(x,[Gi,up])&&(i[parseInt(v.toString(),10)].classList.add(al),p++),d++}else if(this.overflowMode==="Popup"){if(c>0&&d===p){var x=i[v+d+(c-1)];f(x,[Gi,up])&&tt(x,{display:"none"})}c++,d=0,p=0}}else d++;i[parseInt(v.toString(),10)].classList.contains(ca)&&n?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+g:f(i[parseInt(v.toString(),10)],[Gi,up])?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+g:(i[parseInt(v.toString(),10)].classList.add(al),this.isVertical?tt(i[parseInt(v.toString(),10)],{display:"none",minHeight:C+"px"}):tt(i[parseInt(v.toString(),10)],{display:"none",minWidth:C+"px"}),p++)}}if(n){var w=ze("."+zi+":not(."+al+")",this.element);this.checkPriority(t,w,l,!1)}},e.prototype.createPopupIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+aq);r=this.overflowMode==="Extended"?r+" "+lq:r;var n=this.createElement("div",{id:i,className:r});(B.info.name==="msie"||B.info.name==="edge")&&n.classList.add("e-ie-align");var a=this.createElement("div",{className:op+" e-icons"});n.appendChild(a),n.setAttribute("tabindex","0"),n.setAttribute("role","button"),t.appendChild(n)},e.prototype.tbarPriRef=function(t,i,r,n,a,o,l,h,u){var c=h,d=this.popObj.element,p="."+zi+":not(."+Gi+"):not(."+ca+")",f=ze("."+al+":not(."+ca+")",d).length,v=function(x,w){return x.classList.contains(w)};if(ze(p,t).length===0){var g=t.children[i-(i-r)-1],b=!m(g)&&v(g,up);if(!m(g)&&v(g,Gi)&&!or(g)||b){g.style.display="unset";var y=g.offsetWidth+parseFloat(window.getComputedStyle(g).marginRight)*2,C=g.previousElementSibling;o+y<l||a?(t.insertBefore(n,t.children[i+c-(i-r)]),m(C)||(C.style.display="")):(tt(n,u),C.classList.contains(Gi)&&(C.style.display="none")),g.style.display=""}else t.insertBefore(n,t.children[i+c-(i-r)])}else t.insertBefore(n,t.children[i+c-f])},e.prototype.popupRefresh=function(t,i){var r=this,n=this.element,a=this.isVertical,o=n.querySelector("."+Li),l=n.querySelector("."+es);if(!m(l)){o.removeAttribute("style"),t.style.display="block";var h;a?h=n.offsetHeight-(l.offsetHeight+o.offsetHeight):h=n.offsetWidth-(l.offsetWidth+o.offsetWidth);var u=0;[].slice.call(t.children).forEach(function(c){u+=r.popupEleWidth(c),tt(c,{position:""})}),h+(a?l.offsetHeight:l.offsetWidth)>u&&this.popupPriCount===0&&(i=!0),this.popupEleRefresh(h,t,i),t.style.display="",t.children.length===0&&l&&this.popObj&&(ne(l),l=null,this.popObj.destroy(),ne(this.popObj.element),this.popObj=null)}},e.prototype.ignoreEleFetch=function(t,i){var r=[].slice.call(i.querySelectorAll("."+up)),n=[],a=0;if(r.length>0)r.forEach(function(o){n.push([].slice.call(i.children).indexOf(o))});else return 0;return n.forEach(function(o){o<=t&&a++}),a},e.prototype.checkPopupRefresh=function(t,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var n=t.offsetWidth-t.querySelector("."+es).offsetWidth,a=t.querySelector("."+Li).offsetWidth;return i.style.removeProperty("display"),n>r+a},e.prototype.popupEleWidth=function(t){t.style.position="absolute";var i=this.isVertical?t.offsetHeight:t.offsetWidth,r=t.querySelector("."+oq);if(t.classList.contains("e-tbtn-align")||t.classList.contains(LS)){var n=t.children[0];!m(r)&&t.classList.contains(LS)?r.style.display="none":!m(r)&&t.classList.contains(ZN)&&(r.style.display="block"),n.style.minWidth="0%",i=parseFloat(this.isVertical?t.style.minHeight:t.style.minWidth),n.style.minWidth="",n.style.minHeight="",m(r)||(r.style.display="")}return i},e.prototype.popupEleRefresh=function(t,i,r){for(var n=this.popupPriCount>0,a=this.tbarEle,o,l,h=this.element.querySelector("."+Li),u=0,c=function(y){if(y.classList.contains(RS)&&n&&!r)return"continue";var C=d.popupEleWidth(y);if(y===d.tbarEle[0]&&(C+=d.tbarEleMrgn),y.style.position="",C<t||r){var x={minWidth:y.style.minWidth,height:y.style.height,minHeight:y.style.minHeight};if(tt(y,{minWidth:"",height:"",minHeight:""}),y.classList.contains(wm)||y.classList.remove(al),l=d.tbarEle.indexOf(y),d.tbarAlign){var w=d.items[parseInt(l.toString(),10)].align;l=d.tbarAlgEle[(w+"s").toLowerCase()].indexOf(y),a=d.tbarAlgEle[(w+"s").toLowerCase()],h=d.element.querySelector("."+Li+" .e-toolbar-"+w.toLowerCase())}var M=0;d.overflowMode!=="Extended"&&a.slice(0,l).forEach(function(E){(E.classList.contains(ca)||E.classList.contains(Gi))&&(E.classList.contains(Gi)&&(E.style.display="",t-=E.offsetWidth),M++)}),u=d.ignoreEleFetch(l,h),y.classList.contains(ca)?(d.tbarPriRef(h,l,M,y,r,C,t,u,x),t-=y.offsetWidth):l===0?(h.insertBefore(y,h.firstChild),t-=y.offsetWidth):(o=ze("."+ca,d.popObj.element).length,h.insertBefore(y,h.children[l+u-o]),t-=y.offsetWidth),y.style.height=""}else return"break"},d=this,p=0,f=[].slice.call(i.children);p<f.length;p++){var v=f[p],g=c(v);if(g==="break")break}var b=this.checkOverflow(this.element,this.element.getElementsByClassName(Li)[0]);b&&!r&&this.renderOverflowMode()},e.prototype.removePositioning=function(){var t=this.element.querySelector("."+Li);if(!(m(t)||!t.classList.contains(da))){this.remove(t,da);var i=[].slice.call(t.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},e.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+Li);this.add(t,da),this.itemPositioning()},e.prototype.itemPositioning=function(){var t=this.element.querySelector("."+Li),i;if(!(m(t)||!t.classList.contains(da))){var r=this.element.querySelector("."+es),n;if(this.scrollModule){var a=this.isVertical?sq:nq;n=[].slice.call(t.querySelector("."+a).children)}else n=[].slice.call(t.childNodes);this.isVertical?i=n[0].offsetHeight+n[2].offsetHeight:i=n[0].offsetWidth+n[2].offsetWidth;var o=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(r){o-=this.isVertical?r.offsetHeight:r.offsetWidth;var l=(this.isVertical?r.offsetHeight:r.offsetWidth)+"px";n[2].removeAttribute("style"),this.isVertical?this.enableRtl?n[2].style.top=l:n[2].style.bottom=l:this.enableRtl?n[2].style.left=l:n[2].style.right=l}if(!(o<=i)){var h=(o-i-(this.isVertical?n[1].offsetHeight:n[1].offsetWidth))/2;n[1].removeAttribute("style");var u=(this.isVertical?n[0].offsetHeight:n[0].offsetWidth)+h+"px";this.isVertical?this.enableRtl?n[1].style.marginBottom=u:n[1].style.marginTop=u:this.enableRtl?n[1].style.marginRight=u:n[1].style.marginLeft=u}}},e.prototype.tbarItemAlign=function(t,i,r){var n=this;if(!(t.showAlwaysInPopup&&t.overflow!=="Show")){var a=[];if(a.push(this.createElement("div",{className:rq})),a.push(this.createElement("div",{className:ek})),a.push(this.createElement("div",{className:iq})),r===0&&t.align!=="Left")a.forEach(function(h){i.appendChild(h)}),this.tbarAlign=!0,this.add(i,da);else if(t.align!=="Left"){var o=i.childNodes,l=a[0];[].slice.call(o).forEach(function(h){n.tbarAlgEle.lefts.push(h),l.appendChild(h)}),i.appendChild(l),i.appendChild(a[1]),i.appendChild(a[2]),this.tbarAlign=!0,this.add(i,da)}}},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,Li),this.tbarEle=[];var i=[].slice.call(this.trgtEle.children);i.forEach(function(r){r.tagName==="DIV"&&(t.tbarEle.push(r),m(r.firstElementChild)||r.firstElementChild.setAttribute("aria-disabled","false"),t.add(r,zi))})},e.prototype.renderItems=function(){var t=this.element,i=this.items;if(this.trgtEle!=null)this.ctrlTemplate();else if(t&&i.length>0){var r=void 0;t&&t.children.length>0&&(r=t.querySelector("."+Li)),r||(r=this.createElement("div",{className:Li})),this.itemsAlign(i,r),t.appendChild(r)}},e.prototype.setAttr=function(t,i){for(var r=Object.keys(t),n,a=0;a<r.length;a++)n=r[parseInt(a.toString(),10)],n==="class"?this.add(i,t[""+n]):i.setAttribute(n,t[""+n])},e.prototype.enableItems=function(t,i){var r=t,n=r.length,a;m(i)&&(i=!0);var o=function(c,d){c?(d.classList.remove(Vn),m(d.firstElementChild)||d.firstElementChild.setAttribute("aria-disabled","false")):(d.classList.add(Vn),m(d.firstElementChild)||d.firstElementChild.setAttribute("aria-disabled","true"))};if(!m(n)&&n>=1){for(var l=0,h=[].slice.call(r);l<n;l++){var u=h[parseInt(l.toString(),10)];if(typeof u=="number"){if(a=this.getElementByIndex(u),m(a))return;r[parseInt(l.toString(),10)]=a}else a=u;o(i,a)}i?te(r,Vn):Q(r,Vn)}else{if(typeof r=="number"){if(a=this.getElementByIndex(r),m(a))return}else a=t;o(i,a)}},e.prototype.getElementByIndex=function(t){return this.tbarEle[parseInt(t.toString(),10)]?this.tbarEle[parseInt(t.toString(),10)]:null},e.prototype.addItems=function(t,i){var r;this.extendedOpen();var n=this.element.querySelector("."+Li);if(m(n)){this.itemsRerender(t);return}var a,o="Left";m(i)&&(i=0),t.forEach(function(p){!m(p.align)&&p.align!=="Left"&&o==="Left"&&(o=p.align)});for(var l=0,h=t;l<h.length;l++){var u=h[l];if(m(u.type)&&(u.type="Button"),r=ze("."+zi,this.element),u.align=o,a=this.renderSubComponent(u,i),this.tbarEle.length>=i&&r.length>=0){m(this.scrollModule)&&this.destroyMode();var c=u.align[0]==="L"?0:u.align[0]==="C"?1:2,d=void 0;!this.tbarAlign&&o!=="Left"?(this.tbarItemAlign(u,n,1),this.tbarAlign=!0,d=U(r[0],"."+Li).children[parseInt(c.toString(),10)],d.appendChild(a),this.tbarAlgEle[(u.align+"s").toLowerCase()].push(a),this.refreshPositioning()):this.tbarAlign?(d=U(r[0],"."+Li).children[parseInt(c.toString(),10)],d.insertBefore(a,d.children[parseInt(i.toString(),10)]),this.tbarAlgEle[(u.align+"s").toLowerCase()].splice(i,0,a),this.refreshPositioning()):r.length===0?(r=ze("."+Li,this.element),r[0].appendChild(a)):r[0].parentNode.insertBefore(a,r[parseInt(i.toString(),10)]),this.items.splice(i,0,u),u.template&&this.tbarEle.splice(this.tbarEle.length-1,1),this.tbarEle.splice(i,0,a),i++,this.offsetWid=n.offsetWidth}}n.style.width="",this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},e.prototype.removeItems=function(t){var i=t,r,n=[].slice.call(ze("."+zi,this.element));if(typeof i=="number")r=parseInt(t.toString(),10),this.removeItemByIndex(r,n);else if(i&&i.length>1)for(var a=0,o=[].slice.call(i);a<o.length;a++){var l=o[a];r=this.tbarEle.indexOf(l),this.removeItemByIndex(r,n),n=ze("."+zi,this.element)}else{var l=i&&i.length&&i.length===1?i[0]:t;r=n.indexOf(l),this.removeItemByIndex(r,n)}this.resize()},e.prototype.removeItemByIndex=function(t,i){if(this.tbarEle[parseInt(t.toString(),10)]&&i[parseInt(t.toString(),10)]){var r=this.tbarEle.indexOf(i[parseInt(t.toString(),10)]);if(this.tbarAlign){var n=this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].indexOf(this.tbarEle[parseInt(r.toString(),10)]);this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].splice(parseInt(n.toString(),10),1)}this.isReact&&this.clearToolbarTemplate(i[parseInt(t.toString(),10)]);var a=i[parseInt(t.toString(),10)].querySelector(".e-control.e-btn");!m(a)&&!m(a.ej2_instances[0])&&!a.ej2_instances[0].isDestroyed&&a.ej2_instances[0].destroy(),ne(i[parseInt(t.toString(),10)]),this.items.splice(r,1),this.tbarEle.splice(r,1)}},e.prototype.templateRender=function(t,i,r,n){var a=r.type,o=t,l;if(typeof t=="object"&&(l=typeof o.appendTo=="function"),typeof t=="string"||!l){var h=void 0,u=t,c=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);u=typeof t=="string"?t.trim():t;try{if(typeof t=="object"&&!m(t.tagName))i.appendChild(t);else if(typeof t=="string"&&c.test(u))i.innerHTML=u;else if(document.querySelectorAll(u).length){var d=document.querySelector(u),p=d.outerHTML.trim();i.appendChild(d),d.style.display="",m(p)||this.tempId.push(u)}else h=pi(u)}catch{h=pi(u)}var f=void 0;if(!m(h)){var v=this.element.id+n+"_template";f=h({},this,"template",v,this.isStringTemplate,void 0,void 0,this.root)}!m(f)&&f.length>0&&[].slice.call(f).forEach(function(b){m(b.tagName)||(b.style.display=""),i.appendChild(b)})}else if(a==="Input"){var d=this.createElement("input");r.id?d.id=r.id:d.id=mi("tbr-ipt"),i.appendChild(d),o.appendTo(d)}this.add(i,KN);var g=i.firstElementChild;m(g)||(g.setAttribute("tabindex",m(g.getAttribute("tabIndex"))?"-1":this.getDataTabindex(g)),g.setAttribute("data-tabindex",m(g.getAttribute("tabIndex"))?"-1":this.getDataTabindex(g))),this.tbarEle.push(i)},e.prototype.buttonRendering=function(t,i){var r=this.createElement("button",{className:tq});r.setAttribute("type","button");var n=t.text,a,o;t.id?r.id=t.id:r.id=mi("e-tbr-btn");var l=this.createElement("span",{className:"e-tbar-btn-text"});n?(l.innerHTML=this.enableHtmlSanitizer?Fi.sanitize(n):n,r.appendChild(l),r.classList.add("e-tbtn-txt")):this.add(i,"e-tbtn-align"),(t.prefixIcon||t.suffixIcon)&&(t.prefixIcon&&t.suffixIcon||t.prefixIcon?(a=t.prefixIcon+" e-icons",o="Left"):(a=t.suffixIcon+" e-icons",o="Right"));var h=new Ql({iconCss:a,iconPosition:o});return h.createElement=this.createElement,h.appendTo(r),t.width&&tt(r,{width:qe(t.width)}),r},e.prototype.renderSubComponent=function(t,i){var r,n=this.createElement("div",{className:zi}),a=this.createElement("div",{innerHTML:this.enableHtmlSanitizer&&!m(t.tooltipText)?Fi.sanitize(t.tooltipText):t.tooltipText});if(this.tbarEle||(this.tbarEle=[]),t.htmlAttributes&&this.setAttr(t.htmlAttributes,n),t.tooltipText&&n.setAttribute("title",a.textContent),t.cssClass&&(n.className=n.className+" "+t.cssClass),t.template)this.templateRender(t.template,n,t,i);else switch(t.type){case"Button":r=this.buttonRendering(t,n),r.setAttribute("tabindex",m(t.tabIndex)?"-1":t.tabIndex.toString()),r.setAttribute("data-tabindex",m(t.tabIndex)?"-1":t.tabIndex.toString()),r.setAttribute("aria-label",t.text||t.tooltipText),r.setAttribute("aria-disabled","false"),n.appendChild(r),n.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(n,Gi);break}if(t.showTextOn){var o=t.showTextOn;o==="Toolbar"?(this.add(n,ZN),this.add(n,"e-tbtn-align")):o==="Overflow"&&this.add(n,LS)}if(t.overflow){var l=t.overflow;l==="Show"?this.add(n,ca):l==="Hide"&&(n.classList.contains(Gi)||this.add(n,wm))}return t.overflow!=="Show"&&t.showAlwaysInPopup&&!n.classList.contains(Gi)&&(this.add(n,RS),this.popupPriCount++),t.disabled&&this.add(n,Vn),t.visible===!1&&this.add(n,Co),n},e.prototype.getDataTabindex=function(t){return m(t.getAttribute("data-tabindex"))?"-1":t.getAttribute("data-tabindex")},e.prototype.itemClick=function(t){this.activeEleSwitch(t.currentTarget)},e.prototype.activeEleSwitch=function(t){this.activeEleRemove(t.firstElementChild),this.activeEle.focus()},e.prototype.activeEleRemove=function(t){if(m(this.activeEle)||this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)),this.activeEle=t,this.getDataTabindex(this.activeEle)==="-1")if(m(this.trgtEle)&&!t.parentElement.classList.contains(KN))this.updateTabIndex("-1"),t.removeAttribute("tabindex");else{var i=parseInt(this.getDataTabindex(this.activeEle))+1;this.activeEle.setAttribute("tabindex",i.toString())}},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"toolbar"},e.prototype.itemsRerender=function(t){this.items=this.tbarItemsCol,(this.isReact||this.isAngular)&&this.clearTemplate(),this.destroyMode(),this.destroyItems(),this.items=t,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},e.prototype.resize=function(){var t=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&this.overflowMode==="Popup"&&this.popObj.hide();var i=this.checkOverflow(t,t.getElementsByClassName(Li)[0]);if(!i){this.destroyScroll();var r=t.querySelector("."+Li);m(r)||(this.remove(r,ik),this.tbarAlign&&this.add(r,da))}if(!(i&&this.scrollModule&&this.offsetWid===t.offsetWidth)){if((this.offsetWid>t.offsetWidth||i)&&this.renderOverflowMode(),this.popObj){if(this.overflowMode==="Extended"){var n=window.getComputedStyle(this.element);this.popObj.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)*2}this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()}this.element.querySelector("."+OS)&&(this.scrollStep=this.element.querySelector("."+OS).offsetWidth),this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator()}},e.prototype.orientationChange=function(){var t=this;setTimeout(function(){t.resize()},500)},e.prototype.extendedOpen=function(){var t=this.element.querySelector("."+Mm);this.overflowMode==="Extended"&&t&&(this.isExtendedOpen=t.classList.contains(XN))},e.prototype.updateHideEleTabIndex=function(t,i,r,n,a){r&&(n=a.indexOf(t));for(var o=a[++n];o;){var l=this.eleContains(o);if(!l){var h=o.firstElementChild.getAttribute("data-tabindex");i&&h==="-1"?o.firstElementChild.setAttribute("tabindex","0"):h!==o.firstElementChild.getAttribute("tabindex")&&o.firstElementChild.setAttribute("tabindex",h);break}o=a[++n]}},e.prototype.clearToolbarTemplate=function(t){if(this.registeredTemplate&&this.registeredTemplate.template)for(var i=this.registeredTemplate,r=0;r<i.template.length;r++){var n=i.template[parseInt(r.toString(),10)].rootNodes[0],a=U(n,"."+zi);if(!m(a)&&a===t){this.clearTemplate(["template"],[i.template[parseInt(r.toString(),10)]]);break}}else if(this.portals&&this.portals.length>0)for(var o=this.portals,r=0;r<o.length;r++){var l=o[parseInt(r.toString(),10)],a=U(l.containerInfo,"."+zi);if(!m(a)&&a===t){this.clearTemplate(["template"],r);break}}},e.prototype.onPropertyChanged=function(t,i){var r=this.element;r.offsetWidth,this.extendedOpen();for(var n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"items":if(t.items instanceof Array&&i.items instanceof Array)this.itemsRerender(t.items);else for(var l=Object.keys(t.items),h=0;h<l.length;h++){var u=parseInt(Object.keys(t.items)[parseInt(h.toString(),10)],10),c=Object.keys(t.items[parseInt(u.toString(),10)])[0],d=Object(t.items[parseInt(u.toString(),10)])[""+c];if(this.tbarAlign||c==="align"){this.refresh(),this.trigger("created");break}var p=c==="showAlwaysInPopup"&&!d,f=c==="overflow"&&this.popupPriCount!==0;(p||this.items[parseInt(u.toString(),10)].showAlwaysInPopup&&f)&&--this.popupPriCount,m(this.scrollModule)&&this.destroyMode();var v=[].slice.call(ze("."+Li+" ."+zi,r));this.isReact&&this.items[parseInt(u.toString(),10)].template&&this.clearToolbarTemplate(v[parseInt(u.toString(),10)]),ne(v[parseInt(u.toString(),10)]),this.tbarEle.splice(u,1),this.addItems([this.items[parseInt(u.toString(),10)]],u),this.items.splice(u,1),this.items[parseInt(u.toString(),10)].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":tt(r,{width:qe(t.width)}),this.refreshOverflow();break;case"height":tt(this.element,{height:qe(t.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(r,Va),this.refreshOverflow();break;case"enableRtl":t.enableRtl?this.add(r,Va):this.remove(r,Va),m(this.scrollModule)||(t.enableRtl?this.add(this.scrollModule.element,Va):this.remove(this.scrollModule.element,Va)),m(this.popObj)||(t.enableRtl?this.add(this.popObj.element,Va):this.remove(this.popObj.element,Va)),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"});break;case"cssClass":i.cssClass&&te([this.element],i.cssClass.split(" ")),t.cssClass&&Q([this.element],t.cssClass.split(" "));break;case"allowKeyboard":this.unwireKeyboardEvent(),t.allowKeyboard&&this.wireKeyboardEvent();break}}},e.prototype.hideItem=function(t,i){var r=typeof t=="object",n=t,a;if(!(!r&&m(n))){var o=[].slice.call(ze("."+zi,this.element));if(r)a=t;else if(this.tbarEle[parseInt(n.toString(),10)]){var l=[].slice.call(ze("."+zi,this.element));a=l[parseInt(n.toString(),10)]}a&&(i?(a.classList.add(Co),a.classList.contains(Gi)||(m(a.firstElementChild.getAttribute("tabindex"))||a.firstElementChild.getAttribute("tabindex")!=="-1")&&this.updateHideEleTabIndex(a,i,r,n,o)):(a.classList.remove(Co),a.classList.contains(Gi)||this.updateHideEleTabIndex(a,i,r,n,o)),this.refreshOverflow())}},bi([ii([],VI)],e.prototype,"items",void 0),bi([S("auto")],e.prototype,"width",void 0),bi([S("auto")],e.prototype,"height",void 0),bi([S("")],e.prototype,"cssClass",void 0),bi([S("Scrollable")],e.prototype,"overflowMode",void 0),bi([S()],e.prototype,"scrollStep",void 0),bi([S(!0)],e.prototype,"enableCollision",void 0),bi([S(!0)],e.prototype,"enableHtmlSanitizer",void 0),bi([S(!0)],e.prototype,"allowKeyboard",void 0),bi([_()],e.prototype,"clicked",void 0),bi([_()],e.prototype,"created",void 0),bi([_()],e.prototype,"destroyed",void 0),bi([_()],e.prototype,"beforeCreate",void 0),e=bi([Ot],e),e}(Pi),hq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Em=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Wz=function(s){hq(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){this.isMenu=!1,this.element.id=this.element.id||mi("ej2-contextmenu"),s.prototype.preRender.call(this)},e.prototype.initialize=function(){s.prototype.initialize.call(this),De(this.element,{role:"menubar",tabindex:"0"}),this.element.style.zIndex=bu(this.element).toString()},e.prototype.open=function(t,i,r){s.prototype.openMenu.call(this,null,null,t,i,null,r)},e.prototype.close=function(){s.prototype.closeMenu.call(this)},e.prototype.onPropertyChanged=function(t,i){s.prototype.onPropertyChanged.call(this,t,i);for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"filter":this.close(),this.filter=t.filter;break;case"target":this.unWireEvents(i.target),this.wireEvents();break}}},e.prototype.getModuleName=function(){return"contextmenu"},Em([S("")],e.prototype,"target",void 0),Em([S("")],e.prototype,"filter",void 0),Em([ii([],ef)],e.prototype,"items",void 0),e=Em([Ot],e),e}(Uz),uq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),So=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},pa="e-vertical",cq="e-scrollable",jS="e-hamburger",rc=function(s){uq(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.tempItems=[],r}return e.prototype.getModuleName=function(){return"menu"},e.prototype.preRender=function(){if(this.isMenu=!0,this.element.id=this.element.id||mi("ej2-menu"),this.template){try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&(this.template=document.querySelector(this.template).innerHTML.trim(),this.clearChanges())}catch{}this.updateMenuItems(this.items)}else this.updateMenuItems(this.items);s.prototype.preRender.call(this)},e.prototype.initialize=function(){s.prototype.initialize.call(this),De(this.element,{role:"menubar",tabindex:"0"}),this.orientation==="Vertical"?(this.element.classList.add(pa),this.hamburgerMode&&!this.target&&this.element.previousElementSibling.classList.add(pa),this.element.setAttribute("aria-orientation","vertical")):B.isDevice&&!this.enableScrolling&&this.element.parentElement.classList.add(cq),this.hamburgerMode&&(this.element.parentElement.classList.add(jS),this.orientation==="Horizontal"&&this.element.classList.add("e-hide-menu"))},e.prototype.updateMenuItems=function(t){this.tempItems=t,this.items=[],this.tempItems.map(this.createMenuItems,this),this.setProperties({items:this.items},!0),this.tempItems=[]},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"orientation":t.orientation==="Vertical"?(this.element.classList.add(pa),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.add(pa),this.element.classList.remove("e-hide-menu")),this.element.setAttribute("aria-orientation","vertical")):(this.element.classList.remove(pa),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.remove(pa),this.element.classList.add("e-hide-menu")),this.element.removeAttribute("aria-orientation"));break;case"items":Object.keys(i.items).length||this.updateMenuItems(t.items);break;case"hamburgerMode":this.element.previousElementSibling||s.prototype.createHeaderContainer.call(this),t.hamburgerMode?(this.element.parentElement.classList.add(jS),[].slice.call(this.element.getElementsByClassName("e-blankicon")).forEach(function(l){l.style[r.enableRtl?"paddingRight":"paddingLeft"]=""})):(this.element.parentElement.classList.remove(jS),this.orientation==="Vertical"&&this.setBlankIconStyle(this.element)),this.orientation==="Vertical"?(this.target||this.element.previousElementSibling.classList.add(pa),this.element.classList.remove("e-hide-menu")):(this.target?this.element.previousElementSibling.classList.add(pa):this.element.previousElementSibling.classList.remove(pa),this.element.classList[t.hamburgerMode?"add":"remove"]("e-hide-menu"));break;case"title":this.hamburgerMode&&this.element.previousElementSibling&&(t.title=this.enableHtmlSanitizer?Fi.sanitize(t.title):t.title,this.element.previousElementSibling.querySelector(".e-menu-title").innerHTML=t.title);break;case"target":this.hamburgerMode&&(this.unWireEvents(i.target),this.wireEvents(),this.orientation==="Horizontal"&&(t.target?this.element.previousElementSibling.classList.add(pa):(this.element.previousElementSibling||s.prototype.createHeaderContainer.call(this),this.element.previousElementSibling.classList.remove(pa)),this.element.classList.add("e-hide-menu")));break}}s.prototype.onPropertyChanged.call(this,t,i)},e.prototype.createMenuItems=function(t){var i,r,n=this.items,a=this.getField("parentId");if(t[""+a]){for(i=this.getIndex(t[""+a].toString(),!0),r=0;r<i.length;r++)n[i[r]].items||(n[i[r]].items=[]),n=n[i[r]].items;n.push(t)}else this.items.push(t)},e.prototype.open=function(){s.prototype.openHamburgerMenu.call(this)},e.prototype.close=function(){s.prototype.closeHamburgerMenu.call(this)},So([S("Horizontal")],e.prototype,"orientation",void 0),So([S("")],e.prototype,"target",void 0),So([S(null)],e.prototype,"template",void 0),So([S(!1)],e.prototype,"enableScrolling",void 0),So([S(!1)],e.prototype,"hamburgerMode",void 0),So([S("Menu")],e.prototype,"title",void 0),So([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),So([Ee({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},Vz)],e.prototype,"fields",void 0),e=So([Ot],e),e}(Uz),Dv=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Dt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ol="e-tab",on="e-tab-header",dq="blazor-template",Qt="e-content",Im="e-nested",pq="e-items",nr="e-item",BS="e-template",HS="e-rtl",hi="e-active",ll="e-disable",Ni="e-hidden",VS="e-focused",US="e-icons",_S="e-icon",nk="e-icon-tab",WS="e-close-icon",Tm="e-close-show",cp="e-tab-text",Dm="e-indicator",js="e-tab-wrap",Am="e-text-wrap",sk="e-tab-icon",ts="e-toolbar-items",zt="e-toolbar-item",ak="e-toolbar-pop",xo="e-toolbar-popup",fq="e-hor-nav",vq="e-popup-open",mq="e-popup-close",Nm="e-progress",gq="e-ignore",qS="e-overlay",yq="e-hscroll-content",bq="e-vscroll-content",YS="e-vertical-tab",QS="e-vertical",ok="e-vertical-left",lk="e-vertical-right",hk="e-horizontal-bottom",GS="e-fill-mode",uk="tabitem_",$S="e-reorder-active-item",ck=function(s){Dv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Dt([S("SlideLeftIn")],e.prototype,"effect",void 0),Dt([S(600)],e.prototype,"duration",void 0),Dt([S("ease")],e.prototype,"easing",void 0),e}(ke),Cq=function(s){Dv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Dt([Ee({effect:"SlideLeftIn",duration:600,easing:"ease"},ck)],e.prototype,"previous",void 0),Dt([Ee({effect:"SlideRightIn",duration:600,easing:"ease"},ck)],e.prototype,"next",void 0),e}(ke),Sq=function(s){Dv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Dt([S("")],e.prototype,"text",void 0),Dt([S("")],e.prototype,"iconCss",void 0),Dt([S("left")],e.prototype,"iconPosition",void 0),e}(ke),xq=function(s){Dv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Dt([Ee({},Sq)],e.prototype,"header",void 0),Dt([S(null)],e.prototype,"headerTemplate",void 0),Dt([S("")],e.prototype,"content",void 0),Dt([S("")],e.prototype,"cssClass",void 0),Dt([S(!1)],e.prototype,"disabled",void 0),Dt([S(!0)],e.prototype,"visible",void 0),Dt([S()],e.prototype,"id",void 0),Dt([S(-1)],e.prototype,"tabIndex",void 0),e}(ke),UI=function(s){Dv(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.show={},r.hide={},r.maxHeight=0,r.title="Close",r.isInteracted=!1,r.lastIndex=0,r.isAdd=!1,r.isIconAlone=!1,r.draggableItems=[],r.resizeContext=r.refreshActiveTabBorder.bind(r),r.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},r}return e.prototype.destroy=function(){if((this.isReact||this.isAngular)&&this.clearTemplate(),m(this.tbObj)||(this.tbObj.destroy(),this.tbObj=null),this.unWireEvents(),this.element.removeAttribute("aria-disabled"),this.expTemplateContent(),this.isTemplate){var t=$("."+ol+" > ."+Qt,this.element);this.element.classList.remove(BS),m(t)||(t.innerHTML=this.cnt)}else for(;this.element.firstElementChild;)pt(this.element.firstElementChild);if(this.btnCls&&(this.btnCls=null),this.hdrEle=null,this.cntEle=null,this.tbItems=null,this.tbItem=null,this.tbPop=null,this.prevItem=null,this.popEle=null,this.bdrLine=null,this.content=null,this.dragItem=null,this.cloneElement=null,this.draggingItems=[],this.draggableItems&&this.draggableItems.length>0){for(var i=0;i<this.draggableItems.length;i++)this.draggableItems[i].destroy(),this.draggableItems[i]=null;this.draggableItems=[]}s.prototype.destroy.call(this),this.trigger("destroyed")},e.prototype.refresh=function(){this.isReact&&this.clearTemplate(),s.prototype.refresh.call(this),this.isReact&&this.renderReactTemplates()},e.prototype.preRender=function(){var t=U(this.element,"."+Qt);this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwiped=!1,this.itemIndexArray=[],this.templateEle=[],this.allowDragAndDrop&&(this.dragArea=m(this.dragArea)?"#"+this.element.id+" "+("."+on):this.dragArea),m(t)||(t.parentElement.classList.add(Im),this.isNested=!0);var i=B.info.name,r=i==="msie"?"e-ie":i==="edge"?"e-edge":i==="safari"?"e-safari":"";tt(this.element,{width:qe(this.width),height:qe(this.height)}),this.setCssClass(this.element,this.cssClass,!0),De(this.element,{"aria-disabled":"false"}),this.setCssClass(this.element,r,!0),this.updatePopAnimationConfig()},e.prototype.render=function(){var t=this;this.btnCls=this.createElement("span",{className:US+" "+WS,attrs:{title:this.title}}),this.tabId=this.element.id.length>0?"-"+this.element.id:TW(),this.renderContainer(),this.wireEvents(),this.initRender=!1,this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){m(t.tbObj)||t.tbObj.refreshOverflow(),t.refreshActiveBorder()})},e.prototype.renderContainer=function(){var t=this.element;if(this.items.forEach(function(n,a){m(n.id)&&!m(n.setProperties)&&n.setProperties({id:uk+a.toString()},!0)}),this.items.length>0&&t.children.length===0)t.appendChild(this.createElement("div",{className:Qt})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:on})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,t.classList.add(BS);var i=t.querySelector("."+on);i&&this.headerPlacement==="Bottom"&&this.setOrientation(this.headerPlacement,i)}if(!m($("."+on,this.element))&&!m($("."+Qt,this.element))){if(this.renderHeader(),this.tbItems=$("."+on+" ."+ts,this.element),m(this.tbItems)||yr(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),ze("."+zt,this.element).length>0){this.tbItems=$("."+on+" ."+ts,this.element),this.bdrLine=this.createElement("div",{className:Dm+" "+Ni+" "+gq});var r=$("."+this.scrCntClass,this.tbItems);m(r)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):r.insertBefore(this.bdrLine,r.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}},e.prototype.renderHeader=function(){var t=this,i=this.headerPlacement,r=[];if(this.hdrEle=this.getTabHeader(),this.addVerticalClass(),!this.isTemplate)r=this.parseObject(this.items,0);else{this.element.children.length>1&&this.element.children[1].classList.contains(on)&&this.setProperties({headerPlacement:"Bottom"},!0);for(var n=this.hdrEle.children.length,a=[],o=0;o<n;o++)a.push(this.hdrEle.children.item(o));if(n>0){var l=this.createElement("div",{className:pq});this.hdrEle.appendChild(l),a.forEach(function(u,c){t.lastIndex=c;var d={className:nr,id:nr+t.tabId+"_"+c},p=t.createElement("span",{className:cp,attrs:{role:"presentation"}}).outerHTML,f=t.createElement("div",{className:Am,innerHTML:p+t.btnCls.outerHTML}).outerHTML,v=t.createElement("div",{className:js,innerHTML:f,attrs:{role:"tab",tabIndex:"-1","aria-selected":"false","aria-controls":Qt+t.tabId+"_"+c,"aria-disabled":"false"}});v.querySelector("."+cp).appendChild(u),l.appendChild(t.createElement("div",d)),ze("."+nr,l)[c].appendChild(v)})}}this.tbObj=new ov({width:i==="Left"||i==="Right"?"auto":"100%",height:i==="Left"||i==="Right"?"100%":"auto",overflowMode:this.overflowMode,items:r.length!==0?r:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep,enableHtmlSanitizer:this.enableHtmlSanitizer,cssClass:this.cssClass}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle),De(this.hdrEle,{role:"tablist"}),m(this.element.getAttribute("aria-label"))?m(this.element.getAttribute("aria-labelledby"))||(this.hdrEle.setAttribute("aria-labelledby",this.element.getAttribute("aria-labelledby")),this.element.removeAttribute("aria-labelledby")):(this.hdrEle.setAttribute("aria-label",this.element.getAttribute("aria-label")),this.element.removeAttribute("aria-label")),this.setCloseButton(this.showCloseButton);var h=this.tbObj.element.querySelector("."+ts);m(h)||(m(h.id)||h.id==="")&&(h.id=this.element.id+"_tab_header_items")},e.prototype.renderContent=function(){this.cntEle=$("."+Qt,this.element);var t=ze("."+zt,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var i=this.cntEle.children,r=0;r<t.length;r++)i.length-1>=r&&(Q([i.item(r)],nr),De(i.item(r),{role:"tabpanel","aria-labelledby":nr+this.tabId+"_"+r}),i.item(r).id=Qt+this.tabId+"_"+r)}},e.prototype.reRenderItems=function(){this.renderContainer(),m(this.cntEle)||(this.touchModule=new Pn(this.cntEle,{swipe:this.swipeHandler.bind(this)}))},e.prototype.parseObject=function(t,i){var r=this,n=Array.prototype.slice.call(ze(".e-tab-header ."+zt,this.element)),a=this.lastIndex;if(!this.isReplace&&n.length>0){var o=[];n.forEach(function(c){o.push(r.getIndexFromEle(c.id))}),a=Math.max.apply(Math,o)}var l=[],h,u=[];return t.forEach(function(c,d){var p=m(c.header)||m(c.header.iconPosition)?"":c.header.iconPosition,f=m(c.header)||m(c.header.iconCss)?"":c.header.iconCss;if(m(c.headerTemplate)&&(m(c.header)||m(c.header.text)||c.header.text.length===0&&f==="")){u.push(d);return}var v=c.headerTemplate||c.header.text;typeof v=="string"&&r.enableHtmlSanitizer&&(v=Fi.sanitize(v));var g;r.isReplace&&!m(r.tbId)&&r.tbId!==""?(g=parseInt(r.tbId.substring(r.tbId.lastIndexOf("_")+1),10),r.tbId=""):g=i+d,r.lastIndex=n.length===0?d:r.isReplace?g:a+1+d;var b=c.disabled?" "+ll+" "+qS:"",y=c.visible===!1?" "+Ni:"";h=r.createElement("div",{className:cp,attrs:{role:"presentation"}});var C=v instanceof Object?v.outerHTML:v,x=!m(C)&&C!=="";m(v.tagName)?r.headerTextCompile(h,v,d):h.appendChild(v);var w,M=r.createElement("span",{className:US+" "+sk+" "+_S+"-"+p+" "+f}),E=r.createElement("div",{className:Am});E.appendChild(h),v!==""&&v!==void 0&&f!==""?(p==="left"||p==="top"?E.insertBefore(M,E.firstElementChild):E.appendChild(M),w=h,r.isIconAlone=!1):(w=f===""?h:M,w===M&&(ne(h),E.appendChild(M),r.isIconAlone=!0));var T=m(c.tabIndex)?"-1":c.tabIndex.toString(),D=c.disabled?{}:{tabIndex:T,"data-tabindex":T,role:"tab","aria-selected":"false","aria-disabled":"false"};E.appendChild(r.btnCls.cloneNode(!0));var N=r.createElement("div",{className:js,attrs:D});N.appendChild(E),r.itemIndexArray instanceof Array&&r.itemIndexArray.splice(i+d,0,nr+r.tabId+"_"+r.lastIndex);var A={id:nr+r.tabId+"_"+r.lastIndex,"data-id":c.id},L={htmlAttributes:A,template:N};L.cssClass=(c.cssClass!==void 0?c.cssClass:" ")+" "+b+" "+y+" "+(f!==""?"e-i"+p:"")+" "+(x?"":_S),(p==="top"||p==="bottom")&&r.element.classList.add("e-vertical-icon"),l.push(L),d++}),this.isAdd||u.forEach(function(c){r.items.splice(c,1)}),this.isIconAlone?this.element.classList.add(nk):this.element.classList.remove(nk),l},e.prototype.removeActiveClass=function(){var t=this.getTabHeader();if(t){var i=ze("."+zt+"."+hi,t);[].slice.call(i).forEach(function(r){return r.classList.remove(hi)}),[].slice.call(i).forEach(function(r){return r.firstElementChild.setAttribute("aria-selected","false")})}},e.prototype.checkPopupOverflow=function(t){this.tbPop=$("."+ak,this.element);var i=$(".e-hor-nav",this.element),r=$("."+ts,this.element),n=r.lastChild,a=!1;return(!this.isVertical()&&(this.enableRtl&&i.offsetLeft+i.offsetWidth>r.offsetLeft||!this.enableRtl&&i.offsetLeft<r.offsetWidth)||this.isVertical()&&i.offsetTop<n.offsetTop+n.offsetHeight)&&(a=!0),a&&(t.classList.add(xo),this.tbPop.insertBefore(t,ze("."+xo,this.tbPop)[0])),!0},e.prototype.popupHandler=function(t){var i=t.querySelector(".e-ripple-element");m(i)||(i.outerHTML="",t.querySelector("."+js).classList.remove("e-ripple")),this.tbItem=ze("."+ts+" ."+zt,this.hdrEle);var r=this.tbItem[this.tbItem.length-1];if(this.tbItem.length!==0){if(t.classList.remove(xo),t.removeAttribute("style"),this.tbItems.appendChild(t),this.actEleId=t.id,this.checkPopupOverflow(r)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return ze("."+zt,this.tbItems).length-1},e.prototype.setCloseButton=function(t){var i=$("."+on,this.element);t===!0?i.classList.add(Tm):i.classList.remove(Tm),this.tbObj.refreshOverflow(),this.refreshActiveTabBorder()},e.prototype.prevCtnAnimation=function(t,i){var r;return this.enableRtl||this.element.classList.contains(HS),this.isPopup||t<=i?this.animation.previous.effect==="SlideLeftIn"?r={name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:r=null:this.animation.next.effect==="SlideRightIn"?r={name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:r=null,r},e.prototype.triggerPrevAnimation=function(t,i){var r=this,n=this.prevCtnAnimation(i,this.selectedItem);m(n)?t.classList.remove(hi):(n.begin=function(){tt(t,{position:"absolute"}),t.classList.add(Nm),t.classList.add("e-view")},n.end=function(){t.style.display="none",t.classList.remove(hi),t.classList.remove(Nm),t.classList.remove("e-view"),tt(t,{display:"",position:""}),t.childNodes.length===0&&!r.isTemplate&&ne(t)},new ri(n).animate(t))},e.prototype.triggerAnimation=function(t,i){var r=this,n=this.prevIndex,a,o=[].slice.call(this.element.querySelector("."+Qt).children);o.forEach(function(g){g.id===r.prevActiveEle&&(a=g)});var l=this.tbItem[n],h=this.getTrgContent(this.cntEle,this.extIndex(t));if(m(a)&&!m(l)){var u=this.extIndex(l.id);a=this.getTrgContent(this.cntEle,u)}m(h)||(this.prevActiveEle=h.id);var c=m(this.animation)||m(this.animation.next.effect)||m(this.animation.previous.effect)||this.animation.previous.effect==="None"||this.animation.next.effect==="None";if(this.initRender||i===!1||c){a&&a!==h&&a.classList.remove(hi);return}var d=$("."+Qt,this.element),p;if(this.prevIndex>this.selectedItem&&!this.isPopup){var f=this.animation.previous.effect;p={name:f==="None"?"":f!=="SlideLeftIn"?f:"SlideLeftIn",duration:this.animation.previous.duration===0&&vi==="Enable"?600:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var v=this.animation.next.effect;p={name:v==="None"?"":v!=="SlideRightIn"?v:"SlideRightIn",duration:this.animation.next.duration===0&&vi==="Enable"?600:this.animation.next.duration,timingFunction:this.animation.next.easing}}p.progress=function(){d.classList.add(Nm),r.setActiveBorder()},p.end=function(){d.classList.remove(Nm),h.classList.add(hi)},!this.initRender&&!m(a)&&this.triggerPrevAnimation(a,n),this.isPopup=!1,p.name===""?h.classList.add(hi):new ri(p).animate(h)},e.prototype.keyPressed=function(t){var i=U(t,"."+on+" ."+zt),r=this.getEleIndex(i);!m(this.popEle)&&t.classList.contains("e-hor-nav")?this.popEle.classList.contains(vq)?this.popObj.hide(this.hide):this.popObj.show(this.show):t.classList.contains("e-scroll-nav")?t.click():!m(i)&&i.classList.contains(hi)===!1&&(this.selectTab(r,null,!0),m(this.popEle)||this.popObj.hide(this.hide))},e.prototype.getTabHeader=function(){if(!m(this.element)){var t=[].slice.call(this.element.children).filter(function(r){return r.classList.contains(on)});if(t.length>0)return t[0];var i=[].slice.call(this.element.children).filter(function(r){return!r.classList.contains(dq)})[0];return i?[].slice.call(i.children).filter(function(r){return r.classList.contains(on)})[0]:void 0}},e.prototype.getEleIndex=function(t){return Array.prototype.indexOf.call(ze("."+zt,this.getTabHeader()),t)},e.prototype.extIndex=function(t){return t.replace(nr+this.tabId+"_","")},e.prototype.expTemplateContent=function(){var t=this;this.templateEle.forEach(function(i){m(t.element.querySelector(i))||(document.body.appendChild(t.element.querySelector(i)).style.display="none")})},e.prototype.templateCompile=function(t,i,r){var n=this.createElement("div");this.compileElement(n,i,"content",r),n.childNodes.length!==0&&t.appendChild(n),this.isReact&&this.renderReactTemplates()},e.prototype.compileElement=function(t,i,r,n){var a;typeof i=="string"?(i=i.trim(),this.isVue?a=pi(Fi.sanitize(i)):t.innerHTML=Fi.sanitize(i)):a=pi(i);var o;m(a)||(o=a({},this,r)),!m(a)&&o.length>0&&[].slice.call(o).forEach(function(l){t.appendChild(l)})},e.prototype.headerTextCompile=function(t,i,r){this.compileElement(t,i,"headerTemplate",r)},e.prototype.getContent=function(t,i,r,n){var a;if(i=m(i)?"":i,typeof i=="string"||m(i.innerHTML))if(typeof i=="string"&&this.enableHtmlSanitizer&&(i=Fi.sanitize(i)),i[0]==="."||i[0]==="#")if(document.querySelectorAll(i).length){var o=document.querySelector(i);a=o.outerHTML.trim(),r==="clone"?t.appendChild(o.cloneNode(!0)):(t.appendChild(o),o.style.display="")}else this.templateCompile(t,i,n);else this.templateCompile(t,i,n);else t.appendChild(i);m(a)||this.templateEle.indexOf(i.toString())===-1&&this.templateEle.push(i.toString())},e.prototype.getTrgContent=function(t,i){var r;return this.element.classList.contains(Im)?r=$("."+Im+"> ."+Qt+" > #"+Qt+this.tabId+"_"+i,this.element):r=this.findEle(t.children,Qt+this.tabId+"_"+i),r},e.prototype.findEle=function(t,i){for(var r,n=0;n<t.length;n++)if(t[n].id===i){r=t[n];break}return r},e.prototype.isVertical=function(){var t=this.headerPlacement==="Left"||this.headerPlacement==="Right";return this.scrCntClass=t?bq:yq,t},e.prototype.addVerticalClass=function(){if(this.isVertical()){var t=this.headerPlacement==="Left"?ok:lk;Q([this.hdrEle],[QS,t]),this.element.classList.contains(Im)?Q([this.hdrEle],[YS,t]):Q([this.element],[YS,t])}this.headerPlacement==="Bottom"&&Q([this.hdrEle],[hk])},e.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},e.prototype.changeOrientation=function(t){this.setOrientation(t,this.hdrEle);var i=this.hdrEle.querySelector("."+hi),r=!!this.hdrEle.classList.contains(QS);te([this.element],[YS]),te([this.hdrEle],[QS,ok,lk]),r!==this.isVertical()&&(this.changeToolbarOrientation(),!m(i)&&i.classList.contains(xo)&&this.popupHandler(i)),this.addVerticalClass(),this.setActiveBorder(),this.focusItem()},e.prototype.focusItem=function(){var t=$(" #"+nr+this.tabId+"_"+this.selectedItem,this.hdrEle);m(t)||t.firstElementChild.focus()},e.prototype.changeToolbarOrientation=function(){this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()},e.prototype.setOrientation=function(t,i){var r=Array.prototype.indexOf.call(this.element.children,i),n=Array.prototype.indexOf.call(this.element.children,this.element.querySelector("."+Qt));t==="Bottom"&&n>r?this.element.appendChild(i):(te([i],[hk]),this.element.insertBefore(i,$("."+Qt,this.element)))},e.prototype.setCssClass=function(t,i,r){if(i!=="")for(var n=i.split(" "),a=0;a<n.length;a++)r?t.classList.add(n[a]):t.classList.remove(n[a])},e.prototype.setContentHeight=function(t){if(this.element.classList.contains(GS)&&te([this.element],[GS]),!m(this.cntEle)){var i=this.getTabHeader();if(this.heightAdjustMode==="None"){if(this.height==="auto")return;this.isVertical()||tt(this.cntEle,{height:this.element.clientHeight-i.offsetHeight+"px"})}else if(this.heightAdjustMode==="Fill")Q([this.element],[GS]),tt(this.element,{height:"100%"}),this.cntEle.style.height="calc(100% - "+this.hdrEle.offsetHeight+"px)";else if(this.heightAdjustMode==="Auto"){if(this.isTemplate===!0)for(var r=ze("."+Qt+" > ."+nr,this.element),n=0;n<r.length;n++)r[n].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(r[n])),r[n].style.removeProperty("display"),r[n].style.removeProperty("visibility");else{this.cntEle=$("."+Qt,this.element),t===!0&&this.cntEle.appendChild(this.createElement("div",{id:Qt+this.tabId+"_0",className:nr+" "+hi,attrs:{role:"tabpanel","aria-labelledby":nr+this.tabId+"_0"}}));for(var a=this.cntEle.children.item(0),n=0;n<this.items.length;n++)for(this.getContent(a,this.items[n].content,"clone",n),this.maxHeight=Math.max(this.maxHeight,this.getHeight(a));a.firstChild;)a.removeChild(a.firstChild);this.isReact&&this.clearTemplate(["content"]),this.templateEle=[],this.getContent(a,this.items[0].content,"render",0),this.prevIndex!==this.selectedItem&&a.classList.remove(hi)}tt(this.cntEle,{height:this.maxHeight+"px"})}else tt(this.cntEle,{height:"auto"})}},e.prototype.getHeight=function(t){var i=window.getComputedStyle(t);return t.offsetHeight+parseFloat(i.getPropertyValue("padding-top"))+parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("margin-top"))+parseFloat(i.getPropertyValue("margin-bottom"))},e.prototype.setActiveBorder=function(){var t=this.getTabHeader(),i=$("."+zt+"."+hi,t);if(!m(i)){this.reorderActiveTab?t&&t.classList.remove($S):(i.classList.contains(xo)&&!this.bdrLine.classList.contains(Ni)&&this.bdrLine.classList.add(Ni),t&&!t.classList.contains($S)&&t.classList.add($S));var r=U(i,"."+ol);if(this.element===r){this.tbItems=$("."+ts,t);var n=$("."+Dm,t),a=$("."+ts+" ."+this.scrCntClass,t);if(this.isVertical()){tt(n,{left:"",right:""});var o=m(a)?this.tbItems.offsetHeight:a.offsetHeight;o!==0?tt(n,{top:i.offsetTop+"px",height:i.offsetHeight+"px"}):tt(n,{top:0,height:0})}else{if(this.overflowMode==="MultiRow"){var l=this.headerPlacement==="Bottom"?i.offsetTop:i.offsetHeight+i.offsetTop;tt(n,{top:l+"px",height:""})}else tt(n,{top:"",height:""});var h=m(a)?this.tbItems.offsetWidth:a.offsetWidth;h!==0?tt(n,{left:i.offsetLeft+"px",right:h-(i.offsetLeft+i.offsetWidth)+"px"}):tt(n,{left:"auto",right:"auto"})}!m(this.bdrLine)&&!i.classList.contains(xo)&&this.bdrLine.classList.remove(Ni)}}},e.prototype.setActive=function(t,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),this.tbItem=ze("."+zt,this.getTabHeader());var n=this.tbItem[t];if(!(t<0||isNaN(t)||this.tbItem.length===0)){if(t>=0&&!i&&(this.allowServerDataBinding=!1,this.setProperties({selectedItem:t},!0),this.allowServerDataBinding=!0,this.initRender||this.serverDataBind()),n.classList.contains(hi)){this.setActiveBorder();return}this.isTemplate||De(n.firstElementChild,{"aria-controls":Qt+this.tabId+"_"+t});var a=n.id;this.removeActiveClass(),n.classList.add(hi),n.firstElementChild.setAttribute("aria-selected","true");var o=Number(this.extIndex(a));if(m(this.prevActiveEle)&&(this.prevActiveEle=Qt+this.tabId+"_"+o),this.isTemplate){if($("."+Qt,this.element).children.length>0){var l=this.findEle($("."+Qt,this.element).children,Qt+this.tabId+"_"+o);m(l)||l.classList.add(hi),this.triggerAnimation(a,this.enableAnimation)}}else{this.cntEle=$("."+ol+" > ."+Qt,this.element);var h=this.getTrgContent(this.cntEle,this.extIndex(a));if(m(h)){this.cntEle.appendChild(this.createElement("div",{id:Qt+this.tabId+"_"+this.extIndex(a),className:nr+" "+hi,attrs:{role:"tabpanel","aria-labelledby":nr+this.tabId+"_"+this.extIndex(a)}}));var u=this.getTrgContent(this.cntEle,this.extIndex(a)),c=Array.prototype.indexOf.call(this.itemIndexArray,a);this.getContent(u,this.items[c].content,"render",c)}else h.classList.add(hi);this.triggerAnimation(a,this.enableAnimation)}if(this.setActiveBorder(),this.refreshItemVisibility(n),!this.initRender&&!i){var d={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:n,selectedIndex:t,selectedContent:$("#"+Qt+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:r,preventFocus:!1};this.trigger("selected",d,function(p){p.preventFocus||n.firstElementChild.focus()})}}},e.prototype.setItems=function(t){this.isReplace=!0,this.tbItems=$("."+ts,this.getTabHeader()),this.tbObj.items=this.parseObject(t,0),this.tbObj.dataBind(),this.isReplace=!1},e.prototype.setRTL=function(t){this.tbObj.enableRtl=t,this.tbObj.dataBind(),this.setCssClass(this.element,HS,t),this.refreshActiveBorder()},e.prototype.refreshActiveBorder=function(){m(this.bdrLine)||this.bdrLine.classList.add(Ni),this.setActiveBorder()},e.prototype.showPopup=function(t){var i=$(".e-popup.e-toolbar-pop",this.hdrEle);if(i&&i.classList.contains("e-popup-close")){var r=i&&i.ej2_instances[0];r.position.X=this.headerPlacement==="Left"?"left":"right",r.dataBind(),r.show(t)}},e.prototype.bindDraggable=function(){var t=this;if(this.allowDragAndDrop){var i=this.element.querySelector("."+on);if(i){var r=Array.prototype.slice.call(i.querySelectorAll("."+zt));r.forEach(function(n){t.initializeDrag(n)})}}},e.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),I.add(this.element,"mouseover",this.hoverHandler,this),I.add(this.element,"keydown",this.spaceKeyDown,this),m(this.cntEle)||(this.touchModule=new Pn(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new wr(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new wr(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},e.prototype.unWireEvents=function(){m(this.keyModule)||this.keyModule.destroy(),m(this.tabKeyModule)||this.tabKeyModule.destroy(),!m(this.cntEle)&&!m(this.touchModule)&&(this.touchModule.destroy(),this.touchModule=null),window.removeEventListener("resize",this.resizeContext),I.remove(this.element,"mouseover",this.hoverHandler),I.remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove(HS),this.element.classList.remove(VS)},e.prototype.clickHandler=function(t){this.element.classList.remove(VS);var i=t.originalEvent.target,r=U(i,"."+zt),n=this.getEleIndex(r);i.classList.contains(WS)?this.removeTab(n):this.isVertical()&&U(i,"."+fq)?this.showPopup(this.show):(this.isPopup=!1,!m(r)&&n!==this.selectedItem&&this.selectTab(n,t.originalEvent,!0))},e.prototype.swipeHandler=function(t){if(!(t.velocity<3&&m(t.originalEvent.changedTouches))){this.isNested&&this.element.setAttribute("data-swipe","true");var i=this.element.querySelector('[data-swipe="true"]');if(i){i.removeAttribute("data-swipe");return}if(this.isSwiped=!0,t.swipeDirection==="Right"&&this.selectedItem!==0){for(var r=this.selectedItem-1;r>=0;r--)if(!this.tbItem[r].classList.contains(Ni)){this.selectTab(r,null,!0);break}}else if(t.swipeDirection==="Left"&&this.selectedItem!==ze("."+zt,this.element).length-1){for(var n=this.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains(Ni)){this.selectTab(n,null,!0);break}}this.isSwiped=!1}},e.prototype.spaceKeyDown=function(t){if(t.keyCode===32&&t.which===32||t.keyCode===35&&t.which===35){var i=U(t.target,"."+on);m(i)||t.preventDefault()}},e.prototype.keyHandler=function(t){if(!this.element.classList.contains(ll)){this.element.classList.add(VS);var i=t.target,r=this.getTabHeader(),n=$("."+hi,r);this.popEle=$("."+ak,r),m(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]);var a=U(document.activeElement,"."+zt),o=U(i,"."+zt);switch(t.action){case"space":case"enter":if(i.parentElement.classList.contains(ll))return;if(t.action==="enter"&&i.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(i);break;case"tab":case"shiftTab":i.classList.contains(js)&&U(i,"."+zt).classList.contains(hi)===!1&&i.setAttribute("tabindex",i.getAttribute("data-tabindex")),this.popObj&&or(this.popObj.element)&&this.popObj.hide(this.hide),!m(n)&&n.children.item(0).getAttribute("tabindex")==="-1"&&n.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":m(a)||this.refreshItemVisibility(a);break;case"openPopup":t.preventDefault(),!m(this.popEle)&&this.popEle.classList.contains(mq)&&this.popObj.show(this.show);break;case"delete":if(this.showCloseButton===!0&&!m(o)){var l=o.nextSibling;!m(l)&&l.classList.contains(zt)&&l.firstElementChild.focus(),this.removeTab(this.getEleIndex(o))}this.setActiveBorder();break}}},e.prototype.refreshItemVisibility=function(t){var i=$("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!m(i)){var r=$(".e-hscroll-bar",this.tbItems),n=r.scrollLeft,a=n+r.offsetWidth,o=t.offsetLeft,l=t.offsetWidth,h=t.offsetLeft+t.offsetWidth;if(n<o&&a<h){var u=a-o;r.scrollLeft=n+(l-u)}else if(n>o&&a>h){var u=h-n;r.scrollLeft=n-(l-u)}}else return},e.prototype.getIndexFromEle=function(t){return parseInt(t.substring(t.lastIndexOf("_")+1),10)},e.prototype.hoverHandler=function(t){var i=t.target;!m(i.classList)&&i.classList.contains(WS)&&i.setAttribute("title",new In("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},e.prototype.evalOnPropertyChangeItems=function(t,i){if(t.items instanceof Array&&i.items instanceof Array)if(this.lastIndex=0,m(this.tbObj))this.reRenderItems();else{(this.isReact||this.isAngular)&&this.clearTemplate(),this.setItems(t.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];for(var w=$("."+ol+" > ."+Qt,this.element);w.firstElementChild;)ne(w.firstElementChild);this.select(this.selectedItem),this.draggableItems=[],this.bindDraggable()}else for(var r=Object.keys(t.items),n=0;n<r.length;n++)for(var a=parseInt(Object.keys(t.items)[n],10),o=Object.keys(t.items[a]),l=0;l<o.length;l++){var h=Object(i.items[a])[o[l]],u=Object(t.items[a])[o[l]],c=this.element.querySelectorAll("."+zt)[a],d=void 0;c&&!m(c.id)&&c.id!==""?d=this.getIndexFromEle(c.id):d=a;var p=$("."+ts+" #"+nr+this.tabId+"_"+d,this.element),f=$("."+Qt+" #"+Qt+this.tabId+"_"+d,this.element);if(o[l]==="header"||o[l]==="headerTemplate"){var v=m(this.items[a].header)||m(this.items[a].header.iconCss)?"":this.items[a].header.iconCss,g=this.items[a].headerTemplate||this.items[a].header.text;if(o[l]==="headerTemplate"&&this.clearTabTemplate(p,o[l],zt),g===""&&v==="")this.removeTab(a);else{this.tbId=c.id;var b=[];b.push(this.items[a]),this.items.splice(a,1),this.itemIndexArray.splice(a,1),this.tbObj.items.splice(a,1);var y=p.classList.contains(Ni);ne(p),this.isReplace=!0,this.addTab(b,a),y&&this.hideTab(a),this.isReplace=!1}}if(o[l]==="content"&&!m(f)){var C=typeof u=="string"||m(u.innerHTML);if(C&&(u[0]==="."||u[0]==="#")&&u.length){var x=document.querySelector(u);f.appendChild(x),x.style.display=""}else u===""&&h[0]==="#"?(document.body.appendChild(this.element.querySelector(h)).style.display="none",f.innerHTML=u):this.isAngular||this.isReact?(this.clearTabTemplate(f,o[l],nr),f.innerHTML="",this.templateCompile(f,u,a)):typeof u!="function"&&(f.innerHTML=u)}o[l]==="cssClass"&&(m(p)||(p.classList.remove(h),p.classList.add(u)),m(f)||(f.classList.remove(h),f.classList.add(u))),o[l]==="disabled"&&this.enableTab(a,u!==!0),o[l]==="visible"&&this.hideTab(a,u!==!0)}},e.prototype.clearTabTemplate=function(t,i,r){if(this.clearTemplates){if(this.registeredTemplate&&this.registeredTemplate[i])for(var n=this.registeredTemplate,a=0;a<n[i].length;a++){var o=n[i][a].rootNodes[0],l=U(o,"."+r);if(!m(l)&&l===t){this.clearTemplate([i],[n[i][a]]);break}}else if(this.portals&&this.portals.length>0)for(var h=this.portals,a=0;a<h.length;a++){var u=h[a],l=U(u.containerInfo,"."+r);if(!m(l)&&l===t){this.clearTemplate([i],a);break}}}},e.prototype.initializeDrag=function(t){var i=this,r=new vI(t,{dragArea:this.dragArea,dragTarget:"."+zt,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(n){var a=i.getEleIndex(i.dragItem),o,l,h={draggedItem:i.dragItem,event:n.event,target:n.target,droppedItem:n.target.closest("."+zt),clonedElement:i.cloneElement,index:a};if(!m(n.target.closest("."+ol))&&!n.target.closest("."+ol).isEqualNode(i.element)&&i.dragArea!=="."+on)i.trigger("dragging",h);else{if(!n.target.closest(i.dragArea)&&i.overflowMode!=="Popup"?(document.body.style.cursor="not-allowed",Q([i.cloneElement],Ni),i.dragItem.classList.contains(Ni)&&te([i.dragItem],Ni),i.dragItem.querySelector("."+js).style.visibility="visible"):(document.body.style.cursor="",i.dragItem.querySelector("."+js).style.visibility="hidden",i.cloneElement.classList.contains(Ni)&&te([i.cloneElement],Ni)),i.overflowMode==="Scrollable"&&!m(i.element.querySelector(".e-hscroll"))){var u=i.element.querySelector(".e-scroll-right-nav"),c=i.element.querySelector(".e-scroll-left-nav"),d=i.element.querySelector(".e-hscroll-bar");!m(u)&&Math.abs(u.offsetWidth/2+u.offsetLeft)>i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&(d.scrollLeft-=10),!m(c)&&Math.abs(c.offsetLeft+c.offsetWidth-i.cloneElement.offsetLeft)>c.offsetWidth/2&&(d.scrollLeft+=10)}i.cloneElement.style.pointerEvents="none",l=U(n.target,"."+zt+".e-draggable");var p=0;i.overflowMode==="Scrollable"&&!m(i.element.querySelector(".e-hscroll"))&&(p=i.element.querySelector(".e-hscroll-content").offsetWidth),l!=null&&!l.isSameNode(i.dragItem)&&l.closest("."+ol).isSameNode(i.dragItem.closest("."+ol))&&(o=i.getEleIndex(l),o<a&&Math.abs(l.offsetLeft+l.offsetWidth-i.cloneElement.offsetLeft)>l.offsetWidth/2&&i.dragAction(l,a,o),o>a&&Math.abs(l.offsetWidth/2)+l.offsetLeft-p<i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&i.dragAction(l,a,o)),i.droppedIndex=i.getEleIndex(i.dragItem),i.trigger("dragging",h)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(r)},e.prototype.helper=function(t){return this.cloneElement=this.createElement("div"),t.element&&(this.cloneElement=t.element.cloneNode(!0),Q([this.cloneElement],"e-tab-clone-element"),this.element.querySelector("."+on).classList.contains(Tm)&&Q([this.cloneElement],Tm),te([this.cloneElement.querySelector("."+js)],"e-ripple"),m(this.cloneElement.querySelector(".e-ripple-element"))||pt(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},e.prototype.itemDragStart=function(t){var i=this;this.draggingItems=this.items.map(function(n){return n}),this.dragItem=t.element;var r={draggedItem:t.element,event:t.event,target:t.target,droppedItem:null,index:this.getEleIndex(this.dragItem),clonedElement:this.cloneElement,cancel:!1};this.trigger("onDragStart",r,function(n){if(n.cancel){var a=t.element.ej2_instances[0];m(a)||a.intDestroy(t.event),ne(i.cloneElement)}else i.removeActiveClass(),Q([i.tbItems.querySelector("."+Dm)],Ni),i.dragItem.querySelector("."+js).style.visibility="hidden"})},e.prototype.dragAction=function(t,i,r){if(this.items.length>0){var n=this.draggingItems[i];this.draggingItems.splice(i,1),this.draggingItems.splice(r,0,n)}if(this.overflowMode==="MultiRow"&&t.parentNode.insertBefore(this.dragItem,t.nextElementSibling),i>r)if(this.dragItem.parentElement.isSameNode(t.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,t);else if(this.overflowMode==="Extended")if(t.isSameNode(t.parentElement.lastChild)){var a=this.dragItem.parentNode;t.parentNode.insertBefore(this.dragItem,t),a.insertBefore(t.parentElement.lastChild,a.childNodes[0])}else this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t);else{var o=t.parentElement.lastChild;if(t.isSameNode(o)){var a=this.dragItem.parentNode;t.parentNode.insertBefore(this.dragItem,t),a.insertBefore(o,a.childNodes[0])}else this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t)}i<r&&(this.dragItem.parentElement.isSameNode(t.parentElement)?this.dragItem.parentNode.insertBefore(this.dragItem,t.nextElementSibling):this.overflowMode==="Extended"?(this.dragItem.parentElement.appendChild(t.parentElement.firstElementChild),t.parentNode.insertBefore(this.dragItem,t.nextSibling)):(this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t)))},e.prototype.itemDragStop=function(t){var i=this;ne(this.cloneElement),this.cloneElement=null,this.dragItem.querySelector("."+js).style.visibility="visible",document.body.style.cursor="";var r={draggedItem:this.dragItem,event:t.event,target:t.target,droppedItem:this.tbItem[this.droppedIndex],clonedElement:null,index:this.droppedIndex,cancel:!1};this.trigger("dragged",r,function(n){n.cancel?i.refresh():i.items.length>0&&i.draggingItems.length>0?(i.items=i.draggingItems,i.selectedItem=i.droppedIndex,i.refresh()):(i.dragItem.querySelector("."+js).style.visibility="",te([i.tbItems.querySelector("."+Dm)],Ni),i.selectTab(i.droppedIndex,null,!0))}),this.dragItem=null},e.prototype.enableTab=function(t,i){var r=ze("."+zt,this.element)[t];m(r)||(i===!0?(r.classList.remove(ll,qS),r.firstElementChild.setAttribute("tabindex",r.firstElementChild.getAttribute("data-tabindex"))):(r.classList.add(ll,qS),r.firstElementChild.removeAttribute("tabindex"),r.classList.contains(hi)&&this.select(t+1)),m(this.items[t])||(this.items[t].disabled=!i,this.dataBind()),r.firstElementChild.setAttribute("aria-disabled",i===!0?"false":"true"))},e.prototype.addTab=function(t,i){var r=this,n={addedItems:t,cancel:!1};this.isReplace?this.addingTabContent(t,i):this.trigger("adding",n,function(a){a.cancel||r.addingTabContent(t,i)}),this.isReact&&this.renderReactTemplates()},e.prototype.addingTabContent=function(t,i){var r=this,n=0;if(this.hdrEle=$("."+on,this.element),m(this.hdrEle))this.items=t,this.reRenderItems(),this.bindDraggable();else{var a=ze(".e-tab-header ."+zt,this.element).length;if(a!==0&&(n=this.lastIndex+1),m(i)&&(i=a-1),a<i||i<0||isNaN(i))return;a===0&&!m(this.hdrEle)&&(this.hdrEle.style.display=""),m(this.bdrLine)||this.bdrLine.classList.add(Ni),this.tbItems=$("."+ts,this.getTabHeader()),this.isAdd=!0;var o=this.parseObject(t,i);this.isAdd=!1;var l=0,h;t.forEach(function(u,c){if(h=u.headerTemplate||u.header.text,m(u.headerTemplate||u.header)||m(h)||h.length===0&&!m(u.header)&&m(u.header.iconCss)||(o[c]&&(m(u.id)&&(u.id=nr+r.tabId+"_"+uk+(n+c).toString()),o[c].htmlAttributes["data-id"]=u.id),r.items.splice(i+l,0,u),l++),r.isTemplate&&!m(u.header)&&!m(u.header.text)){var d=n+c,p=r.createElement("div",{id:Qt+r.tabId+"_"+d,className:nr,attrs:{role:"tabpanel","aria-labelledby":nr+"_"+d}});r.cntEle.insertBefore(p,r.cntEle.children[i+c]);var f=r.getTrgContent(r.cntEle,d.toString());r.getContent(f,u.content,"render",i)}}),this.tbObj.addItems(o,i),this.isReplace||this.trigger("added",{addedItems:t}),this.selectedItem===i?this.select(i):(this.setActiveBorder(),this.tbItem=ze("."+zt,this.getTabHeader())),this.bindDraggable()}},e.prototype.removeTab=function(t){var i=this,r=ze("."+zt,this.element)[t];if(!m(r)){var n={removedItem:r,removedIndex:t,cancel:!1};this.trigger("removing",n,function(a){if(!a.cancel){var o=$("#"+nr+i.tabId+"_"+i.extIndex(r.id),$("."+ts,i.element));m(o)||i.clearTabTemplate(o,"headerTemplate",zt),i.tbObj.removeItems(t),i.allowDragAndDrop&&t!==Array.prototype.indexOf.call(i.itemIndexArray,r.id)&&(t=Array.prototype.indexOf.call(i.itemIndexArray,r.id));var l=i.itemIndexArray.indexOf(r.id);i.items.splice(l,1),i.itemIndexArray.splice(l,1),i.refreshActiveBorder();var h=$("#"+Qt+i.tabId+"_"+i.extIndex(r.id),$("."+Qt,i.element));m(h)||(i.clearTabTemplate(h,"content",nr),ne(h)),i.trigger("removed",a),i.draggableItems&&i.draggableItems.length>0&&(i.draggableItems[t].destroy(),i.draggableItems[t]=null,i.draggableItems.splice(t,1)),r.classList.contains(hi)?(t=t>ze("."+zt+":not(."+xo+")",i.element).length-1?t-1:t,i.enableAnimation=!1,i.selectedItem=t,i.select(t)):t!==i.selectedItem&&(t<i.selectedItem&&(t=i.itemIndexArray.indexOf(i.tbItem[i.selectedItem].id),i.setProperties({selectedItem:t>-1?t:i.selectedItem},!0),i.prevIndex=i.selectedItem),i.tbItem=ze("."+zt,i.getTabHeader())),ze("."+zt,i.element).length===0&&(i.hdrEle.style.display="none"),i.enableAnimation=!0}})}},e.prototype.hideTab=function(t,i){var r,n=ze("."+zt,this.element)[t];if(!m(n)){if(m(i)&&(i=!0),this.bdrLine.classList.add(Ni),i===!0)if(n.classList.add(Ni),r=ze("."+zt+":not(."+Ni+")",this.tbItems),r.length!==0&&n.classList.contains(hi)){if(t!==0)for(var a=t-1;a>=0;a--)if(this.tbItem[a].classList.contains(Ni)){if(a===0){for(var o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains(Ni)){this.select(o);break}}}else{this.select(a);break}else for(var o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains(Ni)){this.select(o);break}}else r.length===0&&this.element.classList.add(Ni);else this.element.classList.remove(Ni),r=ze("."+zt+":not(."+Ni+")",this.tbItems),n.classList.remove(Ni),r.length===0&&this.select(t);this.setActiveBorder(),m(n.firstElementChild)||n.firstElementChild.setAttribute("aria-hidden",""+i),this.overflowMode==="Popup"&&this.tbObj&&this.tbObj.refreshOverflow()}},e.prototype.selectTab=function(t,i,r){i===void 0&&(i=null),r===void 0&&(r=!1),this.isInteracted=r,this.select(t,i)},e.prototype.select=function(t,i){var r=this,n=this.getTabHeader();this.tbItems=$("."+ts,n),this.tbItem=ze("."+zt,n),this.content=$("."+Qt,this.element),this.prevItem=this.tbItem[this.prevIndex],m(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);var a=this.tbItem[t];m(a)?this.selectedID="0":this.selectingID=this.extIndex(a.id),!m(this.prevItem)&&!this.prevItem.classList.contains(ll)&&this.prevItem.children.item(0).setAttribute("tabindex",this.prevItem.firstElementChild.getAttribute("tabindex"));var o={event:i,previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:m(this.content)?null:$("#"+Qt+this.tabId+"_"+this.selectedID,this.content),selectingItem:a,selectingIndex:t,selectingContent:m(this.content)?null:$("#"+Qt+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:this.isInteracted,cancel:!1};this.initRender?this.selectingContent(t,this.isInteracted):this.trigger("selecting",o,function(l){l.cancel||r.selectingContent(t,r.isInteracted)}),this.isInteracted=!1},e.prototype.selectingContent=function(t,i){if(typeof t=="number"){if(!m(this.tbItem[t])&&(this.tbItem[t].classList.contains(ll)||this.tbItem[t].classList.contains(Ni)))for(var r=t+1;r<this.items.length;r++)if(this.items[r].disabled===!1&&this.items[r].visible===!0){t=r;break}else t=0;if(this.tbItem.length>t&&t>=0&&!isNaN(t))if(this.prevIndex=this.selectedItem,this.prevItem=this.tbItem[this.prevIndex],this.tbItem[t].classList.contains(xo)&&this.reorderActiveTab){if(this.setActive(this.popupHandler(this.tbItem[t]),null,i),!m(this.items)&&this.items.length>0&&this.allowDragAndDrop){this.tbItem=ze("."+ts+" ."+zt,this.hdrEle);var n=this.items[t];this.items.splice(t,1),this.items.splice(this.tbItem.length-1,0,n);var a=this.itemIndexArray[t];this.itemIndexArray.splice(t,1),this.itemIndexArray.splice(this.tbItem.length-1,0,a)}}else this.setActive(t,null,i);else this.setActive(0,null,i)}else t instanceof HTMLElement&&this.setActive(this.getEleIndex(t),null,i)},e.prototype.getItemIndex=function(t){for(var i,r=0;r<this.tbItem.length;r++){var n=this.tbItem[r].getAttribute("data-id");if(t===n){i=r;break}}return i},e.prototype.disable=function(t){this.setCssClass(this.element,ll,t),this.element.setAttribute("aria-disabled",""+t)},e.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},e.prototype.getModuleName=function(){return"tab"},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"width":tt(this.element,{width:qe(t.width)});break;case"height":tt(this.element,{height:qe(t.height)}),this.setContentHeight(!1);break;case"cssClass":var l=this.element.querySelector("."+on);i.cssClass!==""&&!m(i.cssClass)?(this.setCssClass(this.element,i.cssClass,!1),this.setCssClass(this.element,t.cssClass,!0),m(l)||(this.setCssClass(l,i.cssClass,!1),this.setCssClass(l,t.cssClass,!0))):(this.setCssClass(this.element,t.cssClass,!0),m(l)||this.setCssClass(l,t.cssClass,!0));break;case"items":this.evalOnPropertyChangeItems(t,i);break;case"showCloseButton":this.setCloseButton(t.showCloseButton);break;case"reorderActiveTab":this.refreshActiveTabBorder();break;case"selectedItem":this.selectedItem=i.selectedItem,this.select(t.selectedItem);break;case"headerPlacement":this.changeOrientation(t.headerPlacement);break;case"enableRtl":this.setRTL(t.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=t.overflowMode,this.tbObj.dataBind(),this.refreshActiveTabBorder();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep);break;case"allowDragAndDrop":this.bindDraggable();break;case"dragArea":this.allowDragAndDrop&&(this.draggableItems.forEach(function(h){h.dragArea=r.dragArea}),this.refresh());break}}},e.prototype.refreshActiveTab=function(){if(this.isReact&&this.isTemplate&&this.clearTemplate(),this.isTemplate){var b=this.element.querySelector("."+ts),y=this.element.querySelector("."+zt+"."+hi),C=this.getIndexFromEle(y.id),x=y.innerText,w=this.element.querySelector("."+Qt).querySelector("."+hi).children[0],M=w.innerHTML;ne(y),ne(w);var E={className:zt+" "+BS+" "+hi,id:nr+this.tabId+"_"+C},T=this.createElement("span",{className:cp,innerHTML:x,attrs:{role:"presentation"}}).outerHTML,D=this.createElement("div",{className:Am,innerHTML:T+this.btnCls.outerHTML}).outerHTML,u=y.firstElementChild.getAttribute("data-tabindex"),N=this.createElement("div",{className:js,innerHTML:D,attrs:{tabIndex:u,"data-tabindex":u,role:"tab","aria-controls":Qt+this.tabId+"_"+C,"aria-selected":"true","aria-disabled":"false"}});b.insertBefore(this.createElement("div",E),b.children[C+1]),this.element.querySelector("."+zt+"."+hi).appendChild(N);var p=this.createElement("div",{innerHTML:M});this.element.querySelector("."+Qt).querySelector("."+hi).appendChild(p)}else if(this.element.querySelector("."+zt+"."+hi)){ne(this.element.querySelector("."+zt+"."+hi).children[0]),ne(this.element.querySelector("."+Qt).querySelector("."+hi).children[0]);var t=this.items[this.selectedItem],i=m(t.header)||m(t.header.iconPosition)?"":t.header.iconPosition,r=m(t.header)||m(t.header.iconCss)?"":t.header.iconCss,n=t.headerTemplate||t.header.text,a=this.createElement("div",{className:cp,attrs:{role:"presentation"}});m(n.tagName)?this.headerTextCompile(a,n,this.selectedItem):a.appendChild(n);var o=void 0,l=this.createElement("span",{className:US+" "+sk+" "+_S+"-"+i+" "+r}),h=this.createElement("div",{className:Am});h.appendChild(a),n!==""&&n!==void 0&&r!==""?(i==="left"||i==="top"?h.insertBefore(l,h.firstElementChild):h.appendChild(l),o=a,this.isIconAlone=!1):(o=r===""?a:l,o===l&&(ne(a),h.appendChild(l),this.isIconAlone=!0));var u=m(t.tabIndex)?"-1":t.tabIndex.toString(),c=t.disabled?{}:{tabIndex:u,"data-tabindex":u,role:"tab","aria-selected":"true","aria-disabled":"false"};h.appendChild(this.btnCls.cloneNode(!0));var d=this.createElement("div",{className:js,attrs:c});d.appendChild(h),(i==="top"||i==="bottom")&&this.element.classList.add("e-vertical-icon"),this.element.querySelector("."+zt+"."+hi).appendChild(d);var p=this.createElement("div"),f=t.content,v=void 0;if(typeof f=="string"||m(f.innerHTML))if(typeof f=="string"&&this.enableHtmlSanitizer&&(f=Fi.sanitize(f)),f[0]==="."||f[0]==="#")if(document.querySelectorAll(f).length){var g=document.querySelector(f);v=g.outerHTML.trim(),p.appendChild(g),g.style.display=""}else this.compileElement(p,f,"content",this.selectedItem);else this.compileElement(p,f,"content",this.selectedItem);else p.appendChild(f);m(v)||this.templateEle.indexOf(f.toString())===-1&&this.templateEle.push(f.toString()),this.element.querySelector("."+nr+"."+hi).appendChild(p)}this.isReact&&this.renderReactTemplates()},e.prototype.refreshActiveTabBorder=function(){var t=$("."+zt+"."+xo+"."+hi,this.element);!m(t)&&this.reorderActiveTab&&this.select(this.getEleIndex(t)),this.refreshActiveBorder()},Dt([ii([],xq)],e.prototype,"items",void 0),Dt([S("100%")],e.prototype,"width",void 0),Dt([S("auto")],e.prototype,"height",void 0),Dt([S("")],e.prototype,"cssClass",void 0),Dt([S(0)],e.prototype,"selectedItem",void 0),Dt([S("Top")],e.prototype,"headerPlacement",void 0),Dt([S("Content")],e.prototype,"heightAdjustMode",void 0),Dt([S("Scrollable")],e.prototype,"overflowMode",void 0),Dt([S("Dynamic")],e.prototype,"loadOn",void 0),Dt([S(!1)],e.prototype,"enablePersistence",void 0),Dt([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),Dt([S(!1)],e.prototype,"showCloseButton",void 0),Dt([S(!0)],e.prototype,"reorderActiveTab",void 0),Dt([S()],e.prototype,"scrollStep",void 0),Dt([S()],e.prototype,"dragArea",void 0),Dt([S(!1)],e.prototype,"allowDragAndDrop",void 0),Dt([S(!0)],e.prototype,"clearTemplates",void 0),Dt([Ee({},Cq)],e.prototype,"animation",void 0),Dt([_()],e.prototype,"created",void 0),Dt([_()],e.prototype,"adding",void 0),Dt([_()],e.prototype,"added",void 0),Dt([_()],e.prototype,"selecting",void 0),Dt([_()],e.prototype,"selected",void 0),Dt([_()],e.prototype,"removing",void 0),Dt([_()],e.prototype,"removed",void 0),Dt([_()],e.prototype,"onDragStart",void 0),Dt([_()],e.prototype,"dragging",void 0),Dt([_()],e.prototype,"dragged",void 0),Dt([_()],e.prototype,"destroyed",void 0),e=Dt([Ot],e),e}(Pi),Ge={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",FLOATTEXTCONTENT:"e-float-text-content",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},ye;(function(s){var e,t=!0;function i(H,V){var re=m(V)?St:V,he={container:null,buttons:[],clearButton:null};if(e=H.floatLabelType,t=H.bindClearAction,m(H.floatLabelType)||H.floatLabelType==="Never"?(he.container=x(H,Ge.INPUTGROUP,Ge.INPUTCUSTOMTAG,"span",re),H.element.parentNode.insertBefore(he.container,H.element),Q([H.element],Ge.INPUT),he.container.appendChild(H.element)):u(H,he,re),r(H),!m(H.properties)&&!m(H.properties.showClearButton)&&H.properties.showClearButton&&(O(H.properties.showClearButton,H.element,he,!0,re),he.clearButton.setAttribute("role","button"),he.container.classList.contains(Ge.FLOATINPUT)&&Q([he.container],Ge.INPUTGROUP)),!m(H.buttons))for(var Ie=0;Ie<H.buttons.length;Ie++)he.buttons.push(Ne(H.buttons[Ie],he.container,re));return!m(H.element)&&H.element.tagName==="TEXTAREA"&&Q([he.container],Ge.TEXTAREA),we(he.container,H.element),he=d(H,he),z(he.container,re),he}s.createInput=i;function r(H){n(H.floatLabelType,H.element),H.element.addEventListener("focus",function(){var V=v(this);(V.classList.contains("e-input-group")||V.classList.contains("e-outline")||V.classList.contains("e-filled"))&&V.classList.add("e-input-focus"),H.floatLabelType==="Auto"&&setTimeout(function(){s.calculateWidth(H.element,V)},80)}),H.element.addEventListener("blur",function(){var V=v(this);(V.classList.contains("e-input-group")||V.classList.contains("e-outline")||V.classList.contains("e-filled"))&&V.classList.remove("e-input-focus"),H.floatLabelType==="Auto"&&H.element.value===""&&setTimeout(function(){s.calculateWidth(H.element,V)},80)}),H.element.addEventListener("input",function(){n(e,H.element)})}s.bindInitialEvent=r;function n(H,V){var re=V.value,he=V.parentElement,Ie=he.parentElement;re!==""&&!m(re)?he&&he.classList.contains("e-input-group")?he.classList.add("e-valid-input"):Ie&&Ie.classList.contains("e-input-group")&&Ie.classList.add("e-valid-input"):H!=="Always"&&(he&&he.classList.contains("e-input-group")?he.classList.remove("e-valid-input"):Ie&&Ie.classList.contains("e-input-group")&&Ie.classList.remove("e-valid-input"))}function a(){var H=v(this).getElementsByClassName("e-float-text")[0];m(H)||(Q([H],Ge.LABELTOP),H.classList.contains(Ge.LABELBOTTOM)&&te([H],Ge.LABELBOTTOM))}function o(){var H=v(this);if(H.getElementsByTagName("textarea")[0]?H.getElementsByTagName("textarea")[0].value==="":H.getElementsByTagName("input")[0].value===""){var V=H.getElementsByClassName("e-float-text")[0];m(V)||(V.classList.contains(Ge.LABELTOP)&&te([V],Ge.LABELTOP),Q([V],Ge.LABELBOTTOM))}}function l(H){H.addEventListener("focus",a),H.addEventListener("blur",o)}s.wireFloatingEvents=l;function h(H){H.removeEventListener("focus",a),H.removeEventListener("blur",o)}function u(H,V,re){var he=m(re)?St:re;H.floatLabelType==="Auto"&&l(H.element),m(V.container)?(V.container=x(H,Ge.FLOATINPUT,Ge.FLOATCUSTOMTAG,"div",he),V.container.classList.add(Ge.INPUTGROUP),H.element.parentNode&&H.element.parentNode.insertBefore(V.container,H.element)):(m(H.customTag)||V.container.classList.add(Ge.FLOATCUSTOMTAG),V.container.classList.add(Ge.FLOATINPUT));var Ie=he("span",{className:Ge.FLOATLINE}),Te=he("label",{className:Ge.FLOATTEXT});if(!m(H.element.id)&&H.element.id!==""&&(Te.id="label_"+H.element.id.replace(/ /g,"_"),De(H.element,{"aria-labelledby":Te.id})),!m(H.element.placeholder)&&H.element.placeholder!==""&&(Te.innerText=w(H.element.placeholder),H.element.removeAttribute("placeholder")),!m(H.properties)&&!m(H.properties.placeholder)&&H.properties.placeholder!==""&&(Te.innerText=w(H.properties.placeholder)),Te.innerText||V.container.classList.add(Ge.NOFLOATLABEL),V.container.classList.contains("e-float-icon-left")){var rt=V.container.querySelector(".e-input-in-wrap");rt.appendChild(H.element),rt.appendChild(Ie),rt.appendChild(Te)}else V.container.appendChild(H.element),V.container.appendChild(Ie),V.container.appendChild(Te);f(H.element.value,Te),H.floatLabelType==="Always"&&(Te.classList.contains(Ge.LABELBOTTOM)&&te([Te],Ge.LABELBOTTOM),Q([Te],Ge.LABELTOP)),H.floatLabelType==="Auto"&&(H.element.addEventListener("input",function(Tt){C(H.element,H.floatLabelType)}),H.element.addEventListener("blur",function(Tt){C(H.element,H.floatLabelType)})),m(H.element.getAttribute("id"))||Te.setAttribute("for",H.element.getAttribute("id"))}function c(H,V){H==="Always"&&V.classList.contains("e-outline")&&V.classList.add("e-valid-input")}function d(H,V){if(!m(H.properties))for(var re=0,he=Object.keys(H.properties);re<he.length;re++){var Ie=he[re];switch(Ie){case"cssClass":E(H.properties.cssClass,[V.container]),c(H.floatLabelType,V.container);break;case"enabled":k(H.properties.enabled,H.element,H.floatLabelType,V.container);break;case"enableRtl":L(H.properties.enableRtl,[V.container]);break;case"placeholder":N(H.properties.placeholder,H.element);break;case"readonly":A(H.properties.readonly,H.element);break}}return V}function p(H,V,re){m(V)||(H&&!re?te([V],Ge.CLEARICONHIDE):Q([V],Ge.CLEARICONHIDE))}function f(H,V,re){if(re===void 0&&(re=null),H)Q([V],Ge.LABELTOP),V.classList.contains(Ge.LABELBOTTOM)&&te([V],Ge.LABELBOTTOM);else{var he=re!=null?re!==document.activeElement:!0;he&&(V.classList.contains(Ge.LABELTOP)&&te([V],Ge.LABELTOP),Q([V],Ge.LABELBOTTOM))}}function v(H){var V=m(H.parentNode)?H:H.parentNode;return V&&V.classList.contains("e-input-in-wrap")&&(V=V.parentNode),V}function g(H,V,re,he){var Ie=m(he)?St:he,Te=Ie("span",{className:Ge.CLEARICON}),rt=V.container;if(!m(re))rt.appendChild(Te);else{var Tt=V.container.classList.contains(Ge.FLOATINPUT)?V.container.querySelector("."+Ge.FLOATTEXT):H;Tt.insertAdjacentElement("afterend",Te)}return Q([Te],Ge.CLEARICONHIDE),b(H,Te),Te.setAttribute("aria-label","close"),Te}function b(H,V,re){(t===void 0||t)&&V.addEventListener("click",function(he){H.classList.contains(Ge.DISABLE)||H.readOnly||(he.preventDefault(),H!==document.activeElement&&H.focus(),H.value="",Q([V],Ge.CLEARICONHIDE))}),H.addEventListener("input",function(he){p(H.value,V)}),H.addEventListener("focus",function(he){p(H.value,V,H.readOnly)}),H.addEventListener("blur",function(he){setTimeout(function(){m(V)||(Q([V],Ge.CLEARICONHIDE),V=!m(H)&&H.classList.contains("e-combobox")?null:V)},200)})}s.wireClearBtnEvents=b;function y(){}s.destroy=y;function C(H,V){var re=v(H);if(re.classList.contains(Ge.FLOATINPUT)&&V==="Auto"){var he=v(H).getElementsByClassName("e-float-text")[0];f(H.value,he,H)}}function x(H,V,re,he,Ie){var Te=m(Ie)?St:Ie,rt;return m(H.customTag)?rt=Te(he,{className:V}):(rt=Te(H.customTag,{className:V}),rt.classList.add(re)),rt.classList.add("e-control-wrapper"),rt}function w(H){var V="";if(!m(H)&&H!==""){var re=document.createElement("span");re.innerHTML='<input  placeholder="'+H+'"/>';var he=re.children[0];V=he.placeholder}return V}function M(H,V,re,he){if(V.value=H,re==="Auto"&&H===""&&T(V,V.parentElement),!m(re)&&re==="Auto"&&C(V,re),!m(he)&&he){var Ie=v(V);if(!m(Ie)){var Te=Ie.getElementsByClassName(Ge.CLEARICON)[0];m(Te)||(V.value&&!m(Ie)&&Ie.classList.contains("e-input-focus")?te([Te],Ge.CLEARICONHIDE):Q([Te],Ge.CLEARICONHIDE))}}n(re,V)}s.setValue=M;function E(H,V,re){!m(re)&&re!==""&&te(V,re.split(" ")),!m(H)&&H!==""&&Q(V,H.split(" "))}s.setCssClass=E;function T(H,V,re){var he=re==="multiselect"?H:H.clientWidth-parseInt(getComputedStyle(H,null).getPropertyValue("padding-left"),10);m(V.getElementsByClassName("e-float-text-content")[0])||(V.getElementsByClassName("e-float-text-content")[0].classList.contains("e-float-text-overflow")&&V.getElementsByClassName("e-float-text-content")[0].classList.remove("e-float-text-overflow"),(he<V.getElementsByClassName("e-float-text-content")[0].clientWidth||he===V.getElementsByClassName("e-float-text-content")[0].clientWidth)&&V.getElementsByClassName("e-float-text-content")[0].classList.add("e-float-text-overflow"))}s.calculateWidth=T;function D(H,V){typeof H=="number"?V.style.width=qe(H):typeof H=="string"&&(V.style.width=H.match(/px|%|em/)?H:qe(H)),T(V.firstChild,V)}s.setWidth=D;function N(H,V){H=w(H);var re=v(V);re.classList.contains(Ge.FLOATINPUT)?!m(H)&&H!==""?(re.getElementsByClassName("e-float-text-content")[0]?re.getElementsByClassName(Ge.FLOATTEXT)[0].children[0].textContent=H:re.getElementsByClassName(Ge.FLOATTEXT)[0].textContent=H,re.classList.remove(Ge.NOFLOATLABEL),V.removeAttribute("placeholder")):(re.classList.add(Ge.NOFLOATLABEL),re.getElementsByClassName("e-float-text-content")[0]?re.getElementsByClassName(Ge.FLOATTEXT)[0].children[0].textContent="":re.getElementsByClassName(Ge.FLOATTEXT)[0].textContent=""):!m(H)&&H!==""?De(V,{placeholder:H}):V.removeAttribute("placeholder")}s.setPlaceholder=N;function A(H,V,re){H?De(V,{readonly:""}):V.removeAttribute("readonly"),m(re)||C(V,re)}s.setReadonly=A;function L(H,V){H?Q(V,Ge.RTL):te(V,Ge.RTL)}s.setEnableRtl=L;function k(H,V,re,he){var Ie={disabled:"disabled","aria-disabled":"true"},Te=!m(he);H?(V.classList.remove(Ge.DISABLE),R(Ie,V),Te&&te([he],Ge.DISABLE)):(V.classList.add(Ge.DISABLE),j(Ie,V),Te&&Q([he],Ge.DISABLE)),m(re)||C(V,re)}s.setEnabled=k;function O(H,V,re,he,Ie){var Te=m(Ie)?St:Ie;H?re.clearButton=g(V,re,he,Te):(pt(re.clearButton),re.clearButton=null)}s.setClearButton=O;function R(H,V){for(var re=0,he=Object.keys(H);re<he.length;re++){var Ie=he[re],Te=v(V);Ie==="disabled"&&V.classList.remove(Ge.DISABLE),Ie==="disabled"&&Te.classList.contains(Ge.INPUTGROUP)&&Te.classList.remove(Ge.DISABLE),Ie==="placeholder"&&Te.classList.contains(Ge.FLOATINPUT)?Te.getElementsByClassName(Ge.FLOATTEXT)[0].textContent="":V.removeAttribute(Ie)}}s.removeAttributes=R;function j(H,V){for(var re=0,he=Object.keys(H);re<he.length;re++){var Ie=he[re],Te=v(V);Ie==="disabled"&&V.classList.add(Ge.DISABLE),Ie==="disabled"&&Te.classList.contains(Ge.INPUTGROUP)&&Te.classList.add(Ge.DISABLE),Ie==="placeholder"&&Te.classList.contains(Ge.FLOATINPUT)?Te.getElementsByClassName(Ge.FLOATTEXT)[0].textContent=H[""+Ie]:V.setAttribute(Ie,H[""+Ie])}}s.addAttributes=j;function P(H){var V=H.container;if(!m(V)&&V.classList.contains(Ge.FLOATINPUT)){var re=V.querySelector("textarea")?V.querySelector("textarea"):V.querySelector("input"),he=V.querySelector("."+Ge.FLOATTEXT).textContent,Ie=V.querySelector(".e-clear-icon")!==null;ne(V.querySelector("."+Ge.FLOATLINE)),ne(V.querySelector("."+Ge.FLOATTEXT)),br(V,[Ge.INPUTGROUP],[Ge.FLOATINPUT]),h(re),De(re,{placeholder:he}),re.classList.add(Ge.INPUT),!Ie&&re.tagName==="INPUT"&&re.removeAttribute("required")}}s.removeFloating=P;function F(H,V,re,he){var Ie=m(he)?St:he,Te=U(H,"."+Ge.INPUTGROUP);if(e=V,V!=="Never"){var rt=Te.tagName;rt=rt!=="DIV"&&rt!=="SPAN"?rt:null;var Tt={element:H,floatLabelType:V,customTag:rt,properties:{placeholder:re}},si=Te.querySelector(".e-clear-icon"),K={container:Te};H.classList.remove(Ge.INPUT),u(Tt,K,Ie),z(K.container,Ie),T(Tt.element,K.container);var ue=Te.classList.contains("e-float-icon-left");if(m(si))if(ue){var Me=Te.querySelector(".e-input-in-wrap");si=Me.querySelector(".e-input-group-icon")}else si=Te.querySelector(".e-input-group-icon");if(m(si))ue&&(si=Te.querySelector(".e-input-group-icon"));else{var Ae=Te.querySelector("."+Ge.FLOATLINE),Be=Te.querySelector("."+Ge.FLOATTEXT),_e=ue?Te.querySelector(".e-input-in-wrap"):Te;_e.insertBefore(H,si),_e.insertBefore(Ae,si),_e.insertBefore(Be,si)}}c(V,H.parentElement)}s.addFloating=F;function z(H,V){if(H.classList.contains("e-outline")&&H.getElementsByClassName("e-float-text")[0]){var re=V("span",{className:Ge.FLOATTEXTCONTENT});re.innerHTML=H.getElementsByClassName("e-float-text")[0].innerHTML,H.getElementsByClassName("e-float-text")[0].innerHTML="",H.getElementsByClassName("e-float-text")[0].appendChild(re)}}s.createSpanElement=z;function q(H,V){for(var re=0;re<V.length;re++)X(H,V[parseInt(re.toString())].container)}s.setRipple=q;function X(H,V,re){var he=[];he.push(re);var Ie=m(re)?V.querySelectorAll(".e-input-group-icon"):he;if(H&&Ie.length>0)for(var Te=0;Te<Ie.length;Te++)Ie[parseInt(Te.toString())].addEventListener("mousedown",Z,!1),Ie[parseInt(Te.toString())].addEventListener("mouseup",se,!1);else if(Ie.length>0)for(var Te=0;Te<Ie.length;Te++)Ie[parseInt(Te.toString())].removeEventListener("mousedown",Z,this),Ie[parseInt(Te.toString())].removeEventListener("mouseup",se,this)}function G(H,V){!H.classList.contains("e-disabled")&&!H.querySelector("input").readOnly&&V.classList.add("e-input-btn-ripple")}function Z(){for(var H=this,V=this.parentElement;!V.classList.contains("e-input-group");)V=V.parentElement;G(V,H)}function se(){var H=this;setTimeout(function(){H.classList.remove("e-input-btn-ripple")},500)}function oe(H,V){var re=V("span",{className:H});return re.classList.add("e-input-group-icon"),re}function fe(H,V,re,he,Ie){var Te=typeof V=="string"?V.split(","):V;if(H.toLowerCase()==="append")for(var rt=0,Tt=Te;rt<Tt.length;rt++){var si=Tt[rt];Ne(si,re,Ie)}else for(var K=0,ue=Te;K<ue.length;K++){var si=ue[K];be(si,re,he,Ie)}re.getElementsByClassName("e-input-group-icon")[0]&&re.getElementsByClassName("e-float-text-overflow")[0]&&re.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon")}s.addIcon=fe;function be(H,V,re,he){var Ie=m(he)?St:he,Te=oe(H,Ie);V.classList.add("e-float-icon-left");var rt=V.querySelector(".e-input-in-wrap");if(m(rt)){rt=Ie("span",{className:"e-input-in-wrap"}),re.parentNode.insertBefore(rt,re);var Tt=V.querySelectorAll(re.tagName+" ~ *");rt.appendChild(re);for(var si=0;si<Tt.length;si++){var K=Tt[parseInt(si.toString())],ue=rt.parentElement;(!K.classList.contains("e-float-line")||!(ue&&ue.classList.contains("e-filled"))&&ue)&&rt.appendChild(K)}}return rt.parentNode.insertBefore(Te,rt),X(!0,V,Te),Te}s.prependSpan=be;function Ne(H,V,re){var he=m(re)?St:re,Ie=oe(H,he),Te=V.classList.contains("e-float-icon-left")?V.querySelector(".e-input-in-wrap"):V;return Te.appendChild(Ie),X(!0,V,Ie),Ie}s.appendSpan=Ne;function we(H,V){V.type==="hidden"?H.classList.add("e-hidden"):H.classList.contains("e-hidden")&&H.classList.remove("e-hidden")}s.validateInputType=we})(ye||(ye={}));var wq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ji=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Mq="e-control-wrapper e-numeric",XS="e-input-group-icon",KS="e-spin-up",Eq="e-spin-down",ZS="e-error",Yu="increment",dp="decrement",Iq=new RegExp("^(-)?(\\d*)$"),Tq=".",Dq="e-numerictextbox",Aq="e-control",dk="e-input-focus",Nq="e-numeric-hidden",pk=["title","style","class"],fk=0,to=function(s){wq(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.isVue=!1,r.preventChange=!1,r.isAngular=!1,r.isDynamicChange=!1,r.numericOptions=t,r}return e.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var t=ie("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),te([this.cloneElement],[Aq,Dq,"e-lib"]),this.angularTagName=null,this.formEle=U(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(o){return o.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,kt("ej2_instances",t,this.element)}De(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off"});var a={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new In("numerictextbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",mi("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},e.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete())},e.prototype.checkAttributes=function(t){for(var i=t?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,n=i;r<n.length;r++){var a=n[r];if(!m(this.element.getAttribute(a)))switch(a){case"disabled":if(m(this.numericOptions)||this.numericOptions.enabled===void 0||t){var o=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:o},!t)}break;case"readonly":if(m(this.numericOptions)||this.numericOptions.readonly===void 0||t){var l=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(m(this.numericOptions)||this.numericOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.element.placeholder},!t);break;case"value":if(m(this.numericOptions)||this.numericOptions.value===void 0||t){var h=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));this.setProperties(kt(a,h,{}),!t)}break;case"min":if(m(this.numericOptions)||this.numericOptions.min===void 0||t){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));u!==null&&!isNaN(u)&&this.setProperties(kt(a,u,{}),!t)}break;case"max":if(m(this.numericOptions)||this.numericOptions.max===void 0||t){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));c!==null&&!isNaN(c)&&this.setProperties(kt(a,c,{}),!t)}break;case"step":if(m(this.numericOptions)||this.numericOptions.step===void 0||t){var d=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));d!==null&&!isNaN(d)&&this.setProperties(kt(a,d,{}),!t)}break;case"style":this.inputStyle=this.element.getAttribute(a);break;case"name":this.inputName=this.element.getAttribute(a);break;default:{var p=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));(p!==null&&!isNaN(p)||a==="value")&&this.setProperties(kt(a,p,{}),!0)}break}}},e.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},e.prototype.initCultureFunc=function(){this.instance=new _t(this.locale)},e.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,ie("currency",this)!==null&&(kt("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},e.prototype.createWrapper=function(){var t=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(t=this.getNumericValidClassList(this.cssClass));var i=ye.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:t,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",Mq+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&De(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text",validateHidden:"true","aria-label":"hidden",class:Nq}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),this.isAngular&&this.angularTagName==="EJS-NUMERICTEXTBOX"&&this.cloneElement.id.length>0?De(this.hiddenInput,{name:this.cloneElement.id}):De(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&De(this.container,{style:this.inputStyle})},e.prototype.updateDataAttribute=function(t){var i={};if(t)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];o.indexOf("data")===0&&this.hiddenInput.setAttribute(o,i[""+o])}},e.prototype.updateHTMLAttrToElement=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];pk.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateCssClass=function(t,i){ye.setCssClass(this.getNumericValidClassList(t),[this.container],this.getNumericValidClassList(i))},e.prototype.getNumericValidClassList=function(t){var i=t;return!m(t)&&t!==""&&(i=t.replace(/\s+/g," ").trim()),i},e.prototype.updateHTMLAttrToWrapper=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(pk.indexOf(r)>-1)if(r==="class"){var n=this.getNumericValidClassList(this.htmlAttributes[""+r]);n!==""&&Q([this.container],n.split(" "))}else if(r==="style"){var a=this.container.getAttribute(r);a=m(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.container.setAttribute(r,a)}else this.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.setElementWidth=function(t){m(t)||(typeof t=="number"?this.container.style.width=qe(t):typeof t=="string"&&(this.container.style.width=t.match(/px|%|em/)?t:qe(t)))},e.prototype.spinBtnCreation=function(){this.spinDown=ye.appendSpan(XS+" "+Eq,this.container,this.createElement),De(this.spinDown,{title:this.l10n.getConstant("decrementTitle")}),this.spinUp=ye.appendSpan(XS+" "+KS,this.container,this.createElement),De(this.spinUp,{title:this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},e.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),this.min!==-Number.MAX_VALUE&&De(this.element,{"aria-valuemin":this.min.toString()}),this.max!==Number.MAX_VALUE&&De(this.element,{"aria-valuemax":this.max.toString()})},e.prototype.formattedValue=function(t,i){return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(i)},e.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},e.prototype.action=function(t,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,t)),this.raiseChangeEvent(i)},e.prototype.checkErrorClass=function(){this.isValidState?te([this.container],ZS):Q([this.container],ZS),De(this.element,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.bindClearEvent=function(){this.showClearButton&&I.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){t.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(t),this.isInteract=!0,this.raiseChangeEvent(t)},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=U(this.element,"form");if(i){var r=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},e.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},e.prototype.setSpinButton=function(){m(this.spinDown)||De(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),m(this.spinUp)||De(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},e.prototype.wireEvents=function(){I.add(this.element,"focus",this.focusHandler,this),I.add(this.element,"blur",this.focusOutHandler,this),I.add(this.element,"keydown",this.keyDownHandler,this),I.add(this.element,"keyup",this.keyUpHandler,this),I.add(this.element,"input",this.inputHandler,this),I.add(this.element,"keypress",this.keyPressHandler,this),I.add(this.element,"change",this.changeHandler,this),I.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&I.add(this.formEle,"reset",this.resetFormHandler,this))},e.prototype.wireSpinBtnEvents=function(){I.add(this.spinUp,B.touchStartEvent,this.mouseDownOnSpinner,this),I.add(this.spinDown,B.touchStartEvent,this.mouseDownOnSpinner,this),I.add(this.spinUp,B.touchEndEvent,this.mouseUpOnSpinner,this),I.add(this.spinDown,B.touchEndEvent,this.mouseUpOnSpinner,this),I.add(this.spinUp,B.touchMoveEvent,this.touchMoveOnSpinner,this),I.add(this.spinDown,B.touchMoveEvent,this.touchMoveOnSpinner,this)},e.prototype.unwireEvents=function(){I.remove(this.element,"focus",this.focusHandler),I.remove(this.element,"blur",this.focusOutHandler),I.remove(this.element,"keyup",this.keyUpHandler),I.remove(this.element,"input",this.inputHandler),I.remove(this.element,"keydown",this.keyDownHandler),I.remove(this.element,"keypress",this.keyPressHandler),I.remove(this.element,"change",this.changeHandler),I.remove(this.element,"paste",this.pasteHandler),this.formEle&&I.remove(this.formEle,"reset",this.resetFormHandler)},e.prototype.unwireSpinBtnEvents=function(){I.remove(this.spinUp,B.touchStartEvent,this.mouseDownOnSpinner),I.remove(this.spinDown,B.touchStartEvent,this.mouseDownOnSpinner),I.remove(this.spinUp,B.touchEndEvent,this.mouseUpOnSpinner),I.remove(this.spinDown,B.touchEndEvent,this.mouseUpOnSpinner),I.remove(this.spinUp,B.touchMoveEvent,this.touchMoveOnSpinner),I.remove(this.spinDown,B.touchMoveEvent,this.touchMoveOnSpinner)},e.prototype.changeHandler=function(t){t.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,t)},e.prototype.raiseChangeEvent=function(t){if(this.inputValue=m(this.inputValue)||isNaN(this.inputValue)?null:this.inputValue,this.prevValue!==this.value||this.prevValue!==this.inputValue){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:t},t&&(this.changeEventArgs.event=t),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),bt(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},e.prototype.pasteHandler=function(){var t=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){t.numericRegex().test(t.element.value)||t.setElementValue(i)})}},e.prototype.preventHandler=function(){var t=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(t.element.selectionStart>0){var r=t.element.selectionStart,n=t.element.selectionStart-1,a=0,o=t.element.value.split(""),l=Lo(t.locale),h=ie("decimal",l),u=h.charCodeAt(0);t.element.value[n]===" "&&t.element.selectionStart>0&&!i?(m(t.prevVal)?t.element.value=t.element.value.trim():n!==0?t.element.value=t.prevVal:n===0&&(t.element.value=t.element.value.trim()),t.element.setSelectionRange(n,n)):isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.value[t.element.selectionStart-1].charCodeAt(0)!==45?(o.indexOf(t.element.value[t.element.selectionStart-1])!==o.lastIndexOf(t.element.value[t.element.selectionStart-1])&&t.element.value[t.element.selectionStart-1].charCodeAt(0)===u||t.element.value[t.element.selectionStart-1].charCodeAt(0)!==u)&&(t.element.value=t.element.value.substring(0,n)+t.element.value.substring(r,t.element.value.length),t.element.setSelectionRange(n,n),isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.selectionStart>0&&t.element.value.length&&t.preventHandler()):isNaN(parseFloat(t.element.value[t.element.selectionStart-2]))&&t.element.selectionStart>1&&t.element.value[t.element.selectionStart-2].charCodeAt(0)!==45&&(o.indexOf(t.element.value[t.element.selectionStart-2])!==o.lastIndexOf(t.element.value[t.element.selectionStart-2])&&t.element.value[t.element.selectionStart-2].charCodeAt(0)===u||t.element.value[t.element.selectionStart-2].charCodeAt(0)!==u)&&(t.element.setSelectionRange(n,n),t.nextEle=t.element.value[t.element.selectionStart],t.cursorPosChanged=!0,t.preventHandler()),t.cursorPosChanged===!0&&t.element.value[t.element.selectionStart]===t.nextEle&&isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&(t.element.setSelectionRange(t.element.selectionStart+1,t.element.selectionStart+1),t.cursorPosChanged=!1,t.nextEle=null),t.element.value.trim()===""&&t.element.setSelectionRange(a,a),t.element.selectionStart>0&&(t.element.value[t.element.selectionStart-1].charCodeAt(0)===45&&t.element.selectionStart>1&&(m(t.prevVal)?t.element.value=t.element.value:t.element.value=t.prevVal,t.element.setSelectionRange(t.element.selectionStart,t.element.selectionStart)),t.element.value[t.element.selectionStart-1]===h&&t.decimals===0&&t.validateDecimalOnType&&(t.element.value=t.element.value.substring(0,n)+t.element.value.substring(r,t.element.value.length))),t.prevVal=t.element.value}})},e.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!t&&B.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=U(this.element,"form");if(r){var n=this.element.nextElementSibling,a=document.createEvent("KeyboardEvent");a.initEvent("keyup",!1,!0),n.dispatchEvent(a)}}},e.prototype.inputHandler=function(t){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((n||r)&&B.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==ie("decimal",Lo(this.locale))&&this.element.value!==ie("minusSign",Lo(this.locale))){var a=this.instance.getNumberParser({format:"n"})(this.element.value);a=isNaN(a)?null:a,i.localChange({value:a}),this.preventChange=!0}if(this.isVue){var o=this.instance.getNumberParser({format:"n"})(this.element.value),l=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),h=new RegExp("[^0-9]+$");(h.test(this.element.value)||(this.elementPrevValue.indexOf(".")!==-1||this.elementPrevValue.indexOf("-")!==-1)&&this.element.value[this.element.value.length-1]==="0")&&(o=this.value);var u={event:t,value:o===null||isNaN(o)?null:o,previousValue:l===null||isNaN(l)?null:l};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",u)}}},e.prototype.keyDownHandler=function(t){if(!this.readonly)switch(t.keyCode){case 38:t.preventDefault(),this.action(Yu,t);break;case 40:t.preventDefault(),this.action(dp,t);break}},e.prototype.performAction=function(t,i,r){(t===null||isNaN(t))&&(t=0);var n=r===Yu?t+i:t-i;return n=this.correctRounding(t,i,n),this.strictMode?this.trimValue(n):n},e.prototype.correctRounding=function(t,i,r){var n=new RegExp("[,.](.*)"),a=n.test(t.toString()),o=n.test(i.toString());if(a||o){var l=a?n.exec(t.toString())[0].length:0,h=o?n.exec(i.toString())[0].length:0,u=Math.max(l,h);return t=this.roundValue(r,u)}return r},e.prototype.roundValue=function(t,i){i=i||0;var r=Math.pow(10,i);return t*=r,t=Math.round(t)/r},e.prototype.updateValue=function(t,i){i&&(this.isInteract=!0),t!==null&&!isNaN(t)&&this.decimals&&(t=this.roundNumber(t,this.decimals)),this.inputValue=t,this.changeValue(t===null||isNaN(t)?null:this.strictMode?this.trimValue(t):t),this.isDynamicChange||this.raiseChangeEvent(i)},e.prototype.updateCurrency=function(t,i){kt(t,i,this.cultureInfo),this.updateValue(this.value)},e.prototype.changeValue=function(t){if(!(t||t===0))t=null,this.setProperties({value:t},!0);else{var i=this.getNumberOfDecimals(t);this.setProperties({value:this.roundNumber(t,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},e.prototype.modifyText=function(){if(this.value||this.value===0){var t=this.formatNumber(),i=this.isFocused?t:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(i),De(this.element,{"aria-valuenow":t}),this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},e.prototype.setElementValue=function(t,i){ye.setValue(t,i||this.element,this.floatLabelType,this.showClearButton)},e.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},e.prototype.getNumberOfDecimals=function(t){var i,r=new RegExp("[eE][-+]?([0-9]+)"),n=t.toString();if(r.test(n)){var a=r.exec(n);m(a)||(n=t.toFixed(Math.min(parseInt(a[1],10),20)))}var o=n.split(".")[1];return i=!o||!o.length?0:o.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},e.prototype.formatNumber=function(){var t=this.getNumberOfDecimals(this.value);return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(this.value)},e.prototype.trimValue=function(t){return t>this.max?this.max:t<this.min?this.min:t},e.prototype.roundNumber=function(t,i){var r=t,n=i||0,a=r.toString().split("e");r=Math.round(+(a[0]+"e"+(a[1]?Number(a[1])+n:n)));var o=r.toString().split("e");return r=+(o[0]+"e"+(o[1]?Number(o[1])-n:-n)),Number(r.toFixed(n))},e.prototype.cancelEvent=function(t){return t.preventDefault(),!1},e.prototype.keyPressHandler=function(t){if(!this.enabled||this.readonly)return!0;if(!B.isDevice&&B.info.version==="11.0"&&t.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,t),!0}if(t.which===0||t.metaKey||t.ctrlKey||t.keyCode===8||t.keyCode===13)return!0;var r=String.fromCharCode(t.which),n=ie("decimal",Lo(this.locale)),a=t.code==="NumpadDecimal"&&r!==n;a&&(r=n);var o=this.element.value;if(o=o.substring(0,this.element.selectionStart)+r+o.substring(this.element.selectionEnd),this.numericRegex().test(o)){if(a){var l=this.element.selectionStart+1;this.element.value=o,this.element.setSelectionRange(l,l),t.preventDefault(),t.stopPropagation()}return!0}else return t.preventDefault(),t.stopPropagation(),!1},e.prototype.numericRegex=function(){var t=Lo(this.locale),i=ie("decimal",t),r="*";return i===Tq&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?Iq:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},e.prototype.mouseWheel=function(t){t.preventDefault();var i,r=t;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(Yu,t):i<0&&this.action(dp,t),this.cancelEvent(t)},e.prototype.focusHandler=function(t){var i=this;if(clearTimeout(fk),this.focusEventArgs={event:t,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,te([this.container],ZS),this.prevValue=this.value,this.value||this.value===0){var r=this.formatNumber();if(this.setElementValue(r),!this.isPrevFocused)if(!B.isDevice&&B.info.version==="11.0")this.element.setSelectionRange(0,r.length);else{var n=B.isDevice&&B.isIos?600:0;fk=setTimeout(function(){i.element.setSelectionRange(0,r.length)},n)}}B.isDevice||I.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},e.prototype.focusOutHandler=function(t){var i=this;if(this.blurEventArgs={event:t,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(t.preventDefault(),B.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){i.setElementValue(r,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var a=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(a),B.isDevice||I.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}var o=U(this.element,"form");if(o){var l=this.element.nextElementSibling,h=document.createEvent("FocusEvent");h.initEvent("focusout",!1,!0),l.dispatchEvent(h)}}},e.prototype.mouseDownOnSpinner=function(t){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,t.preventDefault()),!!this.getElementData(t)){this.getElementData(t);var r=t.currentTarget,n=r.classList.contains(KS)?Yu:dp;I.add(r,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(n,t)},150),I.add(document,"mouseup",this.mouseUpClick,this)}},e.prototype.touchMoveOnSpinner=function(t){var i;if(t.type==="touchmove"){var r=t.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(t.clientX,t.clientY);i.classList.contains(XS)||clearInterval(this.timeOut)},e.prototype.mouseUpOnSpinner=function(t){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),B.isDevice||(this.isPrevFocused=!1)),B.isDevice||t.preventDefault(),!!this.getElementData(t)){var i=t.currentTarget,r=i.classList.contains(KS)?Yu:dp;I.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,t),this.isCalled=!1,I.remove(document,"mouseup",this.mouseUpClick);var n=U(this.element,"form");if(n){var a=this.element.nextElementSibling,o=document.createEvent("KeyboardEvent");o.initEvent("keyup",!1,!0),a.dispatchEvent(o)}}},e.prototype.getElementData=function(t){return t.which&&t.which===3||t.button&&t.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},e.prototype.floatLabelTypeUpdate=function(){ye.removeFloating(this.inputWrapper);var t=this.hiddenInput;this.hiddenInput.remove(),ye.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(t,this.container.childNodes[1])},e.prototype.mouseUpClick=function(t){t.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,this.spinUp&&I.remove(this.spinUp,"mouseleave",this.mouseUpClick),this.spinDown&&I.remove(this.spinDown,"mouseleave",this.mouseUpClick)},e.prototype.increment=function(t){t===void 0&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,Yu)),this.raiseChangeEvent()},e.prototype.decrement=function(t){t===void 0&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,dp)),this.raiseChangeEvent()},e.prototype.destroy=function(){this.unwireEvents(),ne(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),ne(this.spinUp),ne(this.spinDown));for(var t=["aria-labelledby","role","autocomplete","aria-readonly","aria-disabled","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-valuenow","aria-invalid"],i=0;i<t.length;i++)this.element.removeAttribute(t[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),ne(this.container),this.spinUp=null,this.spinDown=null,this.container=null,this.hiddenInput=null,this.changeEventArgs=null,this.blurEventArgs=null,this.focusEventArgs=null,this.inputWrapper=null,ye.destroy(),s.prototype.destroy.call(this)},e.prototype.getText=function(){return this.element.value},e.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),Q([this.container],[dk]))},e.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),te([this.container],[dk]))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"width":this.setElementWidth(t.width),ye.calculateWidth(this.element,this.container);break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"enabled":ye.setEnabled(t.enabled,this.element),this.bindClearEvent();break;case"enableRtl":ye.setEnableRtl(t.enableRtl,[this.container]);break;case"readonly":ye.setReadonly(t.readonly,this.element),this.readonly?De(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),ye.validateInputType(this.container,this.element);break;case"placeholder":ye.setPlaceholder(t.placeholder,this.element),ye.calculateWidth(this.element,this.container);break;case"step":this.step=t.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(t);break;case"showClearButton":this.updateClearButton(t);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(t.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":kt(a,ie(a,t),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=t.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),ye.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var o=ie(a,t);this.setProperties({currencyCode:o},!0),this.updateCurrency(a,o)}break;case"currencyCode":{var l=ie(a,t);this.setProperties({currency:l},!0),this.updateCurrency("currency",l)}break;case"format":kt(a,ie(a,t),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=t.decimals,this.updateValue(this.value)}}},e.prototype.updateClearButton=function(t){ye.setClearButton(t.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},e.prototype.updateSpinButton=function(t){t.showSpinButton?this.spinBtnCreation():(ne(this.spinUp),ne(this.spinDown))},e.prototype.getModuleName=function(){return"numerictextbox"},ji([S("")],e.prototype,"cssClass",void 0),ji([S(null)],e.prototype,"value",void 0),ji([S(-Number.MAX_VALUE)],e.prototype,"min",void 0),ji([S(Number.MAX_VALUE)],e.prototype,"max",void 0),ji([S(1)],e.prototype,"step",void 0),ji([S(null)],e.prototype,"width",void 0),ji([S(null)],e.prototype,"placeholder",void 0),ji([S({})],e.prototype,"htmlAttributes",void 0),ji([S(!0)],e.prototype,"showSpinButton",void 0),ji([S(!1)],e.prototype,"readonly",void 0),ji([S(!0)],e.prototype,"enabled",void 0),ji([S(!1)],e.prototype,"showClearButton",void 0),ji([S(!1)],e.prototype,"enablePersistence",void 0),ji([S("n2")],e.prototype,"format",void 0),ji([S(null)],e.prototype,"decimals",void 0),ji([S(null)],e.prototype,"currency",void 0),ji([S(null)],e.prototype,"currencyCode",void 0),ji([S(!0)],e.prototype,"strictMode",void 0),ji([S(!1)],e.prototype,"validateDecimalOnType",void 0),ji([S("Never")],e.prototype,"floatLabelType",void 0),ji([_()],e.prototype,"created",void 0),ji([_()],e.prototype,"destroyed",void 0),ji([_()],e.prototype,"change",void 0),ji([_()],e.prototype,"focus",void 0),ji([_()],e.prototype,"blur",void 0),e=ji([Ot],e),e}(Pi),Av=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},kq=function(s){Av(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Nt([S("None")],e.prototype,"placement",void 0),Nt([S(10)],e.prototype,"largeStep",void 0),Nt([S(1)],e.prototype,"smallStep",void 0),Nt([S(!1)],e.prototype,"showSmallTicks",void 0),Nt([S(null)],e.prototype,"format",void 0),e}(ke),Lq=function(s){Av(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Nt([S(null)],e.prototype,"color",void 0),Nt([S(null)],e.prototype,"start",void 0),Nt([S(null)],e.prototype,"end",void 0),e}(ke),Oq=function(s){Av(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Nt([S(!1)],e.prototype,"enabled",void 0),Nt([S(null)],e.prototype,"minStart",void 0),Nt([S(null)],e.prototype,"minEnd",void 0),Nt([S(null)],e.prototype,"maxStart",void 0),Nt([S(null)],e.prototype,"maxEnd",void 0),Nt([S(!1)],e.prototype,"startHandleFixed",void 0),Nt([S(!1)],e.prototype,"endHandleFixed",void 0),e}(ke),Rq=function(s){Av(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Nt([S("")],e.prototype,"cssClass",void 0),Nt([S("Before")],e.prototype,"placement",void 0),Nt([S("Focus")],e.prototype,"showOn",void 0),Nt([S(!1)],e.prototype,"isVisible",void 0),Nt([S(null)],e.prototype,"format",void 0),e}(ke),Fq=6,Pq=3,pe={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},vk=function(s){Av(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.horDir="left",r.verDir="bottom",r.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},r.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},r.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",r.customAriaText=null,r.drag=!0,r.isDragComplete=!1,r.initialTooltip=!0,r}return e.prototype.preRender=function(){var t={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new In("slider",t,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},e.prototype.formChecker=function(){var t=U(this.element,"form");t?(this.isForm=!0,m(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&(m(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat(qe(this.min)),parseFloat(qe(this.max))]:m(this.formResetValue)&&(this.formResetValue=parseFloat(qe(this.min))),this.formElement=t):this.isForm=!1},e.prototype.initCultureFunc=function(){this.internationalization=new _t(this.locale)},e.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=m(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=m(this.ticks.format)?null:this.ticks.format},e.prototype.formatString=function(t,i){var r=null,n=null;if(t||t===0){r=this.formatNumber(t);var a=this.numberOfDecimals(t);n=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(t,a))}return{elementVal:r,formatString:n}},e.prototype.formatNumber=function(t){var i=this.numberOfDecimals(t);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(t)},e.prototype.numberOfDecimals=function(t){var i=t.toString().split(".")[1],r=!i||!i.length?0:i.length;return r},e.prototype.makeRoundNumber=function(t,i){var r=i||0;return Number(t.toFixed(r))},e.prototype.fractionalToInteger=function(t){t=this.numberOfDecimals(t)===0?Number(t).toFixed(this.noOfDecimals):t;for(var i=1,r=0;r<this.noOfDecimals;r++)i*=10;return t=Number((t*i).toFixed(0)),t},e.prototype.render=function(){var t=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)=="none"&&setTimeout(function(){t.refresh()},0)},e.prototype.initialize=function(){Q([this.element],pe.root),this.setCSSClass()},e.prototype.setElementWidth=function(t){!m(t)&&!m(this.sliderContainer)&&(typeof t=="number"?this.sliderContainer.style.width=qe(t):typeof t=="string"&&(this.sliderContainer.style.width=t.match(/px|%|em/)?t:qe(t)))},e.prototype.setCSSClass=function(t){t&&te([this.element],t.split(" ")),this.cssClass&&Q([this.element],this.cssClass.split(" "))},e.prototype.setEnabled=function(){this.enabled?(te([this.sliderContainer],[pe.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(pe.sliderDisabled),this.wireEvents()):(Q([this.sliderContainer],[pe.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(pe.sliderDisabled),this.unwireEvents())},e.prototype.getTheme=function(t){var i=window.getComputedStyle(t,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},e.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:pe.sliderContainer+" "+pe.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:pe.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:m(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(Math.random()*1e3).toFixed(0)+"slider",class:pe.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=m(this.value)?parseFloat(qe(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat(qe(this.value.toString()))):[this.checkHandleValue(parseFloat(qe(this.value[0].toString()))),this.checkHandleValue(parseFloat(qe(this.value[1].toString())))],this.previousChanged=this.previousVal,m(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?te([this.sliderContainer],[pe.sliderDisabled]):Q([this.sliderContainer],[pe.sliderDisabled]),this.readonly?Q([this.sliderContainer],[pe.readonly]):te([this.sliderContainer],[pe.readonly])},e.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isMaterial3=this.getTheme(this.sliderContainer)==="Material3"||this.getTheme(this.sliderContainer)==="Material3-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isMaterialTooltip=(this.isMaterial||this.isMaterial3)&&this.type!=="Range"&&this.tooltip.isVisible},e.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:pe.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(pe.dragHorizontal):this.rangeBar.classList.add(pe.dragVertical)))},e.prototype.createLimitBar=function(){var t=this.type!=="Range"?pe.limitBarDefault:pe.limitBarFirst;t+=" "+pe.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:t}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:pe.limitBarSecond+" "+pe.limits}}),this.element.appendChild(this.limitBarSecond))},e.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(pe.verticalSlider),this.sliderContainer.classList.add(pe.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(pe.horizontalSlider),this.sliderContainer.classList.add(pe.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},e.prototype.setAriaAttributes=function(t){var i=this,r=this.min,n=this.max;if(!m(this.customValues)&&this.customValues.length>0&&(r=this.customValues[0],n=this.customValues[this.customValues.length-1]),this.type!=="Range")De(t,{"aria-valuemin":r.toString(),"aria-valuemax":n.toString()});else{var a=!m(this.customValues)&&this.customValues.length>0?[[r.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[r.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]];a.forEach(function(o,l){var h=l===0?i.firstHandle:i.secondHandle;h&&De(h,{"aria-valuemin":o[0],"aria-valuemax":o[1]})})}},e.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:pe.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.secondHandle.classList.add(pe.sliderSecondHandle),this.element.appendChild(this.secondHandle)},e.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:pe.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.firstHandle.classList.add(pe.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:pe.sliderHandle+" "+pe.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},e.prototype.wireFirstHandleEvt=function(t){t?(I.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),I.remove(this.firstHandle,"transitionend",this.transitionEnd),I.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),I.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(I.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),I.add(this.firstHandle,"transitionend",this.transitionEnd,this),I.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),I.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.wireSecondHandleEvt=function(t){t?(I.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),I.remove(this.secondHandle,"transitionend",this.transitionEnd),I.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),I.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(I.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),I.add(this.secondHandle,"transitionend",this.transitionEnd,this),I.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),I.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](pe.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](pe.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](pe.sliderTooltipStart)))},e.prototype.transitionEnd=function(t){t.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},e.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(pe.sliderHandleFocused)&&this.firstHandle.classList.remove(pe.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(pe.sliderHandleFocused)&&this.secondHandle.classList.remove(pe.sliderHandleFocused)},e.prototype.handleFocus=function(t){this.focusSliderElement(),this.sliderBarClick(t),t.currentTarget===this.firstHandle?(this.firstHandle.classList.add(pe.sliderHandleFocused),this.firstHandle.classList.add(pe.sliderTabHandle)):(this.secondHandle.classList.add(pe.sliderHandleFocused),this.secondHandle.classList.add(pe.sliderTabHandle)),I.add(document,"mousemove touchmove",this.sliderBarMove,this),I.add(document,"mouseup touchend",this.sliderBarUp,this)},e.prototype.handleOver=function(t){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(t.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},e.prototype.handleLeave=function(t){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!t.currentTarget.classList.contains(pe.sliderHandleFocused)&&!t.currentTarget.classList.contains(pe.sliderTabHandle)&&this.closeTooltip()},e.prototype.setHandler=function(){this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},e.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?Q([this.sliderContainer],pe.rtl):te([this.sliderContainer],pe.rtl);var t=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;t!==i&&this.orientation==="Horizontal"&&(tt(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&tt(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},e.prototype.tooltipValue=function(){var t=this,i,r={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),r.text=i=typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,this.trigger("tooltipChange",r,function(n){if(t.addTooltipClass(n.text),i!==n.text){t.customAriaText=n.text,t.enableHtmlSanitizer?n.text=Fi.sanitize(n.text.toString()):n.text=n.text.toString();var a=function(){return n.text};t.tooltipObj.content=wy(a),t.setAriaAttrValue(t.firstHandle),t.type==="Range"&&t.setAriaAttrValue(t.secondHandle)}}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},e.prototype.setTooltipContent=function(){var t;t=this.formatContent(this.tooltipFormatInfo,!1);var i=function(){return t};this.tooltipObj.content=wy(i)},e.prototype.formatContent=function(t,i){var r="",n=this.handleVal1,a=this.handleVal2;return!m(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],a=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=!m(this.tooltip)&&!m(this.tooltip.format)?this.formatString(a,t).elementVal+" - "+this.formatString(n,t).elementVal:a.toString()+" - "+n.toString():r=!m(this.tooltip)&&!m(this.tooltip.format)?this.formatString(n,t).elementVal+" - "+this.formatString(a,t).elementVal:n.toString()+" - "+a.toString():m(n)||(r=!m(this.tooltip)&&!m(this.tooltip.format)?this.formatString(n,t).elementVal:n.toString()),r):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=m(t.format)?a.toString()+" - "+n.toString():this.formatString(a,t).formatString+" - "+this.formatString(n,t).formatString:r=m(t.format)?n.toString()+" - "+a.toString():this.formatString(n,t).formatString+" - "+this.formatString(a,t).formatString:m(n)||(r=m(t.format)?n.toString():this.formatString(n,t).formatString),r)},e.prototype.addTooltipClass=function(t){if(this.isMaterialTooltip){var i=t.toString().length;if(this.tooltipElement){var r=i>4?{oldCss:pe.sliderMaterialDefault,newCss:pe.sliderMaterialRange}:{oldCss:pe.sliderMaterialRange,newCss:pe.sliderMaterialDefault};this.tooltipElement.classList.remove(r.oldCss),this.tooltipElement.classList.contains(r.newCss)||(this.tooltipElement.classList.add(r.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var r=i>4?pe.sliderMaterialRange:pe.sliderMaterialDefault;this.tooltipObj.cssClass=pe.sliderTooltip+" "+r}}},e.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},e.prototype.tooltipBeforeOpen=function(t){this.tooltipElement=t.element,this.tooltip.cssClass&&Q([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),t.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(pe.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},e.prototype.tooltipCollision=function(t){if(this.isBootstrap||this.isBootstrap4||(this.isMaterial||this.isMaterial3)&&!this.isMaterialTooltip){var i=this.isBootstrap4?Pq:Fq;switch(t){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},e.prototype.materialTooltipEventCallBack=function(t){this.sliderBarClick(t),I.add(document,"mousemove touchmove",this.sliderBarMove,this),I.add(document,"mouseup touchend",this.sliderBarUp,this)},e.prototype.wireMaterialTooltipEvent=function(t){this.isMaterialTooltip&&(t?I.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):I.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},e.prototype.tooltipPositionCalculation=function(t){var i;switch(t){case"TopCenter":i=pe.horizontalTooltipBefore;break;case"BottomCenter":i=pe.horizontalTooltipAfter;break;case"LeftCenter":i=pe.verticalTooltipBefore;break;case"RightCenter":i=pe.verticalTooltipAfter;break}return i},e.prototype.getTooltipTransformProperties=function(t){var i;if(this.tooltipElement){var r=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?t===pe.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+r+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-r+"px)"}:t===pe.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+r+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-r+"px)"}}return i},e.prototype.openMaterialTooltip=function(){var t=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(pe.materialTooltipHide),i.classList.add(pe.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(pe.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition=t.transition.handle)},2500):setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition="none")},2500)}},e.prototype.closeMaterialTooltip=function(){var t=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(pe.materialTooltipShow),i.classList.add(pe.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(pe.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition="none")},2500)}},e.prototype.checkTooltipPosition=function(t){var i=this.tooltipPositionCalculation(t.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==t.collidedPosition||!t.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(t.element.classList.remove(this.previousTooltipClass),t.element.classList.add(i),this.previousTooltipClass=i),t.element.style.transform&&t.element.classList.contains(pe.materialTooltipOpen)&&t.element.firstElementChild.innerText.length<=4&&(t.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=t.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},e.prototype.setTooltipTransform=function(){var t=this.getTooltipTransformProperties(this.previousTooltipClass);m(this.tooltipElement)||(this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=t.translate+" scale(0.01)":this.tooltipElement.style.transform=t.translate+" "+t.rotate+" scale(0.01)")},e.prototype.renderTooltip=function(){this.tooltipObj=new D0({showTipPointer:this.isBootstrap||this.isMaterial||this.isMaterial3||this.isBootstrap4||this.isTailwind||this.isBootstrap5||this.isFluent,cssClass:pe.sliderTooltip,height:this.isMaterial||this.isMaterial3?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},e.prototype.initializeTooltipProps=function(){var t=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:t}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){m(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(pe.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},e.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},e.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:pe.sliderButton+" "+pe.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:pe.sliderButtonIcon})),this.isTailwind&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:pe.sliderButton+" "+pe.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:pe.sliderButtonIcon})),this.isTailwind&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(pe.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},e.prototype.buttonTitle=function(){var t=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),r=this.l10n.getConstant("incrementTitle");De(t?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),De(t?this.firstBtn:this.secondBtn,{"aria-label":r,title:r})},e.prototype.buttonFocusOut=function(){(this.isMaterial||this.isMaterial3)&&this.getHandle().classList.remove("e-large-thumb-size")},e.prototype.repeatButton=function(t){var i=this.handleValueUpdate(),r=this.enableRtl&&this.orientation!=="Vertical",n;t.target.parentElement.classList.contains(pe.firstButton)||t.target.classList.contains(pe.firstButton)?r?n=this.add(i,parseFloat(this.step.toString()),!0):n=this.add(i,parseFloat(this.step.toString()),!1):(t.target.parentElement.classList.contains(pe.secondButton)||t.target.classList.contains(pe.secondButton))&&(r?n=this.add(i,parseFloat(this.step.toString()),!1):n=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(n=this.getLimitCorrectedValues(n)),n>=this.min&&n<=this.max&&(this.changeHandleValue(n),this.tooltipToggle(this.getHandle()))},e.prototype.repeatHandlerMouse=function(t){t.preventDefault(),(t.type==="mousedown"||t.type==="touchstart")&&(this.buttonClick(t),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,t))},e.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},e.prototype.focusHandle=function(){this.getHandle().classList.contains(pe.sliderTabHandle)||this.getHandle().classList.add(pe.sliderTabHandle)},e.prototype.repeatHandlerUp=function(t){this.changeEvent("changed",t),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},e.prototype.customTickCounter=function(t){var i=4;return!m(this.customValues)&&this.customValues.length>0&&(t>4&&(i=3),t>7&&(i=2),t>14&&(i=1),t>28&&(i=0)),i},e.prototype.renderScale=function(){var t=this.orientation==="Vertical"?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:pe.scale+" e-"+t+"-scale "+pe.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",B.isAndroid&&t==="h"&&this.ul.classList.add(pe.sliderTickPosition);var i=this.ticks.smallStep;this.ticks.showSmallTicks?i<=0&&(i=parseFloat(qe(this.step))):this.ticks.largeStep>0?i=this.ticks.largeStep:i=parseFloat(qe(this.max))-parseFloat(qe(this.min));var r=this.fractionalToInteger(this.min),n=this.fractionalToInteger(this.max),a=this.fractionalToInteger(i),o=!m(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,l=this.customTickCounter(o),h=!m(this.customValues)&&this.customValues.length>0?o*l+o:Math.abs((n-r)/a);this.element.appendChild(this.ul);var u,c=parseFloat(this.min.toString());t==="v"&&(c=parseFloat(this.max.toString()));var d=0,p,f=100/h;f===1/0&&(f=5);for(var v=0,g=!m(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,b=0;v<=h;v++){if(u=this.createElement("li",{attrs:{class:pe.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!m(this.customValues)&&this.customValues.length>0)p=v%(l+1)===0,p&&(t==="h"?(c=this.customValues[b],b++):(c=this.customValues[g],g--),u.setAttribute("title",c.toString()));else if(u.setAttribute("title",c.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)t==="h"?p=(c-parseFloat(this.min.toString()))%this.ticks.largeStep===0:p=Math.abs(c-parseFloat(this.max.toString()))%this.ticks.largeStep===0;else{var y=this.fractionalToInteger(this.ticks.largeStep),C=this.fractionalToInteger(c);t==="h"?p=(C-r)%y===0:p=Math.abs(C-parseFloat(n.toString()))%y===0}p&&u.classList.add(pe.large),t==="h"?u.style.width=f+"%":u.style.height=f+"%";var x=p?this.ticks.placement==="Both"?2:1:0;if(p)for(var w=0;w<x;w++)this.createTick(u,c,f);else m(this.customValues)&&this.formatTicksValue(u,c);this.ul.appendChild(u),this.tickElementCollection.push(u);var M=void 0;m(this.customValues)&&(this.numberOfDecimals(i)>this.numberOfDecimals(c)?M=this.numberOfDecimals(i):M=this.numberOfDecimals(c),t==="h"?c=this.makeRoundNumber(c+i,M):this.min>this.max?c=this.makeRoundNumber(c+i,M):c=this.makeRoundNumber(c-i,M),d=this.makeRoundNumber(d+i,M))}this.ticksAlignment(t,f)},e.prototype.ticksAlignment=function(t,i,r){r===void 0&&(r=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(pe.sliderFirstTick),this.lastChild.classList.add(pe.sliderLastTick),this.sliderContainer.classList.add(pe.scale+"-"+this.ticks.placement.toLowerCase()),t==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var n={ticksWrapper:this.ul,tickElements:this.tickElementCollection};r&&this.trigger("renderedTicks",n),this.scaleAlignment()},e.prototype.createTick=function(t,i,r){var n=this.createElement("span",{className:pe.tickValue+" "+pe.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});t.appendChild(n),m(this.customValues)?this.formatTicksValue(t,i,n,r):this.enableHtmlSanitizer?n.innerHTML=Fi.sanitize(i.toString()):n.innerHTML=i.toString()},e.prototype.formatTicksValue=function(t,i,r,n){var a=this,o=this.formatNumber(i),l=!m(this.ticks)&&!m(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:o,h={value:i,text:l,tickElement:t};this.trigger("renderingTicks",h,function(u){t.setAttribute("title",u.text.toString()),r&&(a.enableHtmlSanitizer?r.innerHTML=Fi.sanitize(u.text.toString()):r.innerHTML=u.text.toString())})},e.prototype.scaleAlignment=function(){this.tickValuePosition(),this.orientation,this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(pe.sliderSmallSize):this.sliderContainer.classList.remove(pe.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(pe.sliderSmallSize):this.sliderContainer.classList.remove(pe.sliderSmallSize)},e.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var t=this.firstChild.getBoundingClientRect(),i,r,n=this.ticks.smallStep,a=Math.abs(parseFloat(qe(this.max))-parseFloat(qe(this.min)))/n;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var o=[this.sliderContainer.querySelectorAll("."+pe.tick+"."+pe.large+" ."+pe.tickValue)],l;this.ticks.placement==="Both"?l=[].slice.call(o[0],2):l=[].slice.call(o[0],1);for(var h=this.orientation==="Vertical"?t.height*2:t.width*2,u=0;u<this.firstChild.children.length;u++)this.orientation==="Vertical"?this.firstChild.children[u].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[u].style.left=(h-this.firstChild.children[u].getBoundingClientRect().width)/2+"px":this.firstChild.children[u].style.left=-(i.width/2)+"px";for(var u=0;u<l.length;u++)r=l[u].getBoundingClientRect(),this.orientation==="Vertical"?tt(l[u],{top:(h-r.height)/2+"px"}):tt(l[u],{left:(h-r.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&a!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),a===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(pe.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(pe.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(pe.sliderLastTick))},e.prototype.setAriaAttrValue=function(t){var i,r=!m(this.ticks)&&!m(this.ticks.format),n=r?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),a=r?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);n=this.customAriaText?this.customAriaText:n,n.split(" - ").length===2?i=n.split(" - "):i=[n,n],this.setAriaAttributes(t),this.type!=="Range"?De(t,{"aria-valuenow":a,"aria-valuetext":n}):this.enableRtl?t===this.firstHandle?De(t,{"aria-valuenow":a.split(" - ")[1],"aria-valuetext":i[1]}):De(t,{"aria-valuenow":a.split(" - ")[0],"aria-valuetext":i[0]}):t===this.firstHandle?De(t,{"aria-valuenow":a.split(" - ")[0],"aria-valuetext":i[0]}):De(t,{"aria-valuenow":a.split(" - ")[1],"aria-valuetext":i[1]})},e.prototype.handleValueUpdate=function(){var t;return this.type==="Range"?this.activeHandle===1?t=this.handleVal1:t=this.handleVal2:t=this.handleVal1,t},e.prototype.getLimitCorrectedValues=function(t){return this.type==="MinRange"||this.type==="Default"?t=this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?t=this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:t=this.getLimitValueAndPosition(t,this.limits.maxStart,this.limits.maxEnd)[0],t},e.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},e.prototype.buttonClick=function(t){this.focusSliderElement();var i,r=this.enableRtl&&this.orientation!=="Vertical",n=this.handleValueUpdate();t.keyCode===40||t.keyCode===37||t.currentTarget.classList.contains(pe.firstButton)?r?i=this.add(n,parseFloat(this.step.toString()),!0):i=this.add(n,parseFloat(this.step.toString()),!1):t.keyCode===38||t.keyCode===39||t.currentTarget.classList.contains(pe.secondButton)?r?i=this.add(n,parseFloat(this.step.toString()),!1):i=this.add(n,parseFloat(this.step.toString()),!0):t.keyCode===33||t.currentTarget.classList.contains(pe.firstButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):t.keyCode===34||t.currentTarget.classList.contains(pe.secondButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):t.keyCode===36?i=parseFloat(this.min<this.max?this.min.toString():this.max.toString()):t.keyCode===35&&(i=parseFloat(this.min<this.max?this.max.toString():this.min.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(pe.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),t.currentTarget.classList.contains(pe.firstButton)&&I.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),t.currentTarget.classList.contains(pe.secondButton)&&I.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},e.prototype.tooltipToggle=function(t){this.isMaterialTooltip?this.tooltipElement.classList.contains(pe.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(t):this.openTooltip(t)},e.prototype.buttonUp=function(t){t.currentTarget.classList.contains(pe.firstButton)&&I.remove(this.firstBtn,"mouseup touchend",this.buttonUp),t.currentTarget.classList.contains(pe.secondButton)&&I.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},e.prototype.setRangeBar=function(){this.orientation==="Horizontal"&&!m(this.rangeBar)?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",tt(this.rangeBar,{width:m(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",tt(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):m(this.rangeBar)||(this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",tt(this.rangeBar,{height:m(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",tt(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"})))},e.prototype.checkValidValueAndPos=function(t){return t=this.checkHandleValue(t),t=this.checkHandlePosition(t),t},e.prototype.setLimitBarPositions=function(t,i,r,n){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=t+"px",this.limitBarFirst.style.width=i-t+"px"):(this.limitBarFirst.style.left=t+"px",this.limitBarFirst.style.width=i-t+"px"):(this.limitBarFirst.style.bottom=(this.min<this.max?t:i)+"px",this.limitBarFirst.style.height=(this.min<this.max?i-t:t-i)+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.left=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.bottom=(this.min<this.max?r:n)+"px",this.limitBarSecond.style.height=(this.min<this.max?n-r:r-n)+"px"))},e.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var t=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];t=this.checkValidValueAndPos(t);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(t,i)}else if(this.type==="Range"){var r=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var a=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];a=this.checkValidValueAndPos(a);var o=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];o=this.checkValidValueAndPos(o),this.setLimitBarPositions(r,n,a,o)}},e.prototype.getLimitValueAndPosition=function(t,i,r,n){return m(i)&&(i=this.min<this.max?this.min:this.max,m(t)&&n&&(t=i)),m(r)&&(r=this.min<this.max?this.max:this.min,m(t)&&n&&(t=r)),t<i&&(t=i),t>r&&(t=r),[t,this.checkHandlePosition(t)]},e.prototype.setValue=function(){if(!m(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=m(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,m(this.activeHandle)?this.type==="Range"?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var t=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=t[0],this.handlePos1=t[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},e.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat(qe(this.min)),parseFloat(qe(this.max))])},e.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},e.prototype.modifyZindex=function(){this.type==="Range"&&!m(this.firstHandle)&&!m(this.secondHandle)?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=bu(this.element)+"")},e.prototype.setHandlePosition=function(t){var i=this,r,n=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?r=[this.firstHandle,this.materialHandle]:r=[this.getHandle()],this.handleStart(),r.forEach(function(a){i.orientation==="Horizontal"?i.enableRtl?a.style.right=n+"px":a.style.left=n+"px":a.style.bottom=n+"px"}),this.changeEvent("change",t)},e.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},e.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},e.prototype.changeEvent=function(t,i){var r=t==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),r!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(t,this.changeEventArgs(t,i)),this.initialTooltip=!0,this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.firstHandle);else{var n=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:n},!0),(r.length===this.value.length&&this.value[0]!==r[0]||this.value[1]!==r[1])&&(this.initialTooltip=!1,this.trigger(t,this.changeEventArgs(t,i)),this.initialTooltip=!0,this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},e.prototype.changeEventArgs=function(t,i){var r;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),r={value:this.value,previousValue:t==="change"?this.previousVal:this.previousChanged,action:t,text:typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,isInteracted:!m(i)}):r={value:this.value,previousValue:t==="change"?this.previousVal:this.previousChanged,action:t,text:m(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!m(i)},r},e.prototype.setPreviousVal=function(t,i){t==="change"?this.previousVal=i:this.previousChanged=i},e.prototype.updateRangeValue=function(){var t=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[t[1],t[0]]:this.value=[t[0],t[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.min<this.max&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.min>this.max&&this.handlePos1<this.handlePos2&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},e.prototype.checkHandlePosition=function(t){var i;return t=100*(t-parseFloat(qe(this.min)))/(parseFloat(qe(this.max))-parseFloat(qe(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(t/100):i=this.element.getBoundingClientRect().height*(t/100),parseFloat(qe(this.max))===parseFloat(qe(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},e.prototype.checkHandleValue=function(t){if(this.min===this.max)return parseFloat(qe(this.max));var i=this.tempStartEnd();return t<i.start?t=i.start:t>i.end&&(t=i.end),t},e.prototype.reposition=function(){var t=this;m(this.firstHandle)||(this.firstHandle.style.transition="none"),this.type!=="Default"&&!m(this.rangeBar)&&(this.rangeBar.style.transition="none"),this.type==="Range"&&!m(this.secondHandle)&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&!m(this.materialHandle)&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"&&!m(this.rangeBar)?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",tt(this.rangeBar,{width:m(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&!m(this.secondHandle)&&!m(this.rangeBar)&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",tt(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",tt(this.rangeBar,{height:m(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",tt(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){m(t.firstHandle)||(t.firstHandle.style.transition=t.scaleTransform),t.type==="Range"&&!m(t.secondHandle)&&(t.secondHandle.style.transition=t.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},e.prototype.changeHandleValue=function(t){var i=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(t),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&(this.handlePos1>this.handlePos2&&this.min<this.max||this.handlePos1<this.handlePos2&&this.min>this.max)&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(i=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(t),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&(this.handlePos2<this.handlePos1&&this.min<this.max||this.handlePos2>this.handlePos1&&this.min>this.max)&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(i=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),i!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(null))},e.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},e.prototype.xyToPosition=function(t){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var r=t.x-this.element.getBoundingClientRect().left,n=this.element.offsetWidth/100;this.val=r/n}else{var a=t.y-this.element.getBoundingClientRect().top,n=this.element.offsetHeight/100;this.val=100-a/n}var o=this.stepValueCalculation(this.val);return o<0?o=0:o>100&&(o=100),this.enableRtl&&this.orientation!=="Vertical"&&(o=100-o),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(o/100):i=this.element.getBoundingClientRect().height*(o/100),i},e.prototype.stepValueCalculation=function(t){this.step===0&&(this.step=1);var i=parseFloat(qe(this.step))/((parseFloat(qe(this.max))-parseFloat(qe(this.min)))/100),r=t%Math.abs(i);return r!==0&&(i/2>r?t-=r:t+=Math.abs(i)-r),t},e.prototype.add=function(t,i,r){var n=Math.pow(10,3),a;return r?a=(Math.round(t*n)+Math.round(i*n))/n:a=(Math.round(t*n)-Math.round(i*n))/n,a},e.prototype.positionToValue=function(t){var i,r=parseFloat(qe(this.max))-parseFloat(qe(this.min));this.orientation==="Horizontal"?i=t/this.element.getBoundingClientRect().width*r:i=t/this.element.getBoundingClientRect().height*r;var n=this.add(i,parseFloat(this.min.toString()),!0);return n},e.prototype.sliderBarClick=function(t){t.preventDefault();var i;t.type==="mousedown"||t.type==="mouseup"||t.type==="click"?i={x:t.clientX,y:t.clientY}:(t.type==="touchend"||t.type==="touchstart")&&(i={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY});var r=this.xyToPosition(i),n=this.positionToValue(r);if(this.type==="Range"&&(this.min<this.max&&this.handlePos2-r<r-this.handlePos1||this.min>this.max&&this.handlePos1-r>r-this.handlePos2)){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=a[0],r=a[1]}this.secondHandle.classList.add(pe.sliderActiveHandle),this.handlePos2=this.preHandlePos2=r,this.handleVal2=n}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=a[0],r=a[1]}this.firstHandle.classList.add(pe.sliderActiveHandle),this.handlePos1=this.preHandlePos1=r,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(pe.materialTooltipActive);var o=this.element.querySelector("."+pe.sliderTabHandle);o&&this.getHandle()!==o&&o.classList.remove(pe.sliderTabHandle);var l=this.activeHandle===1?this.firstHandle:this.secondHandle,h;if((t.type==="click"||t.type==="mousedown")&&t.target===l){var u=t.clientX,c=t.clientY;h=document.elementFromPoint(u,c)}if(t.target===l&&h!=l){(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(pe.sliderTabHandle)&&this.materialChange(),this.sliderBarUp(t),this.tooltipToggle(this.getHandle());return}if(this.checkRepeatedValue(n)){var d=(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=d.handle,this.type!=="Default"&&(this.rangeBar.style.transition=d.rangeBar),this.setHandlePosition(t),this.isMaterialTooltip&&(this.initialTooltip=!1),t.target!=l&&this.changeEvent("changed",t),this.type!=="Default"&&this.setRangeBar()}},e.prototype.handleValueAdjust=function(t,i,r){r===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):r===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},e.prototype.dragRangeBarMove=function(t){var i,r;t.type!=="touchmove"&&t.preventDefault(),this.rangeBarDragged=!0;var n;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var a,o;if(t.type==="mousemove"?(i=[t.clientX,t.clientY],a=i[0],o=i[1]):(r=[t.changedTouches[0].clientX,t.changedTouches[0].clientY],a=r[0],o=r[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?n={x:a+this.secondPartRemain,y:o+this.secondPartRemain}:n={x:a-this.firstPartRemain,y:o+this.secondPartRemain},this.min>this.max?(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)):(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)),this.enableRtl?n={x:a-this.firstPartRemain,y:o-this.firstPartRemain}:n={x:a+this.secondPartRemain,y:o-this.firstPartRemain},this.min>this.max?(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)):(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)),this.limits.enabled){var l=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=l[0],this.handlePos1=l[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),l=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=l[0],this.handlePos2=l[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===(this.min>this.max?this.min:this.max)&&this.handleValueAdjust(this.handleVal2,this.min>this.max?this.min:this.max,2),this.handleVal1===(this.min>this.max?this.max:this.min)&&this.handleValueAdjust(this.handleVal1,this.min>this.max?this.max:this.min,1)}this.activeHandle=1,this.setHandlePosition(t),this.activeHandle=2,this.setHandlePosition(t),this.tooltipToggle(this.rangeBar),this.setRangeBar()},e.prototype.sliderBarUp=function(t){this.changeEvent("changed",t),this.handleFocusOut(),this.firstHandle.classList.remove(pe.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(pe.sliderActiveHandle)),this.closeTooltip(),(this.isMaterial||this.isMaterial3)&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(pe.materialTooltipActive)),I.remove(document,"mousemove touchmove",this.sliderBarMove),I.remove(document,"mouseup touchend",this.sliderBarUp)},e.prototype.sliderBarMove=function(t){t.type!=="touchmove"&&t.preventDefault();var i;t.type==="mousemove"?i={x:t.clientX,y:t.clientY}:i={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};var r=this.xyToPosition(i),n=this.positionToValue(r);if(r=Math.round(r),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);r=a[1],n=a[0]}this.handlePos1=r,this.handleVal1=n}this.firstHandle.classList.add(pe.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(pe.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&((this.min<this.max&&r>this.handlePos2||this.min>this.max&&r<this.handlePos2)&&(r=this.handlePos2,n=this.handleVal2),r!==this.preHandlePos1)){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=o[0],r=o[1]}this.handlePos1=this.preHandlePos1=r,this.handleVal1=n,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(pe.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&((this.min<this.max&&r<this.handlePos1||this.min>this.max&&r>this.handlePos1)&&(r=this.handlePos1,n=this.handleVal1),r!==this.preHandlePos2))){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=o[0],r=o[1]}this.handlePos2=this.preHandlePos2=r,this.handleVal2=n,this.activeHandle=2}}this.checkRepeatedValue(n)&&(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(t),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(pe.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},e.prototype.dragRangeBarUp=function(t){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(t)),this.changeEvent("changed",t),this.closeTooltip(),I.remove(document,"mousemove touchmove",this.dragRangeBarMove),I.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},e.prototype.checkRepeatedValue=function(t){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(t===i)return 0}else if(t===this.previousVal)return 0;return 1},e.prototype.refreshTooltip=function(t){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),t&&(this.tooltipObj.refresh(t),this.tooltipTarget=t))},e.prototype.openTooltip=function(t){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(t),this.tooltipTarget=t)},e.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},e.prototype.keyDown=function(t){switch(t.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:t.preventDefault(),this.buttonClick(t);break}},e.prototype.wireButtonEvt=function(t){t?(I.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),I.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),I.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),I.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),I.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),I.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),I.remove(this.firstBtn,"focusout",this.sliderFocusOut),I.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(I.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),I.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),I.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),I.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),I.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),I.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),I.add(this.firstBtn,"focusout",this.sliderFocusOut,this),I.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},e.prototype.rangeBarMousedown=function(t){var i,r;if(t.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&t.target===this.rangeBar){var n=void 0,a=void 0;t.type==="mousedown"?(i=[t.clientX,t.clientY],n=i[0],a=i[1]):t.type==="touchstart"&&(r=[t.changedTouches[0].clientX,t.changedTouches[0].clientY],n=r[0],a=r[1]),this.orientation==="Horizontal"?(this.firstPartRemain=n-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-n):(this.firstPartRemain=a-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-a),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var o=this.element.querySelector("."+pe.sliderTabHandle);o&&o.classList.remove(pe.sliderTabHandle),I.add(document,"mousemove touchmove",this.dragRangeBarMove,this),I.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},e.prototype.elementClick=function(t){if(this.isDragComplete){this.isDragComplete=!1;return}t.preventDefault(),this.focusSliderElement(),this.sliderBarClick(t),this.focusHandle()},e.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(I.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&I.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),I.add(this.sliderContainer,"keydown",this.keyDown,this),I.add(this.sliderContainer,"keyup",this.keyUp,this),I.add(this.element,"focusout",this.sliderFocusOut,this),I.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&I.add(this.formElement,"reset",this.formResetHandler,this))},e.prototype.unwireEvents=function(){I.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&I.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),I.remove(this.sliderContainer,"keydown",this.keyDown),I.remove(this.sliderContainer,"keyup",this.keyUp),I.remove(this.element,"focusout",this.sliderFocusOut),I.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),I.remove(this.element,"reset",this.formResetHandler)},e.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},e.prototype.keyUp=function(t){if(t.keyCode===9&&t.target.classList.contains(pe.sliderHandle)&&(this.focusSliderElement(),!t.target.classList.contains(pe.sliderTabHandle))){this.element.querySelector("."+pe.sliderTabHandle)&&this.element.querySelector("."+pe.sliderTabHandle).classList.remove(pe.sliderTabHandle),t.target.classList.add(pe.sliderTabHandle);var i=t.target.parentElement;i===this.element&&(i.querySelector("."+pe.sliderTrack).classList.add(pe.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+pe.rangeBar).classList.add(pe.sliderTabRange)),this.type==="Range"&&(t.target.previousSibling.classList.contains(pe.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",t)},e.prototype.hover=function(t){if(!m(t))if(t.type==="mouseover"||t.type==="touchmove"||t.type==="mousemove"||t.type==="pointermove"||t.type==="touchstart")this.sliderContainer.classList.add(pe.sliderHover);else{this.sliderContainer.classList.remove(pe.sliderHover);var i=t.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(pe.sliderHandleFocused)&&!i.classList.contains(pe.sliderTabHandle)&&this.closeMaterialTooltip()}},e.prototype.sliderFocusOut=function(t){t.relatedTarget!==this.secondHandle&&t.relatedTarget!==this.firstHandle&&t.relatedTarget!==this.element&&t.relatedTarget!==this.firstBtn&&t.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+pe.sliderTabHandle)&&this.element.querySelector("."+pe.sliderTabHandle).classList.remove(pe.sliderTabHandle),this.element.querySelector("."+pe.sliderTabTrack)&&(this.element.querySelector("."+pe.sliderTabTrack).classList.remove(pe.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+pe.sliderTabRange)&&this.element.querySelector("."+pe.sliderTabRange).classList.remove(pe.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},e.prototype.removeElement=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.prototype.changeSliderType=function(t,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(pe.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,t!=="Default"&&(t==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!m(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(t==="MinRange"||t==="Default"?m(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):m(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig()},e.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var t=this.enableRtl&&this.orientation!=="Vertical";De(t?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),De(t?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},e.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},e.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},e.prototype.limitsPropertyChange=function(){this.limits.enabled?(m(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),m(this.limitBarFirst)&&m(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(m(this.limitBarFirst)||ne(this.limitBarFirst),m(this.limitBarSecond)||ne(this.limitBarSecond))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),te([this.sliderContainer],[pe.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),ne(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML="",this.hiddenInput=null,this.sliderContainer=null,this.sliderTrack=null,this.rangeBar=null,this.firstHandle=null,this.secondHandle=null,this.tickElementCollection=null,this.ul=null,this.firstBtn=null,this.secondBtn=null,this.materialHandle=null,this.tooltipObj=null,this.tooltipTarget=null,this.limitBarFirst=null,this.limitBarSecond=null,this.firstChild=null,this.lastChild=null,this.tooltipElement=null},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(t&&i){var l=m(t.value)?this.type==="Range"?[this.min,this.max]:this.min:t.value;this.setProperties({value:l},!0),!m(i.value)&&i.value.toString()!==l.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&(m(t.value)||i.value[1]===l[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!m(t.tooltip)&&!m(i.tooltip)&&(this.setTooltip(o),this.showButtons||this.wireEvents());break;case"type":!m(i)&&Object.keys(i).length&&!m(i.type)&&(this.changeSliderType(i.type,o),this.setZindex());break;case"enableRtl":i.enableRtl!==t.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":m(this.sliderContainer.querySelector("."+pe.scale))||(ne(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(h){h.match(/e-scale-/)&&r.sliderContainer.classList.remove(h)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":t.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(pe.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(t.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},e.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(pe.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(pe.readonly))},e.prototype.setMinMaxValue=function(){var t=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),m(this.sliderContainer.querySelector("."+pe.scale))||this.ul&&(ne(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&t.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},e.prototype.setZindex=function(){this.zIndex=6,!m(this.ticks)&&this.ticks.placement!=="None"&&!m(this.ul)&&!m(this.element)&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!this.isMaterial3&&!m(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),m(this.firstHandle)||(this.firstHandle.style.zIndex=this.zIndex+3+""),this.type==="Range"&&!m(this.secondHandle)&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},e.prototype.setTooltip=function(t){this.changeSliderType(this.type,t)},e.prototype.setBarColor=function(){for(var t,i,r=this.sliderTrack.lastElementChild;r;)this.sliderTrack.removeChild(r),r=this.sliderTrack.lastElementChild;for(var n=0;n<this.colorRange.length;n++)if(!m(this.colorRange[n].start)&&!m(this.colorRange[n].end)&&this.colorRange[n].end>this.colorRange[n].start){this.colorRange[n].start<this.min&&(this.colorRange[n].start=this.min),this.colorRange[n].end>this.max&&(this.colorRange[n].end=this.max);var a=this.checkHandlePosition(this.colorRange[n].start),o=this.checkHandlePosition(this.colorRange[n].end),l=this.createElement("div");l.style.backgroundColor=this.colorRange[n].color,l.style.border="1px solid "+this.colorRange[n].color,this.orientation==="Horizontal"?(i=pe.sliderHorizantalColor,this.enableRtl?m(this.customValues)?t=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[n].end):t=this.checkHandlePosition(this.customValues.length-this.colorRange[n].end-1):t=this.checkHandlePosition(this.colorRange[n].start),l.style.width=o-a+"px",l.style.left=t+"px"):(i=pe.sliderVerticalColor,t=this.checkHandlePosition(this.colorRange[n].start),l.style.height=o-a+"px",l.style.bottom=t+"px"),l.classList.add(i),this.sliderTrack.appendChild(l)}},e.prototype.getModuleName=function(){return"slider"},Nt([S(null)],e.prototype,"value",void 0),Nt([S(null)],e.prototype,"customValues",void 0),Nt([S(1)],e.prototype,"step",void 0),Nt([S(null)],e.prototype,"width",void 0),Nt([S(0)],e.prototype,"min",void 0),Nt([S(100)],e.prototype,"max",void 0),Nt([S(!1)],e.prototype,"readonly",void 0),Nt([S("Default")],e.prototype,"type",void 0),Nt([ii([{}],Lq)],e.prototype,"colorRange",void 0),Nt([Ee({},kq)],e.prototype,"ticks",void 0),Nt([Ee({},Oq)],e.prototype,"limits",void 0),Nt([S(!0)],e.prototype,"enabled",void 0),Nt([Ee({},Rq)],e.prototype,"tooltip",void 0),Nt([S(!1)],e.prototype,"showButtons",void 0),Nt([S(!0)],e.prototype,"enableAnimation",void 0),Nt([S("Horizontal")],e.prototype,"orientation",void 0),Nt([S("")],e.prototype,"cssClass",void 0),Nt([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),Nt([_()],e.prototype,"created",void 0),Nt([_()],e.prototype,"change",void 0),Nt([_()],e.prototype,"changed",void 0),Nt([_()],e.prototype,"renderingTicks",void 0),Nt([_()],e.prototype,"renderedTicks",void 0),Nt([_()],e.prototype,"tooltipChange",void 0),e=Nt([Ot],e),e}(Pi),zq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ln=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Qu={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")},N0;(function(s){s[s.Message=0]="Message",s[s.Label=1]="Label"})(N0||(N0={}));var jq=function(s){zq(e,s);function e(i,r){var n=s.call(this,r,i)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.localyMessage={},n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},typeof n.rules>"u"&&(n.rules={}),n.l10n=new In("formValidator",n.defaultMessages,n.locale),n.locale&&n.localeFunc(),sd.on("notifyExternalChange",n.afterLocalization,n),i=typeof i=="string"?$(i,document):i,n.element!=null)n.element.setAttribute("novalidate",""),n.inputElements=ze(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents();else return;return n}t=e,e.prototype.addRules=function(i,r){i&&(this.rules.hasOwnProperty(i)?me(this.rules[""+i],r,{}):this.rules[""+i]=r)},e.prototype.removeRules=function(i,r){if(!i&&!r)this.rules={};else if(this.rules[""+i]&&!r)delete this.rules[""+i];else{if(m(this.rules[""+i]&&r))return;for(var n=0;n<r.length;n++)delete this.rules[""+i][r[parseInt(n.toString())]]}},e.prototype.validate=function(i){var r=Object.keys(this.rules);if(i&&r.length)return this.validateRules(i),r.indexOf(i)!==-1&&this.errorRules.filter(function(l){return l.name===i}).length===0;this.errorRules=[];for(var n=0,a=r;n<a.length;n++){var o=a[n];this.validateRules(o)}return this.errorRules.length===0},e.prototype.reset=function(){this.element.reset(),this.clearForm()},e.prototype.getInputElement=function(i){return this.inputElement=$('[name="'+i+'"]',this.element),this.inputElement},e.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var i=ze("."+this.errorClass+", ."+this.validClass,this.element),r=0,n=i;r<n.length;r++){var a=n[r];ne(a)}s.prototype.destroy.call(this),this.infoElement=null,sd.off("notifyExternalChange",this.afterLocalization)},e.prototype.onPropertyChanged=function(i,r){for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];switch(o){case"locale":this.localeFunc();break}}},e.prototype.localeFunc=function(){for(var i=0,r=Object.keys(this.defaultMessages);i<r.length;i++){var n=r[i];this.l10n.setLocale(this.locale);var a=this.l10n.getConstant(n);this.localyMessage[""+n]=a}},e.prototype.getModuleName=function(){return"formvalidator"},e.prototype.afterLocalization=function(i){this.locale=i.locale,this.localeFunc()},e.prototype.refresh=function(){this.unwireEvents(),this.inputElements=ze(this.selectQuery,this.element),this.wireEvents()},e.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var i=ze(this.selectQuery,this.element),r=0,n=i;r<n.length;r++){var a=n[r],o=a;o.removeAttribute("aria-invalid");var l=o.parentElement,h=l.parentElement;l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||o.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.errorClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.errorClass):o.classList.remove(this.errorClass),o.name.length>0&&(this.getInputElement(o.name),this.getErrorElement(o.name),this.hideMessage(o.name)),l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||o.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.validClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.validClass):o.classList.remove(this.validClass)}},e.prototype.createHTML5Rules=function(){for(var i=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],r=["hidden","email","url","date","number","tel"],n=0,a=this.inputElements;n<a.length;n++){for(var o=a[n],l={},h=0,u=i;h<u.length;h++){var c=u[h];if(o.getAttribute(c)!==null)switch(c){case"required":this.defRule(o,l,c,o.required);break;case"data-validation":c=o.getAttribute(c),this.defRule(o,l,c,!0);break;case"type":r.indexOf(o.type)!==-1&&this.defRule(o,l,o.type,!0);break;case"rangeLength":case"range":this.defRule(o,l,c,JSON.parse(o.getAttribute(c)));break;case"equalTo":{var d=o.getAttribute(c);this.defRule(o,l,c,d)}break;default:o.getAttribute("data-val")==="true"?this.annotationRule(o,l,c,o.getAttribute(c)):this.defRule(o,l,c,o.getAttribute(c))}}Object.keys(l).length!==0&&this.addRules(o.name,l)}},e.prototype.annotationRule=function(i,r,n,a){var o=n.split("-"),l=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],h=o[o.length-1],u=o[o.length-2];if(l.indexOf(h)!==-1)switch(h){case"required":this.defRule(i,r,"required",a);break;case"creditcard":this.defRule(i,r,"creditcard",a);break;case"phone":this.defRule(i,r,"tel",a);break}else if(l.indexOf(u)!==-1)switch(u){case"maxlength":this.defRule(i,r,"maxLength",a);break;case"minlength":this.defRule(i,r,"minLength",a);break;case"range":{var c=i.getAttribute("data-val-range-min"),d=i.getAttribute("data-val-range-max");this.defRule(i,r,"range",[c,d])}break;case"equalto":{var p=i.getAttribute(n).split(".");this.defRule(i,r,"equalTo",p[p.length-1])}break;case"regex":this.defRule(i,r,"regex",a);break}},e.prototype.defRule=function(i,r,n,a){var o=i.getAttribute("data-"+n+"-message"),l=i.getAttribute("data-val-"+n),h;this.rules[i.name]&&n!=="validateHidden"&&n!=="hidden"&&(this.getInputElement(i.name),h=this.getErrorMessage(this.rules[i.name][""+n],n)),o?a=[a,o]:l?a=[a,l]:h&&(a=[a,h]),r[""+n]=a},e.prototype.wireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];t.isCheckable(n)?I.add(n,"click",this.clickHandler,this):n.tagName==="SELECT"?I.add(n,"change",this.changeHandler,this):(I.add(n,"focusout",this.focusOutHandler,this),I.add(n,"keyup",this.keyUpHandler,this))}I.add(this.element,"submit",this.submitHandler,this),I.add(this.element,"reset",this.resetHandler,this)},e.prototype.unwireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];I.clearEvents(n)}I.remove(this.element,"submit",this.submitHandler),I.remove(this.element,"reset",this.resetHandler)},e.prototype.focusOutHandler=function(i){this.trigger("focusout",i);var r=i.target;this.rules[r.name]&&(this.rules[r.name][this.required]||r.value.length>0?this.validate(r.name):this.validated.indexOf(r.name)===-1&&this.validated.push(r.name))},e.prototype.keyUpHandler=function(i){this.trigger("keyup",i);var r=i.target,n=[16,17,18,20,35,36,37,38,39,40,45,144,225];i.which===9&&(!this.rules[r.name]||this.rules[r.name]&&!this.rules[r.name][this.required])||this.validated.indexOf(r.name)!==-1&&this.rules[r.name]&&n.indexOf(i.which)===-1&&this.validate(r.name)},e.prototype.clickHandler=function(i){this.trigger("click",i);var r=i.target;r.type!=="submit"?this.validate(r.name):r.getAttribute("formnovalidate")!==null&&(this.allowSubmit=!0)},e.prototype.changeHandler=function(i){this.trigger("change",i);var r=i.target;this.validate(r.name)},e.prototype.submitHandler=function(i){this.trigger("submit",i),!this.allowSubmit&&!this.validate()?i.preventDefault():this.allowSubmit=!1},e.prototype.resetHandler=function(){this.clearForm()},e.prototype.validateRules=function(i){if(this.rules[""+i]){var r=Object.keys(this.rules[""+i]),n=!1,a=!1,o=r.indexOf("validateHidden"),l=r.indexOf("hidden");if(this.getInputElement(i),l!==-1&&(n=!0),o!==-1&&(a=!0),!n||n&&a){o!==-1&&r.splice(o,1),l!==-1&&r.splice(l-1,1),this.getErrorElement(i);for(var h=0,u=r;h<u.length;h++){var c=u[h],d=this.getErrorMessage(this.rules[""+i][""+c],c),p={name:i,message:d},f={inputName:i,element:this.inputElement,message:d};if(!this.isValid(i,c)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(i),this.errorRules.push(p),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info");var v=this.inputElement.parentElement,g=v.parentElement;v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):g!=null&&(g.classList.contains("e-control-wrapper")||g.classList.contains("e-wrapper"))?(g.classList.add(this.errorClass),g.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.infoElement?this.showMessage(p):this.createErrorElement(i,p.message,this.inputElement),f.errorElement=this.infoElement,f.status="failure",v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):g!=null&&(g.classList.contains("e-control-wrapper")||g.classList.contains("e-wrapper"))?(g.classList.add(this.errorClass),g.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.optionalValidationStatus(i,f),this.trigger("validationComplete",f),c==="required"&&this.inputElement.setAttribute("aria-required","true");break}else this.hideMessage(i),f.status="success",this.trigger("validationComplete",f)}}else return}},e.prototype.optionalValidationStatus=function(i,r){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!m(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),r.status="",this.hideMessage(i))},e.prototype.isValid=function(i,r){var n=this.rules[""+i][""+r],a=n instanceof Array&&typeof n[1]=="string"?n[0]:n,o=this.rules[""+i][""+r],l={value:this.inputElement.value,param:a,element:this.inputElement,formElement:this.element};if(this.trigger("validationBegin",l),!l.param&&r==="required")return!0;if(o&&typeof o[0]=="function"){var h=o[0];return h.call(this,{element:this.inputElement,value:this.inputElement.value})}else return t.isCheckable(this.inputElement)?r!=="required"?!0:ze('input[name="'+i+'"]:checked',this.element).length>0:t.checkValidator[""+r](l)},e.prototype.getErrorMessage=function(i,r){var n=this.inputElement.getAttribute("data-"+r+"-message")?this.inputElement.getAttribute("data-"+r+"-message"):i instanceof Array&&typeof i[1]=="string"?i[1]:Object.keys(this.localyMessage).length!==0?this.localyMessage[""+r]:this.defaultMessages[""+r],a=n.match(/{(\d)}/g);if(!m(a))for(var o=0;o<a.length;o++){var l=i instanceof Array?i[parseInt(o.toString())]:i;n=n.replace(a[parseInt(o.toString())],l)}return n},e.prototype.createErrorElement=function(i,r,n){var a=St(this.errorElement,{className:this.errorClass,innerHTML:r,attrs:{for:i}});if(this.errorOption===N0.Message&&(a.classList.remove(this.errorClass),a.classList.add("e-message"),a=St(this.errorContainer,{className:this.errorClass,innerHTML:a.outerHTML})),a.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+n.id+'"]'))this.element.querySelector('[data-valmsg-for="'+n.id+'"]').appendChild(a);else if(n.hasAttribute("data-msg-containerid")===!0){var o=n.getAttribute("data-msg-containerid"),l=$("#"+o,this.element);l.appendChild(a)}else if(this.customPlacement!=null)this.customPlacement.call(this,this.inputElement,a);else{var h=this.inputElement.parentElement,u=h.parentElement;h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper")?u.insertBefore(a,h.nextSibling):u.classList.contains("e-control-wrapper")||u.classList.contains("e-wrapper")?u.parentElement.insertBefore(a,u.nextSibling):h.insertBefore(a,this.inputElement.nextSibling)}a.style.display="block",this.getErrorElement(i),this.validated.push(i),this.checkRequired(i)},e.prototype.getErrorElement=function(i){return this.infoElement=$(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=$(this.errorElement+"."+this.errorClass+'[for="'+i+'"]',this.element)),this.infoElement},e.prototype.removeErrorRules=function(i){for(var r=0;r<this.errorRules.length;r++){var n=this.errorRules[parseInt(r.toString())];n.name===i&&this.errorRules.splice(r,1)}},e.prototype.showMessage=function(i){this.infoElement.style.display="block",this.infoElement.innerHTML=i.message,this.checkRequired(i.name)},e.prototype.hideMessage=function(i){if(this.infoElement){this.infoElement.style.display="none",this.removeErrorRules(i);var r=this.inputElement.parentElement,n=r.parentElement;r.classList.contains("e-control-wrapper")||r.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&r.classList.contains("e-input-group")?(r.classList.add(this.validClass),r.classList.remove(this.errorClass)):n!=null&&(n.classList.contains("e-control-wrapper")||n.classList.contains("e-wrapper"))?(n.classList.add(this.validClass),n.classList.remove(this.errorClass)):(this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass)),this.inputElement.setAttribute("aria-invalid","false")}},e.prototype.checkRequired=function(i){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!m(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(i))},e.isCheckable=function(i){var r=i.getAttribute("type");return r&&(r==="checkbox"||r==="radio"||r==="submit")};var t;return e.checkValidator={required:function(i){return isNaN(Date.parse(i.value))?i.value.toString().length>0:!isNaN(new Date(i.value).getTime())},email:function(i){return Qu.EMAIL.test(i.value)},url:function(i){return Qu.URL.test(i.value)},dateIso:function(i){return Qu.DATE_ISO.test(i.value)},tel:function(i){return Qu.PHONE.test(i.value)},creditcard:function(i){return Qu.CREDITCARD.test(i.value)},number:function(i){return!isNaN(Number(i.value))&&i.value.indexOf(" ")===-1},digits:function(i){return Qu.DIGITS.test(i.value)},maxLength:function(i){return i.value.length<=i.param},minLength:function(i){return i.value.length>=i.param},rangeLength:function(i){var r=i.param;return i.value.length>=r[0]&&i.value.length<=r[1]},range:function(i){var r=i.param;return!isNaN(Number(i.value))&&Number(i.value)>=r[0]&&Number(i.value)<=r[1]},date:function(i){if(!m(i.param)&&typeof i.param=="string"&&i.param!==""){var r=new _t,n={format:i.param.toString(),type:"dateTime",skeleton:"yMd"},a=r.parseDate(i.value,n);return!m(a)&&a instanceof Date&&!isNaN(+a)}else return!isNaN(new Date(i.value).getTime())},max:function(i){return isNaN(Number(i.value))?new Date(i.value).getTime()<=new Date(JSON.parse(JSON.stringify(i.param))).getTime():+i.value<=i.param},min:function(i){if(isNaN(Number(i.value)))if(i.value.indexOf(",")!==-1){var r=i.value.replace(/,/g,"");return parseFloat(r)>=i.param}else return new Date(i.value).getTime()>=new Date(JSON.parse(JSON.stringify(i.param))).getTime();else return+i.value>=i.param},regex:function(i){return new RegExp(i.param).test(i.value)},equalTo:function(i){var r=i.formElement.querySelector("#"+i.param);return i.param=r.value,i.param===i.value}},ln([S("")],e.prototype,"locale",void 0),ln([S("e-hidden")],e.prototype,"ignore",void 0),ln([S()],e.prototype,"rules",void 0),ln([S("e-error")],e.prototype,"errorClass",void 0),ln([S("e-valid")],e.prototype,"validClass",void 0),ln([S("label")],e.prototype,"errorElement",void 0),ln([S("div")],e.prototype,"errorContainer",void 0),ln([S(N0.Label)],e.prototype,"errorOption",void 0),ln([_()],e.prototype,"focusout",void 0),ln([_()],e.prototype,"keyup",void 0),ln([_()],e.prototype,"click",void 0),ln([_()],e.prototype,"change",void 0),ln([_()],e.prototype,"submit",void 0),ln([_()],e.prototype,"validationBegin",void 0),ln([_()],e.prototype,"validationComplete",void 0),ln([_()],e.prototype,"customPlacement",void 0),e=t=ln([Ot],e),e}(Xo),Bq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gu=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};function lv(s,e){for(var t=me({},s),i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];e.indexOf(n)<0&&dI(t,n)}return t}function Hq(s,e){var t=e===40?0:s.childElementCount-1,i=t,r,n=s.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var a=0,o=s.children.length;a<o;a++)s.children[a].classList.contains("e-focused")&&(r=s.children[a],i=a,r.classList.remove("e-focused"),e===40?i++:i--,i===(e===40?s.childElementCount:-1)&&(i=t));r=s.children[i],i=qz(s,r,i,e),i!==-1&&(Q([s.children[i]],"e-focused"),s.children[i].focus())}function qz(s,e,t,i,r){if(r===void 0&&(r=0),(e.classList.contains("e-separator")||e.classList.contains("e-disabled"))&&(t===(i===40?s.childElementCount-1:0)?t=i===40?0:s.childElementCount-1:i===40?t++:t--),e=s.children[t],e.classList.contains("e-separator")||e.classList.contains("e-disabled")){if(r++,r===s.childElementCount)return t=-1;t=qz(s,e,t,i,r)}return t}function Vq(s,e){var t=[].slice.call(s.getElementsByClassName("e-blank-icon"));if(e){var i=[].slice.call(s.getElementsByClassName("e-item"));i.forEach(function(h){(h.style.paddingLeft||h.style.paddingRight)&&h.removeAttribute("style")})}if(t.length){var r=s.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!m(r)){r.classList.contains("e-url")&&(r=r.querySelector(".e-menu-url"));var n=r.querySelector(".e-menu-icon"),a,o=s.classList.contains("e-rtl");o?a={padding:"paddingRight",margin:"marginLeft"}:a={padding:"paddingLeft",margin:"marginRight"};var l=parseInt(getComputedStyle(n).fontSize,10)+parseInt(getComputedStyle(n)[a.margin],10)+parseInt(getComputedStyle(r).paddingLeft,10)+"px";t.forEach(function(h){h.classList.contains("e-url")?h.querySelector(".e-menu-url").style[a.padding]=l:h.style[a.padding]=l})}}}var RM=function(s){Bq(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Gu([S("")],e.prototype,"iconCss",void 0),Gu([S("")],e.prototype,"id",void 0),Gu([S(!1)],e.prototype,"separator",void 0),Gu([S("")],e.prototype,"text",void 0),Gu([S("")],e.prototype,"url",void 0),Gu([S(!1)],e.prototype,"disabled",void 0),e}(ke),Uq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$r=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Ua={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},Or=function(s){Uq(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.isPopupCreated=!0,r}return e.prototype.preRender=function(){},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},e.prototype.addItems=function(t,i){for(var r,n=this.items.length,a=0,o=this.items.length;a<o;a++)if(i===this.items[a].text){n=a;break}for(var l=t.length-1;l>=0;l--)r=new RM(this,"items",t[l],!0),this.items.splice(n,0,r);this.canOpen()||this.createItems()},e.prototype.removeItems=function(t,i){for(var r=!1,n=0,a=t.length;n<a;n++)for(var o=0,l=this.items.length;o<l;o++)if(t[n]===(i?this.items[o].id:this.items[o].text)){this.items.splice(o,1),r=!0;break}r&&this.getULElement()&&this.createItems()},e.prototype.createPopup=function(){var t,i=this.createElement("div",{className:Ua.POPUP,id:this.element.id+"-popup"});document.body.appendChild(i),this.dropDown=new za(i,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),m(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),De(this.element,(t={},t["aria-haspopup"]=this.items.length||this.target?"true":"false",t["aria-expanded"]="false",t.type="button",t)),this.cssClass&&Q([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0},e.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!m(this.popupContent)?this.popupContent:typeof this.target=="string"?$(this.target):this.target},e.prototype.createItems=function(t){var i=this.items,r=this.hasIcon(this.items,"iconCss"),n,a,o,l,h=this.getULElement();h?h.innerHTML="":h=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}});for(var u=0;u<i.length;u++){a=i[u];var c=a.text;o=this.createElement("li",{innerHTML:a.url?"":c,className:a.separator?Ua.ITEM+" "+Ua.SEPARATOR:Ua.ITEM,attrs:a.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":c},id:a.id?a.id:mi("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?o.textContent=a.url?"":c:o.innerHTML=a.url?"":c,a.url&&(o.appendChild(this.createAnchor(a)),o.classList.add("e-url")),a.iconCss?(n=this.createElement("span",{className:Ua.ICON+" "+a.iconCss}),a.url?o.childNodes[0].appendChild(n):o.insertBefore(n,o.childNodes[0])):r&&!a.separator&&o.classList.add("e-blank-icon");var d=a.disabled;a.disabled&&o.classList.add("e-disabled"),l={item:a,element:o},this.trigger("beforeItemRender",l);var p=l.item.disabled;d!==p&&(l.item.disabled?o.classList.add("e-disabled"):o.classList.remove("e-disabled")),h.appendChild(o)}t&&this.getPopUpElement().appendChild(h),r&&Vq(this.getPopUpElement())},e.prototype.hasIcon=function(t,i){for(var r=0,n=t.length;r<n;r++)if(t[r][""+i])return!0;return!1},e.prototype.createAnchor=function(t){var i=this.enableHtmlSanitizer?Fi.sanitize(t.text):t.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:i,attrs:{href:t.url}})},e.prototype.initialize=function(){this.button=new Ql({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=mi("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},e.prototype.isColorPicker=function(){if(!this.element)return!1;var t=this.element.previousSibling;return!!(t&&t.classList&&t.classList.contains("e-split-colorpicker"))},e.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(Ua.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},e.prototype.setActiveElem=function(t){this.activeElem=t},e.prototype.getModuleName=function(){return"dropdown-btn"},e.prototype.canOpen=function(){var t=!1;return this.isPopupCreated&&(t=this.getPopUpElement().classList.contains("e-popup-close")),t},e.prototype.destroy=function(){var t=this;if(s.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&ne(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&te([this.element],i),te(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(n){t.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},e.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var t=document.getElementById(this.getPopUpElement().id);t&&(te([t],["e-popup-open","e-popup-close"]),ne(t))}I.remove(this.getPopUpElement(),"click",this.clickHandler),I.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1},e.prototype.getPopUpElement=function(){var t=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=Ct(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(t=this.dropDown.element),t},e.prototype.getULElement=function(){var t=null;return this.getPopUpElement()&&(t=this.getPopUpElement().children[0]),t},e.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||I.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),I.add(this.element,"click",this.clickHandler,this),I.add(this.element,"keydown",this.keyBoardHandler,this),I.add(window,"resize",this.windowResize,this)},e.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},e.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var t=this.getPopUpElement();this.createPopupOnClick&&I.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),t&&(I.add(t,"click",this.clickHandler,this),I.add(t,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&I.add(t,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=yr(t,{selector:"."+Ua.ITEM})},e.prototype.popupUnWireEvents=function(){var t=this.getPopUpElement();this.createPopupOnClick&&I.remove(document,"mousedown touchstart",this.delegateMousedownHandler),t&&t.parentElement&&(I.remove(t,"click",this.clickHandler),I.remove(t,"keydown",this.keyBoardHandler),this.closeActionEvents&&I.remove(t,this.closeActionEvents,this.focusoutHandler)),Zl&&this.rippleFn&&this.rippleFn()},e.prototype.keyBoardHandler=function(t){if(!(t.target===this.element&&(t.keyCode===9||!t.altKey&&t.keyCode===40||t.keyCode===38)))switch(t.keyCode){case 38:case 40:t.altKey&&(t.keyCode===38||t.keyCode===40)?this.keyEventHandler(t):this.upDownKeyHandler(t);break;case 9:case 13:case 27:case 32:this.keyEventHandler(t);break}},e.prototype.upDownKeyHandler=function(t){this.target&&(t.keyCode===38||t.keyCode===40)||(t.preventDefault(),Hq(this.getULElement(),t.keyCode))},e.prototype.keyEventHandler=function(t){if(!(this.target&&(t.keyCode===13||t.keyCode===9))){if(t.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.activeElem[0].focus();return}t.target&&t.target.className.indexOf("e-edit-template")>-1&&t.keyCode===32||(t.keyCode!==9&&t.preventDefault(),t.keyCode===27||t.keyCode===38||t.keyCode===9?this.canOpen()||this.closePopup(t,this.element):this.clickHandler(t))}},e.prototype.getLI=function(t){return t.tagName==="LI"?t:U(t,"li")},e.prototype.mousedownHandler=function(t){var i=t.target;this.dropDown&&!this.canOpen()&&!(U(i,'[id="'+this.getPopUpElement().id+'"]')||U(i,'[id="'+this.element.id+'"]'))&&this.closePopup(t)},e.prototype.focusoutHandler=function(t){if(this.isPopupCreated&&!this.canOpen()){var i=t.relatedTarget;if(i&&i.className.indexOf("e-item")>-1){var r=this.getLI(i);if(r){var n=Array.prototype.indexOf.call(this.getULElement().children,r),a=this.items[n];if(a){var o={element:r,item:a,event:t};this.trigger("select",o)}}}this.closePopup(t)}},e.prototype.clickHandler=function(t){var i=t.target;if(U(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(t):this.closePopup(t):this.isPopupCreated?this.closePopup(t,this.activeElem[0]):(this.createPopup(),this.openPopUp(t));else if(U(i,'[id="'+this.getPopUpElement().id+'"]')){var r=void 0,n=void 0,a=void 0,o=this.getLI(i);o&&(n=Array.prototype.indexOf.call(this.getULElement().children,o),a=this.items[n],a&&(r={element:o,item:a,event:t},this.trigger("select",r)),this.closePopup(t,this.activeElem[0]))}},e.prototype.openPopUp=function(t){var i=this;t===void 0&&(t=null);var r=this.getPopUpElement();if(!this.target)this.createItems(!0);else if(this.activeElem.length>1){var n=Ct(this.activeElem[0],"split-btn");n.isReact&&r.childNodes.length<1&&(n.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&r.childNodes.length<1&&(this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var a=this.getULElement();this.popupWireEvents();var o={element:a,items:this.items,event:t,cancel:!1};this.trigger("beforeOpen",o,function(l){if(!l.cancel){var h=i.getULElement();if(i.dropDown.show(null,i.element),Q([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),h&&h.focus(),i.enableRtl&&h.parentElement.style.left!=="0px"){var u=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?u=i.element.parentElement.offsetWidth:u=i.element.offsetWidth;var c=h.parentElement.offsetWidth-u,d=parseFloat(h.parentElement.style.left)-c;d<0&&(d=0),h.parentElement.style.left=d+"px"}var p={element:h,items:i.items};i.trigger("open",p)}})},e.prototype.closePopup=function(t,i){var r=this;t===void 0&&(t=null);var n=this.getULElement(),a={element:n,items:this.items,event:t,cancel:!1};this.trigger("beforeClose",a,function(o){if(o.cancel)n&&n.focus();else{var l=r.getPopUpElement();l&&I.remove(l,"keydown",r.keyBoardHandler),r.popupUnWireEvents();var h=r.getULElement(),u=void 0;h&&(u=h.querySelector(".e-selected")),u&&u.classList.remove("e-selected"),r.dropDown.hide(),te(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&i.focus();var c={element:h,items:r.items};r.trigger("close",c),!r.target&&h&&ne(h),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup()}})},e.prototype.unWireEvents=function(){this.createPopupOnClick||I.remove(document,"mousedown touchstart",this.delegateMousedownHandler),I.remove(this.element,"click",this.clickHandler),I.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(I.remove(this.getPopUpElement(),"click",this.clickHandler),I.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),I.remove(window,"resize",this.windowResize)},e.prototype.onPropertyChanged=function(t,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(lv(t,r));var n;this.isPopupCreated&&(n=this.getPopUpElement(),this.dropDown.setProperties(lv(t,["enableRtl"])));for(var a=0,o=Object.keys(t);a<o.length;a++){var l=o[a];switch(l){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":t.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(t.cssClass.indexOf(Ua.VERTICAL)>-1||i.cssClass.indexOf(Ua.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var h=this.element.querySelector("span.e-caret");t.cssClass.indexOf(Ua.VERTICAL)>-1?br(h,["e-icon-bottom"],["e-icon-right"]):br(h,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&te([n],i.cssClass.split(" ")),t.cssClass&&Q([n],t.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":t.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},e.prototype.focusIn=function(){this.element.focus()},$r([S("")],e.prototype,"content",void 0),$r([S("")],e.prototype,"cssClass",void 0),$r([S(!1)],e.prototype,"disabled",void 0),$r([S("")],e.prototype,"iconCss",void 0),$r([S("Left")],e.prototype,"iconPosition",void 0),$r([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),$r([ii([],RM)],e.prototype,"items",void 0),$r([S(!1)],e.prototype,"createPopupOnClick",void 0),$r([S("")],e.prototype,"target",void 0),$r([S("")],e.prototype,"closeActionEvents",void 0),$r([_()],e.prototype,"beforeItemRender",void 0),$r([_()],e.prototype,"beforeOpen",void 0),$r([_()],e.prototype,"beforeClose",void 0),$r([_()],e.prototype,"close",void 0),$r([_()],e.prototype,"open",void 0),$r([_()],e.prototype,"select",void 0),$r([_()],e.prototype,"created",void 0),e=$r([Ot],e),e}(Pi),_q=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),hn=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},km="e-rtl",JS="EJS-SPLITBUTTON",FM=function(s){_q(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){var t=this.element;if(t.tagName===JS){for(var i=ie("ej2_instances",t),r=this.createElement("button",{attrs:{type:"button"}}),n=this.createElement(JS,{className:"e-"+this.getModuleName()+"-wrapper"}),a=0,o=t.attributes.length;a<o;a++)r.setAttribute(t.attributes[a].nodeName,t.attributes[a].nodeValue);t.parentNode.insertBefore(n,t),ne(t),t=r,n.appendChild(t),kt("ej2_instances",i,t),this.wrapper=n,this.element=t}this.element.id||(this.element.id=mi("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},e.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},e.prototype.addItems=function(t,i){s.prototype.addItems.call(this,t,i),this.secondaryBtnObj.items=this.items},e.prototype.removeItems=function(t,i){s.prototype.removeItems.call(this,t,i),this.secondaryBtnObj.items=this.items},e.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(km),this.cssClass&&Q([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},e.prototype.createPrimaryButton=function(){var t={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new Ql(t),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},e.prototype.createSecondaryButton=function(){var t=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var r={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};r.beforeItemRender=function(n){t.createPopupOnClick&&(t.secondaryBtnObj.dropDown.relateTo=t.wrapper,t.dropDown=t.secondaryBtnObj.dropDown),t.trigger("beforeItemRender",n)},r.open=function(n){t.trigger("open",n)},r.close=function(n){t.trigger("close",n)},r.select=function(n){t.trigger("select",n)},r.beforeOpen=function(n){t.createPopupOnClick&&t.items.length==0&&(t.secondaryBtnObj.dropDown.relateTo=t.wrapper,t.dropDown=t.secondaryBtnObj.dropDown);var a=new k0;return t.trigger("beforeOpen",n,function(o){a.resolve(o)}),a},r.beforeClose=function(n){var a=new k0;return t.trigger("beforeClose",n,function(o){a.resolve(o)}),a},this.secondaryBtnObj=new Or(r),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.isPopupCreated=this.secondaryBtnObj.isPopupCreated,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right"),this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},e.prototype.setAria=function(){De(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},e.prototype.getModuleName=function(){return"split-btn"},e.prototype.toggle=function(){this.secondaryBtnObj.toggle()},e.prototype.destroy=function(){var t=this,i=[km];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var r=document.getElementById(this.element.id);r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===JS?(this.wrapper.innerHTML="",te([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),te([this.wrapper],this.cssClass.split(" "))):(te([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){t.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),pt(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),s.prototype.destroy.call(this),this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class"),this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(n){t.element.classList.add(n)}),kt("ej2_instances",[this],this.element)),this.wrapper=null},e.prototype.wireEvents=function(){I.add(this.element,"click",this.primaryBtnClickHandler,this),new wr(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},e.prototype.unWireEvents=function(){I.remove(this.element,"click",this.primaryBtnClickHandler),Ln(this.element,wr).destroy()},e.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},e.prototype.btnKeyBoardHandler=function(t){switch(t.action){case"altdownarrow":this.clickHandler(t);break;case"enter":this.clickHandler(t),this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active");break}},e.prototype.onPropertyChanged=function(t,i){var r=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(lv(t,r)),r=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(t).indexOf("items")>-1&&(this.secondaryBtnObj.items=t.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(lv(t,r));for(var n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"cssClass":i.cssClass&&te([this.wrapper],i.cssClass.split(" ")),Q([this.wrapper],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?Q([this.wrapper],km):te([this.wrapper],km);break;case"disabled":t.disabled?Q([this.wrapper],"e-splitbtn-disabled"):te([this.wrapper],"e-splitbtn-disabled")}}},e.prototype.focusIn=function(){this.element.focus()},hn([S("")],e.prototype,"content",void 0),hn([S("")],e.prototype,"cssClass",void 0),hn([S(!1)],e.prototype,"disabled",void 0),hn([S("")],e.prototype,"iconCss",void 0),hn([S("Left")],e.prototype,"iconPosition",void 0),hn([S(!1)],e.prototype,"createPopupOnClick",void 0),hn([ii([],RM)],e.prototype,"items",void 0),hn([S("")],e.prototype,"target",void 0),hn([_()],e.prototype,"beforeItemRender",void 0),hn([_()],e.prototype,"beforeOpen",void 0),hn([_()],e.prototype,"beforeClose",void 0),hn([_()],e.prototype,"click",void 0),hn([_()],e.prototype,"close",void 0),hn([_()],e.prototype,"open",void 0),hn([_()],e.prototype,"select",void 0),hn([_()],e.prototype,"created",void 0),e=hn([Ot],e),e}(Or),k0=function(){function s(){var e=this;this.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return s}(),Wq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),sr=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},pp="e-apply",Lm="e-cancel",ex="e-current",qq="e-container",fp="e-ctrl-btn",$u="e-switch-ctrl-btn",mk="e-disabled",gk="e-value-switch-btn",yk="e-handler",bk="e-hex",tx="e-hide-hex-value",ix="e-hide-opacity",Xu="e-hide-switchable-value",Ch="e-hide-value",Ck="e-hide-valueswitcher",vp="e-hsv-color",Sk="e-hsv-container",Ku="e-selected-value",Om="e-mode-switch-btn",rx="e-nocolor-item",nx="e-opacity-value",mp="e-palette",Rm="e-color-palette",sx="e-color-picker",Fm="e-preview-container",Pm="e-previous",Yq="e-rtl",Zu="e-show-value",gp="e-selected",zm="e-split-preview",jm="e-tile",Qq={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},PM=function(s){Wq(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){var t=this.element;this.formElement=U(this.element,"form"),this.formElement&&I.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new In("colorpicker",i,this.locale),t.getAttribute("ejs-for")&&!t.getAttribute("name")&&t.setAttribute("name",t.id)},e.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||Q([this.container.parentElement],ix),this.renderComplete()},e.prototype.initWrapper=function(){var t=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(t,this.element),t.appendChild(this.element),De(this.element,{tabindex:"-1",spellcheck:"false","aria-label":"colorpicker"}),this.container=this.createElement("div",{className:qq}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var r=i.slice(0,7);m(this.initialInputValue)&&(this.initialInputValue=r),this.element.value=r,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:r},!0),this.enableRtl&&t.classList.add(Yq),this.cssClass&&Q([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.tileRipple=yr(this.container,{selector:"."+jm}),this.ctrlBtnRipple=yr(this.container,{selector:".e-btn"})},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),B.isDevice&&this.refreshPopupPos()},e.prototype.createSplitBtn=function(){var t=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new FM({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){t.trigger("change",{currentValue:{hex:t.value.slice(0,7),rgba:t.convertToRgbString(t.hexToRgb(t.value))},previousValue:{hex:null,rgba:null},value:t.value})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i);var r=this.createElement("span",{className:zm});$(".e-selected-color",i).appendChild(r),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(Q([n],"e-colorpicker-popup"),this.cssClass&&Q([n],this.cssClass.replace(/\s+/g," ").trim().split(" ")),B.isDevice){var a=this.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,n.style.zIndex=bu(this.splitBtn.element).toString()}this.bindCallBackEvent()},e.prototype.onOpen=function(){if(this.trigger("open",{element:this.container}),!B.isDevice){var t=this.getPopupInst(),i=Qa(t.element);i.length>0&&(t.collision={X:"flip",Y:"fit"},t.position={X:"right",Y:"bottom"},t.targetType="container")}},e.prototype.getPopupInst=function(){return Ln(this.getPopupEle(),za)},e.prototype.bindCallBackEvent=function(){var t=this;this.splitBtn.beforeOpen=function(i){var r=new k0;return t.trigger("beforeOpen",i,function(n){if(!n.cancel){var a=t.getPopupEle();a.style.top=qe(0+pageYOffset),a.style.left=qe(0+pageXOffset),a.style.display="block",t.createWidget(),a.style.display="",B.isDevice&&(t.modal=t.createElement("div"),t.modal.className="e-"+t.getModuleName()+" e-modal",t.modal.style.display="none",document.body.insertBefore(t.modal,a),document.body.className+=" e-colorpicker-overflow",t.modal.style.display="block",t.modal.style.zIndex=(Number(a.style.zIndex)-1).toString())}i.cancel=n.cancel,r.resolve(n)}),r},this.splitBtn.beforeClose=function(i){var r=new k0;if(m(i.event))r.resolve(i);else{var n={element:t.container,event:i.event,cancel:!1};t.trigger("beforeClose",n,function(a){B.isDevice&&i.event.target===t.modal&&(a.cancel=!0),a.cancel||t.onPopupClose(),i.cancel=a.cancel,r.resolve(a)})}return r}},e.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",$("."+zm,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",te([this.container],[sx,Rm]),B.isDevice&&this.modal&&(te([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},e.prototype.createPalette=function(){if(br(this.container,[Rm],[sx]),this.presetColors){var t=this.createElement("div",{className:"e-custom-palette"});this.appendElement(t);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],t);else for(var r=0,n=i.length;r<n;r++)this.appendPalette(this.presetColors[i[r]],i[r],t);ze(".e-row",t).length>10&&Q([t],"e-palette-group")}else this.appendPalette(Qq.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var a=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=qe(this.container.children[0].offsetWidth+a+a),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},e.prototype.firstPaletteFocus=function(){$("."+gp,this.container.children[0])||ze("."+mp,this.container)[0].focus()},e.prototype.appendPalette=function(t,i,r){var n=this.createElement("div",{className:mp,attrs:{tabindex:"0",role:"grid"}});r?r.appendChild(n):this.appendElement(n);for(var a,o,l,h=0,u=t.length;h<u;h++)(h===0||h%this.columns===0)&&(a=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),n.appendChild(a)),l=this.roundValue(t[h]).toLowerCase(),o=this.createElement("span",{className:jm,attrs:{role:"gridcell","aria-label":l,"aria-selected":"false",tabindex:"0"}}),this.trigger("beforeTileRender",{element:o,presetName:i,value:t[h]}),a.appendChild(o),this.value===l&&(this.addTileSelection(o),n.focus()),o.style.backgroundColor=this.convertToRgbString(this.hexToRgb(l))},e.prototype.setNoColor=function(){var t=this.container.querySelector(".e-row").children[0];t.classList.add(rx),this.value||(t.classList.add(gp),U(t,"."+mp).focus()),["aria-selected","aria-label"].forEach(function(i){t.removeAttribute(i)}),t.style.backgroundColor=""},e.prototype.appendElement=function(t,i){i===void 0&&(i=0);var r=this.container.children[i];r?this.container.insertBefore(t,r):this.container.appendChild(t)},e.prototype.addTileSelection=function(t){t.classList.add(gp),t.setAttribute("aria-selected","true")},e.prototype.createPicker=function(){br(this.container,[sx],[Rm]);var t=this.createElement("div",{className:Sk});this.appendElement(t),t.appendChild(this.createElement("div",{className:vp}));var i=this.createElement("span",{className:yk,attrs:{tabindex:"0"}});t.appendChild(i),(this.value===null||this.value==="")&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},e.prototype.setHsvContainerBg=function(t){t===void 0&&(t=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(t,100,100,1))},e.prototype.getHsvContainer=function(){return $("."+Sk,this.container)},e.prototype.setHandlerPosition=function(){var t=this.getDragHandler(),i=$("."+vp,this.container);this.enableRtl?t.style.left=qe(i.offsetWidth*Math.abs(100-this.hsv[1])/100):t.style.left=qe(i.offsetWidth*this.hsv[1]/100),t.style.top=qe(i.offsetHeight*(100-this.hsv[2])/100)},e.prototype.createSlider=function(){var t=this.createElement("div",{className:"e-slider-preview"});this.appendElement(t,1),this.createPreview(t);var i=this.createElement("div",{className:"e-colorpicker-slider"});t.insertBefore(i,t.children[0]);var r=this.createElement("div",{className:"e-hue-slider"});i.appendChild(r),this.hueSlider=new vk({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(r),this.enableOpacity&&(r=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(r),this.createOpacitySlider(r))},e.prototype.createOpacitySlider=function(t){this.opacitySlider=new vk({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(t);var i=this.createElement("div",{className:"e-opacity-empty-track"});t.appendChild(i),this.updateOpacitySliderBg()},e.prototype.updateOpacitySliderBg=function(){var t=this.enableRtl?"to left":"to right",i=$(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+t+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},e.prototype.hueChange=function(t){this.hsv[0]=t.value,this.setHsvContainerBg(),this.convertToOtherFormat()},e.prototype.opacityChange=function(t){var i=t.value,r=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var n=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.triggerEvent(n,r,a)},e.prototype.updateOpacityInput=function(t){if(this.enableOpacity&&!this.getWrapper().classList.contains(Ch)){var i=Ln($("."+nx,this.container),to);i.value=t,i.dataBind()}},e.prototype.createPreview=function(t){var i=this.createElement("div",{className:Fm});t.appendChild(i);var r=this.createElement("span",{className:"e-preview "+ex});i.appendChild(r);var n=this.convertToRgbString(this.rgb);r.style.backgroundColor=n,r=this.createElement("span",{className:"e-preview "+Pm}),i.appendChild(r),r.style.backgroundColor=n},e.prototype.isPicker=function(){return!this.container.classList.contains(Rm)},e.prototype.getPopupEle=function(){return this.container.parentElement},e.prototype.createNumericInput=function(t,i,r,n){var a=this,o=new to({value:i,placeholder:r,min:0,max:n,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(l){l.event&&a.inputHandler(l.event)}});o.createElement=this.createElement,o.appendTo(t)},e.prototype.createInput=function(){var t=this.isPicker(),i=this.getWrapper();if(t&&!i.classList.contains(Ch)||!t&&i.classList.contains(Zu)){var r=this.createElement("div",{className:Ku});t?this.appendElement(r,2):this.appendElement(r,1);var n=this.createElement("div",{className:"e-input-container"});if(r.appendChild(n),i.classList.contains(Ck)||this.appendValueSwitchBtn(r),!i.classList.contains(tx)){var a=this.createElement("input",{className:bk,attrs:{maxlength:"7",spellcheck:"false","aria-label":"HEX"}});n.appendChild(a),ye.createInput({element:a,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),ye.setValue(this.value.slice(0,7),a),a.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(Xu)){var o=void 0,l=void 0;this.isRgb?(o="RGB",l=this.rgb):(o="HSV",l=this.hsv);for(var h=["rh","gs","bv"],u=0;u<3;u++)this.createNumericInput(n.appendChild(this.createElement("input",{className:"e-"+h[u]+"-value"})),l[u],o[u],255);this.enableOpacity&&this.appendOpacityValue(n)}}},e.prototype.appendOpacityValue=function(t){this.createNumericInput(t.appendChild(this.createElement("input",{className:nx})),this.rgb[3]*100,"A",100)},e.prototype.appendValueSwitchBtn=function(t){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+gk,attrs:{title:"Toggle format"}});t.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(Xu)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},e.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var t=this.createElement("div",{className:$u});if(this.container.appendChild(t),this.showButtons){var i=this.createElement("div",{className:fp});t.appendChild(i);var r=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-primary e-small "+pp,attrs:{title:r}}));var n=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-small "+Lm,attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},e.prototype.appendModeSwitchBtn=function(){var t=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Om,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});$("."+$u,this.container).insertBefore(t,$("."+fp,this.container))},e.prototype.createDragTooltip=function(){var t=this,i=new D0({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",htmlAttributes:{title:"tooltip"},beforeOpen:function(r){t.tooltipEle=r.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=bu(this.tooltipEle).toString(),this.tooltipEle.setAttribute("aria-label","colorpicker-tooltip"),$(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},e.prototype.getTooltipInst=function(){return Ln(this.container,D0)},e.prototype.setTooltipOffset=function(t){this.getTooltipInst().offsetY=t},e.prototype.toggleDisabled=function(t){t?this.getWrapper().classList.add(mk):this.getWrapper().classList.remove(mk),this.showButtons&&[].slice.call(ze(".e-btn",this.container)).forEach(function(i){t?De(i,{disabled:""}):i.removeAttribute("disabled")})},e.prototype.convertToRgbString=function(t){return t.length?t.length===4?"rgba("+t.join()+")":"rgb("+t.join()+")":""},e.prototype.convertToHsvString=function(t){return t.length===4?"hsva("+t.join()+")":"hsv("+t.join()+")"},e.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},e.prototype.convertToOtherFormat=function(t){t===void 0&&(t=!1);var i=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var r=this.rgbToHex(this.rgb),n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.updateInput(r),this.triggerEvent(r,i,n,t)},e.prototype.updateInput=function(t){var i=this.getWrapper();i.classList.contains(Ch)||(i.classList.contains(tx)||ye.setValue(t.substr(0,7),$("."+bk,this.container)),i.classList.contains(Xu)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},e.prototype.updatePreview=function(t){this.enableOpacity&&this.updateOpacitySliderBg(),$(".e-tip-transparent",this.tooltipEle).style.backgroundColor=t,$("."+Fm+" ."+ex,this.container).style.backgroundColor=t,$("."+Fm+" ."+Pm,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},e.prototype.getDragHandler=function(){return $("."+yk,this.container)},e.prototype.removeTileSelection=function(){var t=[].slice.call(ze("."+gp,this.container.children[0]));t.forEach(function(i){i.classList.remove(gp),i.setAttribute("aria-selected","false")})},e.prototype.convertRgbToNumberArray=function(t){return t.slice(t.indexOf("(")+1,t.indexOf(")")).split(",").map(function(i,r){return r!==3?parseInt(i,10):parseFloat(i)})},e.prototype.getValue=function(t,i){if(t||(t=this.value),i=i?i.toLowerCase():"hex",t[0]==="r"){var r=this.convertRgbToNumberArray(t);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,r.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"null"}else if(t[0]==="h"){var r=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(t));if(i==="rgba")return this.convertToRgbString(r);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="rgb"?this.convertToRgbString(r.slice(0,3)):"null"}else{t=this.roundValue(t);var a=this.hexToRgb(t);return(i==="rgb"||i==="hsv")&&(a=a.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(a):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,a)):i==="hex"?t.slice(0,7):i==="a"?a[3].toString():"null"}},e.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},e.prototype.getModuleName=function(){return"colorpicker"},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.wireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();I.add(t,"keydown",this.pickerKeyDown,this);var i=$("."+fp,this.container);i&&I.add(i,"keydown",this.ctrlBtnKeyDown,this),I.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),I.add($("."+Pm,this.container),"click",this.previewHandler,this)}else I.add(this.container,"click",this.paletteClickHandler,this),I.add(this.container,"keydown",this.paletteKeyDown,this)},e.prototype.formResetHandler=function(){this.value=this.initialInputValue,De(this.element,{value:this.initialInputValue})},e.prototype.addCtrlSwitchEvent=function(){var t=$("."+$u,this.container);t&&I.add(t,"click",this.btnClickHandler,this)},e.prototype.ctrlBtnKeyDown=function(t){if(t.keyCode===13){var i=$("."+pp,this.container);if(i){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}this.splitBtn.element.focus()}},e.prototype.pickerKeyDown=function(t){switch(t.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,t);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,t);break;case 38:this.handlerDragPosition(2,1,t);break;case 40:this.handlerDragPosition(2,-1,t);break;case 13:{t.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i,t)}}},e.prototype.enterKeyHandler=function(t,i){this.triggerChangeEvent(t),this.inline||this.splitBtn.element.focus()},e.prototype.closePopup=function(t){var i=this,r={element:this.container,event:t,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},e.prototype.triggerChangeEvent=function(t){var i=t.slice(0,7);this.trigger("change",{currentValue:{hex:i,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?t:i}),this.enableOpacity?this.setProperties({value:t},!0):this.setProperties({value:i},!0),this.element.value=i||"#000000"},e.prototype.handlerDragPosition=function(t,i,r){r.preventDefault(),this.hsv[t]+=i*(r.ctrlKey?1:3),this.hsv[t]<0&&(this.hsv[t]=0),this.updateHsv(),this.convertToOtherFormat(!0)},e.prototype.handlerDown=function(t){t.preventDefault(),t.type==="mousedown"?(this.clientX=Math.abs(t.pageX-pageXOffset),this.clientY=Math.abs(t.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(t.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(t.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),I.add(document,"mousemove touchmove",this.handlerMove,this),I.add(document,"mouseup touchend",this.handlerEnd,this)},e.prototype.handlerMove=function(t){t.type!=="touchmove"&&t.preventDefault();var i,r;t.type==="mousemove"?(i=Math.abs(t.pageX-pageXOffset),r=Math.abs(t.pageY-pageYOffset)):(i=Math.abs(t.changedTouches[0].pageX-pageXOffset),r=Math.abs(t.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,r);var n=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-r)>8)&&($("."+vp,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},e.prototype.setHsv=function(t,i){var r=$("."+vp,this.container),n=r.getBoundingClientRect();this.enableRtl?t=t>n.right?0:Math.abs(t-n.right):t=t>n.left?Math.abs(t-n.left):0,i=i>n.top?Math.abs(i-n.top):0,this.hsv[2]=Math.round(Number(100*(r.offsetHeight-Math.max(0,Math.min(r.offsetHeight,i-r.offsetTop)))/r.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(r.offsetWidth,t-r.offsetLeft))/r.offsetWidth)*10)/10},e.prototype.handlerEnd=function(t){t.type!=="touchend"&&t.preventDefault(),I.remove(document,"mousemove touchmove",this.handlerMove),I.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();$("."+vp,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(t)},e.prototype.btnClickHandler=function(t){var i=t.target;U(i,"."+Om)?(t.stopPropagation(),this.switchToPalette()):(i.classList.contains(pp)||i.classList.contains(Lm))&&this.ctrlBtnClick(i,t)},e.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),ne($(".e-slider-preview",this.container)),this.getWrapper().classList.contains(Ch)||pt($("."+Ku,this.container)),ne(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},e.prototype.refreshImageEditorPopupPos=function(){if(B.isDevice){var t=this.getPopupEle();t.style.left=qe(0+pageXOffset),t.style.top=qe(0+pageYOffset);var i=document.querySelector("#"+this.element.parentElement.parentElement.id.split("-popup")[0]);i&&t.parentElement.ej2_instances[0].refreshPosition(i)}},e.prototype.refreshPopupPos=function(){if(!this.inline){var t=this.getPopupEle();t.style.left=qe(0+pageXOffset),t.style.top=qe(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},e.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},e.prototype.updateValue=function(t,i,r,n){for(var a=["e-rh-value","e-gs-value","e-bv-value"],o,l=0,h=a.length;l<h;l++)o=Ln($("."+a[l],this.container),to),o.value=Math.round(t[l]),i&&(o.placeholder=a[l].substr(r,1).toUpperCase(),o.max=n?n[l]:255),o.dataBind()},e.prototype.previewHandler=function(t){var i=t.target,r=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),a=this.rgbToHsv.apply(this,this.rgb);a[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:a[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(a[0]),this.enableOpacity&&a[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:a[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=a,this.setHandlerPosition(),this.updateInput(n),$("."+Fm+" ."+ex,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,r,this.convertToRgbString(this.rgb))},e.prototype.paletteClickHandler=function(t){t.preventDefault();var i=t.target;if(i.classList.contains(jm)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(rx))this.noColorTile();else{var r=i.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(r)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Zu)&&this.updateInput(r),this.triggerEvent(r,n,this.convertToRgbString(this.rgb))}!this.inline&&!this.showButtons&&this.closePopup(t)}else U(i,"."+Om)?this.switchToPicker():i.classList.contains(pp)||i.classList.contains(Lm)?this.ctrlBtnClick(i,t):this.getWrapper().classList.contains(Zu)&&U(i,"."+gk)&&this.formatSwitchHandler()},e.prototype.noColorTile=function(t){t===void 0&&(t=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",t)},e.prototype.switchToPicker=function(){var t=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(ze("."+mp,this.container)).forEach(function(r){ne(r)}),t.classList.contains(Zu)&&ne($("."+Ku,this.container)),this.container.style.width="";var i=$(".e-custom-palette",this.container);this.presetColors&&pt(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},e.prototype.ctrlBtnClick=function(t,i){if(t.classList.contains(pp)){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}if(!this.inline)this.closePopup(i),this.splitBtn.element.focus();else if(t.classList.contains(Lm)){var n={element:this.container,event:i,cancel:!1};this.trigger("beforeClose",n)}},e.prototype.paletteKeyDown=function(t){var i=t.target;if(i.classList.contains(mp)){var r,n,a=[].slice.call(ze("."+jm,i)),o=a.filter(function(h){return h.classList.contains("e-selected")}).pop();switch(!t.altKey&&t.keyCode){case 39:t.preventDefault(),r=o?a[this.tilePosition(a,o,this.enableRtl?-1:1)]:a[this.enableRtl?a.length-1:0],this.keySelectionChanges(r);break;case 37:t.preventDefault(),r=o?a[this.tilePosition(a,o,this.enableRtl?1:-1)]:a[this.enableRtl?0:a.length-1],this.keySelectionChanges(r);break;case 38:t.preventDefault(),n=o?this.tilePosition(a,o,-this.columns):0,r=a[n]?a[n]:a[n-this.columns],this.keySelectionChanges(r);break;case 40:t.preventDefault(),n=o?this.tilePosition(a,o,this.columns):a.length-1,a[n]||(n%=a.length,n+=a[a.length-1].parentElement.childElementCount),r=a[n],this.keySelectionChanges(r);break;case 13:if(t.preventDefault(),o){var l=o.getAttribute("aria-label");this.enterKeyHandler(l||"",t)}}}},e.prototype.keySelectionChanges=function(t){if(this.removeTileSelection(),this.addTileSelection(t),t.classList.contains(rx))this.noColorTile(!0);else{var i=t.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Zu)&&this.updateInput(i),this.triggerEvent(i,r,this.convertToRgbString(this.rgb),!0)}},e.prototype.tilePosition=function(t,i,r){t=Array.prototype.slice.call(t);var n=t.length,a=this.columns-t[n-1].parentElement.childElementCount,o=t.indexOf(i);return o+=r,o<0?o+=n+a:o%=n+a,o},e.prototype.inputHandler=function(t){var i=t.target;if(i.value.length){var r,n,a=$(".e-float-text",i.parentElement).textContent;switch(a){case"HEX":{var o="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(o=this.roundValue(i.value)),o.length===9)n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(o+o.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,i.value);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"G":this.rgb[1]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"B":this.rgb[2]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(i.value);break}}},e.prototype.inputValueChange=function(t,i,r){t[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:t[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(t[0])),this.hsv=t;var n=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(r||n);var a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.triggerEvent(n,i,a)},e.prototype.triggerEvent=function(t,i,r,n){n===void 0&&(n=!1);var a=t.slice(0,7);!this.showButtons&&!n?(this.trigger("change",{currentValue:{hex:a,rgba:r},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:t}),this.enableOpacity?this.setProperties({value:t},!0):this.setProperties({value:a},!0),this.element.value=a||"#000000"):this.trigger("select",{currentValue:{hex:a,rgba:r},previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},e.prototype.destroy=function(){var t=this,i=this.getWrapper();s.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(r){t.element.removeAttribute(r)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&ne(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),ne(i)),this.container=null,this.formElement&&I.remove(this.formElement,"reset",this.formResetHandler)},e.prototype.destroyOtherComp=function(){if(this.isPicker()){for(var t=U(this.hueSlider.element,".e-color-picker"),i=t.querySelectorAll(".e-numerictextbox"),r=0;r<i.length;r++)Ln(i[r],to).destroy();this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var n=this.getTooltipInst();n.close(),n.destroy(),this.tooltipEle=null}},e.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},e.prototype.unWireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();I.remove(t,"keydown",this.pickerKeyDown);var i=$("."+fp,this.container);i&&I.remove(i,"keydown",this.ctrlBtnKeyDown),I.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&I.remove($("."+$u,this.container),"click",this.btnClickHandler),I.remove($("."+Pm,this.container),"click",this.previewHandler)}else I.remove(this.container,"click",this.paletteClickHandler),I.remove(this.container,"keydown",this.paletteKeyDown)},e.prototype.roundValue=function(t){if(!t)return"";t[0]!=="#"&&(t="#"+t);var i=t.length;if(i===4&&(t+="f",i=5),i===5){for(var r="",n=1,a=t.length;n<a;n++)r+=t.charAt(n)+t.charAt(n);t="#"+r,i=9}return i===7&&(t+="ff"),t},e.prototype.hexToRgb=function(t){if(!t)return[];t=t.trim(),t.length!==9&&(t=this.roundValue(t));var i=Number((parseInt(t.slice(-2),16)/255).toFixed(2));t=t.slice(1,7);var r=parseInt(t,16),n=[];return n.push(r>>16&255),n.push(r>>8&255),n.push(r&255),n.push(i),n},e.prototype.rgbToHsv=function(t,i,r,n){if(this.rgb&&!this.rgb.length)return[];t/=255,i/=255,r/=255;var a=Math.max(t,i,r),o=Math.min(t,i,r),l,h=a,u=a-o,c=a===0?0:u/a;if(a===o)l=0;else{switch(a){case t:l=(i-r)/u+(i<r?6:0);break;case i:l=(r-t)/u+2;break;case r:l=(t-i)/u+4;break}l/=6}var d=[Math.round(l*360),Math.round(c*1e3)/10,Math.round(h*1e3)/10];return m(n)||d.push(n),d},e.prototype.hsvToRgb=function(t,i,r,n){var a,o,l;if(i/=100,r/=100,i===0)return a=o=l=r,[Math.round(a*255),Math.round(o*255),Math.round(l*255),n];t/=60;var h=Math.floor(t),u=t-h,c=r*(1-i),d=r*(1-i*u),p=r*(1-i*(1-u));switch(h){case 0:a=r,o=p,l=c;break;case 1:a=d,o=r,l=c;break;case 2:a=c,o=r,l=p;break;case 3:a=c,o=d,l=r;break;case 4:a=p,o=c,l=r;break;default:a=r,o=c,l=d}var f=[Math.round(a*255),Math.round(o*255),Math.round(l*255)];return m(n)||f.push(n),f},e.prototype.rgbToHex=function(t){return t.length?"#"+this.hex(t[0])+this.hex(t[1])+this.hex(t[2])+(m(t[3])?"":t[3]!==0?(Math.round(t[3]*255)+65536).toString(16).substr(-2):"00"):""},e.prototype.hex=function(t){return("0"+t.toString(16)).slice(-2)},e.prototype.changeModeSwitcherProp=function(t){var i=$("."+$u,this.container);t?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?ne($("."+Om,i)):pt(i))},e.prototype.changeShowBtnProps=function(t){var i=$("."+$u,this.container);t?(i&&pt(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?ne($("."+fp,i)):pt(i)},e.prototype.changeValueProp=function(t){if(this.isPicker())this.rgb=this.hexToRgb(t),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),ne(U(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(t),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(t)+'"]');i&&this.addTileSelection(i)}},e.prototype.setInputEleProps=function(){pt($("."+Ku,this.container)),this.createInput()},e.prototype.changeDisabledProp=function(t){this.isPicker()&&(this.hueSlider.enabled=!t,this.opacitySlider.enabled=!t,this.setInputEleProps()),t?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},e.prototype.changeCssClassProps=function(t,i){var r=this.getWrapper(),n=this.getPopupEle();i&&te([r,n],i.split(" ")),t&&Q([r,n],t.replace(/\s+/g," ").trim().split(" "))},e.prototype.changeRtlProps=function(t){t?Q([this.getWrapper()],"e-rtl"):te([this.getWrapper()],"e-rtl")},e.prototype.changePaletteProps=function(){ne(this.container.children[0]),this.container.style.width="",this.createPalette()},e.prototype.changeOpacityProps=function(t){var i=this.getWrapper();t?(te([this.container.parentElement],ix),this.createOpacitySlider($(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(Ch)&&!i.classList.contains(Xu)&&this.appendOpacityValue($(".e-input-container",this.container))):(Q([this.container.parentElement],ix),this.opacitySlider.destroy(),pt(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(Ch)&&!i.classList.contains(Xu)&&pt($("."+nx,this.container).parentElement))},e.prototype.onPropertyChanged=function(t,i){var r=this;if(!m(t.value)){var n=this.roundValue(t.value);if(n.length===9){this.element.value=this.roundValue(n).slice(0,7);var a=this.splitBtn&&$("."+zm,this.splitBtn.element);a&&(a.style.backgroundColor=this.convertToRgbString(this.hexToRgb(t.value)))}else if(this.noColor&&this.mode==="Palette"&&this.value===""){var a=this.splitBtn&&$("."+zm,this.splitBtn.element);a.style.backgroundColor=""}else this.value=i.value}if(!this.inline&&m(t.inline)){var o=["disabled","enableRtl"];if(this.splitBtn.setProperties(lv(t,o)),!this.isPopupOpen()){this.changeCssClassProps(t.cssClass,i.cssClass),this.changeRtlProps(t.enableRtl);return}}for(var l=function(p){switch(p){case"inline":t.inline?(h.getWrapper().appendChild(h.container),h.splitBtn.destroy(),ne(h.element.nextElementSibling),h.container.children.length||h.createWidget()):(h.destroyOtherComp(),h.unWireEvents(),h.container.innerHTML="",h.createSplitBtn());break;case"cssClass":{h.changeCssClassProps(t.cssClass,i.cssClass);var f=t.cssClass.split(" ").concat(i.cssClass.split(" "));f=f.reduce(function(g,b){return g.indexOf(b)<0&&g.push(b),g},[]);var v=0;f.forEach(function(g){if(v===0&&(g===Ch||g===Ck||g===Zu||g===tx||g===Xu)){var b=$("."+Ku,r.container);b&&pt($("."+Ku,r.container)),r.createInput(),v++}});break}case"enableRtl":h.isPicker()&&(h.hueSlider.enableRtl=t.enableRtl,h.enableOpacity&&(h.opacitySlider.enableRtl=t.enableRtl),h.setInputEleProps()),h.changeRtlProps(t.enableRtl);break;case"disabled":h.changeDisabledProp(t.disabled);break;case"value":h.value!==i.value&&h.changeValueProp(t.value);break;case"showButtons":h.changeShowBtnProps(t.showButtons);break;case"mode":t.mode==="Picker"?h.switchToPicker():h.switchToPalette();break;case"modeSwitcher":h.changeModeSwitcherProp(t.modeSwitcher);break;case"columns":case"presetColors":h.isPicker()||h.changePaletteProps();break;case"noColor":t.noColor?h.mode==="Palette"&&!h.modeSwitcher&&h.setNoColor():h.changePaletteProps();break;case"enableOpacity":h.changeOpacityProps(t.enableOpacity);break}},h=this,u=0,c=Object.keys(t);u<c.length;u++){var d=c[u];l(d)}},e.prototype.focusIn=function(){this.element.parentElement.focus()},sr([S("#008000ff")],e.prototype,"value",void 0),sr([S("")],e.prototype,"cssClass",void 0),sr([S(!1)],e.prototype,"disabled",void 0),sr([S("Picker")],e.prototype,"mode",void 0),sr([S(!0)],e.prototype,"modeSwitcher",void 0),sr([S(null)],e.prototype,"presetColors",void 0),sr([S(!0)],e.prototype,"showButtons",void 0),sr([S(10)],e.prototype,"columns",void 0),sr([S(!1)],e.prototype,"inline",void 0),sr([S(!1)],e.prototype,"noColor",void 0),sr([S(!1)],e.prototype,"enablePersistence",void 0),sr([S(!0)],e.prototype,"enableOpacity",void 0),sr([S(!1)],e.prototype,"createPopupOnClick",void 0),sr([_()],e.prototype,"select",void 0),sr([_()],e.prototype,"change",void 0),sr([_()],e.prototype,"beforeTileRender",void 0),sr([_()],e.prototype,"beforeOpen",void 0),sr([_()],e.prototype,"open",void 0),sr([_()],e.prototype,"beforeClose",void 0),sr([_()],e.prototype,"beforeModeSwitch",void 0),sr([_()],e.prototype,"onModeSwitch",void 0),sr([_()],e.prototype,"created",void 0),e=sr([Ot],e),e}(Pi),Gq=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ir=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},$q="e-clear-icon-hide",xk="e-input-focus",ax=["title","style","class"],ox=function(s){Gq(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.previousValue=null,r.isAngular=!1,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.isVue=!1,r.textboxOptions=t,r}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"floatLabelType":ye.removeFloating(this.textboxWrapper),ye.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":ye.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":ye.setWidth(t.width,this.textboxWrapper.container);break;case"value":{var o=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=o,ye.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(m(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&m(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkAttributes(!0),this.multiline&&!m(this.textarea)?ye.validateInputType(this.textboxWrapper.container,this.textarea):ye.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":ye.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),ye.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":ye.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":ye.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":ye.setPlaceholder(this.placeholder,this.respectiveElement),ye.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"locale":this.globalize=new _t(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ye.setPlaceholder(this.placeholder,this.respectiveElement);break}}},e.prototype.getModuleName=function(){return"textbox"},e.prototype.isBlank=function(t){return!t||/^\s*$/.test(t)},e.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=U(this.element,"form"),m(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var t=ie("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(n,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,n==="name"&&this.element.removeAttribute("name")):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,kt("ej2_instances",t,this.element)}this.updateHTMLAttrToElement(),this.checkAttributes(!1),(m(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),this.type==="text"&&this.element.setAttribute("role","textbox"),this.globalize=new _t(this.locale);var a={placeholder:this.placeholder};if(this.l10n=new In("textbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",mi("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",mi("textarea"));for(var o=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;this.element.hasAttribute(n)&&ax.indexOf(n)<0&&!(n==="id"||n==="type"||n==="e-mappinguid")&&(this.textarea.setAttribute(n,this.element.attributes[r].nodeValue),o.indexOf(n)<0&&(this.element.removeAttribute(n),r--))}}},e.prototype.checkAttributes=function(t){for(var i=t?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,n=i;r<n.length;r++){var a=n[r];if(!m(this.element.getAttribute(a)))switch(a){case"disabled":if(m(this.textboxOptions)||this.textboxOptions.enabled===void 0||t){var o=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:o},!t)}break;case"readonly":if(m(this.textboxOptions)||this.textboxOptions.readonly===void 0||t){var l=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(m(this.textboxOptions)||this.textboxOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.element.placeholder},!t);break;case"autocomplete":if(m(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||t){var h=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:h},!t)}break;case"value":(m(this.textboxOptions)||this.textboxOptions.value===void 0||t)&&this.element.value!==""&&this.setProperties({value:this.element.value},!t);break;case"type":(m(this.textboxOptions)||this.textboxOptions.type===void 0||t)&&this.setProperties({type:this.element.type},!t);break}}},e.prototype.render=function(){var t=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(t=this.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=ye.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:t,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttrToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),m(this.value)||(ye.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),m(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!m(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,ye.setWidth(this.width,this.textboxWrapper.container),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete()},e.prototype.updateHTMLAttrToWrapper=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(ax.indexOf(r)>-1)if(r==="class"){var n=this.getInputValidClassList(this.htmlAttributes[""+r]);n!==""&&Q([this.textboxWrapper.container],n.split(" "))}else if(r==="style"){var a=this.textboxWrapper.container.getAttribute(r);a=m(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.textboxWrapper.container.setAttribute(r,a)}else this.textboxWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateHTMLAttrToElement=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];ax.indexOf(r)<0&&(this.multiline&&!m(this.textarea)?this.textarea.setAttribute(r,this.htmlAttributes[""+r]):this.element.setAttribute(r,this.htmlAttributes[""+r]))}},e.prototype.updateCssClass=function(t,i){ye.setCssClass(this.getInputValidClassList(t),[this.textboxWrapper.container],this.getInputValidClassList(i))},e.prototype.getInputValidClassList=function(t){var i=t;return!m(t)&&t!==""&&(i=t.replace(/\s+/g," ").trim()),i},e.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},e.prototype.wireEvents=function(){I.add(this.respectiveElement,"focus",this.focusHandler,this),I.add(this.respectiveElement,"blur",this.focusOutHandler,this),I.add(this.respectiveElement,"keydown",this.keydownHandler,this),I.add(this.respectiveElement,"input",this.inputHandler,this),I.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&I.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!m(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&I.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},e.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var t=this.textboxWrapper.container.querySelector(".e-float-text");m(t)||(t.classList.add("e-label-top"),t.classList.contains("e-label-bottom")&&t.classList.remove("e-label-bottom"))},e.prototype.resetValue=function(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=t,t==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},e.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!m(this.textboxWrapper)){var t=this.textboxWrapper.container.querySelector(".e-float-text");!m(t)&&this.floatLabelType!=="Always"&&(m(this.initialValue)||this.initialValue===""?(t.classList.add("e-label-bottom"),t.classList.remove("e-label-top")):this.initialValue!==""&&(t.classList.add("e-label-top"),t.classList.remove("e-label-bottom")))}},e.prototype.focusHandler=function(t){var i={container:this.textboxWrapper.container,event:t,value:this.value};this.trigger("focus",i)},e.prototype.focusOutHandler=function(t){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(t,!0);var i={container:this.textboxWrapper.container,event:t,value:this.value};this.trigger("blur",i)},e.prototype.keydownHandler=function(t){(t.keyCode===13||t.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},e.prototype.inputHandler=function(t){var i=this,r={event:t,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),t.stopPropagation()},e.prototype.changeHandler=function(t){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!=this.value&&this.raiseChangeEvent(t,!0),t.stopPropagation()},e.prototype.raiseChangeEvent=function(t,i){var r={event:t,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&B.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},e.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?I.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):I.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},e.prototype.resetInputHandler=function(t){if(t.preventDefault(),!this.textboxWrapper.clearButton.classList.contains($q)||this.textboxWrapper.container.classList.contains("e-static-clear")){ye.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:t,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(t,!0),U(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}}},e.prototype.unWireEvents=function(){I.remove(this.respectiveElement,"focus",this.focusHandler),I.remove(this.respectiveElement,"blur",this.focusOutHandler),I.remove(this.respectiveElement,"keydown",this.keydownHandler),I.remove(this.respectiveElement,"input",this.inputHandler),I.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&I.remove(this.formElement,"reset",this.resetForm),!m(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&I.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},e.prototype.destroy=function(){this.unWireEvents(),this.element.tagName==="INPUT"&&this.multiline&&(ne(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),m(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),ne(this.textboxWrapper.container)),this.textboxWrapper=null,ye.destroy(),s.prototype.destroy.call(this)},e.prototype.addIcon=function(t,i){ye.addIcon(t,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.addAttributes=function(t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!1},!0),ye.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!0},!0),ye.setReadonly(this.readonly,this.respectiveElement)):n==="class"?this.respectiveElement.classList.add(t[""+n]):n==="placeholder"?(this.setProperties({placeholder:t[""+n]},!0),ye.setPlaceholder(this.placeholder,this.respectiveElement)):n==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(n,t[""+n]):this.respectiveElement.setAttribute(n,t[""+n])}},e.prototype.removeAttributes=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!0},!0),ye.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!1},!0),ye.setReadonly(this.readonly,this.respectiveElement)):n==="placeholder"?(this.setProperties({placeholder:null},!0),ye.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(n)}},e.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&Q([this.textboxWrapper.container],[xk]))},e.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&te([this.textboxWrapper.container],[xk]))},Ir([S("text")],e.prototype,"type",void 0),Ir([S(!1)],e.prototype,"readonly",void 0),Ir([S(null)],e.prototype,"value",void 0),Ir([S("Never")],e.prototype,"floatLabelType",void 0),Ir([S("")],e.prototype,"cssClass",void 0),Ir([S(null)],e.prototype,"placeholder",void 0),Ir([S("on")],e.prototype,"autocomplete",void 0),Ir([S({})],e.prototype,"htmlAttributes",void 0),Ir([S(!1)],e.prototype,"multiline",void 0),Ir([S(!0)],e.prototype,"enabled",void 0),Ir([S(!1)],e.prototype,"showClearButton",void 0),Ir([S(!1)],e.prototype,"enablePersistence",void 0),Ir([S(null)],e.prototype,"width",void 0),Ir([_()],e.prototype,"created",void 0),Ir([_()],e.prototype,"destroyed",void 0),Ir([_()],e.prototype,"change",void 0),Ir([_()],e.prototype,"blur",void 0),Ir([_()],e.prototype,"focus",void 0),Ir([_()],e.prototype,"input",void 0),e=Ir([Ot],e),e}(Pi),Db=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),et=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Bs="e-treeview",wk="e-control",Tr="e-icon-collapsible",ui="e-icon-expandable",mt="e-list-item",Sh="e-list-text",Xq="e-text-wrap",Kq="e-ie-wrap",qt="e-list-parent",Bm="e-hover",is="e-active",lx="e-icons-spinner",wo="e-process",Ui="e-icons",Dr="e-text-content",Hm="e-input",Mk="e-input-group",Vm="e-tree-input",hx="e-editing",Ek="e-rtl",Ik="e-interaction",Zq="e-drag-item",Tk="e-droppable",ux="e-dragging",yp="e-sibling",Um="e-drop-in",bp="e-drop-next",cx="e-drop-out",dx="e-no-drop",Jq="e-fullrow-wrap",Mo="e-fullrow",Ju="e-selected",_m="e-expanded",Dk="e-node-collapsed",Ak="e-disable",eY="e-drop-count",un="e-check",Hs="e-stop",ms="e-checkbox-wrapper",Eo="e-frame",tY="e-ripple-container",Nk="e-ripple",iY="e-ripple-element",xh="e-node-focus",kk="e-list-img",rY="e-bigger",nY="e-small",sY="e-has-child",Wm="e-animation-active",Lk="e-disabled",ec="e-prevent",Ok={treeRole:"group",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},aY=function(s){Db(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return et([S("child")],e.prototype,"child",void 0),et([S([])],e.prototype,"dataSource",void 0),et([S("expanded")],e.prototype,"expanded",void 0),et([S("hasChildren")],e.prototype,"hasChildren",void 0),et([S("htmlAttributes")],e.prototype,"htmlAttributes",void 0),et([S("iconCss")],e.prototype,"iconCss",void 0),et([S("id")],e.prototype,"id",void 0),et([S("imageUrl")],e.prototype,"imageUrl",void 0),et([S("isChecked")],e.prototype,"isChecked",void 0),et([S("parentID")],e.prototype,"parentID",void 0),et([S(null)],e.prototype,"query",void 0),et([S("selectable")],e.prototype,"selectable",void 0),et([S("selected")],e.prototype,"selected",void 0),et([S(null)],e.prototype,"tableName",void 0),et([S("text")],e.prototype,"text",void 0),et([S("tooltip")],e.prototype,"tooltip",void 0),et([S("navigateUrl")],e.prototype,"navigateUrl",void 0),e}(ke),Rk=function(s){Db(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return et([S("SlideDown")],e.prototype,"effect",void 0),et([S(400)],e.prototype,"duration",void 0),et([S("linear")],e.prototype,"easing",void 0),e}(ke),oY=function(s){Db(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return et([Ee({effect:"SlideUp",duration:400,easing:"linear"},Rk)],e.prototype,"collapse",void 0),et([Ee({effect:"SlideDown",duration:400,easing:"linear"},Rk)],e.prototype,"expand",void 0),e}(ke),Yz=function(s){Db(e,s);function e(i,r){var n=s.call(this,i,r)||this;return n.isRefreshed=!1,n.preventExpand=!1,n.checkedElement=[],n.disableNode=[],n.validArr=[],n.validNodes=[],n.expandChildren=[],n.isFieldChange=!1,n.changeDataSource=!1,n.hasTemplate=!1,n.isFirstRender=!1,n.isNodeDropped=!1,n.isInteracted=!1,n.isRightClick=!1,n.mouseDownStatus=!1,n}t=e,e.prototype.getModuleName=function(){return"treeview"},e.prototype.preRender=function(){var i=this;this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space",shiftSpace:"shift+space",ctrlSpace:"ctrl+space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:ui,ariaAttributes:Ok,expandIconPosition:"Left",itemCreated:function(r){i.beforeNodeCreate(r)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new ri({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),m(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),m(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),m(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},e.prototype.getPersistData=function(){var i=["selectedNodes","checkedNodes","expandedNodes"];return this.addOnPersist(i)},e.prototype.render=function(){this.initialRender=!0,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.initialRender=!1,this.renderComplete()},e.prototype.initialize=function(){this.element.setAttribute("role","tree"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.setTextWrap(),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},e.prototype.setDisabledMode=function(){this.disabled?(this.element.classList.add(Lk),this.element.setAttribute("aria-disabled","true")):(this.element.classList.remove(Lk),this.element.setAttribute("aria-disabled","false"))},e.prototype.setEnableRtl=function(){(this.enableRtl?Q:te)([this.element],Ek)},e.prototype.setRipple=function(){var i="."+Mo+",."+Dr,r={selector:i,ignore:"."+Dr+" > ."+Ui+",."+Mk+",."+Hm+", ."+ms};this.rippleFn=yr(this.element,r);var n={selector:"."+Dr+" > ."+Ui,isCenterRipple:!0};this.rippleIconFn=yr(this.element,n)},e.prototype.setFullRow=function(i){(i?Q:te)([this.element],Jq)},e.prototype.setMultiSelect=function(i){i?this.element.setAttribute("aria-multiselectable","true"):this.element.setAttribute("aria-multiselectable","false")},e.prototype.templateComplier=function(i){if(i){this.hasTemplate=!0,this.element.classList.add(Ik);try{return typeof i!="function"&&document.querySelectorAll(i).length?pi(document.querySelector(i).innerHTML.trim()):pi(i)}catch{return pi(i)}}this.element.classList.remove(Ik)},e.prototype.setDataBinding=function(i){var r=this;this.treeList.push("false"),this.fields.dataSource instanceof ge?(this.isOffline=this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then(function(n){r.isOffline=r.fields.dataSource.dataSource.offline,r.fields.dataSource instanceof ge&&r.isOffline&&(r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),r.renderItems(!0),r.treeList.length===0&&!r.isLoaded&&r.finalize())}).catch(function(n){r.trigger("actionFailure",{error:n})}):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(n){r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),i&&(r.changeDataSource=!0),r.renderItems(!0),r.changeDataSource=!1,r.treeList.length===0&&!r.isLoaded&&r.finalize()}).catch(function(n){r.trigger("actionFailure",{error:n})})):(this.treeList.pop(),m(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),this.treeList.length===0&&!this.isLoaded&&this.finalize()},e.prototype.getQuery=function(i,r){r===void 0&&(r=null);var n=[],a;if(i.query)a=i.query.clone();else{a=new $e;for(var o=this.getActualProperties(i),l=0,h=Object.keys(o);l<h.length;l++){var u=h[l];u!=="dataSource"&&u!=="tableName"&&u!=="child"&&i[u]&&u!=="url"&&n.indexOf(i[u])===-1&&n.push(i[u])}a.select(n),o.hasOwnProperty("tableName")&&a.from(i.tableName)}return Et.addSorting(this.sortOrder,i.text,a),!m(r)&&!m(i.parentID)&&a.where(i.parentID,"equal",this.isNumberTypeId?parseFloat(r):r),a},e.prototype.getType=function(){return this.treeData[0]?typeof ie(this.fields.id,this.treeData[0])=="number":!1},e.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),this.dataType===1){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var i=this.getChildNodes(this.treeData,void 0,!0);m(i)?this.rootData=[]:this.rootData=i}else this.rootData=this.treeData},e.prototype.isChildObject=function(){return typeof this.fields.child=="object"},e.prototype.renderItems=function(i){this.listBaseOption.ariaAttributes.level=1;var r=this.getSortedData(this.rootData);this.ulElement=Et.createList(this.createElement,i?this.rootData:r,this.listBaseOption),this.element.appendChild(this.ulElement);var n=this.ulElement.querySelectorAll(".e-list-item");if(this.loadOnDemand===!1)for(var a=0;a<n.length;)this.renderChildNodes(n[a],!0,null,!0),a++;var o=ze("."+qt,this.element);(o.length===1&&n&&n.length!==0||this.loadOnDemand)&&this.finalizeNode(this.element),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},e.prototype.updateCheckedStateFromDS=function(i){if(this.validNodes=[],this.treeData&&this.showCheckBox){if(this.dataType===1){for(var r=this.fields,n=new ge(this.treeData).executeLocal(new $e().where(r.isChecked,"equal",!0,!1)),a=0;a<n.length;a++){var o=n[a][this.fields.id]?n[a][this.fields.id].toString():null;if(n[a][this.fields.parentID]&&n[a][this.fields.parentID].toString(),this.checkedNodes.indexOf(o)===-1&&!this.isLoaded&&this.checkedNodes.push(o),n[a][this.fields.hasChildren])for(var l=n[a][this.fields.id],h=new ge(this.treeData).executeLocal(new $e().where(r.parentID,"equal",l,!1)),u=0;u<h.length;u++){var c=h[u][this.fields.id]?h[u][this.fields.id].toString():null;this.checkedNodes.indexOf(c)===-1&&this.autoCheck&&this.checkedNodes.push(c)}}for(var a=0;a<this.checkedNodes.length;a++){var d=this.fields,p=new ge(this.treeData).executeLocal(new $e().where(d.id,"equal",this.checkedNodes[a],!0));if(p[0]&&this.autoCheck&&(this.getCheckedNodeDetails(d,p),this.checkIndeterminateState(p[0])),p.length>0){var f=p[0][this.fields.id]?p[0][this.fields.id].toString():null;this.checkedNodes.indexOf(f)>-1&&this.validNodes.indexOf(f)===-1&&this.validNodes.push(f)}for(var v=new ge(this.treeData).executeLocal(new $e().where(d.parentID,"equal",this.checkedNodes[a],!0)),g=0;g<v.length;g++){var f=v[g][this.fields.id]?v[g][this.fields.id].toString():null;this.checkedNodes.indexOf(f)===-1&&this.autoCheck&&this.checkedNodes.push(f),this.checkedNodes.indexOf(f)>-1&&this.validNodes.indexOf(f)===-1&&this.validNodes.push(f)}}}else if(this.dataType===2||this.fields.dataSource instanceof ge&&this.isOffline){for(var g=0;g<this.treeData.length;g++){var b=this.treeData[g][this.fields.id]?this.treeData[g][this.fields.id].toString():"";this.treeData[g][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(b)===-1&&this.checkedNodes.push(b),this.checkedNodes.indexOf(b)>-1&&this.validNodes.indexOf(b)===-1&&this.validNodes.push(b);var y=ie(this.fields.child.toString(),this.treeData[g]);y&&this.updateChildCheckState(y,this.treeData[g])}this.validNodes=this.enablePersistence?this.checkedNodes:this.validNodes}this.setProperties({checkedNodes:this.validNodes},!0)}},e.prototype.getCheckedNodeDetails=function(i,r){var n=r[0][this.fields.parentID]?r[0][this.fields.parentID].toString():null,a=0,o=this.element.querySelector('[data-uid="'+r[0][this.fields.id]+'"]'),l=this.element.querySelector('[data-uid="'+r[0][this.fields.parentID]+'"]');if(!o&&!l){this.parentNodeCheck.length,this.parentNodeCheck.indexOf(n)===-1&&this.parentNodeCheck.push(n);for(var h=this.getChildNodes(this.treeData,n),u=0;u<h.length;u++){var c=h[u][this.fields.id]?h[u][this.fields.id].toString():null;this.checkedNodes.indexOf(c)!==-1&&a++,a===h.length&&this.checkedNodes.indexOf(n)===-1&&this.checkedNodes.push(n)}var d=new ge(this.treeData).executeLocal(new $e().where(i.id,"equal",n,!0));this.getCheckedNodeDetails(i,d)}else if(l){var p=$("."+un,l);p||this.changeState(l,"indeterminate",null,!0,!0)}},e.prototype.updateParentCheckState=function(){for(var i=ze("."+Hs,this.element),r,n=0;n<i.length;n++){var a=U(i[n],"."+mt),o=a.getAttribute("data-uid").toString();this.dataType===1?r=new ge(this.treeData).executeLocal(new $e().where(this.fields.parentID,"equal",o,!0)):r=this.getChildNodes(this.treeData,o);var l=0;if(r){for(var h=0;h<r.length;h++){var u=r[h][this.fields.id].toString();this.checkedNodes.indexOf(u)!==-1&&l++}if(l===r.length){var c=a.getAttribute("data-uid");this.checkedNodes.indexOf(c)===-1&&this.checkedNodes.push(c),this.changeState(a,"check",null,!0,!0)}else l===0&&this.checkedNodes.length===0&&this.changeState(a,"uncheck",null,!0,!0)}}},e.prototype.checkIndeterminateState=function(i){var r;if(this.dataType===1?r=this.element.querySelector('[data-uid="'+i[this.fields.parentID]+'"]'):r=this.element.querySelector('[data-uid="'+i[this.fields.id]+'"]'),r){var n=r.querySelector("."+ms).getAttribute("aria-checked");n!=="true"&&this.changeState(r,"indeterminate",null,!0,!0)}else this.dataType===2&&(this.parentNodeCheck.length,this.parentNodeCheck.indexOf(i[this.fields.id].toString())===-1&&this.parentNodeCheck.push(i[this.fields.id].toString()))},e.prototype.updateChildCheckState=function(i,r){for(var n=0,a=r[this.fields.id]?r[this.fields.id].toString():"",o=0;o<i.length;o++){var l=i[o][this.fields.id]?i[o][this.fields.id].toString():"";i[o][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(l)===-1&&this.checkedNodes.push(l),this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(l)===-1&&this.autoCheck&&this.checkedNodes.push(l),this.checkedNodes.indexOf(l)!==-1&&this.autoCheck&&n++,this.checkedNodes.indexOf(l)>-1&&this.validNodes.indexOf(l)===-1&&this.validNodes.push(l);var h=ie(this.fields.child.toString(),i[o]);h&&h.length&&(this.parentCheckData.indexOf(r)===-1&&this.parentCheckData.push(r),this.updateChildCheckState(h,i[o])),n===i.length&&this.autoCheck&&this.checkedNodes.indexOf(a)===-1&&this.checkedNodes.push(a)}if(n!==0&&this.autoCheck){this.checkIndeterminateState(r);for(var u=0;u<this.parentCheckData.length;u++)r!==this.parentCheckData[u]&&this.parentCheckData[u]&&this.checkIndeterminateState(this.parentCheckData[u])}this.parentCheckData=[]},e.prototype.beforeNodeCreate=function(i){if(this.showCheckBox){var r=M0(this.createElement,!0,{cssClass:this.touchClass});r.setAttribute("role","checkbox"),r.setAttribute("aria-label",i.text);var n=$("div."+Ui,i.item),a=i.item.getAttribute("data-uid");i.item.childNodes[0].insertBefore(r,i.item.childNodes[0].childNodes[m(n)?0:1]);var o=ie(i.fields.isChecked,i.curData);this.checkedNodes.indexOf(a)>-1?($("."+Eo,r).classList.add(un),r.setAttribute("aria-checked","true"),this.addCheck(i.item)):!m(o)&&o.toString()==="true"?($("."+Eo,r).classList.add(un),r.setAttribute("aria-checked","true"),this.addCheck(i.item)):r.setAttribute("aria-checked","false");var l=$("."+Eo,r);I.add(l,"mousedown",this.frameMouseHandler,this),I.add(l,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(i.item),this.allowMultiSelection&&!i.item.classList.contains(Ju)&&i.item.setAttribute("aria-selected","false");var h=i.fields;if(this.addActionClass(i,h.selected,Ju),this.addActionClass(i,h.expanded,_m),i.item.setAttribute("tabindex","-1"),I.add(i.item,"focus",this.focusIn,this),!m(this.nodeTemplateFn)){var u=i.item.querySelector("."+Sh),c=i.item.getAttribute("data-uid");u.innerHTML="",this.renderNodeTemplate(i.curData,u,c)}var d={node:i.item,nodeData:i.curData,text:i.text};this.isRefreshed||(this.trigger("drawNode",d),i.curData[this.fields.selectable]===!1&&!this.showCheckBox&&(i.item.classList.add(ec),i.item.firstElementChild.setAttribute("style","cursor: not-allowed")))},e.prototype.frameMouseHandler=function(i){var r=$("."+tY,i.target.parentElement);$h(i,r)},e.prototype.addActionClass=function(i,r,n){var a=i.curData,o=ie(r,a);!m(o)&&o.toString()!=="false"&&i.item.classList.add(n)},e.prototype.getDataType=function(i,r){if(this.fields.dataSource instanceof ge){for(var n=0;n<i.length;n++)if(this.isOffline){if(typeof r.child=="string"&&m(ie(r.child,i[n]))&&!m(ie(r.parentID,i[n])))return 1}else if(typeof r.child=="string"&&m(ie(r.child,i[n])))return 1;return 2}for(var n=0,a=i.length;n<a;n++){if(typeof r.child=="string"&&!m(ie(r.child,i[n]))||this.isChildObject())return 2;if(!m(ie(r.parentID,i[n]))||!m(ie(r.hasChildren,i[n])))return 1}return 1},e.prototype.getGroupedData=function(i,r){for(var n=new $e().group(r),a=Et.getDataSource(i,n),o=[],l=0;l<a.length;l++){var h=a[l].items;o.push(h)}return o},e.prototype.getSortedData=function(i){return i&&this.sortOrder!=="None"&&(i=Et.getDataSource(i,Et.addSorting(this.sortOrder,this.fields.text))),i},e.prototype.finalizeNode=function(i){for(var r=this,n=ze("."+kk,i),a=0;a<n.length;a++)n[a].setAttribute("alt",kk);if(this.isLoaded){for(var o=ze("."+Ju,i),l=0;l<o.length;l++){this.selectNode(o[l],null);break}te(o,Ju)}for(var h=ze("."+mt+":not(."+_m+")",i),u=0;u<h.length;u++){var c=$("div."+Ui,h[u]);c&&c.classList.contains(ui)&&this.disableExpandAttr(h[u])}var d=ze("."+_m,i);if(!this.loadOnDemand&&this.fields.dataSource instanceof ge&&(this.isInitalExpand=this.treeData.filter(function(p){return p[r.fields.expanded]==!0}).length>0?!0:this.isInitalExpand),!this.isInitalExpand)for(var l=0;l<d.length;l++)this.renderChildNodes(d[l]);te(d,_m),this.updateList(),this.isLoaded&&this.updateCheckedProp()},e.prototype.updateCheckedProp=function(){if(this.showCheckBox){var i=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:i},!0)}},e.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var i=ze("li",this.element),r=void 0,n=0;n<i.length;n++)i[n].classList.contains(mt)&&(r=$("."+qt,i[n]),r?this.ensureParentCheckState(i[n]):this.ensureChildCheckState(i[n]));else for(var a=ze("."+Hs,this.element),n=0;n<a.length;n++)a[n].classList.remove(Hs)},e.prototype.ensureParentCheckState=function(i){if(!m(i)){if(i.classList.contains(Bs))return;var r=i;i.classList.contains(mt)&&(r=$("."+qt,i));var n=ze("."+un,r),a=ze("."+Hs,r),o=ze("."+mt,r),l=i.getElementsByClassName(ms)[0];o.length===n.length?this.changeState(l,"check",null,!0,!0):n.length>0||a.length>0?this.changeState(l,"indeterminate",null,!0,!0):n.length===0&&this.changeState(l,"uncheck",null,!0,!0);var h=U(i,"."+qt);if(!m(h)){var u=U(h,"."+mt);this.ensureParentCheckState(u)}}},e.prototype.ensureChildCheckState=function(i,r){if(!m(i)){var n=$("."+qt,i),a=void 0;if(!m(n)){a=ze("."+ms,n);var o=i.getElementsByClassName(Eo)[0].classList.contains(un),l=i.getElementsByClassName(Eo)[0].classList.contains(Hs),h=n.querySelectorAll("li");n.parentElement.getAttribute("aria-expanded");for(var u=void 0,c=0;c<a.length;c++){var d=h[c].getAttribute("data-uid");if(!m(this.currentLoadData)&&!m(ie(this.fields.isChecked,this.currentLoadData[c])))u=ie(this.fields.isChecked,this.currentLoadData[c])?"check":"uncheck",this.ele!==-1&&(u=o?"check":"uncheck"),u==="uncheck"&&!Re(this.parentNodeCheck)&&this.autoCheck&&this.parentNodeCheck.indexOf(d)!==-1&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1),u="indeterminate");else{var p=a[c].getElementsByClassName(Eo)[0].classList.contains(un);o||p&&!this.isLoaded||this.checkedNodes.indexOf(d)!==-1&&this.isLoaded&&(l||o)?u="check":h[c].classList.contains(sY)&&!Re(this.parentNodeCheck)&&this.autoCheck&&(o||l)&&this.parentNodeCheck.indexOf(d)!==-1?(u="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)):this.dataType===1&&!Re(this.parentNodeCheck)&&this.autoCheck&&(o||l)&&this.parentNodeCheck.indexOf(d)!==-1?(u="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)):u="uncheck"}this.changeState(a[c],u,r,!0,!0)}}this.autoCheck&&this.isLoaded&&this.updateParentCheckState()}},e.prototype.doCheckBoxAction=function(i,r){if(ze("."+mt,this.element),m(i)){var p=ze("."+ms,this.element);if(this.loadOnDemand)for(var f=0;f<p.length;f++)this.updateFieldChecked(p[f],r),this.changeState(p[f],r?"check":"uncheck",null,null,null,r);else for(var f=0;f<p.length;f++)this.updateFieldChecked(p[f],r),this.changeState(p[f],r?"check":"uncheck")}else for(var n=i.length-1;n>=0;n--){var a=this.getElement(i[n]);if(m(a)){var o=void 0;if(o=i[n-(i.length-1)]?i[n-(i.length-1)].toString():i[n]?i[n].toString():null,o!==""&&r&&o)this.setValidCheckedNode(o),this.dynamicCheckState(o,r);else if(this.checkedNodes.indexOf(o)!==-1&&o!==""&&!r){this.checkedNodes.splice(this.checkedNodes.indexOf(o),1);var l=this.getChildNodes(this.treeData,o);if(l){for(var h=0;h<l.length;h++){var u=l[h][this.fields.id]?l[h][this.fields.id].toString():null;if(this.checkedNodes.indexOf(u)!==-1){this.checkedNodes.splice(this.checkedNodes.indexOf(u),1);var c=this.element.querySelector('[data-uid="'+u+'"]');c&&this.changeState(c,"uncheck",null)}}this.parentNodeCheck.indexOf(o)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1)}o&&this.dynamicCheckState(o,r),this.updateField(this.treeData,this.fields,o,"isChecked",null)}continue}var d=$("."+qt+" ."+ms,a);this.validateCheckNode(d,!r,a,null)}if(i)for(var v=0;v<i.length-1;v++){var o=i[v]?i[v].toString():"";r||this.updateField(this.treeData,this.fields,o,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},e.prototype.updateFieldChecked=function(i,r){var n=U(i,"."+mt),a=n.getAttribute("data-uid"),o=this.getNodeData(n);o.isChecked==="true"&&!r&&this.updateField(this.treeData,this.fields,a,"isChecked",null)},e.prototype.dynamicCheckState=function(i,r){if(this.dataType===1){var n=0,a=new ge(this.treeData).executeLocal(new $e().where(this.fields.id,"equal",i,!0));if(a[0]){var o=a[0][this.fields.id]?a[0][this.fields.id].toString():null,l=a[0][this.fields.parentID]?a[0][this.fields.parentID].toString():null,h=this.element.querySelector('[data-uid="'+l+'"]');h&&$("."+Hs,h);var u=h?$("."+un,h):null,c=this.element.querySelector('[data-uid="'+o+'"]'),d=this.getChildNodes(this.treeData,l);if(d)for(var p=0;p<d.length;p++){var f=d[p][this.fields.id]?d[p][this.fields.id].toString():null;this.checkedNodes.indexOf(f)!==-1&&n++}this.checkedNodes.indexOf(i)!==-1&&h&&o===i&&this.autoCheck?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&c&&o===i&&!r?this.changeState(c,"uncheck",null):this.checkedNodes.indexOf(i)!==-1&&c&&o===i&&r?this.changeState(c,"check",null):this.checkedNodes.indexOf(i)===-1&&!c&&h&&o===i&&this.autoCheck&&n!==0?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&!c&&h&&o===i&&this.autoCheck&&n===0?this.changeState(h,"uncheck",null):!c&&!h&&o===i&&this.autoCheck&&this.updateIndeterminate(i,r)}}else if(this.dataType===2||this.fields.dataSource instanceof ge&&this.isOffline)for(var o=void 0,h=void 0,u=void 0,p=0;p<this.treeData.length;p++){o=this.treeData[p][this.fields.id]?this.treeData[p][this.fields.id].toString():"",h=this.element.querySelector('[data-uid="'+o+'"]'),u=h?$("."+un,h):null,this.checkedNodes.indexOf(o)===-1&&h&&u&&!r&&this.changeState(h,"uncheck",null);var v=ie(this.fields.child.toString(),this.treeData[p]);v&&this.updateChildIndeterminate(v,o,i,r,o)}},e.prototype.updateIndeterminate=function(i,r){var n=this.getTreeData(i),a=0,o;this.dataType===1&&(o=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null);var l=this.getChildNodes(this.treeData,o);if(l)for(var h=0;h<l.length;h++){var u=l[h][this.fields.id]?l[h][this.fields.id].toString():null;this.checkedNodes.indexOf(u)!==-1&&a++}var c=this.element.querySelector('[data-uid="'+o+'"]');c&&r?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(o)===-1&&a!==0?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(o)===-1&&a===0?this.changeState(c,"uncheck",null):c||(!r&&this.checkedNodes.indexOf(o)===-1&&this.parentNodeCheck.indexOf(o)!==-1?this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1):r&&this.checkedNodes.indexOf(o)===-1&&this.parentNodeCheck.indexOf(o)===-1?this.parentNodeCheck.push(o):!r&&this.checkedNodes.indexOf(o)!==-1&&this.parentNodeCheck.indexOf(o)===-1&&a!==0&&this.parentNodeCheck.push(o),this.updateIndeterminate(o,r),this.checkedNodes.indexOf(o)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(o),1))},e.prototype.updateChildIndeterminate=function(i,r,n,a,o){for(var l=0,h=0;h<i.length;h++){var u=i[h][this.fields.id]?i[h][this.fields.id].toString():"";this.checkedNodes.indexOf(u)!==-1&&l++;var c=this.element.querySelector('[data-uid="'+r+'"]'),d=c?$("."+Hs,c):null,p=c?$("."+un,c):null,f=this.element.querySelector('[data-uid="'+u+'"]'),v=f?$("."+un,f):null;if(this.checkedNodes.indexOf(n)!==-1&&c&&u===n&&this.autoCheck)this.changeState(c,"indeterminate",null);else if(this.checkedNodes.indexOf(n)===-1&&c&&!f&&u===n&&!a)this.autoCheck?this.changeState(c,"uncheck",null):l!==0?this.changeState(c,"indeterminate",null):this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&f&&u===n&&!a)this.changeState(f,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&d&&u===n&&this.autoCheck&&l===0&&!a)d.classList.remove(Hs);else if(this.checkedNodes.indexOf(n)===-1&&!f&&p&&u===n&&l===0)this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(u)===-1&&f&&v&&l===0)this.changeState(f,"uncheck",null);else if(!f&&!c&&u===n||this.parentNodeCheck.indexOf(r)!==-1&&this.autoCheck){var g=this.element.querySelector('[data-uid="'+o+'"]');a&&l!==0?this.changeState(g,"indeterminate",null):a&&l===i.length&&this.checkedNodes.indexOf(r)===-1?this.checkedNodes.push(r):!a&&l===0&&this.parentNodeCheck.indexOf(r)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r)),this.parentNodeCheck.indexOf(r)===-1&&this.parentNodeCheck.push(r)}var b=ie(this.fields.child.toString(),i[h]);b&&this.updateChildIndeterminate(b,u,n,a,o)}},e.prototype.changeState=function(i,r,n,a,o,l){var h=this,u,c=U(i,"."+mt);i===c&&(i=$("."+ms,c)),a?this.nodeCheckAction(i,r,c,u,n,a,o,l):(this.checkActionNodes=[],u=this.getCheckEvent(c,r,n),this.trigger("nodeChecking",u,function(d){d.cancel||h.nodeCheckAction(i,r,c,d,n,a,o,l)}))},e.prototype.nodeCheckAction=function(i,r,n,a,o,l,h,u){var c,d=i.getElementsByClassName(Eo)[0];if(r==="check"&&!d.classList.contains(un)?(d.classList.remove(Hs),d.classList.add(un),this.addCheck(n),c="true"):r==="uncheck"&&(d.classList.contains(un)||d.classList.contains(Hs))?(te([d],[un,Hs]),this.removeCheck(n),c="false"):r==="indeterminate"&&this.autoCheck&&(d.classList.remove(un),d.classList.add(Hs),this.removeCheck(n),c="mixed"),c=r==="check"?"true":r==="uncheck"?"false":c,m(c)||i.setAttribute("aria-checked",c),h){var p=[].concat([],this.checkActionNodes);a=this.getCheckEvent(n,r,o),Re(l)&&(a.data=p)}u!==void 0&&this.ensureStateChange(n,u),l||m(c)||(i.setAttribute("aria-checked",c),a.data[0].checked=c,this.trigger("nodeChecked",a),this.checkActionNodes=[])},e.prototype.addCheck=function(i){var r=i.getAttribute("data-uid");!m(r)&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r)},e.prototype.removeCheck=function(i){var r=this.checkedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.checkedNodes.splice(r,1)},e.prototype.getCheckEvent=function(i,r,n){this.checkActionNodes.push(this.getNodeData(i));var a=this.checkActionNodes;return{action:r,cancel:!1,isInteracted:!m(n),node:i,data:a}},e.prototype.finalize=function(){var i=$("."+qt,this.element);if(!m(i)){i.setAttribute("role",Ok.treeRole),this.setMultiSelect(this.allowMultiSelection);var r=$("."+mt,this.element);r&&(r.setAttribute("tabindex","0"),this.updateIdAttr(null,r)),this.allowTextWrap&&this.updateWrap(),this.renderReactTemplates(),this.hasPid=this.rootData[0]?this.rootData[0].hasOwnProperty(this.fields.parentID):!1,this.doExpandAction()}},e.prototype.setTextWrap=function(){(this.allowTextWrap?Q:te)([this.element],Xq),B.isIE&&(this.allowTextWrap?Q:te)([this.element],Kq)},e.prototype.updateWrap=function(i){if(this.fullRowSelect)for(var r=i?ze("."+mt,i):this.liList,n=r.length,a=0;a<n;a++)this.calculateWrap(r[a])},e.prototype.calculateWrap=function(i){var r=$("."+Mo,i);r&&r.nextElementSibling&&(r.style.height=this.allowTextWrap?r.nextElementSibling.offsetHeight+"px":"")},e.prototype.doExpandAction=function(){var i=this,r=this.expandedNodes;if(!this.loadOnDemand&&this.fields.dataSource instanceof ge&&(this.isInitalExpand=this.treeData.filter(function(l){return l[i.fields.expanded]==!0}).length>0?!0:this.isInitalExpand),this.isInitalExpand&&r.length>0)if(this.setProperties({expandedNodes:[]},!0),this.fields.dataSource instanceof ge)this.expandGivenNodes(r);else{for(var n=0;n<r.length;n++){var a=$('[data-uid="'+r[n]+'"]',this.element);if(m(a)){r[n]&&this.expandChildren.indexOf(r[n])===-1&&this.expandChildren.push(r[n].toString());continue}else{var o=$("."+ui,$("."+Dr,a));m(o)||this.expandAction(a,o,null)}}this.afterFinalized()}else this.afterFinalized()},e.prototype.expandGivenNodes=function(i){var r=this;this.expandCallback(i[this.index],function(){r.index++,r.index<i.length?r.expandGivenNodes(i):r.afterFinalized()})},e.prototype.expandCallback=function(i,r){var n=$('[data-uid="'+i+'"]',this.element);if(m(n))r();else{var a=$("."+ui,$("."+Dr,n));m(a)?r():this.expandAction(n,a,null,!1,r)}},e.prototype.afterFinalized=function(){if(this.doSelectionAction(),this.updateCheckedProp(),this.isAnimate=!0,this.isInitalExpand=!1,(!this.isLoaded||this.isFieldChange)&&!this.isNodeDropped){var i={data:this.treeData};this.trigger("dataBound",i)}this.isLoaded=!0,this.isNodeDropped=!1},e.prototype.doSelectionAction=function(){var i=ze("."+Ju,this.element),r=this.selectedNodes;if(r.length>0){this.setProperties({selectedNodes:[]},!0);for(var n=0;n<r.length;n++){var a=$('[data-uid="'+r[n]+'"]',this.element);if(a&&!a.classList.contains("e-active")?this.selectNode(a,null,!0):this.selectedNodes.push(r[n]),!this.allowMultiSelection)break}}else this.selectGivenNodes(i);te(i,Ju)},e.prototype.selectGivenNodes=function(i){for(var r=0;r<i.length&&(i[r].classList.contains("e-disable")||this.selectNode(i[r],null,!0),!!this.allowMultiSelection);r++);},e.prototype.clickHandler=function(i){var r=B.isDevice&&!B.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;if(I.remove(this.element,"contextmenu",this.preventContextMenu),!(!r||this.dragStartAction)){var n=r.classList,a=U(r,"."+mt);if(!a||a.classList.contains(ec)&&!(n.contains(ui)||n.contains(Tr)))return;if(i.originalEvent.which!==3){var o=$("."+iY,a),l=$("."+Ui,a);if(this.removeHover(),this.setFocusElement(a),this.showCheckBox&&!a.classList.contains("e-disable")){var h=U(r,"."+ms);if(!m(h)){var u=$("."+Eo,h);this.validateCheckNode(h,u.classList.contains(un),a,i.originalEvent),this.triggerClickEvent(i.originalEvent,a);return}}n.contains(ui)?this.expandAction(a,r,i):n.contains(Tr)?this.collapseNode(a,r,i):o&&l?l.classList.contains(Nk)&&l.classList.contains(ui)?this.expandAction(a,l,i):l.classList.contains(Nk)&&l.classList.contains(Tr)?this.collapseNode(a,l,i):!n.contains(qt)&&!n.contains(mt)&&this.toggleSelect(a,i.originalEvent,!1):!n.contains(qt)&&!n.contains(mt)&&this.toggleSelect(a,i.originalEvent,!1)}i.originalEvent.which===3&&(this.isRightClick=!0),this.triggerClickEvent(i.originalEvent,a)}},e.prototype.nodeCheckedEvent=function(i,r,n){U(i,"."+mt);var a=this.getCheckEvent(i,r?"uncheck":"check",n);a.data=a.data.splice(0,a.data.length-1),this.trigger("nodeChecked",a)},e.prototype.triggerClickEvent=function(i,r){var n={event:i,node:r};this.trigger("nodeClicked",n)},e.prototype.expandNode=function(i,r,n){var a=this;if(this.renderReactTemplates(),r.classList.contains(lx)&&this.hideSpinner(r),this.initialRender||r.classList.add("interaction"),n!==!0||n===!0&&i.classList.contains("e-expanded")){if(this.preventExpand!==!0){te([r],ui),Q([r],Tr);var o=0,l=0,h=this,u=$("."+qt,i),c=i;this.setHeight(c,u);var d=$("."+mt+"."+is,i);this.isAnimate&&!this.isRefreshed?this.aniObj.animate(u,{name:this.animation.expand.effect,duration:this.animation.expand.duration===0&&vi==="Enable"?400:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(f){c.style.overflow="hidden",!m(d)&&d instanceof HTMLElement&&d.classList.add(Wm),o=c.offsetHeight,l=$("."+Dr,i).offsetHeight},progress:function(f){f.element.style.display="block",h.animateHeight(f,o,l)},end:function(f){f.element.style.display="block",!m(d)&&d instanceof HTMLElement&&d.classList.remove(Wm),a.expandedNode(c,u,r)}}):this.expandedNode(c,u,r)}}else{var p=$("."+qt,i);p.style.display="none",this.fields.dataSource instanceof ge&&(this.preventExpand=!1)}this.initialRender&&r.classList.add("interaction")},e.prototype.expandedNode=function(i,r,n){r.style.display="block",i.style.display="block",i.style.overflow="",i.style.height="",te([n],wo),this.addExpand(i),this.allowTextWrap&&this.isLoaded&&this.isFirstRender&&(this.updateWrap(i),this.isFirstRender=!1),this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(i,null),this.expandArgs.isInteracted=this.isInteracted,this.trigger("nodeExpanded",this.expandArgs))},e.prototype.addExpand=function(i){i.setAttribute("aria-expanded","true"),te([i],Dk);var r=i.getAttribute("data-uid");!m(r)&&this.expandedNodes.indexOf(r)===-1&&this.expandedNodes.push(r)},e.prototype.collapseNode=function(i,r,n){var a=this;if(!r.classList.contains(wo)){Q([r],wo);var o;this.isLoaded?(o=this.getExpandEvent(i,n),this.isInteracted=o.isInteracted,this.trigger("nodeCollapsing",o,function(l){l.cancel?te([r],wo):a.nodeCollapseAction(i,r,l)})):this.nodeCollapseAction(i,r,o)}},e.prototype.nodeCollapseAction=function(i,r,n){var a=this;te([r],Tr),Q([r],ui);var o=0,l=0,h=this,u=$("."+qt,i),c=i,d=$("."+mt+"."+is,i);this.isAnimate?this.aniObj.animate(u,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration===0&&vi==="Enable"?400:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(p){c.style.overflow="hidden",!m(d)&&d instanceof HTMLElement&&d.classList.add(Wm),o=$("."+Dr,i).offsetHeight,l=c.offsetHeight},progress:function(p){h.animateHeight(p,o,l)},end:function(p){p.element.style.display="none",!m(d)&&d instanceof HTMLElement&&d.classList.remove(Wm),a.collapsedNode(c,u,r,n)}}):this.collapsedNode(c,u,r,n)},e.prototype.collapsedNode=function(i,r,n,a){r.style.display="none",i.style.overflow="",i.style.height="",te([n],wo),this.removeExpand(i),this.isLoaded&&(a=this.getExpandEvent(i,null),a.isInteracted=this.isInteracted,this.trigger("nodeCollapsed",a))},e.prototype.removeExpand=function(i,r){r?i.removeAttribute("aria-expanded"):this.disableExpandAttr(i);var n=this.expandedNodes.indexOf(i.getAttribute("data-uid"));n>-1&&this.expandedNodes.splice(n,1)},e.prototype.disableExpandAttr=function(i){i.setAttribute("aria-expanded","false"),Q([i],Dk)},e.prototype.setHeight=function(i,r){r.style.display="block",r.style.visibility="hidden",i.style.height=i.offsetHeight+"px",r.style.display="none",r.style.visibility=""},e.prototype.animateHeight=function(i,r,n){var a=(i.duration-i.timeStamp)/i.duration,o=(n-r)*a+r;i.element.parentElement.style.height=o+"px"},e.prototype.renderChildNodes=function(i,r,n,a){var o=this,l=$("div."+Ui,i);if(!m(l)){this.showSpinner(l);var h;if(this.fields.dataSource instanceof ge){var u=this.parents(i,"."+qt).length,c=this.getChildFields(this.fields,u,1);if(m(c)||m(c.dataSource)){ne(l),this.removeExpand(i,!0);return}this.treeList.push("false"),this.fields.dataSource instanceof ge&&this.isOffline?(this.treeList.pop(),h=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.loadChild(h,c,l,i,r,n,a)):c.dataSource.executeQuery(this.getQuery(c,i.getAttribute("data-uid"))).then(function(d){o.treeList.pop(),h=d.result,o.dataType===1&&(o.dataType=2),o.loadChild(h,c,l,i,r,n,a)}).catch(function(d){o.trigger("actionFailure",{error:d})})}else if(h=this.getChildNodes(this.treeData,i.getAttribute("data-uid"),!1,parseFloat(i.getAttribute("aria-level"))+1),this.currentLoadData=this.getSortedData(h),m(h)||h.length===0){ne(l),this.removeExpand(i,!0);return}else this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(Et.createList(this.createElement,this.currentLoadData,this.listBaseOption)),this.expandNode(i,l,a),this.setSelectionForChildNodes(h),this.ensureCheckNode(i),this.finalizeNode(i),this.disableTreeNodes(h),this.renderSubChild(i,r,a)}},e.prototype.loadChild=function(i,r,n,a,o,l,h){if(this.currentLoadData=i,m(i)||i.length===0)ne(n),this.removeExpand(a,!0);else{if(this.updateListProp(r),this.fields.dataSource instanceof ge&&!this.isOffline){var u=a.getAttribute("data-uid"),c=this.getNodeObject(u);kt("child",i,c)}this.listBaseOption.ariaAttributes.level=parseFloat(a.getAttribute("aria-level"))+1,a.appendChild(Et.createList(this.createElement,i,this.listBaseOption)),this.expandNode(a,n,h),this.setSelectionForChildNodes(i),this.ensureCheckNode(a),this.finalizeNode(a),this.disableTreeNodes(i),this.renderSubChild(a,o,h)}l&&l(),o&&this.expandedNodes.push(a.getAttribute("data-uid")),this.treeList.length===0&&!this.isLoaded&&this.finalize()},e.prototype.disableTreeNodes=function(i){for(var r=0;r<i.length;){var n=i[r][this.fields.id]?i[r][this.fields.id].toString():null;this.disableNode!==void 0&&this.disableNode.indexOf(n)!==-1&&this.doDisableAction([n]),r++}},e.prototype.setSelectionForChildNodes=function(i){var r;for(r=0;r<i.length;r++){var n=i[r][this.fields.id]?i[r][this.fields.id].toString():null;this.selectedNodes!==void 0&&this.selectedNodes.indexOf(n)!==-1&&this.doSelectionAction()}},e.prototype.ensureCheckNode=function(i){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(i.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(i),this.ensureParentCheckState(i))),this.currentLoadData=null},e.prototype.getFields=function(i,r,n){return r===n?i:this.getFields(this.getChildMapper(i),r,n+1)},e.prototype.getChildFields=function(i,r,n){return r===n?this.getChildMapper(i):this.getChildFields(this.getChildMapper(i),r,n+1)},e.prototype.getChildMapper=function(i){return typeof i.child=="string"||m(i.child)?i:i.child},e.prototype.getChildNodes=function(i,r,n,a){var o=this;n===void 0&&(n=!1);var l;if(m(i))return l;if(this.dataType===1)return this.getChildGroup(this.groupedData,r,n);if(typeof this.fields.child=="string"){var h=i.findIndex(function(g){return ie(o.fields.id,g)&&ie(o.fields.id,g).toString()===r});if(h!==-1)return ie(this.fields.child,i[h]);if(h===-1)for(var u=0,c=i.length;u<c;u++){var d=ie(this.fields.child,i[u]),p=m(d)?-1:d.findIndex(function(g){return ie(o.fields.id,g)&&ie(o.fields.id,g).toString()===r});if(p!==-1)return ie(this.fields.child,d[p]);if(!m(d)&&(l=this.getChildNodes(d,r),l!==void 0))break}}else if(this.isChildObject()){for(var f=m(a)?this.fields.child:this.fields,u=1;u<a&&!m(f.child);){f=f.child;u++}this.updateListProp(f);var h=i.findIndex(function(y){return ie(o.fields.id,y)&&ie(o.fields.id,y).toString()===r});if(h!==-1)return ie("child",i[h]);if(h===-1)for(var v=0,c=i.length;v<c;v++){var d=ie("child",i[v]),p=m(d)?-1:d.findIndex(function(w){return ie(o.fields.child.id,w)&&ie(o.fields.child.id,w).toString()===r});if(p!==-1)return ie("child",d[p]);if(!m(d)&&(l=this.getChildNodes(d,r,!1,a),l!==void 0))break}}return l},e.prototype.getChildGroup=function(i,r,n){var a;if(m(i))return a;for(var o=0,l=i.length;o<l;o++)if(!m(i[o][0])&&!m(ie(this.fields.parentID,i[o][0]))){if(ie(this.fields.parentID,i[o][0]).toString()===r)return i[o]}else return n?i[o]:[];return a},e.prototype.renderSubChild=function(i,r,n){if(r)for(var a=ze("."+ui,i),o=0,l=a.length;o<l;o++){var h=a[o];if(i.querySelector(".e-icons")!==a[o]){var u=U(h,"."+mt);this.expandArgs=this.getExpandEvent(u,null),n!==!0&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(u,r,null,n)}}},e.prototype.toggleSelect=function(i,r,n){i.classList.contains("e-disable")||(this.allowMultiSelection&&(r&&r.ctrlKey||n)&&this.isActive(i)?this.unselectNode(i,r):this.selectNode(i,r,n))},e.prototype.isActive=function(i){return!!i.classList.contains(is)},e.prototype.selectNode=function(i,r,n){var a=this;if(m(i)||!this.allowMultiSelection&&this.isActive(i)&&!m(r)){this.setFocusElement(i);return}var o;this.isLoaded?(o=this.getSelectEvent(i,"select",r),this.trigger("nodeSelecting",o,function(l){!l.cancel&&!l.node.classList.contains(ec)&&a.nodeSelectAction(i,r,l,n)})):this.nodeSelectAction(i,r,o,n)},e.prototype.nodeSelectAction=function(i,r,n,a){if((!this.allowMultiSelection||!a&&(!r||r&&!r.ctrlKey))&&this.removeSelectAll(),this.allowMultiSelection&&r&&r.shiftKey){this.startNode||(this.startNode=i);var o=this.liList.indexOf(this.startNode),l=this.liList.indexOf(i);if(o>l){var h=o;o=l,l=h}for(var u=o;u<=l;u++){var c=this.liList[u];or(c)&&!c.classList.contains("e-disable")&&this.addSelect(c)}}else this.startNode=i,this.addSelect(i);this.isLoaded&&(n.nodeData=this.getNodeData(i),this.trigger("nodeSelected",n),this.isRightClick=!1),this.isRightClick=!1},e.prototype.unselectNode=function(i,r){var n=this,a;this.isLoaded?(a=this.getSelectEvent(i,"un-select",r),this.trigger("nodeSelecting",a,function(o){o.cancel||n.nodeUnselectAction(i,o)})):this.nodeUnselectAction(i,a)},e.prototype.nodeUnselectAction=function(i,r){this.removeSelect(i),this.setFocusElement(i),this.isLoaded&&(r.nodeData=this.getNodeData(i),this.trigger("nodeSelected",r))},e.prototype.setFocusElement=function(i){if(!m(i)){var r=this.getFocusedNode();r&&(te([r],xh),r.setAttribute("tabindex","-1")),Q([i],xh),i.setAttribute("tabindex","0"),I.add(i,"blur",this.focusOut,this),this.updateIdAttr(r,i)}},e.prototype.addSelect=function(i){i.setAttribute("aria-selected","true"),Q([i],is);var r=i.getAttribute("data-uid");!m(r)&&this.selectedNodes.indexOf(r)===-1&&this.selectedNodes.push(r)},e.prototype.removeSelect=function(i){this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected"),te([i],is);var r=this.selectedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.selectedNodes.splice(r,1)},e.prototype.removeSelectAll=function(){for(var i=this.element.querySelectorAll("."+is),r=0,n=i;r<n.length;r++){var a=n[r];this.allowMultiSelection?a.setAttribute("aria-selected","false"):a.removeAttribute("aria-selected")}te(i,is),this.setProperties({selectedNodes:[]},!0)},e.prototype.getSelectEvent=function(i,r,n){var a=this.getNodeData(i);return{action:r,cancel:!1,isInteracted:!m(n),node:i,nodeData:a}},e.prototype.setExpandOnType=function(){this.expandOnType=this.expandOn==="Auto"?B.isDevice?"Click":"DblClick":this.expandOn},e.prototype.expandHandler=function(i){var r=i.originalEvent.target;!r||r.classList.contains(Hm)||r.classList.contains(Bs)||r.classList.contains(qt)||r.classList.contains(mt)||r.classList.contains(Ui)||this.showCheckBox&&U(r,"."+ms)||this.expandCollapseAction(U(r,"."+mt),i)},e.prototype.expandCollapseAction=function(i,r){var n=$("div."+Ui,i);if(!(!n||n.classList.contains(wo))){var a=n.classList;a.contains(ui)?this.expandAction(i,n,r):a.contains(Tr)&&this.collapseNode(i,n,r)}},e.prototype.expandAction=function(i,r,n,a,o){var l=this;r.classList.contains(wo)||(Q([r],wo),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(i,n),this.isInteracted=this.expandArgs.isInteracted,this.trigger("nodeExpanding",this.expandArgs,function(h){h.cancel?te([r],wo):l.nodeExpandAction(i,r,a,o)})):this.nodeExpandAction(i,r,a,o))},e.prototype.nodeExpandAction=function(i,r,n,a){var o=$("."+qt,i);if(o&&o.nodeName==="UL")this.expandNode(i,r);else{this.isFirstRender=!0,this.renderChildNodes(i,n,a);for(var l=ze("."+mt,i),h=0;h<l.length;h++){var u=this.getId(l[h]);if(this.expandChildren.indexOf(u)!==-1&&this.expandChildren!==void 0){var c=$("."+ui,$("."+Dr,l[h]));m(c)||this.expandAction(l[h],c,null),this.expandChildren.splice(this.expandChildren.indexOf(u),1)}}}},e.prototype.keyActionHandler=function(i){var r=this,n=i.target,a=this.getFocusedNode();if(n&&n.classList.contains(Hm)){var o=n;i.action==="enter"?o.blur():i.action==="escape"&&(o.value=this.oldText,o.blur());return}i.preventDefault();var l={cancel:!1,event:i,node:a};this.trigger("keyPress",l,function(h){if(!h.cancel)switch(i.action){case"space":r.showCheckBox?r.checkNode(i):r.toggleSelect(a,i);break;case"moveRight":r.openNode(!r.enableRtl,i);break;case"moveLeft":r.openNode(!!r.enableRtl,i);break;case"shiftDown":r.shiftKeySelect(!0,i);break;case"moveDown":case"ctrlDown":case"csDown":r.navigateNode(!0);break;case"shiftUp":r.shiftKeySelect(!1,i);break;case"moveUp":case"ctrlUp":case"csUp":r.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":r.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":r.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":case"shiftSpace":case"ctrlSpace":r.toggleSelect(a,i);break;case"f2":r.allowEditing&&!a.classList.contains("e-disable")&&r.createTextbox(a,i);break;case"ctrlA":if(r.allowMultiSelection){var u=ze("."+mt+":not(."+is+")",r.element);r.selectGivenNodes(u)}break}})},e.prototype.navigateToFocus=function(i){var r=this.getFocusedNode().querySelector("."+Dr),n=r.getBoundingClientRect(),a=this.getScrollParent(this.element);if(!m(a)){var o=a.getBoundingClientRect();n.bottom>o.bottom?a.scrollTop+=n.bottom-o.bottom:n.top<o.top&&(a.scrollTop-=o.top-n.top)}var l=this.isVisibleInViewport(r);l||r.scrollIntoView(i)},e.prototype.isVisibleInViewport=function(i){var r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},e.prototype.getScrollParent=function(i){return m(i)?null:i.scrollHeight>i.clientHeight?i:this.getScrollParent(i.parentElement)},e.prototype.shiftKeySelect=function(i,r){if(this.allowMultiSelection){var n=this.getFocusedNode(),a=i?this.getNextNode(n):this.getPrevNode(n);this.removeHover(),this.setFocusElement(a),this.toggleSelect(a,r,!1),this.navigateToFocus(!i)}else this.navigateNode(i)},e.prototype.checkNode=function(i){var r=this.getFocusedNode(),n=$("."+ms,r),a=$(" ."+Eo,n).classList.contains(un);r.classList.contains("e-disable")||r.getElementsByClassName("e-checkbox-disabled").length==0&&this.validateCheckNode(n,a,r,i)},e.prototype.validateCheckNode=function(i,r,n,a){var o=this,l=U(i,"."+mt);this.checkActionNodes=[];var h=r?"false":"true";m(h)||i.setAttribute("aria-checked",h);var u=this.getCheckEvent(l,r?"uncheck":"check",a);this.trigger("nodeChecking",u,function(c){c.cancel||o.nodeCheckingAction(i,r,n,c,a)})},e.prototype.nodeCheckingAction=function(i,r,n,a,o){if(this.checkedElement.indexOf(n.getAttribute("data-uid"))===-1&&(this.checkedElement.push(n.getAttribute("data-uid")),this.autoCheck)){var l=this.getChildNodes(this.treeData,n.getAttribute("data-uid"));l!==null?this.allCheckNode(l,this.checkedElement,null,null,!1):l=null}if(this.changeState(i,r?"uncheck":"check",o,!0),this.autoCheck){this.ensureChildCheckState(n),this.ensureParentCheckState(U(U(n,"."+qt),"."+mt));var h=void 0;a.action==="check"?h=!0:a.action==="uncheck"&&(h=!1),this.ensureStateChange(n,h)}this.nodeCheckedEvent(i,r,o)},e.prototype.ensureStateChange=function(i,r){var n=$("."+qt,i),a=i.getAttribute("data-uid"),o=this.fields;if(this.dataType===1&&this.autoCheck)for(var l=new ge(this.treeData).executeLocal(new $e().where(o.parentID,"equal",a,!0)),h=0;h<l.length;h++){var u=l[h][this.fields.id]?l[h][this.fields.id].toString():null,c=l[h][this.fields.isChecked]?l[h][this.fields.isChecked].toString():null;if(this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(u)===-1){this.checkedNodes.push(u);var d=this.getChildNodes(this.treeData,u);this.getChildItems(d,r),this.parentNodeCheck.indexOf(u)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(u),1)}else if(this.checkedNodes.indexOf(a)===-1&&n===null&&this.checkedNodes.indexOf(u)!==-1){if(this.checkedNodes.splice(this.checkedNodes.indexOf(u),1),c==="true"&&this.updateField(this.treeData,this.fields,u,"isChecked",null),this.checkedNodes.indexOf(a)===-1&&n===null||this.parentNodeCheck.indexOf(u)!==-1){var p=this.getChildNodes(this.treeData,u);this.getChildItems(p,r),this.parentNodeCheck.indexOf(u)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(u),1)}}else{var d=this.getChildNodes(this.treeData,u);this.getChildItems(d,r)}}else if(this.dataType===1&&!this.autoCheck)if(r)for(var h=0;h<this.treeData.length;h++){var g=this.treeData[h][this.fields.id]?this.treeData[h][this.fields.id].toString():null;this.checkedNodes.indexOf(g)===-1&&this.checkedNodes.push(g)}else{for(var f=new ge(this.treeData).executeLocal(new $e().where(o.isChecked,"equal",!0,!1)),h=0;h<f.length;h++){var v=f[h][this.fields.id]?f[h][this.fields.id].toString():null;this.checkedNodes.indexOf(v)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(v),1),this.updateField(this.treeData,this.fields,v,"isChecked",null)}this.checkedNodes=[]}else{var d=this.getChildNodes(this.treeData,a);d&&this.childStateChange(d,a,n,r)}},e.prototype.getChildItems=function(i,r){for(var n=0;n<i.length;n++){var a=i[n][this.fields.id]?i[n][this.fields.id].toString():null,o=i[n][this.fields.isChecked]?i[n][this.fields.isChecked].toString():null;this.checkedNodes.indexOf(a)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(a),1),this.checkedNodes.indexOf(a)===-1&&r&&this.checkedNodes.push(a),o==="true"&&!r&&this.updateField(this.treeData,this.fields,a,"isChecked",null);var l=this.getChildNodes(this.treeData,a);l.length>0&&this.getChildItems(l,r)}},e.prototype.childStateChange=function(i,r,n,a){for(var o=0;o<i.length;o++){var l=i[o][this.fields.id]?i[o][this.fields.id].toString():"",h=i[o][this.fields.isChecked]?i[o][this.fields.isChecked].toString():null;this.autoCheck?this.checkedNodes.indexOf(r)!==-1&&this.checkedNodes.indexOf(l)===-1?(this.checkedNodes.push(l),this.parentNodeCheck.indexOf(l)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1)):this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.indexOf(l)!==-1&&!a&&(this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),h==="true"&&this.updateField(this.treeData,this.fields,l,"isChecked",null)):this.autoCheck||(a?this.checkedNodes.indexOf(l)===-1&&this.checkedNodes.push(l):(this.checkedNodes.indexOf(l)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),this.updateField(this.treeData,this.fields,l,"isChecked",null),this.checkedNodes=[]));var u=this.getChildNodes([i[o]],l);u&&this.childStateChange(u,r,n,a)}},e.prototype.allCheckNode=function(i,r,n,a,o){if(i)for(var l=0;l<i.length;l++){var h=ie(this.fields.id,i[l]),u=this.element.querySelector('[data-uid="'+h+'"]');o!==!1&&this.checkedElement.indexOf(h.toString())===-1&&(u===null&&!m(i[l][this.fields.isChecked])&&r.indexOf(h.toString())===-1||a===0||n===2)&&(i[l][this.fields.isChecked]!==!1||n===2?r.push(h.toString()):a=null,a=i[l][this.fields.isChecked]!==!1||n===2?0:null),r.indexOf(h.toString())===-1&&m(n)&&r.push(h.toString());var c=ie(this.fields.child.toString(),i[l]);if(ie(this.fields.hasChildren,i[l])===!0||c){var d=ie(this.fields.id,i[l]),p=void 0;this.dataType===1?p=this.getChildNodes(this.treeData,d.toString()):p=c,p&&(m(o)?this.allCheckNode(p,r,n,a):this.allCheckNode(p,r,n,a,o),a=null)}a=null}},e.prototype.openNode=function(i,r){var n=this.getFocusedNode(),a=$("div."+Ui,n);if(i)if(a)a.classList.contains(ui)?this.expandAction(n,a,r):this.focusNextNode(n,!0);else return;else if(a&&a.classList.contains(Tr))this.collapseNode(n,a,r);else{var o=U(U(n,"."+qt),"."+mt);if(o)o.classList.contains("e-disable")||(this.setFocus(n,o),this.navigateToFocus(!0));else return}},e.prototype.navigateNode=function(i){var r=this.getFocusedNode();this.focusNextNode(r,i)},e.prototype.navigateRootNode=function(i){var r=this.getFocusedNode(),n=i?this.getRootNode():this.getEndNode();n.classList.contains("e-disable")||(this.setFocus(r,n),this.navigateToFocus(i))},e.prototype.getFocusedNode=function(){var i,r=$("."+mt+'[tabindex="0"]',this.element);return m(r)&&(i=$("."+mt,this.element)),m(r)?m(i)?this.element.firstElementChild:i:r},e.prototype.focusNextNode=function(i,r){var n=r?this.getNextNode(i):this.getPrevNode(i);if(this.setFocus(i,n),this.navigateToFocus(!r),n.classList.contains("e-disable")){var a=n.lastChild;n.previousSibling==null&&n.classList.contains("e-level-1")?this.focusNextNode(n,!0):n.nextSibling==null&&n.classList.contains("e-node-collapsed")?this.focusNextNode(n,!1):n.nextSibling==null&&a.classList.contains(Dr)?this.focusNextNode(n,!1):this.focusNextNode(n,r)}},e.prototype.getNextNode=function(i){var r=this.liList.indexOf(i),n;do if(r++,n=this.liList[r],m(n))return i;while(!or(n));return n},e.prototype.getPrevNode=function(i){var r=this.liList.indexOf(i),n;do if(r--,n=this.liList[r],m(n))return i;while(!or(n));return n},e.prototype.getRootNode=function(){var i=0,r;do r=this.liList[i],i++;while(!or(r));return r},e.prototype.getEndNode=function(){var i=this.liList.length-1,r;do r=this.liList[i],i--;while(!or(r));return r},e.prototype.setFocus=function(i,r){te([i],xh),i.setAttribute("tabindex","-1"),!r.classList.contains("e-disable")&&!r.classList.contains(ec)&&(Q([r],xh),r.setAttribute("tabindex","0"),r.focus(),I.add(r,"blur",this.focusOut,this),this.updateIdAttr(i,r))},e.prototype.updateIdAttr=function(i,r){this.element.removeAttribute("aria-activedescendant"),i&&i.removeAttribute("id"),r.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},e.prototype.focusIn=function(){if(!this.mouseDownStatus){var i=this.getFocusedNode();i.setAttribute("tabindex","0"),Q([i],xh),I.add(i,"blur",this.focusOut,this)}this.mouseDownStatus=!1},e.prototype.focusOut=function(i){var r=this.getFocusedNode();i.target==r&&(te([r],xh),I.remove(r,"blur",this.focusOut))},e.prototype.onMouseOver=function(i){var r=i.target,n=r.classList,a=U(r,"."+mt);if(!a||n.contains(qt)||n.contains(mt)){this.removeHover();return}else a&&!a.classList.contains("e-disable")&&this.setHover(a)},e.prototype.setHover=function(i){!i.classList.contains(Bm)&&!i.classList.contains(ec)&&(this.removeHover(),Q([i],Bm))},e.prototype.onMouseLeave=function(i){this.removeHover()},e.prototype.removeHover=function(){var i=ze("."+Bm,this.element);i&&i.length&&te(i,Bm)},e.prototype.getNodeData=function(i,r){if(!m(i)&&i.classList.contains(mt)&&!m(U(i,"."+wk))&&U(i,"."+wk).classList.contains(Bs)){var n=i.getAttribute("data-uid"),a=this.getText(i,r),o=U(i.parentNode,"."+mt),l=o?o.getAttribute("data-uid"):null,h=i.classList.contains(is),u=!i.classList.contains(ec),c=i.getAttribute("aria-expanded")==="true",d=i.getAttribute("aria-expanded")!==null?!0:($("."+ui,i)||$("."+Tr,i))!=null,p=null,f=$("."+ms,i);return this.showCheckBox&&f&&(p=f.getAttribute("aria-checked")),{id:n,text:a,parentID:l,selected:h,selectable:u,expanded:c,isChecked:p,hasChildren:d}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},e.prototype.getText=function(i,r){if(r){var n=this.getNodeObject(i.getAttribute("data-uid")),a=parseFloat(i.getAttribute("aria-level")),o=this.getFields(this.fields,a,1);return ie(o.text,n)}return $("."+Sh,i).textContent},e.prototype.getExpandEvent=function(i,r){var n=this.getNodeData(i);return{cancel:!1,isInteracted:!m(r),node:i,nodeData:n,event:r}},e.prototype.renderNodeTemplate=function(i,r,n){var a=this.nodeTemplateFn(i,this,"nodeTemplate"+n,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,r,this.root);a&&(a=Array.prototype.slice.call(a),Ut(a,r))},e.prototype.destroyTemplate=function(i){this.clearTemplate(["nodeTemplate"+i.getAttribute("data-uid")])},e.prototype.reRenderNodes=function(){this.updateListProp(this.fields),B.isIE?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",m(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},e.prototype.setCssClass=function(i,r){!m(i)&&i!==""&&te([this.element],i.split(" ")),!m(r)&&r!==""&&Q([this.element],r.split(" "))},e.prototype.editingHandler=function(i){var r=i.target;if(!(!r||r.classList.contains(Bs)||r.classList.contains(qt)||r.classList.contains(mt)||r.classList.contains(Ui)||r.classList.contains(Hm)||r.classList.contains(Mk))){var n=U(r,"."+mt);this.createTextbox(n,i)}},e.prototype.createTextbox=function(i,r){var n=this,a=$("."+Vm,this.element);a&&a.blur();var o=$("."+Sh,i);this.updateOldText(i);var l=this.createElement("input",{className:Vm,attrs:{value:this.oldText}}),h=this.getEditEvent(i,null,l.outerHTML);this.trigger("nodeEditing",h,function(u){if(!u.cancel){var c=o.offsetWidth+5,d="width:"+c+"px";Q([i],hx),m(n.nodeTemplateFn)||n.destroyTemplate(i),n.isReact?setTimeout(function(){n.renderTextBox(h,o,d)},5):n.renderTextBox(h,o,d)}})},e.prototype.renderTextBox=function(i,r,n){r.innerHTML=i.innerHtml;var a=$("."+Vm,r);this.inputObj=ye.createInput({element:a,properties:{enableRtl:this.enableRtl}},this.createElement),this.inputObj.container.setAttribute("style",n),a.focus();var o=a;o.setSelectionRange(0,o.value.length),this.wireInputEvents(a)},e.prototype.updateOldText=function(i){var r=i.getAttribute("data-uid");this.editData=this.getNodeObject(r);var n=parseFloat(i.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,n,1),this.oldText=ie(this.editFields.text,this.editData)},e.prototype.inputFocusOut=function(i){if($("."+Vm,this.element)){var r=i.target,n=r.value,a=U(r,"."+Sh),o=U(r,"."+mt);ne(this.inputObj.container),this.fields.dataSource instanceof ge&&!this.isOffline?this.crudOperation("update",null,o,n,null,null,!0):this.appendNewText(o,a,n,!0)}},e.prototype.appendNewText=function(i,r,n,a){var o=this,l=this.getEditEvent(i,n,null);this.trigger("nodeEdited",l,function(h){n=h.cancel?h.oldText:h.newText,o.updateText(i,r,n,a),h.oldText!==n&&o.triggerEvent("nodeEdited",[o.getNode(i)])})},e.prototype.updateText=function(i,r,n,a){var o=kt(this.editFields.text,n,this.editData);if(m(this.nodeTemplateFn))this.enableHtmlSanitizer?r.innerText=Fi.sanitize(n):r.innerHTML=n;else{r.innerText="";var l=i.getAttribute("data-uid");this.renderNodeTemplate(o,r,l),this.renderReactTemplates()}a&&(te([i],hx),i.focus(),I.add(i,"blur",this.focusOut,this),Q([i],xh)),this.allowTextWrap&&this.calculateWrap(i)},e.prototype.getElement=function(i){return m(i)?null:typeof i=="string"?this.element.querySelector('[data-uid="'+i+'"]'):typeof i=="object"?aA(i):null},e.prototype.getId=function(i){return m(i)?null:typeof i=="string"?i:typeof i=="object"?aA(i).getAttribute("data-uid"):null},e.prototype.getEditEvent=function(i,r,n){var a=this.getNodeData(i);return{cancel:!1,newText:r,node:i,nodeData:a,oldText:this.oldText,innerHtml:n}},e.prototype.getNodeObject=function(i){var r;if(m(i))return r;if(this.dataType===1)for(var n=0,a=this.treeData.length;n<a;n++){var o=ie(this.fields.id,this.treeData[n]);if(!m(this.treeData[n])&&!m(o)&&o.toString()===i)return this.treeData[n]}else return this.getChildNodeObject(this.treeData,this.fields,i);return r},e.prototype.getChildNodeObject=function(i,r,n){var a;if(m(i))return a;for(var o=0,l=i.length;o<l;o++){var h=ie(r.id,i[o]);if(i[o]&&h&&h.toString()===n)return i[o];if(typeof r.child=="string"&&!m(ie(r.child,i[o]))){var u=ie(r.child,i[o]);if(a=this.getChildNodeObject(u,this.getChildMapper(r),n),a!==void 0)break}else if(this.fields.dataSource instanceof ge&&!m(ie("child",i[o]))){var c="child";if(a=this.getChildNodeObject(ie(c,i[o]),this.getChildMapper(r),n),a!==void 0)break}else if(this.isChildObject()){var d="child",u=ie(d,i[o]);if(a=this.getChildNodeObject(u,this.getChildMapper(r),n),a!==void 0)break}}return a},e.prototype.setDragAndDrop=function(i){i&&!this.disabled?this.initializeDrag():this.destroyDrag()},e.prototype.initializeDrag=function(){var i=this,r,n=this;this.dragObj=new vI(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+Dr,enableTapHold:!0,tapHoldThreshold:100,helper:function(a){i.dragTarget=a.sender.target;var o=U(i.dragTarget,"."+Bs),l=U(i.dragTarget,"."+Dr);if(i.dragLi=U(i.dragTarget,"."+mt),i.fullRowSelect&&!l&&i.dragTarget.classList.contains(Mo)&&(l=i.dragTarget.nextElementSibling),!i.dragTarget||!a.element.isSameNode(o)||!l||i.dragTarget.classList.contains(Bs)||i.dragTarget.classList.contains(qt)||i.dragTarget.classList.contains(mt)||i.dragLi.classList.contains("e-disable"))return!1;var h=l.cloneNode(!0);if(m($("div."+Ui,h))){var u=n.createElement("div",{className:Ui+" "+ui});h.insertBefore(u,h.children[0])}var c=Zq+" "+Bs+" "+i.cssClass+" "+(i.enableRtl?Ek:"");r=n.createElement("div",{className:c}),r.appendChild(h);var d=i.selectedNodes.length;if(d>1&&i.allowMultiSelection&&i.dragLi.classList.contains(is)){var p=n.createElement("span",{className:eY,innerHTML:""+d});r.appendChild(p)}return document.body.appendChild(r),document.body.style.cursor="",i.dragData=i.getNodeData(i.dragLi),r},dragStart:function(a){Q([i.element],ux);var o=U(a.target,".e-list-item"),l;o&&(l=parseInt(o.getAttribute("aria-level"),10));var h=i.getDragEvent(a.event,i,null,a.target,null,r,l);h.draggedNode.classList.contains(hx)?(i.dragObj.intDestroy(a.event),i.dragCancelAction(r)):i.trigger("nodeDragStart",h,function(u){u.cancel?(i.dragObj.intDestroy(a.event),i.dragCancelAction(r)):i.dragStartAction=!0})},drag:function(a){i.dragObj.setProperties({cursorAt:{top:!m(a.event.targetTouches)||B.isDevice?60:-20}}),i.dragAction(a,r)},dragStop:function(a){te([i.element],ux),i.removeVirtualEle();var o=a.target,l=!1,h=U(o,"."+Tk);(!o||!h)&&(ne(a.helper),document.body.style.cursor="");var u=U(o,".e-list-item"),c;u&&(c=parseInt(u.getAttribute("aria-level"),10));var d=i.getDragEvent(a.event,i,o,o,null,a.helper,c);d.preventTargetExpand=l,i.trigger("nodeDragStop",d,function(p){i.dragParent=p.draggedParentNode,i.preventExpand=p.preventTargetExpand,p.cancel&&(a.helper.parentNode&&ne(a.helper),document.body.style.cursor=""),i.dragStartAction=!1})}}),this.dropObj=new rW(this.element,{out:function(a){!m(a)&&!a.target.classList.contains(yp)&&i.dropObj.dragData.default&&i.dropObj.dragData.default.helper.classList.contains(Bs)&&(document.body.style.cursor="not-allowed")},over:function(a){document.body.style.cursor=""},drop:function(a){i.dropAction(a)}})},e.prototype.dragCancelAction=function(i){ne(i),te([this.element],ux),this.dragStartAction=!1},e.prototype.dragAction=function(i,r){var n=U(i.target,"."+Tk),a=U(i.target,"."+Dr),o=$("div."+Ui,r);te([o],[Um,bp,cx,dx]),this.removeVirtualEle(),document.body.style.cursor="";var l=i.target.classList;if(this.fullRowSelect&&!a&&!m(l)&&l.contains(Mo)&&(a=i.target.nextElementSibling),n){var h=U(i.target,"."+mt),u=U(i.target,"."+ms),c=U(i.target,"."+Tr),d=U(i.target,"."+ui);if(!n.classList.contains(Bs)||a&&!h.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,h))if(this.hasTemplate&&h){var p=$(this.fullRowSelect?"."+Mo:"."+Dr,h);if(i&&!d&&!c&&i.event.offsetY<7&&!u||d&&i.event.offsetY<5||c&&i.event.offsetX<3){var f=this.fullRowSelect?1:0;this.appendIndicator(h,o,f)}else if(i&&!d&&!c&&!u&&p&&i.event.offsetY>p.offsetHeight-10||d&&i.event.offsetY>19||c&&i.event.offsetX>19){var f=this.fullRowSelect?2:1;this.appendIndicator(h,o,f)}else Q([o],Um)}else if(h&&i&&!d&&!c&&i.event.offsetY<7&&!u||d&&i.event.offsetY<5||c&&i.event.offsetX<3){var f=this.fullRowSelect?1:0;this.appendIndicator(h,o,f)}else if(h&&i&&!d&&!c&&i.target.offsetHeight>0&&i.event.offsetY>i.target.offsetHeight-10&&!u||d&&i.event.offsetY>19||c&&i.event.offsetX>19){var f=this.fullRowSelect?2:1;this.appendIndicator(h,o,f)}else Q([o],Um);else i.target.nodeName==="LI"&&!h.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,h)?(Q([o],bp),this.renderVirtualEle(i)):i.target.classList.contains(yp)?Q([o],bp):Q([o],cx)}else Q([o],dx),document.body.style.cursor="not-allowed";var v=U(i.target,".e-list-item"),g;v&&(g=parseInt(v.getAttribute("aria-level"),10));var b=this.getDragEvent(i.event,this,i.target,i.target,null,r,g);b.dropIndicator&&te([o],b.dropIndicator),this.trigger("nodeDragging",b),b.dropIndicator&&Q([o],b.dropIndicator)},e.prototype.appendIndicator=function(i,r,n){Q([r],bp);var a=this.createElement("div",{className:yp});i.insertBefore(a,i.children[n])},e.prototype.dropAction=function(i){var r=i.event.offsetY,n=i.target,a,o,l=!1,h,u=[],c=[];h=i.dragData.draggable;for(var d=0;d<h.ej2_instances.length;d++)if(h.ej2_instances[d]instanceof t){a=h.ej2_instances[d];break}if(a&&a.dragTarget){var p=a.dragTarget,f=U(p,"."+mt),v=U(n,"."+mt);if(c.push(f),v==null&&n.classList.contains(Bs)&&(v=n.firstElementChild),ne(i.droppedElement),document.body.style.cursor="",!v||v.isSameNode(f)||this.isDescendant(f,v)){this.fields.dataSource instanceof ge||(this.preventExpand=!1);return}if(a.allowMultiSelection&&f.classList.contains(is)){var g=ze("."+is,a.element);if(c=g,i.target.offsetHeight<=33&&r>i.target.offsetHeight-10&&r>6)for(var b=g.length-1;b>=0;b--)v.isSameNode(g[b])||this.isDescendant(g[b],v)||this.appendNode(n,g[b],v,i,a,r);else for(var y=0;y<g.length;y++)v.isSameNode(g[y])||this.isDescendant(g[y],v)||this.appendNode(n,g[y],v,i,a,r)}else this.appendNode(n,f,v,i,a,r);o=parseInt(f.getAttribute("aria-level"),10),l=!0}this.fields.dataSource instanceof ge||(this.preventExpand=!1);for(var C=0;C<c.length;C++)u.push(this.getNode(c[C]));this.trigger("nodeDropped",this.getDragEvent(i.event,a,n,i.target,i.dragData.draggedElement,null,o,l)),a.element.id!==this.element.id&&(a.triggerEvent("nodeDropped",u),this.isNodeDropped=!0,this.fields.dataSource=this.treeData),this.triggerEvent("nodeDropped",u)},e.prototype.appendNode=function(i,r,n,a,o,l){var h=U(i,"."+ms),u=U(a.target,"."+Tr),c=U(a.target,"."+ui);!r.classList.contains("e-disable")&&!h&&(c&&a.event.offsetY<5||u&&a.event.offsetX<3||c&&a.event.offsetY>19||u&&a.event.offsetX>19||!c&&!u)?i.nodeName==="LI"?this.dropAsSiblingNode(r,n,a,o):i.firstElementChild&&i.classList.contains(Bs)?i.firstElementChild.nodeName==="UL"&&this.dropAsSiblingNode(r,n,a,o):i.classList.contains("e-icon-collapsible")||i.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(r,n,a,o):this.dropAsChildNode(r,n,o,null,a,l):this.dropAsChildNode(r,n,o,null,a,l,!0),this.showCheckBox&&this.ensureIndeterminate()},e.prototype.dropAsSiblingNode=function(i,r,n,a){var o=U(r,"."+qt),l=U(i,"."+qt),h=U(l,"."+mt),u;if(n.target.offsetHeight>0&&n.event.offsetY>n.target.offsetHeight-2?u=!1:n.event.offsetY<2?u=!0:(n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible"))&&(n.event.offsetY<5||n.event.offsetX<3?u=!0:(n.event.offsetY>15||n.event.offsetX>17)&&(u=!1)),n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible")){var c=n.target.closest("li");o.insertBefore(i,u?c:c.nextElementSibling)}else o.insertBefore(i,u?n.target:n.target.nextElementSibling);this.moveData(i,r,o,u,a),this.updateElement(l,h),this.updateAriaLevel(i),a.element.id===this.element.id?this.updateList():(a.updateInstance(),this.updateInstance())},e.prototype.dropAsChildNode=function(i,r,n,a,o,l,h){var u=U(i,"."+qt),c=U(u,"."+mt),d=U(r,"."+qt),p;if(o&&o.target&&(p=$(this.fullRowSelect?"."+Mo:"."+Dr,r)),o&&l<7&&!h)d.insertBefore(i,r),this.moveData(i,r,d,!0,n);else if(o&&o.target.offsetHeight>0&&l>o.target.offsetHeight-10&&!h&&!this.hasTemplate)d.insertBefore(i,r.nextElementSibling),this.moveData(i,r,d,!1,n);else if(this.hasTemplate&&p&&l>p.offsetHeight-10&&!h)d.insertBefore(i,r.nextElementSibling),this.moveData(i,r,d,!1,n);else{var f=this.expandParent(r),v=f.childNodes[a];f.insertBefore(i,v),this.moveData(i,v,f,!0,n)}this.updateElement(u,c),this.updateAriaLevel(i),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},e.prototype.moveData=function(i,r,n,a,o){var l=U(n,"."+mt),h=this.getId(i),u=o.updateChildField(o.treeData,o.fields,h,null,null,!0),c=this.getId(r),d=this.getDataPos(this.treeData,this.fields,c),p=this.getId(l);if(this.dataType===1){this.updateField(this.treeData,this.fields,p,"hasChildren",!0);var f=m(d)?this.treeData.length:a?d:d+1;if(m(p)&&!this.hasPid)delete u[0][this.fields.parentID];else{var v=this.isNumberTypeId?parseFloat(p):p;kt(this.fields.parentID,v,u[0])}if(this.treeData.splice(f,0,u[0]),o.element.id!==this.element.id){var g=o.removeChildNodes(h);f++;for(var b=0,y=g.length;b<y;b++)this.treeData.splice(f,0,g[b]),f++;o.groupedData=o.getGroupedData(o.treeData,o.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,p,u,a?d:d+1)},e.prototype.expandParent=function(i){var r=$("div."+Ui,i);r&&r.classList.contains(ui)&&this.preventExpand!==!0&&this.expandAction(i,r,null);var n=$("."+qt,i);if(this.preventExpand===!0&&!n&&r&&this.renderChildNodes(i),n=$("."+qt,i),!m(n)&&this.preventExpand===!0&&(n.style.display="none"),!m(n)&&this.preventExpand===!1&&(n.style.display="block"),m(n)&&this.preventExpand===!0){m(r)&&Et.generateIcon(this.createElement,i,ui,this.listBaseOption);var a=$("div."+Ui,i);a&&a.classList.add("e-icon-expandable"),n=Et.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),a?te([a],Tr):Et.generateIcon(this.createElement,i,ui,this.listBaseOption),i.setAttribute("aria-expanded","false"),n.style.display="none"}if(m(n)){var o=this.expandArgs;(m(o)||o.name!="nodeExpanding")&&this.trigger("nodeExpanding",this.getExpandEvent(i,null)),m(r)&&Et.generateIcon(this.createElement,i,Tr,this.listBaseOption);var a=$("div."+Ui,i);a?te([a],ui):(Et.generateIcon(this.createElement,i,Tr,this.listBaseOption),a=$("div."+Ui,i),te([a],ui)),n=Et.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),this.addExpand(i),this.trigger("nodeExpanded",this.getExpandEvent(i,null))}return n},e.prototype.updateElement=function(i,r){if(r&&i.childElementCount===0){var n=$("div."+Ui,r);ne(i),ne(n);var a=this.getId(r);this.updateField(this.treeData,this.fields,a,"hasChildren",!1),this.removeExpand(r,!0)}},e.prototype.updateAriaLevel=function(i){var r=this.parents(i,"."+qt).length;i.setAttribute("aria-level",""+r),this.updateChildAriaLevel($("."+qt,i),r+1)},e.prototype.updateChildAriaLevel=function(i,r){if(!m(i))for(var n=i.childNodes,a=0,o=n.length;a<o;a++){var l=n[a];l.setAttribute("aria-level",""+r),this.updateChildAriaLevel($("."+qt,l),r+1)}},e.prototype.renderVirtualEle=function(i){var r;i.event.offsetY>i.target.offsetHeight-2?r=!1:i.event.offsetY<2&&(r=!0);var n=this.createElement("div",{className:yp}),a=this.fullRowSelect?r?1:2:r?0:1;i.target.insertBefore(n,i.target.children[a])},e.prototype.removeVirtualEle=function(){var i=$("."+yp);i&&ne(i)},e.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},e.prototype.getDragEvent=function(i,r,n,a,o,l,h,u){var c=n?U(n,"."+mt):null,d=c?this.getNodeData(c):null,p=r?r.dragLi:o,f=r?r.dragData:null,v=n?this.parents(n,"."+mt):null,g=r.dragLi.parentElement,b=r.dragLi?U(g,"."+mt):null,y=null,C=null,x=[bp,Um,cx,dx],w=null,M=u===!0?p:c,E=M?U(M,".e-list-parent"):null,T=0,D=null;if(b=r.dragLi&&b===null?U(g,"."+Bs):b,b=u===!0?this.dragParent:b,l)for(;T<4;){if($("."+Ui,l).classList.contains(x[T])){w=x[T];break}T++}if(E){var N=0;for(T=0;T<E.childElementCount;T++)if(N=u!==!0&&E.children[T]===p&&c!==p?++N:N,u!==!0&&E.children[T].classList.contains("e-hover")){C=i.offsetY>=23?T+1:T;break}else if(E.children[T]===M){C=(i.offsetY>=23,T);break}C=N!==0?--C:C,D=w=="e-drop-in"?"Inside":i.offsetY<7?"Before":"After"}if(n&&(v.length===0?y=null:n.classList.contains(mt)?y=v[0]:y=v[1]),c===p&&(y=c),n&&a.offsetHeight<=33&&i.offsetY<a.offsetHeight-10&&i.offsetY>6&&(y=c,u!==!0)){h=++h;var A=y?$(".e-list-parent",y):null;if(C=A?A.children.length:0,!(this.fields.dataSource instanceof ge)&&A===null&&y){var L=y.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,y.getAttribute("data-uid").toString()):null;C=L?L.length:0}}return{cancel:!1,clonedNode:l,event:i,draggedNode:p,draggedNodeData:f,droppedNode:c,droppedNodeData:d,dropIndex:C,dropLevel:h,draggedParentNode:b,dropTarget:y,dropIndicator:w,target:a,position:D}},e.prototype.addFullRow=function(i){var r=this.liList.length;if(i)for(var n=0;n<r;n++)this.createFullRow(this.liList[n]);else for(var n=0;n<r;n++){var a=$("."+Mo,this.liList[n]);ne(a)}},e.prototype.createFullRow=function(i){var r=this.createElement("div",{className:Mo});i.insertBefore(r,i.childNodes[0])},e.prototype.addMultiSelect=function(i){if(i)for(var r=ze("."+mt+':not([aria-selected="true"])',this.element),n=0,a=r;n<a.length;n++){var o=a[n];o.setAttribute("aria-selected","false")}else for(var r=ze("."+mt+'[aria-selected="false"]',this.element),l=0,h=r;l<h.length;l++){var o=h[l];o.removeAttribute("aria-selected")}},e.prototype.collapseByLevel=function(i,r,n){if(r>0&&!m(i))for(var a=this.getVisibleNodes(n,i.childNodes),o=0,l=a.length;o<l;o++){var h=a[o],u=$("."+Tr,$("."+Dr,h));m(u)||this.collapseNode(h,u,null),this.collapseByLevel($("."+qt,h),r-1,n)}},e.prototype.collapseAllNodes=function(i){for(var r=this.getVisibleNodes(i,ze("."+Tr,this.element)),n=0,a=r.length;n<a;n++){var o=r[n],l=U(o,"."+mt);this.collapseNode(l,o,null)}},e.prototype.expandByLevel=function(i,r,n){if(r>0&&!m(i))for(var a=this.getVisibleNodes(n,i.childNodes),o=0,l=a.length;o<l;o++){var h=a[o],u=$("."+ui,$("."+Dr,h));m(u)||this.expandAction(h,u,null),this.expandByLevel($("."+qt,h),r-1,n)}},e.prototype.expandAllNodes=function(i){for(var r=this.getVisibleNodes(i,ze("."+ui,this.element)),n=0,a=r.length;n<a;n++){var o=r[n],l=U(o,"."+mt);this.expandAction(l,o,null,!0)}},e.prototype.getVisibleNodes=function(i,r){var n=Array.prototype.slice.call(r);if(i)for(var a=0;a<n.length;a++)or(n[a])||(n.splice(a,1),a--);return n},e.prototype.removeNode=function(i){var r=U(i,"."+qt),n=U(r,"."+mt);m(this.nodeTemplateFn)||this.destroyTemplate(i),ne(i),this.updateElement(r,n),this.removeData(i)},e.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes()},e.prototype.updateList=function(){this.liList=Array.prototype.slice.call(ze("."+mt,this.element))},e.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var i=ze("."+is,this.element);this.selectGivenNodes(i)},e.prototype.updateExpandedNodes=function(){this.setProperties({expandedNodes:[]},!0);for(var i=ze('[aria-expanded="true"]',this.element),r=0,n=i.length;r<n;r++)this.addExpand(i[r])},e.prototype.removeData=function(i){if(this.dataType===1){var r=new ge(this.treeData),n=this.getId(i),a={},o=this.isNumberTypeId?parseFloat(n):n;a[this.fields.id]=o,r.remove(this.fields.id,a),this.removeChildNodes(n)}else{var n=this.getId(i);this.updateChildField(this.treeData,this.fields,n,null,null,!0)}},e.prototype.removeChildNodes=function(i){var r=this.getChildGroup(this.groupedData,i,!1),n=[];if(r)for(var a=0,o=r.length;a<o;a++){var l=new ge(this.treeData),h=ie(this.fields.id,r[a]).toString(),u={},c=this.isNumberTypeId?parseFloat(h):h;u[this.fields.id]=c;var d=l.remove(this.fields.id,u);n.push(d[0]),this.removeChildNodes(h)}return n},e.prototype.doGivenAction=function(i,r,n){for(var a=0,o=i.length;a<o;a++){var l=this.getElement(i[a]);if(!m(l)){var h=$("."+r,$("."+Dr,l));m(h)||(n?this.expandAction(l,h,null):this.collapseNode(l,h,null))}}},e.prototype.addGivenNodes=function(i,r,n,a,o){if(i.length!==0){var l=this.getSortedData(i),h=r?parseFloat(r.getAttribute("aria-level"))+1:1;a&&this.updateMapper(h);var u=Et.createListItemFromJson(this.createElement,l,this.listBaseOption,h),c=this.getId(r),d,p;m(r)||(p=$("div."+Ui,r)),this.dataType===1&&p&&p.classList.contains(ui)&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")&&(this.preventExpand=!0),this.dataType!==1&&(this.addChildData(this.treeData,this.fields,c,i,n),this.isFirstRender=!1);var f;if(o?f=o:f=r?this.expandParent(r):$("."+qt,this.element),d=f.childNodes[n],!this.isFirstRender||this.dataType===1){var v=this.expandArgs;if(d||this.sortOrder==="None"){for(var g=0;g<u.length;g++)f.insertBefore(u[g],d);if(this.dataType===1&&!m(r)&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var b=$("div."+Ui,r);b&&b.classList.contains(ui)&&(m(v)||v.name!="nodeExpanding")&&this.expandAction(r,b,null)}}if(!d&&(this.sortOrder==="Ascending"||this.sortOrder==="Descending"))if(f.childNodes.length===0){for(var g=0;g<u.length;g++)f.insertBefore(u[g],d);if(this.dataType===1&&!m(r)&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var b=$("div."+Ui,r);b&&b.classList.contains(ui)&&(m(v)||v.name!="nodeExpanding")&&this.expandAction(r,b,null)}}else for(var y=f.childNodes,g=0;g<u.length;g++)for(var C=0;C<y.length;C++){var x=this.sortOrder==="Ascending"?y[C].textContent.toUpperCase()>u[g].innerText.toUpperCase():y[C].textContent.toUpperCase()<u[g].innerText.toUpperCase();if(x){f.insertBefore(u[g],y[C]);break}f.insertBefore(u[g],y[y.length])}}if(this.dataType===1){this.updateField(this.treeData,this.fields,c,"hasChildren",!0);for(var w=this.getId(d),M=m(w)?this.treeData.length:this.getDataPos(this.treeData,this.fields,w),C=0;C<i.length;C++){if(!m(c)){var E=this.isNumberTypeId?parseFloat(c):c;kt(this.fields.parentID,E,i[C])}this.treeData.splice(M,0,i[C]),M++}}this.finalizeNode(f)}},e.prototype.updateMapper=function(i){var r=i===1?this.fields:this.getChildFields(this.fields,i-1,1);this.updateListProp(r)},e.prototype.updateListProp=function(i){var r=this.getActualProperties(i);this.listBaseOption.fields=r,this.listBaseOption.fields.url=r.hasOwnProperty("navigateUrl")?r.navigateUrl:"navigateUrl"},e.prototype.getDataPos=function(i,r,n){for(var a=null,o=0,l=i.length;o<l;o++){var h=ie(r.id,i[o]);if(i[o]&&h&&h.toString()===n)return o;if(typeof r.child=="string"&&!m(ie(r.child,i[o]))){var u=ie(r.child,i[o]);if(a=this.getDataPos(u,this.getChildMapper(r),n),a!==null)break}else if(this.fields.dataSource instanceof ge&&!m(ie("child",i[o]))){var c=ie("child",i[o]);if(a=this.getDataPos(c,this.getChildMapper(r),n),a!==null)break}}return a},e.prototype.addChildData=function(i,r,n,a,o){var l;if(m(n)){o=m(o)?i.length:o;for(var h=0,u=a.length;h<u;h++)i.splice(o,0,a[h]),o++;return l}for(var c=0,d=i.length;c<d;c++){var p=ie(r.id,i[c]);if(i[c]&&p&&p.toString()===n){if(typeof r.child=="string"&&i[c].hasOwnProperty(r.child)&&i[c][r.child]!==null||this.fields.dataSource instanceof ge&&i[c].hasOwnProperty("child")){var f=typeof r.child=="string"?r.child:"child",v=ie(f,i[c]);m(v)&&(v=[]),o=m(o)?v.length:o;for(var h=0,u=a.length;h<u;h++)v.splice(o,0,a[h]),o++}else{var f=typeof r.child=="string"?r.child:"child";i[c][f]=a}return!0}else if(typeof r.child=="string"&&!m(ie(r.child,i[c]))){var g=ie(r.child,i[c]);if(l=this.addChildData(g,this.getChildMapper(r),n,a,o),l!==void 0)break}else if(this.fields.dataSource instanceof ge&&!m(ie("child",i[c]))){var v=ie("child",i[c]);if(l=this.addChildData(v,this.getChildMapper(r),n,a,o),l!==void 0)break}}return l},e.prototype.doDisableAction=function(i){var r=this.nodeType(i),n=this.checkValidId(r);this.validArr=[];for(var a=0,o=n.length;a<o;a++){var l=n[a][this.fields.id].toString();l&&this.disableNode.indexOf(l)===-1&&this.disableNode.push(l);var h=this.getElement(l);h&&(h.setAttribute("aria-disabled","true"),Q([h],Ak))}},e.prototype.doEnableAction=function(i){for(var r=this.nodeType(i),n=0,a=r.length;n<a;n++){var o=this.getElement(r[n]),l=r[n];l&&this.disableNode.indexOf(l)!==-1&&this.disableNode.splice(this.disableNode.indexOf(l),1),o&&(o.removeAttribute("aria-disabled"),te([o],Ak))}},e.prototype.nodeType=function(i){for(var r=[],n=0,a=i.length;n<a;n++){var o=void 0;typeof i[n]=="string"?o=i[n]?i[n].toString():null:typeof i[n]=="object"&&(o=i[n]?i[n].getAttribute("data-uid").toString():null),r.indexOf(o)==-1&&r.push(o)}return r},e.prototype.checkValidId=function(i){var r=this;if(this.dataType===1)this.validArr=this.treeData.filter(function(l){return i.indexOf(l[r.fields.id]?l[r.fields.id].toString():null)!==-1});else if(this.dataType===2)for(var n=0;n<this.treeData.length;n++){var a=this.treeData[n][this.fields.id]?this.treeData[n][this.fields.id].toString():null;i.indexOf(a)!==-1&&this.validArr.push(this.treeData[n]);var o=ie(this.fields.child.toString(),this.treeData[n]);o&&this.filterNestedChild(o,i)}return this.validArr},e.prototype.filterNestedChild=function(i,r){for(var n=0;n<i.length;n++){var a=i[n][this.fields.id]?i[n][this.fields.id].toString():null;r.indexOf(a)!==-1&&this.validArr.push(i[n]);var o=ie(this.fields.child.toString(),i[n]);o&&this.filterNestedChild(o,r)}},e.prototype.setTouchClass=function(){var i=U(this.element,"."+rY);this.touchClass=m(i)?"":nY},e.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var i=this.selectedNodes,r=0,n=i.length;r<n;r++)this.updateField(this.treeData,this.fields,i[r],"selected",!0);for(var a=this.expandedNodes,o=0,l=a.length;o<l;o++)this.updateField(this.treeData,this.fields,a[o],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);for(var h=this.checkedNodes,u=0,l=h.length;u<l;u++)this.updateField(this.treeData,this.fields,h[u],"isChecked",!0)}},e.prototype.removeField=function(i,r,n){if(!(m(i)||m(r)))for(var a=0,o=i.length;a<o;a++){for(var l=0;l<n.length;l++){var h=this.getMapperProp(r,n[l]);m(i[a][h])||delete i[a][h]}typeof r.child=="string"&&!m(ie(r.child,i[a]))?this.removeField(ie(r.child,i[a]),this.getChildMapper(r),n):this.fields.dataSource instanceof ge&&!m(ie("child",i[a]))&&this.removeField(ie("child",i[a]),this.getChildMapper(r),n)}},e.prototype.getMapperProp=function(i,r){switch(r){case"selected":return m(i.selected)?"selected":i.selected;case"expanded":return m(i.expanded)?"expanded":i.expanded;case"isChecked":return m(i.isChecked)?"isChecked":i.isChecked;case"hasChildren":return m(i.hasChildren)?"hasChildren":i.hasChildren;default:return r}},e.prototype.updateField=function(i,r,n,a,o){if(!m(n))if(this.dataType===1){var l=this.isNumberTypeId?parseFloat(n):n,h=new ge(this.treeData).executeLocal(new $e().where(r.id,"equal",l,!1));kt(this.getMapperProp(r,a),o,h[0])}else this.updateChildField(i,r,n,a,o)},e.prototype.updateChildField=function(i,r,n,a,o,l){var h;if(m(i))return h;for(var u=0,c=i.length;u<c;u++){var d=ie(r.id,i[u]);if(i[u]&&d&&d.toString()===n)return l?h=i.splice(u,1):(kt(this.getMapperProp(r,a),o,i[u]),h=[]),h;if(typeof r.child=="string"&&!m(ie(r.child,i[u]))){var p=ie(r.child,i[u]);if(h=this.updateChildField(p,this.getChildMapper(r),n,a,o,l),h!==void 0)break}else if(this.fields.dataSource instanceof ge&&!m(ie("child",i[u]))){var f=ie("child",i[u]);if(h=this.updateChildField(f,this.getChildMapper(r),n,a,o,l),h!==void 0)break}}return h},e.prototype.triggerEvent=function(i,r){if(this.renderReactTemplates(),i==="addNodes"){for(var n=[],a=0;a<r.length;a++)n.push(this.getNode(this.getElement(m(r[a][this.fields.id])?ie(this.fields.id,r[a]).toString():null)));r=n}var o={data:this.treeData,action:i,nodeData:r};this.trigger("dataSourceChanged",o)},e.prototype.wireInputEvents=function(i){I.add(i,"blur",this.inputFocusOut,this)},e.prototype.wireEditingEvents=function(i){var r=this;if(i&&!this.disabled){var n=this;this.touchEditObj=new Pn(this.element,{tap:function(a){r.isDoubleTapped(a)&&a.tapCount===2&&(a.originalEvent.preventDefault(),n.editingHandler(a.originalEvent))}})}else this.touchEditObj&&this.touchEditObj.destroy()},e.prototype.wireClickEvent=function(i){if(i){var r=this;this.touchClickObj=new Pn(this.element,{tap:function(n){r.clickHandler(n)}})}else this.touchClickObj&&this.touchClickObj.destroy()},e.prototype.wireExpandOnEvent=function(i){var r=this;if(i){var n=this;this.touchExpandObj=new Pn(this.element,{tap:function(a){(r.expandOnType==="Click"||r.expandOnType==="DblClick"&&r.isDoubleTapped(a)&&a.tapCount===2)&&a.originalEvent.which!==3&&n.expandHandler(a)}})}else this.touchExpandObj&&this.touchExpandObj.destroy()},e.prototype.mouseDownHandler=function(i){this.mouseDownStatus=!0,(i.shiftKey||i.ctrlKey)&&i.preventDefault(),i.ctrlKey&&this.allowMultiSelection&&I.add(this.element,"contextmenu",this.preventContextMenu,this)},e.prototype.preventContextMenu=function(i){i.preventDefault()},e.prototype.wireEvents=function(){I.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.expandOnType!=="None"&&this.wireExpandOnEvent(!0),I.add(this.element,"mouseover",this.onMouseOver,this),I.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new wr(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},e.prototype.unWireEvents=function(){I.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),I.remove(this.element,"mouseover",this.onMouseOver),I.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},e.prototype.parents=function(i,r){for(var n=[],a=i.parentNode;!m(a);)fI(a,r)&&n.push(a),a=a.parentNode;return n},e.prototype.isDoubleTapped=function(i){var r=i.originalEvent.target,n;return r&&i.tapCount&&(i.tapCount===1?this.firstTap=U(r,"."+mt):i.tapCount===2&&(n=U(r,"."+mt))),this.firstTap===n},e.prototype.isDescendant=function(i,r){for(var n=r.parentNode;!m(n);){if(n===i)return!0;n=n.parentNode}return!1},e.prototype.showSpinner=function(i){Q([i],lx),Nd({target:i,width:B.isDevice?16:14},this.createElement),Ol(i)},e.prototype.hideSpinner=function(i){kd(i),i.innerHTML="",te([i],lx)},e.prototype.setCheckedNodes=function(i){i=JSON.parse(JSON.stringify(i)),this.uncheckAll(this.checkedNodes),this.setIndeterminate(i),i.length>0&&this.checkAll(i)},e.prototype.setValidCheckedNode=function(i){if(this.dataType===1){var r=this.fields,n=new ge(this.treeData).executeLocal(new $e().where(r.id,"equal",i,!0));if(n[0]&&(this.setChildCheckState(n,i,n[0]),this.autoCheck)){for(var a=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null,o=this.getChildNodes(this.treeData,a),l=0,h=0;h<o.length;h++){var u=o[h][this.fields.id].toString();this.checkedNodes.indexOf(u)!==-1&&l++}l===o.length&&this.checkedNodes.indexOf(a)===-1&&a&&this.checkedNodes.push(a)}}else if(this.dataType===2)for(var c=0;c<this.treeData.length;c++){var d=this.treeData[c][this.fields.id]?this.treeData[c][this.fields.id].toString():"";if(d===i&&this.checkedNodes.indexOf(i)===-1){this.checkedNodes.push(i);break}var p=ie(this.fields.child.toString(),this.treeData[c]);p&&this.setChildCheckState(p,i,this.treeData[c])}},e.prototype.setChildCheckState=function(i,r,n){var a,o=0;if(this.dataType===1){n&&(a=n[this.fields.id]?n[this.fields.id].toString():null);for(var l=0;l<i.length;l++){var h=i[l][this.fields.id]?i[l][this.fields.id].toString():null;n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(h)===-1&&this.checkedNodes.push(h),h===r&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r);var u=this.getChildNodes(this.treeData,h);u&&this.setChildCheckState(u,r,n)}}else{n&&(a=n[this.fields.id]?n[this.fields.id].toString():"");for(var l=0;l<i.length;l++){var c=i[l][this.fields.id]?i[l][this.fields.id].toString():"";n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(c)===-1&&this.checkedNodes.push(c),c===r&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r);var u=ie(this.fields.child.toString(),i[l]);u&&this.setChildCheckState(u,r,i[l]),this.checkedNodes.indexOf(c)!==-1&&this.autoCheck&&o++,o===i.length&&this.checkedNodes.indexOf(a)===-1&&this.autoCheck&&this.checkedNodes.push(a)}}},e.prototype.setIndeterminate=function(i){for(var r=0;r<i.length;r++)this.setValidCheckedNode(i[r])},e.prototype.updatePosition=function(i,r,n,a){if(this.dataType===1){var o=this.getDataPos(this.treeData,this.fields,i);if(this.treeData.splice(o,1,r),n){this.removeChildNodes(i);for(var l=0;l<a.length;l++)this.treeData.splice(o,0,a[l]),o++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,i,[r],void 0)},e.prototype.updateChildPosition=function(i,r,n,a,o){for(var l,h=0,u=i.length;h<u;h++){var c=ie(r.id,i[h]);if(i[h]&&c&&c.toString()===n)return i[h]=a[0],!0;if(typeof r.child=="string"&&!m(ie(r.child,i[h]))){var d=ie(r.child,i[h]);if(l=this.updateChildPosition(d,this.getChildMapper(r),n,a,o),l!==void 0)break}else if(this.fields.dataSource instanceof ge&&!m(ie("child",i[h]))){var p=ie("child",i[h]);if(l=this.updateChildPosition(p,this.getChildMapper(r),n,a,o),l!==void 0)break}}return l},e.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},e.prototype.crudOperation=function(i,r,n,a,o,l,h){var u=this,c=this.fields.dataSource,d=[],p=this.getQuery(this.fields),f=this.fields.id,v,g={addedRecords:[],deletedRecords:[],changedRecords:[]},b=[];r?b=this.nodeType(r):n&&(typeof n=="string"?b[0]=n.toString():typeof n=="object"&&(b[0]=n.getAttribute("data-uid").toString()));for(var y=0,C=b.length;y<C;y++){var x=this.getElement(b[y]);if(!m(x)){var w=this.getNodeObject(b[y]);d.push(w)}}switch(i){case"delete":r.length==1?v=c.remove(f,d[0],p.fromTable,p):(g.deletedRecords=d,v=c.saveChanges(g,f,p.fromTable,p)),v.then(function(E){return u.deleteSuccess(b)}).catch(function(E){return u.dmFailure(E)});break;case"update":d[0][this.fields.text]=a,v=c.update(f,d[0],p.fromTable,p),v.then(function(E){return u.editSucess(n,a,h)}).catch(function(E){return u.dmFailure(E,n,h)});break;case"insert":if(o.length==1)v=c.insert(o[0],p.fromTable,p);else{for(var M=[],y=0,C=o.length;y<C;y++)M.push(o[y]);g.addedRecords=M,v=c.saveChanges(g,f,p.fromTable,p)}v.then(function(E){var T=u.getElement(n);u.addSuccess(o,T,l),u.preventExpand=!1}).catch(function(E){return u.dmFailure(E)});break}},e.prototype.deleteSuccess=function(i){for(var r=[],n=0,a=i.length;n<a;n++){var o=this.getElement(i[n]);r.push(this.getNode(o)),!m(o)&&this.removeNode(o)}this.updateInstance(),this.dataType===1&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent("removeNode",r)},e.prototype.editSucess=function(i,r,n){var a=this.getElement(i),o=$("."+Sh,a);this.appendNewText(a,o,r,n)},e.prototype.addSuccess=function(i,r,n){var a,o=r?r.querySelector("."+Ui):null,l=this;r&&o&&o.classList.contains(ui)&&r.querySelector("."+qt)===null?l.renderChildNodes(r,null,function(){a=r.querySelector("."+qt),l.addGivenNodes(i,r,n,!0,a),l.triggerEvent("addNodes",i)}):(this.addGivenNodes(i,r,n,!0),this.triggerEvent("addNodes",i))},e.prototype.dmFailure=function(i,r,n){r&&this.updatePreviousText(r,n),this.trigger("actionFailure",{error:i})},e.prototype.updatePreviousText=function(i,r){var n=this.getElement(i),a=$("."+Sh,n);this.updateText(n,a,this.oldText,r)},e.prototype.getHierarchicalParentId=function(i,r,n){var a=this,o=r.findIndex(function(u){return u[a.fields.id]&&u[a.fields.id].toString()===i});if(o==-1)for(var l=0;l<r.length;l++){var h=ie(this.fields.child.toString(),r[l]);if(!m(h))if(o=h.findIndex(function(u){return u[a.fields.id]&&u[a.fields.id].toString()===i}),o==-1)this.getHierarchicalParentId(i,h,n);else{n.push(r[l][this.fields.id].toString()),this.getHierarchicalParentId(r[l][this.fields.id].toString(),this.treeData,n);break}}return n},e.prototype.onPropertyChanged=function(i,r){for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];switch(o){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var l=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(l,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"allowTextWrap":this.setTextWrap(),this.updateWrap();break;case"checkedNodes":this.showCheckBox&&(this.checkedNodes=r.checkedNodes,this.setCheckedNodes(i.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=i.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(r.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.setProperties({expandedNodes:m(i.expandedNodes)?[]:i.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.expandOnType!=="None"&&!this.disabled&&this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,(!this.isReact||this.isReact&&!(this.fields.dataSource instanceof ge))&&this.reRenderNodes(),this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect),this.allowTextWrap&&(this.setTextWrap(),this.updateWrap());break;case"loadOnDemand":if(this.loadOnDemand===!1&&!this.onLoaded){for(var h=this.element.querySelectorAll("li"),u=0;u<h.length;)h[u].getAttribute("aria-expanded")!=="true"&&this.renderChildNodes(h[u],!0,null,!0),u++;this.onLoaded=!0}break;case"nodeTemplate":this.hasTemplate=!1,this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:i.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":this.reRenderNodes();break;case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:i.fullRowNavigable},!0),this.listBaseOption.itemNavigable=i.fullRowNavigable,this.reRenderNodes();break}}},e.prototype.destroy=function(){this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),this.ulElement=null,this.liList=null,this.startNode=null,this.firstTap=null,this.expandArgs=null,this.dragLi=null,this.dragTarget=null,this.dragParent=null,this.dragObj=null,this.dropObj=null,this.inputObj=null,this.touchEditObj=null,this.touchExpandObj=null,this.touchClickObj=null,s.prototype.destroy.call(this)},e.prototype.addNodes=function(i,r,n,a){if(!m(i)){i=JSON.parse(JSON.stringify(i));var o=this.getElement(r);if(this.preventExpand=a,this.fields.dataSource instanceof ge)this.isOffline?this.addSuccess(i,o,n):this.crudOperation("insert",null,r,null,i,n,this.preventExpand);else if(this.dataType===2)this.addGivenNodes(i,o,n);else{if(o)this.addGivenNodes(i,o,n);else{i=this.getSortedData(i);for(var l=0;l<i.length;l++){var h=ie(this.fields.parentID,i[l]);o=h&&this.getElement(h.toString()),this.addGivenNodes([i[l]],o,n)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}this.updateCheckedStateFromDS(),this.showCheckBox&&o&&this.ensureParentCheckState(o),this.fields.dataSource instanceof ge||(this.preventExpand=!1,this.triggerEvent("addNodes",i))}},e.prototype.beginEdit=function(i){var r=this.getElement(i);m(r)||this.disabled||this.createTextbox(r,null)},e.prototype.checkAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!0)},e.prototype.collapseAll=function(i,r,n){m(i)?r>0?this.collapseByLevel($("."+qt,this.element),r,n):this.collapseAllNodes(n):this.doGivenAction(i,Tr,!1)},e.prototype.disableNodes=function(i){m(i)||this.doDisableAction(i)},e.prototype.enableNodes=function(i){m(i)||this.doEnableAction(i)},e.prototype.ensureVisible=function(i){var r=[];if(this.dataType==1)for(var n=this.getTreeData(i);n.length!=0&&!m(n[0][this.fields.parentID]);)r.push(n[0][this.fields.parentID].toString()),n=this.getTreeData(n[0][this.fields.parentID].toString());else this.dataType==2&&(r=this.getHierarchicalParentId(i,this.treeData,r));this.expandAll(r.reverse());var a=this.getElement(i);if(!m(a)){if(typeof i=="object"){var o=this.parents(a,"."+mt);this.expandAll(o)}setTimeout(function(){a.scrollIntoView({behavior:"smooth"})},450)}},e.prototype.expandAll=function(i,r,n){m(i)?r>0?this.expandByLevel($("."+qt,this.element),r,n):this.expandAllNodes(n):this.doGivenAction(i,ui,!0)},e.prototype.getAllCheckedNodes=function(){var i=this.checkedNodes;return i},e.prototype.getDisabledNodes=function(){var i=this.disableNode;return i},e.prototype.getNode=function(i){var r=this.getElement(i);return this.getNodeData(r,!0)},e.prototype.getTreeData=function(i){var r=this.getId(i);if(this.updatePersistProp(),m(r))return this.treeData;var n=this.getNodeObject(r);return m(n)?[]:[n]},e.prototype.moveNodes=function(i,r,n,a){var o=this.getElement(r),l=[];if(!m(o)){for(var h=0;h<i.length;h++){var u=this.getElement(i[h]);l.push(this.getNode(u)),!(m(u)||o.isSameNode(u)||this.isDescendant(u,o))&&(this.preventExpand=a,this.dropAsChildNode(u,o,this,n))}this.fields.dataSource instanceof ge||(this.preventExpand=!1),this.triggerEvent("moveNodes",l)}},e.prototype.refreshNode=function(i,r){if(!(m(i)||m(r))){var n,a=!1;if(this.dataType==1&&r.length>1)a=!0;else if(this.dataType==2&&r.length===1){var o=ie(this.fields.child.toString(),r[0]);m(o)||(a=!0)}var l=this.getElement(i);n=l?l.getAttribute("data-uid"):i?i.toString():null,this.refreshData=this.getNodeObject(n),r=JSON.parse(JSON.stringify(r));var h,u;if(this.dataType==1&&a){for(var c=0;c<r.length;c++)if(m(r[c][this.fields.parentID])){u=r[c],r.splice(c,1);break}h=me({},this.refreshData,u)}else h=me({},this.refreshData,r[0]);if(m(l)){this.updatePosition(n,h,a,r);return}this.isRefreshed=!0;var d=parseFloat(l.getAttribute("aria-level")),p=Et.createListItemFromJson(this.createElement,[h],this.listBaseOption,d),f=$("."+qt,l),v=ie(this.fields.child.toString(),h);if(a&&f||a&&!m(v)){var g=l.parentElement,b=Array.prototype.indexOf.call(g.childNodes,l);pt(l),g.insertBefore(p[0],g.childNodes[b]),this.updatePosition(n,h,a,r),a&&f&&this.expandAll([n])}else{var y=$("."+Dr,l),C=$("."+Dr,p[0]),x=$("div."+Ui,y),w=$("div."+Ui,C);x&&w&&(w.classList.contains(ui)&&x.classList.contains(Tr)?(te([w],ui),Q([w],Tr)):w.classList.contains(Tr)&&x.classList.contains(ui)?(te([w],Tr),Q([w],ui)):x.classList.contains("interaction")&&Q([w],"interaction")),pt(y);var M=$("."+Mo,l);M.parentNode.insertBefore(C,M.nextSibling),this.updatePosition(n,h,a,r)}if(l=this.getElement(i),h[this.fields.tooltip]&&l.setAttribute("title",h[this.fields.tooltip]),h.hasOwnProperty(this.fields.htmlAttributes)&&h[this.fields.htmlAttributes]){var E={};bt(E,h[this.fields.htmlAttributes]),E.class?(Q([l],E.class.split(" ")),delete E.class):De(l,E)}this.selectedNodes.indexOf(n)!==-1&&(l.setAttribute("aria-selected","true"),Q([l],is)),this.isRefreshed=!1,this.triggerEvent("refreshNode",[this.getNode(l)])}},e.prototype.removeNodes=function(i){m(i)||(this.fields.dataSource instanceof ge&&!this.isOffline?this.crudOperation("delete",i):this.deleteSuccess(i))},e.prototype.updateNode=function(i,r){var n=this;if(!(m(i)||m(r)||!this.allowEditing)){var a=this.getElement(i);if(!m(a)){var o=$("."+Sh,a);this.updateOldText(a);var l=this.getEditEvent(a,null,null);this.trigger("nodeEditing",l,function(h){h.cancel||(n.fields.dataSource instanceof ge&&!n.isOffline?n.crudOperation("update",null,i,r,null,null,!1):n.appendNewText(a,o,r,!1))})}}},e.prototype.uncheckAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!1)};var t;return et([S(!1)],e.prototype,"allowDragAndDrop",void 0),et([S(!1)],e.prototype,"allowEditing",void 0),et([S(!1)],e.prototype,"allowMultiSelection",void 0),et([S(!1)],e.prototype,"allowTextWrap",void 0),et([Ee({},oY)],e.prototype,"animation",void 0),et([S()],e.prototype,"checkedNodes",void 0),et([S("")],e.prototype,"cssClass",void 0),et([S(!1)],e.prototype,"disabled",void 0),et([S(null)],e.prototype,"dragArea",void 0),et([S(!1)],e.prototype,"enableHtmlSanitizer",void 0),et([S(!1)],e.prototype,"enablePersistence",void 0),et([S()],e.prototype,"expandedNodes",void 0),et([S("Auto")],e.prototype,"expandOn",void 0),et([Ee({},aY)],e.prototype,"fields",void 0),et([S(!0)],e.prototype,"fullRowSelect",void 0),et([S(!0)],e.prototype,"loadOnDemand",void 0),et([S()],e.prototype,"locale",void 0),et([S()],e.prototype,"nodeTemplate",void 0),et([S()],e.prototype,"selectedNodes",void 0),et([S("None")],e.prototype,"sortOrder",void 0),et([S(!1)],e.prototype,"showCheckBox",void 0),et([S(!0)],e.prototype,"autoCheck",void 0),et([S(!1)],e.prototype,"fullRowNavigable",void 0),et([_()],e.prototype,"actionFailure",void 0),et([_()],e.prototype,"created",void 0),et([_()],e.prototype,"dataBound",void 0),et([_()],e.prototype,"dataSourceChanged",void 0),et([_()],e.prototype,"drawNode",void 0),et([_()],e.prototype,"destroyed",void 0),et([_()],e.prototype,"keyPress",void 0),et([_()],e.prototype,"nodeChecked",void 0),et([_()],e.prototype,"nodeChecking",void 0),et([_()],e.prototype,"nodeClicked",void 0),et([_()],e.prototype,"nodeCollapsed",void 0),et([_()],e.prototype,"nodeCollapsing",void 0),et([_()],e.prototype,"nodeDragging",void 0),et([_()],e.prototype,"nodeDragStart",void 0),et([_()],e.prototype,"nodeDragStop",void 0),et([_()],e.prototype,"nodeDropped",void 0),et([_()],e.prototype,"nodeEdited",void 0),et([_()],e.prototype,"nodeEditing",void 0),et([_()],e.prototype,"nodeExpanded",void 0),et([_()],e.prototype,"nodeExpanding",void 0),et([_()],e.prototype,"nodeSelected",void 0),et([_()],e.prototype,"nodeSelecting",void 0),e=t=et([Ot],e),e}(Pi),lY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Gf,this.initiateHyperlinkHandler,this),this.parent.on($f,this.editHyperlinkHandler,this),this.parent.on(Q1,this.openHyperlinkHandler,this),this.parent.on(hu,this.hyperlinkClickHandler,this),this.parent.on(G1,this.createHyperlinkEle,this),this.parent.on(Xn,this.keyUpHandler,this),this.parent.on(Mg,this.removeHyperlink,this),this.parent.on(Xf,this.removeHyperlinkHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Gf,this.initiateHyperlinkHandler),this.parent.off($f,this.editHyperlinkHandler),this.parent.off(Q1,this.openHyperlinkHandler),this.parent.off(hu,this.hyperlinkClickHandler),this.parent.off(G1,this.createHyperlinkEle),this.parent.off(Xn,this.keyUpHandler),this.parent.off(Mg,this.removeHyperlink),this.parent.off(Xf,this.removeHyperlinkHandler))},s.prototype.getModuleName=function(){return"spreadsheetHyperlink"},s.prototype.keyUpHandler=function(e){var t=e.target;if(U(t,".e-document")){var i=document.querySelector(".e-hyp-text"),r=this.parent.element.querySelector(".e-hyperlink-alert-span"),n=U(t,".e-hyperlink-dlg")||U(t,".e-edithyperlink-dlg"),a=n.getElementsByClassName("e-footer-content")[0],o=a.firstChild;i&&!m(i.value)&&(ur(i.value.toUpperCase())?r&&(r.remove(),o.removeAttribute("disabled")):(this.showDialog(),o.setAttribute("disabled","true")))}if(t.classList.contains("e-text")&&U(t,".e-cont")&&U(t,".e-webpage")&&U(t,".e-webpage").getElementsByClassName("e-cont")[1]===t.parentElement){var l=U(t,".e-hyperlink-dlg")||U(t,".e-edithyperlink-dlg"),h=l.getElementsByClassName("e-footer-content")[0],o=h.firstChild;if(t.value!=="")o.removeAttribute("disabled");else{var u=U(t,".e-link-dialog"),c=u.querySelector(".e-webpage"),d=!!c.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;d||o.setAttribute("disabled","true")}}},s.prototype.initiateHyperlinkHandler=function(){var e=this,t=this.parent.getActiveSheet();if(t.isProtected&&(!t.protectSettings.insertLink||ah(this.parent))){this.parent.notify(Ta,null);return}var i=this.parent.serviceLocator.getService(de);if(!this.parent.element.querySelector(".e-hyperlink-dlg")){var r=this.parent.serviceLocator.getService(At),n;r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-hyperlink-dlg",header:i.getConstant("InsertLink"),beforeOpen:function(a){var o={dialogName:"InsertLinkDialog",element:a.element,target:a.target,cancel:a.cancel};if(e.parent.trigger("dialogBeforeOpen",o),o.cancel){a.cancel=!0;return}r.dialogInstance.content=e.hyperlinkContent(),n=r.dialogInstance.content.querySelector(".e-text").value,r.dialogInstance.dataBind(),Fe(e.parent.element)},open:function(){setTimeout(function(){Fe(r.dialogInstance.element.querySelectorAll(".e-webpage input")[1])})},buttons:[{buttonModel:{content:i.getConstant("Insert"),isPrimary:!0,disabled:!0},click:function(){e.dlgClickHandler(n),r.hide()}}]})}},s.prototype.dlgClickHandler=function(e){var t,i,r=this.parent.getActiveSheet(),n=r.name+"!"+r.selectedRange,a=this.parent.element.querySelector(".e-link-dialog").getElementsByClassName("e-content")[0].querySelector(".e-item.e-active");if(a)if(t=a.getElementsByClassName("e-cont")[0].querySelector(".e-text").value,t===e&&(t=null),a.querySelector(".e-webpage")){i=a.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var o={address:i};this.parent.insertHyperlink(o,n,t,!1)}else{i=a.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var l=a.getElementsByClassName("e-cont")[2];if(l.getElementsByClassName("e-list-item")[0].querySelector(".e-active")){var h=a.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent;i=h+"!"+i.toUpperCase();var o={address:i};this.parent.insertHyperlink(o,n,t,!1)}else if(l.querySelector(".e-active")){for(var u=a.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent,c=0;c<this.parent.definedNames.length;c++)if(this.parent.definedNames[c].name===u){var o={address:this.parent.definedNames[c].name};this.parent.insertHyperlink(o,n,t,!1)}}}},s.prototype.showDialog=function(){this.parent.element.querySelector(".e-hyperlink-alert-span")&&this.parent.element.querySelector(".e-hyperlink-alert-span").remove();var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("span",{className:"e-hyperlink-alert-span"});t.innerText=e.getConstant("HyperlinkAlert");var i=this.parent.element.querySelector(".e-hyperlink-dlg")||this.parent.element.querySelector(".e-edithyperlink-dlg");i.querySelector(".e-dlg-content").appendChild(t)},s.prototype.editHyperlinkHandler=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At),r;i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-edithyperlink-dlg",header:t.getConstant("EditLink"),beforeOpen:function(n){var a={dialogName:"EditLinkDialog",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel&&(n.cancel=!0),i.dialogInstance.content=e.hyperEditContent(),r=i.dialogInstance.content.querySelector(".e-text").value,i.dialogInstance.dataBind(),Fe(e.parent.element)},open:function(){setTimeout(function(){i.dialogInstance.element.querySelector(".e-webpage")?Fe(i.dialogInstance.element.querySelectorAll(".e-webpage input")[1]):Fe(i.dialogInstance.element.querySelectorAll(".e-document input")[1])})},buttons:[{buttonModel:{content:t.getConstant("Update"),isPrimary:!0},click:function(){e.dlgClickHandler(r),i.hide()}}]})},s.prototype.openHyperlinkHandler=function(){var e=xe(this.parent.getActiveSheet().activeCell),t=this.parent.getCell(e[0],e[1]);t.getElementsByClassName("e-hyperlink")[0]&&(t=t.querySelector(".e-hyperlink")),this.hlOpenHandler(t)},s.prototype.hlOpenHandler=function(e,t){var i=this;if(e.classList.contains("e-hyperlink")){var r=U(e,".e-cell");if(!r)return;var n=["",""],a=void 0,o=!0,l=this.parent.getActiveSheet(),h=parseInt(r.getAttribute("aria-colindex"),10)-1,u=parseInt(r.parentElement.getAttribute("aria-rowindex"),10)-1,c=Y(u,h,l,!1,!0);c.style&&c.style.color==="#00e"&&(Tn(this.parent,l,{rowIdx:u,colIdx:h,preventEvt:!0,cell:{style:{color:"#551a8b"}}}),r.style.color="#551a8b");var d=c.hyperlink,p=void 0,f={hyperlink:d,address:l.activeCell,target:"_blank",cancel:!1};if(this.parent.trigger(JW,f),f.cancel)return;d=f.hyperlink;var v={hyperlink:d,address:l.activeCell};typeof d=="string"&&(p=d),typeof d=="object"&&(p=d.address);var g=p;if(p.indexOf("http://")===-1&&p.indexOf("https://")===-1&&p.indexOf("ftp://")===-1){if(!m(p)){if(this.parent.definedNames){for(var b=0;b<this.parent.definedNames.length;b++)if(this.parent.definedNames[b].name===p){p=this.parent.definedNames[b].refersTo,p=p.slice(1);break}}p.indexOf("!")!==-1?(n=p.split("!"),n[0].indexOf(" ")!==-1&&(n[0]=n[0].slice(1,n[0].length-1))):(n[0]=this.parent.getActiveSheet().name,n[1]=p);for(var y,b=0;b<this.parent.sheets.length;b++)this.parent.sheets[b].name===n[0]&&(y=b);if(l=this.parent.sheets[y],n[1].indexOf(":")!==-1){var C=n[1].indexOf(":"),x=n[1].substr(0,C),w=n[1].substr(C+1,n[1].length);x=x.replace("$",""),w=w.replace("$",""),w.match(/\D/g)&&!w.match(/[0-9]/g)&&x.match(/\D/g)&&!x.match(/[0-9]/g)?(x=x+"1",w=w+l.rowCount,n[1]=x+":"+w):!w.match(/\D/g)&&w.match(/[0-9]/g)&&!x.match(/\D/g)&&x.match(/[0-9]/g)&&(a=[parseInt(x,10)-1,0,parseInt(w,10)-1,l.colCount-1],o=!1)}var M=void 0,E=this.parent.definedNames;if(!m(E)){for(var b=0;b<E.length;b++)if(E[b].name===g){M=!0;break}}if(ur(n[1])||M){if(a=o?ee(n[1]):a,this.parent.scrollSettings.enableVirtualization&&(a[0]=a[0]>=this.parent.viewport.topIndex?a[0]-this.parent.viewport.topIndex:a[0],a[1]=a[1]>=this.parent.viewport.leftIndex?a[1]-this.parent.viewport.leftIndex:a[1]),!m(l)){var T=je(a);if(l===this.parent.getActiveSheet())Vi(function(){i.parent.goTo(T)});else{if(T.indexOf(":")>=0){var D=T.split(":");T=D[0]===D[1]?D[0]:T}Vi(function(){i.parent.goTo(i.parent.sheets[y].name+"!"+T)})}}}else this.showInvalidHyperlinkDialog()}}else t||(this.isValidUrl(p)?window.open(p,f.target):this.showInvalidHyperlinkDialog());this.parent.trigger(e6,v)}},s.prototype.isValidUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},s.prototype.showInvalidHyperlinkDialog=function(){var e=this.parent.serviceLocator.getService(At),t=this.parent.serviceLocator.getService(de);e.show({width:323,isModal:!0,showCloseIcon:!0,header:t.getConstant("Hyperlink"),content:t.getConstant("InvalidHyperlinkAlert"),buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){e.hide()}}]},!1)},s.prototype.hyperlinkClickHandler=function(e){var t=e.target;if(U(t,".e-link-dialog")&&U(t,".e-toolbar-item")){var i=U(t,".e-hyperlink-dlg")||U(t,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild,a=i.querySelector(".e-document"),o=i.querySelector(".e-webpage"),l=o?o.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value,h=a?a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:l,u=U(t,".e-toolbar-items");if(u.getElementsByClassName("e-toolbar-item")[1].classList.contains("e-active")){var c=a.querySelectorAll(".e-cont")[2].querySelector(".e-active");a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=l,U(c,".e-list-item").classList.contains("e-level-2")&&n.hasAttribute("disabled")?n.removeAttribute("disabled"):U(c,".e-list-item").classList.contains("e-level-1")&&!n.hasAttribute("disabled")&&n.setAttribute("disabled","true")}else{var d=!o.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;o.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=h,d&&!n.hasAttribute("disabled")?n.setAttribute("disabled","true"):!d&&n.hasAttribute("disabled")&&n.removeAttribute("disabled")}}if(U(t,".e-list-item")&&t.classList.contains("e-fullrow")){var p=this.parent.element.getElementsByClassName("e-link-dialog")[0];if(p)p=p.getElementsByClassName("e-content")[0].getElementsByClassName("e-active")[0];else return;var f=p.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0],i=U(t,".e-hyperlink-dlg")||U(t,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;U(t,".e-list-item").classList.contains("e-level-2")?U(t,".e-list-item").getAttribute("data-uid")==="defName"?(!f.classList.contains("e-disabled")&&!f.hasAttribute("readonly")&&(f.setAttribute("readonly","true"),f.classList.add("e-disabled"),f.setAttribute("disabled","true")),n.hasAttribute("disabled")&&n.removeAttribute("disabled")):U(t,".e-list-item").getAttribute("data-uid")==="sheet"&&(f.classList.contains("e-disabled")&&f.hasAttribute("readonly")&&(f.removeAttribute("readonly"),f.classList.remove("e-disabled"),f.removeAttribute("disabled")),ur(f.value.toUpperCase())&&n.hasAttribute("disabled")&&n.removeAttribute("disabled")):U(t,".e-list-item").classList.contains("e-level-1")&&n.setAttribute("disabled","true")}else this.hlOpenHandler(t,!0)},s.prototype.createHyperlinkEle=function(e){var t=e.cell;if(!m(t.hyperlink)){var i=e.td,r=this.parent.createElement("a",{className:"e-hyperlink e-hyperlink-style"}),n=void 0;if(typeof t.hyperlink=="string"?(t.hyperlink.toLowerCase().indexOf("www.")===0&&(t.hyperlink="http://"+t.hyperlink),n=t.hyperlink):(n=t.hyperlink.address,n.toLowerCase().indexOf("www.")===0&&(t.hyperlink.address=n="http://"+n)),n.indexOf("http://")===0||n.indexOf("https://")===0||n.indexOf("ftp://")===0?(r.setAttribute("href",n),r.setAttribute("target","_blank")):(n.includes("=")||n.includes("!"))&&r.setAttribute("ref",n),rh(t.format)==="Accounting"?r.innerHTML=i.innerHTML:r.innerText=i.innerText!==""?i.innerText:n,i.textContent="",i.innerText="",i.appendChild(r),!e.style.color||!e.style.textDecoration){var a={};e.style.color||(e.style.color=a.color="#00e"),e.style.textDecoration||(e.style.textDecoration=a.textDecoration="underline"),Tn(this.parent,this.parent.getActiveSheet(),{rowIdx:e.rowIdx,colIdx:e.colIdx,preventEvt:!0,cell:{style:a}})}}},s.prototype.hyperEditContent=function(){var e=!0,t=this.hyperlinkContent(),i=ee(this.parent.getActiveSheet().activeCell),r=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[i[0]].cells[i[1]];this.parent.scrollSettings.enableVirtualization&&(i[0]=i[0]-this.parent.viewport.topIndex,i[1]=i[1]-this.parent.viewport.leftIndex);var n=this.parent.getDisplayText(r),a,o=r.hyperlink;typeof o=="string"?(a=o,n=n||a,a.indexOf("http://")===-1&&a.indexOf("https://")===-1&&a.indexOf("ftp://")===-1&&(e=!1)):typeof o=="object"&&(a=o.address,n=n||a,a.indexOf("http://")===-1&&a.indexOf("https://")===-1&&a.indexOf("ftp://")===-1&&(e=!1));for(var l=0,h=0,u=this.parent.definedNames,c=this.parent.sheets,d=0,p=u.length;d<p;d++)u[d].name===a&&l++;for(var d=0,p=c.length;d<p;d++)a.includes(c[d].name)&&h++;l===0&&h===0&&(e=!0);var f=t.querySelector(".e-content");if(e){var v=f.querySelector(".e-webpage");if(v.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n),typeof o=="string")v.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",o);else{var g=v.getElementsByClassName("e-cont")[1].querySelector(".e-text");g.setAttribute("value",o.address)}}else{var b=void 0,y=f.querySelector(".e-document");y.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n);var C=void 0;if(this.parent.definedNames){for(var d=0;d<this.parent.definedNames.length;d++)if(this.parent.definedNames[d].name===a){b=!0;break}}if(b){var x=y.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0];x.setAttribute("readonly","true"),x.classList.add("e-disabled"),x.setAttribute("disabled","true");for(var w=y.getElementsByClassName("e-cont")[2],M=w.querySelectorAll(".e-list-item.e-level-1")[1],d=0;d<M.getElementsByTagName("li").length;d++)M.getElementsByTagName("li")[d].innerText===a&&M.getElementsByTagName("li")[d].classList.add("e-active")}else{a&&a.indexOf("!")!==-1&&(C=a.split("!"));var E=C[0];y.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",C[1]);for(var w=y.getElementsByClassName("e-cont")[2],M=w.querySelectorAll(".e-list-item.e-level-1")[0],d=0;d<M.getElementsByTagName("li").length;d++)if(M.getElementsByTagName("li")[d].innerText===E){if(M.getElementsByTagName("li")[d].classList.contains("e-active"))break;M.getElementsByTagName("li")[d].classList.add("e-active")}else M.getElementsByTagName("li")[d].classList.contains("e-active")&&M.getElementsByTagName("li")[d].classList.remove("e-active")}}return t},s.prototype.hyperlinkContent=function(){var e=this.parent.serviceLocator.getService(de),t=0,i=0,r=!0,n,a=!0,o,l=ee(this.parent.getActiveSheet().activeCell),h=this.parent.getActiveSheet(),u=Y(l[0],l[1],h),c=!0;if(u){u.value&&typeof u.value=="string"&&u.value.match("[A-Za-z]+")!==null||u.value===""||m(u.value)?c=!0:c=!1;var d=u.hyperlink;if(typeof d=="string"){var p=d;p.indexOf("http://")===-1&&p.indexOf("https://")===-1&&p.indexOf("ftp://")===-1&&(o=d,r=!1)}else if(typeof d=="object"){var p=d.address;p.indexOf("http://")===-1&&p.indexOf("https://")===-1&&p.indexOf("ftp://")===-1&&(o=d.address,r=!1)}if(o){for(var f=0,v=0,g=this.parent.definedNames,b=this.parent.sheets,y=0,C=b.length;y<C;y++)o.includes(b[y].name)&&v++;for(var x=0,C=g.length;x<C;x++)g[x].name===o&&f++;f===0&&v===0&&(r=!0)}if(r?i=0:i=1,this.parent.definedNames){for(var w=0;w<this.parent.definedNames.length;w++)if(this.parent.definedNames[w].name===o){n=!0,a=!1;break}}}var M=this.parent.createElement("div",{className:"e-link-dialog"}),E=this.parent.createElement("div",{className:"e-webpage"}),T=this.parent.createElement("div",{className:"e-document"}),D=new UI({selectedItem:i,items:[{header:{text:e.getConstant("WebPage")},content:E},{header:{text:e.getConstant("ThisDocument")},content:T}]});D.appendTo(M),r?M.querySelector(".e-toolbar-items").querySelector(".e-indicator").setAttribute("style","left: 0; right: 136px"):M.querySelector(".e-toolbar-items").querySelector(".e-indicator").setAttribute("style","left: 136px; right: 0");var N=this.parent.createElement("div",{className:"e-cont"}),A=this.parent.createElement("div",{className:"e-cont"}),L=this.parent.createElement("div",{className:"e-header"});L.innerText=e.getConstant("DisplayText");var k=this.parent.createElement("div",{className:"e-header"});k.innerText=e.getConstant("Url");var O=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});c||(O.classList.add("e-disabled"),O.setAttribute("readonly","true"),O.setAttribute("disabled","true")),u&&m(u.hyperlink)&&O.setAttribute("value",this.parent.getDisplayText(u));var R=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});O.setAttribute("placeholder",e.getConstant("EnterTheTextToDisplay")),R.setAttribute("placeholder",e.getConstant("EnterTheUrl")),N.appendChild(O),N.insertBefore(L,O),A.appendChild(R),A.insertBefore(k,R),E.appendChild(A),E.insertBefore(N,A);var j=[],P=[],F=this.parent.sheets;for(t;t<this.parent.sheets.length;t++){var z=this.parent.sheets[t].name;this.parent.sheets[t].state==="Visible"&&(F[t]===this.parent.getActiveSheet()?j.push({nodeId:"sheet",nodeText:z.indexOf(" ")!==-1?"'"+z+"'":z,selected:!0}):j.push({nodeId:"sheet",nodeText:z.indexOf(" ")!==-1?"'"+z+"'":z}))}for(t=0;t<this.parent.definedNames.length;t++)P.push({nodeId:"defName",nodeText:this.parent.definedNames[t].name});var q=[{nodeId:"01",nodeText:e.getConstant("CellReference"),expanded:a,nodeChild:j},{nodeId:"02",nodeText:e.getConstant("DefinedNames"),expanded:n,nodeChild:P}],X=new Yz({fields:{dataSource:q,id:"nodeId",text:"nodeText",child:"nodeChild"}}),G=this.parent.createElement("div",{className:"e-cont"}),Z=this.parent.createElement("div",{className:"e-header"});Z.innerText=e.getConstant("CellReference");var se=this.parent.createElement("input",{className:"e-input e-text e-hyp-text",attrs:{type:"Text"}});se.setAttribute("value","A1"),G.appendChild(se),G.insertBefore(Z,se);var oe=this.parent.createElement("div",{className:"e-cont"}),fe=this.parent.createElement("div",{className:"e-header"});fe.innerText=e.getConstant("DisplayText");var be=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});c||(be.classList.add("e-disabled"),be.setAttribute("readonly","true"),be.setAttribute("disabled","true")),u&&m(u.hyperlink)&&be.setAttribute("value",this.parent.getDisplayText(u)),be.setAttribute("placeholder",e.getConstant("EnterTheTextToDisplay")),oe.appendChild(be),oe.insertBefore(fe,be);var Ne=this.parent.createElement("div",{className:"e-cont"}),we=this.parent.createElement("div",{className:"e-header"});we.innerText=e.getConstant("Sheet");var H=this.parent.createElement("div",{className:"e-refcont"});return Ne.appendChild(H),Ne.insertBefore(we,H),T.appendChild(G),T.insertBefore(oe,G),X.appendTo(H),T.appendChild(Ne),M},s.prototype.removeHyperlink=function(e){var t=Y(e.rowIdx,e.colIdx,e.sheet);t&&t.hyperlink&&(typeof t.hyperlink=="string"?t.value=t.value?t.value:t.hyperlink:t.value=t.value?t.value:t.hyperlink.address,delete t.hyperlink,t.style&&(delete t.style.textDecoration,delete t.style.color),t.validation&&t.validation.isHighlighted&&t.style.backgroundColor&&(t.style.color="#ff0000"),e.sheet===this.parent.getActiveSheet()&&(t.style&&this.parent.notify(Oa,null),e.preventRefresh||this.parent.serviceLocator.getService("cell").refresh(e.rowIdx,e.colIdx,!1,null,!0,!1,ea(this.parent))))},s.prototype.removeHyperlinkHandler=function(e){var t=e.range,i,r=this.parent.getActiveSheet(),n;if(!e.preventEventTrigger){var a={address:t.indexOf("!")===-1?r.name+"!"+t:t,cancel:!1};if(this.parent.notify(li,{action:"removeHyperlink",eventArgs:a}),a.cancel)return}if(t&&t.indexOf("!")!==-1){i=t.split("!");for(var o=this.parent.sheets,l=0;l<o.length;l++)o[l].name===i[0]&&(n=l);r=this.parent.sheets[n],t=i[1]}for(var h=ee(t||r.activeCell),u,c,d=h[0];d<=h[2];d++)for(var p=h[1];p<=h[3];p++)if(r&&r.rows[d]&&r.rows[d].cells[p]){if(c=[],u=this.parent.getCell(d,p),u)for(var f=0;f<u.classList.length;f++)c.push(u.classList[f]);this.parent.notify(Mg,{sheet:r,rowIdx:d,colIdx:p});for(var f=0;f<c.length;f++)u.classList.contains(c[f])||u.classList.add(c[f])}e.preventEventTrigger||this.parent.notify(yt,{action:"removeHyperlink",eventArgs:{address:t.indexOf("!")===-1?r.name+"!"+t:t}})},s}(),zM=function(){return zM=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},zM.apply(this,arguments)},hY=function(){function s(e){this.undoCollection=[],this.redoCollection=[],this.isUndo=!1,this.undoRedoStep=100,this.parent=e,this.addEventListener()}return s.prototype.setActionData=function(e){var t=this.parent.getActiveSheet(),i,r=[],n=[],a=e.args,o=a.eventArgs,l={};switch(a.action){case"format":i=ee(a.eventArgs.range);break;case"clipboard":l=o.copiedInfo,i=ee(nu(o.pastedRange)),l&&l.isCut&&(n=this.getCellDetails(l.range,Pe(this.parent,Qn(this.parent,l.sId)),"clipboard"));break;case"beforeSort":i=ee(a.eventArgs.range),i[0]===i[2]&&i[2]-i[0]===0&&(i[0]=0,i[1]=0,i[2]=t.usedRange.rowIndex,i[3]=t.usedRange.colIndex);break;case"beforeCellSave":case"cellDelete":case"cellSave":i=ee(o.address);break;case"beforeWrap":case"beforeReplace":case"chartDesign":i=this.parent.getAddressInfo(o.address).indices;break;case"beforeClear":i=ee(o.range);break;case"beforeInsertImage":i=ee(o.range);break;case"deleteImage":i=ee(o.address);break;case"beforeInsertChart":i=ee(o.range);break;case"filter":i=ee(o.range);break;case"autofill":i=ee(o.fillRange);break;case"removeValidation":if(o.isColSelected){this.beforeActionData={cellDetails:[]};for(var h=o.range.split("!")[1].split(":"),u=Rn(h[0]),c=Rn(h[1]);u<=c;u++)t.columns[u]&&t.columns[u].validation&&this.beforeActionData.cellDetails.push({colIndex:u,validation:t.columns[u].validation})}else i=ee(o.range);break;case"hyperlink":case"removeHyperlink":i=ee(o.address);break}a.action==="beforeSort"?(this.beforeActionData={cellDetails:o.cellDetails},this.beforeActionData.sortedCellDetails=o.sortedCellDetails):i&&(r=this.getCellDetails(i,t,a.action),this.beforeActionData={cellDetails:r,cutCellDetails:n})},s.prototype.getBeforeActionData=function(e){e.beforeDetails=this.beforeActionData},s.prototype.performUndoRedo=function(e){var t;e.isFromUpdateAction?t=e:(t=e.isUndo?this.undoCollection.pop():this.redoCollection.pop(),e.setCollection&&(e.undoArgs=t)),this.isUndo=e.isUndo;var i;if(t){var r=void 0,n={};if(!e.isPublic){var a=t.eventArgs.beforeActionData;if(delete t.eventArgs.beforeActionData,r={action:t.action,eventArgs:{}},me(r.eventArgs,t.eventArgs,null,!0),t.eventArgs.beforeActionData=a,r.eventArgs.cancel=!1,t.preventAction=r.preventAction=!0,e.isUndo?r.isUndo=!0:r.isRedo=!0,e.isFromUpdateAction||this.parent.notify(li,r),r.eventArgs.cancel){this.updateUndoRedoIcons();return}delete r.eventArgs.cancel}switch(t.action){case"cellSave":case"format":case"wrap":case"cellDelete":case"autofill":case"removeValidation":case"hyperlink":case"removeHyperlink":t=this.performOperation(t,e.preventEvt,e.preventReSelect,e.isPublic);break;case"sorting":this.undoForSorting(t,e.isUndo);break;case"clipboard":t=this.undoForClipboard(t,e.isUndo,r),i=!0;break;case"resize":case"resizeToFit":t=this.undoForResize(t);break;case"hideShow":kr(t,this.parent,!e.isUndo);break;case"replace":t=this.performOperation(t);break;case"replaceAll":t.eventArgs.isAction=!1,e.isUndo&&(n.value=t.eventArgs.replaceValue,n.replaceValue=t.eventArgs.value,n.skipFormatCheck=ea(this.parent)),this.parent.notify(fd,zM({},t.eventArgs,n));break;case"insert":case"filter":kr(t,this.parent,!e.isUndo,null,r),i=t.action==="filter";break;case"delete":kr(t,this.parent,!e.isUndo);break;case"validation":case"addHighlight":case"removeHighlight":kr(t,this.parent,!e.isUndo);break;case"merge":t.eventArgs.merge=t.isFromUpdateAction?t.eventArgs.merge:!t.eventArgs.merge,kr(t,this.parent,!1);break;case"clear":t=this.performOperation(t),e.isUndo&&t.eventArgs.cfClearActionArgs&&kr({action:"clearCF",eventArgs:t.eventArgs.cfClearActionArgs},this.parent,!e.isUndo);break;case"conditionalFormat":kr(t,this.parent,!e.isUndo,this.undoCollection);break;case"clearCF":kr(t,this.parent,!e.isUndo);break;case"insertImage":case"deleteImage":kr(t,this.parent,!e.isUndo);break;case"imageRefresh":kr(t,this.parent,!e.isUndo);break;case"insertChart":case"deleteChart":kr(t,this.parent,!e.isUndo);break;case"chartRefresh":kr(t,this.parent,!e.isUndo);break;case"chartDesign":t.eventArgs.isUndo=e.isUndo,this.parent.notify(vM,t.eventArgs);break;case"addDefinedName":kr(t,this.parent,!e.isUndo);break}e.isFromUpdateAction||(e.isUndo?this.redoCollection.push(t):this.undoCollection.push(t),this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.redoCollection.length>this.undoRedoStep&&this.redoCollection.splice(0,1),this.updateUndoRedoIcons(),!e.isPublic&&!i&&this.parent.notify(yt,me({isUndoRedo:!0,isUndo:e.isUndo},t))),this.parent.notify(Oa,null)}},s.prototype.undoForSorting=function(e,t){var i=this,r=La(this.parent,e.eventArgs.range),n=ee(e.eventArgs.range),a=function(h,u){if(r===i.parent.activeSheetIndex){var c=i.parent.getCell(n[0]-1,i.parent.sortCollection[h].columnIndex);c&&(c=$(".e-filter-icon",c),c&&(u?c.classList.add("e-sort"+(i.parent.sortCollection[h].order==="Ascending"?"asc":"desc")+"-filter"):c.classList.remove("e-sort"+(i.parent.sortCollection[h].order==="Ascending"?"asc":"desc")+"-filter")))}};if(t){if(this.parent.notify(r1,{result:e.eventArgs.beforeActionData.cellDetails,range:n,sheet:Pe(this.parent,r),jsonData:e.eventArgs.beforeActionData.sortedCellDetails,isUndo:!0}),this.parent.notify($p,{range:e.eventArgs.range}),this.parent.sortCollection&&e.eventArgs.previousSort){for(var o=0;o<this.parent.sortCollection.length;o++)if(this.parent.sortCollection[o].sheetIndex===r){a(o,!1),this.parent.sortCollection.splice(o,1),e.eventArgs.previousSort.order?(this.parent.sortCollection.splice(o,0,e.eventArgs.previousSort),a(o,!0)):this.parent.sortCollection.length||(this.parent.sortCollection=void 0);break}}}else if(kr(e,this.parent,!0),e.eventArgs.previousSort){var l=void 0;if(this.parent.sortCollection){for(var o=0;o<this.parent.sortCollection.length;o++)if(this.parent.sortCollection[o].sheetIndex===r){a(o,!1),l=o,this.parent.sortCollection.splice(o,1);break}}else this.parent.sortCollection=[],l=0;this.parent.sortCollection.splice(l,0,{sortRange:e.eventArgs.range.split("!")[1],sheetIndex:r,columnIndex:Rn(e.eventArgs.sortOptions.sortDescriptors.field),order:e.eventArgs.sortOptions.sortDescriptors.order}),a(l,!0)}},s.prototype.updateUndoRedoCollection=function(e){var t=["clipboard","format","sorting","cellSave","resize","resizeToFit","wrap","hideShow","replace","validation","merge","clear","conditionalFormat","clearCF","insertImage","imageRefresh","insertChart","deleteChart","chartRefresh","filter","cellDelete","autofill","addDefinedName","removeValidation","removeHighlight","addHighlight","hyperlink","removeHyperlink","deleteImage","chartDesign","replaceAll"];(e.args.action==="insert"||e.args.action==="delete")&&e.args.eventArgs.modelType!=="Sheet"&&t.push(e.args.action);var i=e.args.action;if(!(t.indexOf(i)===-1&&!e.isPublic)){var r=e.args.eventArgs;if(i==="clipboard"||i==="sorting"||i==="format"||i==="cellSave"||i==="wrap"||i==="replace"||i==="validation"||i==="clear"||i==="conditionalFormat"||i==="clearCF"||i==="insertImage"||i==="imageRefresh"||i==="insertChart"||i==="chartRefresh"||i==="filter"||i==="cellDelete"||i==="autofill"||i==="removeValidation"||i==="addDefinedName"||i==="hyperlink"||i==="removeHyperlink"||i==="deleteImage"||i==="chartDesign"){var n={beforeDetails:{cellDetails:[]}};this.parent.notify(HC,n),r.beforeActionData=n.beforeDetails}if(i==="clipboard"&&r.copiedInfo&&r.copiedInfo.isExternal){var a=this.parent.getAddressInfo(r.pastedRange);r.copiedInfo.cellDetails=this.getCellDetails(a.indices,Pe(this.parent,a.sheetIndex),i)}this.undoCollection.push(e.args),this.redoCollection=[],this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.updateUndoRedoIcons()}},s.prototype.clearUndoRedoCollection=function(){this.undoCollection=[],this.redoCollection=[],this.updateUndoRedoIcons()},s.prototype.updateUndoRedoIcons=function(){var e=this.parent.serviceLocator.getService(de);this.parent.notify(nh,[{tab:e.getConstant("Home"),items:[this.parent.element.id+"_undo"],enable:this.undoCollection.length>0}]),this.parent.notify(nh,[{tab:e.getConstant("Home"),items:[this.parent.element.id+"_redo"],enable:this.redoCollection.length>0}])},s.prototype.undoForClipboard=function(e,t,i){var r=this,n=e.eventArgs,a=n.pastedRange.split("!"),o=ee(a[1]),l=gt(this.parent,a[0]),h=Pe(this.parent,l),u=n.copiedInfo,c=n.beforeActionData,d=e.isFromUpdateAction,p=l===this.parent.activeSheetIndex,f;if(i&&(i.isUndoRedo=!0,i.eventArgs.beforeActionData=c),e.eventArgs.requestType==="imagePaste"){var v=n.copiedShapeInfo;t?(f=v.pictureElem,v.isCut?(this.parent.notify(Xs,{id:f.id,sheetIdx:n.pasteSheetIndex+1}),this.parent.notify(Da,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,imageId:f.id},range:v.copiedRange,isPublic:!1,isUndoRedo:!0})):this.parent.notify(Xs,{id:n.pastedPictureElement.id,sheetIdx:n.pasteSheetIndex+1})):v.isCut?(f=v.pictureElem,this.parent.notify(Xs,{id:f.id,sheetIdx:v.sId}),this.parent.notify(Da,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,imageId:f.id},range:v.pastedRange,isPublic:!1,isUndoRedo:!0})):(f=n.pastedPictureElement,this.parent.notify(Da,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:f.offsetHeight,width:f.offsetWidth,imageId:f.id},range:v.pastedRange,isPublic:!1,isUndoRedo:!0}))}else{if(t){if(u.isCut){var g=c.cutCellDetails;this.updateCellDetails(g,Pe(this.parent,Qn(this.parent,u.sId)),lt(u.range),p,e),n.cfClearActionArgs&&kr({action:"clearCF",eventArgs:n.cfClearActionArgs},this.parent,!1)}c&&this.updateCellDetails(c.cellDetails,h,o,p,e,null,null,i?i.isUndoRedo:null),n.cfActionArgs&&n.cfActionArgs.cfModel.forEach(function(x){kr({eventArgs:{range:x.range,type:x.type,cFColor:x.cFColor,value:x.value,sheetIdx:n.cfActionArgs.sheetIdx,cancel:!0},action:"conditionalFormat"},r.parent,!1)}),Yl(h,o[0],o[1],Wt(h,o[0]));var b=eo(h,o[0]);Ja(this.parent,h,b,o[0]),n.mergeCollection.forEach(function(x){x.merge=!x.merge,r.parent.notify(Fn,x),x.merge=!x.merge}),i&&!d&&this.parent.notify(yt,i)}else if(u.isExternal){var y=this.parent.getAddressInfo(n.pastedRange);this.updateCellDetails(u.cellDetails,Pe(this.parent,y.sheetIndex),y.indices,!0,e,null,null,i?i.isUndoRedo:null),i&&!d&&this.parent.notify(yt,i)}else{var C=new Promise(function(w){w(function(){}())}),y=this.parent.getAddressInfo(n.copiedRange);this.parent.notify(n.copiedInfo.isCut?du:pu,{range:y.indices,sId:Pe(this.parent,y.sheetIndex).id,promise:C,invokeCopy:!0,isPublic:!0,isFromUpdateAction:d}),C.then(function(){r.parent.notify(Ia,{range:a&&ir(n.pastedRange),sIdx:a&&gt(r.parent,Ms(n.pastedRange)),type:n.type,isAction:!1,isInternal:!0,isFromUpdateAction:d}),i&&!d&&r.parent.notify(yt,i)})}p&&!d?(this.parent.notify(cu,{address:n.selectedRange}),this.parent.notify(Pa,{})):this.checkRefreshNeeded(l,d)}return e},s.prototype.undoForResize=function(e){var t=e.eventArgs;if(t.hide===void 0)if(t.isCol){var i=t.oldWidth;t.oldWidth=t.width,t.width=i}else{var i=t.oldHeight;t.oldHeight=t.height,t.height=i}else t.hide=!t.hide;kr(e,this.parent,!1);var r=this.parent.getActiveSheet(),n=ee(r.activeCell),a=Y(n[0],n[1],r);if(a&&a.rowSpan){var o=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.height=o.offsetHeight+"px"}else if(a&&a.colSpan){var o=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.width=o.offsetWidth+"px"}return e},s.prototype.performOperation=function(e,t,i,r){var n=e.eventArgs,a=[];e.action==="autofill"?a=n.fillRange.split("!"):a=e.action==="cellSave"||e.action==="wrap"||e.action==="replace"||e.action==="cellDelete"||e.action==="hyperlink"||e.action==="removeHyperlink"?n.address.split("!"):n.range.split("!");var o=gt(this.parent,a[0]),l=Pe(this.parent,o),h;if(n.isColSelected){var u=a[1].split(":");h=[0,Rn(u[0]),l.rowCount-1,Rn(u[1])]}else h=lt(ee(a[1]));var c=h,d=n.beforeActionData,p=e.isFromUpdateAction,f=this.checkRefreshNeeded(o,p),v={cellIdx:[h[0],h[1]],isUnique:!1,uniqueRange:""};if(n.isColSelected||this.parent.notify(ou,v),this.isUndo){if(v.isUnique&&n.formula&&n.formula.indexOf("UNIQUE")>-1){var g=ee(v.uniqueRange);if(Y(g[0],g[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var b=g[0];b<=g[2];b++)for(var y=g[1];y<=g[3];y++)b===g[0]&&y===g[1]&&(y=y+1),this.parent.updateCell({value:""},je([b,y]))}if(this.updateCellDetails(d.cellDetails,l,h,f,e,t,n.isColSelected),v.isUnique&&e.action==="cellDelete"&&n.isSpill){for(var g=ee(v.uniqueRange),C=Y(g[0],g[1],this.parent.getActiveSheet()),x=g[0];x<=g[2];x++)for(var b=g[1];b<=g[3];b++)for(var y=h[0];y<=h[2];y++)for(var w=h[1];w<=h[3];w++)(x!==y||b!==w)&&this.parent.updateCell({value:""},Je(x,b));C.value="#SPILL!",this.parent.updateCell(C,Je(g[0],g[1]))}if(!n.isSpill&&v.uniqueRange!==""){for(var M=ee(v.uniqueRange),b=M[0];b<=M[2];b++)for(var y=M[1];y<=M[3];y++)b===M[0]&&y===M[1]&&(y=y+1),this.parent.updateCell({value:""},je([b,y]));this.parent.notify(Dy,null)}}else{var E=e.eventArgs,T=ee(l.activeCell),D=this.parent.getCellStyleValue(["textDecoration"],T).textDecoration;if(E&&E.style&&E.style.textDecoration){var N=E.style.textDecoration,A=N,L=void 0,k=!1;D==="underline"?A=N==="underline"?"none":"underline line-through":D==="line-through"?A=N==="line-through"?"none":"underline line-through":D==="underline line-through"&&(A=N==="underline"?"line-through":"underline",k=!0),A==="none"&&(k=!0),E.style.textDecoration=A,e.eventArgs=E;for(var x=c[0];x<=c[2];x++)for(var b=c[1];b<=c[3];b++){if(L={},D=this.parent.getCellStyleValue(["textDecoration"],[x,b]).textDecoration,D==="none"){if(k)continue;L.textDecoration=N}else if(D==="underline"||D==="line-through")if(k)if(N===D)L.textDecoration="none";else continue;else L.textDecoration=N!==D?"underline line-through":N;else if(D==="underline line-through")if(k)L.textDecoration=N==="underline"?"line-through":"underline";else continue;this.parent.notify(Ri,{style:{textDecoration:L.textDecoration},range:[x,b,x,b],refreshRibbon:!0,onActionUpdate:!0})}E.style.textDecoration=N,e.eventArgs=E}else{if(!m(n.oldValue)&&n.oldValue!==n.value&&v.isUnique){var O=ee(v.uniqueRange);if(Y(O[0],O[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var b=O[0];b<=O[2];b++)for(var y=O[1];y<=O[3];y++)b===O[0]&&y===O[1]&&(this.parent.updateCell({value:"#SPILL!"},je([O[0],O[1]])),y=y+1),this.parent.updateCell({value:""},je([b,y]))}if(kr(e,this.parent,!0),v.isUnique&&e.action==="cellDelete"&&n.isSpill){for(var R=ee(v.uniqueRange),j=!1,x=R[0];x<=R[1];x++)for(var b=R[1];b<=R[3];b++)x===R[0]&&b===R[1]&&b++,Y(x,b,l)&&!m(Y(x,b,l).value)&&Y(x,b,l).value!==""&&(j=!0);if(!j){var C=Y(R[0],R[1],this.parent.getActiveSheet());C.value="",this.parent.updateCell(C,Je(R[0],R[1])),this.parent.notify(Dy,null)}}}}return e.action==="autofill"&&(a[1]=this.isUndo?e.eventArgs.dataRange:e.eventArgs.selectedRange),f&&!i&&!p&&(n.isColSelected&&(a[1]=l.selectedRange),this.parent.notify(cu,{address:a[1]})),this.parent.showAggregate&&this.parent.notify(wd,{}),e},s.prototype.getCellDetails=function(e,t,i){var r=[],n,a=i==="cellDelete";e=lt(e);for(var o=e[0];o<=e[2];o++)if(!(a&&Aa(t,o)))for(var l=e[1];l<=e[3];l++)n=Y(o,l,t),r.push({rowIndex:o,colIndex:l,format:n?n.format:null,isLocked:n?n.isLocked:null,style:n&&n.style?Object.assign({},n.style):null,value:n?n.value:"",formula:n?n.formula:"",wrap:n&&n.wrap,rowSpan:n&&n.rowSpan,colSpan:n&&n.colSpan,hyperlink:n&&(na(n.hyperlink)?me({},n.hyperlink):n.hyperlink),image:n&&n.image,chart:n&&n.chart&&JSON.parse(JSON.stringify(n.chart)),validation:n&&n.validation});return r},s.prototype.updateCellDetails=function(e,t,i,r,n,a,o,l){for(var h=this,u=e.length,c=n&&!a&&(n.action==="cellSave"||n.action==="cellDelete"||n.action==="autofill"||n.action==="clipboard"),d,p,f,v=n&&!n.eventArgs.cfClearActionArgs&&t.conditionalFormats&&t.conditionalFormats.length&&[].slice.call(t.conditionalFormats),g=[],b,y,C=function(E){if(o)return Td(t,e[E].colIndex,{validation:e[E].validation}),"continue";p=Y(e[E].rowIndex,e[E].colIndex,t,!1,!0),p.style&&n&&(n.action==="format"||n.action==="clipboard")&&(p.style.borderTop&&(!e[E].style||!e[E].style.borderTop)&&x.parent.setBorder({borderTop:""},t.name+"!"+Je(e[E].rowIndex,e[E].colIndex),null,l),p.style.borderLeft&&(!e[E].style||!e[E].style.borderLeft)&&x.parent.setBorder({borderLeft:""},t.name+"!"+Je(e[E].rowIndex,e[E].colIndex),null,l),p.style.borderRight&&(!e[E].style||!e[E].style.borderRight)&&x.parent.setBorder({borderRight:""},t.name+"!"+Je(e[E].rowIndex,e[E].colIndex),null,l),p.style.fontSize&&(!e[E].style||!e[E].style.fontSize)&&(p.style.fontSize="11pt",f=!0,x.parent.notify(dr,{style:{fontSize:"11pt"},rowIdx:e[E].rowIndex,colIdx:e[E].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0})),p.style.fontFamily&&(!e[E].style||!e[E].style.fontFamily)&&(f=!0,p.style.fontFamily="Calibri",x.parent.notify(dr,{style:{fontFamily:"Calibri"},rowIdx:e[E].rowIndex,colIdx:e[E].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0}))),p.image&&n&&n.action==="clipboard"&&p.image.forEach(function(T){h.parent.notify(Xs,{id:T.id,sheet:t,preventEventTrigger:!0,rowIdx:e[E].rowIndex,colIdx:e[E].colIndex})}),Ht(e[E].rowIndex,e[E].colIndex,t,{value:e[E].formula&&e[E].formula.toUpperCase().includes("UNIQUE")?null:e[E].value,format:e[E].format,isLocked:e[E].isLocked,style:e[E].style&&Object.assign({},e[E].style),formula:e[E].formula,wrap:e[E].wrap,rowSpan:e[E].rowSpan,colSpan:e[E].colSpan,hyperlink:e[E].hyperlink,validation:e[E]&&e[E].validation,image:e[E].image}),y={action:"updateCellValue",address:[e[E].rowIndex,e[E].colIndex,e[E].rowIndex,e[E].colIndex],value:e[E].formula?e[E].formula:e[E].value,sheetIndex:gt(x.parent,t.name),skipFormatCheck:ea(x.parent)},x.parent.notify(au,y),v&&!b&&(b=y.isFormulaDependent),(n&&n.action==="wrap"&&n.eventArgs.wrap||p.wrap&&!e[E].wrap)&&x.parent.notify(eh,{range:[e[E].rowIndex,e[E].colIndex,e[E].rowIndex,e[E].colIndex],wrap:!1,sheet:t}),n&&e[E].hyperlink&&n.action==="clear"&&(n.eventArgs.range=t.name+"!"+je([e[E].rowIndex,e[E].colIndex,e[E].rowIndex,e[E].colIndex]),d=x.parent.getCell(e[E].rowIndex,e[E].colIndex),n.eventArgs.type==="Clear All"||n.eventArgs.type==="Clear Hyperlinks"?x.parent.addHyperlink(e[E].hyperlink,n.eventArgs.range,e[E].value):n.eventArgs.type==="Clear Formats"&&d&&Q(d.querySelectorAll(".e-hyperlink"),"e-hyperlink-style")),c&&e[E].value!==p.value&&x.parent.trigger("cellSave",{element:null,value:e[E].value,oldValue:p.value,formula:e[E].formula,cancel:!1,address:t.name+"!"+Je(e[E].rowIndex,e[E].colIndex),displayText:x.parent.getDisplayText(e[E])}),v&&!b&&_f(v,g,e[E].rowIndex,e[E].colIndex)},x=this,w=0;w<u;w++)C(w);if(r){if(i[0]===i[2]&&i[1]===i[3]){var M=Y(i[0],i[1],t);M.rowSpan>1&&(i[2]=i[0]+M.rowSpan-1),M.colSpan>1&&(i[3]=i[1]+M.colSpan-1)}this.parent.serviceLocator.getService("cell").refreshRange(i,!1,!1,!0,!1,ea(this.parent)),(g.length||b)&&this.parent.notify(er,{cfModel:!b&&g,refreshAll:b,isAction:!0}),f&&Vi(function(){return h.parent.selectRange(t.selectedRange)})}},s.prototype.checkRefreshNeeded=function(e,t){var i=!0;return e!==this.parent.activeSheetIndex&&(t||(this.parent.activeSheetIndex=e,this.parent.dataBind()),i=!1),i},s.prototype.addEventListener=function(){this.parent.on(Fa,this.performUndoRedo,this),this.parent.on(e0,this.updateUndoRedoCollection,this),this.parent.on(t0,this.setActionData,this),this.parent.on(HC,this.getBeforeActionData,this),this.parent.on(mu,this.clearUndoRedoCollection,this),this.parent.on(iM,this.updateUndoRedoIcons,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Fa,this.performUndoRedo),this.parent.off(e0,this.updateUndoRedoCollection),this.parent.off(t0,this.setActionData),this.parent.off(HC,this.getBeforeActionData),this.parent.off(mu,this.clearUndoRedoCollection),this.parent.off(iM,this.updateUndoRedoIcons))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"undoredo"},s}(),uY=function(){function s(e){this.parent=e,this.wrapCell=this.parent.createElement("span",{className:"e-wrap-content"}),this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(Qf,this.ribbonClickHandler,this),this.parent.on(eh,this.wrapTextHandler,this),this.parent.on(an,this.rowHeightChangedHandler,this),this.parent.on(wn,this.colWidthChanged,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Qf,this.ribbonClickHandler),this.parent.off(eh,this.wrapTextHandler),this.parent.off(an,this.rowHeightChangedHandler),this.parent.off(wn,this.colWidthChanged))},s.prototype.wrapTextHandler=function(e){if(e.initial||hz(this.parent,e.range,!0)){for(var t=void 0,i=void 0,r=void 0,n=void 0,a=void 0,o=void 0,l=void 0,h=void 0,u=e.range[0];u<=e.range[2];u++){n=0,l=sh(e.sheet,u).customHeight,o=l||e.isCustomHgt;for(var c=e.range[1];c<=e.range[3];c++)if(i=Y(u,c,e.sheet,null,!0),!(i.rowSpan<0||i.colSpan<0)){var d=i.rowSpan>1||i.colSpan>1;if(t=e.initial?e.td:this.parent.getCell(u,c),t?(e.wrap?(h=TI(i.style&&i.style.fontFamily?i.style:this.parent.cellStyle),t.classList.add(QA)):(t.classList.remove(QA),h=null),(o||d)&&this.updateWrapCell(u,c,e.sheet,t)):h=null,B.isIE&&t.classList.add("e-ie-wrap"),!(o||d)){r=Ad(e.sheet,u,c,i.colSpan>1?c+i.colSpan-1:c);var p=this.parent.getDisplayText(i).toString();if(p.indexOf(`
`)<0){var f=this.parent.element.querySelector(".e-spreadsheet-edit");f&&f.textContent.indexOf(`
`)>-1&&(p=f.textContent)}if(p)if(e.wrap){t&&t.classList.contains("e-alt-unwrap")&&t.classList.remove("e-alt-unwrap");var v=void 0,g=0,b=void 0;if(p.indexOf(`
`)>-1){var y=p.split(`
`),C=y.length;for(b=0;b<C;b++)v=iv(y[b],r,i.style,this.parent.cellStyle),v===0&&(v=1),g=g+v;v=g}else v=iv(p,r,i.style,this.parent.cellStyle);if(a=qc(this.parent,u,c,e.sheet,i.style||this.parent.cellStyle,v,h),n=Math.max(n,a),i.rowSpan>1){var x=Ei(e.sheet,u,u+(i.rowSpan-1));if(x>=n)return;a=n=Wt(e.sheet,u)+(n-x)}Yl(e.sheet,u,c,a)}else p.indexOf(`
`)>-1&&t.classList.add("e-alt-unwrap"),a=qc(this.parent,u,c,e.sheet,i.style||this.parent.cellStyle,1,h),Yl(e.sheet,u,c,a),n=Math.max(eo(e.sheet,u),20);else(!e.wrap||!p)&&(Yl(e.sheet,u,c,20),n=Math.max(eo(e.sheet,u),20));c===e.range[3]&&(e.wrap&&n>20&&eo(e.sheet,u)<=n||(!e.wrap||!p)&&eo(e.sheet,u)<Wt(e.sheet,u)&&Wt(e.sheet,u)>20)&&(Ja(this.parent,e.sheet,n,u,e.row,e.hRow),e.sheet.conditionalFormats&&e.sheet.conditionalFormats.length&&this.parent.notify(er,{indexes:[u,c],isAction:!0}))}if(o&&!d){var p=this.parent.getDisplayText(i);e.wrap?t&&t.classList.contains("e-alt-unwrap")&&t.classList.remove("e-alt-unwrap"):p.indexOf(`
`)>-1&&t.classList.add("e-alt-unwrap")}e.wrap&&t?l?t.style.lineHeight&&(t.style.lineHeight=""):t.style.lineHeight=parseFloat(i.style&&i.style.fontSize||this.parent.cellStyle.fontSize)*h+"pt":t&&(t.style.lineHeight="")}}e.initial||this.parent.notify(Pa,null)}},s.prototype.ribbonClickHandler=function(e){var t=U(e.originalEvent.target,".e-btn");if(t&&t.id===this.parent.element.id+"_wrap"){var i=t.classList.contains("e-active"),r=_W(this.parent.getActiveSheet()),n={address:r,wrap:i,cancel:!1};this.parent.notify(li,{action:"beforeWrap",eventArgs:n}),n.cancel||(_c(this.parent.getActiveSheet().selectedRange,i,this.parent),this.parent.notify(yt,{action:"wrap",eventArgs:{address:r,wrap:i}}))}},s.prototype.rowHeightChangedHandler=function(e){if(e.isCustomHgt)for(var t=this.parent.getActiveSheet(),i=void 0,r=this.parent.viewport.leftIndex,n=this.parent.viewport.rightIndex;r<=n;r++)Y(e.rowIdx,r,t,!1,!0).wrap&&(i=this.parent.getCell(e.rowIdx,r),this.updateWrapCell(e.rowIdx,r,t,i),i.style.lineHeight&&(i.style.lineHeight=""))},s.prototype.colWidthChanged=function(e){if(e.checkWrapCell)for(var t=this.parent.getActiveSheet(),i=this.parent.viewport.topIndex,r=this.parent.viewport.bottomIndex;i<=r;i++)Y(i,e.colIdx,t,!1,!0).wrap&&this.updateWrapCell(i,e.colIdx,t,this.parent.getCell(i,e.colIdx))},s.prototype.updateWrapCell=function(e,t,i,r){if(r&&!r.querySelector(".e-wrap-content")){for(var n=this.wrapCell.cloneNode(),a=r.querySelector(".e-filter-btn");r.childElementCount;)n.appendChild(r.firstElementChild);if(a&&(r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a)),!Y(e,t,i,!1,!0).hyperlink){var o=r.lastChild;o&&o.nodeType===3?(n.appendChild(document.createTextNode(o.textContent)),o.textContent=""):(n.appendChild(document.createTextNode(r.textContent)),r.textContent="")}r.appendChild(n)}},s.prototype.getModuleName=function(){return"wrapText"},s.prototype.destroy=function(){this.removeEventListener(),this.wrapCell=null,this.parent=null},s}(),cY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.insert=function(e){var t=e.eventArgs;this.parent.notify(Hf,t);var i=Pe(this.parent,t.activeSheetIndex);switch(t.modelType){case"Sheet":this.parent.notify(A1,{startIdx:t.index,endIdx:t.index+(t.model.length-1),preventUpdate:!t.isAction}),this.parent.renderModule.refreshSheet();break;case"Row":if(t.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.frozenRowCount(i);if(!this.parent.scrollSettings.enableVirtualization||t.index<=this.parent.viewport.bottomIndex)if(t.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenColCount(i);if(t.index>=this.parent.viewport.topIndex+r){var a=[],o=void 0;n?(o=xe(i.topLeftCell)[1],a.push(r),a.push(this.parent.viewport.leftIndex+n)):o=this.parent.viewport.leftIndex;var l=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:o,refresh:"Row",frozenIndexes:a,skipUpdateOnFirst:this.parent.viewport.topIndex+r===ae(i,r,!0)}),n&&(this.parent.viewport.leftIndex=l)}var h=xe(i.paneTopLeftCell)[0];t.index<h&&(this.parent.notify(g0,{scrollTop:Ei(i,r,h-1,!0)}),this.parent.goTo(Je(t.index,ae(i,n,!0,"columns")))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,rowIndex:this.parent.viewport.topIndex,colIndex:0,refresh:"Row"}),this.parent.selectRange(i.selectedRange);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.topIndex+r===ae(i,0,!0)||this.parent.viewport.bottomIndex===ae(i,i.rowCount-t.model.length-1,!1))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break;case"Column":if(t.activeSheetIndex===this.parent.activeSheetIndex){var n=this.parent.frozenColCount(i);if(!this.parent.scrollSettings.enableVirtualization||t.index<=this.parent.viewport.rightIndex)if(t.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var r=this.parent.frozenRowCount(i);if(t.index>=this.parent.viewport.leftIndex+n){var a=[];r&&(a=[r+this.parent.viewport.topIndex,n]);var u=r?xe(i.topLeftCell)[0]:this.parent.viewport.topIndex,c=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+n===ae(i,n,!0,"columns"),rowIndex:u,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:a}),r&&(this.parent.viewport.topIndex=c)}var d=xe(i.paneTopLeftCell)[1];t.index<d&&(this.parent.notify(g0,{scrollLeft:ci(i,0,d-1,!0)}),this.parent.goTo(Je(ae(i,r,!0),t.index))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,rowIndex:0,colIndex:this.parent.viewport.leftIndex,refresh:"Column"}),this.parent.selectRange(i.selectedRange);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.leftIndex+n===ae(i,0,!0,"columns")||this.parent.viewport.rightIndex===ae(i,i.colCount-t.model.length-1,!1,"columns"))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break}this.refreshImgElement(t.model.length,this.parent.activeSheetIndex,t.modelType,t.index),t.isAction?(delete t.isAction,this.parent.notify(yt,e),Fe(this.parent.element)):t.isUndoRedo||(t.isMethod=!0,this.parent.notify(Nf,e))},s.prototype.refreshImgElement=function(e,t,i,r){for(var n=this.parent.sheets[t],a,o=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],l=0;l<=o[2];l++)for(var h=o[1];h<=o[3];h++)a=Y(l,h,n),a&&a.image&&a.image.length>0&&(i==="Row"&&l>=r||i==="Column"&&h>=r)&&this.parent.notify(u0,{rowIdx:l,colIdx:h,sheetIdx:t,type:i,count:e,status:"insert"})},s.prototype.addEventListener=function(){this.parent.on(s1,this.insert,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(s1,this.insert)},s.prototype.getModuleName=function(){return"insert"},s}(),dY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.delete=function(e){var t=e.eventArgs;if(t.modelType==="Sheet"){var i=t.activeSheetIndex>=t.startIndex&&t.activeSheetIndex<=t.endIndex;i&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(t.startIndex<this.parent.sheets.length?t.startIndex:t.startIndex?t.startIndex-1:0)},!0),this.parent.notify(Wl,null),i&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else if(t.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.getActiveSheet();if(t.modelType==="Row"){if(!this.parent.scrollSettings.enableVirtualization||t.startIndex<=this.parent.viewport.bottomIndex)if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenRowCount(r);if(t.startIndex<xe(r.paneTopLeftCell)[0])this.parent.updateTopLeftCell(ae(r,t.startIndex-1<n?n:t.startIndex-1,!0)-n,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(t.freezePane||this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex>=ae(r,r.rowCount-1,!1))this.parent.renderModule.refreshSheet(!1,!1,!0);else{var a=[],o=this.parent.frozenColCount(r),l=void 0,h=this.parent.viewport.leftIndex;o?(a.push(n),a.push(h+o),l=xe(r.topLeftCell)[1]):l=h,this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,refresh:"Row",colIndex:l,skipUpdateOnFirst:this.parent.viewport.topIndex+n===ae(r,n,!0),frozenIndexes:a}),o&&(this.parent.viewport.leftIndex=h),this.parent.selectRange(r.selectedRange)}}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,refresh:"Row",rowIndex:this.parent.viewport.topIndex,colIndex:0}),this.parent.selectRange(r.selectedRange)}else{if(t.refreshSheet!==!1&&(!this.parent.scrollSettings.enableVirtualization||t.startIndex<=this.parent.viewport.rightIndex)){var o=this.parent.frozenColCount(r);if(this.parent.scrollSettings.enableVirtualization)if(t.startIndex<xe(r.paneTopLeftCell)[1])this.parent.updateTopLeftCell(null,ae(r,t.startIndex-1<o?o:t.startIndex-1,!0,"columns")-o,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(t.freezePane||t.refreshSheet===!0)this.parent.renderModule.refreshSheet(!1,!1,!0);else{var n=this.parent.frozenRowCount(r),a=[],u=this.parent.viewport.topIndex,c=n?xe(r.topLeftCell)[0]:u;n&&(a=[n+u,o]),this.parent.renderModule.refreshUI({rowIndex:c,refresh:"Column",colIndex:this.parent.viewport.leftIndex,insertDelete:!0,skipUpdateOnFirst:this.parent.viewport.leftIndex+o===ae(r,o,!0,"columns"),frozenIndexes:a}),n&&(this.parent.viewport.topIndex=u),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,refresh:"Column",rowIndex:0,colIndex:this.parent.viewport.leftIndex,insertDelete:!0}),this.parent.selectRange(r.selectedRange)}delete t.refreshSheet}}this.refreshImgElement(t.deletedModel.length,this.parent.activeSheetIndex,t.modelType,t.startIndex),t.isAction?(delete t.isAction,this.parent.notify(yt,e),Fe(this.parent.element)):t.isUndoRedo||(t.isMethod=!0,this.parent.notify(Nf,e))},s.prototype.addEventListener=function(){this.parent.on(a1,this.delete,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(a1,this.delete)},s.prototype.getModuleName=function(){return"delete"},s.prototype.refreshImgElement=function(e,t,i,r){for(var n=this.parent.sheets[t],a,o=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],l=0;l<=o[2];l++)for(var h=o[1];h<=o[3];h++)a=Y(l,h,n),a&&a.image&&a.image.length>0&&(i==="Row"&&l>=r||i==="Column"&&h>=r)&&this.parent.notify(u0,{rowIdx:l,colIdx:h,sheetIdx:t,type:i,count:e,status:"delete"})},s}(),ns="",Ag="",Cp="",Nr=[],pY="e-active",L0="";function qm(s,e,t,i,r,n,a,o,l){!n||ns===""?Cp!=""?(ns=Cp+String.fromCharCode(s),Cp=""):ns+=String.fromCharCode(s):ns==Ag&&(Cp=String.fromCharCode(s)),o?(setTimeout(function(){Cp=""},700),setTimeout(function(){ns=""},3e3)):setTimeout(function(){ns=""},1e3);var h;if(ns=i?ns.toLowerCase():ns,L0===r&&Ag===ns&&!l){for(var u=0;u<Nr.length;u++){if(Nr[u].classList.contains(pY)){h=u;break}if(a&&Nr[u].textContent.toLowerCase()===a.toLowerCase()){h=u;break}}return h=h+1,o?Nr[h]&&Nr.length-1!=h?Nr[h]:Nr[Nr.length]:Nr[h]?Nr[h]:Nr[0]}else{var c=e,d=ns.length,p=void 0,f=void 0;t=t?t+1:0;var u=t;Nr=[];do u===c.length&&(u=-1),u===-1?h=0:h=u,f=c[h],p=i?f.innerText.toLowerCase():f.innerText,p.substr(0,d)===ns&&Nr.push(c[h]),u++;while(u!==t);if(Ag=ns,L0=r,o){for(var v=!1,g=0;g<Nr.length;g++)if(a&&Nr[g].textContent.toLowerCase()===a.toLowerCase()){h=g,v=!0;break}return a&&v&&(h=h+1),Nr[h]?Nr[h]:Nr[0]}return Nr[0]}}function nc(s,e,t,i,r,n,a){var o=e;i=i??!0;var l={item:null,index:null};if(s&&s.length){var h=s.length,u=i?s.toLocaleLowerCase():s;u=fY(u);for(var c=function(v,g){var b=g[v],y=void 0,C;if(e&&r){var x=b,w=n.text.split(".");r.filter(function(M){Array.prototype.slice.call(w).forEach(function(E){(a==="object"&&!M.isHeader&&x.textContent.toString().indexOf(M[E])!==-1&&x.getAttribute("data-value")===M[n.value].toString()||a==="string"&&x.textContent.toString().indexOf(M)!==-1)&&(C=a==="object"?M[E]:M)})})}if(y=r&&C?(i?C.toString().toLocaleLowerCase():C).replace(/^\s+|\s+$/g,""):(i?b.textContent.toLocaleLowerCase():b.textContent).replace(/^\s+|\s+$/g,""),t==="Equal"&&y===u||t==="StartsWith"&&y.substr(0,h)===u||t==="EndsWith"&&y.substr(y.length-u.length)===u||t==="Contains"&&new RegExp(u,"g").test(y))return l.item=b,l.index=v,{value:{item:b,index:v}}},d=0,p=o;d<p.length;d++){var f=c(d,p);if(typeof f=="object")return f.value}return l}return l}function fY(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function vY(s){L0===s&&(L0="",Ag="",ns="",Nr=[])}function Ym(s,e,t,i){if(e!==""){var r=t?"gim":"gm";e=/^[a-zA-Z0-9- ]*$/.test(e)?e:e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var n=i==="StartsWith"?"^("+e+")":i==="EndsWith"?"("+e+")$":"("+e+")";Qz(s,new RegExp(n,r))}}function Qz(s,e){for(var t=0;s.childNodes&&t<s.childNodes.length;t++)if(s.childNodes[t].nodeType===3&&s.childNodes[t].textContent.trim()!==""){var i=s.childNodes[t].nodeValue.trim().replace(e,'<span class="e-highlight">$1</span>');s.childNodes[t].nodeValue="",s.innerHTML=s.innerHTML.trim()+i;break}else Qz(s.childNodes[t],e)}function mY(s){for(var e=s.querySelectorAll(".e-highlight"),t=e.length-1;t>=0;t--){var i=e[t].parentNode,r=document.createTextNode(e[t].textContent);i.replaceChild(r,e[t])}}var Gz=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},$z=function(s){Gz(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Bi([S()],e.prototype,"text",void 0),Bi([S()],e.prototype,"value",void 0),Bi([S()],e.prototype,"iconCss",void 0),Bi([S()],e.prototype,"groupBy",void 0),Bi([S()],e.prototype,"htmlAttributes",void 0),e}(ke),Ke={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:"e-list-item",group:"e-list-group-item",disabled:"e-disabled",grouping:"e-dd-group"},gY="ItemTemplate",yY="DisplayTemplate",bY="SpinnerTemplate",CY="ValueTemplate",SY="GroupTemplate",xY="HeaderTemplate",wY="FooterTemplate",MY="NoRecordsTemplate",EY="ActionFailureTemplate",IY="e-hide-group-header",TY=function(s){Gz(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.preventChange=!1,r.isAngular=!1,r.isPreventChange=!1,r.isDynamicDataChange=!1,r.addedNewItem=!1,r.isAddNewItemTemplate=!1,r.isRequesting=!1,r.isVirtualizationEnabled=!1,r.isAllowFiltering=!1,r.virtualizedItemsCount=0,r.totalItemCount=0,r.dataCount=0,r.isRemoteDataUpdated=!1,r.isIncrementalRequest=!1,r.itemCount=10,r}return e.prototype.getPropObject=function(t,i,r){var n=new Object,a=new Object,o=function(h){return h};n[o(t)]=i[o(t)],a[o(t)]=r[o(t)];var l=new Object;return l.newProperty=n,l.oldProperty=a,l},e.prototype.getValueByText=function(t,i,r){var n=null;return m(this.listData)||(i?n=this.checkValueCase(t,!0,r):n=this.checkValueCase(t,!1,r)),n},e.prototype.checkValueCase=function(t,i,r,n){var a=this,o=null;n&&(o=t);var l=this.listData,h=this.fields,u=this.typeOfData(l).typeof;if(u==="string"||u==="number"||u==="boolean")for(var c=0,d=l;c<d.length;c++){var p=d[c];m(p)||(r?o=this.checkingAccent(String(p),t,i):i?this.checkIgnoreCase(String(p),t)&&(o=this.getItemValue(String(p),t,i)):this.checkNonIgnoreCase(String(p),t)&&(o=this.getItemValue(String(p),t,i,n)))}else if(i)l.filter(function(v){var g=ie(h.value,v);!m(g)&&a.checkIgnoreCase(ie(h.text,v).toString(),t)&&(o=ie(h.value,v))});else if(n){var f=null;f=o,l.filter(function(v){var g=ie(h.value,v);!m(g)&&!m(o)&&g.toString()===f.toString()&&(o=ie(h.text,v))})}else l.filter(function(v){a.checkNonIgnoreCase(ie(h.text,v),t)&&(o=ie(h.value,v))});return o},e.prototype.checkingAccent=function(t,i,r){var n=ce.ignoreDiacritics(String(t)),a=ce.ignoreDiacritics(i.toString()),o=null;return r?this.checkIgnoreCase(n,a)&&(o=this.getItemValue(String(t),i,r)):this.checkNonIgnoreCase(String(t),i)&&(o=this.getItemValue(String(t),i,r)),o},e.prototype.checkIgnoreCase=function(t,i){return String(t).toLowerCase()===i.toString().toLowerCase()},e.prototype.checkNonIgnoreCase=function(t,i){return String(t)===i.toString()},e.prototype.getItemValue=function(t,i,r,n){var a=null,o=this.listData,l=this.typeOfData(o).typeof;return n?a=t.toString():r?a=l==="string"?String(t):this.getFormattedValue(String(t)):a=l==="string"?i:this.getFormattedValue(i),a},e.prototype.templateCompiler=function(t){var i=!1;if(typeof t!="function"&&t)try{i=!!ze(t,document).length}catch{i=!1}return i},e.prototype.l10nUpdate=function(t){var i=this.getModuleName()==="listbox"?this.ulElement:this.list;if(this.noRecordsTemplate!=="No records found"||this.actionFailureTemplate!=="Request failed"){var r=t?this.actionFailureTemplate:this.noRecordsTemplate,n=void 0,a=t?this.actionFailureTemplateId:this.noRecordsTemplateId;i.innerHTML="";var o=this.templateCompiler(r);typeof r!="function"&&o?n=pi($(r,document).innerHTML.trim()):n=pi(r);var l=t?"actionFailureTemplate":"noRecordsTemplate",h=void 0;if(this.isReact&&typeof r=="function"?h=n({},this,l,a,this.isStringTemplate,null):h=n({},this,l,a,this.isStringTemplate,null,i),h&&h.length>0)for(var u=0;u<h.length;u++)if(this.getModuleName()==="listbox"&&l==="noRecordsTemplate")if(h[u].nodeName==="#text"){var c=this.createElement("li");c.textContent=h[u].textContent,c.classList.add("e-list-nrt"),c.setAttribute("role","option"),i.appendChild(c)}else h[u].classList.add("e-list-nr-template"),i.appendChild(h[u]);else h[u]instanceof HTMLElement&&i.appendChild(h[u]);this.renderReactTemplates()}else{var d={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed"},p=new In(this.getLocaleName(),{},this.locale);p.getConstant("actionFailureTemplate")!==""||p.getConstant("noRecordsTemplate")!==""?this.l10n=p:this.l10n=new In(this.getModuleName()==="listbox"?"listbox":this.getModuleName()==="mention"?"mention":"dropdowns",d,this.locale);var f=t?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate");if(this.getModuleName()==="listbox"){var c=this.createElement("li");c.textContent=f,i.appendChild(c),c.classList.add("e-list-nrt"),c.setAttribute("role","option")}else m(i)||(i.innerHTML=f)}},e.prototype.getLocaleName=function(){return"drop-down-base"},e.prototype.getTextByValue=function(t){var i=this.checkValueCase(t,!1,!1,!0);return i},e.prototype.getFormattedValue=function(t){if(this.listData&&this.listData.length){var i=void 0;if(this.properties.allowCustomValue&&this.properties.value&&this.properties.value instanceof Array&&this.properties.value.length>0?i=this.typeOfData(this.properties.value):i=this.typeOfData(this.listData),typeof ie(this.fields.value?this.fields.value:"value",i.item)=="number"||i.typeof==="number")return parseFloat(t);if(typeof ie(this.fields.value?this.fields.value:"value",i.item)=="boolean"||i.typeof==="boolean")return t==="true"||""+t=="true"}return t},e.prototype.setEnableRtl=function(){m(this.enableRtlElements)||(this.list&&this.enableRtlElements.push(this.list),this.enableRtl?Q(this.enableRtlElements,Ke.rtl):te(this.enableRtlElements,Ke.rtl))},e.prototype.initialize=function(t){if(this.bindEvent=!0,this.actionFailureTemplateId=""+this.element.id+EY,this.element.tagName==="UL"){var i=Et.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(i,this.fields)}else if(this.element.tagName==="SELECT"){var r=this.dataSource instanceof Array?this.dataSource.length>0:!m(this.dataSource);r?this.isDynamicDataChange&&this.setListData(this.dataSource,this.fields,this.query):this.renderItemsBySelect()}else this.setListData(this.dataSource,this.fields,this.query,t)},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.updateDataAttribute=function(t){for(var i=["class","style","id","type","aria-expanded","aria-autocomplete","aria-readonly"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&!(this.getModuleName()==="dropdownlist"&&this.element.attributes[n].name==="readonly")&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));me(r,t,r),this.setProperties({htmlAttributes:r},!0)},e.prototype.renderItemsBySelect=function(){var t=this.element,i={value:"value",text:"text"},r=[],n=t.querySelectorAll("select>optgroup"),a=t.querySelectorAll("select>option");if(this.getJSONfromOption(r,a,i),n.length){for(var o=0;o<n.length;o++){var l=n[o],h={};h[i.text]=l.label,h.isHeader=!0;var u=l.querySelectorAll("option");r.push(h),this.getJSONfromOption(r,u,i)}t.querySelectorAll("select>option")}this.updateFields(i.text,i.value,this.fields.groupBy,this.fields.htmlAttributes,this.fields.iconCss),this.resetList(r,i)},e.prototype.updateFields=function(t,i,r,n,a){var o={fields:{text:t,value:i,groupBy:m(r)?this.fields&&this.fields.groupBy:r,htmlAttributes:m(n)?this.fields&&this.fields.htmlAttributes:n,iconCss:m(a)?this.fields&&this.fields.iconCss:a}};this.setProperties(o,!0)},e.prototype.getJSONfromOption=function(t,i,r){for(var n=0,a=i;n<a.length;n++){var o=a[n],l={};l[r.text]=o.innerText,l[r.value]=m(o.getAttribute(r.value))?o.innerText:o.getAttribute(r.value),t.push(l)}},e.prototype.preRender=function(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=""+this.element.id+gY,this.displayTemplateId=""+this.element.id+yY,this.spinnerTemplateId=""+this.element.id+bY,this.valueTemplateId=""+this.element.id+CY,this.groupTemplateId=""+this.element.id+SY,this.headerTemplateId=""+this.element.id+xY,this.footerTemplateId=""+this.element.id+wY,this.noRecordsTemplateId=""+this.element.id+MY},e.prototype.setListData=function(t,i,r,n){var a=this;i=i||this.fields;var o;this.isActive=!0;var l={cancel:!1,data:t,query:r};this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.isRequesting||this.trigger("actionBegin",l,function(h){if(!h.cancel)if(a.isRequesting=!0,a.showSpinner(),t instanceof ge&&!a.virtualGroupDataSource){if(a.isRequested=!0,a.isDataFetched){a.emptyDataRequest(i);return}h.data.executeQuery(a.getQuery(h.query)).then(function(g){a.isPreventChange=a.isAngular&&a.preventChange?!0:a.isPreventChange,a.trigger("actionComplete",g,function(b){if(!a.virtualGroupDataSource&&a.isVirtualizationEnabled){if(a.isRemoteDataUpdated=!0,a.getModuleName()==="combobox"&&a.isAllowFiltering&&a.isVirtualizationEnabled&&b.result&&(b.result=b.result.result),b.result.length>0){var y=b.result;if(a.isVirtualizationEnabled&&a.fields.groupBy){var C=new ge(y).executeLocal(new $e().group(a.fields.groupBy));a.virtualGroupDataSource=C.records}else{a.virtualGroupDataSource=y,a.hideSpinner(),a.isRequested=!1,a.isRequesting=!1,a.setListData(y,i,r,n);return}}a.hideSpinner(),a.isRequested=!1,a.isRequesting=!1,a.updatePopupState();return}if(!b.cancel){a.isRequesting=!1;var x=b.result;if(a.isIncrementalRequest){o=a.renderItems(x,i);return}x.length===0&&(a.isDataFetched=!0),a.dataCount=b.count,a.totalItemCount=b.count,o=a.renderItems(x,i),a.onActionComplete(o,x,b),a.groupTemplate&&a.renderGroupTemplate(o),a.isRequested=!1,a.bindChildItems(x,o,i,b)}})}).catch(function(g){a.isRequested=!1,a.isRequesting=!1,a.onActionFailure(g),a.hideSpinner()})}else{a.isRequesting=!1;var u=void 0;if(a.isVirtualizationEnabled&&!a.virtualGroupDataSource&&a.fields.groupBy){var c=new ge(a.dataSource).executeLocal(new $e().group(a.fields.groupBy));a.virtualGroupDataSource=c.records}var d=a.isVirtualizationEnabled&&a.virtualGroupDataSource?new ge(a.virtualGroupDataSource):new ge(h.data);if(u=a.getQuery(h.query).executeLocal(d),a.isVirtualizationEnabled&&a.getModuleName()==="autocomplete"&&u.count!=0&&u.count<a.itemCount*2){var p=a.getQuery(h.query);if(p){for(var f=0;f<p.queries.length;f++)if(p.queries[f].fn==="onTake"){p.queries[f].e.nos=u.count,u=p.executeLocal(d);break}}}a.dataCount=u.count,a.totalItemCount=u.count,u=a.isVirtualizationEnabled?u.result:u;var v={cancel:!1,result:u};a.isPreventChange=a.isAngular&&a.preventChange?!0:a.isPreventChange,a.trigger("actionComplete",v,function(g){if(a.isIncrementalRequest){o=a.renderItems(g.result,i);return}g.cancel||(o=a.renderItems(g.result,i),a.onActionComplete(o,g.result,n),a.groupTemplate&&a.renderGroupTemplate(o),a.bindChildItems(g.result,o,i),setTimeout(function(){a.getModuleName()==="multiselect"&&a.itemTemplate!=null&&o.childElementCount>0&&(o.children[0].childElementCount>0||a.fields.groupBy&&o.children[1]&&o.children[1].childElementCount>0)&&a.updateDataList()}))})}})},e.prototype.updatePopupState=function(){},e.prototype.updateRemoteData=function(){this.setListData(this.dataSource,this.fields,this.query)},e.prototype.bindChildItems=function(t,i,r,n){var a=this;t.length>=100&&this.getModuleName()==="autocomplete"?setTimeout(function(){var o=a.remainingItems(a.sortedData,r);Ut(o,i),a.liCollections=a.list.querySelectorAll("."+Ke.li),a.updateListValues(),a.raiseDataBound(t,n)},0):this.raiseDataBound(t,n)},e.prototype.updateListValues=function(){},e.prototype.findListElement=function(t,i,r,n){var a=null;if(t){for(var o=[].slice.call(t.querySelectorAll(i)),l=0;l<o.length;l++)if(o[l].getAttribute(r)===n+""){a=o[l];break}}return a},e.prototype.raiseDataBound=function(t,i){this.hideSpinner();var r={items:t,e:i};this.trigger("dataBound",r)},e.prototype.remainingItems=function(t,i){var r=new ge(t).executeLocal(new $e().skip(100));if(this.itemTemplate){var n=this.templateListItem(r,i);return[].slice.call(n.childNodes)}var a=this.typeOfData(r).typeof;return a==="string"||a==="number"||a==="boolean"?Et.createListItemFromArray(this.createElement,r,!0,this.listOption(r,i),this):Et.createListItemFromJson(this.createElement,r,this.listOption(r,i),1,!0,this)},e.prototype.emptyDataRequest=function(t){var i=[];this.onActionComplete(this.renderItems(i,t),i),this.isRequested=!1,this.hideSpinner()},e.prototype.showSpinner=function(){},e.prototype.hideSpinner=function(){},e.prototype.onActionFailure=function(t){this.liCollections=[],this.trigger("actionFailure",t),this.l10nUpdate(!0),m(this.list)||Q([this.list],Ke.noData)},e.prototype.onActionComplete=function(t,i,r){if(this.listData=i,this.isVirtualizationEnabled&&this.notify("setGeneratedData",{module:"VirtualScroll"}),this.getModuleName()!=="listbox"&&t.setAttribute("tabindex","0"),this.isReact&&this.clearTemplate(["itemTemplate","groupTemplate","actionFailureTemplate","noRecordsTemplate"]),this.isVirtualizationEnabled||(this.fixedHeaderElement=m(this.fixedHeaderElement)?this.fixedHeaderElement:null),this.getModuleName()==="multiselect"&&this.properties.allowCustomValue&&this.fields.groupBy)for(var n=0;n<t.childElementCount;n++)t.children[n].classList.contains("e-list-group-item")&&(m(t.children[n].innerHTML)||t.children[n].innerHTML=="")&&Q([t.children[n]],IY);m(this.list)||this.isVirtualizationEnabled||(this.list.innerHTML="",this.list.appendChild(t),this.liCollections=this.list.querySelectorAll("."+Ke.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,i,this.bindEvent))},e.prototype.postRender=function(t,i,r){var n=t.querySelector("."+Ke.li),a=t.querySelector("."+Ke.selected);n&&!a&&n.classList.add(Ke.focus),i.length<=0?(this.l10nUpdate(),Q([t],Ke.noData)):t.classList.remove(Ke.noData)},e.prototype.getQuery=function(t){return t||(this.query?this.query:new $e)},e.prototype.updateVirtualizationProperties=function(t,i){this.isVirtualizationEnabled=!0,this.virtualizedItemsCount=t,this.isAllowFiltering=i},e.prototype.renderGroupTemplate=function(t){if(this.fields.groupBy!==null&&this.dataSource||this.element.querySelector("."+Ke.group)){var i=this.dataSource,r={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},n=t.querySelectorAll("."+Ke.group),a=this.templateCompiler(this.groupTemplate);if(typeof this.groupTemplate!="function"&&a){var o=$(this.groupTemplate,document).innerHTML.trim(),l=Et.renderGroupTemplate(o,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}else{var l=Et.renderGroupTemplate(this.groupTemplate,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}this.renderReactTemplates()}},e.prototype.createListItems=function(t,i){if(t){i.groupBy||this.element.querySelector("optgroup")?(i.groupBy&&(this.sortOrder!=="None"&&(t=this.getSortedDataSource(t)),t=Et.groupDataSource(t,i.properties,this.sortOrder)),Q([this.list],Ke.grouping)):t=this.getSortedDataSource(t);var r=this.listOption(t,i),n=t.length>100?new ge(t).executeLocal(new $e().take(100)):t;return this.sortedData=t,Et.createList(this.createElement,this.getModuleName()==="autocomplete"?n:t,r,!0,this)}return null},e.prototype.listOption=function(t,i){var r=!m(i.iconCss),n=m(i.properties)?i:i.properties,a=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}};return me({},a,i,!0)},e.prototype.setFloatingHeader=function(t){!m(this.list)&&!this.list.classList.contains(Ke.noData)&&(m(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:Ke.fixedHead}),!m(this.list)&&!this.list.querySelector("li").classList.contains(Ke.group)&&(this.fixedHeaderElement.style.display="none"),!m(this.fixedHeaderElement)&&!m(this.list)&&xs([this.fixedHeaderElement],this.list),this.setFixedHeader()),!m(this.fixedHeaderElement)&&this.fixedHeaderElement.style.zIndex==="0"&&this.setFixedHeader(),this.scrollStop(t))},e.prototype.scrollStop=function(t,i){for(var r=m(t)?this.list:t.target,n=parseInt(getComputedStyle(this.getValidLi(),null).getPropertyValue("height"),10),a=Math.round(r.scrollTop/n),o=this.list.querySelectorAll("li:not(.e-hide-listitem)"),l=this.list.querySelectorAll(".e-virtual-list").length,h=0,u=!1,c=a;c>-1;c--){var d=this.isVirtualizationEnabled?c+l:c;if(this.isVirtualizationEnabled){var p=this.list.querySelectorAll(".e-list-group-item").length,f=0;if(u&&h++,this.updateGroupHeader(d,o,r)&&(f++,h>=this.getPageCount()||p<=f))break;i&&(!m(o[d])&&o[d].classList.contains(Ke.selected)&&this.getModuleName()!=="autocomplete"||!m(o[d])&&o[d].classList.contains(Ke.focus)&&this.getModuleName()==="autocomplete")&&(h++,u=!0)}else if(this.updateGroupHeader(d,o,r))break}},e.prototype.getPageCount=function(t){var i=this.list.classList.contains(Ke.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height"),r=Math.round(this.list.getBoundingClientRect().height/parseInt(i,10));return t?r:Math.round(r)},e.prototype.updateGroupHeader=function(t,i,r){return!m(i[t])&&i[t].classList.contains(Ke.group)?(this.updateGroupFixedHeader(i[t],r),!0):(this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none",!1)},e.prototype.updateGroupFixedHeader=function(t,i){this.fixedHeaderElement.innerHTML=t.innerHTML,this.fixedHeaderElement.style.position="fixed",this.fixedHeaderElement.style.top=this.list.parentElement.offsetTop+this.list.offsetTop+"px",this.fixedHeaderElement.style.display="block"},e.prototype.getValidLi=function(){return this.liCollections[0]},e.prototype.renderItems=function(t,i){var r;if(this.itemTemplate&&t){var n=t;n&&i.groupBy?(this.sortOrder!=="None"&&(n=this.getSortedDataSource(n)),n=Et.groupDataSource(n,i.properties,this.sortOrder)):n=this.getSortedDataSource(n),this.sortedData=n;var a=n.length>100?new ge(n).executeLocal(new $e().take(100)):n;if(r=this.templateListItem(this.getModuleName()==="autocomplete"?a:n,i),this.isVirtualizationEnabled){var o=this.list.querySelector(".e-list-parent"),l=this.list.querySelector(".e-virtual-ddl-content");t.length>=this.virtualizedItemsCount&&o&&l||o&&l&&this.isAllowFiltering||o&&l&&this.getModuleName()==="autocomplete"?(l.replaceChild(r,o),this.updateListElements(t)):l||(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(r),this.updateListElements(t))}}else{if(r=this.createListItems(t,i),this.isIncrementalRequest)return this.incrementalLiCollections=r.querySelectorAll("."+Ke.li),this.incrementalUlElement=r,this.incrementalListData=t,r;if(this.isVirtualizationEnabled){var o=this.list.querySelector(".e-list-parent"),l=this.list.querySelector(".e-virtual-ddl-content");t.length>=this.virtualizedItemsCount&&o&&l||o&&l&&this.isAllowFiltering||o&&l&&this.getModuleName()==="autocomplete"?(l.replaceChild(r,o),this.updateListElements(t)):l||(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(r),this.updateListElements(t))}}return r},e.prototype.createVirtualContent=function(){this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content"}))},e.prototype.updateListElements=function(t){this.liCollections=this.list.querySelectorAll("."+Ke.li),this.ulElement=this.list.querySelector("ul"),this.listData=t,this.postRender(this.list,t,this.bindEvent)},e.prototype.templateListItem=function(t,i){var r=this.listOption(t,i);r.templateID=this.itemTemplateId,r.isStringTemplate=this.isStringTemplate;var n=this.templateCompiler(this.itemTemplate);if(typeof this.itemTemplate!="function"&&n){var a=$(this.itemTemplate,document).innerHTML.trim();return Et.renderContentTemplate(this.createElement,a,t,i.properties,r,this)}else return Et.renderContentTemplate(this.createElement,this.itemTemplate,t,i.properties,r,this)},e.prototype.typeOfData=function(t){for(var i={typeof:null,item:null},r=0;!m(t)&&r<t.length;r++)if(!m(t[r])){var n=typeof t[r]=="string"||typeof t[r]=="number"||typeof t[r]=="boolean",a=m(n?t[r]:ie(this.fields.value?this.fields.value:"value",t[r]));if(!a)return i={typeof:typeof t[r],item:t[r]}}return i},e.prototype.setFixedHeader=function(){m(this.list)||(this.list.parentElement.style.display="block");var t=0;if(this.list&&this.list.parentElement&&(t=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10),isNaN(t))){var i=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-top-width"),10),r=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-bottom-width"),10),n=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-left-width"),10),a=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-right-width"),10);t=i+r+n+a}if(!m(this.liCollections)){var o=this.getValidLi().offsetWidth-t;this.fixedHeaderElement.style.width=o.toString()+"px"}tt(this.fixedHeaderElement,{zIndex:10});var l=this.ulElement.querySelector("."+Ke.group+":not(.e-hide-listitem)");this.fixedHeaderElement.innerHTML=l.innerHTML},e.prototype.getSortedDataSource=function(t){if(t&&this.sortOrder!=="None"){var i=this.fields.text?this.fields.text:"text";(this.typeOfData(t).typeof==="string"||this.typeOfData(t).typeof==="number"||this.typeOfData(t).typeof==="boolean")&&(i=""),t=Et.getDataSource(t,Et.addSorting(this.sortOrder,i))}return t},e.prototype.getIndexByValue=function(t){for(var i,r=this.getItems(),n=0;n<r.length;n++)if(!m(t)&&r[n].getAttribute("data-value")===t.toString()){i=n;break}return i},e.prototype.getIndexByValueFilter=function(t){var i,r=this.renderItems(this.selectData,this.fields);if(r&&r.children){for(var n=0;n<r.children.length;n++)if(!m(t)&&r.children[n].getAttribute("data-value")===t.toString()){i=n;break}}return i},e.prototype.dispatchEvent=function(t,i){var r=document.createEvent("HTMLEvents");r.initEvent(i,!1,!0),t&&t.dispatchEvent(r)},e.prototype.setFields=function(){this.fields.value&&!this.fields.text?this.updateFields(this.fields.value,this.fields.value):!this.fields.value&&this.fields.text?this.updateFields(this.fields.text,this.fields.text):!this.fields.value&&!this.fields.text&&this.updateFields("text","text")},e.prototype.resetList=function(t,i,r,n){if(this.list){if(this.element.tagName==="SELECT"&&this.element.options.length>0||this.element.tagName==="UL"&&this.element.childNodes.length>0){var a=t instanceof Array?t.length>0:!m(t);!a&&this.selectData&&this.selectData.length>0&&(t=this.selectData)}t=this.getModuleName()==="combobox"&&this.selectData&&t instanceof Array&&t.length<this.selectData.length&&this.addedNewItem?this.selectData:t,this.addedNewItem=!1,this.setListData(t,i,r,n)}},e.prototype.updateSelectElementData=function(t){(t||this.isVirtualizationEnabled)&&m(this.selectData)&&this.listData&&this.listData.length>0&&(this.selectData=this.listData)},e.prototype.updateSelection=function(){},e.prototype.renderList=function(){this.render()},e.prototype.updateDataSource=function(t){this.resetList(this.dataSource),this.totalItemCount=this.dataSource instanceof ge?this.dataSource.dataSource.json.length:0},e.prototype.setUpdateInitial=function(t,i){this.isDataFetched=!1;for(var r={},n=0;t.length>n;n++)i[t[n]]&&t[n]==="fields"?(this.setFields(),r[t[n]]=i[t[n]]):i[t[n]]&&(r[t[n]]=i[t[n]]);Object.keys(r).length>0&&(Object.keys(r).indexOf("dataSource")===-1&&(r.dataSource=this.dataSource),this.updateDataSource(r))},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="dropdownbase"&&this.setUpdateInitial(["fields","query","dataSource"],t),this.setUpdateInitial(["sortOrder","itemTemplate"],t);for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){var o=this.ulElement.querySelector("."+Ke.group);this.fixedHeaderElement.innerHTML=o.innerHTML}break;case"locale":this.list&&!m(this.liCollections)&&this.liCollections.length===0&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:t.zIndex},!0),this.setZIndex();break}}},e.prototype.render=function(t,i){this.getModuleName()==="listbox"?this.list=this.createElement("div",{className:Ke.content,attrs:{tabindex:"0"}}):this.list=this.createElement("div",{className:Ke.content}),this.list.classList.add(Ke.root),this.setFields();var r={duration:300,selector:"."+Ke.li};this.rippleFun=yr(this.list,r);var n=this.element.querySelector("select>optgroup");if((this.fields.groupBy||!m(n))&&!this.isGroupChecking&&I.add(this.list,"scroll",this.setFloatingHeader,this),this.getModuleName()==="dropdownbase"){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),te([this.element],Ke.root),this.element.style.display="none";var a=this.createElement("div");this.element.parentElement.insertBefore(a,this.element),a.appendChild(this.element),a.appendChild(this.list)}this.setEnableRtl(),i||this.initialize(t)},e.prototype.removeScrollEvent=function(){this.list&&I.remove(this.list,"scroll",this.setFloatingHeader)},e.prototype.getModuleName=function(){return"dropdownbase"},e.prototype.getItems=function(){return this.ulElement.querySelectorAll("."+Ke.li)},e.prototype.addItem=function(t,i){if((!this.list||this.list.textContent===this.noRecordsTemplate&&this.getModuleName()!=="listbox")&&this.renderList(),this.sortOrder!=="None"&&m(i)){var r=[].slice.call(this.listData);r.push(t),r=this.getSortedDataSource(r),this.fields.groupBy&&(r=Et.groupDataSource(r,this.fields.properties,this.sortOrder)),i=r.indexOf(t)}var n=this.getItems().length,a=this.list.querySelector("."+Ke.selected);t=t instanceof Array?t:[t];var o;o=m(i)||i<0||i>n-1?n:i;var l=this.fields;t&&l.groupBy&&(t=Et.groupDataSource(t,l.properties));for(var h=[],u=0;u<t.length;u++){var c=t[u],d=c.isHeader,p=this.createElement("li",{className:d?Ke.group:Ke.li,id:"option-add-"+u}),f=c instanceof Object?ie(l.text,c):c;if(d&&(p.innerText=f),this.itemTemplate&&!d){var v=this.templateCompiler(this.itemTemplate),g=typeof this.itemTemplate!="function"&&v?pi($(this.itemTemplate,document).innerHTML.trim()):pi(this.itemTemplate),b=g(c,this,"itemTemplate",this.itemTemplateId,this.isStringTemplate,null,p);b&&Ut(b,p)}else d||p.appendChild(document.createTextNode(f));p.setAttribute("data-value",c instanceof Object?ie(l.value,c):c),p.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:p}),h.push(p),this.listData.push(c),this.sortOrder==="None"&&m(i)&&o===0&&(o=null),this.updateActionCompleteData(p,c,o),this.trigger("beforeItemRender",{element:p,item:c})}if(n===0&&m(this.list.querySelector("ul")))m(this.list)||(this.list.innerHTML="",this.list.classList.remove(Ke.noData),this.isAddNewItemTemplate=!0,m(this.ulElement)||this.list.appendChild(this.ulElement)),this.liCollections=h,!m(h)&&!m(this.ulElement)&&Ut(h,this.ulElement),this.updateAddItemList(this.list,n);else{this.getModuleName()==="listbox"&&n===0&&(this.ulElement.innerHTML="");for(var y=[],u=0;u<t.length;u++){for(var C=this.ulElement.querySelectorAll(".e-list-group-item"),x=0;x<C.length;x++)y[x]=C[x].innerText;if(y.indexOf(h[u].innerText)>-1&&l.groupBy){for(var x=0;x<C.length;x++)if(y[x]===h[u].innerText){this.sortOrder==="None"?this.ulElement.insertBefore(h[u+1],C[x+1]):this.ulElement.insertBefore(h[u+1],this.ulElement.childNodes[i]),u=u+1;break}}else this.liCollections[o]?this.liCollections[o].parentNode.insertBefore(h[u],this.liCollections[o]):this.ulElement.appendChild(h[u]);var w=[].slice.call(this.liCollections);w.splice(o,0,h[u]),this.liCollections=w,o+=1,this.getModuleName()==="multiselect"&&this.updateDataList()}}this.getModuleName()==="listbox"&&this.isReact&&this.renderReactTemplates(),(a||i===0)&&this.updateSelection(),this.addedNewItem=!0},e.prototype.validationAttribute=function(t,i){var r=t.getAttribute("name")?t.getAttribute("name"):t.getAttribute("id");i.setAttribute("name",r),t.removeAttribute("name");for(var n=["required","aria-required","form"],a=0;a<n.length;a++)if(t.getAttribute(n[a])){var o=t.getAttribute(n[a]);i.setAttribute(n[a],o),t.removeAttribute(n[a])}},e.prototype.setZIndex=function(){},e.prototype.updateActionCompleteData=function(t,i,r){},e.prototype.updateAddItemList=function(t,i){},e.prototype.updateDataList=function(){},e.prototype.getDataByValue=function(t){if(!m(this.listData)){var i=this.typeOfData(this.listData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.listData;r<n.length;r++){var a=n[r];if(!m(a)&&a===t)return a}else for(var o=0,l=this.listData;o<l.length;o++){var a=l[o];if(!m(a)&&ie(this.fields.value?this.fields.value:"value",a)===t)return a}}return null},e.prototype.destroy=function(){document.body.contains(this.list)&&(I.remove(this.list,"scroll",this.setFloatingHeader),m(this.rippleFun)||this.rippleFun(),ne(this.list)),this.liCollections=null,this.ulElement=null,this.list=null,this.enableRtlElements=null,this.rippleFun=null,s.prototype.destroy.call(this)},Bi([Ee({text:null,value:null,iconCss:null,groupBy:null},$z)],e.prototype,"fields",void 0),Bi([S(null)],e.prototype,"itemTemplate",void 0),Bi([S(null)],e.prototype,"groupTemplate",void 0),Bi([S("No records found")],e.prototype,"noRecordsTemplate",void 0),Bi([S("Request failed")],e.prototype,"actionFailureTemplate",void 0),Bi([S("None")],e.prototype,"sortOrder",void 0),Bi([S([])],e.prototype,"dataSource",void 0),Bi([S(null)],e.prototype,"query",void 0),Bi([S("StartsWith")],e.prototype,"filterType",void 0),Bi([S(!0)],e.prototype,"ignoreCase",void 0),Bi([S(1e3)],e.prototype,"zIndex",void 0),Bi([S(!1)],e.prototype,"ignoreAccent",void 0),Bi([S()],e.prototype,"locale",void 0),Bi([_()],e.prototype,"actionBegin",void 0),Bi([_()],e.prototype,"actionComplete",void 0),Bi([_()],e.prototype,"actionFailure",void 0),Bi([_()],e.prototype,"select",void 0),Bi([_()],e.prototype,"dataBound",void 0),Bi([_()],e.prototype,"created",void 0),Bi([_()],e.prototype,"destroyed",void 0),e=Bi([Ot],e),e}(Pi),DY=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),hl=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},px={TEXTSHAPE:"e-skeleton-text",CIRCLESHAPE:"e-skeleton-circle",SQUARESHAPE:"e-skeleton-square",RECTANGLESHAPE:"e-skeleton-rectangle",WAVEEFFECT:"e-shimmer-wave",PULSEEFFECT:"e-shimmer-pulse",FADEEFFECT:"e-shimmer-fade",VISIBLENONE:"e-visible-none"},Fk;(function(s){s.Text="Text",s.Circle="Circle",s.Square="Square",s.Rectangle="Rectangle"})(Fk||(Fk={}));var Pk;(function(s){s.Wave="Wave",s.Fade="Fade",s.Pulse="Pulse",s.None="None"})(Pk||(Pk={}));var AY=function(s){DY(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.getModuleName=function(){return"skeleton"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.preRender=function(){this.element.id||(this.element.id=mi("e-"+this.getModuleName())),this.updateCssClass(),De(this.element,{role:"alert","aria-busy":"true","aria-live":"polite","aria-label":this.label})},e.prototype.render=function(){this.initialize()},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"width":case"height":this.updateDimension();break;case"shape":this.updateShape();break;case"shimmerEffect":this.updateEffect();break;case"visible":this.updateVisibility();break;case"label":this.element.setAttribute("aria-label",this.label);break;case"cssClass":i.cssClass&&te([this.element],i.cssClass.split(" ")),this.updateCssClass();break}}},e.prototype.destroy=function(){s.prototype.destroy.call(this);var t=["role","aria-live","aria-busy","aria-label"],i=[];this.cssClass&&(i=i.concat(this.cssClass.split(" ")));for(var r=0;r<t.length;r++)this.element.removeAttribute(t[parseInt(r.toString(),10)]);i=i.concat(this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)),i=i.concat(this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)),te([this.element],i)},e.prototype.initialize=function(){this.updateShape(),this.updateEffect(),this.updateVisibility()},e.prototype.updateShape=function(){var t=px[this.shape.toUpperCase()+"SHAPE"],i=this.element.classList.value.match(/(e-skeleton-[^\s]+)/g);this.updateDimension(),i&&te([this.element],i),Q([this.element],[t])},e.prototype.updateDimension=function(){var t=!this.width&&["Text","Rectangle"].indexOf(this.shape)>-1?"100%":qe(this.width),i=["Circle","Square"].indexOf(this.shape)>-1?t:qe(this.height);this.element.style.width=t,this.element.style.height=i},e.prototype.updateEffect=function(){var t=this.element.classList.value.match(/(e-shimmer-[^\s]+)/g);t&&te([this.element],t),Q([this.element],[px[this.shimmerEffect.toUpperCase()+"EFFECT"]])},e.prototype.updateVisibility=function(){this.element.classList[this.visible?"remove":"add"](px.VISIBLENONE)},e.prototype.updateCssClass=function(){this.cssClass&&Q([this.element],this.cssClass.split(" "))},hl([S("")],e.prototype,"width",void 0),hl([S("")],e.prototype,"height",void 0),hl([S(!0)],e.prototype,"visible",void 0),hl([S("Text")],e.prototype,"shape",void 0),hl([S("Wave")],e.prototype,"shimmerEffect",void 0),hl([S("Loading...")],e.prototype,"label",void 0),hl([S("")],e.prototype,"cssClass",void 0),e=hl([Ot],e),e}(Pi),NY=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ii=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Xe={root:"e-dropdownlist",hover:Ke.hover,selected:Ke.selected,rtl:Ke.rtl,li:Ke.li,disable:Ke.disabled,base:Ke.root,focus:Ke.focus,content:Ke.content,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden",virtualList:"e-list-item e-virtual-list"},kY={container:null,buttons:[]},Na=function(s){NY(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.skeletonCount=32,r.isListSearched=!1,r.preventChange=!1,r.isAngular=!1,r.virtualListHeight=0,r.isVirtualScrolling=!1,r.isPreventScrollAction=!1,r.scrollPreStartIndex=0,r.isScrollActionTriggered=!1,r.previousStartIndex=0,r.isMouseScrollAction=!1,r.isKeyBoardAction=!1,r.isUpwardScrolling=!1,r.startIndex=0,r.currentPageNumber=0,r.pageCount=0,r.isPreventKeyAction=!1,r.generatedDataObject={},r.incrementalQueryString="",r.incrementalEndIndex=0,r.incrementalStartIndex=0,r.incrementalPreQueryString="",r.isTouched=!1,r.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.selectedValueInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.IsScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},r}return e.prototype.preRender=function(){this.valueTempElement=null,this.element.style.opacity="0",this.initializeData(),s.prototype.preRender.call(this),this.activeIndex=this.index,this.queryString=""},e.prototype.initializeData=function(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.actionData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.previousValue=null,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},e.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"VirtualScroll"}),t},e.prototype.renderList=function(t,i){s.prototype.render.call(this,t,i),this.dataSource instanceof ge||(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0),this.unWireListEvents(),this.wireListEvents()},e.prototype.floatLabelChange=function(){if(this.getModuleName()==="dropdownlist"&&this.floatLabelType==="Auto"){var t=this.inputWrapper.container.querySelector(".e-float-text");this.inputElement.value!==""||this.isInteracted?br(t,["e-label-top"],["e-label-bottom"]):br(t,["e-label-bottom"],["e-label-top"])}},e.prototype.resetHandler=function(t){t.preventDefault(),this.clearAll(t),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=0)},e.prototype.resetFocusElement=function(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,this.getModuleName()!=="autocomplete"&&!m(this.ulElement)){var t=this.ulElement.querySelector("."+Xe.li);this.enableVirtualization&&(t=this.liCollections[this.skeletonCount]),t&&t.classList.add(Xe.focus)}},e.prototype.clearAll=function(t,i){this.previousItemData=m(this.itemData)?null:this.itemData,(m(i)||!m(i)&&(m(i.dataSource)||!(i.dataSource instanceof ge)&&i.dataSource.length===0))&&(this.isActive=!0,this.resetSelection(i));var r=this.getItemData();this.previousValue!==r.value&&(this.onChangeEvent(t),this.checkAndResetCache(),this.enableVirtualization&&this.updateInitialData())},e.prototype.resetSelection=function(t){this.list&&(!m(t)&&(m(t.dataSource)||!(t.dataSource instanceof ge)&&t.dataSource.length===0)?(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(t.dataSource)):(this.allowFiltering&&this.getModuleName()!=="autocomplete"&&!m(this.actionCompleteData.ulElement)&&!m(this.actionCompleteData.list)&&this.actionCompleteData.list.length>0&&this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement())),m(this.hiddenElement)||(this.hiddenElement.innerHTML=""),m(this.inputElement)||(this.inputElement.value=""),this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&(ne(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()},e.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&Q([this.inputWrapper.container],n.split(" "))}else if(r==="disabled"&&this.htmlAttributes[""+r]==="disabled")this.enabled=!1,this.setEnable();else if(r==="readonly"&&!m(this.htmlAttributes[""+r]))this.readonly=!0,this.dataBind();else if(r==="style")this.inputWrapper.container.setAttribute("style",this.htmlAttributes[""+r]);else if(r==="aria-label")(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.setAttribute("aria-label",this.htmlAttributes[""+r]):this.getModuleName()==="dropdownlist"&&this.inputWrapper.container.setAttribute("aria-label",this.htmlAttributes[""+r]);else{var a=["title","id","placeholder","role","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],o=["name","required"];(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&a.push("tabindex"),o.indexOf(r)>-1||r.indexOf("data")===0?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):a.indexOf(r)>-1?r==="placeholder"?ye.setPlaceholder(this.htmlAttributes[""+r],this.inputElement):this.inputElement.setAttribute(r,this.htmlAttributes[""+r]):this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}}(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&this.inputWrapper.container.removeAttribute("tabindex")},e.prototype.getAriaAttributes=function(){return{"aria-disabled":"false",role:"combobox","aria-expanded":"false","aria-live":"polite","aria-labelledby":this.hiddenElement.id}},e.prototype.setEnableRtl=function(){ye.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},e.prototype.setEnable=function(){ye.setEnabled(this.enabled,this.inputElement),this.enabled?(te([this.inputWrapper.container],Xe.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex)):(this.hidePopup(),Q([this.inputWrapper.container],Xe.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1)},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.getLocaleName=function(){return"drop-down-list"},e.prototype.preventTabIndex=function(t){this.getModuleName()==="dropdownlist"&&(t.tabIndex=-1)},e.prototype.targetElement=function(){return m(this.inputWrapper)?null:this.inputWrapper.container},e.prototype.getNgDirective=function(){return"EJS-DROPDOWNLIST"},e.prototype.getElementByText=function(t){return this.getElementByValue(this.getValueByText(t))},e.prototype.getElementByValue=function(t){for(var i,r=this.getItems(),n=0,a=r;n<a.length;n++){var o=a[n];if(this.getFormattedValue(o.getAttribute("data-value"))===t){i=o;break}}return i},e.prototype.initValue=function(){this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.renderList(),this.dataSource instanceof ge?this.initRemoteRender=!0:this.updateValues()},e.prototype.updateValues=function(){if(this.selectedValueInfo=this.viewPortInfo,!m(this.value))this.setSelection(this.getElementByValue(this.value),null);else if(this.text&&m(this.value)){var t=this.getElementByText(this.text);if(m(t)){this.setProperties({text:null});return}else this.setSelection(t,null)}else this.setSelection(this.liCollections[this.activeIndex],null);this.setHiddenValue(),ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.onBlurHandler=function(t){if(this.enabled){var i=t.relatedTarget,r=t.target,n=this.isPreventBlur;if(this.isPreventBlur=!1,n&&!this.isDocumentClick&&this.isPopupOpen&&(!m(r)||!this.isFilterLayout()&&m(i))){this.getModuleName()==="dropdownlist"&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus();return}if(this.isDocumentClick||!m(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(Xe.mobileFilter)){this.beforePopupOpen||(this.isDocumentClick=!1);return}(this.getModuleName()==="dropdownlist"&&!this.isFilterFocus&&i!==this.inputElement&&(document.activeElement!==i||document.activeElement===i&&r.classList.contains(Xe.inputFocus))||m(i)&&this.getModuleName()==="dropdownlist"&&this.allowFiltering&&r!==this.inputWrapper.container||this.getModuleName()!=="dropdownlist"&&!this.inputWrapper.container.contains(i)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(t),this.isTabKey=!1),this.isRequested&&!this.isPopupOpen&&!this.isPreventBlur&&(this.isActive=!1,this.beforePopupOpen=!1)}},e.prototype.focusOutAction=function(t){this.isInteracted=!1,this.focusOut(t),this.onFocusOut()},e.prototype.onFocusOut=function(){this.enabled&&(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(null)),this.floatLabelChange(),this.dispatchEvent(this.hiddenElement,"change"),this.getModuleName()==="dropdownlist"&&this.element.tagName!=="INPUT"&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&Q([this.inputWrapper.clearButton],Xe.clearIconHide),this.trigger("blur"))},e.prototype.onFocus=function(t){if(!this.isInteracted){this.isInteracted=!0;var i={isInteracted:!!t,event:t};this.trigger("focus",i)}this.updateIconState()},e.prototype.resetValueHandler=function(t){var i=U(this.inputElement,"form");if(i&&t.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=r}},e.prototype.wireEvent=function(){I.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),I.add(this.inputWrapper.container,"focus",this.focusIn,this),I.add(this.inputWrapper.container,"keypress",this.onSearch,this),I.add(window,"resize",this.windowResize,this),this.bindCommonEvent()},e.prototype.bindCommonEvent=function(){I.add(this.targetElement(),"blur",this.onBlurHandler,this);var t=U(this.inputElement,"form");t&&I.add(t,"reset",this.resetValueHandler,this),B.isDevice?this.keyboardModule=new wr(this.targetElement(),{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.keyboardModule=new wr(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.bindClearEvent()},e.prototype.windowResize=function(){this.isPopupOpen&&this.popupObj.refreshPosition(this.inputWrapper.container)},e.prototype.bindClearEvent=function(){this.showClearButton&&I.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)},e.prototype.unBindCommonEvent=function(){!m(this.inputWrapper)&&this.targetElement()&&I.remove(this.targetElement(),"blur",this.onBlurHandler);var t=this.inputElement&&U(this.inputElement,"form");t&&I.remove(t,"reset",this.resetValueHandler),B.isDevice||this.keyboardModule.destroy(),this.showClearButton&&I.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)},e.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement.value!==""&&!this.readonly?te([this.inputWrapper.clearButton],Xe.clearIconHide):Q([this.inputWrapper.clearButton],Xe.clearIconHide))},e.prototype.wireListEvents=function(){m(this.list)||(I.add(this.list,"click",this.onMouseClick,this),I.add(this.list,"mouseover",this.onMouseOver,this),I.add(this.list,"mouseout",this.onMouseLeave,this))},e.prototype.onSearch=function(t){t.charCode!==32&&t.charCode!==13&&(this.list===void 0&&this.renderList(),this.searchKeyEvent=t,this.onServerIncrementalSearch(t))},e.prototype.onServerIncrementalSearch=function(t){!this.isRequested&&!m(this.list)&&!m(this.list.querySelector("li"))&&this.enabled&&!this.readonly&&this.incrementalSearch(t)},e.prototype.onMouseClick=function(t){var i=t.target;this.keyboardEvent=null;var r=U(i,"."+Ke.li);if(this.isValidLI(r))if(this.setSelection(r,t),B.isDevice&&this.isFilterLayout())history.back();else{var n=100;this.closePopup(n,t)}},e.prototype.onMouseOver=function(t){var i=U(t.target,"."+Ke.li);this.setHover(i)},e.prototype.setHover=function(t){this.enabled&&this.isValidLI(t)&&!t.classList.contains(Ke.hover)&&(this.removeHover(),Q([t],Ke.hover))},e.prototype.onMouseLeave=function(){this.removeHover()},e.prototype.removeHover=function(){if(this.list){var t=this.list.querySelectorAll("."+Ke.hover);t&&t.length&&te(t,Ke.hover)}},e.prototype.isValidLI=function(t){return t&&t.hasAttribute("role")&&t.getAttribute("role")==="option"},e.prototype.updateIncrementalInfo=function(t,i){this.viewPortInfo.startIndex=t,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.isIncrementalRequest=!0,this.resetList(this.dataSource,this.fields,this.query),this.isIncrementalRequest=!1},e.prototype.updateIncrementalView=function(t,i){this.viewPortInfo.startIndex=t,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+Ke.li),this.ulElement=this.list.querySelector("ul")},e.prototype.updateIncrementalItemIndex=function(t,i){this.incrementalStartIndex=t,this.incrementalEndIndex=i},e.prototype.incrementalSearch=function(t){if(this.liCollections.length>0)if(this.enableVirtualization){var i=!1,r=!1,n=this.ulElement.getElementsByClassName("e-active")[0],a=n?n.textContent:null;this.incrementalQueryString==""?(this.incrementalQueryString=String.fromCharCode(t.charCode),this.incrementalPreQueryString=this.incrementalQueryString):String.fromCharCode(t.charCode).toLocaleLowerCase()==this.incrementalPreQueryString.toLocaleLowerCase()?r=!0:this.incrementalQueryString=String.fromCharCode(t.charCode),(this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex==0)&&(i=!0,this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex==0?this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100:this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0),(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount);for(var o=qm(t.charCode,this.incrementalLiCollections,this.activeIndex,!0,this.element.id,r,a,!0);m(o)&&this.incrementalEndIndex<this.totalItemCount&&(this.updateIncrementalItemIndex(this.incrementalEndIndex,this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),o=qm(t.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,a,!0,!0),!!m(o));)if(m(o)&&this.incrementalEndIndex>=this.totalItemCount){this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100);break}m(o)&&this.incrementalEndIndex>=this.totalItemCount&&(this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),o=qm(t.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,a,!0,!0));var l=o&&this.getIndexByValue(o.getAttribute("data-value"));if(l)l=l-this.skeletonCount;else for(var h=0;h<this.incrementalLiCollections.length;h++)if(!m(o)&&!m(o.getAttribute("data-value"))&&this.incrementalLiCollections[h].getAttribute("data-value")===o.getAttribute("data-value").toString()){l=h,l=this.incrementalStartIndex+l;break}if(l&&(!(this.viewPortInfo.startIndex>=l)||!(l>=this.viewPortInfo.endIndex))){var u=l-(this.itemCount/2-2)>0?l-(this.itemCount/2-2):0,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(m(o))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var d=this.getIndexByValue(o.getAttribute("data-value"))-this.skeletonCount;if(d>this.itemCount/2){var u=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(o=this.getElementByValue(o.getAttribute("data-value")),this.setSelection(o,t),this.setScrollPosition(),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var p=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.list.scrollTop=p-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}this.incrementalPreQueryString=this.incrementalQueryString}}else{var o=qm(t.charCode,this.liCollections,this.activeIndex,!0,this.element.id);m(o)||(this.setSelection(o,t),this.setScrollPosition())}},e.prototype.hideSpinner=function(){m(this.spinnerElement)||(kd(this.spinnerElement),te([this.spinnerElement],Xe.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)},e.prototype.showSpinner=function(){m(this.spinnerElement)&&(this.spinnerElement=B.isDevice&&!m(this.filterInputObj)&&this.filterInputObj.buttons[1]||!m(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],Q([this.spinnerElement],Xe.disableIcon),Nd({target:this.spinnerElement,width:B.isDevice?"16px":"14px"},this.createElement),Ol(this.spinnerElement))},e.prototype.keyActionHandler=function(t){if(this.enabled){this.keyboardEvent=t,this.isPreventKeyAction&&this.enableVirtualization&&t.preventDefault();var i=t.action==="pageUp"||t.action==="pageDown",r=this.getModuleName()!=="dropdownlist"&&(t.action==="home"||t.action==="end");this.isEscapeKey=t.action==="escape",this.isTabKey=!this.isPopupOpen&&t.action==="tab";var n=t.action==="down"||t.action==="up"||t.action==="pageUp"||t.action==="pageDown"||t.action==="home"||t.action==="end";if(!((this.isEditTextBox()||i||r)&&!this.isPopupOpen)&&!this.readonly){var a=t.action==="tab"||t.action==="close";if(m(this.list)&&!this.isRequested&&!a&&t.action!=="escape"&&(this.searchKeyEvent=t,this.renderList(t),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+Ke.li),this.ulElement=this.list.querySelector("ul")),m(this.list)||!m(this.liCollections)&&n&&this.liCollections.length===0||this.isRequested)return;switch((a&&this.getModuleName()!=="autocomplete"&&this.isPopupOpen||t.action==="escape")&&t.preventDefault(),this.isSelected=t.action==="escape"?!1:this.isSelected,this.isTyped=n||t.action==="escape"?!1:this.isTyped,t.action){case"down":case"up":this.updateUpDownAction(t);break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),t),t.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),t),t.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(t);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(t);break;case"space":this.getModuleName()==="dropdownlist"&&(this.beforePopupOpen||(this.showPopup(),t.preventDefault()));break;case"open":this.showPopup(t);break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(t),this.focusDropDown(t);break;case"enter":this.selectCurrentItem(t);break;case"tab":this.selectCurrentValueOnTab(t);break;case"escape":case"close":this.isPopupOpen&&(this.hidePopup(t),this.focusDropDown(t));break}}}},e.prototype.updateUpDownAction=function(t,i){if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value;m(r)&&(r="null");var n=this.getIndexByValue(r);m(n)||(this.activeIndex=n)}var a=this.list.querySelector("."+Xe.focus);if(this.isSelectFocusItem(a)&&!i){if(this.setSelection(a,t),this.enableVirtualization&&!this.fields.groupBy&&this.getModuleName()!=="combobox"){var o=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.list.scrollTop=o-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}else if(!m(this.liCollections)){var l=this.activeIndex,h=t.action==="down"?this.activeIndex+1:this.activeIndex-1;h=i?l:h;var u=0;this.getModuleName()==="autocomplete"&&(u=t.action==="down"&&m(this.activeIndex)?0:this.liCollections.length-1,h=h<0?this.liCollections.length-1:h===this.liCollections.length?0:h);var c=void 0;if(this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&this.isPopupOpen)if(!this.enableVirtualization)c=m(this.activeIndex)?this.liCollections[u]:this.liCollections[h];else if(!i)c=m(this.activeIndex)?this.liCollections[this.skeletonCount]:this.liCollections[h],c=!m(c)&&!c.classList.contains("e-virtual-list")?c:null;else if(this.getModuleName()==="autocomplete"){var d=this.getFormattedValue(this.selectedLI.getAttribute("data-value"));c=this.getElementByValue(d)}else c=this.getElementByValue(this.getItemData().value);if(!m(c))this.setSelection(c,t);else if(this.enableVirtualization&&!this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&(this.viewPortInfo.endIndex!==this.totalItemCount&&t.action==="down"||this.viewPortInfo.startIndex!==0&&t.action==="up")){if(t.action==="down"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex+this.itemCount<this.totalItemCount-this.itemCount?this.viewPortInfo.startIndex+this.itemCount:this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var p=this.liCollections[0].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[0].getAttribute("data-value")):null,f=this.getDataByValue(p);f&&(this.itemData=f)}else if(t.action==="up"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex-this.itemCount>0?this.viewPortInfo.startIndex-this.itemCount:0,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var v=this.liCollections[this.liCollections.length-1].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[this.liCollections.length-1].getAttribute("data-value")):null,f=this.getDataByValue(v);f&&(this.itemData=f)}this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+Ke.li),this.ulElement=this.list.querySelector("ul"),this.handleVirtualKeyboardActions(t,this.pageCount)}}if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var g=this.getItemData().value,n=this.getIndexByValueFilter(g);m(n)||(this.activeIndex=n)}this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id})),t.preventDefault()},e.prototype.updateVirtualItemIndex=function(){this.virtualItemStartIndex=this.viewPortInfo.startIndex,this.virtualItemEndIndex=this.viewPortInfo.endIndex,this.virtualListInfo=this.viewPortInfo},e.prototype.updateHomeEndAction=function(t,i){if(this.getModuleName()==="dropdownlist"){var r=0;if(t.action==="home"?(r=0,this.enableVirtualization&&this.isPopupOpen?r=this.skeletonCount:this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query))):(this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.endIndex!==this.totalItemCount&&(this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query)),r=this.getItems().length-1),t.preventDefault(),this.activeIndex===r){i&&this.setSelection(this.liCollections[r],t);return}this.setSelection(this.liCollections[r],t)}},e.prototype.selectCurrentValueOnTab=function(t){this.getModuleName()==="autocomplete"?this.selectCurrentItem(t):this.isPopupOpen&&(this.hidePopup(t),this.focusDropDown(t))},e.prototype.mobileKeyActionHandler=function(t){if(this.enabled&&!(this.isEditTextBox()&&!this.isPopupOpen)&&!this.readonly){if(this.list===void 0&&!this.isRequested&&(this.searchKeyEvent=t,this.renderList()),m(this.list)||!m(this.liCollections)&&this.liCollections.length===0||this.isRequested)return;t.action==="enter"&&this.selectCurrentItem(t)}},e.prototype.handleVirtualKeyboardActions=function(t,i){switch(t.action){case"down":case"up":(this.itemData!=null||this.getModuleName()==="autocomplete")&&this.updateUpDownAction(t,!0);break;case"pageUp":var r=i*2-4;this.activeIndex=Math.round(r),this.pageUpSelection(this.activeIndex-this.getPageCount(),t,!0),t.preventDefault();break;case"pageDown":this.activeIndex=1,this.pageDownSelection(this.activeIndex+this.getPageCount(),t,!0),t.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(t,!0);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(t,!0);break}this.keyboardEvent=null},e.prototype.selectCurrentItem=function(t){if(this.isPopupOpen){var i=this.list.querySelector("."+Xe.focus);i&&(this.setSelection(i,t),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(t)),this.hidePopup(t),this.focusDropDown(t)}else this.showPopup()},e.prototype.isSelectFocusItem=function(t){return!m(t)},e.prototype.pageUpSelection=function(t,i,r){var n=t>=0?this.liCollections[t+1]:this.liCollections[0];(this.enableVirtualization&&this.activeIndex==null||r)&&(n=t>=0?this.liCollections[t+this.skeletonCount+1]:this.liCollections[0]),!m(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.PageUpDownSelection(n,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.PageUpDownSelection=function(t,i){this.enableVirtualization?!m(t)&&(this.getModuleName()!=="autocomplete"&&!t.classList.contains("e-active")||this.getModuleName()==="autocomplete"&&!t.classList.contains("e-item-focus"))&&this.setSelection(t,i):this.setSelection(t,i)},e.prototype.pageDownSelection=function(t,i,r){var n=this.getItems(),a=t<=n.length?this.liCollections[t-1]:this.liCollections[n.length-1];(this.enableVirtualization&&this.activeIndex==null||r)&&(a=t<=n.length?this.liCollections[t+this.skeletonCount-1]:this.liCollections[n.length-1]),this.PageUpDownSelection(a,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&De(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.unWireEvent=function(){m(this.inputWrapper)||(I.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),I.remove(this.inputWrapper.container,"keypress",this.onSearch),I.remove(this.inputWrapper.container,"focus",this.focusIn),I.remove(window,"resize",this.windowResize)),this.unBindCommonEvent()},e.prototype.unWireListEvents=function(){this.list&&(I.remove(this.list,"click",this.onMouseClick),I.remove(this.list,"mouseover",this.onMouseOver),I.remove(this.list,"mouseout",this.onMouseLeave))},e.prototype.checkSelector=function(t){return'[id="'+t.replace(/(:|\.|\[|\]|,|=|@|\\|\/|#)/g,"\\$1")+'"]'},e.prototype.onDocumentClick=function(t){var i=t.target;if(!(!m(this.popupObj)&&U(i,this.checkSelector(this.popupObj.element.id)))&&!m(this.inputWrapper)&&!this.inputWrapper.container.contains(t.target)){if(this.inputWrapper.container.classList.contains(Xe.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;var r=this.isRequested;this.hidePopup(t),this.isInteracted=!1,r||(this.onFocusOut(),this.inputWrapper.container.classList.remove(Xe.inputFocus))}}else i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&!(this.getModuleName()==="combobox"&&!this.allowFiltering&&B.isDevice&&i===this.inputWrapper.buttons[0])&&(this.isPreventBlur=(B.isIE||B.info.name==="edge")&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),t.preventDefault())},e.prototype.activeStateChange=function(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(Xe.inputFocus))},e.prototype.focusDropDown=function(t){!this.initial&&this.isFilterLayout()&&this.focusIn(t)},e.prototype.dropDownClick=function(t){if(!(t.which===3||t.button===2)&&(this.keyboardEvent=null,!(this.targetElement().classList.contains(Xe.disable)||this.inputWrapper.clearButton===t.target))){var i=t.target;if(i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&this.getModuleName()!=="combobox"&&t.preventDefault(),this.readonly)this.focusIn(t);else{this.isPopupOpen?(this.hidePopup(t),this.isFilterLayout()&&this.focusDropDown(t)):(this.focusIn(t),this.floatLabelChange(),this.queryString=this.inputElement.value.trim()===""?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup(t));var r=this,n=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isSecondClick||setTimeout(function(){r.cloneElements(),r.isSecondClick=!0},n)}}},e.prototype.cloneElements=function(){if(this.list){var t=this.list.querySelector("ul");t&&(t=t.cloneNode?t.cloneNode(!0):t,this.actionCompleteData.ulElement=t)}},e.prototype.updateSelectedItem=function(t,i,r,n){var a=this;this.removeSelection(),t.classList.add(Ke.selected),this.removeHover();var o=t.getAttribute("data-value")!=="null"?this.getFormattedValue(t.getAttribute("data-value")):null,l=this.getDataByValue(o);if(!this.initial&&!r&&!m(i)){var h=this.detachChanges(l);this.isSelected=!0;var u={e:i,item:t,itemData:h,isInteracted:!!i,cancel:!1};this.trigger("select",u,function(c){c.cancel?t.classList.remove(Ke.selected):(a.selectEventCallback(t,i,r,l,o),n&&a.setSelectOptions(t,i))})}else this.selectEventCallback(t,i,r,l,o),n&&this.setSelectOptions(t,i)},e.prototype.selectEventCallback=function(t,i,r,n,a){this.previousItemData=m(this.itemData)?null:this.itemData,this.itemData!=n&&(this.previousValue=m(this.itemData)?null:typeof this.itemData=="object"?this.checkFieldValue(this.itemData,this.fields.value.split(".")):this.itemData),this.item=t,this.itemData=n;var o=this.list.querySelector("."+Ke.focus);if(o&&te([o],Ke.focus),t.setAttribute("aria-selected","true"),m(a)&&(a="null"),this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var l=this.getIndexByValueFilter(a);m(l)?this.activeIndex=this.getIndexByValue(a):this.activeIndex=l}else this.activeIndex=this.getIndexByValue(a)},e.prototype.activeItem=function(t){this.isValidLI(t)&&!t.classList.contains(Ke.selected)&&(this.removeSelection(),t.classList.add(Ke.selected),this.removeHover(),t.setAttribute("aria-selected","true"))},e.prototype.setValue=function(t){var i=this.getItemData();i.value===null?ye.setValue(null,this.inputElement,this.floatLabelType,this.showClearButton):ye.setValue(i.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&this.itemData!==null?this.setValueTemplate():!m(this.valueTempElement)&&this.inputElement.previousSibling===this.valueTempElement&&(ne(this.valueTempElement),this.inputElement.style.display="block"),!m(i.value)&&!this.enableVirtualization&&this.allowFiltering&&(this.activeIndex=this.getIndexByValueFilter(i.value));var r=Xe.clearIcon,n=this.isFiltering()&&this.filterInput&&this.getModuleName()==="combobox",a=n&&this.filterInput.parentElement.querySelector("."+r);return this.isFiltering()&&a&&a.style.removeProperty("visibility"),this.previousValue===i.value?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,this.getModuleName()==="dropdownlist"&&this.updateIconState(),!1)},e.prototype.setSelection=function(t,i){var r=this;if(this.isValidLI(t)&&(!t.classList.contains(Ke.selected)||this.isPopupOpen&&this.isSelected&&t.classList.contains(Ke.selected)))this.updateSelectedItem(t,i,!1,!0);else if(this.setSelectOptions(t,i),this.enableVirtualization){var n=this.fields.value?this.fields.value:"";if(this.dataSource instanceof ge)this.dataSource.executeQuery(new $e().where(new It(n,"equal",this.value))).then(function(l){if(l.result.length>0){r.itemData=l.result[0];var h=r.getItemData();(r.value===h.value&&r.text!==h.text||r.value!==h.value&&r.text===h.text)&&r.setProperties({text:h.text,value:h.value})}});else{var a=new ge(this.dataSource).executeLocal(new $e().where(new It(n,"equal",this.value)));if(a&&a.length>0){this.itemData=a[0];var o=this.getItemData();(this.value===o.value&&this.text!==o.text||this.value!==o.value&&this.text===o.text)&&this.setProperties({text:o.text,value:o.value})}}}},e.prototype.setSelectOptions=function(t,i){this.list&&this.removeHover(),this.previousSelectedLI=m(this.selectedLI)?null:this.selectedLI,this.selectedLI=t,!this.setValue(i)&&((!this.isPopupOpen&&!m(t)||this.isPopupOpen&&!m(i)&&(i.type!=="keydown"||i.type==="keydown"&&i.action==="enter"))&&(this.isSelectCustom=!1,this.onChangeEvent(i)),this.isPopupOpen&&!m(this.selectedLI)&&this.itemData!==null&&(!i||i.type!=="click")&&this.setScrollPosition(i),B.info.name!=="mozilla"&&this.targetElement()&&(De(this.targetElement(),{"aria-describedby":this.inputElement.id!==""?this.inputElement.id:this.element.id}),this.targetElement().removeAttribute("aria-live")),this.isPopupOpen&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?De(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):this.isPopupOpen&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&De(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.dropdownCompiler=function(t){var i=!1;if(typeof t!="function"&&t)try{i=!!document.querySelectorAll(t).length}catch{i=!1}return i},e.prototype.setValueTemplate=function(){var t;this.isReact&&(this.clearTemplate(["valueTemplate"]),this.valueTempElement&&(ne(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null)),this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:Xe.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.isReact||(this.valueTempElement.innerHTML="");var i=this.dropdownCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&i?t=pi(document.querySelector(this.valueTemplate).innerHTML.trim()):t=pi(this.valueTemplate);var r=t(this.itemData,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,this.valueTempElement);r&&r.length>0&&Ut(r,this.valueTempElement),this.renderReactTemplates()},e.prototype.removeSelection=function(){if(this.list){var t=this.list.querySelectorAll("."+Ke.selected);t.length&&(te(t,Ke.selected),t[0].removeAttribute("aria-selected"))}},e.prototype.getItemData=function(){var t=this.fields,i=null;i=this.itemData;var r,n;m(i)||(r=ie(t.value,i),n=ie(t.text,i));var a=!m(i)&&!Re(r)?r:i,o=!m(i)&&!Re(r)?n:i;return{value:a,text:o}},e.prototype.onChangeEvent=function(t){var i=this.getItemData(),r=this.isSelectCustom?null:this.activeIndex;this.setProperties({index:r,text:i.text,value:i.value},!0),this.detachChangeEvent(t)},e.prototype.detachChanges=function(t){var i;return typeof t=="string"||typeof t=="boolean"||typeof t=="number"?i=Object.defineProperties({},{value:{value:t,enumerable:!0},text:{value:t,enumerable:!0}}):i=t,i},e.prototype.detachChangeEvent=function(t){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.index,this.typedString=m(this.text)?"":this.text,!this.initial){var i=this.detachChanges(this.itemData),r=void 0;typeof this.previousItemData=="string"||typeof this.previousItemData=="boolean"||typeof this.previousItemData=="number"?r=Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):r=this.previousItemData,this.setHiddenValue();var n={e:t,item:this.item,itemData:i,previousItem:this.previousSelectedLI,previousItemData:r,isInteracted:!!t,value:this.value,element:this.element,event:t};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}(m(this.value)||this.value==="")&&this.floatLabelType!=="Always"&&te([this.inputWrapper.container],"e-valid-input")},e.prototype.setHiddenValue=function(){if(m(this.value))this.hiddenElement.innerHTML="";else if(this.hiddenElement.querySelector("option")){var t=this.hiddenElement.querySelector("option");t.textContent=this.text,t.setAttribute("value",this.value.toString())}else if(!m(this.hiddenElement)){this.hiddenElement.innerHTML="<option selected>"+this.text+"</option>";var t=this.hiddenElement.querySelector("option");t.setAttribute("value",this.value.toString())}},e.prototype.onFilterUp=function(t){if(!(t.ctrlKey&&t.keyCode===86)&&(this.isValidKey||t.keyCode===40||t.keyCode===38))switch(this.isValidKey=!1,t.keyCode){case 38:case 40:this.getModuleName()==="autocomplete"&&!this.isPopupOpen&&!this.preventAltUp&&!this.isRequested?(this.preventAutoFill=!0,this.searchLists(t)):this.preventAutoFill=!1,this.preventAltUp=!1,this.getModuleName()==="autocomplete"&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])&&De(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}),t.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&this.typedString!==""||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(t)):this.typedString===""&&this.queryString===""&&this.getModuleName()!=="autocomplete"?(this.preventAutoFill=!0,this.searchLists(t)):this.typedString===""&&(this.list&&this.resetFocusElement(),this.activeIndex=null,this.getModuleName()!=="dropdownlist"&&(this.preventAutoFill=!0,this.searchLists(t),this.getModuleName()==="autocomplete"&&this.hidePopup())),t.preventDefault();break;default:this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.searchLists(t),(this.enableVirtualization&&this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof ge)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof ge&&this.totalItemCount!=0)&&this.getFilteringSkeletonCount();break}else this.isValidKey=!1},e.prototype.getFilteringSkeletonCount=function(){var t=this.dataCount-this.viewPortInfo.endIndex,i=this.skeletonCount;this.getSkeletonCount(!0),this.skeletonCount=this.dataCount>this.itemCount*2?this.skeletonCount:t>this.skeletonCount?this.skeletonCount:t>0?t:0;var r=!0;this.getModuleName()==="autocomplete"&&this.totalItemCount!=0&&this.totalItemCount<this.itemCount*2&&(this.skeletonCount=0,r=!1),this.list.classList.contains(Ke.noData)||(this.skeletonCount,i!==this.skeletonCount&&r?this.UpdateSkeleton(!0,Math.abs(i-this.skeletonCount)):this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl").length>0&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.list.getElementsByClassName("e-virtual-ddl-content").length>0&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()))},e.prototype.getSkeletonCount=function(t){this.virtualListHeight=this.listHeight!=null?parseInt(this.listHeight,10):this.virtualListHeight;var i=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;this.skeletonCount=i*2<this.itemCount?this.itemCount:i*2,this.itemCount=t?this.itemCount:this.skeletonCount,this.skeletonCount=Math.floor(this.skeletonCount/2)+2},e.prototype.onFilterDown=function(t){switch(t.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,t.preventDefault();break;case 9:this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&t.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value;break}},e.prototype.removeFillSelection=function(){if(this.isInteracted){var t=this.getSelectionPoints();this.inputElement.setSelectionRange(t.end,t.end)}},e.prototype.getQuery=function(t){var i;if(!this.isCustomFilter&&this.allowFiltering&&this.filterInput){i=t?t.clone():this.query?this.query.clone():new $e;var r=this.typedString===""?"contains":this.filterType,n=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof ge)&&n==="string"||n==="number")i.where("",r,this.typedString,this.ignoreCase,this.ignoreAccent);else{var a=this.fields.text?this.fields.text:"";i.where(a,r,this.typedString,this.ignoreCase,this.ignoreAccent)}}else i=t?t.clone():this.query?this.query.clone():new $e;if(this.enableVirtualization&&this.viewPortInfo.endIndex!=0&&(!(this.dataSource instanceof ge)||this.dataSource instanceof ge&&this.virtualGroupDataSource)){var o=this.getTakeValue(),l=!1;if(i){for(var h=0;h<i.queries.length;h++)if(i.queries[h].fn==="onSkip"){l=!0;break}}(this.allowFiltering||!this.isPopupOpen||!l)&&i.skip(this.virtualItemStartIndex),this.isIncrementalRequest?i.take(this.incrementalEndIndex):i.take(o),i.requiresCount()}return i},e.prototype.getSelectionPoints=function(){var t=this.inputElement;return{start:Math.abs(t.selectionStart),end:Math.abs(t.selectionEnd)}},e.prototype.searchLists=function(t){var i=this;if(this.isTyped=!0,this.activeIndex=null,this.isListSearched=!0,this.filterInput.parentElement.querySelector("."+Xe.clearIcon)){var r=this.filterInput.parentElement.querySelector("."+Xe.clearIcon);r.style.visibility=this.filterInput.value===""?"hidden":"visible"}if(this.isDataFetched=!1,this.isFiltering()){this.checkAndResetCache();var n={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(a,o,l){n.cancel||(i.isCustomFilter=!0,i.filteringAction(a,o,l))},baseEventArgs:t,cancel:!1};this.trigger("filtering",n,function(a){!a.cancel&&!i.isCustomFilter&&!a.preventDefaultAction&&i.filteringAction(i.dataSource,null,i.fields)})}},e.prototype.filter=function(t,i,r){this.isCustomFilter=!0,this.filteringAction(t,i,r)},e.prototype.filteringAction=function(t,i,r){if(!m(this.filterInput)){this.beforePopupOpen=!(!this.isPopupOpen&&this.getModuleName()==="combobox"&&this.filterInput.value==="");var n=this.list.classList.contains(Ke.noData);if(this.filterInput.value.trim()===""&&!this.itemTemplate){if(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,!m(this.actionCompleteData.ulElement)&&!m(this.actionCompleteData.list)){if(this.enableVirtualization&&(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(t,r,i),n&&!this.list.classList.contains(Ke.noData)&&(this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content",styles:this.getTransformValues()})).appendChild(this.list.querySelector(".e-list-parent")),!this.list.querySelector(".e-virtual-ddl")))){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});document.getElementsByClassName("e-popup")[0].querySelector(".e-dropdownbase").appendChild(a)}this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list)}this.isTyped=!0,!m(this.itemData)&&this.getModuleName()==="dropdownlist"&&(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0}else if(this.isNotSearchList=!1,i=this.filterInput.value.trim()===""?null:i,this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(t,r,i),this.enableVirtualization&&n&&!this.list.classList.contains(Ke.noData)&&(this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content",styles:this.getTransformValues()})).appendChild(this.list.querySelector(".e-list-parent")),!this.list.querySelector(".e-virtual-ddl"))){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});document.getElementsByClassName("e-popup")[0].querySelector(".e-dropdownbase").appendChild(a)}this.enableVirtualization&&this.getFilteringSkeletonCount(),this.renderReactTemplates()}},e.prototype.setSearchBox=function(t){if(this.isFiltering()){var i=t.querySelector("."+Xe.filterParent)?t.querySelector("."+Xe.filterParent):this.createElement("span",{className:Xe.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:Xe.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);var r=!1;return B.isDevice&&(r=!0),this.filterInputObj=ye.createInput({element:this.filterInput,buttons:r?[Xe.backIcon,Xe.filterBarClearIcon]:[Xe.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),m(this.cssClass)||(this.cssClass.split(" ").indexOf("e-outline")!==-1?Q([this.filterInputObj.container],"e-outline"):this.cssClass.split(" ").indexOf("e-filled")!==-1&&Q([this.filterInputObj.container],"e-filled")),Ut([this.filterInputObj.container],i),xs([i],t),De(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Xe.clearIcon),!B.isDevice&&this.clearIconElement&&(I.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),B.isDevice?this.searchKeyModule=new wr(this.filterInput,{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.searchKeyModule=new wr(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),I.add(this.filterInput,"input",this.onInput,this),I.add(this.filterInput,"keyup",this.onFilterUp,this),I.add(this.filterInput,"keydown",this.onFilterDown,this),I.add(this.filterInput,"blur",this.onBlurHandler,this),I.add(this.filterInput,"paste",this.pasteHandler,this),this.filterInputObj}else return kY},e.prototype.onInput=function(t){this.isValidKey=!0,this.getModuleName()==="combobox"&&this.updateIconState(),B.isDevice&&B.info.name==="mozilla"&&(this.typedString=this.filterInput.value,this.preventAutoFill=!0,this.searchLists(t))},e.prototype.pasteHandler=function(t){var i=this;setTimeout(function(){i.typedString=i.filterInput.value,i.searchLists(t)})},e.prototype.onActionFailure=function(t){s.prototype.onActionFailure.call(this,t),this.beforePopupOpen&&this.renderPopup()},e.prototype.UpdateSkeleton=function(t,i){var r=this.list.querySelector(".e-virtual-ddl-content"),n=this.list.querySelector(".e-virtual-list");if(r&&(!n||t)&&this.enableVirtualization)for(var a=t?i:this.skeletonCount,o=0;o<a;o++){var l=this.createElement("li",{className:Xe.virtualList,styles:"overflow: inherit"});this.enableVirtualization&&this.itemTemplate&&(l.style.height=this.listItemHeight+"px");var h=new AY({shape:"Text",height:"10px",width:"95%",cssClass:"e-skeleton-text"});h.appendTo(this.createElement("div")),l.appendChild(h.element),r.firstChild.insertBefore(l,r.firstChild.children[0])}},e.prototype.getTakeValue=function(){return this.allowFiltering&&this.getModuleName()==="dropdownlist"&&B.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},e.prototype.onActionComplete=function(t,i,r,n){var a=this;if(this.dataSource instanceof ge&&!m(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.isNotSearchList&&!this.enableVirtualization){this.isNotSearchList=!1;return}var o=this.itemCount;if(this.isActive||!m(t)){var l=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(s.prototype.onActionComplete.call(this,t,i,r),this.skeletonCount=this.totalItemCount!=0&&this.totalItemCount<this.itemCount*2?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering),this.isRequested&&!m(this.searchKeyEvent)&&this.searchKeyEvent.type==="keydown"&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!m(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.enableVirtualization||(this.list.scrollTop=0),m(t)||De(t,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"listbox"}),this.initRemoteRender){if(this.initial=!0,this.activeIndex=this.index,this.initRemoteRender=!1,this.value&&this.dataSource instanceof ge){var h=m(this.fields.value)?this.fields.text:this.fields.value,u=this.fields.value.split("."),c=i.some(function(f){return m(f[h])&&u.length>1?a.checkFieldValue(f,u)===a.value:f[h]===a.value});c?this.updateValues():this.dataSource.executeQuery(this.getQuery(this.query).where(new It(h,"equal",this.value))).then(function(f){f.result.length>0&&a.addItem(f.result,i.length),a.updateValues()})}else this.updateValues();this.initial=!1}else this.getModuleName()==="autocomplete"&&this.value&&this.setInputValue();if(this.getModuleName()!=="autocomplete"&&this.isFiltering()&&!this.isTyped)(!this.actionCompleteData.isUpdated||!this.isCustomFilter&&!this.isFilterFocus||m(this.itemData)&&this.allowFiltering&&(this.dataSource instanceof ge||!m(this.dataSource)&&!m(this.dataSource.length)&&this.dataSource.length!==0))&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){a.updateActionCompleteDataValues(t,i)},0):this.updateActionCompleteDataValues(t,i)),(this.allowCustom||this.allowFiltering&&!this.isValueInList(i,this.value)&&this.dataSource instanceof ge)&&!this.enableVirtualization?this.addNewItem(i,l):(this.allowCustom||this.allowFiltering&&this.isValueInList(i,this.value))&&!this.enableVirtualization&&this.addNewItem(i,l),(!m(this.itemData)||m(this.itemData)&&this.enableVirtualization)&&this.focusIndexItem(),this.enableVirtualization&&this.updateActionCompleteDataValues(t,i);else if(this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&!this.isFiltering()){var d=this.getItemData().value;this.activeIndex=this.getIndexByValue(d);var p=this.findListElement(this.list,"li","data-value",d);this.selectedLI=p}else this.enableVirtualization&&this.getModuleName()==="autocomplete"&&(this.activeIndex=this.skeletonCount);this.beforePopupOpen&&(this.renderPopup(r),this.enableVirtualization&&(this.list.querySelector(".e-virtual-list")||(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"))),this.enableVirtualization&&o!=this.itemCount&&this.resetList(this.dataSource,this.fields))}},e.prototype.isValueInList=function(t,i){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(t[r]===i)return!0}else if(typeof t=="object"&&t!==null){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]===i)return!0}return!1},e.prototype.checkFieldValue=function(t,i){var r=t;return i.forEach(function(n){r=r[n]}),r},e.prototype.updateActionCompleteDataValues=function(t,i){this.actionCompleteData={ulElement:t.cloneNode(!0),list:i,isUpdated:!0},this.actionData.list!==this.actionCompleteData.list&&this.actionCompleteData.ulElement&&this.actionCompleteData.list&&(this.actionData=this.actionCompleteData)},e.prototype.addNewItem=function(t,i){var r=this;if(!m(this.itemData)&&!m(i)){var n=this.getItemData().value,a=t.some(function(o){return(typeof o=="string"||typeof o=="number")&&o===n||ie(r.fields.value,o)===n});a||this.addItem(this.itemData)}},e.prototype.updateActionCompleteData=function(t,i,r){var n=this;this.getModuleName()!=="autocomplete"&&this.actionCompleteData.ulElement&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){n.actionCompleteDataUpdate(t,i,r)},0):this.actionCompleteDataUpdate(t,i,r))},e.prototype.actionCompleteDataUpdate=function(t,i,r){r!==null?this.actionCompleteData.ulElement.insertBefore(t.cloneNode(!0),this.actionCompleteData.ulElement.childNodes[r]):this.actionCompleteData.ulElement.appendChild(t.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list.indexOf(i)<0&&this.actionCompleteData.list.push(i)},e.prototype.focusIndexItem=function(){var t=this.getItemData().value;this.activeIndex=this.getIndexByValue(t);var i=this.findListElement(this.list,"li","data-value",t);this.selectedLI=i,this.activeItem(i),this.enableVirtualization&&m(i)||this.removeFocus()},e.prototype.updateSelection=function(){var t=this.list.querySelector("."+Ke.selected);t?(this.setProperties({index:this.getIndexByValue(t.getAttribute("data-value"))}),this.activeIndex=this.index):(this.removeFocus(),this.list.querySelector("."+Ke.li).classList.add(Xe.focus))},e.prototype.updateSelectionList=function(){var t=this.list&&this.list.querySelector(".e-active");if(!t&&!m(this.value)){var i=this.findListElement(this.list,"li","data-value",this.value);i&&i.classList.add("e-active")}},e.prototype.checkAndResetCache=function(){this.enableVirtualization&&(this.generatedDataObject={},this.virtualItemStartIndex=this.virtualItemEndIndex=0,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.selectedValueInfo=null)},e.prototype.removeFocus=function(){var t=this.list.querySelectorAll("."+Xe.focus);t&&t.length&&te(t,Xe.focus)},e.prototype.getTransformValues=function(){var t=this.viewPortInfo.startIndex*this.listItemHeight;t=t-this.skeletonCount*this.listItemHeight,t=this.viewPortInfo.startIndex===0&&this.listData&&this.listData.length===0?0:t;var i="transform: translate(0px, "+t+"px);";return i},e.prototype.GetVirtualTrackHeight=function(){var t=this.totalItemCount===this.viewPortInfo.endIndex?this.totalItemCount*this.listItemHeight-this.itemCount*this.listItemHeight:this.totalItemCount*this.listItemHeight,i="height: "+(t-this.itemCount*this.listItemHeight)+"px;";return this.getModuleName()==="autocomplete"&&this.skeletonCount===0?"height: 0px;":i},e.prototype.renderPopup=function(t){var i=this;if(this.popupObj&&document.body.contains(this.popupObj.element)){this.refreshPopup();return}var r={cancel:!1};this.trigger("beforeOpen",r,function(n){if(n.cancel)i.beforePopupOpen=!1;else{var a=i.createElement("div",{id:i.element.id+"_popup",className:"e-ddl e-popup "+(i.cssClass!==null?i.cssClass:"")});a.setAttribute("aria-label",i.element.id),a.setAttribute("role","dialog");var o=i.setSearchBox(a);if(i.listHeight=qe(i.popupHeight),i.headerTemplate&&i.setHeaderTemplate(a),Ut([i.list],a),i.footerTemplate&&i.setFooterTemplate(a),document.body.appendChild(a),a.style.top="0px",i.enableVirtualization&&i.itemTemplate){var l=a.querySelectorAll("li.e-list-item:not(.e-virtual-list)");i.listItemHeight=l.length>0?Math.ceil(l[0].getBoundingClientRect().height):0}if(i.enableVirtualization&&!i.list.classList.contains(Ke.noData))if(i.list.querySelector(".e-virtual-ddl-content")?i.list.getElementsByClassName("e-virtual-ddl-content")[0].style=i.getTransformValues():i.list.appendChild(i.createElement("div",{className:"e-virtual-ddl-content",styles:i.getTransformValues()})).appendChild(i.list.querySelector(".e-list-parent")),i.UpdateSkeleton(),i.liCollections=i.list.querySelectorAll("."+Ke.li),i.virtualItemCount=i.itemCount,i.list.querySelector(".e-virtual-ddl"))i.list.getElementsByClassName("e-virtual-ddl")[0].style=i.GetVirtualTrackHeight();else{var h=i.createElement("div",{id:i.element.id+"_popup",className:"e-virtual-ddl",styles:i.GetVirtualTrackHeight()});a.querySelector(".e-dropdownbase").appendChild(h)}if(a.style.visibility="hidden",i.popupHeight!=="auto"){if(i.searchBoxHeight=0,!m(o.container)&&i.getModuleName()!=="combobox"&&i.getModuleName()!=="autocomplete"&&(i.searchBoxHeight=o.container.parentElement.getBoundingClientRect().height,i.listHeight=(parseInt(i.listHeight,10)-i.searchBoxHeight).toString()+"px"),i.headerTemplate){i.header=i.header?i.header:a.querySelector(".e-ddl-header");var u=Math.round(i.header.getBoundingClientRect().height);i.listHeight=(parseInt(i.listHeight,10)-(u+i.searchBoxHeight)).toString()+"px"}if(i.footerTemplate){i.footer=i.footer?i.footer:a.querySelector(".e-ddl-footer");var u=Math.round(i.footer.getBoundingClientRect().height);i.listHeight=(parseInt(i.listHeight,10)-(u+i.searchBoxHeight)).toString()+"px"}i.list.style.maxHeight=(parseInt(i.listHeight,10)-2).toString()+"px",a.style.maxHeight=qe(i.popupHeight)}else a.style.height="auto";var c=0,d=void 0;if(i.isPreventScrollAction=!0,!m(i.selectedLI)&&!m(i.activeIndex)&&i.activeIndex>=0||i.enableVirtualization?i.setScrollPosition():i.list.scrollTop=0,B.isDevice&&!i.allowFiltering&&(i.getModuleName()==="dropdownlist"||i.isDropDownClick&&i.getModuleName()==="combobox")){c=i.getOffsetValue(a);var p=i.isEmptyList()?i.list:i.liCollections[0];m(i.inputElement)||(d=-(parseInt(getComputedStyle(p).textIndent,10)-parseInt(getComputedStyle(i.inputElement).paddingLeft,10)+parseInt(getComputedStyle(i.inputElement.parentElement).borderLeftWidth,10)))}i.createPopup(a,c,d),i.popupContentElement=i.popupObj.element.querySelector(".e-content"),i.getFocusElement(),i.checkCollision(a),B.isDevice&&(i.popupObj.element.classList.add(Xe.device),(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox"&&!i.allowFiltering&&i.isDropDownClick)&&(i.popupObj.collision={X:"fit",Y:"fit"}),i.isFilterLayout()&&(i.popupObj.element.classList.add(Xe.mobileFilter),i.popupObj.position={X:0,Y:0},i.popupObj.dataBind(),De(i.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),Q([document.body,i.popupObj.element],Xe.popupFullScreen),i.setSearchBoxPosition(),i.backIconElement=o.container.querySelector(".e-back-icon"),i.clearIconElement=o.container.querySelector("."+Xe.clearIcon),I.add(i.backIconElement,"click",i.clickOnBackIcon,i),I.add(i.clearIconElement,"click",i.clearText,i))),a.style.visibility="visible",Q([a],"e-popup-close");for(var f=i.popupObj.getScrollableParent(i.inputWrapper.container),v=0,g=f;v<g.length;v++){var b=g[v];I.add(b,"scroll",i.scrollHandler,i)}m(i.list)||(i.unWireListEvents(),i.wireListEvents()),i.selectedElementID=i.selectedLI?i.selectedLI.id:null,i.enableVirtualization&&(i.notify("bindScrollEvent",{module:"VirtualScroll",component:i.getModuleName(),enable:i.enableVirtualization}),setTimeout(function(){(i.value||i.list.querySelector(".e-active"))&&(i.updateSelectionList(),i.selectedValueInfo&&i.viewPortInfo&&i.viewPortInfo.offsets.top?i.list.scrollTop=i.viewPortInfo.offsets.top:i.scrollBottom(!0,!0))},5)),De(i.targetElement(),{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.inputElement.setAttribute("aria-expanded","true"),i.inputElement.setAttribute("aria-controls",i.element.id);var y=i.isFiltering()?i.filterInput.parentElement:i.inputWrapper.container;Q([y],[Xe.inputFocus]);var C={name:"FadeIn",duration:100};i.beforePopupOpen=!0;var x=i.popupObj,w={popup:x,event:t,cancel:!1,animation:C};i.trigger("open",w,function(M){M.cancel?(i.beforePopupOpen=!1,i.destroyPopup()):(m(i.inputWrapper)||Q([i.inputWrapper.container],[Xe.iconAnimation]),i.renderReactTemplates(),m(i.popupObj)||i.popupObj.show(new ri(M.animation),i.zIndex===1e3?i.element:null))})}})},e.prototype.checkCollision=function(t){if(!B.isDevice||B.isDevice&&!(this.getModuleName()==="dropdownlist"||this.isDropDownClick)){var i=Qa(t);i.length>0&&(t.style.marginTop=-parseInt(getComputedStyle(t).marginTop,10)+"px"),this.popupObj.resolveCollision()}},e.prototype.getOffsetValue=function(t){var i=getComputedStyle(t),r=parseInt(i.borderTopWidth,10),n=parseInt(i.borderBottomWidth,10);return this.setPopupPosition(r+n)},e.prototype.createPopup=function(t,i,r){var n=this;this.popupObj=new za(t,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.enableRtl,offsetX:r,position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:function(){n.isDocumentClick||n.focusDropDown(),n.isReact&&n.clearTemplate(["headerTemplate","footerTemplate"]),n.isNotSearchList=!1,n.isDocumentClick=!1,n.destroyPopup(),n.isFiltering()&&n.actionCompleteData.list&&n.actionCompleteData.list[0]&&(n.isActive=!0,n.enableVirtualization?n.onActionComplete(n.ulElement,n.listData,null,!0):n.onActionComplete(n.actionCompleteData.ulElement,n.actionCompleteData.list,null,!0))},open:function(){I.add(document,"mousedown",n.onDocumentClick,n),n.isPopupOpen=!0;var a=n.actionCompleteData&&n.actionCompleteData.ulElement&&n.actionCompleteData.ulElement.querySelector("li"),o=n.list.querySelector("ul li");!m(n.ulElement)&&!m(n.ulElement.getElementsByClassName("e-item-focus")[0])?De(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(n.ulElement)&&!m(n.ulElement.getElementsByClassName("e-active")[0])&&De(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-active")[0].id}),n.isFiltering()&&n.itemTemplate&&n.element.tagName===n.getNgDirective()&&a&&o&&a.textContent!==o.textContent&&n.element.tagName!=="EJS-COMBOBOX"&&n.cloneElements(),n.isFilterLayout()&&(te([n.inputWrapper.container],[Xe.inputFocus]),n.isFilterFocus=!0,n.filterInput.focus(),n.inputWrapper.clearButton&&Q([n.inputWrapper.clearButton],Xe.clearIconHide)),n.activeStateChange()},targetExitViewport:function(){B.isDevice||n.hidePopup()}})},e.prototype.isEmptyList=function(){return!m(this.liCollections)&&this.liCollections.length===0},e.prototype.getFocusElement=function(){},e.prototype.isFilterLayout=function(){return this.getModuleName()==="dropdownlist"&&this.allowFiltering},e.prototype.scrollHandler=function(){B.isDevice&&(this.getModuleName()==="dropdownlist"&&!this.isFilterLayout()||this.getModuleName()==="combobox"&&!this.allowFiltering&&this.isDropDownClick)&&this.element&&!this.isElementInViewport(this.element)&&this.hidePopup()},e.prototype.isElementInViewport=function(t){var i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=window.innerHeight&&i.right<=window.innerWidth},e.prototype.setSearchBoxPosition=function(){var t=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-t+"px",this.list.style.height=window.innerHeight-t+"px";var i=this.filterInput.parentElement.querySelector("."+Xe.clearIcon);ne(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},e.prototype.setPopupPosition=function(t){var i,r=t,n=this.list.querySelector("."+Xe.focus)||this.selectedLI,a=this.isEmptyList()?this.list:this.liCollections[0],o=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],l=a.getBoundingClientRect().height;this.listItemHeight=l;var h=this.list.offsetHeight/2,u=m(n)?a.offsetTop:n.offsetTop,c=o.offsetTop;if(c-h<u&&!m(this.liCollections)&&this.liCollections.length>0&&!m(n)){var d=this.list.offsetHeight/l,p=parseInt(getComputedStyle(this.list).paddingBottom,10);i=(d-(this.liCollections.length-this.activeIndex))*l-r+p,this.list.scrollTop=n.offsetTop}else u>h&&!this.enableVirtualization?(i=h-l/2,this.list.scrollTop=u-h+l/2):i=u;var f=this.inputWrapper.container.offsetHeight;return i=i+l+r-(l-f)/2,-i},e.prototype.setWidth=function(){var t=qe(this.popupWidth);if(t.indexOf("%")>-1){var i=this.inputWrapper.container.offsetWidth*parseFloat(t)/100;t=i.toString()+"px"}if(B.isDevice&&!this.allowFiltering&&(this.getModuleName()==="dropdownlist"||this.isDropDownClick&&this.getModuleName()==="combobox")){var r=this.isEmptyList()?this.list:this.liCollections[0];t=parseInt(t,10)+(parseInt(getComputedStyle(r).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))*2+"px"}return t},e.prototype.scrollBottom=function(t,i,r){var n=this;if(i===void 0&&(i=!1),r===void 0&&(r=null),m(this.selectedLI)&&this.enableVirtualization&&(this.selectedLI=this.list.querySelector("."+Ke.li),!m(this.selectedLI)&&this.selectedLI.classList.contains("e-virtual-list")&&(this.selectedLI=this.liCollections[this.skeletonCount])),!m(this.selectedLI)){this.isUpwardScrolling=!1;var a=this.list.querySelectorAll(".e-virtual-list").length,o=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,l=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop,h=this.list.offsetHeight,u=l-a*this.selectedLI.offsetHeight+this.selectedLI.offsetHeight-this.list.scrollTop,c=this.list.scrollTop+u-h,d=!1;c=t?c+parseInt(getComputedStyle(this.list).paddingTop,10)*2:c+parseInt(getComputedStyle(this.list).paddingTop,10);var p=l-a*this.selectedLI.offsetHeight+this.selectedLI.offsetHeight-this.list.scrollTop;if(p=this.fields.groupBy&&!m(this.fixedHeaderElement)?p-this.fixedHeaderElement.offsetHeight:p,this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0,d=this.isKeyBoardAction;else if(u>h||!(p>0&&this.list.offsetHeight>p)){var f=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,v=r=="pageDown"?this.getPageCount()-2:1;!this.enableVirtualization||this.isKeyBoardAction||i?this.isKeyBoardAction&&this.enableVirtualization&&o&&f===o&&r!="end"&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.enableVirtualization&&this.itemTemplate?this.list.scrollTop+=c:this.list.scrollTop+=this.selectedLI.offsetHeight*v,this.isPreventKeyAction=this.IsScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r=="end"?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(r=="pageDown"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,c=c+this.selectedLI.offsetHeight*v),this.list.scrollTop=c):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight:0,d=this.isKeyBoardAction}this.isKeyBoardAction=d,this.enableVirtualization&&this.fields.groupBy&&this.fixedHeaderElement&&r=="down"&&setTimeout(function(){n.scrollStop(null,!0)},100)}},e.prototype.scrollTop=function(t){if(t===void 0&&(t=null),!m(this.selectedLI)){var i=this.list.querySelectorAll(".e-virtual-list").length,r=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop,n=r-i*this.selectedLI.offsetHeight-this.list.scrollTop,a=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;n=this.fields.groupBy&&!m(this.fixedHeaderElement)?n-this.fixedHeaderElement.offsetHeight:n;var o=r-i*this.selectedLI.offsetHeight+this.selectedLI.offsetHeight-this.list.scrollTop,l=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&n<=0;if(this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(n<0||l){var h=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,u=t=="pageUp"?this.getPageCount()-2:1;this.enableVirtualization&&this.isKeyBoardAction&&a&&h===a&&t!="home"&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.list.scrollTop-=this.selectedLI.offsetHeight*u,this.isPreventKeyAction=this.list.scrollTop!=0?this.isPreventKeyAction:!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&t=="home"?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(t=="pageUp"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,n=n-this.selectedLI.offsetHeight*u),this.list.scrollTop=this.list.scrollTop+n)}else o>0&&this.list.offsetHeight>o||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!m(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},e.prototype.isEditTextBox=function(){return!1},e.prototype.isFiltering=function(){return this.allowFiltering},e.prototype.isPopupButton=function(){return!0},e.prototype.setScrollPosition=function(t){if(this.isPreventScrollAction=!0,m(t))this.scrollBottom(!0);else switch(t.action){case"pageDown":case"down":case"end":this.isKeyBoardAction=!0,this.scrollBottom(!1,!1,t.action);break;default:this.isKeyBoardAction=t.action=="up"||t.action=="pageUp"||t.action=="open",this.scrollTop(t.action);break}this.isKeyBoardAction=!1},e.prototype.clearText=function(){this.filterInput.value=this.typedString="",this.searchLists(null),this.enableVirtualization&&(this.list.scrollTop=0,this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0]&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.getSkeletonCount(),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()))},e.prototype.setEleWidth=function(t){m(t)||(typeof t=="number"?this.inputWrapper.container.style.width=qe(t):typeof t=="string"&&(this.inputWrapper.container.style.width=t.match(/px|%|em/)?t:qe(t)))},e.prototype.closePopup=function(t,i){var r=this,n=!m(this.filterInput)&&!m(this.filterInput.value)&&this.filterInput.value!=="";if(this.getModuleName()==="combobox"&&this.typedString,this.isTyped=!1,!!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen)){this.keyboardEvent=null,I.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.filterInputObj=null,this.isDropDownClick=!1,this.preventAutoFill=!1;for(var a=this.popupObj.getScrollableParent(this.inputWrapper.container),o=0,l=a;o<l.length;o++){var h=l[o];I.remove(h,"scroll",this.scrollHandler)}B.isDevice&&this.isFilterLayout()&&te([document.body,this.popupObj.element],Xe.popupFullScreen),this.isFilterLayout()&&(B.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&I.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(I.remove(this.backIconElement,"click",this.clickOnBackIcon),I.remove(this.clearIconElement,"click",this.clearText)),m(this.filterInput)||(I.remove(this.filterInput,"input",this.onInput),I.remove(this.filterInput,"keyup",this.onFilterUp),I.remove(this.filterInput,"keydown",this.onFilterDown),I.remove(this.filterInput,"blur",this.onBlurHandler),I.remove(this.filterInput,"paste",this.pasteHandler)),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&this.filterInput.removeAttribute("aria-activedescendant"),this.filterInput=null),De(this.targetElement(),{"aria-expanded":"false"}),this.inputElement.setAttribute("aria-expanded","false"),this.targetElement().removeAttribute("aria-owns"),this.targetElement().removeAttribute("aria-activedescendant"),this.inputWrapper.container.classList.remove(Xe.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.enableVirtualization&&(this.value==null||this.isTyped?(this.viewPortInfo.endIndex=this.viewPortInfo&&this.viewPortInfo.endIndex>0?this.viewPortInfo.endIndex:this.itemCount,(this.getModuleName()==="autocomplete"||this.getModuleName()==="dropdownlist"&&!m(this.typedString)&&this.typedString!=""||this.getModuleName()==="combobox"&&this.allowFiltering&&!m(this.typedString)&&this.typedString!="")&&this.checkAndResetCache()):this.getModuleName()==="autocomplete"&&this.checkAndResetCache(),(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.skeletonCount!=0&&this.getSkeletonCount(!0)),this.beforePopupOpen=!1;var u={name:"FadeOut",duration:100,delay:t||0},c=this.popupObj,d={popup:c,cancel:!1,animation:u,event:i||null};this.trigger("close",d,function(f){if(!m(r.popupObj)&&!m(r.popupObj.element.querySelector(".e-fixed-head"))){var v=r.popupObj.element.querySelector(".e-fixed-head");v.parentNode.removeChild(v),r.fixedHeaderElement=null}f.cancel||(r.getModuleName()==="autocomplete"&&r.rippleFun(),r.isPopupOpen?r.popupObj.hide(new ri(f.animation)):r.destroyPopup())}),this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&(this.actionCompleteData.ulElement=this.ulElement.cloneNode(!0));var p;this.dataSource instanceof ge?p=this.virtualGroupDataSource&&this.virtualGroupDataSource.length?this.virtualGroupDataSource.length:0:p=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.enableVirtualization&&this.isFiltering()&&this.value!=null&&n&&this.totalItemCount!==p&&(this.updateInitialData(),this.checkAndResetCache())}},e.prototype.updateInitialData=function(){var t=this.selectData,i=this.renderItems(t,this.fields);this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},this.getModuleName()==="combobox"&&(this.typedString=""),this.previousStartIndex=0,this.previousEndIndex=0,this.dataSource instanceof ge?this.totalItemCount=this.dataCount=this.virtualGroupDataSource&&this.virtualGroupDataSource.length?this.virtualGroupDataSource.length:0:this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0]&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.getModuleName()!=="autocomplete"&&this.totalItemCount!=0&&this.totalItemCount>this.itemCount*2&&this.getSkeletonCount(),this.UpdateSkeleton(),this.listData=t,this.updateActionCompleteDataValues(i,t),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())},e.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.popupObj&&(this.popupObj.destroy(),ne(this.popupObj.element))},e.prototype.clickOnBackIcon=function(){this.hidePopup(),this.focusIn()},e.prototype.render=function(){this.preselectedIndex=m(this.index)?null:this.index,this.element.tagName==="INPUT"?(this.inputElement=this.element,m(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","combobox"),m(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text"),this.inputElement.setAttribute("aria-expanded","false")):(this.inputElement=this.createElement("input",{attrs:{role:"combobox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement));var t=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(t=this.cssClass.replace(/\s+/g," ").trim()),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.inputWrapper=ye.createInput({element:this.inputElement,buttons:this.isPopupButton()?[Xe.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:this.getModuleName()==="dropdownlist"?!0:this.readonly,placeholder:this.placeholder,cssClass:t,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true","aria-label":this.getModuleName(),tabindex:"-1",class:Xe.hiddenElement}}),xs([this.hiddenElement],this.inputWrapper.container),this.validationAttribute(this.element,this.hiddenElement),this.setReadOnly(),this.setFields(),this.inputWrapper.container.style.width=qe(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.floatLabelType==="Auto"&&ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");var i=this.element.getAttribute("id")?this.element.getAttribute("id"):mi("ej2_dropdownlist");if(this.element.id=i,this.hiddenElement.id=i+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.setAttribute("aria-label",this.getModuleName()):this.getModuleName()==="dropdownlist"&&(De(this.targetElement(),{"aria-label":this.getModuleName()}),this.inputElement.setAttribute("aria-label",this.getModuleName()),this.inputElement.setAttribute("aria-expanded","false"),this.inputElement.setAttribute("aria-controls",this.element.id+"_popups")),De(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),this.targetElement()===this.inputElement&&this.inputElement.removeAttribute("aria-labelledby"),this.value!==null||this.activeIndex!==null||this.text!==null)this.enableVirtualization&&(this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.updateVirtualizationProperties(this.itemCount,this.allowFiltering)),this.initValue(),this.selectedValueInfo=this.viewPortInfo,this.enableVirtualization&&(this.activeIndex=this.activeIndex+this.skeletonCount);else if(this.element.tagName==="SELECT"&&this.element.options[0]){var r=this.element;this.value=r.options[r.selectedIndex].value,this.text=m(this.value)?null:r.options[r.selectedIndex].textContent,this.initValue()}this.setEnabled(),this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=function(a){a.stopImmediatePropagation()},this.inputElement.onchange=function(a){a.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),m(this.text)||this.inputElement.setAttribute("value",this.text),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false");var n=this.inputWrapper.container.getElementsByClassName("e-float-text")[0];!m(this.element.id)&&this.element.id!==""&&!m(n)&&(n.id="label_"+this.element.id.replace(/ /g,"_"),De(this.inputElement,{"aria-labelledby":n.id})),this.renderComplete(),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount},e.prototype.getListHeight=function(){var t=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=qe(this.popupHeight);t.style.height=parseInt(r,10).toString()+"px",t.appendChild(i),document.body.appendChild(t),this.virtualListHeight=t.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height);return t.remove(),n},e.prototype.setFooterTemplate=function(t){var i;this.footer?this.isReact&&typeof this.footerTemplate=="function"?this.clearTemplate(["footerTemplate"]):this.footer.innerHTML="":(this.footer=this.createElement("div"),Q([this.footer],Xe.footer));var r=this.dropdownCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&r?i=pi($(this.footerTemplate,document).innerHTML.trim()):i=pi(this.footerTemplate);var n=i({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);n&&n.length>0&&Ut(n,this.footer),Ut([this.footer],t)},e.prototype.setHeaderTemplate=function(t){var i;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),Q([this.header],Xe.header));var r=this.dropdownCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&r?i=pi($(this.headerTemplate,document).innerHTML.trim()):i=pi(this.headerTemplate);var n=i({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);n&&n.length&&Ut(n,this.header);var a=t.querySelector("div.e-content");t.insertBefore(this.header,a)},e.prototype.setEnabled=function(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")},e.prototype.setOldText=function(t){this.text=t},e.prototype.setOldValue=function(t){this.value=t},e.prototype.refreshPopup=function(){!m(this.popupObj)&&document.body.contains(this.popupObj.element)&&(this.allowFiltering&&!(B.isDevice&&this.isFilterLayout())||this.getModuleName()==="autocomplete")&&(te([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container),this.popupObj.resolveCollision())},e.prototype.checkData=function(t){t.dataSource&&!m(Object.keys(t.dataSource))&&this.itemTemplate&&this.allowFiltering&&!(this.isListSearched&&t.dataSource instanceof ge)&&(this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1}),this.isListSearched=!1;var i=Object.keys(t).indexOf("value")!==-1&&m(t.value),r=Object.keys(t).indexOf("text")!==-1&&m(t.text);this.getModuleName()!=="autocomplete"&&this.allowFiltering&&(i||r)&&(this.itemData=null),this.allowFiltering&&t.dataSource&&!m(Object.keys(t.dataSource))?(this.actionCompleteData={ulElement:null,list:null,isUpdated:!1},this.actionData=this.actionCompleteData):this.allowFiltering&&t.query&&!m(Object.keys(t.query))&&(this.actionCompleteData=this.getModuleName()==="combobox"?{ulElement:null,list:null,isUpdated:!1}:this.actionCompleteData,this.actionData=this.actionCompleteData)},e.prototype.updateDataSource=function(t){(this.inputElement.value!==""||!m(t)&&(m(t.dataSource)||!(t.dataSource instanceof ge)&&t.dataSource.length===0))&&this.clearAll(null,t),this.fields.groupBy&&t.fields&&!this.isGroupChecking&&this.list&&(I.remove(this.list,"scroll",this.setFloatingHeader),I.add(this.list,"scroll",this.setFloatingHeader,this)),(!(!m(t)&&(m(t.dataSource)||!(t.dataSource instanceof ge)&&t.dataSource.length===0))||!(Array.isArray(t.dataSource)&&t.dataSource.length===0))&&(this.typedString="",this.resetList(this.dataSource)),!this.isCustomFilter&&!this.isFilterFocus&&document.activeElement!==this.filterInput&&this.checkCustomValue()},e.prototype.checkCustomValue=function(){this.itemData=this.getDataByValue(this.value);var t=this.getItemData();this.setProperties({text:t.text,value:t.value})},e.prototype.updateInputFields=function(){this.getModuleName()==="dropdownlist"&&ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.onPropertyChanged=function(t,i){var r=this;!m(t.dataSource)&&!this.isTouched&&m(t.value)&&m(t.index)&&!m(this.preselectedIndex)&&(t.index=this.preselectedIndex),(!m(t.value)||!m(t.index))&&(this.isTouched=!0),this.getModuleName()==="dropdownlist"&&(this.checkData(t),this.setUpdateInitial(["fields","query","dataSource"],t));for(var n=function(u){switch(u){case"query":case"dataSource":a.getSkeletonCount(),a.checkAndResetCache();break;case"htmlAttributes":a.setHTMLAttributes();break;case"width":a.setEleWidth(t.width),ye.calculateWidth(a.inputElement,a.inputWrapper.container);break;case"placeholder":ye.setPlaceholder(t.placeholder,a.inputElement);break;case"filterBarPlaceholder":a.filterInput&&ye.setPlaceholder(t.filterBarPlaceholder,a.filterInput);break;case"readonly":a.getModuleName()!=="dropdownlist"&&ye.setReadonly(t.readonly,a.inputElement),a.setReadOnly();break;case"cssClass":a.setCssClass(t.cssClass,i.cssClass),ye.calculateWidth(a.inputElement,a.inputWrapper.container);break;case"enableRtl":a.setEnableRtl();break;case"enabled":a.setEnable();break;case"text":if(t.text===null){a.clearAll();break}if(a.enableVirtualization){a.updateValues(),a.updateInputFields(),a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"});break}if(a.list||(a.dataSource instanceof ge&&(a.initRemoteRender=!0),a.renderList()),!a.initRemoteRender){var c=a.getElementByText(t.text);if(!a.checkValidLi(c))if(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100)a.setSelectionData(t.text,i.text,"text");else if(t.text&&a.dataSource instanceof ge){var d=a.getItems().length,p=m(a.fields.text)?a.fields.value:a.fields.text;a.typedString="",a.dataSource.executeQuery(a.getQuery(a.query).where(new It(p,"equal",t.text))).then(function(y){y.result.length>0?(r.addItem(y.result,d),r.updateValues()):r.setOldText(i.text)})}else a.getModuleName()==="autocomplete"?a.setInputValue(t,i):a.setOldText(i.text);a.updateInputFields()}break;case"value":if(t.value===null){a.clearAll();break}if(a.enableVirtualization){a.updateValues(),a.updateInputFields(),a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),a.preventChange=a.isAngular&&a.preventChange?!a.preventChange:a.preventChange;break}if(a.notify("beforeValueChange",{newProp:t}),a.list||(a.dataSource instanceof ge&&(a.initRemoteRender=!0),a.renderList()),!a.initRemoteRender){var f=a.getElementByValue(t.value);if(!a.checkValidLi(f))if(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100)a.setSelectionData(t.value,i.value,"value");else if(t.value&&a.dataSource instanceof ge){var v=a.getItems().length,p=m(a.fields.value)?a.fields.text:a.fields.value;a.typedString="",a.dataSource.executeQuery(a.getQuery(a.query).where(new It(p,"equal",t.value))).then(function(C){C.result.length>0?(r.addItem(C.result,v),r.updateValues()):r.setOldValue(i.value)})}else a.getModuleName()==="autocomplete"?a.setInputValue(t,i):a.setOldValue(i.value);a.updateInputFields(),a.preventChange=a.isAngular&&a.preventChange?!a.preventChange:a.preventChange}break;case"index":if(t.index===null){a.clearAll();break}if(a.list||(a.dataSource instanceof ge&&(a.initRemoteRender=!0),a.renderList()),!a.initRemoteRender&&a.liCollections){var g=a.liCollections[t.index];a.checkValidLi(g)||(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100?a.setSelectionData(t.index,i.index,"index"):a.index=i.index),a.updateInputFields()}break;case"footerTemplate":a.popupObj&&a.setFooterTemplate(a.popupObj.element);break;case"headerTemplate":a.popupObj&&a.setHeaderTemplate(a.popupObj.element);break;case"valueTemplate":!m(a.itemData)&&a.valueTemplate!==null&&a.setValueTemplate();break;case"allowFiltering":a.allowFiltering&&(a.actionCompleteData={ulElement:a.ulElement,list:a.listData,isUpdated:!0},a.actionData=a.actionCompleteData,a.updateSelectElementData(a.allowFiltering));break;case"floatLabelType":ye.removeFloating(a.inputWrapper),ye.addFloating(a.inputElement,t.floatLabelType,a.placeholder,a.createElement),!m(a.inputWrapper.buttons[0])&&a.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0]&&a.floatLabelType!=="Never"&&a.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"showClearButton":a.inputWrapper.clearButton||(ye.setClearButton(t.showClearButton,a.inputElement,a.inputWrapper,null,a.createElement),a.bindClearEvent());break;default:{var b=a.getPropObject(u,t,i);s.prototype.onPropertyChanged.call(a,b.newProperty,b.oldProperty)}break}},a=this,o=0,l=Object.keys(t);o<l.length;o++){var h=l[o];n(h)}},e.prototype.checkValidLi=function(t){return this.isValidLI(t)?(this.setSelection(t,null),!0):!1},e.prototype.setSelectionData=function(t,i,r){var n=this,a;this.updateListValues=function(){r==="text"?(a=n.getElementByText(t),n.checkValidLi(a)||n.setOldText(i)):r==="value"?(a=n.getElementByValue(t),n.checkValidLi(a)||n.setOldValue(i)):r==="index"&&(a=n.liCollections[t],n.checkValidLi(a)||(n.index=i))}},e.prototype.updatePopupState=function(){this.beforePopupOpen&&(this.beforePopupOpen=!1,this.showPopup())},e.prototype.setReadOnly=function(){this.readonly?Q([this.inputWrapper.container],["e-readonly"]):te([this.inputWrapper.container],["e-readonly"])},e.prototype.setInputValue=function(t,i){},e.prototype.setCssClass=function(t,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(t)||(t=t.replace(/\s+/g," ").trim()),ye.setCssClass(t,[this.inputWrapper.container],i),this.popupObj&&ye.setCssClass(t,[this.popupObj.element],i)},e.prototype.getModuleName=function(){return"dropdownlist"},e.prototype.showPopup=function(t){if(this.enabled){if(this.isReact&&this.getModuleName()==="combobox"&&this.itemTemplate&&this.isCustomFilter&&this.isAddNewItemTemplate&&(this.renderList(),this.isAddNewItemTemplate=!1),this.isFiltering()&&this.dataSource instanceof ge&&this.actionData.list!==this.actionCompleteData.list&&this.actionData.list&&this.actionData.ulElement&&(this.actionCompleteData=this.actionData,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)),this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):(m(this.list)||!Re(this.list)&&(this.list.classList.contains(Ke.noData)||this.list.querySelectorAll("."+Ke.li).length<=0))&&this.renderList(t),this.enableVirtualization&&this.listData&&this.listData.length&&(!m(this.value)&&(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.removeHover(),this.beforePopupOpen||this.notify("setCurrentViewDataAsync",{module:"VirtualScroll"})),this.beforePopupOpen&&this.invokeRenderPopup(t),this.enableVirtualization&&!this.allowFiltering&&this.selectedValueInfo!=null&&this.selectedValueInfo.startIndex>0&&this.value!=null&&this.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0})}},e.prototype.invokeRenderPopup=function(t){if(B.isDevice&&this.isFilterLayout()){var i=this;window.onpopstate=function(){i.hidePopup()},history.pushState({},"")}!m(this.list)&&(!m(this.list.children[0])||this.list.classList.contains(Ke.noData))&&this.renderPopup(t)},e.prototype.renderHightSearch=function(){},e.prototype.hidePopup=function(t){if(this.isEscapeKey&&this.getModuleName()==="dropdownlist")if(m(this.inputElement)||ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,m(this.index))this.resetSelection();else{var i=this.findListElement(this.ulElement,"li","data-value",this.value);this.selectedLI=this.liCollections[this.index]||i,this.selectedLI&&(this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&this.itemData!==null&&this.setValueTemplate())}this.closePopup(0,t);var r=this.getItemData(),n=!m(this.selectedLI);n&&this.enableVirtualization&&this.selectedLI.classList&&(n=this.selectedLI.classList.contains("e-active")),this.inputElement&&this.inputElement.value.trim()===""&&!this.isInteracted&&(this.isSelectCustom||n&&this.inputElement.value!==r.text)&&(this.isSelectCustom=!1,this.clearAll(t))},e.prototype.focusIn=function(t){if(this.enabled&&!this.targetElement().classList.contains(Xe.disable)){var i=!1;this.preventFocus&&B.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,i=!0),i||this.targetElement().focus(),Q([this.inputWrapper.container],[Xe.inputFocus]),this.onFocus(t),this.floatLabelType==="Auto"&&ye.calculateWidth(this.inputElement,this.inputWrapper.container)}},e.prototype.focusOut=function(t){this.enabled&&(!this.enableVirtualization&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.isTyped=!0),this.hidePopup(t),this.targetElement()&&this.targetElement().blur(),te([this.inputWrapper.container],[Xe.inputFocus]),this.floatLabelType==="Auto"&&this.inputElement.value===""&&ye.calculateWidth(this.inputElement,this.inputWrapper.container))},e.prototype.destroy=function(){if(this.isActive=!1,vY(this.element.id),this.isReact&&this.clearTemplate(),this.hidePopup(),this.unWireEvent(),this.list&&this.unWireListEvents(),!(this.element&&!this.element.classList.contains("e-"+this.getModuleName()))){if(this.inputElement){for(var t=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-describedby","aria-label"],i=0;i<t.length;i++)this.inputElement.removeAttribute(t[i]);this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),ye.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)}this.element.style.display="block",this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?ne(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),ne(this.inputWrapper.container)),this.hiddenElement=null,this.inputWrapper=null,this.keyboardModule=null,this.ulElement=null,this.list=null,this.popupObj=null,this.popupContentElement=null,this.rippleFun=null,this.selectedLI=null,this.liCollections=null,this.item=null,this.inputWrapper=null,this.footer=null,this.header=null,this.previousSelectedLI=null,this.valueTempElement=null,this.actionData.ulElement=null,this.inputElement&&!m(this.inputElement.onchange)&&(this.inputElement.onchange=null),this.isAngular&&(this.inputElement=null),s.prototype.destroy.call(this)}},e.prototype.getItems=function(){return this.list||(this.dataSource instanceof ge&&(this.initRemoteRender=!0),this.renderList()),this.ulElement?s.prototype.getItems.call(this):[]},e.prototype.getDataByValue=function(t){return s.prototype.getDataByValue.call(this,t)},e.prototype.clear=function(){this.value=null},Ii([S(null)],e.prototype,"cssClass",void 0),Ii([S("100%")],e.prototype,"width",void 0),Ii([S(!0)],e.prototype,"enabled",void 0),Ii([S(!1)],e.prototype,"enablePersistence",void 0),Ii([S("300px")],e.prototype,"popupHeight",void 0),Ii([S("100%")],e.prototype,"popupWidth",void 0),Ii([S(null)],e.prototype,"placeholder",void 0),Ii([S(null)],e.prototype,"filterBarPlaceholder",void 0),Ii([S({})],e.prototype,"htmlAttributes",void 0),Ii([S(null)],e.prototype,"query",void 0),Ii([S(null)],e.prototype,"valueTemplate",void 0),Ii([S(null)],e.prototype,"headerTemplate",void 0),Ii([S(null)],e.prototype,"footerTemplate",void 0),Ii([S(!1)],e.prototype,"allowFiltering",void 0),Ii([S(!1)],e.prototype,"readonly",void 0),Ii([S(!1)],e.prototype,"enableVirtualization",void 0),Ii([S(null)],e.prototype,"text",void 0),Ii([S(null)],e.prototype,"value",void 0),Ii([S(null)],e.prototype,"index",void 0),Ii([S("Never")],e.prototype,"floatLabelType",void 0),Ii([S(!1)],e.prototype,"showClearButton",void 0),Ii([_()],e.prototype,"filtering",void 0),Ii([_()],e.prototype,"change",void 0),Ii([_()],e.prototype,"beforeOpen",void 0),Ii([_()],e.prototype,"open",void 0),Ii([_()],e.prototype,"close",void 0),Ii([_()],e.prototype,"blur",void 0),Ii([_()],e.prototype,"focus",void 0),e=Ii([Ot],e),e}(TY),LY=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$i=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},zk="e-atc-spinner-icon";Xe.root="e-combobox";var OY={container:null,buttons:[]},Xz=function(s){LY(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){s.prototype.preRender.call(this)},e.prototype.getLocaleName=function(){return"combo-box"},e.prototype.wireEvent=function(){this.getModuleName()==="combobox"&&(I.add(this.inputWrapper.buttons[0],"mousedown",this.preventBlur,this),I.add(this.inputWrapper.container,"blur",this.onBlurHandler,this)),m(this.inputWrapper.buttons[0])||I.add(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick,this),I.add(this.inputElement,"focus",this.targetFocus,this),this.readonly||(I.add(this.inputElement,"input",this.onInput,this),I.add(this.inputElement,"keyup",this.onFilterUp,this),I.add(this.inputElement,"keydown",this.onFilterDown,this),I.add(this.inputElement,"paste",this.pasteHandler,this),I.add(window,"resize",this.windowResize,this)),this.bindCommonEvent()},e.prototype.preventBlur=function(t){(!this.allowFiltering&&document.activeElement!==this.inputElement&&!document.activeElement.classList.contains(Xe.input)&&B.isDevice||!B.isDevice)&&t.preventDefault()},e.prototype.onBlurHandler=function(t){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;!m(this.listData)&&!m(i)&&i!==this.text&&this.customValue(t),s.prototype.onBlurHandler.call(this,t)},e.prototype.targetElement=function(){return this.inputElement},e.prototype.setOldText=function(t){ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue(),this.removeSelection()},e.prototype.setOldValue=function(t){this.allowCustom?this.valueMuteChange(this.value):this.valueMuteChange(null),this.removeSelection(),this.setHiddenValue()},e.prototype.valueMuteChange=function(t){var i=m(t)?null:t.toString();ye.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:t,text:t,index:null},!0),this.activeIndex=this.index;var r=this.fields,n={};n[r.text]=m(t)?null:t.toString(),n[r.value]=m(t)?null:t.toString(),this.itemData=n,this.item=null,this.previousValue!==this.value&&this.detachChangeEvent(null)},e.prototype.updateValues=function(){if(m(this.value))if(this.text&&m(this.value)){var t=this.getElementByText(this.text);t?this.setSelection(t,null):(ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue())}else this.setSelection(this.liCollections[this.activeIndex],null);else{var t=this.getElementByValue(this.value);t?this.setSelection(t,null):this.allowCustom?this.valueMuteChange(this.value):this.valueMuteChange(null)}this.setHiddenValue(),ye.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement&&this.inputElement.value!==""&&!this.readonly?te([this.inputWrapper.clearButton],Xe.clearIconHide):Q([this.inputWrapper.clearButton],Xe.clearIconHide))},e.prototype.getAriaAttributes=function(){var t={role:"combobox","aria-autocomplete":"both","aria-labelledby":this.hiddenElement.id,"aria-expanded":"false","aria-readonly":this.readonly.toString(),autocomplete:"off",autocapitalize:"off",spellcheck:"false"};return t},e.prototype.searchLists=function(t){this.isTyped=!0,this.isFiltering()?(s.prototype.searchLists.call(this,t),this.ulElement&&this.filterInput.value.trim()===""&&this.setHoverList(this.ulElement.querySelector("."+Xe.li))):(this.ulElement&&this.inputElement.value===""&&this.preventAutoFill&&this.setHoverList(this.ulElement.querySelector("."+Xe.li)),this.incrementalSearch(t))},e.prototype.getNgDirective=function(){return"EJS-COMBOBOX"},e.prototype.setSearchBox=function(){this.filterInput=this.inputElement;var t=this.isFiltering()||this.isReact&&this.getModuleName()==="combobox"?this.inputWrapper:OY;return t},e.prototype.onActionComplete=function(t,i,r,n){var a=this;s.prototype.onActionComplete.call(this,t,i,r),this.isSelectCustom&&this.removeSelection(),!this.preventAutoFill&&this.getModuleName()==="combobox"&&this.isTyped&&!this.enableVirtualization&&setTimeout(function(){a.inlineSearch()})},e.prototype.getFocusElement=function(){var t=this.isSelectCustom?{text:""}:this.getItemData(),i=m(this.list)?this.list:this.list.querySelector("."+Xe.selected),r=t.text&&t.text.toString()===this.inputElement.value&&!m(i);if(r)return i;if((B.isDevice&&!this.isDropDownClick||!B.isDevice)&&!m(this.liCollections)&&this.liCollections.length>0){var n=this.inputElement.value,a=this.sortedData,o=this.typeOfData(a).typeof,l=nc(n,this.liCollections,this.filterType,!0,a,this.fields,o);if(this.enableVirtualization&&n!==""&&this.getModuleName()!=="autocomplete"&&this.isTyped&&!this.allowFiltering){var h=!1;for((this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex==0)&&(h=!0,this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex==0?this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100:this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0),(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=nc(n,this.incrementalLiCollections,this.filterType,!0,a,this.fields,o);m(l)&&this.incrementalEndIndex<this.totalItemCount&&(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0,(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=nc(n,this.incrementalLiCollections,this.filterType,!0,a,this.fields,o),!!m(l));)if(m(l)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}if(l.index&&(!(this.viewPortInfo.startIndex>=l.index)||!(l.index>=this.viewPortInfo.endIndex))){var u=l.index-(this.itemCount/2-2)>0?l.index-(this.itemCount/2-2):0,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;u!=this.viewPortInfo.startIndex&&this.updateIncrementalView(u,c)}if(m(l.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var d=this.getIndexByValue(l.item.getAttribute("data-value"))-this.skeletonCount;if(d>this.itemCount/2){var u=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}l.item=this.getElementByValue(l.item.getAttribute("data-value"))}l&&l.item&&(l.item=this.getElementByValue(l.item.getAttribute("data-value")))}var p=l.item;if(m(p))this.isSelectCustom&&this.inputElement.value.trim()!==""&&(this.removeFocus(),this.enableVirtualization||(this.list.scrollTop=0));else{var f=this.getIndexByValue(p.getAttribute("data-value"))-1,v=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10);if(!isNaN(v)&&this.getModuleName()!=="autocomplete"){this.removeFocus();var g=this.fields.groupBy?this.liCollections[0].offsetHeight:0;if(!this.enableVirtualization)this.list.scrollTop=f*v+g;else if(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var b=this.virtualListInfo&&this.virtualListInfo.startIndex?p.offsetTop+this.virtualListInfo.startIndex*p.offsetHeight:p.offsetTop;this.list.scrollTop=b-this.list.querySelectorAll(".e-virtual-list").length*p.offsetHeight}Q([p],Xe.focus)}}return p}else return null},e.prototype.setValue=function(t){return t&&t.type==="keydown"&&t.action==="enter"&&this.removeFillSelection(),this.autofill&&this.getModuleName()==="combobox"&&t&&t.type==="keydown"&&t.action!=="enter"?(this.preventAutoFill=!1,this.inlineSearch(t),!1):s.prototype.setValue.call(this,t)},e.prototype.checkCustomValue=function(){this.itemData=this.getDataByValue(this.value);var t=this.getItemData();this.allowCustom&&m(t.value)&&m(t.text)||this.setProperties({value:t.value},!this.allowCustom)},e.prototype.showSpinner=function(){m(this.spinnerElement)&&(this.spinnerElement=this.getModuleName()==="autocomplete"?this.inputWrapper.buttons[0]||this.inputWrapper.clearButton||ye.appendSpan("e-input-group-icon "+zk,this.inputWrapper.container,this.createElement):this.inputWrapper.buttons[0]||this.inputWrapper.clearButton,Q([this.spinnerElement],Xe.disableIcon),Nd({target:this.spinnerElement,width:B.isDevice?"16px":"14px"},this.createElement),Ol(this.spinnerElement))},e.prototype.hideSpinner=function(){m(this.spinnerElement)||(kd(this.spinnerElement),te([this.spinnerElement],Xe.disableIcon),this.spinnerElement.classList.contains(zk)?ne(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},e.prototype.setAutoFill=function(t,i){if(i||this.setHoverList(t),this.autofill&&!this.preventAutoFill){var r=this.getTextByValue(t.getAttribute("data-value")).toString(),n=this.getFormattedValue(t.getAttribute("data-value"));this.getModuleName()==="combobox"&&(!this.isSelected&&this.previousValue!==n?(this.updateSelectedItem(t,null),this.isSelected=!0,this.previousValue=this.getFormattedValue(t.getAttribute("data-value"))):this.updateSelectedItem(t,null,!0)),this.isAndroidAutoFill(r)||this.setAutoFillSelection(r,i)}},e.prototype.isAndroidAutoFill=function(t){if(B.isAndroid){var i=this.getSelectionPoints(),r=this.prevSelectPoints.end,n=i.end,a=this.prevSelectPoints.start,o=i.start;return r!==0&&(r===t.length&&a===t.length||a>o&&r>n||r===n&&a===o)}else return!1},e.prototype.clearAll=function(t,i){(m(i)||!m(i)&&m(i.dataSource))&&s.prototype.clearAll.call(this,t),this.isFiltering()&&!m(t)&&t.target===this.inputWrapper.clearButton&&this.searchLists(t)},e.prototype.isSelectFocusItem=function(t){return!m(t)},e.prototype.inlineSearch=function(t){var i=t&&(t.action==="down"||t.action==="up"||t.action==="home"||t.action==="end"||t.action==="pageUp"||t.action==="pageDown"),r=i?this.liCollections[this.activeIndex]:this.getFocusElement();if(m(r))if(this.inputElement.value===""){if(this.activeIndex=null,!m(this.list)){this.enableVirtualization||(this.list.scrollTop=0);var a=this.list.querySelector("."+Xe.li);this.setHoverList(a)}}else this.activeIndex=null,this.removeSelection(),this.liCollections&&this.liCollections.length>0&&!this.isCustomFilter&&this.removeFocus();else{if(!i){var n=this.getFormattedValue(r.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(n),this.activeIndex=m(this.activeIndex)?null:this.activeIndex}this.preventAutoFill=this.inputElement.value===""?!1:this.preventAutoFill,this.setAutoFill(r,i)}},e.prototype.incrementalSearch=function(t){this.showPopup(t),m(this.listData)||(this.inlineSearch(t),t.preventDefault())},e.prototype.setAutoFillSelection=function(t,i){i===void 0&&(i=!1);var r=this.getSelectionPoints(),n=this.inputElement.value.substr(0,r.start);if(n&&n.toLowerCase()===t.substr(0,r.start).toLowerCase()){var a=n+t.substr(n.length,t.length);ye.setValue(a,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(r.start,this.inputElement.value.length)}else i&&(ye.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(0,this.inputElement.value.length))},e.prototype.getValueByText=function(t){return s.prototype.getValueByText.call(this,t,!0,this.ignoreAccent)},e.prototype.unWireEvent=function(){this.getModuleName()==="combobox"&&(I.remove(this.inputWrapper.buttons[0],"mousedown",this.preventBlur),I.remove(this.inputWrapper.container,"blur",this.onBlurHandler)),m(this.inputWrapper.buttons[0])||I.remove(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick),this.inputElement&&(I.remove(this.inputElement,"focus",this.targetFocus),this.readonly||(I.remove(this.inputElement,"input",this.onInput),I.remove(this.inputElement,"keyup",this.onFilterUp),I.remove(this.inputElement,"keydown",this.onFilterDown),I.remove(this.inputElement,"paste",this.pasteHandler),I.remove(window,"resize",this.windowResize))),this.unBindCommonEvent()},e.prototype.setSelection=function(t,i){s.prototype.setSelection.call(this,t,i),!m(t)&&!this.autofill&&!this.isDropDownClick&&this.removeFocus()},e.prototype.selectCurrentItem=function(t){var i;this.isPopupOpen&&(this.isSelected?i=this.list.querySelector("."+Xe.selected):i=this.list.querySelector("."+Xe.focus),i&&(this.setSelection(i,t),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(t))),t.action==="enter"&&this.inputElement.value.trim()===""?this.clearAll(t):this.isTyped&&!this.isSelected&&m(i)&&this.customValue(t),this.hidePopup(t)},e.prototype.setHoverList=function(t){this.removeSelection(),this.isValidLI(t)&&!t.classList.contains(Xe.selected)&&(this.removeFocus(),t.classList.add(Xe.focus))},e.prototype.targetFocus=function(t){B.isDevice&&!this.allowFiltering&&(this.preventFocus=!1),this.onFocus(t),ye.calculateWidth(this.inputElement,this.inputWrapper.container)},e.prototype.dropDownClick=function(t){t.preventDefault(),B.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),s.prototype.dropDownClick.call(this,t)},e.prototype.customValue=function(t){var i=this,r=this.getValueByText(this.inputElement.value);if(!this.allowCustom&&this.inputElement.value!==""){var n=this.previousValue,a=this.value;this.setProperties({value:r}),m(this.value)&&ye.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.autofill&&n===this.value&&a!==this.value&&this.onChangeEvent(null)}else if(this.inputElement.value.trim()!==""){var o=this.value;if(m(r)){var l=this.inputElement.value===""?null:this.inputElement.value,h={text:l,item:{}};this.initial?this.updateCustomValueCallback(l,h,o):this.trigger("customValueSpecifier",h,function(u){i.updateCustomValueCallback(l,u,o,t)})}else this.isSelectCustom=!1,this.setProperties({value:r}),o!==this.value&&this.onChangeEvent(t)}else this.allowCustom&&(this.isSelectCustom=!0)},e.prototype.updateCustomValueCallback=function(t,i,r,n){var a=this.fields,o=i.item,l={};o&&ie(a.text,o)&&ie(a.value,o)?l=o:(kt(a.text,t,l),kt(a.value,t,l)),this.itemData=l;var h={text:ie(a.text,this.itemData),value:ie(a.value,this.itemData),index:null};this.setProperties(h,!0),this.setSelection(null,null),this.isSelectCustom=!0,r!==this.value&&this.onChangeEvent(n)},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="combobox"&&(this.checkData(t),this.setUpdateInitial(["fields","query","dataSource"],t));for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"readonly":ye.setReadonly(this.readonly,this.inputElement),this.readonly?(I.remove(this.inputElement,"input",this.onInput),I.remove(this.inputElement,"keyup",this.onFilterUp),I.remove(this.inputElement,"keydown",this.onFilterDown)):(I.add(this.inputElement,"input",this.onInput,this),I.add(this.inputElement,"keyup",this.onFilterUp,this),I.add(this.inputElement,"keydown",this.onFilterDown,this)),this.setReadOnly();break;case"allowFiltering":this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&m(this.list)&&s.prototype.renderList.call(this);break;case"allowCustom":break;default:{var o=this.getPropObject(a,t,i);s.prototype.onPropertyChanged.call(this,o.newProperty,o.oldProperty),this.isFiltering()&&a==="dataSource"&&m(this.list)&&this.itemTemplate&&this.getModuleName()==="combobox"&&s.prototype.renderList.call(this);break}}}},e.prototype.render=function(){s.prototype.render.call(this),this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&m(this.list)&&s.prototype.renderList.call(this),this.renderComplete()},e.prototype.getModuleName=function(){return"combobox"},e.prototype.addItem=function(t,i){s.prototype.addItem.call(this,t,i)},e.prototype.filter=function(t,i,r){s.prototype.filter.call(this,t,i,r)},e.prototype.showPopup=function(t){s.prototype.showPopup.call(this,t)},e.prototype.hidePopup=function(t){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;if(!m(this.listData)){var r=this.isEscapeKey;this.isEscapeKey&&(ye.setValue(this.typedString,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1),this.autofill&&this.removeFillSelection();var n=this.isSelectCustom?{text:""}:this.getItemData(),a=m(this.list)?null:this.list.querySelector("."+Xe.selected);if(this.inputElement&&n.text===this.inputElement.value&&!m(a)){this.isSelected&&(this.onChangeEvent(t),this.isSelectCustom=!1),s.prototype.hidePopup.call(this,t);return}if(this.getModuleName()==="combobox"&&this.inputElement.value.trim()!==""){var o=this.sortedData,l=this.typeOfData(o).typeof,h=nc(this.inputElement.value,this.liCollections,"Equal",!0,o,this.fields,l);this.selectedLI=h.item,m(h.index)&&(h.index=nc(this.inputElement.value,this.liCollections,"StartsWith",!0,o,this.fields,l).index),this.activeIndex=h.index,m(this.selectedLI)?r&&(this.isSelectCustom=!0,this.removeSelection()):this.updateSelectedItem(this.selectedLI,null,!0)}!this.isEscapeKey&&this.isTyped&&!this.isInteracted&&this.customValue(t)}m(this.listData)&&this.allowCustom&&!m(i)&&i!==this.value&&this.customValue(),s.prototype.hidePopup.call(this,t)},e.prototype.focusIn=function(){this.enabled&&(B.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),s.prototype.focusIn.call(this))},e.prototype.clear=function(){this.value=null},e.prototype.focusOut=function(t){s.prototype.focusOut.call(this,t)},e.prototype.getItems=function(){return s.prototype.getItems.call(this)},e.prototype.getDataByValue=function(t){return s.prototype.getDataByValue.call(this,t)},e.prototype.renderHightSearch=function(){},$i([S(!1)],e.prototype,"autofill",void 0),$i([S(!0)],e.prototype,"allowCustom",void 0),$i([S({})],e.prototype,"htmlAttributes",void 0),$i([S(!1)],e.prototype,"allowFiltering",void 0),$i([S(null)],e.prototype,"query",void 0),$i([S(null)],e.prototype,"index",void 0),$i([S(!0)],e.prototype,"showClearButton",void 0),$i([S(!1)],e.prototype,"enableRtl",void 0),$i([_()],e.prototype,"customValueSpecifier",void 0),$i([_()],e.prototype,"filtering",void 0),$i([S(null)],e.prototype,"valueTemplate",void 0),$i([S("Never")],e.prototype,"floatLabelType",void 0),$i([S(null)],e.prototype,"filterBarPlaceholder",void 0),$i([S(null)],e.prototype,"cssClass",void 0),$i([S(null)],e.prototype,"headerTemplate",void 0),$i([S(null)],e.prototype,"footerTemplate",void 0),$i([S(null)],e.prototype,"placeholder",void 0),$i([S("100%")],e.prototype,"width",void 0),$i([S("300px")],e.prototype,"popupHeight",void 0),$i([S("100%")],e.prototype,"popupWidth",void 0),$i([S(!1)],e.prototype,"readonly",void 0),$i([S(null)],e.prototype,"text",void 0),$i([S(null)],e.prototype,"value",void 0),e=$i([Ot],e),e}(Na),RY=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cn=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};Xe.root="e-autocomplete";Xe.icon="e-input-group-icon e-ddl-icon e-search-icon";var Kz=function(s){RY(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.isFiltered=!1,r.searchList=!1,r}return e.prototype.preRender=function(){s.prototype.preRender.call(this)},e.prototype.getLocaleName=function(){return"auto-complete"},e.prototype.getNgDirective=function(){return"EJS-AUTOCOMPLETE"},e.prototype.getQuery=function(t){var i=t?t.clone():this.query?this.query.clone():new $e,r=this.queryString===""&&!m(this.value)?"equal":this.filterType,n=this.queryString===""&&!m(this.value)?this.value:this.queryString;if(this.isFiltered)return i;if(this.queryString!==null&&this.queryString!==""){var a=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof ge)&&a==="string"||a==="number")i.where("",r,n,this.ignoreCase,this.ignoreAccent);else if(!this.enableVirtualization||this.enableVirtualization&&(!(this.dataSource instanceof ge)||this.dataSource instanceof ge&&this.virtualGroupDataSource)){var o=m(this.fields.value)?"":this.fields.value;i.where(o,r,n,this.ignoreCase,this.ignoreAccent)}}if(!m(this.suggestionCount)&&!this.enableVirtualization){if(this.suggestionCount!==20)for(var l=0;l<i.queries.length;l++)i.queries[l].fn==="onTake"&&i.queries.splice(l,1);i.take(this.suggestionCount)}if(this.enableVirtualization&&(!(this.dataSource instanceof ge)||this.dataSource instanceof ge&&this.virtualGroupDataSource)){var h=this.getTakeValue();i.skip(this.virtualItemStartIndex),i.take(h),i.requiresCount()}return i},e.prototype.searchLists=function(t){var i=this;if(this.isTyped=!0,this.isDataFetched=this.isSelectCustom=!1,this.checkAndResetCache(),m(this.list)&&s.prototype.renderList.call(this,t,!0),this.queryString=this.filterInput.value,t.type!=="mousedown"&&(t.keyCode===40||t.keyCode===38)){this.queryString=this.queryString===""?null:this.queryString,this.beforePopupOpen=!0,this.resetList(this.dataSource,this.fields,null,t);return}this.isSelected=!1,this.activeIndex=null;var r={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(n,a,o){r.cancel||(i.isFiltered=!0,i.filterAction(n,a,o))},cancel:!1};this.trigger("filtering",r,function(n){!n.cancel&&!i.isFiltered&&!n.preventDefaultAction&&(i.searchList=!0,i.filterAction(i.dataSource,null,i.fields,t))})},e.prototype.filter=function(t,i,r){this.isFiltered=!0,this.filterAction(t,i,r)},e.prototype.filterAction=function(t,i,r,n){this.beforePopupOpen=!0;var a=this.list.classList.contains("e-nodata");if(this.queryString!==""&&this.queryString.length>=this.minLength){if(this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(t,r,i,n),this.enableVirtualization&&a&&!this.list.classList.contains("e-nodata")&&(this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content",styles:this.getTransformValues()})).appendChild(this.list.querySelector(".e-list-parent")),!this.list.querySelector(".e-virtual-ddl"))){var o=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});document.getElementsByClassName("e-popup")[0].querySelector(".e-dropdownbase").appendChild(o)}(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof ge)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof ge&&this.totalItemCount!=0)&&this.getFilteringSkeletonCount()}else this.hidePopup(n),this.beforePopupOpen=!1;this.renderReactTemplates()},e.prototype.clearAll=function(t,i){(m(i)||!m(i)&&m(i.dataSource))&&(s.prototype.clearAll.call(this,t),this.checkAndResetCache()),this.beforePopupOpen&&this.hidePopup()},e.prototype.onActionComplete=function(t,i,r,n){this.enableVirtualization||(this.fixedHeaderElement=null),(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof ge)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof ge&&this.totalItemCount!=0)&&this.getFilteringSkeletonCount(),s.prototype.onActionComplete.call(this,t,i,r);var a=this.list.querySelector("."+Xe.li);m(a)||te([a],Xe.focus),this.postBackAction()},e.prototype.postBackAction=function(){if(this.autofill&&!m(this.liCollections[0])&&this.searchList){var t=[this.liCollections[0]],i=this.listData,r=this.typeOfData(i).typeof,n=nc(this.inputElement.value,t,"StartsWith",this.ignoreCase,i,this.fields,r);this.searchList=!1,m(n.item)||s.prototype.setAutoFill.call(this,this.liCollections[0],!0)}},e.prototype.setSelection=function(t,i){if(!this.isValidLI(t)){this.selectedLI=t;return}if(!m(i)&&i.type==="keydown"&&i.action!=="enter"&&i.action!=="tab"&&this.isValidLI(t)){var r=this.getFormattedValue(t.getAttribute("data-value"));if(this.activeIndex=this.getIndexByValue(r),this.setHoverList(t),this.selectedLI=t,this.setScrollPosition(i),this.autofill&&this.isPopupOpen){this.preventAutoFill=!1;var n=i&&i.action==="down"||i.action==="up"||i.action==="home"||i.action==="end"||i.action==="pageUp"||i.action==="pageDown";s.prototype.setAutoFill.call(this,t,n)}}else s.prototype.setSelection.call(this,t,i)},e.prototype.listOption=function(t,i){var r=this,n=s.prototype.listOption.call(this,t,i);if(m(n.itemCreated))n.itemCreated=function(o){if(r.highlight)if(r.element.tagName===r.getNgDirective()&&r.itemTemplate)setTimeout(function(){Ym(o.item,r.queryString,r.ignoreCase,r.filterType)},0);else{var l=/<[^>]*>/g.test(o.item.innerText);l&&(o.item.innerText=o.item.innerText.replace(/[\u00A0-\u9999<>&]/g,function(h){return"&#"+h.charCodeAt(0)+";"})),Ym(o.item,r.queryString,r.ignoreCase,r.filterType)}};else{var a=n.itemCreated;n.itemCreated=function(o){r.highlight&&Ym(o.item,r.queryString,r.ignoreCase,r.filterType),a.apply(r,[o])}}return n},e.prototype.isFiltering=function(){return!0},e.prototype.renderPopup=function(t){this.enableVirtualization||(this.list.scrollTop=0),s.prototype.renderPopup.call(this,t)},e.prototype.isEditTextBox=function(){return!1},e.prototype.isPopupButton=function(){return this.showPopupButton},e.prototype.isSelectFocusItem=function(t){return!1},e.prototype.setInputValue=function(t,i){var r=i&&i.text?i.text:i&&i.value,n=t&&t.text?t.text:t&&t.value?t.value:this.value;if(n&&this.typedString===""&&!this.allowCustom&&!(this.dataSource instanceof ge)){var a=this.typeOfData(this.dataSource).typeof==="string"?"":this.fields.value,o=this.getItems().length,l=new $e,h=this;new ge(this.dataSource).executeQuery(l.where(new It(a,"equal",n))).then(function(u){u.result.length>0?(h.value=a!==""?u.result[0][h.fields.value].toString():u.result[0].toString(),h.addItem(u.result,o),h.updateValues()):t&&t.text?h.setOldText(r):t&&t.value?h.setOldValue(r):h.updateValues()})}else t&&(t.text?this.setOldText(r):this.setOldValue(r))},e.prototype.showPopup=function(t){if(this.enabled){if(this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.preventAutoFill=!0,m(this.list)?this.renderList(t):this.resetList(this.dataSource,this.fields,null,t)}},e.prototype.hidePopup=function(t){s.prototype.hidePopup.call(this,t),this.activeIndex=null,this.virtualListInfo=this.viewPortInfo,this.previousStartIndex=this.viewPortInfo.startIndex,this.startIndex=this.viewPortInfo.startIndex,this.previousEndIndex=this.viewPortInfo.endIndex},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="autocomplete"&&this.setUpdateInitial(["fields","query","dataSource"],t);for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"showPopupButton":if(this.showPopupButton){var o=ye.appendSpan(Xe.icon,this.inputWrapper.container,this.createElement);this.inputWrapper.buttons[0]=o,ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),this.inputWrapper&&this.inputWrapper.buttons&&this.inputWrapper.buttons[0]&&I.add(this.inputWrapper.buttons[0],"click",this.dropDownClick,this)}else ne(this.inputWrapper.buttons[0]),this.inputWrapper.buttons[0]=null;break;default:{var l=this.getPropObject(a,t,i);s.prototype.onPropertyChanged.call(this,l.newProperty,l.oldProperty);break}}}},e.prototype.renderHightSearch=function(){if(this.highlight)for(var t=0;t<this.liCollections.length;t++){var i=this.ulElement.querySelector(".e-active");i||(mY(this.liCollections[t]),Ym(this.liCollections[t],this.queryString,this.ignoreCase,this.filterType))}},e.prototype.getModuleName=function(){return"autocomplete"},e.prototype.render=function(){s.prototype.render.call(this)},cn([Ee({value:null,iconCss:null,groupBy:null},$z)],e.prototype,"fields",void 0),cn([S(!0)],e.prototype,"ignoreCase",void 0),cn([S(!1)],e.prototype,"showPopupButton",void 0),cn([S(!1)],e.prototype,"highlight",void 0),cn([S(20)],e.prototype,"suggestionCount",void 0),cn([S({})],e.prototype,"htmlAttributes",void 0),cn([S(null)],e.prototype,"query",void 0),cn([S(1)],e.prototype,"minLength",void 0),cn([S("Contains")],e.prototype,"filterType",void 0),cn([_()],e.prototype,"filtering",void 0),cn([S(null)],e.prototype,"index",void 0),cn([S("Never")],e.prototype,"floatLabelType",void 0),cn([S(null)],e.prototype,"valueTemplate",void 0),cn([S(null)],e.prototype,"filterBarPlaceholder",void 0),cn([S(!1)],e.prototype,"allowFiltering",void 0),cn([S(null)],e.prototype,"text",void 0),e=cn([Ot],e),e}(Xz),FY=function(){function s(e){this.data=[],this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener();var e=$("#"+this.parent.element.id+"_datavalidation-popup");e&&e.remove(),this.parent=null},s.prototype.addEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?I.add(this.parent.element,"touchend",this.listOpen,this):I.add(this.parent.element,"dblclick",this.listOpen,this),this.parent.on(Z1,this.initiateDataValidationHandler,this),this.parent.on(Zf,this.invalidDataHandler,this),this.parent.on(jf,this.checkDataValidation,this),this.parent.on(sa,this.listHandler,this),this.parent.on(Xn,this.keyUpHandler,this),this.parent.on(Jf,this.removeValidationHandler,this),this.parent.on(v1,this.InvalidElementHandler,this)},s.prototype.removeEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?I.remove(this.parent.element,"touchend",this.listOpen):I.remove(this.parent.element,"dblclick",this.listOpen),this.parent.isDestroyed||(this.parent.off(Z1,this.initiateDataValidationHandler),this.parent.off(Zf,this.invalidDataHandler),this.parent.off(jf,this.checkDataValidation),this.parent.off(sa,this.listHandler),this.parent.off(Xn,this.keyUpHandler),this.parent.off(Jf,this.removeValidationHandler),this.parent.off(v1,this.InvalidElementHandler))},s.prototype.removeValidationHandler=function(e){var t,i,r={cancel:!1,isColSelected:e.isCol},n=e.range;if(e.range&&e.range.includes("!")){if(i=e.range,t=Pe(this.parent,gt(this.parent,i.split("!")[0])),!t)return}else if(t=this.parent.getActiveSheet(),i=t.name+"!",e.range)i+=e.range;else{var a=this.getRange(t.selectedRange);i+=a.range,r.isColSelected=a.isColSelected}if(n=t.selectedRange,r.range=i,e.isAction&&this.parent.notify(li,{eventArgs:r,action:"removeValidation"}),!r.cancel){var o=void 0,l=void 0,h=void 0;if(t.name===this.parent.getActiveSheet().name){h=xe(t.activeCell);var u=lt(ee(n));h[0]>=u[0]&&h[1]>=u[1]&&h[0]<=u[2]&&h[1]<=u[3]&&(l=r.isColSelected?oi(t,h[1])||{}:Y(h[0],h[1],t,!1,!0),o=l.validation&&l.validation.type==="List")}if(this.parent.notify(Yo,{range:i,isRemoveValidation:!0,viewport:this.parent.viewport}),o&&!l.validation){var c=this.parent.getCell(h[0],h[1]);c&&c.getElementsByClassName("e-validation-list")[0]&&(this.listObj.destroy(),c.removeChild(c.getElementsByClassName("e-validation-list")[0]))}e.isAction&&(delete r.cancel,this.parent.notify(yt,{eventArgs:r,action:"removeValidation"}))}},s.prototype.keyUpHandler=function(e){var t=e.target,i=this.parent.element.querySelector(".e-datavalidation-dlg");if(U(t,".e-values")&&i&&e.keyCode!==13){var r=i.querySelector(".e-values"),n=r.querySelector(".e-dlg-error"),a=i.querySelector(".e-footer-content"),o=a.querySelector(".e-primary");o.hasAttribute("disabled")&&o.removeAttribute("disabled"),n&&r.removeChild(n)}},s.prototype.listOpen=function(e){var t=e.target;this.listObj&&t.classList.contains("e-cell")&&t.querySelector(".e-validation-list")&&this.parent.isEdit&&this.listObj.showPopup()},s.prototype.invalidDataHandler=function(e){var t={range:e.range||this.parent.dataValidationRange,cancel:!1};if(t.range){var i;!e.isPublic&&(i={eventArgs:t,action:e.isRemoveHighlight?"removeHighlight":"addHighlight"},this.parent.notify(li,i),t.cancel)||(e.isRemoveHighlight?this.parent.removeInvalidHighlight(t.range):this.parent.addInvalidHighlight(t.range),e.isPublic||this.parent.notify(yt,i))}},s.prototype.listHandler=function(){var e=this;if(this.parent.allowDataValidation){var t=this.parent.getActiveSheet(),i=xe(t.activeCell),r=Y(i[0],i[1],t),n=this.parent.getCell(i[0],i[1]),a;if(!n)return;document.getElementsByClassName("e-validation-list")[0]&&(this.listObj&&this.listObj.destroy(),pt(document.getElementsByClassName("e-validation-list")[0]),this.data=[]);var o=r&&r.validation||t.columns&&t.columns[i[1]]&&t.columns[i[1]].validation;if(o&&o.type==="List"){if(o.address&&!ez(o.address,i[0],i[1]))return;if(o.ignoreBlank=m(o.ignoreBlank)?!0:o.ignoreBlank,o.inCellDropDown=m(o.inCellDropDown)?!0:o.inCellDropDown,o.inCellDropDown){var l=this.parent.createElement("div",{className:"e-validation-list"}),h=this.parent.createElement("input",{id:this.parent.element.id+"listValid"});l.appendChild(h),o.inCellDropDown||(l.style.display="none");var u=n.getElementsByClassName("e-wrap-content")[0]||n;u.insertBefore(l,u.firstChild);var c=this.updateDataSource(r,o);this.listObj=new Na({index:this.setDropDownListIndex(c,r),dataSource:c,fields:{text:"text",value:"id"},width:"0px",popupHeight:"200px",change:function(){return e.listValueChange(e.listObj.text)},beforeOpen:function(d){a=window.browserDetails.isDevice,a&&(window.browserDetails.isDevice=!1)},open:function(d){if(d.popup.offsetX=-(n.offsetWidth-20)+4,d.popup.offsetY=-13,d.popup.element.style.width=n.offsetWidth-1+"px",a){var p=n.querySelector(".e-validation-list"),f=n.querySelector(".e-control-wrapper.e-ddl");d.popup.offsetX=-(n.offsetWidth-(p?p.offsetWidth:20))+4,d.popup.offsetY=-((f?f.offsetHeight:37)-(p?p.offsetHeight:18)),window.browserDetails.isDevice=!0}},close:function(d){d.event&&(d.event.keyCode===13||d.event.altKey&&d.event.keyCode===38)&&(d.event.preventDefault(),d.event.stopPropagation()),Fe(e.parent.element)}}),this.listObj.appendTo("#"+this.parent.element.id+"listValid")}}r&&r.validation&&(r.validation=o)}},s.prototype.setDropDownListIndex=function(e,t){if(t&&t.value){for(var i=0,r=e.length;i<r;i++)if(e[i].text===t.value.toString())return i}return null},s.prototype.updateDataSource=function(e,t){var i=this;this.data=[];var r=0,n=this.parent.definedNames,a=t.value1,o=a.indexOf("=")!==-1;if(n.length>0&&o){for(var l=a.split("=")[1],h=0,u=n.length;h<u;h++)if(n[h].name===l){for(var c=n[h].refersTo;c.includes("'");)c=c.replace("'","");a=c}}if(o){var d=a.indexOf("!")>-1?Pe(this.parent,gt(this.parent,a.split("=")[1].split("!")[0])):this.parent.getActiveSheet(),p=a.indexOf("!")>-1?a.split("!")[1]:a.split("=")[1],f=this.parent.getActiveSheet();if(d.name!==f.name){var v,g=ee(f.selectedRange);d.ranges.forEach(function(T){if(!T.info||!T.info.loadedRange||!T.info.loadedRange.length){v=!0;return}}),v&&(this.parent.showSpinner(),$s(this.parent,d.name+"!"+p).then(function(){if(i.parent.hideSpinner(),f.name===i.parent.getActiveSheet().name){var T=ee(i.parent.getActiveSheet().selectedRange);T[0]===g[0]&&T[1]===g[1]&&(i.listObj.dataSource=i.updateDataSource(e,t),i.listObj.dataBind())}}))}var b=void 0,y=p.split(":");if(y[0].match(/[a-z]+$/ig)&&y[1].match(/[a-z]+$/ig)||y[0].match(/^[0-9]/g)&&y[1].match(/^[0-9]/g)){var C=this.parent.getIndexes(p);C.isCol?b=[0,C.startIdx,d.usedRange.rowIndex,C.startIdx]:b=[C.startIdx,0,C.startIdx,d.usedRange.colIndex]}else b=ee(p);for(var x=b[0];x<=b[2];x++){d.rows[x]||Ts(d,x,{});for(var w=b[1];w<=b[3];w++){d.rows[x].cells||Ht(x,w,d,{}),r+=1,e=d.rows[x].cells[w];var M=this.parent.getDisplayText(e)||"";this.data.push({text:M,id:"list-"+r})}}}else for(var E=a.split(","),h=0;h<E.length;h++)r+=1,this.data.push({text:E[h],id:"list-"+r});return this.data},s.prototype.listValueChange=function(e){this.parent.notify(Po,{action:"refreshFormulabar",value:e});var t=this.parent.getActiveSheet(),i=ir(t.activeCell),r=Object.assign({},Y(i[0],i[1],t));if(t.isProtected&&Cn(r,oi(t,i[1])))this.parent.notify(Ta,null);else{this.parent.isEdit&&this.parent.closeEdit();var n={value:e,oldValue:r.value,address:t.name+"!"+t.activeCell,cancel:!1};if(this.parent.notify(li,{action:"cellSave",eventArgs:n}),n.cancel)return;Tn(this.parent,t,{cell:{value:e},rowIdx:i[0],colIdx:i[1],valChange:!0,lastCell:!0,uiRefresh:!0,checkCF:!0}),this.parent.notify(yt,{action:"cellSave",eventArgs:{value:e,oldValue:r.value,address:t.name+"!"+t.activeCell}})}},s.prototype.getRange=function(e){var t=ee(e),i=this.parent.getActiveSheet(),r=i.rowCount,n=i.colCount,a;return t[2]===r-1&&t[0]===0?(e=e.replace(/[0-9]/g,""),a=!0):t[3]===n-1&&t[2]===0&&(e=e.replace(/\D/g,"")),{range:e,isColSelected:a}},s.prototype.initiateDataValidationHandler=function(e,t){var i=this,r=this.parent.serviceLocator.getService(de),n,a,o,l,h=!0,u=!0,c=!0,d=this.parent.getActiveSheet(),p,f=d.selectedRange,v=lt(ee(f));f=this.getRange(f).range;var g=this.validateRange(v,d);if(!g.extendValidation&&!g.moreValidation||e){for(var b=v[0];b<=v[2];b++)if(d.rows[b])for(var y=v[1];y<=v[3];y++)d.rows[b].cells&&d.rows[b].cells[y]&&(p=d.rows[b].cells[y],p.validation&&(c=!1,n=p.validation.type,a=p.validation.operator,o=p.validation.value1,l=p.validation.value2,h=m(p.validation.ignoreBlank)?h:p.validation.ignoreBlank,u=m(p.validation.inCellDropDown)?u:p.validation.inCellDropDown));if(c)for(var C=v[1];C<=v[3];C++){var x=oi(d,C);x&&x.validation&&(c=!1,n=x.validation.type,a=x.validation.operator,o=x.validation.value1,l=x.validation.value2,h=m(x.validation.ignoreBlank)?h:x.validation.ignoreBlank,u=m(x.validation.inCellDropDown)?u:x.validation.inCellDropDown)}if(!this.parent.element.querySelector(".e-datavalidation-dlg")){var w=this.parent.serviceLocator.getService(At);w.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-datavalidation-dlg",header:r.getConstant("DataValidation"),beforeOpen:function(M){var E={dialogName:"ValidationDialog",element:M.element,target:M.target,cancel:M.cancel};i.parent.trigger("dialogBeforeOpen",E),E.cancel&&(M.cancel=!0),t&&(c=!0),w.dialogInstance.content=i.dataValidationContent(c,n,a,o,l,h,u,f),w.dialogInstance.dataBind(),Fe(i.parent.element)},buttons:[{buttonModel:{content:r.getConstant("ClearAll"),cssClass:"e-btn e-clearall-btn e-flat"},click:function(){w.dialogInstance.content=i.dataValidationContent(!0,n,a,o,l,h,u,f),w.dialogInstance.dataBind()}},{buttonModel:{content:r.getConstant("Apply"),isPrimary:!0},click:function(){i.dlgClickHandler(w)}}]}),w.dialogInstance.refresh()}}else g.moreValidation&&this.moreValidationDlg(),g.extendValidation&&this.extendValidationDlg()},s.prototype.dataValidationContent=function(e,t,i,r,n,a,o,l){var h=this,u=this.parent.serviceLocator.getService(de),c,d;if(e)c=d="0";else if(t==="Date"){var p=function(H){if(He(H)){var V={cell:{value:H},type:"date",value:H};return h.parent.notify(Iy,V),V.value}return H};c=p(c),d=p(d)}else c=r,d=n;var f=this.parent.createElement("div",{className:"e-validation-dlg"}),v=this.parent.createElement("div",{className:"e-cellrange"}),g=this.parent.createElement("div",{className:"e-allowdata"}),b=this.parent.createElement("div",{className:"e-values"}),y=this.parent.createElement("div",{className:"e-ignoreblank"});f.appendChild(v),f.appendChild(g),f.appendChild(b),f.appendChild(y);var C=this.parent.createElement("span",{className:"e-header"});C.innerText=u.getConstant("CellRange");var x=this.parent.createElement("input",{className:"e-input",attrs:{value:l,"aria-label":u.getConstant("CellRange")}});v.appendChild(C),v.appendChild(x);var w=this.parent.createElement("div",{className:"e-allow"}),M=this.parent.createElement("div",{className:"e-data"});g.appendChild(w),g.appendChild(M);var E=this.parent.createElement("span",{className:"e-header"});E.innerText=u.getConstant("Allow"),this.typeData=[{text:u.getConstant("WholeNumber"),id:"type-1"},{text:u.getConstant("Decimal"),id:"type-2"},{text:u.getConstant("Date"),id:"type-3"},{text:u.getConstant("Time"),id:"type-4"},{text:u.getConstant("TextLength"),id:"type-5"},{text:u.getConstant("List"),id:"type-6"}],this.operatorData=[{text:u.getConstant("Between"),id:"operator-1"},{text:u.getConstant("NotBetween"),id:"operator-2"},{text:u.getConstant("EqualTo"),id:"operator-3"},{text:u.getConstant("NotEqualTo"),id:"operator-4"},{text:u.getConstant("GreaterThan"),id:"operator-5"},{text:u.getConstant("LessThan"),id:"operator-6"},{text:u.getConstant("GreaterThanOrEqualTo"),id:"operator-7"},{text:u.getConstant("LessThanOrEqualTo"),id:"operator-8"}];var T=this.parent.createElement("input",{className:"e-select"});t&&(t=this.formattedType(t));var D=0;if(!e){for(var N=0;N<this.typeData.length;N++)if(t===this.formattedType(this.typeData[N].text)){D=N;break}}if(e||t!=="List"){var A=0,L=this.parent.createElement("span",{className:"e-header"});L.innerText=u.getConstant("Data");var k=this.parent.createElement("input",{className:"e-select"});if(!e){for(var N=0;N<this.operatorData.length;N++)if(i===this.formattedValue(this.operatorData[N].text)){A=N;break}}M.appendChild(L),M.appendChild(k),this.dataList=new Na({dataSource:this.operatorData,index:A,popupHeight:"200px",change:function(){h.userInput(j,h.dataList)}}),this.dataList.appendTo(k)}else{var O=this.parent.createElement("input",{className:"e-checkbox"});M.appendChild(O);var R=new Vo({label:u.getConstant("InCellDropDown"),checked:o});R.appendTo(O)}w.appendChild(E),w.appendChild(T);var j=new Na({dataSource:this.typeData,index:D,popupHeight:"200px",change:function(){h.userInput(j,h.dataList)}});if(j.appendTo(T),e||j.value!==u.getConstant("List")&&(this.dataList.value===u.getConstant("Between")||this.dataList.value===u.getConstant("NotBetween"))){var P=this.parent.createElement("div",{className:"e-minimum"}),F=this.parent.createElement("div",{className:"e-maximum"});b.appendChild(P),b.appendChild(F);var z=this.parent.createElement("span",{className:"e-header"});z.innerText=u.getConstant("Minimum");var q=this.parent.createElement("span",{className:"e-header"});q.innerText=u.getConstant("Maximum");var X=this.parent.createElement("input",{id:"minvalue",className:"e-input",attrs:{value:c,"aria-label":u.getConstant("Minimum")}}),G=this.parent.createElement("input",{id:"maxvalue",className:"e-input",attrs:{value:d,"aria-label":u.getConstant("Maximum")}});P.appendChild(z),P.appendChild(X),F.appendChild(q),F.appendChild(G);var Z=new to({value:0});Z.appendTo("#minvalue");var se=new to({value:0});se.appendTo("#maxvalue")}else if(!e&&t==="List"){var oe=this.parent.createElement("span",{className:"e-header"});oe.innerText=u.getConstant("Sources");var fe=this.parent.createElement("input",{className:"e-input",attrs:{value:c}});b.appendChild(oe),b.appendChild(fe)}else{var oe=this.parent.createElement("span",{className:"e-header"});oe.innerText=u.getConstant("Value");var fe=this.parent.createElement("input",{className:"e-input",attrs:{value:c}});b.appendChild(oe),b.appendChild(fe)}var be=a,Ne=this.parent.createElement("input",{className:"e-checkbox"});y.appendChild(Ne);var we=new Vo({label:u.getConstant("IgnoreBlank"),checked:be});return we.appendTo(Ne),f},s.prototype.validateRange=function(e,t){for(var i=!1,r=!1,n=[],a=[],o=[],l=[],h=e[0];h<=e[2];h++)if(t.rows[h]){for(var u=e[1];u<=e[3];u++)if(t.rows[h].cells&&t.rows[h].cells[u]){var c=t.rows[h].cells[u];c.validation&&(n.push(c.validation.type),a.push(c.validation.operator),o.push(c.validation.value1),l.push(c.validation.value2))}}for(var d=e[1];d<=e[3];d++){var p=oi(t,d);p&&p.validation&&(n.push(p.validation.type),a.push(p.validation.operator),o.push(p.validation.value1),l.push(p.validation.value2))}for(var f=[],d=0;d<n.length;d++)f.indexOf(n[d])===-1&&f.push(n[d]);if(f.length>1&&(i=!0),!i){f=[];for(var v=0;v<a.length;v++)f.indexOf(a[v])===-1&&f.push(a[v]);f.length>1&&(i=!0)}if(!i){f=[];for(var v=0;v<o.length;v++)f.indexOf(o[v])===-1&&f.push(o[v]);f.length>1&&(i=!0)}if(!i){f=[];for(var v=0;v<l.length;v++)f.indexOf(l[v])===-1&&f.push(l[v]);f.length>1&&(i=!0)}if(!i){for(var g=0,b=0,y=e[0];y<=e[2];y++)if(t.rows[y]){for(var u=e[1];u<=e[3];u++)if(t.rows[y].cells&&t.rows[y].cells[u]){var c=t.rows[y].cells[u];b++,c.validation&&g++}}if(g===0)for(var d=e[1];d<=e[3];d++){var p=oi(t,d);p&&p.validation&&g++}g>0&&b>1&&g!==b&&(r=!0)}return{moreValidation:i,extendValidation:r}},s.prototype.moreValidationDlg=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At),r=!1,n={width:350,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:t.getConstant("Spreadsheet"),beforeOpen:function(a){var o={dialogName:"MoreValidation",element:a.element,target:a.target,cancel:a.cancel};e.parent.trigger("dialogBeforeOpen",o),o.cancel&&(a.cancel=!0),i.dialogInstance.content=t.getConstant("MoreValidation"),i.dialogInstance.dataBind(),Fe(e.parent.element)},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0}}],close:function(){r?(e.initiateDataValidationHandler(!0),r=!1):i.hide()}};i.show(n)},s.prototype.extendValidationDlg=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At),r=!1,n=!1,a={width:550,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:t.getConstant("Spreadsheet"),beforeOpen:function(o){var l={dialogName:"ExtendValidation",element:o.element,target:o.target,cancel:o.cancel};e.parent.trigger("dialogBeforeOpen",l),l.cancel&&(o.cancel=!0),i.dialogInstance.content=t.getConstant("ExtendValidation"),i.dialogInstance.dataBind(),Fe(e.parent.element)},buttons:[{buttonModel:{content:t.getConstant("Yes"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0}},{buttonModel:{content:t.getConstant("No"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0,n=!0}}],close:function(){r?(e.initiateDataValidationHandler(!0,n),r=!1):i.hide()}};i.show(a)},s.prototype.userInput=function(e,t){for(var i=this.parent.element.querySelector(".e-datavalidation-dlg"),r=i.querySelector(".e-validation-dlg"),n=r.querySelector(".e-allowdata"),a=r.querySelector(".e-values"),o=this.parent.serviceLocator.getService(de),l=n.querySelector(".e-data");a.lastChild;)a.removeChild(a.lastChild);if(e.value===o.getConstant("List")){for(;l.lastChild;)l.removeChild(l.lastChild);var h=this.parent.createElement("input",{className:"e-checkbox"});l.appendChild(h);var u=new Vo({label:o.getConstant("InCellDropDown"),checked:!0});u.appendTo(h)}else if(l.getElementsByClassName("e-checkbox-wrapper")[0]){for(;l.lastChild;)l.removeChild(l.lastChild);var c=this.parent.createElement("span",{className:"e-header"});c.innerText=o.getConstant("Data");var d=this.parent.createElement("input",{className:"e-select"});l.appendChild(c),l.appendChild(d),t.appendTo(d)}if(e.value!==o.getConstant("List")&&(t.value===o.getConstant("Between")||t.value===o.getConstant("NotBetween"))){var p=this.parent.createElement("div",{className:"e-minimum"}),f=this.parent.createElement("div",{className:"e-maximum"});a.appendChild(p),a.appendChild(f);var v=this.parent.createElement("span",{className:"e-header"});v.innerText=o.getConstant("Minimum");var g=this.parent.createElement("span",{className:"e-header"});g.innerText=o.getConstant("Maximum");var b=this.parent.createElement("input",{id:"min",className:"e-input",attrs:{value:"0"}}),y=this.parent.createElement("input",{id:"max",className:"e-input",attrs:{value:"0"}}),C=new to({value:0});C.appendTo("min");var x=new to({value:0});x.appendTo("max"),p.appendChild(v),p.appendChild(b),f.appendChild(g),f.appendChild(y)}else{var w=this.parent.createElement("span",{className:"e-header"});w.innerText=e.value===o.getConstant("List")?o.getConstant("Sources"):o.getConstant("Value");var M=e.value===o.getConstant("List")?this.parent.createElement("input",{className:"e-input",attrs:{placeholder:"Enter value"}}):this.parent.createElement("input",{className:"e-input",attrs:{value:"0"}});a.appendChild(w),a.appendChild(M)}},s.prototype.dlgClickHandler=function(e){var t=this.parent.serviceLocator.getService(de),i,r=this.parent.element.querySelector(".e-datavalidation-dlg"),n=r.querySelector(".e-footer-content"),a=r.getElementsByClassName("e-dlg-content")[0].getElementsByClassName("e-validation-dlg")[0],o=a.getElementsByClassName("e-allowdata")[0],l=o.getElementsByClassName("e-allow")[0].getElementsByTagName("input")[0],h=o.getElementsByClassName("e-data")[0].getElementsByTagName("input")[0],u=a.getElementsByClassName("e-values")[0],c=[];c[0]=u.getElementsByTagName("input")[0].value,c[1]=u.getElementsByTagName("input")[1]?u.getElementsByTagName("input")[1].value:"",yb(c,this.parent.locale);var d=a.querySelector(".e-ignoreblank .e-checkbox").checked,p=o.querySelector(".e-data").querySelector(".e-checkbox-wrapper")?!!o.querySelector(".e-data").querySelector(".e-checkbox-wrapper").querySelector(".e-check"):null,f=a.querySelector(".e-cellrange").getElementsByTagName("input")[0].value,v,g=this.formattedType(l.value);h&&(v=h.value,v=this.formattedValue(v));var b=[],y=[];c[0]!==""&&y.push(c[0]),c[1]!==""&&y.push(c[1]);var C=!0;if(g==="List")if(c[0].indexOf("=")!==-1){if(c[0].indexOf(":")!==-1){var x=c[0].indexOf("!")>-1?c[0].split("!")[1]:c[0].split("=")[1],w=c[0].indexOf("!")>-1?gt(this.parent,c[0].split("=")[1].split("!")[0])>-1:!0;b=x.split(":");var M=x.match(/[a-z]/gi)?b[0].replace(/[0-9]/g,"")===b[1].replace(/[0-9]/g,""):!1,E=x.match(/\d/g)?b[0].replace(/\D/g,"")===b[1].replace(/\D/g,""):!1;C=w?M?!0:!!E:!1,C||(i=t.getConstant("DialogError"))}}else c[0].length>256&&(C=!1,i=t.getConstant("ListLengthError"));if(C){var T=this.parent.getActiveSheet(),D=this.isDialogValidator(y,g,v);if(v==="Between"&&D.isValidate&&!isNaN(parseFloat(y[0]))&&!isNaN(parseFloat(y[1]))&&parseFloat(y[0])>parseFloat(y[1])&&(D.isValidate=!1,D.errorMsg=t.getConstant("MinMaxError")),i=D.errorMsg,C=D.isValidate,C){var N=xe(T.activeCell),A=Y(N[0],N[1],T,!1,!0),L=A.validation&&A.validation.type==="List",k={range:T.name+"!"+f,value1:y[0],value2:y[1]||"",ignoreBlank:d,type:g,operator:v,inCellDropDown:p,cancel:!1};if(this.parent.notify(li,{eventArgs:k,action:"validation"}),!k.cancel){if(this.parent.notify(Yo,{rules:{type:k.type,operator:k.operator,value1:k.value1,value2:k.value2,ignoreBlank:k.ignoreBlank,inCellDropDown:k.inCellDropDown},range:k.range}),A=Y(N[0],N[1],T,!1,!0),A.validation){if(L){var O=this.parent.getCell(N[0],N[1]);O&&O.getElementsByClassName("e-validation-list")[0]&&(this.listObj.destroy(),O.removeChild(O.getElementsByClassName("e-validation-list")[0]))}A.validation.type==="List"&&this.listHandler()}delete k.cancel,document.getElementsByClassName("e-validation-error-dlg")[0]||(e.dialogInstance?e.dialogInstance.hide():e.hide()),this.parent.notify(yt,{eventArgs:k,action:"validation"})}}}if(!C){var R=this.parent.createElement("div",{className:"e-dlg-error",id:"e-invalid"});R.innerText=i,u.appendChild(R),n.querySelector(".e-primary").setAttribute("disabled","true")}},s.prototype.formattedValue=function(e){var t=this.parent.serviceLocator.getService(de);switch(e){case t.getConstant("Between"):e="Between";break;case t.getConstant("NotBetween"):e="NotBetween";break;case t.getConstant("EqualTo"):e="EqualTo";break;case t.getConstant("NotEqualTo"):e="NotEqualTo";break;case t.getConstant("GreaterThan"):e="GreaterThan";break;case t.getConstant("LessThan"):e="LessThan";break;case t.getConstant("GreaterThanOrEqualTo"):e="GreaterThanOrEqualTo";break;case t.getConstant("LessThanOrEqualTo"):e="LessThanOrEqualTo";break;default:e="Between";break}return e},s.prototype.formattedType=function(e){var t=this.parent.serviceLocator.getService(de);switch(e){case t.getConstant("WholeNumber"):e="WholeNumber";break;case t.getConstant("Decimal"):e="Decimal";break;case t.getConstant("Date"):e="Date";break;case t.getConstant("TextLength"):e="TextLength";break;case t.getConstant("List"):e="List";break;case t.getConstant("Time"):e="Time";break}return e},s.prototype.isDialogValidator=function(e,t,i){var r=this.parent.serviceLocator.getService(de),n=0,a=!1,o;if(t==="List"?a=!(e.length>0):i==="Between"||i==="NotBetween"?a=e.length!==2:a=!(e.length>0),a)o={isValidate:!1,errorMsg:r.getConstant("EmptyError")};else{for(var l=void 0,h=0;h<e.length&&(Bt(e[h])?l=this.parent.computeExpression(e[h]).toString():t==="Date"||t==="Time"?(l=this.getDateAsNumber({range:[],cell:{value:e[h]}},e[h]),t==="Date"&&(e[h]=l)):l=e[h],o=this.formatValidation(l,t,!0),o.isValidate);h++)n=n+1;o.isValidate=n===e.length}return{isValidate:o.isValidate,errorMsg:o.errorMsg}},s.prototype.getDateAsNumber=function(e,t){var i={value:t,rowIndex:e.range[0],cell:e.cell,colIndex:e.range[1],sheetIndex:e.sheetIdx,updatedVal:""};return this.parent.notify(yn,i),i.updatedVal||t},s.prototype.isValidationHandler=function(e){var t=this.parent.serviceLocator.getService(de);e.value=e.value?e.value:"";var i,r,n=e.value,a=this.parent.sheets[e.sheetIdx],o,l=Y(e.range[0],e.range[1],a),h=oi(a,e.range[1]);if(l&&l.validation?o=l.validation:az(h,e.range[0],e.range[1])&&(o=h.validation),o){var u=o.value1,c=o.value2;Bt(u)&&o.type!=="List"&&(u=this.parent.computeExpression(u).toString()),Bt(c)&&o.type!=="List"&&(c=this.parent.computeExpression(c).toString()),Bt(e.value)&&o.type!=="List"&&(e.value=this.parent.computeExpression(e.value).toString());var d=e.value,p=o.operator||"Between",f=o.type||"WholeNumber",v=m(o.ignoreBlank)?!0:o.ignoreBlank;if(v&&n==="")i=!0;else{var g=f==="Date"||f==="Time";if(e.value&&!He(e.value))if(g||o.type==="TextLength")d=e.value=this.getDateAsNumber(e,e.value);else{var b=l&&l.format,y=void 0;if(b){if(b!=="@")try{for(var C=ba(b);C;)b=b.split("["+C+"]").join(""),C=ba(b);var x=new _t(this.parent.locale),w=ad(de,jd);if(w!=="$"&&b.includes("$")&&e.value.includes(w)&&(b=b.split("$").join(w)),b.includes("%")&&e.value.indexOf("%")>0){y=x.getNumberParser({format:"n"})(e.value);var M=b.indexOf("%");b[M-1]!=='"'&&(y/=100)}else y=x.getNumberParser({format:b})(e.value)}catch{y=e.value}}else{var E={formattedText:e.value,value:e.value,format:"General",cell:{value:e.value,format:"General"}};this.parent.notify(jn,E),y=E.value}y!==e.value&&He(y)&&(d=e.value=y.toString())}var T=this.formatValidation(e.value,f);if(i=T.isValidate,r=T.errorMsg,i)if(i=!1,g?(u&&!He(u)&&(u=this.getDateAsNumber(e,u)),c&&!He(c)&&(c=this.getDateAsNumber(e,c))):o.type==="TextLength"&&(d=e.value.toString().length.toString()),f==="List"){if(u.indexOf("=")!==-1){this.data=!m(this.data)&&!this.data.length?this.updateDataSource(l,o):this.data;for(var M=0;M<this.data.length;M++)e.value.toString()===this.data[M].text&&(i=!0)}else for(var D=u.split(","),M=0;M<D.length;M++)e.value.toString()===D[M]&&(i=!0);!i&&v&&e.value.toString()===""&&(i=!0)}else switch(f==="Decimal"||f==="Time"?(d=parseFloat(d.toString()),u=parseFloat(u.toString()),c=c?parseFloat(c.toString()):null):(d=parseInt(d.toString(),10),u=parseInt(u.toString(),10),c=c?parseInt(c.toString(),10):null),p){case"EqualTo":d===u||v&&n===""?i=!0:i=!1;break;case"NotEqualTo":d!==u||v&&n===""?i=!0:i=!1;break;case"Between":d>=u&&d<=c||v&&n===""?i=!0:i=!1;break;case"NotBetween":d>=u&&d<=c?i=!1:i=!0;break;case"GreaterThan":d>u||v&&n===""?i=!0:i=!1;break;case"LessThan":d<u||v&&n===""?i=!0:i=!1;break;case"GreaterThanOrEqualTo":d>=u||v&&n===""?i=!0:i=!1;break;case"LessThanOrEqualTo":d<=u||v&&n===""?i=!0:i=!1;break}}}if(r=t.getConstant("ValidationError"),i&&(l&&l.validation&&l.validation.isHighlighted||h&&h.validation&&h.validation.isHighlighted)){var N=this.parent.getCellStyleValue(["backgroundColor","color"],[e.range[0],e.range[1]]);ct(a,e.range[0])||this.parent.notify(dr,{style:N,rowIdx:e.range[0],colIdx:e.range[1],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0,td:e.td})}return{isValidate:i,errorMsg:r}},s.prototype.checkDataValidation=function(e){var t=Y(e.range[0],e.range[1],this.parent.getActiveSheet());e.td=e.td||this.parent.getCell(e.range[0],e.range[1]),e.sheetIdx=e.sheetIdx||this.parent.activeSheetIndex;var i={skip:!1,value:""};if(t&&t.validation){if(Bt(t.validation.value1)&&!ur(t.validation.value1.substring(1,t.validation.value1.length))&&t.validation.value1.indexOf("(")>-1){var r=t.validation.value1;r=r.substring(r.indexOf("=")+1,r.indexOf("(")),i.value=r.toUpperCase(),this.parent.notify(Ay,i)}if(!i.skip&&Bt(t.validation.value2)&&!ur(t.validation.value2.substring(1,t.validation.value2.length))&&t.validation.value1.indexOf("(")>-1){var n=t.validation.value2;n=n.substring(n.indexOf("=")+1,n.indexOf("(")),i.value=n.toUpperCase(),this.parent.notify(Ay,i)}}if(!i.skip){var a=this.isValidationHandler(e);!a.isValidate&&e.isCell&&this.validationErrorHandler(a.errorMsg),e.isValid=a.isValidate}},s.prototype.formatValidation=function(e,t,i){var r=this.parent.element.getElementsByClassName("e-sheet-panel")[0],n,a=this.parent.createElement("form",{id:"formId",className:"form-horizontal"}),o=this.parent.createElement("input",{id:"e-validation"});if(o.setAttribute("name","validation"),o.setAttribute("type","text"),t==="Date"&&He(e)){var l=e.toString().split(".");l.length==2&&(e=l[0])}o.setAttribute("value",e),a.appendChild(o),r.appendChild(a);var h;switch(t){case"Date":h={rules:{validation:{date:!0}},customPlacement:function(d,p){n=p.innerText}};break;case"Decimal":h={rules:{validation:{number:!0}},customPlacement:function(d,p){n=p.innerText}};break;case"WholeNumber":h={rules:{validation:{regex:/^-?\d*\.?[0]*$/}},customPlacement:function(d,p){n=p.innerText}};break;case"TextLength":i&&(h={rules:{validation:{regex:/^\d*\.?[0]*$/}},customPlacement:function(d,p){n=p.innerText}});break}var u=new jq("#formId",h),c=u.validate();return r.removeChild(r.getElementsByClassName("form-horizontal")[0]),{isValidate:c,errorMsg:n}},s.prototype.InvalidElementHandler=function(e){var t=e.rowIdx,i=e.colIdx,r=e.isRemoveHighlightedData;if(!r)this.parent.notify(dr,{style:{backgroundColor:"#ffff00",color:"#ff0000"},rowIdx:t,colIdx:i,td:e.td});else if(r){var n=this.parent.getCellStyleValue(["backgroundColor","color"],[t,i]);this.parent.notify(dr,{style:n,rowIdx:t,colIdx:i,td:e.td})}},s.prototype.validationErrorHandler=function(e){var t=this,i=document.getElementsByClassName("e-spreadsheet-edit")[0],r=this.parent.serviceLocator.getService(de);if(!this.parent.element.querySelector(".e-validation-error-dlg")){var n=this.parent.serviceLocator.getService(At),a=!1,o={width:400,height:200,isModal:!0,showCloseIcon:!0,cssClass:"e-validation-error-dlg",target:document.querySelector(".e-control.e-spreadsheet"),beforeOpen:function(l){var h={dialogName:"ValidationErrorDialog",element:l.element,target:l.target,cancel:l.cancel,content:e};t.parent.trigger("dialogBeforeOpen",h),h.cancel&&(t.errorDlgHandler(n,"Cancel"),l.cancel=!0),i.focus(),n.dialogInstance.content=h.content,n.dialogInstance.dataBind()},buttons:[{buttonModel:{content:r.getConstant("Retry"),isPrimary:!0},click:function(){t.errorDlgHandler(n,"Retry")}},{buttonModel:{content:r.getConstant("Cancel")},click:function(){t.errorDlgHandler(n,"Cancel")}}]};n.show(o,a)}},s.prototype.errorDlgHandler=function(e,t){if(t==="Retry"){var i=document.getElementsByClassName("e-spreadsheet-edit")[0];e.hide(),i.innerText&&(window.getSelection().selectAllChildren(i),this.listObj&&this.listObj.showPopup())}else{var r=xe(this.parent.getActiveSheet().activeCell),n=Y(r[0],r[1],this.parent.getActiveSheet()),a=n?this.parent.getDisplayText(n):"";this.parent.notify(Jt,{action:"cancelEdit",value:a,refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!1,trigEvent:!0}),e.hide()}},s.prototype.getModuleName=function(){return"dataValidation"},s}(),PY=function(){function s(e){this.password="",this.parent=e,this.init()}return s.prototype.init=function(){this.addEventListener()},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Lp,this.protect,this),this.parent.on(Wc,this.protectSheetHandler,this),this.parent.on(Ta,this.editProtectedAlert,this),this.parent.on(d0,this.protectWorkbook,this),this.parent.on(Xn,this.KeyUpHandler,this),this.parent.on(p0,this.unProtectWorkbook,this),this.parent.on(SM,this.unProtectSheetPassword,this),this.parent.on(WA,this.getPassWord,this),this.parent.on(yM,this.importProtectWorkbook,this),this.parent.on(mM,this.protectWorkbookHandler,this),this.parent.on(gM,this.removeWorkbookProtection,this),this.parent.on(y0,this.toggleProtect,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Lp,this.protect),this.parent.off(Wc,this.protectSheetHandler),this.parent.off(Ta,this.editProtectedAlert),this.parent.off(d0,this.protectWorkbook),this.parent.off(Xn,this.KeyUpHandler),this.parent.off(p0,this.unProtectWorkbook),this.parent.off(SM,this.unProtectSheetPassword),this.parent.off(WA,this.getPassWord),this.parent.off(yM,this.importProtectWorkbook),this.parent.off(mM,this.protectWorkbookHandler),this.parent.off(gM,this.removeWorkbookProtection),this.parent.off(y0,this.toggleProtect))},s.prototype.protect=function(e){if(e.isActive){var t=this.parent.getActiveSheet();t.isImportProtected&&(t.isImportProtected=!1)}this.parent.notify(Cd,null),e.isActive?(this.parent.setSheetPropertyOnMute(Pe(this.parent,e.sheetIndex),"isProtected",!1),this.parent.notify(Ah,{props:"Protect"}),this.parent.notify(Wc,e),this.parent.notify(s0,null)):this.createDialogue()},s.prototype.createDialogue=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=[{text:t.getConstant("SelectCells"),id:"1"},{text:t.getConstant("SelectUnlockedCells"),id:"6"},{text:t.getConstant("FormatCells"),id:"2"},{text:t.getConstant("FormatRows"),id:"3"},{text:t.getConstant("FormatColumns"),id:"4"},{text:t.getConstant("InsertLinks"),id:"5"}];this.optionList=new Ib({width:"250px",dataSource:i,showCheckBox:!0,select:this.dialogOpen.bind(this)});var r=this.parent.createElement("div",{className:"e-sheet-password-dialog"}),n=this.parent.createElement("div",{className:"e-sheet-password-content"}),a=this.parent.createElement("div",{className:"e-header"});a.innerText=t.getConstant("SheetPassword");var o=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});o.setAttribute("placeholder",t.getConstant("EnterThePassword")),n.appendChild(o),n.insertBefore(a,o),r.appendChild(n);var l=this.parent.createElement("div",{className:"e-protect-content"});l.innerText=t.getConstant("ProtectAllowUser"),this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(),"isProtected",!1);var h=new Vo({checked:!0,label:t.getConstant("ProtectContent"),cssClass:"e-protect-checkbox"}),u=this.parent.createElement("div",{className:"e-protect-option-list",id:this.parent.element.id+"_option_list"}),c=this.parent.createElement("div",{className:"e-header-content"});c.innerText=t.getConstant("ProtectSheet");var d=this.parent.createElement("input",{id:this.parent.element.id+"_protect_check",attrs:{type:"checkbox"}});this.dialog=this.parent.serviceLocator.getService("dialog"),this.dialog.show({header:c.outerHTML,content:r.outerHTML+d.outerHTML+l.outerHTML+u.outerHTML,showCloseIcon:!0,isModal:!0,cssClass:"e-protect-dlg",beforeOpen:function(p){var f={dialogName:"ProtectSheetDialog",element:p.element,target:p.target,cancel:p.cancel};e.parent.trigger("dialogBeforeOpen",f),f.cancel&&(p.cancel=!0),Fe(e.parent.element)},beforeClose:function(){I.remove(h.element,"click",e.checkBoxClickHandler)},buttons:[{click:this.selectOption.bind(this,this.dialog,this),buttonModel:{content:t.getConstant("Ok"),isPrimary:!0}},{click:function(){return e.dialog.hide()},buttonModel:{content:t.getConstant("Cancel")}}]},!1),this.protectSheetDialog=this.dialog.dialogInstance,h.appendTo("#"+this.parent.element.id+"_protect_check"),this.optionList.appendTo("#"+this.parent.element.id+"_option_list"),this.optionList.selectMultipleItems([{id:"1"},{id:"6"}]),I.add(h.element,"click",this.checkBoxClickHandler,this)},s.prototype.checkBoxClickHandler=function(){var e=document.getElementById(this.parent.element.id+"_protect_check");e.checked===!1?this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").disabled=!0:this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").disabled=!1},s.prototype.dialogOpen=function(e){var t=this.parent.serviceLocator.getService(de);e.text===t.getConstant("SelectCells")&&e.isChecked&&e.isInteracted&&this.optionList.checkItem({id:"6"}),e.text===t.getConstant("SelectUnlockedCells")&&!e.isChecked&&e.isInteracted&&this.optionList.uncheckItem({id:"1"})},s.prototype.selectOption=function(){var e=this.parent.getActiveSheet(),t=this.parent.element.querySelector(".e-sheet-password-dialog").getElementsByClassName("e-sheet-password-content")[0].querySelector(".e-input");t.value.length===0?(this.parent.setSheetPropertyOnMute(e,"isProtected",!0),this.parent.setSheetPropertyOnMute(e,"password",t.value),this.updateProtectSheet(t.value),this.dialog.hide(),!e.protectSettings.selectCells&&!e.protectSettings.selectUnLockedCells?this.parent.notify(ql,null):e.protectSettings.selectUnLockedCells&&ah(this.parent,ee(e.selectedRange))&&this.parent.notify(ql,null)):this.reEnterSheetPassword()},s.prototype.selectSheetPassword=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.getActiveSheet(),i=this.parent.element.querySelector(".e-sheet-password-dialog").getElementsByClassName("e-sheet-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-reenterpwd-alert-span"});if(i.value===r.value){this.parent.setSheetPropertyOnMute(t,"isProtected",!0),this.parent.setSheetPropertyOnMute(t,"password",i.value),this.updateProtectSheet(i.value),this.dialog.hide(),this.protectSheetDialog&&(this.protectSheetDialog=null);var a=document.querySelector(".e-protect-dlg.e-dialog"),o=Ct(a,"dialog");o.destroy(),!t.protectSettings.selectCells&&!t.protectSettings.selectUnLockedCells&&this.parent.notify(ql,null)}else i.value===""?n.textContent=e.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=e.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=e.getConstant("PasswordAlert")),this.parent.element.querySelector(".e-reenterpwd-dlg").querySelector(".e-reenterpwd-dialog").appendChild(n)},s.prototype.updateProtectSheet=function(e){var t=this.parent.serviceLocator.getService(de),i=this.optionList.getSelectedItems(),r={selectCells:i.text.indexOf(t.getConstant("SelectCells"))>-1,formatCells:i.text.indexOf(t.getConstant("FormatCells"))>-1,formatRows:i.text.indexOf(t.getConstant("FormatRows"))>-1,formatColumns:i.text.indexOf(t.getConstant("FormatColumns"))>-1,insertLink:i.text.indexOf(t.getConstant("InsertLinks"))>-1,selectUnLockedCells:i.text.indexOf(t.getConstant("SelectUnlockedCells"))>-1};this.parent.notify(Hc,{protectSettings:r,password:e,triggerEvent:!0}),this.parent.notify(s0,null),this.parent.notify(mu,null)},s.prototype.protectSheetHandler=function(e){var t=m(e&&e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=Pe(this.parent,t),r=this.parent.element.id,n=[r+"_undo",r+"_redo",r+"_cut",r+"_copy",r+"_paste",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_merge_cells",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],a=[r+"_cut",r+"_copy",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],o=[r+"_insert_function"],l=[r+"_hyperlink",r+"_",r+"_chart"],h=[r+"_image"],u=[r+"_find"],c=[r+"_datavalidation"],d=[r+"_chart"],p=document.getElementById(this.parent.element.id+"_sheet_panel");p&&(i.isProtected&&(i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!ah(this.parent,ee(i.selectedRange)))?p.classList.remove("e-protected"):p.classList.add("e-protected"),i.isProtected||p.classList.remove("e-protected")),this.parent.dataBind(),this.parent.notify(J1,{disableHomeBtnId:n,enableHomeBtnId:a,enableFrmlaBtnId:o,enableInsertBtnId:l,findBtnId:u,dataValidationBtnId:c,imageBtnId:h,chartBtnId:d}),this.parent.notify(rM,null),i.isProtected&&this.parent.notify(Ah,{props:"Protect"}),e&&e.triggerEvent&&this.parent.notify(yt,{action:"protectSheet",eventArgs:{sheetIndex:t,isProtected:i.isProtected,password:i.password,protectSettings:i.protectSettings.properties||i.protectSettings}})},s.prototype.editProtectedAlert=function(){var e=this,t=this.parent.serviceLocator.getService(de);this.dialog=this.parent.serviceLocator.getService("dialog"),this.dialog.show({content:t.getConstant("EditAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-editAlert-dlg",beforeOpen:function(i){var r={dialogName:"EditAlertDialog",content:t.getConstant("EditAlert"),element:i.element,target:i.target,cancel:i.cancel};e.parent.trigger("dialogBeforeOpen",r),r.cancel&&(i.cancel=!0,Vi(function(){return e.dialog.destroyDialog()})),e.dialog.dialogInstance.content=r.content,Fe(e.parent.element)},close:function(){return Fe(e.parent.element)}})},s.prototype.protectWorkbook=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-protectworkbook-dlg",header:t.getConstant("ProtectWorkbook"),beforeOpen:function(r){var n={dialogName:"ProtectWorkbook",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=e.passwordProtectContent(),i.dialogInstance.dataBind(),e.parent.element.focus()},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){e.alertMessage(),e.dlgClickHandler(i)}}]})},s.prototype.passwordProtectContent=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("div",{className:"e-password-dialog"}),i=this.parent.createElement("div",{className:"e-password-content"}),r=this.parent.createElement("div",{className:"e-password-content"}),n=this.parent.createElement("div",{className:"e-header"});n.innerText=e.getConstant("Password");var a=this.parent.createElement("div",{className:"e-header"});a.innerText=e.getConstant("ConfirmPassword");var o=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}}),l=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return o.setAttribute("placeholder",e.getConstant("EnterThePassword")),l.setAttribute("placeholder",e.getConstant("EnterTheConfirmPassword")),i.appendChild(o),i.insertBefore(n,o),r.appendChild(l),r.insertBefore(a,l),t.appendChild(r),t.insertBefore(i,r),t},s.prototype.KeyUpHandler=function(e){var t=e.target;if(t.classList.contains("e-text")&&U(t,".e-password-content")&&U(t,".e-password-dialog")&&U(t,".e-password-dialog").getElementsByClassName("e-password-content")[1]===t.parentElement){var i=U(t,".e-protectworkbook-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;t.value!==""?n.removeAttribute("disabled"):n.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&U(t,".e-unprotectpwd-content")&&U(t,".e-unprotectpwd-dialog")&&U(t,".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0]===t.parentElement){var a=U(t,".e-unprotectworkbook-dlg"),o=a.getElementsByClassName("e-footer-content")[0],l=o.firstChild;t.value!==""?l.removeAttribute("disabled"):l.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&U(t,".e-reenterpwd-content")&&U(t,".e-reenterpwd-dialog")&&U(t,".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0]===t.parentElement){var h=U(t,".e-reenterpwd-dlg"),u=h.getElementsByClassName("e-footer-content")[0],c=u.firstChild;t.value!==""?c.removeAttribute("disabled"):c.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&U(t,".e-unprotectsheetpwd-content")&&U(t,".e-unprotectsheetpwd-dialog")&&U(t,".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0]===t.parentElement){var d=U(t,".e-unprotectworksheet-dlg"),p=d.getElementsByClassName("e-footer-content")[0],f=p.firstChild;t.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&U(t,".e-importprotectpwd-content")&&U(t,".e-importprotectpwd-dialog")&&U(t,".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0]===t.parentElement){var v=U(t,".e-importprotectworkbook-dlg"),g=v.getElementsByClassName("e-footer-content")[0],f=g.firstChild;t.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}},s.prototype.alertMessage=function(){var e=this.parent.element.querySelector(".e-pwd-alert-span"),t=this.parent.element.querySelector(".e-unprotectpwd-alert-span"),i=this.parent.element.querySelector(".e-importprotectpwd-alert-span"),r=this.parent.element.querySelector(".e-reenterpwd-alert-span"),n=this.parent.element.querySelector(".e-unprotectsheetpwd-alert-span");e&&e.remove(),t&&t.remove(),i&&i.remove(),r&&r.remove(),n&&n.remove()},s.prototype.dlgClickHandler=function(e){var t=this.parent.serviceLocator.getService(de),i=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[1].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-pwd-alert-span"});i.value===r.value?(e.hide(),this.parent.notify(Ah,{props:"Protectworkbook"}),this.protectWorkbookHandler({password:i.value}),this.parent.notify(yt,{action:"protectWorkbook",eventArgs:{isProtected:!0,password:i.value}})):i.value===""?n.textContent=t.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=t.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=t.getConstant("PasswordAlert")),e.dialogInstance&&this.parent.element.querySelector(".e-protectworkbook-dlg").querySelector(".e-dlg-content").appendChild(n)},s.prototype.protectWorkbookHandler=function(e){this.parent.password=e.password,this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.notify(Ah,{props:"Protectworkbook"})},s.prototype.unProtectWorkbook=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworkbook-dlg",header:t.getConstant("UnprotectWorkbook"),beforeOpen:function(r){var n={dialogName:"UnprotectWorkbook",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=e.unProtectPasswordContent(),i.dialogInstance.dataBind(),e.parent.element.focus()},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage(),e.unprotectdlgOkClick(i)}}]})},s.prototype.unProtectsheet=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.serviceLocator.getService(At);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworksheet-dlg",header:i.getConstant("UnprotectWorksheet"),beforeOpen:function(n){var a={dialogName:"UnProtectSheet",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel&&(n.cancel=!0),r.dialogInstance.content=t.unProtectSheetPasswordContent(),r.dialogInstance.dataBind(),t.parent.element.focus()},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!(this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1)},click:function(){t.alertMessage(),t.unprotectSheetdlgOkClick(r,e)}}]})},s.prototype.reEnterSheetPassword=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-reenterpwd-dlg",header:t.getConstant("ConfirmPassword"),beforeOpen:function(r){var n={dialogName:"Re-enterPassword",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=e.reEnterSheetPasswordContent(),i.dialogInstance.dataBind();var a=e.parent.element.querySelector(".e-protect-dlg.e-dialog .e-footer-content .e-btn")||e.parent.element;Fe(a)},close:function(){e.dialog.dialogInstance=e.protectSheetDialog},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage(),e.selectSheetPassword()}}]})},s.prototype.unProtectPasswordContent=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("div",{className:"e-unprotectpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=e.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),t.appendChild(i),t},s.prototype.reEnterSheetPasswordContent=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("div",{className:"e-reenterpwd-dialog"}),i=this.parent.createElement("div",{className:"e-reenterpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=e.getConstant("ReEnterPassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),t.appendChild(i),t},s.prototype.unProtectSheetPasswordContent=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("div",{className:"e-unprotectsheetpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectsheetpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=e.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),t.appendChild(i),t},s.prototype.unprotectdlgOkClick=function(e){var t=this.parent.serviceLocator.getService(de),i=this.parent.element.querySelector(".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0].querySelector(".e-input");if(this.parent.password===i.value)e.hide(),this.removeWorkbookProtection(),this.parent.notify(yt,{action:"protectWorkbook",eventArgs:{isProtected:!1}});else{var r=this.parent.createElement("span",{className:"e-unprotectpwd-alert-span"});r.innerText=t.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(r)}},s.prototype.removeWorkbookProtection=function(){this.parent.password="",this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled"));var e=document.getElementById(this.parent.element.id+"_protectworkbook");e&&e.classList.remove("e-active"),this.parent.notify(Ah,{props:"Protectworkbook"})},s.prototype.unprotectSheetdlgOkClick=function(e,t){var i=this.parent.serviceLocator.getService(de),r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0].querySelector(".e-input");if(t&&r.password.length===0){var a={sheetPassword:n.value,sheetIndex:this.parent.activeSheetIndex};this.parent.open(a)}else if(r.password===n.value)e.hide(),this.unProtectSheetPassword();else{var o=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});o.innerText=i.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(o)}},s.prototype.unProtectSheetPassword=function(){var e=this.parent.getActiveSheet(),t=this.parent.activeSheetIndex;this.parent.setSheetPropertyOnMute(e,"isProtected",!e.isProtected),this.parent.setSheetPropertyOnMute(e,"password","");var i=!e.isProtected;this.parent.notify(Lp,{isActive:i,id:this.parent.element.id+"_protect",sheetIndex:t,triggerEvent:!0}),this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(t)===-1&&this.parent.openModule.unProtectSheetIdx.push(t)},s.prototype.getPassWord=function(e){e.passWord=this.password},s.prototype.importProtectWorkbook=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.serviceLocator.getService(At);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-importprotectworkbook-dlg",header:i.getConstant("UnprotectWorkbook"),beforeOpen:function(n){var a={dialogName:"ImportProtectWorkbook",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel&&(n.cancel=!0),r.dialogInstance.content=t.importProtectPasswordContent(e),r.dialogInstance.dataBind(),t.parent.element.focus()},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage(),t.importOkClick(e)}}]})},s.prototype.importProtectPasswordContent=function(e){var t=this.parent.serviceLocator.getService(de),i=this.parent.createElement("div",{className:"e-importprotectpwd-dialog"}),r=this.parent.createElement("div",{className:"e-importprotectpwd-content"}),n=this.parent.createElement("span",{className:"e-header"});n.innerText='"'+e.file.name+'" '+t.getConstant("IsProtected");var a=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return a.setAttribute("placeholder",t.getConstant("EnterThePassword")),r.appendChild(n),r.appendChild(a),i.appendChild(r),i},s.prototype.importOkClick=function(e){var t=this.parent.element.querySelector(".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0].querySelector(".e-input");this.parent.password=t.value;var i={file:e.file,password:t.value};this.parent.open(i)},s.prototype.toggleProtect=function(e){var t,i=this.parent.element.id,r=this.parent.getActiveSheet();r.isProtected&&this.parent.allowOpen&&r.isImportProtected&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1?this.unProtectsheet(!0):r.password&&r.password.length>0?this.unProtectsheet():(this.parent.setSheetPropertyOnMute(r,"isProtected",!r.isProtected),t=!r.isProtected,this.parent.notify(Lp,{isActive:t,id:i+"_protect",sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0}))},s.prototype.getModuleName=function(){return"protectSheet"},s}(),zY=function(){function s(e){this.shortValue="",this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(tM,this.renderFindDlg,this),this.parent.on(eM,this.renderGotoDlg,this),this.parent.on(_h,this.gotoHandler,this),this.parent.on(Xd,this.findHandler,this),this.parent.on(ky,this.showFindAlert,this),this.parent.on(Oy,this.replaceAllDialog,this),this.parent.on(l1,this.findKeyUp,this),this.parent.on(su,this.findToolDlg,this),this.parent.on(fu,this.refreshFindDlg,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tM,this.renderFindDlg),this.parent.off(eM,this.renderGotoDlg),this.parent.off(_h,this.gotoHandler),this.parent.off(Xd,this.findHandler),this.parent.off(ky,this.showFindAlert),this.parent.off(Oy,this.replaceAllDialog),this.parent.off(l1,this.findKeyUp),this.parent.off(su,this.findToolDlg),this.parent.off(fu,this.refreshFindDlg))},s.prototype.findToolDlg=function(e){var t=this,i=function(x){var w=t.parent.showRibbon&&t.parent.element.querySelector(".e-ribbon");if(w){var M=e.event&&e.event.target?U(e.event.target,"#"+t.parent.element.id+"_findbtn"):$("#"+t.parent.element.id+"_findbtn",w);M&&(x?M.classList.add("e-disabled"):M.classList.remove("e-disabled"),M.disabled=x)}},r=e.dialogEle||this.parent.element.getElementsByClassName("e-findtool-dlg")[0];e.isPublic&&(this.findValue=e.findValue);var n=this.parent.getActiveSheet(),a,o,l,h=function(x){if(!(!o||n.isProtected&&!n.protectSettings.selectCells&&!n.protectSettings.selectUnLockedCells)){var w=o.value;if(x&&x.keyCode===13)o.value&&l.textContent!=="0 of 0"&&(t.parent.notify(Xd,{findOption:x.shiftKey?"prev":"next"}),t.updateCount(l,x.shiftKey));else{var M=void 0;if(w==="")l.textContent="0 of 0",M=!1;else{var E={value:w,mode:"Sheet",isCSen:!1,sheetIndex:t.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};t.parent.notify(Ly,E),l.textContent=E.findCount,M=E.findCount!=="0 of 0"}a.enableItems(1,M),a.enableItems(2,M)}}};if(r)if(e.isPublic||e.refreshPosition){if(e.isPublic&&(o=r.querySelector(".e-text-findNext-short"),o.value=this.findValue,l=r.querySelector(".e-input-group-icon"),a=Ct(r.querySelector(".e-find-toolbar"),"toolbar"),h()),e.refreshPosition){var u=void 0;if(this.parent.getActiveSheet().showHeaders){var c=this.parent.getColumnHeaderContent().parentElement;u=(c&&c.offsetHeight||30)+1}else u=1;r.style.top=u+"px"}}else i(!0),this.findDialog.hide();else{var d=this.parent.createElement("div",{className:"e-input-group"});o=this.parent.createElement("input",{className:"e-input e-text-findNext-short",attrs:{type:"Text"}}),this.findValue&&(o.value=this.findValue);var p=this.parent.serviceLocator.getService(de);o.setAttribute("placeholder",p.getConstant("FindValue")),l=this.parent.createElement("span",{className:"e-input-group-icon"});var f,v=n.usedRange.rowIndex*n.usedRange.colIndex>100;o.onkeyup=function(x){v?(f&&clearTimeout(f),f=setTimeout(h.bind(t,x),500)):h(x)},d.appendChild(o),d.appendChild(l);var g=[{type:"Input",template:d},{prefixIcon:"e-icons e-prev-icon",tooltipText:p.getConstant("FindPreviousBtn"),type:"Button",cssClass:"e-findRib-prev",disabled:!0},{prefixIcon:"e-icons e-next-icon",tooltipText:p.getConstant("FindNextBtn"),type:"Button",cssClass:"e-findRib-next",disabled:!0},{type:"Separator"},{prefixIcon:"e-icons e-option-icon",tooltipText:p.getConstant("MoreOptions"),type:"Button",cssClass:"e-findRib-more"},{prefixIcon:"e-icons e-close",tooltipText:p.getConstant("Close"),type:"Button",cssClass:"e-findRib-close"}];a=new ov({clicked:function(x){x.item.cssClass==="e-findRib-next"?(t.parent.notify(Xd,{findOption:"next"}),t.updateCount(l)):x.item.cssClass==="e-findRib-prev"?(t.parent.notify(Xd,{findOption:"prev"}),t.updateCount(l,!0)):x.item.cssClass==="e-findRib-more"&&(t.findDialog.animationSettings.effect="None",t.findDialog.setProperties({animationSettings:t.findDialog.animationSettings},!0),t.renderFindDlg(),t.findDialog.hide())},width:"auto",height:"auto",items:g,cssClass:"e-find-toolObj",created:function(){var x=a.element.querySelectorAll(".e-toolbar-item .e-tbar-btn");x.forEach(function(w){return w.removeAttribute("tabindex")})}});var b=this.parent.createElement("div",{className:"e-find-toolbar",attrs:{tabindex:"-1"}});a.createElement=this.parent.createElement,a.appendTo(b),r=this.parent.createElement("div",{className:"e-dlg-div",attrs:{"aria-label":p.getConstant("FindValue")}});var y=this.parent.element.getElementsByClassName("e-sheet-panel")[0];this.findDialog=new Tv({cssClass:"e-findtool-dlg",content:b,visible:!1,enableRtl:this.parent.enableRtl,target:y,open:function(){if(I.add(document,"click",t.closeDialog,t),t.findValue&&(!n.isProtected||n.protectSettings.selectCells||n.protectSettings.selectUnLockedCells)){var x={value:t.findValue,mode:"Sheet",isCSen:!1,sheetIndex:t.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};t.parent.notify(Ly,x),l.textContent=x.findCount;var w=x.findCount!=="0 of 0";a.enableItems(1,w),a.enableItems(2,w)}else l.textContent="0 of 0";i(!1);var M=a.element.querySelector(".e-input-group");M&&M.addEventListener("focus",function(){var E=document.querySelector(".e-text-findNext-short");Fe(E),E.classList.add("e-input-focus"),E.setSelectionRange(0,E.value.length)}),C&&t.findDialog.setProperties({animationSettings:C},!0)},beforeOpen:function(){return Fe(t.parent.element)},beforeClose:function(){t.findValue=o.value||null,a.destroy(),I.remove(document,"click",t.closeDialog)},close:function(){t.findDialog.destroy(),t.findDialog=null,ne(r),y.style.position="",Fe(t.parent.element),i(!1)},created:function(){y.style.position="relative",r.style.width=t.parent.getMainContent().offsetWidth+"px",r.style.visibility="hidden",r.style.display="block",t.findDialog.width=parseInt(getComputedStyle(r).borderLeftWidth,10)*2+r.querySelector(".e-toolbar-items").getBoundingClientRect().width+"px",r.style.display="",r.style.width="",r.style.visibility="",r.style.top=(e&&e.headerHgt||t.parent.getColumnHeaderContent().parentElement.offsetHeight+1)+"px",r.style.left="",r.style[t.parent.enableRtl?"left":"right"]=t.parent.sheetModule.getScrollSize()+"px",t.findDialog.show()}}),this.findDialog.createElement=this.parent.createElement;var C;e&&e.isPublic&&(C={effect:this.findDialog.animationSettings.effect},this.findDialog.setProperties({animationSettings:{effect:"None"}},!0)),this.findDialog.appendTo(r)}},s.prototype.refreshFindDlg=function(e){var t=this.findDialog&&this.parent.element.getElementsByClassName("e-findtool-dlg")[0];if(t){var i=t.querySelector(".e-text-findNext-short");this.findToolDlg({findValue:i.value,isPublic:!0,refreshPosition:!0,dialogEle:t})}},s.prototype.updateCount=function(e,t){var i=e.textContent.split(" "),r;t?(r=Number(i[0])-1,r<1&&(r=Number(i[2]))):(r=Number(i[0])+1,r>Number(i[2])&&(r=1)),i[0]=r.toString(),e.textContent=i.join(" ")},s.prototype.closeDialog=function(e){(U(e.target,".e-findRib-close")||!U(e.target,".e-spreadsheet"))&&this.findDialog&&this.findToolDlg({})},s.prototype.renderFindDlg=function(){var e=this,t=this.parent.serviceLocator.getService(At);if(this.parent.element.querySelector(".e-find-dlg"))t.hide();else{var i=this.parent.serviceLocator.getService(de),r={isModal:!1,showCloseIcon:!0,cssClass:"e-find-dlg",header:i.getConstant("FindAndReplace"),beforeOpen:function(n){var a={dialogName:"FindAndReplaceDialog",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?n.cancel=!0:(t.dialogInstance.content=e.findandreplaceContent(),t.dialogInstance.dataBind()),Fe(e.parent.element)},buttons:[{buttonModel:{content:i.getConstant("FindPreviousBtn"),isPrimary:!0,cssClass:"e-btn-findPrevious",disabled:!0},click:function(n){e.dialogMessage(),e.findHandler({findOption:n&&n.keyCode===13?"next":"prev"})}},{buttonModel:{content:i.getConstant("FindNextBtn"),isPrimary:!0,cssClass:"e-btn-findNext",disabled:!0},click:function(){e.dialogMessage(),e.findHandler({findOption:"next"})}},{buttonModel:{content:i.getConstant("ReplaceBtn"),isPrimary:!0,cssClass:"e-btn-replace",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(Bf)}},{buttonModel:{content:i.getConstant("ReplaceAllBtn"),isPrimary:!0,cssClass:"e-btn-replaceAll",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(fd)}}],open:function(){var n=e.parent.element.querySelector(".e-text-findNext");if(n.value){var a=e.parent.element.querySelector(".e-btn-findPrevious"),o=Ct(a,"btn");o.disabled=!1,Ct(e.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}Vi(function(){Fe(n)})},close:function(){return t.hide()}};t.show(r)}},s.prototype.dialogMessage=function(){this.parent.element.querySelector(".e-replace-alert-span")?this.parent.element.querySelector(".e-replace-alert-span").remove():this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove()},s.prototype.renderGotoDlg=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.serviceLocator.getService(At),r=!1;if(m(this.parent.element.querySelector(".e-find-dlg"))){var n={width:300,isModal:!1,showCloseIcon:!0,cssClass:"e-goto-dlg",header:t.getConstant("GotoHeader"),beforeOpen:function(a){var o={dialogName:"GoToDialog",element:a.element,target:a.target,cancel:a.cancel};e.parent.trigger("dialogBeforeOpen",o),o.cancel?a.cancel=!0:(i.dialogInstance.content=e.GotoContent(),i.dialogInstance.dataBind()),Fe(e.parent.element)},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){e.gotoHandler()&&i.hide()}}],open:function(){e.textFocus()}};i.show(n,r)}else i.hide()},s.prototype.textFocus=function(){var e=this,t=this.parent.element.querySelector(".e-text-goto");t.addEventListener("focus",function(){e.parent.element.querySelector(".e-goto-alert-span")&&e.parent.element.querySelector(".e-goto-alert-span").remove()})},s.prototype.findHandler=function(e){var t=this.parent.element.querySelector(".e-text-findNext");t||(t=this.parent.element.querySelector(".e-text-findNext-short"),t||this.gotoAlert());var i=t.value;if(t.value!==""){var r=this.parent.getActiveSheet();if(r.isProtected&&!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells)return;var n=this.parent.activeSheetIndex,a=this.parent.element.querySelector(".e-findnreplace-checkcase"),o=void 0;if(!a)o=!1;else{var l=Ct(a,"checkbox");o=l.checked}var h=this.parent.element.querySelector(".e-findnreplace-checkmatch"),u=void 0;if(!h)u=!1;else{var c=Ct(h,"checkbox");u=c.checked}var d=this.parent.element.querySelector(".e-findnreplace-searchby"),p=void 0;if(!d)p="By Row";else{var f=Ct(d,"dropdownlist");p=f.value.toString()}var v=this.parent.element.querySelector(".e-findnreplace-searchwithin"),g=void 0;if(!v)g="Sheet";else{var b=Ct(v,"dropdownlist");g=b.value.toString()}var y={value:i,sheetIndex:n,findOpt:e.findOption,mode:g,isCSen:o,isEMatch:u,searchBy:p,isAction:!0};this.parent.find(y)}},s.prototype.replaceHandler=function(e){var t=this.parent.element.querySelector(".e-find-dlg"),i=t.querySelector(".e-text-findNext").value,r=this.parent.element.querySelector(".e-text-replaceInp").value,n=this.parent.element.querySelector(".e-findnreplace-checkcase").checked,a=this.parent.element.querySelector(".e-findnreplace-checkmatch").checked,o=this.parent.element.querySelector(".e-search-within .e-ddl-hidden").value,l=this.parent.element.querySelector(".e-searchby .e-ddl-hidden").value;this.parent.notify(e,{value:i,mode:o,isCSen:n,isEMatch:a,searchBy:l,findOpt:"next",replaceValue:r,replaceBy:e,sheetIndex:this.parent.activeSheetIndex,isAction:!0})},s.prototype.gotoHandler=function(e){var t=!0;if(e)this.parent.goTo(e.address);else{for(var i=this.parent.element.querySelector(".e-text-goto").value,r=0;r<this.parent.definedNames.length;r++)if(this.parent.definedNames[r].name===i){i=this.parent.definedNames[r].refersTo.slice(1);break}var n=i;i.includes("!")&&(n=i.split("!")[1]),n=n.split("$").join(""),n.includes(":")&&(n=n.split(":")[0]);var a=n.match(/\d+/),o=n.match(/[A-Z]+/i);if(!a||!o||o.index!==0)this.gotoAlert(),t=!1;else{var l=lt(ee(n));l[2]>=1048576||l[3]>=16384?(this.gotoAlert(),t=!1):this.parent.goTo(i)}}return t},s.prototype.gotoAlert=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("span",{className:"e-goto-alert-span"});t.innerText=e.getConstant("InsertingEmptyValue"),this.parent.element.querySelector(".e-goto-alert-span")&&this.parent.element.querySelector(".e-goto-alert-span").remove(),this.parent.element.querySelector(".e-goto-dlg").querySelector(".e-dlg-content").appendChild(t)},s.prototype.showFindAlert=function(){this.parent.element.querySelector(".e-replace-alert-span")&&this.parent.element.querySelector(".e-replace-alert-span").remove();var e=this.parent.element.querySelector(".e-find-dlg .e-dlg-content");if(e){var t=this.parent.createElement("span",{className:"e-find-alert-span"});t.innerText=this.parent.serviceLocator.getService(de).getConstant("NoElements"),e.appendChild(t)}},s.prototype.replaceAllDialog=function(e){this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove();var t=this.parent.serviceLocator.getService(de),i=this.parent.createElement("span",{className:"e-replace-alert-span"});i.innerText=e.count+t.getConstant("ReplaceAllEnd")+e.replaceValue,this.parent.element.querySelector(".e-find-dlg")&&this.parent.element.querySelector(".e-find-dlg").querySelector(".e-dlg-content").appendChild(i)},s.prototype.findKeyUp=function(e){if(e.target.classList.contains("e-text-findNext")){var t=this.parent.element.querySelector(".e-text-findNext").value;if(!m(t)&&t!==""){var i=this.parent.element.querySelector(".e-btn-findPrevious"),r=Ct(i,"btn");r.disabled=!1,Ct(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}else Ct(this.parent.element.querySelector(".e-btn-findPrevious"),"btn").disabled=!0,Ct(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!0,this.dialogMessage()}var n=this.parent.element.querySelector(".e-text-findNext").value,a=this.parent.element.querySelector(".e-text-replaceInp").value;!m(n)&&!m(a)&&n!==""&&a!==""?this.parent.getActiveSheet().isProtected||(Ct(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!1,Ct(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!1):(Ct(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!0,Ct(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!0)},s.prototype.findandreplaceContent=function(){this.parent.element.querySelector(".e-text-findNext-short")&&(this.shortValue=this.parent.element.querySelector(".e-text-findNext-short").value);var e=this.parent.createElement("div",{className:"e-link-dialog"}),t=this.parent.createElement("div",{className:"e-find"}),i=this.parent.createElement("div",{className:"e-findCheck"}),r=this.parent.serviceLocator.getService(de);e.appendChild(t);var n=this.parent.createElement("div",{className:"e-cont"}),a=this.parent.createElement("p",{className:"e-header"});a.innerText=r.getConstant("FindWhat");var o=this.parent.createElement("input",{className:"e-input e-text-findNext",attrs:{type:"Text",placeholder:r.getConstant("FindValue"),value:this.shortValue}});n.appendChild(o),n.insertBefore(a,o),t.appendChild(n);var l=new ox({width:"70%"});l.createElement=this.parent.createElement,l.appendTo(o);var h=this.parent.createElement("div",{className:"e-cont"}),u=this.parent.createElement("p",{className:"e-header"});u.innerText=r.getConstant("ReplaceWith");var c=this.parent.createElement("input",{className:"e-input e-text-replaceInp",attrs:{type:"Text",placeholder:r.getConstant("ReplaceValue")}});h.appendChild(c),h.insertBefore(u,c),t.appendChild(h);var d=new ox({width:"70%"});d.createElement=this.parent.createElement,d.appendTo(c);var p=[{Id:"Sheet",Within:r.getConstant("Sheet")},{Id:"Workbook",Within:r.getConstant("Workbook")}],f=new Na({dataSource:p,cssClass:"e-search-within",fields:{value:"Id",text:"Within"},width:"50%",index:0}),v=r.getConstant("SearchWithin"),g=this.parent.createElement("input",{className:"e-findnreplace-searchwithin",attrs:{type:"select",label:v}}),b=this.parent.createElement("p",{className:"e-header"});b.innerText=v,t.appendChild(b),t.appendChild(g),f.createElement=this.parent.createElement,f.appendTo(g);var y=[{Id:"By Row",Search:r.getConstant("ByRow")},{Id:"By Column",Search:r.getConstant("ByColumn")}],C=new Na({dataSource:y,cssClass:"e-searchby",fields:{value:"Id",text:"Search"},width:"50%",index:0});v=r.getConstant("SearchBy");var x=this.parent.createElement("input",{className:"e-findnreplace-searchby",attrs:{type:"select",label:v}}),w=this.parent.createElement("p",{className:"e-header"});w.innerText=v,t.appendChild(w),t.appendChild(x),C.createElement=this.parent.createElement,C.appendTo(x);var M=new Vo({label:r.getConstant("MatchCase"),checked:!1,cssClass:"e-findnreplace-casecheckbox"}),E=this.parent.createElement("input",{className:"e-findnreplace-checkcase",attrs:{type:"checkbox"}});i.appendChild(E),M.createElement=this.parent.createElement,M.appendTo(E);var T=new Vo({label:r.getConstant("MatchExactCellElements"),checked:!1,cssClass:"e-findnreplace-exactmatchcheckbox"}),D=this.parent.createElement("input",{className:"e-findnreplace-checkmatch",attrs:{type:"checkbox"}});return i.appendChild(D),T.createElement=this.parent.createElement,T.appendTo(D),t.appendChild(i),e},s.prototype.GotoContent=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.createElement("div",{className:"e-link-dialog"}),i=this.parent.createElement("div",{className:"e-goto"});t.appendChild(i);var r=this.parent.createElement("div",{className:"e-cont"}),n=this.parent.createElement("p",{className:"e-header"});n.innerText=e.getConstant("Reference");var a=new ox({placeholder:e.getConstant("EnterCellAddress")}),o=this.parent.createElement("input",{className:"e-text-goto",attrs:{type:"Text"}});return r.appendChild(o),r.insertBefore(n,o),i.appendChild(r),a.createElement=this.parent.createElement,a.appendTo(o),t},s.prototype.destroy=function(){this.removeEventListener(),this.findDialog&&this.findDialog.hide(),this.parent=null},s.prototype.getModuleName=function(){return"findAndReplace"},s}(),jY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.merge=function(e){this.parent.serviceLocator.getService("cell").refresh(e.rowIdx,e.colIdx,e.lastCell,e.element,!1,!1,ea(this.parent))},s.prototype.hideHandler=function(e){var t=this.parent.getActiveSheet(),i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(cr,i),i.range=i.range;var r=Y(i.range[0],i.range[1],t)||{},n=e.model==="row"?i.range[0]:i.range[1],a=n+((r[e.model+"Span"]||1)-1);if(!(!e.isEnd&&(e.start===n||Yt(t,n))||e.isEnd&&e.start>n&&!Yt(t,n))&&r[e.model+"Span"]>1&&a>=e.start)if(e.model==="row"?ct(t,n):Yt(t,n)){if(e.colIdx<=a){var o=ae(t,i.range[1],!0,"columns");if(o<=a){var l=i.range[0];r.rowSpan>1&&(l=ae(t,i.range[0],!0),l=l<=i.range[2]?l:i.range[0]);var h=this.parent.getCell(l,o);h&&(h.style.display="",this.parent.serviceLocator.getService("cell").refresh(i.range[0],i.range[1],!0,h,!0,!0))}}}else{var l=r.rowSpan>1?ae(t,i.range[0],!0):i.range[0];this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:this.parent.getCell(l,i.range[1])})}},s.prototype.checkPrevMerge=function(e){var t=this,i,r,n,a,o,l=this.parent.getActiveSheet(),h=function(){var d=t.parent.getContentTable(),p=d&&d.rows[0];if(p){var f=parseInt(p.getAttribute("aria-rowindex"),10)-1;if(r.range=r.range,f>t.parent.viewport.topIndex+t.parent.frozenRowCount(l)&&f>r.range[0]&&f<=r.range[2]){var v=void 0,g=t.parent.getRowHeaderTable(),b=g&&g.rows[0],y=t.parent.frozenColCount(l);if(y&&!b)return;for(var C=e.colIdx;C<=r.range[3];C++)v=t.parent.getCell(f,C,C<y?b:p),v&&(v.colSpan>1||v.rowSpan>1)&&(v.style.display="none",v.removeAttribute("colSpan"),v.removeAttribute("rowSpan"))}}},u=function(d){if(r.range=r.range,ct(l,r.range[0])&&e.rowIdx>=r.range[0]&&e.rowIdx<=r.range[2]){a=!1;for(var p=r.range[0];p<e.rowIdx;p++)if(!ct(l,p)){a=!0;break}if(i.rowSpan>1&&!a){var f=i.rowSpan-t.parent.hiddenCount(r.range[0],r.range[2]);f>0&&(h(),e.td.style.display="",e.colSpan=n,e.rowSpan=f,e.cell=i,e.isMerged=!1)}}else if(d){for(var p=r.range[0];o&&p<e.rowIdx;p++)if(!ct(l,p)){a=!0;break}a||(h(),e.td.style.display="",e.colSpan=n,e.cell=i,e.isMerged=!1)}};if(e.cell.colSpan<0){if(e.colIdx-1>-1&&Yt(l,e.colIdx-1)&&(i=Y(e.rowIdx,e.colIdx-1,l,!1,!0),(i.colSpan!==void 0||i.rowSpan!==void 0)&&(i.rowSpan===void 0||i.rowSpan>1||(o=e.rowIdx-1>-1&&ct(l,e.rowIdx-1)))&&(r={range:[e.rowIdx,e.colIdx-1,e.rowIdx,e.colIdx-1]},this.parent.notify(cr,r),r.range=r.range,i=Y(r.range[0],r.range[1],l,!1,!0),Yt(l,r.range[1])&&e.colIdx>=r.range[1]&&e.colIdx<=r.range[3]))){for(var c=r.range[1];c<e.colIdx;c++)if(!Yt(l,c)){a=!0;break}i.colSpan>1&&!a&&(n=i.colSpan-this.parent.hiddenCount(r.range[1],r.range[3],"columns"),n>0&&u(!0))}}else e.rowIdx-1>-1&&ct(l,e.rowIdx-1)&&(i=Y(e.rowIdx-1,e.colIdx,l,!1,!0),i.rowSpan!==void 0&&(r={range:[e.rowIdx-1,e.colIdx,e.rowIdx-1,e.colIdx]},this.parent.notify(cr,r),r.range=r.range,i=Y(r.range[0],r.range[1],l,!1,!0),u()))},s.prototype.checkMerge=function(e){var t=this.parent.getActiveSheet(),i,r=Y(e.rowIdx,e.colIdx,t)||{};if(e.isRow){if(r.colSpan===void 0||Yt(t,e.colIdx-1)){if(i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]},i.range=i.range,this.parent.notify(cr,i),Yt(t,e.colIdx-1)&&!Yt(t,i.range[1])||e.isFreezePane&&i.range[0]<this.parent.frozenRowCount(t)){e.insideFreezePane=i.range[0]<this.parent.frozenRowCount(t);return}if(e.colIdx!==this.parent.viewport.leftIndex+this.parent.frozenColCount(t)&&Yt(t,e.colIdx-1)){for(var n=i.range[1];r.colSpan!==void 0&&n<e.colIdx;n++)if(!Yt(t,n))return}r=Y(i.range[0],i.range[1],t);var a=i.range[2]-e.rowIdx+1-this.parent.hiddenCount(e.rowIdx,i.range[2]);a>1?(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:e.td}),e.td.rowSpan=a,e.td.style.display=""):a===1&&(e.td.style.display="")}}else if(r.rowSpan===void 0||ct(t,e.rowIdx-1)){if(i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]},i.range=i.range,this.parent.notify(cr,i),ct(t,e.rowIdx-1)&&!ct(t,i.range[0])||e.isFreezePane&&i.range[1]<this.parent.frozenColCount(t)){e.insideFreezePane=i.range[1]<this.parent.frozenColCount(t);return}if(e.rowIdx!==this.parent.viewport.topIndex+this.parent.frozenRowCount(t)&&ct(t,e.rowIdx-1)){for(var o=i.range[0];r.rowSpan!==void 0&&o<e.rowIdx;o++)if(!ct(t,o))return}r=Y(i.range[0],i.range[1],t);var a=i.range[3]-e.colIdx+1-this.parent.hiddenCount(e.colIdx,i.range[3],"columns");a>1?(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:e.td}),e.td.colSpan=a,e.td.style.display=""):a===1&&(e.td.style.display="")}},s.prototype.addEventListener=function(){this.parent.on(yl,this.merge,this),this.parent.on(a0,this.hideHandler,this),this.parent.on(nM,this.checkPrevMerge,this),this.parent.on(o0,this.checkMerge,this)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(yl,this.merge),this.parent.off(a0,this.hideHandler),this.parent.off(nM,this.checkPrevMerge),this.parent.off(o0,this.checkMerge))},s.prototype.getModuleName=function(){return"merge"},s}(),BY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener()},s.prototype.addEventListener=function(){this.parent.on(er,this.applyCF,this),this.parent.on(oM,this.renderCFDlg,this),this.parent.on(c1,this.clearCF,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(er,this.applyCF),this.parent.off(oM,this.renderCFDlg),this.parent.off(c1,this.clearCF))},s.prototype.clearCF=function(e){var t=this,i=this.parent.getActiveSheet(),r=function(n,a,o,l){te([l],["e-redft","e-yellowft","e-greenft","e-redf","e-redt","e-iconset"]);var h,u;["backgroundColor","color"].forEach(function(d){l.style[""+d]&&(l.style[""+d]="",h=o&&o.style&&o.style[""+d]||t.parent.commonCellStyle[""+d],h&&(u={},u[""+d]=h,t.parent.notify(dr,{style:u,rowIdx:n,colIdx:a,td:l})))});var c;[".e-cf-databar",".e-iconsetspan"].forEach(function(d){c=l.querySelector(d),c&&(l.removeChild(c),l.textContent=t.parent.getDisplayText(o))})};this.updateRange(i,e.indexes,this.parent.frozenRowCount(i),this.parent.frozenColCount(i),xe(i.topLeftCell),r)},s.prototype.renderCFDlg=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.serviceLocator.getService(At);r.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-conditionalformatting-dlg",header:e.action.replace("...",""),beforeOpen:function(){r.dialogInstance.content=t.cfDlgContent(e.action),r.dialogInstance.dataBind(),Fe(t.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){t.dlgClickHandler(e.action),r.hide()}}]})},s.prototype.dlgClickHandler=function(e){var t=this.parent.serviceLocator.getService(de),i=["",""],r,n=this.parent.element.querySelector(".e-conditionalformatting-dlg").getElementsByClassName("e-dlg-content")[0].querySelector(".e-cf-dlg"),a=n.querySelector(".e-cfmain"),o;a&&(o=a.getElementsByTagName("input")[0],o&&o.parentElement.classList.contains("e-cfmain")&&(i[0]=a.getElementsByTagName("input")[0].value),i[1]=a.getElementsByTagName("input")[1]?n.querySelector(".e-cfmain").getElementsByTagName("input")[1].value:"",yb(i,this.parent.locale)),e===t.getConstant("DuplicateValues")+"..."?r=o.value===t.getConstant("Duplicate")?"Duplicate":"Unique":r=this.getType(e);var l={type:r,cFColor:this.getCFColor(n.querySelector(".e-cfsub").getElementsByTagName("input")[0].value),range:this.parent.getActiveSheet().selectedRange};l.value=i[0]!==""?i[0]+(i[1]!==""?","+i[1]:""):i[1],this.parent.notify(vd,{cfModel:l,isAction:!0})},s.prototype.getType=function(e){var t=this.parent.serviceLocator.getService(de),i;switch(e){case t.getConstant("GreaterThan")+"...":i="GreaterThan";break;case t.getConstant("LessThan")+"...":i="LessThan";break;case t.getConstant("Between")+"...":i="Between";break;case t.getConstant("CFEqualTo")+"...":i="EqualTo";break;case t.getConstant("TextThatContains")+"...":i="ContainsText";break;case t.getConstant("ADateOccuring")+"...":i="DateOccur";break;case t.getConstant("Top10Items")+"...":i="Top10Items";break;case t.getConstant("Bottom10Items")+"...":i="Bottom10Items";break;case t.getConstant("Top10")+" %...":i="Top10Percentage";break;case t.getConstant("Bottom10")+" %...":i="Bottom10Percentage";break;case t.getConstant("AboveAverage")+"...":i="AboveAverage";break;case t.getConstant("BelowAverage")+"...":i="BelowAverage";break}return i},s.prototype.getCFColor=function(e){var t=this.parent.serviceLocator.getService(de),i="RedFT";switch(e){case t.getConstant("LightRedFillWithDarkRedText"):i="RedFT";break;case t.getConstant("YellowFillWithDarkYellowText"):i="YellowFT";break;case t.getConstant("GreenFillWithDarkGreenText"):i="GreenFT";break;case t.getConstant("RedFill"):i="RedF";break;case t.getConstant("RedText"):i="RedT";break}return i},s.prototype.cfDlgContent=function(e){var t=this.getDlgText(e),i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("div",{className:"e-cf-dlg"}),n=this.parent.createElement("div",{className:"e-cfmain"}),a=this.parent.createElement("div",{className:"e-cfsub"}),o=this.parent.createElement("span",{className:"e-header e-top-header"});o.innerText=t;var l=this.parent.createElement("input",{className:"e-input",id:"valueInput",attrs:{type:"text","aria-label":t}}),h=this.parent.createElement("input",{className:"e-select"}),u=this.parent.createElement("span",{className:"e-header"});u.innerText=i.getConstant("With");var c=this.parent.createElement("input",{className:"e-select"});r.appendChild(n),r.appendChild(a),n.appendChild(o);var d;if(e!==i.getConstant("DuplicateValues")+"..."){if(e!==i.getConstant("AboveAverage")+"..."&&e!==i.getConstant("BelowAverage")+"..."){n.appendChild(l),d=!0;var p=e===i.getConstant("Top10")+" %..."||e===i.getConstant("Bottom10")+" %...";if(e===i.getConstant("Top10Items")+"..."||e===i.getConstant("Bottom10Items")+"..."||p){l.maxLength=p?3:4;var f=new to({value:10,min:1,max:p?100:1e3,format:"###"});f.appendTo(l)}}}else{n.appendChild(h);var v=[{text:i.getConstant("Duplicate"),id:"duplicate"},{text:i.getConstant("Unique"),id:"unique"}],g=new Na({dataSource:v,index:0,popupHeight:"200px"});g.appendTo(h)}if(e===i.getConstant("Between")+"..."){var b=this.parent.createElement("span",{className:"e-header e-header-2"});b.innerText=i.getConstant("And");var y=this.parent.createElement("input",{className:"e-input e-between"});n.appendChild(b),n.appendChild(y),y.addEventListener("input",this.validateCFInput.bind(this))}d&&(this.validateCFInput({target:l}),l.addEventListener("input",this.validateCFInput.bind(this))),a.appendChild(u),a.appendChild(c);var C=[{text:i.getConstant("LightRedFillWithDarkRedText"),value:"redft",id:"redft"},{text:i.getConstant("YellowFillWithDarkYellowText"),id:"yellowft"},{text:i.getConstant("GreenFillWithDarkGreenText"),id:"greenft"},{text:i.getConstant("RedFill"),id:"redf"},{text:i.getConstant("RedText"),id:"redt"}],x=new Na({dataSource:C,index:0,popupHeight:"200px"});return x.appendTo(c),r},s.prototype.validateCFInput=function(e){var t=this.parent.serviceLocator.getService(At),i=e.target.value,r=t.dialogInstance.element.getElementsByClassName("e-primary")[0];i&&(e.target.classList.contains("e-between")||e.target.parentElement.querySelector(".e-between"))&&(i=e.target.parentElement.querySelector(e.target.classList.contains("e-between")?".e-input":".e-between").value),r.disabled=!i.trim()},s.prototype.checkCellHandler=function(e,t,i){for(var r=i.range.trim().split(","),n=0;n<r.length;n++){var a=ee(r[n].includes(":")?r[n]:r[n]+":"+r[n]);if(e>=a[0]&&e<=a[2]&&t>=a[1]&&t<=a[3])return!0}return!1},s.prototype.getDlgText=function(e){var t=this.parent.serviceLocator.getService(de),i="";switch(e){case t.getConstant("GreaterThan")+"...":i=t.getConstant("FormatCellsGreaterThan");break;case t.getConstant("LessThan")+"...":i=t.getConstant("FormatCellsLessThan");break;case t.getConstant("Between")+"...":i=t.getConstant("FormatCellsBetween");break;case t.getConstant("CFEqualTo")+"...":i=t.getConstant("FormatCellsEqualTo");break;case t.getConstant("TextThatContains")+"...":i=t.getConstant("FormatCellsThatContainTheText");break;case t.getConstant("ADateOccuring")+"...":i=t.getConstant("FormatCellsThatContainADateOccurring");break;case t.getConstant("DuplicateValues")+"...":i=t.getConstant("FormatCellsDuplicate");break;case t.getConstant("Top10Items")+"...":i=t.getConstant("FormatCellsTop");break;case t.getConstant("Top10")+" %...":i=t.getConstant("FormatCellsTop");break;case t.getConstant("Bottom10Items")+"...":i=t.getConstant("FormatCellsBottom");break;case t.getConstant("Bottom10")+" %...":i=t.getConstant("FormatCellsBottom");break;case t.getConstant("AboveAverage")+"...":i=t.getConstant("FormatCellsAbove");break;case t.getConstant("BelowAverage")+"...":i=t.getConstant("FormatCellsBelow");break}return i},s.prototype.updateResult=function(e,t,i,r,n,a,o,l){var h={},u={},c=e.range.split(","),d=[],p,f,v;i?v=function(){if(He(f)){var w=parseFloat(f);w>=0?(d[0]===void 0||w>d[0])&&(d[0]=w):(d[1]===void 0||w<d[1])&&(d[1]=w)}}:r?v=function(){if(He(f)){var w=parseFloat(f);d.push(Number(w))}}:n?(d=[0,0],v=function(){He(f)&&(d[0]+=parseFloat(f),d[1]++)}):a?v=function(){He(f)&&d.push(parseFloat(f))}:o?v=function(){if(He(f)){var w=parseInt(f,10);(d[0]===void 0||w<d[0])&&(d[0]=w),(d[1]===void 0||w>d[1])&&(d[1]=w)}}:v=function(){h[""+f]?u[""+f]||(u[""+f]=!0,d.push(f)):h[""+f]=!0};for(var g,b=0;b<c.length;b++){p=ee(c[b]);for(var y=p[0];y<=p[2];y++)for(var C=p[1];C<=p[3];C++)g=Y(y,C,t,!1,!0),m(g.value)?g.formula&&(this.parent.notify("calculateFormula",{cell:g,rowIdx:y,colIdx:C,sheetIndex:this.parent.activeSheetIndex}),f=g.value.toString().toLowerCase(),v()):(f=g.value.toString().toLowerCase(),v())}if(r||a){if(d=d.sort(function(w,M){return w-M}),e.type.includes("Bottom")||(d=d.reverse()),a){var x=parseFloat(l);e.type.includes("Percentage")&&(x=x/(100/d.length),x=x<1?1:x),d=d.slice(0,x)}}else n&&(d=[d[0]/d[1]],d[0]||(d=[]));e.result=d},s.prototype.applyCF=function(e){var t=!e.cfModel,i=this.parent.getActiveSheet(),r=e.cfModel||i.conditionalFormats,n=[e.indexes],a;e.refreshAll&&(n=SI(this.parent,this.parent.viewport));for(var o=r.length-1;o>=0;o--)t&&(n[0].length===2?!this.checkCellHandler(e.indexes[0],e.indexes[1],r[o]):!qy(n,r[o].range))||(a=this.updateCF(e,i,r[o],a))},s.prototype.updateCF=function(e,t,i,r){var n=this,a,o;if(i.value){var l=i.value.split(",").filter(function(E){return!!E.trim()});if(l.length>1)if(l[0].split("(").length>1){for(var h="",u=0;u<l.length;u++)h+=l[u]+",",h.split("(").length===h.split(")").length&&a===void 0&&(a=h.substring(0,h.length-1),h="");o=h.substring(0,h.length-1)}else{a=l[0];for(var u=1;u<l.length;u++)o+=u+1===l.length?l[u]:l[u]+","}else a=l[0]||i.value}i.type||(i.type="GreaterThan");var c;i.format&&i.format.style?(c=EI(i.format.style,!0),!Object.keys(c).length&&!i.cFColor&&(i.cFColor="RedFT")):(c={},i.cFColor||(i.cFColor="RedFT"));var d,p,f,v=i.type.includes("DataBar"),g=i.type.includes("ColorScale");(!e.isRender||!i.result)&&(i.type==="Duplicate"||i.type==="Unique"||v||g||(d=i.type.includes("Average"))||(p=i.type.includes("10")&&He(a))||(f=i.type.includes("Three")||i.type.includes("Four")||i.type.includes("Five")))&&this.updateResult(i,t,v,g,d,p,f,a);var b=function(E,T,D,N){var A=D&&!m(D.value)?D.value.toString():"",L,k,O=!0;switch(i.type){case"GreaterThan":case"LessThan":L=n.isGreaterThanLessThan(i,A,a);break;case"Between":L=He(A)&&n.isBetWeen(i,A,a,o);break;case"EqualTo":L=He(A)&&n.isEqualTo(i,A,a);break;case"ContainsText":L=A&&n.isContainsText(A,a);break;case"DateOccur":k={value:a,cell:{},updatedVal:""},n.parent.notify(yn,k),L=A===k.updatedVal;break;case"Unique":L=i.result.indexOf(A.toLowerCase())===-1;break;case"Duplicate":L=i.result.indexOf(A.toLowerCase())>-1;break;case"Top10Items":case"Bottom10Items":case"Top10Percentage":case"Bottom10Percentage":if(i.result){var R=parseFloat(A);Mc(A)&&(R=Es(A)),L=i.result.indexOf(R)>-1}break;case"AboveAverage":L=i.result.length&&parseFloat(A)>i.result[0];break;case"BelowAverage":L=i.result.length&&parseFloat(A)<i.result[0];break;default:O=!1,v?n.applyDataBars(A,i,N,E):g?n.applyColorScale(A,i,N,D,E,T):n.applyIconSet(A,i,N);break}if(e.isAction&&O&&(n.parent.trigger("beforeConditionalFormat",{conditionalFormat:i,cell:D,element:N,apply:L,address:Je(E,T)}),!L&&e.isEdit&&!r)){var j;e.indexes&&e.indexes[0]===E&&e.indexes[1]===T&&(r=!0),i.cFColor?N.className.includes("e-"+i.cFColor.toLowerCase())&&(N.classList.remove("e-"+i.cFColor.toLowerCase()),N.style.backgroundColor="",N.style.color="",j=me({},n.parent.commonCellStyle,D&&D.style),(j.backgroundColor||j.color)&&n.parent.notify(dr,{rowIdx:E,colIdx:T,td:N,style:{backgroundColor:j.backgroundColor,color:j.color}})):(N.removeAttribute("style"),j=me({},n.parent.commonCellStyle,D&&D.style),Object.keys(j).length&&n.parent.notify(dr,{style:j,rowIdx:E,colIdx:T,td:N}))}L&&(e.isEdit&&e.indexes&&e.indexes[0]===E&&e.indexes[1]===T&&(r=!0),te([N],["e-redft","e-yellowft","e-greenft","e-redf","e-redt"]),i.cFColor&&(N.classList.add("e-"+i.cFColor.toLowerCase()),n.setCFStyle(c,i)),Object.assign(N.style,c))};if(e.ele)b(e.indexes[0],e.indexes[1],e.cell,e.ele);else for(var y=i.range.split(","),C=this.parent.frozenRowCount(t),x=this.parent.frozenColCount(t),w=xe(t.topLeftCell),M=0;M<y.length;M++)this.updateRange(t,ee(y[M]),C,x,w,b);return r},s.prototype.updateRange=function(e,t,i,r,n,a){t[0]=t[0]<i?t[0]<n[0]?n[0]:t[0]:t[0]<this.parent.viewport.topIndex+i?this.parent.viewport.topIndex+i:t[0],t[1]=t[1]<r?t[1]<n[1]?n[1]:t[1]:t[1]<this.parent.viewport.leftIndex+r?this.parent.viewport.leftIndex+r:t[1],t[2]=t[2]<i?t[2]<n[0]?n[0]-1:t[2]:t[2]>this.parent.viewport.bottomIndex?this.parent.viewport.bottomIndex:t[2],t[3]=t[3]<r?t[3]<n[1]?n[1]-1:t[3]:t[3]>this.parent.viewport.rightIndex?this.parent.viewport.rightIndex:t[3];for(var o,l=t[0];l<=t[2];l++)if(i&&l===i&&(l=this.parent.viewport.topIndex+i),!ct(e,l))for(var h=t[1];h<=t[3];h++)r&&h===r&&(h=this.parent.viewport.leftIndex+r),!Yt(e,h)&&(o=this.parent.getCell(l,h),o&&a(l,h,Y(l,h,e),o))},s.prototype.applyIconSet=function(e,t,i){if(i.classList.contains("e-iconset")){i.classList.remove("e-iconset");var r=i.querySelector(".e-iconsetspan");r&&i.removeChild(r)}var n=parseInt(e,10),a=t.result;if(!(isNaN(n)||a[0]===void 0&&a[1]===void 0)){var o=a[0],l=a[1],h=this.getIconList(t.type).split(","),u;if(h.length===3){var c=o+.67*(l-o),d=o+.33*(l-o);u="e-"+(n>=c?h[0].trim():n>=d?h[1].trim():h[2].trim())}else if(h.length===4){var p=o+.25*(l-o),f=o+.5*(l-o),v=o+.75*(l-o);u="e-"+(n>=v?h[0].trim():n>=f?h[1].trim():n>=p?h[2].trim():h[3].trim())}else if(h.length===5){var p=o+.2*(l-o),f=o+.4*(l-o),v=o+.6*(l-o),g=o+.8*(l-o);u="e-"+(n>=g?h[0].trim():n>=v?h[1].trim():n>=f?h[2].trim():n>=p?h[3].trim():h[4].trim())}var b=this.parent.createElement("span",{className:"e-icon e-iconsetspan "+u});i.insertBefore(b,i.childNodes[0]),i.classList.add("e-iconset")}},s.prototype.getIconList=function(e){var t="3arrows-1,3arrows-2,3arrows-3";switch(e){case"ThreeArrows":return"3arrows-1,3arrows-2,3arrows-3";case"ThreeArrowsGray":return"3arrowsgray-1,3arrowsgray-2,3arrowsgray-3";case"FourArrowsGray":return"4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4";case"FourArrows":return"4arrows-1,4arrows-2,4arrows-3,4arrows-4";case"FiveArrowsGray":return"5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5";case"FiveArrows":return"5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5";case"ThreeTrafficLights1":return"3trafficlights-1,3trafficlights-2,3trafficlights-3";case"ThreeTrafficLights2":return"3rafficlights2-1,3rafficlights2-2,3rafficlights2-3";case"ThreeSigns":return"3signs-1,3signs-2,3signs-3";case"FourTrafficLights":return"4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4";case"FourRedToBlack":return"4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4";case"ThreeSymbols":return"3symbols-1,3symbols-2,3symbols-3";case"ThreeSymbols2":return"3symbols2-1,3symbols2-2,3symbols2-3";case"ThreeFlags":return"3flags-1,3flags-2,3flags-3";case"FourRating":return"4rating-1,4rating-2,4rating-3,4rating-4";case"FiveQuarters":return"5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5";case"FiveRating":return"5rating-1,5rating-2,5rating-3,5rating-4,5rating-5";case"ThreeTriangles":return"3triangles-1,3triangles-2,3triangles-3";case"ThreeStars":return"3stars-1,3stars-2,3stars-3";case"FiveBoxes":return"5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5"}return t},s.prototype.applyColorScale=function(e,t,i,r,n,a){var o=parseFloat(e);if(isNaN(o)){if(i.style.backgroundColor){i.style.backgroundColor="";var l=me({},this.parent.commonCellStyle,r&&r.style);l.backgroundColor&&this.parent.notify(dr,{style:{backgroundColor:l.backgroundColor},td:i,rowIdx:n,colIdx:a})}return}var h=t.result,u=h.indexOf(o),c=this.getColor(t.type);i.style.backgroundColor=u===0?c[0]:u===h.length-1?c[c.length-1]:h.length===3&&u===1?c[1]:this.getGradient(u,c[0],c[1],c[2],h.length)},s.prototype.applyDataBars=function(e,t,i,r){var n=this.parent.getActiveSheet(),a=t.result,o=0,l,h;if(He(e)&&(h=parseFloat(e)),a[0]===void 0&&a[1]===void 0||isNaN(h)){var u=i.getElementsByClassName("e-cf-databar")[0];u&&i.removeChild(u);return}a[0]!==void 0&&a[1]!==void 0?(l=a[0]+Math.abs(a[1]),o=Math.abs(a[1]/l*100)):a[0]!==void 0?l=a[0]:l=a[1];var c=this.parent.createElement("div",{id:"spreadsheet-databar",className:"e-cf-databar"}),d=this.parent.createElement("span",{id:"spreadsheet-leftspan",className:"e-databar"}),p=this.parent.createElement("span",{id:"spreadsheet-rightspan",className:"e-databar"}),f=this.parent.createElement("span",{id:"spreadsheet-dataspan",className:"e-databar-value"}),v=i.querySelector(".e-iconsetspan");v&&i.insertBefore(v,i.firstElementChild);var g=Wt(n,r,!0);c.style.height=g-1+"px";var b=t.type[0];b==="L"&&(b+="B"),a[1]===void 0?(p.style.width=""+Math.ceil(Math.abs(h/l*100))+"%",p.style.height=g-3+"px",p.style.backgroundColor=this.getColor(b)[0],p.style.left="0px"):a[0]===void 0?(p.style.width=""+Math.ceil(Math.abs(h/l*100))+"%",p.style.height=g-3+"px",p.style.backgroundColor=this.getColor("R")[0],p.style.left="0px"):h>=0?(d.style.width=o+"%",d.style.height=g-3+"px",d.style.backgroundColor="transparent",d.style.left="0px",p.style.width=""+Math.ceil(Math.abs(h/l*100))+"%",p.style.height=g-3+"px",p.style.backgroundColor=this.getColor(b)[0],p.style.left=o+"%"):(d.style.width=""+Math.ceil(Math.abs(h/l*100))+"%",d.style.height=g-3+"px",d.style.backgroundColor=this.getColor("R")[0],d.style.width===o+"%"?d.style.left="0px":d.style.right=100-o+"%"),f.style.fontSize=i.style.fontSize||"11pt";var y=i.querySelector("#"+this.parent.element.id+"_currency");y&&c.appendChild(y);var C=i.querySelector(".e-hyperlink");C?f.appendChild(C):(f.innerText=i.textContent,i.textContent===""&&f.appendChild(document.createTextNode(i.textContent))),c.appendChild(d),c.appendChild(p),c.appendChild(f),i.textContent="",i.appendChild(c)},s.prototype.getColor=function(e){if(e==="LB")return["#008aef"];for(var t=e.split(""),i=[],r=0;r<t.length;r++)switch(t[r]){case"G":i.push("#63be7b");break;case"Y":i.push("#ffeb84");break;case"R":i.push("#f8696b");break;case"W":i.push("#ffffff");break;case"B":i.push("#5a8ac6");break;case"O":i.push("#ffb628");break;case"LB":i.push("#008aef");break;case"P":i.push("#d6007b");break}return i},s.prototype.getGradient=function(e,t,i,r,n){if(m(r))return this.getLinear(t,i,e/n);var a=n/2;return e>=a?this.getLinear(i,r,Math.abs((e-a)/a)):this.getLinear(t,i,e/a)},s.prototype.getLinear=function(e,t,i){var r=this.byteLinear(e[1]+e[2],t[1]+t[2],i),n=this.byteLinear(e[3]+e[4],t[3]+t[4],i),a=this.byteLinear(e[5]+e[6],t[5]+t[6],i);return"#"+r+n+a},s.prototype.byteLinear=function(e,t,i){var r=parseInt(e,16)*(1-i)+parseInt(t,16)*i|0;return Math.abs(r).toString(16)},s.prototype.isGreaterThanLessThan=function(e,t,i){if(He(t))if(He(i)){var r=new RegExp(/[^.-a-zA-Z 0-9]+/g);return e.type==="GreaterThan"?parseFloat(t)>parseFloat(i.replace(r,"")):parseFloat(t)<parseFloat(i.replace(r,""))}else{var n={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};return this.parent.notify(yn,n),n.isDate||n.isTime?(e.value=n.updatedVal.toString(),e.type==="GreaterThan"?Number(t)>Number(n.updatedVal):Number(t)<Number(n.updatedVal)):e.type==="GreaterThan"?t.toLowerCase()>i.toLowerCase():t.toLowerCase()<i.toLowerCase()}else if(t===""&&Number(i)>0&&e.type==="LessThan")return!0;return!1},s.prototype.isBetWeen=function(e,t,i,r){var n,a,o=new RegExp(/[^.-a-zA-Z 0-9]+/g);if(i=i.replace(o,""),r=r.replace(o,""),He(i)){var l=parseFloat(i),h=parseFloat(r);return l>h&&(n=[h,l],l=n[0],h=n[1]),parseFloat(t)>=l&&parseFloat(t)<=h}else if(i&&r){var u={value:i,cell:{},updatedVal:""},c={value:r,cell:{},updatedVal:""};return this.parent.notify(yn,u),this.parent.notify(yn,c),(u.isDate||u.isTime)&&(c.isDate||c.isTime)?(e.value=u.updatedVal+","+c.updatedVal,u.updatedVal>c.updatedVal&&(a=[c.updatedVal,u.updatedVal],u.updatedVal=a[0],c.updatedVal=a[1]),t>=u.updatedVal&&t<=c.updatedVal):t.toLowerCase()>=i.toLowerCase()&&t.toLowerCase()<=r.toLowerCase()}return!1},s.prototype.isEqualTo=function(e,t,i){if(He(i)){var r=new RegExp(/[^.-a-zA-Z 0-9]+/g);return parseFloat(t)===parseFloat(i.replace(r,""))}else{var n={value:i,cell:{},updatedVal:""};return this.parent.notify(yn,n),n.isTime||n.isDate?(e.value=n.updatedVal,t===n.updatedVal):t.toLowerCase()===i.toLowerCase()}},s.prototype.isContainsText=function(e,t){var i=new RegExp(/[^.-a-zA-Z 0-9]+/g);return He(t.replace(i,""))?(t=t.replace(i,""),Mc(e)&&(e=Es(e).toString()),e.indexOf(t)>-1):Mc(t)?(Mc(e)&&(e=Es(e).toString()),e.indexOf(Es(t).toString())>-1):e.toLowerCase().indexOf(t.toLowerCase())>-1},s.prototype.setCFStyle=function(e,t){switch(t.cFColor){case"RedFT":e.backgroundColor="#ffc7ce",e.color="#9c0055";break;case"YellowFT":e.backgroundColor="#ffeb9c",e.color="#9c6500";break;case"GreenFT":e.backgroundColor="#c6efce",e.color="#006100";break;case"RedF":e.backgroundColor="#ffc7ce";break;case"RedT":e.color="#9c0055";break}return e},s.prototype.getModuleName=function(){return"conditionalFormatting"},s}(),HY=function(){function s(e){this.fillOptionIndex=0,this.parent=e,this.addEventListener()}return s.prototype.getfillItems=function(){var e=this.parent.serviceLocator.getService(de);return[{text:e.getConstant("CopyCells")},{text:e.getConstant("FillSeries")},{text:e.getConstant("FillFormattingOnly")},{text:e.getConstant("FillWithoutFormatting")}]},s.prototype.createAutoFillElement=function(){if(this.parent.allowAutoFill){var e=this.parent.getMainContent(),t=this.parent.createElement("div",{className:"e-autofill"});e.lastElementChild&&e.lastElementChild.classList.contains("e-ss-overlay")?e.insertBefore(t,e.getElementsByClassName("e-ss-overlay")[0]):e.appendChild(t),this.autoFillElement=t,this.getautofillDDB({id:this.parent.element.id+"_autofilloptionbtn",appendElem:e})}},s.prototype.getautofillDDB=function(e){var t=this,i=this.parent.createElement("button",{id:e.id,className:"e-filloption",attrs:{type:"button"}});return i.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"})),this.autoFillDropDown=new Or({cssClass:"e-dragfill-ddb",iconCss:"e-icons e-dragfill-icon",items:this.getfillItems(),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(r){t.autoFillOptionClick({type:t.getFillType(r.item.text)})},beforeOpen:function(){return t.autoFillClick()}}),this.autoFillDropDown.createElement=this.parent.createElement,this.autoFillDropDown.appendTo(i),e.appendElem.appendChild(i),this.autoFillDropDown},s.prototype.getFillType=function(e){var t=this.parent.serviceLocator.getService(de),i;return e===t.getConstant("CopyCells")?i="CopyCells":e===t.getConstant("FillSeries")?i="FillSeries":e===t.getConstant("FillFormattingOnly")?i="FillFormattingOnly":i="FillWithoutFormatting",i},s.prototype.autoFillClick=function(){var e=this.parent.serviceLocator.getService(de),t={fillType:"FillSeries",disableItems:[""]};this.parent.notify(m1,t),this.autoFillDropDown.setProperties({items:this.getfillItems()},!0),this.autoFillDropDown.removeItems(t.disableItems),this.refreshAutoFillOption(e.getConstant(t.fillType))},s.prototype.getFillRange=function(e,t,i,r){switch(r){case"Up":return[i.rowIndex,e.colIndex,e.rowIndex-1,t.colIndex];case"Right":return[e.rowIndex,t.colIndex+1,t.rowIndex,i.colIndex];case"Down":return[t.rowIndex+1,e.colIndex,i.rowIndex,t.colIndex];case"Left":return[e.rowIndex,i.colIndex,t.rowIndex,e.colIndex-1]}},s.prototype.autoFillOptionClick=function(e){var t=this.parent.serviceLocator.getService(de),i=this.parent.getActiveSheet(),r=lt(ee(this.parent.selectionModule.dAutoFillCell)),n=ee(i.selectedRange),a=r[0],o=r[1],l=r[2],h=r[3],u=this.getDirection({rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]}),c=[a,o,l,h],d=this.getFillRange({rowIndex:a,colIndex:o},{rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]},u);this.refreshAutoFillOption(t.getConstant(e.type));var p={isUndo:!0,isPublic:!0,preventReSelect:!0,preventEvt:e.type==="FillWithoutFormatting",setCollection:e.type==="FillFormattingOnly"||e.type==="FillWithoutFormatting"};this.parent.notify(Fa,p);var f={dataRange:i.name+"!"+je(c),fillRange:i.name+"!"+je(d),direction:u,fillType:e.type,isFillOptClick:!0};this.isVerticalFill=f.direction==="Down"||f.direction==="Up",this.parent.notify(gd,f),this.positionAutoFillElement({isautofill:!0});var v={dataRange:f.dataRange,fillRange:f.fillRange,fillType:f.fillType,direction:f.direction,selectedRange:i.name+"!"+je(n),undoArgs:p.undoArgs};this.parent.notify(yt,{eventArgs:v,action:"autofill"}),this.parent.showAggregate&&this.parent.notify(wd,{}),this.autoFillClick()},s.prototype.refreshAutoFillOption=function(e){for(var t=0;t<this.autoFillDropDown.items.length;t++)this.autoFillDropDown.items[t].iconCss="";for(var t=0;t<this.autoFillDropDown.items.length;t++)this.autoFillDropDown.items[t].text===e&&(this.autoFillDropDown.items[t].iconCss="e-icons e-selected-icon");["Copy Cells","Fill Series","Fill Formatting Only","Fill Without Formatting"].indexOf(e)<0&&(this.autoFillDropDown.items[this.fillOptionIndex].iconCss=""),this.autoFillDropDown.dataBind()},s.prototype.positionAutoFillElement=function(e){var t=0,i=0,r=this.parent.getActiveSheet(),n=lt(ee(r.selectedRange)),a=-5,o=-5,l=6,h=6,u=n[1]===0&&n[3]===r.colCount-1,c=n[0]===0&&n[2]===r.rowCount-1,d=n[2],p=n[3],f,v,g,b=this.parent.enableRtl,y=this.parent.getCell(d,p);if(Yt(r,n[3])||ct(r,n[2])||y&&y.classList.contains("e-formularef-selection")||r.isProtected&&r.protectSettings.selectUnLockedCells&&ah(this.parent,n)){this.hideAutoFillElement();return}if(r.isProtected&&(r.protectSettings.selectCells||r.protectSettings.selectUnLockedCells)||!r.isProtected){if(u?(a=-5,o=-1,l=6,h=2,d=n[2],p=n[1]):c&&(o=-5,a=0,l=1,h=6,d=n[0],p=n[3]),r.frozenColumns||r.frozenRows){if(c||u?(ws(this.parent,this.autoFillElement,n,"e-autofill",e&&e.preventAnimation),this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill&&ws(this.parent,this.autoFillDropDown.element,n,"e-filloption")):(ws(this.parent,this.autoFillElement,[d,p,d,p],"e-autofill",e&&e.preventAnimation),this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill&&ws(this.parent,this.autoFillDropDown.element,[d,p,d,p],"e-filloption")),this.autoFillElement){this.autoFillCell={rowIndex:d,colIndex:p};var C=this.parent.element.querySelectorAll(".e-autofill")[0];if(C){var x=C.getBoundingClientRect();this.autoFillElementPosition={left:x.left,top:x.top}}}}else if(g=Cb(r,[d,p,d,p],this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth),f=Ei(r,d,d,!0),v=ci(r,p,p,!0),c||(t+=f),u||(i+=v),t+=Math.round(g.top)+a,i+=Math.round(g.left)+o,this.autoFillElement){te([this.autoFillElement],"e-hide"),this.autoFillElement.style.top=t+"px",b?this.autoFillElement.style.right=i+"px":this.autoFillElement.style.left=i+"px",this.autoFillCell={rowIndex:d,colIndex:p};var x=this.autoFillElement.getBoundingClientRect();this.autoFillElementPosition={left:x.left,top:x.top},this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill&&(te([this.autoFillDropDown.element],"e-hide"),this.autoFillDropDown.element.style.top=t+l+"px",b?this.autoFillDropDown.element.style.right=i+h+"px":this.autoFillDropDown.element.style.left=i+h+"px")}}},s.prototype.hideAutoFillElement=function(){var e=this.parent.element;[].slice.call(e.querySelectorAll(".e-autofill")).forEach(function(t){e&&Q([t],"e-hide")})},s.prototype.hideAutoFillOptions=function(){var e=this.parent.element;[].slice.call(e.querySelectorAll(".e-filloption")).forEach(function(t){e&&Q([t],"e-hide")})},s.prototype.selectAutoFillRange=function(e){var t={clientY:Za(e.e),target:e.e.target},i={clientX:Ka(e.e),target:e.e.target},r=this.parent.getActiveSheet();this.parent.notify(lo,t),this.parent.notify(ho,i);var n,a=this.getAutoFillRange({rowIndex:t.clientY,colIndex:i.clientX});return a&&a.fillRange?n=[a.startCell.rowIndex,a.startCell.colIndex,a.endCell.rowIndex,a.endCell.colIndex]:n=ee(r.selectedRange),e.indexes=n,n},s.prototype.getAutoFillRange=function(e){var t=this.parent.getActiveSheet(),i=this.autoFillCell,r=lt(ee(t.selectedRange)),n=r[0],a=r[1],o=r[2],l=r[3],h=Uf(r,[e.rowIndex,e.colIndex,e.rowIndex,e.colIndex],!0),u={rowIndex:n,colIndex:a},c={rowIndex:r[0],colIndex:r[1]},d={rowIndex:r[2],colIndex:r[3]},p={rowIndex:o,colIndex:l},f=this.modifyRangeForMerge(e.rowIndex,e.colIndex,i.rowIndex,i.colIndex,r);return e.rowIndex<i.rowIndex?n-e.rowIndex>e.colIndex-l&&n-e.rowIndex>a-e.colIndex?h?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l}}:{startCell:p,endCell:{rowIndex:f.rowIndex,colIndex:a},fillRange:[f.rowIndex,a,n-1,l],direction:"Up"}:e.colIndex>i.colIndex?{startCell:u,endCell:{rowIndex:o,colIndex:e.colIndex},fillRange:[n,l+1,o,e.colIndex],direction:"Right"}:e.colIndex<i.colIndex?h?{startCell:u,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:e.colIndex},fillRange:[n,e.colIndex,o,a-1],direction:"Left"}:{startCell:c,endCell:d}:e.colIndex>i.colIndex?e.rowIndex-o>e.colIndex-l?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l},fillRange:[o+1,a,e.rowIndex,l],direction:"Down"}:{startCell:u,endCell:{rowIndex:o,colIndex:f.colIndex},fillRange:[n,l+1,o,f.colIndex],direction:"Right"}:e.colIndex<i.colIndex?e.rowIndex-o>l-e.colIndex||e.rowIndex-n>l-e.colIndex&&e.rowIndex!==o?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l},fillRange:[o+1,a,e.rowIndex,l],direction:"Down"}:h?{startCell:u,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:f.colIndex},fillRange:[n,f.colIndex,o,a-1],direction:"Left"}:e.rowIndex>i.rowIndex?{startCell:u,endCell:{rowIndex:f.rowIndex,colIndex:l},fillRange:[o+1,a,f.rowIndex,l],direction:"Down"}:e.rowIndex===i.rowIndex&&e.colIndex===i.colIndex?{startCell:c,endCell:d}:{startCell:c,endCell:d}},s.prototype.modifyRangeForMerge=function(e,t,i,r,n){var a={rowIndex:e,colIndex:t};if(this.isMergedRange(n)){var o=n[2]-n[0]+1,l=n[3]-n[1]+1,h=void 0;e<i?(h=(n[2]-e+1)%o,h&&e-(o-h)>=0&&(a.rowIndex=e-(o-h))):t>r?(h=(t-n[1]+1)%l,h&&(a.colIndex=t+(l-h))):t<r?(h=(n[3]-t+1)%l,h&&t-(l-h)>=0&&(a.colIndex=t-(l-h))):e>i&&(h=(e-n[0]+1)%o,h&&(a.rowIndex=e+(o-h)))}return a},s.prototype.performAutoFill=function(e){if(e.rangeInfo||!(e.event.clientX>this.autoFillElementPosition.left&&e.event.clientX<this.autoFillElementPosition.left+10)||!(e.event.clientY>this.autoFillElementPosition.top&&e.event.clientY<this.autoFillElementPosition.top+10)){var t=void 0;if(e.rangeInfo)t=e.rangeInfo;else{var i={clientY:Za(e.event),target:e.event.target},r={clientX:Ka(e.event),target:e.event.target};this.parent.notify(lo,i),this.parent.notify(ho,r),t=this.getAutoFillRange({rowIndex:i.clientY,colIndex:r.clientX})}var n=this.parent.getActiveSheet();if(t&&t.fillRange){var a={dataRange:n.name+"!"+e.dAutoFillCell,fillRange:n.name+"!"+je(t.fillRange),direction:t.direction,fillType:e.fillType||this.parent.autoFillSettings.fillType,cancel:!1};if(this.parent.notify(li,{eventArgs:a,action:"autofill"}),a.cancel)return;var o=ah(this.parent,t.fillRange);if(n.isProtected&&o){this.parent.notify(Ta,null);return}e.rangeInfo?this.performAutoFillAction(a,null,o):(this.performAutoFillAction(a,t,o),this.positionAutoFillElement({isautofill:!0}))}}else this.positionAutoFillElement({isautofill:!1})},s.prototype.refreshCell=function(e){this.parent.serviceLocator.getService("cell").refreshRange([e.rowIndex,e.colIndex,e.rowIndex,e.colIndex])},s.prototype.getDirection=function(e,t,i){if(i=m(i)?this.isVerticalFill:i,i){if(t.rowIndex<e.rowIndex)return"Up";if(t.rowIndex>e.rowIndex)return"Down";if(t.colIndex>e.colIndex)return"Right";if(t.colIndex<e.colIndex)return"Left"}else{if(t.colIndex>e.colIndex)return"Right";if(t.colIndex<e.colIndex)return"Left";if(t.rowIndex<e.rowIndex)return"Up";if(t.rowIndex>e.rowIndex)return"Down"}return null},s.prototype.performAutoFillAction=function(e,t,i){var r=this,n=this.parent.getActiveSheet(),a=this.parent.serviceLocator.getService(de);if(this.isMergedRange(ee(e.fillRange))){var o=this.parent.serviceLocator.getService(At);o.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:a.getConstant("AutoFillMergeAlertMsg"),buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(de).getConstant("Ok"),isPrimary:!0},click:function(){o.hide(),r.parent.selectRange(e.dataRange)}}],close:function(){o.hide(),r.parent.selectRange(e.dataRange)}},!1);return}this.isVerticalFill=e.direction==="Down"||e.direction==="Up",this.parent.notify(gd,{dataRange:e.dataRange,fillRange:e.fillRange,direction:e.direction,fillType:e.fillType,isLockedCell:i});var l=t?je([t.startCell.rowIndex,t.startCell.colIndex,t.endCell.rowIndex,t.endCell.colIndex]):n.selectedRange;Xp(this.parent,l,n);var h={dataRange:e.dataRange,fillRange:e.fillRange,fillType:e.fillType,direction:e.direction,selectedRange:l};this.parent.notify(yt,{eventArgs:h,action:"autofill"}),this.parent.showAggregate&&this.parent.notify(wd,{})},s.prototype.getRangeData=function(e){for(var t=[],i=this.parent.getActiveSheet(),r=e.range[0],n=e.range[1],a=e.range[2],o=e.range[3],l=n,h;r<=a;){if(ct(i,r)){r++;continue}for(n=l;n<=o;){if(Yt(i,n)){n++;continue}h=Y(r,n,i),t.push(h),n++}r++}return t},s.prototype.isMergedRange=function(e){var t=0,i=this.getRangeData({range:e,sheetIdx:this.parent.activeSheetIndex});for(t=0;t<i.length;t++)if(i[t]&&(i[t].rowSpan||i[t].colSpan))return!0;return!1},s.prototype.addEventListener=function(){this.parent.on(tn,this.createAutoFillElement,this),this.parent.on(Pa,this.positionAutoFillElement,this),this.parent.on(v0,this.hideAutoFillOptions,this),this.parent.on(ql,this.hideAutoFillElement,this),this.parent.on(m0,this.performAutoFill,this),this.parent.on(CM,this.selectAutoFillRange,this),this.parent.on(OA,this.refreshCell,this),this.parent.on(By,this.getautofillDDB,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tn,this.createAutoFillElement),this.parent.off(Pa,this.positionAutoFillElement),this.parent.off(v0,this.hideAutoFillOptions),this.parent.off(ql,this.hideAutoFillElement),this.parent.off(m0,this.performAutoFill),this.parent.off(CM,this.selectAutoFillRange),this.parent.off(OA,this.refreshCell),this.parent.off(By,this.getautofillDDB))},s.prototype.destroy=function(){this.removeEventListener(),this.autoFillElement=null,this.autoFillElementPosition=null,this.autoFillCell=null,this.autoFillDropDown=null,this.isVerticalFill=null,this.fillOptionIndex=null,this.parent=null},s.prototype.getModuleName=function(){return"autofill"},s}(),_I=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jM=function(){return jM=Object.assign||function(s){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},jM.apply(this,arguments)},mr=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},VY=function(s){_I(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return mr([S("")],e.prototype,"text",void 0),mr([S("")],e.prototype,"iconCss",void 0),mr([S("left")],e.prototype,"iconPosition",void 0),e}(ke),jk=function(s){_I(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return mr([Ee({},VY)],e.prototype,"header",void 0),mr([ii([],VI)],e.prototype,"content",void 0),mr([S("")],e.prototype,"cssClass",void 0),mr([S(!1)],e.prototype,"disabled",void 0),e}(ke),UY=function(s){_I(e,s);function e(t,i){return s.call(this,t)||this}return e.prototype.preRender=function(){},e.prototype.render=function(){this.element.id||(this.element.id=mi("ribbon")),this.renderRibbon()},e.prototype.destroy=function(){var t=this.element.querySelector(".e-drop-icon");if(t&&t.removeEventListener("click",this.ribbonExpandCollapse.bind(this)),this.menuItems.length){var i=document.getElementById(this.element.id+"_menu");i&&Ct(i,"menu").destroy()}this.toolbarObj.destroy(),this.tabObj.destroy(),this.element.innerHTML="",this.toolbarObj=null,this.tabObj=null,s.prototype.destroy.call(this)},e.prototype.getTabItems=function(){var t=this,i=[];return this.menuItems.length&&i.push({header:{text:this.initMenu(this.menuItems)},content:this.toolbarObj.element,cssClass:"e-menu-tab"}),this.items.forEach(function(r){i.push({header:r.header,content:t.toolbarObj.element})}),i},e.prototype.initMenu=function(t){var i=this,r=this.createElement("ul",{id:this.element.id+"_menu"});this.element.appendChild(r);var n=new rc({cssClass:"e-file-menu",items:t,showItemOnClick:!0,beforeOpen:function(a){a.parentItem.text===t[0].text&&(n.showItemOnClick=!1),i.trigger("beforeOpen",a)},select:function(a){i.trigger("fileMenuItemSelect",a)},beforeClose:function(a){if(a.event.type==="mouseover"&&!U(a.event.target,".e-menu-popup")){a.cancel=!0;return}i.trigger("beforeClose",a),(!a.parentItem||a.parentItem.text===t[0].text)&&n.setProperties({showItemOnClick:!0},!0)},beforeItemRender:function(a){i.trigger("beforeFileMenuItemRender",a)},created:function(){n.element.removeAttribute("tabindex");var a=n.element.querySelector(".e-menu-item");a&&a.removeAttribute("tabindex")}});return n.createElement=this.createElement,n.appendTo(r),r.parentElement},e.prototype.renderRibbon=function(){var t=this,i=this.createElement("div"),r=this.createElement("div"),n;this.toolbarObj=new ov({items:this.items[this.selectedTab].content,clicked:function(o){return t.trigger("clicked",o)}}),this.toolbarObj.createElement=this.createElement,this.toolbarObj.appendTo(r),this.tabObj=new UI({selectedItem:this.getIndex(this.selectedTab),animation:{next:{duration:0},previous:{duration:0}},items:this.getTabItems(),selecting:function(o){if(o.isSwiped){o.cancel=!0;return}if(n=o.event&&o.event.isShortcut,t.menuItems.length&&o.selectingIndex===0){if(o.cancel=!0,(!o.event||n||o.event.type==="keydown")&&o.selectingItem){var l=o.selectingItem.querySelector(".e-file-menu .e-menu-item");l&&l.click()}}else{if(o.selectingIndex===t.getIndex(t.selectedTab))return;t.updateToolbar(t.getIndex(o.selectingIndex,!0)),t.toolbarObj.dataBind(),t.element.classList.contains("e-collapsed")&&I.remove(o.selectedItem,"click",t.ribbonExpandCollapse);var h=void 0;t.menuItems.length?(h=jM({},o),h.selectingIndex-=1,h.selectedIndex-=1):h=o,t.trigger("selecting",h)}},selected:function(o){!o.isInteracted&&!n&&(o.preventFocus=!0),o.selectedIndex!==t.getIndex(t.selectedTab)&&(t.setProperties({selectedTab:t.getIndex(o.selectedIndex,!0)},!0),t.element.classList.contains("e-collapsed")&&(t.element.classList.remove("e-collapsed"),t.trigger("expandCollapse",{element:t.toolbarObj.element,expanded:!0})))},created:function(){t.toolbarObj.refreshOverflow()}}),this.element.appendChild(i),this.tabObj.createElement=this.createElement,this.tabObj.appendTo(i);var a=this.createElement("span",{className:"e-drop-icon e-icons"});a.addEventListener("click",this.ribbonExpandCollapse.bind(this)),this.element.appendChild(a)},e.prototype.ribbonExpandCollapse=function(t){var i={element:this.toolbarObj.element,expanded:!0},r;this.element.classList.contains("e-collapsed")?(r=this.tabObj.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[this.tabObj.selectedItem],this.element.classList.remove("e-collapsed"),r.classList.add("e-active"),I.remove(r,"click",this.ribbonExpandCollapse),this.trigger("expandCollapse",i)):(r=this.tabObj.element.querySelector(".e-tab-header .e-toolbar-item.e-active"),this.element.classList.add("e-collapsed"),i.expanded=!1,r.classList.remove("e-active"),I.add(r,"click",this.ribbonExpandCollapse,this),this.trigger("expandCollapse",i))},e.prototype.getIndex=function(t,i){return this.menuItems.length?i?t-1:t+1:t},e.prototype.updateToolbar=function(t){this.toolbarObj.items=this.items[t].content,this.toolbarObj.dataBind()},e.prototype.enableMenuItems=function(t,i,r){i===void 0&&(i=!0),this.menuItems.length&&Ct(document.getElementById(this.element.id+"_menu"),"menu").enableItems(t,i,r)},e.prototype.hideMenuItems=function(t,i,r){if(i===void 0&&(i=!0),!!this.menuItems.length){var n=Ct(document.getElementById(this.element.id+"_menu"),"menu");i?n.hideItems(t,r):n.showItems(t,r)}},e.prototype.addMenuItems=function(t,i,r,n){if(r===void 0&&(r=!0),!!this.menuItems.length){var a=Ct(document.getElementById(this.element.id+"_menu"),"menu");r?a.insertAfter(t.reverse(),i,n):a.insertBefore(t,i,n)}},e.prototype.hideTabs=function(t,i){var r=this;i===void 0&&(i=!0);var n,a,o,l;if(i||(l=this.isAllHidden()),t.forEach(function(u){n=r.getTabIndex(u,-1),n>-1&&(i?r.items[n].cssClass.includes(" e-hide")||(r.items[n].cssClass=r.items[n].cssClass+" e-hide",r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,a===void 0&&n===r.selectedTab&&(a=!0),o=!0):r.items[n].cssClass.includes(" e-hide")&&(r.items[n].cssClass=r.items[n].cssClass.replace(" e-hide",""),r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,a===void 0&&n===r.selectedTab&&(a=!0),o=!0))}),this.setProperties({items:this.items},!0),this.tabObj.items=this.tabObj.items,this.tabObj.dataBind(),i&&(l=this.isAllHidden(),l&&(a=!1)),!i&&l&&(a=!a),o&&l&&(this.element.classList.contains("e-collapsed")?(this.element.classList.remove("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.remove("e-hide")):(this.element.classList.add("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.add("e-hide"))),a){for(var h=0;h<this.items.length;h++)if(!this.items[h].cssClass.includes(" e-hide")){this.tabObj.selectedItem=this.getIndex(h),this.tabObj.dataBind();break}}},e.prototype.isAllHidden=function(){for(var t=!0,i=0;i<this.items.length;i++)if(!this.items[i].cssClass.includes(" e-hide")){t=!1;break}return t},e.prototype.enableTabs=function(t,i){var r=this;i===void 0&&(i=!0),t.forEach(function(n){var a=r.getTabIndex(n,-1);a>-1&&(r.items[a].disabled=!i,a=r.getIndex(a),r.tabObj.enableTab(a,i))}),this.setProperties({items:this.items},!0)},e.prototype.addTabs=function(t,i){var r=this,n=this.getTabIndex(i);t.forEach(function(a){a=new jk(r.items[0],"items",a,!0),r.items.splice(n,0,a),r.tabObj.addTab([{header:a.header,content:r.toolbarObj.element}],r.getIndex(n)),n++}),this.setProperties({items:this.items},!0),this.setProperties({selectedTab:this.getIndex(this.tabObj.selectedItem,!0)},!0)},e.prototype.getTabIndex=function(t,i){if(i===void 0&&(i=this.items.length),t){for(var r=0;r<this.items.length;r++)if(this.items[r].header.text===t){i=r;break}}return i},e.prototype.addToolbarItems=function(t,i,r){var n=this,a=this.getTabIndex(t);m(r)&&(r=this.items[a].content.length),i.forEach(function(o){o=new VI(n.items[a].content[0],"content",o,!0),n.items[a].content.splice(r,0,o),r++}),this.setProperties({items:this.items},!0),a===this.selectedTab&&i.length&&this.updateToolbar(a)},e.prototype.enableItems=function(t,i,r){if(r===void 0&&(r=!0),i){var n=this.getTabIndex(t,-1);if(n<0)return;for(var a=0;a<i.length;a++){if(typeof i[a]=="string"){for(var o=0;o<this.items[n].content.length;o++)if(this.items[n].content[o].id===i[a]){i[a]=o;break}}if(typeof i[a]=="string"){if(i.length-1>a)continue;return}this.items[n].content[i[a]].disabled=!r,this.setProperties({items:this.items},!0),n===this.selectedTab&&this.toolbarObj.enableItems(i[a],r)}}else this.toolbarObj.disable(!r)},e.prototype.hideToolbarItems=function(t,i,r){var n=this;r===void 0&&(r=!0);for(var a,o,l=0;l<this.items.length;l++)if(this.items[l].header.text===t){a=l,i.forEach(function(h){o=n.items[a].content[h],o&&(r?o.cssClass.includes(" e-hide")||(o.cssClass=o.cssClass+" e-hide"):o.cssClass.includes(" e-hide")&&(o.cssClass=o.cssClass.replace(" e-hide","")))});break}this.setProperties({items:this.items},!0),a!==void 0&&a===this.selectedTab&&this.updateToolbar(a)},e.prototype.getModuleName=function(){return"ribbon"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"selectedTab":this.tabObj.selectedItem=this.getIndex(t.selectedTab),this.tabObj.dataBind();break}}},mr([S("")],e.prototype,"cssClass",void 0),mr([S(!0)],e.prototype,"menuType",void 0),mr([ii([],ef)],e.prototype,"menuItems",void 0),mr([S(0)],e.prototype,"selectedTab",void 0),mr([ii([],jk)],e.prototype,"items",void 0),mr([_()],e.prototype,"selecting",void 0),mr([_()],e.prototype,"fileMenuItemSelect",void 0),mr([_()],e.prototype,"beforeFileMenuItemRender",void 0),mr([_()],e.prototype,"beforeOpen",void 0),mr([_()],e.prototype,"beforeClose",void 0),mr([_()],e.prototype,"selectFormat",void 0),mr([_()],e.prototype,"clicked",void 0),mr([_()],e.prototype,"created",void 0),mr([_()],e.prototype,"expandCollapse",void 0),e=mr([Ot],e),e}(Pi),_Y=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.render=function(){var e=this,t=this.parent.element.id,i=this.parent.createElement("input",{attrs:{type:"color"}}),r=function(n){n.element.tabIndex=-1};this.fontColorPicker=new PM({value:"#000000ff",mode:"Palette",showButtons:!1,presetColors:Z6,enableOpacity:!1,cssClass:"e-spreadsheet-color-popup",beforeTileRender:r,beforeClose:function(){return e.beforeCloseHandler(e.fontColorPicker)},open:this.openHandler.bind(this),beforeModeSwitch:function(n){return e.beforeModeSwitch(e.fontColorPicker,n)},change:function(n){var a=e.fontColorPicker.getValue(n.currentValue.rgba),o={style:{color:a},onActionUpdate:!0};e.parent.notify(Ri,o),o.cancel?e.fontColorPicker.setProperties({value:e.fontColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):e.updateSelectedColor(o.style.color,e.fontColorPicker.element,"TextColor")},created:function(){return e.updateSelectedColor("#000000",e.fontColorPicker.element,"TextColor",!0)}}),this.fontColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.fontColorPicker.appendTo(i),i.parentElement.id=t+"_font_color_picker",Q([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-font-color"]),i=this.parent.createElement("input",{attrs:{type:"color"}}),this.filColorPicker=new PM({value:"#ffff00ff",mode:"Palette",presetColors:J6,showButtons:!1,enableOpacity:!1,cssClass:"e-spreadsheet-color-popup",open:this.openHandler.bind(this),beforeTileRender:r,beforeClose:function(){return e.beforeCloseHandler(e.filColorPicker)},beforeModeSwitch:function(n){return e.beforeModeSwitch(e.filColorPicker,n)},change:function(n){var a=e.filColorPicker.getValue(n.currentValue.rgba),o={style:{backgroundColor:a},onActionUpdate:!0};e.parent.notify(Ri,o),o.cancel?e.filColorPicker.setProperties({value:e.filColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):e.updateSelectedColor(o.style.backgroundColor,e.filColorPicker.element,"FillColor")},created:function(){return e.updateSelectedColor("#ffff00",e.filColorPicker.element,"FillColor",!0)}}),this.filColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.filColorPicker.appendTo(i),i.parentElement.id=t+"_fill_color_picker",Q([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-fill-color"])},s.prototype.updateSelectedColor=function(e,t,i,r){var n=this.parent.serviceLocator.getService(de).getConstant(i);r&&t.parentElement.querySelector(".e-dropdown-btn").setAttribute("aria-label",n);var a=t.parentElement.querySelector(".e-split-colorpicker");a.setAttribute("aria-label",n+" "+e),a.firstElementChild.style.borderBottomColor=e},s.prototype.openHandler=function(e){e.element.querySelector(".e-mode-switch-btn").title=this.parent.serviceLocator.getService(de).getConstant("MoreColors")},s.prototype.beforeCloseHandler=function(e){e.modeSwitcher||e.setProperties({modeSwitcher:!0},!0),e.showButtons&&e.setProperties({showButtons:!1},!0),Fe(e.element.parentElement.querySelector(".e-split-colorpicker"))},s.prototype.beforeModeSwitch=function(e,t){var i=this.parent.serviceLocator.getService(de);t.mode==="Picker"?(e.showButtons=!0,e.dataBind(),t.element.querySelector(".e-apply").title=i.getConstant("Apply"),t.element.querySelector(".e-cancel").title=i.getConstant("Cancel"),t.element.querySelector(".e-mode-switch-btn").title=i.getConstant("StandardColors")):(e.showButtons=!1,e.dataBind(),t.element.querySelector(".e-mode-switch-btn").title=i.getConstant("MoreColors"))},s.prototype.destroy=function(){this.parent&&(this.removeEventListener(),this.fontColorPicker&&this.fontColorPicker.destroy(),this.fontColorPicker=null,this.filColorPicker&&this.filColorPicker.destroy(),this.filColorPicker=null,this.parent=null)},s.prototype.addEventListener=function(){this.parent.on(W1,this.render,this),this.parent.on("destroyRibbonComponents",this.destroy,this),this.parent.on(Dn,this.destroy,this)},s.prototype.removeEventListener=function(){this.parent.off(W1,this.render),this.parent.off("destroyRibbonComponents",this.destroy),this.parent.on(Dn,this.destroy,this)},s}(),WY=function(){function s(e){this.border="1px solid #000000",this.fontNameIndex=5,this.numPopupWidth=0,this.preTabIdx=1,this.parent=e,this.addEventListener(),new _Y(e)}return s.prototype.getModuleName=function(){return"ribbon"},s.prototype.ribbonOperation=function(e){e&&e.onPropertyChange?this.onPropertyChanged(e.prop):this.initialize()},s.prototype.initialize=function(e){if(this.parent.notify(W1,{}),this.parent.isMobileView())this.createMobileView();else{var t=e&&(this.parent.element.querySelector(".e-formula-bar-panel")||document.getElementById(this.parent.element.id+"_sheet_panel"));this.createRibbon(t)}},s.prototype.getRibbonMenuItems=function(){var e=this.parent.serviceLocator.getService(de),t=this.parent.element.id;return[{text:this.parent.isMobileView()?"":e.getConstant("File"),iconCss:this.parent.isMobileView()?"e-icons e-file-menu-icon":null,id:t+"_File",items:[{text:e.getConstant("New"),id:t+"_New",iconCss:"e-new e-icons"},{text:e.getConstant("Open"),id:t+"_Open",iconCss:"e-open e-icons"},{text:e.getConstant("SaveAs"),iconCss:"e-save e-icons",id:t+"_Save_As",items:[{text:e.getConstant("ExcelXlsx"),id:t+"_Xlsx",iconCss:"e-xlsx e-icons"},{text:e.getConstant("ExcelXls"),id:t+"_Xls",iconCss:"e-xls e-icons"},{text:e.getConstant("CSV"),id:t+"_Csv",iconCss:"e-csv e-icons"},{text:e.getConstant("PDF"),id:t+"_Pdf",iconCss:"e-pdf e-icons"}]}]}]},s.prototype.getRibbonItems=function(){var e=this,t=this.parent.element.id,i=this.parent.serviceLocator.getService(de),r=[{header:{text:i.getConstant("Home")},content:[{prefixIcon:"e-undo-icon",tooltipText:i.getConstant("Undo")+" (Ctrl+Z)",htmlAttributes:{"aria-label":i.getConstant("Undo")},id:t+"_undo",disabled:!0},{prefixIcon:"e-redo-icon",tooltipText:i.getConstant("Redo")+" (Ctrl+Y)",htmlAttributes:{"aria-label":i.getConstant("Redo")},id:t+"_redo",disabled:!0},{type:"Separator",id:t+"_separator_1"},{prefixIcon:"e-cut-icon",tooltipText:i.getConstant("Cut")+" (Ctrl+X)",htmlAttributes:{"aria-label":i.getConstant("Cut")},id:t+"_cut"},{prefixIcon:"e-copy-icon",tooltipText:i.getConstant("Copy")+" (Ctrl+C)",htmlAttributes:{"aria-label":i.getConstant("Copy")},id:t+"_copy"},{tooltipText:i.getConstant("Paste")+" (Ctrl+V)",template:this.getPasteBtn(t,i),id:t+"_paste",disabled:!0},{type:"Separator",id:t+"_separator_2"},{template:this.getNumFormatDDB(t,i),tooltipText:i.getConstant("NumberFormat"),id:t+"_number_format"},{type:"Separator",id:t+"_separator_3"},{template:this.getFontNameDDB(t),tooltipText:i.getConstant("Font"),id:t+"_font_name"},{type:"Separator",id:t+"_separator_4"},{template:this.getFontSizeDDB(t),tooltipText:i.getConstant("FontSize"),id:t+"_font_size"},{type:"Separator",id:t+"_separator_5"},{template:this.getBtn(t,"bold",i.getConstant("Bold")),tooltipText:i.getConstant("Bold")+" (Ctrl+B)",id:t+"_bold"},{template:this.getBtn(t,"italic",i.getConstant("Italic")),tooltipText:i.getConstant("Italic")+" (Ctrl+I)",id:t+"_italic"},{template:this.getBtn(t,"line-through",i.getConstant("Strikethrough")),tooltipText:i.getConstant("Strikethrough")+" (Ctrl+5)",id:t+"_line-through"},{template:this.getBtn(t,"underline",i.getConstant("Underline")),tooltipText:i.getConstant("Underline")+" (Ctrl+U)",id:t+"_underline"},{template:document.getElementById(t+"_font_color_picker"),tooltipText:i.getConstant("TextColor"),id:t+"_font_color_picker"},{type:"Separator",id:t+"_separator_6"},{template:document.getElementById(t+"_fill_color_picker"),tooltipText:i.getConstant("FillColor"),id:t+"_fill_color_picker"},{template:this.getBordersDBB(t),tooltipText:i.getConstant("Borders"),id:t+"_borders"},{template:this.getMergeSplitBtn(t),tooltipText:i.getConstant("MergeCells"),htmlAttributes:{"aria-label":i.getConstant("MergeCells")},id:t+"_merge_cells",disabled:!0},{type:"Separator",id:t+"_separator_7"},{template:this.getTextAlignDDB(t),tooltipText:i.getConstant("HorizontalAlignment"),id:t+"_text_align"},{template:this.getVerticalAlignDDB(t),tooltipText:i.getConstant("VerticalAlignment"),id:t+"_vertical_align"},{template:this.getBtn(t,"wrap",i.getConstant("WrapText"),!1),tooltipText:""+i.getConstant("WrapText"),id:t+"_wrap"}]},{header:{text:i.getConstant("Insert")},content:[{prefixIcon:"e-hyperlink-icon",text:i.getConstant("Link"),id:t+"_hyperlink",tooltipText:i.getConstant("Link"),click:function(){e.getHyperlinkDlg()}},{prefixIcon:"e-image-icon",text:i.getConstant("Image"),id:t+"_image",tooltipText:i.getConstant("Image"),click:function(){$("#"+t+"_imageUpload",e.parent.element).click()}}]},{header:{text:i.getConstant("Formulas")},content:[{prefixIcon:"e-insert-function",tooltipText:i.getConstant("InsertFunction"),text:i.getConstant("InsertFunction"),id:t+"_insert_function"}]},{header:{text:i.getConstant("Data")},content:[{prefixIcon:"e-protect-icon",text:i.getConstant("ProtectSheet"),id:t+"_protect",tooltipText:i.getConstant("ProtectSheet")},{prefixIcon:"e-password-protect-icon",text:i.getConstant("ProtectWorkbook"),id:t+"_protectworkbook",tooltipText:i.getConstant("ProtectWorkbook")},{type:"Separator",id:t+"_separator_8"},{template:this.datavalidationDDB(t),tooltipText:i.getConstant("DataValidation"),id:t+"_datavalidation"}]},{header:{text:i.getConstant("View")},content:[{prefixIcon:"e-hide-headers",text:this.getLocaleText("Headers"),id:t+"_headers",tooltipText:this.getLocaleText("Headers")},{type:"Separator",id:t+"_separator_9"},{prefixIcon:"e-hide-gridlines",text:this.getLocaleText("GridLines"),id:t+"_gridlines",tooltipText:this.getLocaleText("GridLines")},{type:"Separator",id:t+"_separator_13"},{prefixIcon:"e-freeze-pane",text:i.getConstant("FreezePanes"),id:t+"_freezepanes",tooltipText:i.getConstant("FreezePanes"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-row",text:i.getConstant("FreezeRows"),id:t+"_freezerows",tooltipText:i.getConstant("FreezeRows"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-column",text:i.getConstant("FreezeColumns"),id:t+"_freezecolumns",tooltipText:i.getConstant("FreezeColumns"),disabled:!this.parent.allowFreezePane}]}];return this.parent.allowConditionalFormat&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:t+"_separator_10"},{template:this.getCFDBB(t),tooltipText:i.getConstant("ConditionalFormatting"),id:t+"_conditionalformatting"}),this.parent.allowChart&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Insert")}).content.push({type:"Separator",id:t+"_separator_11"},{template:this.getChartDDB(t,!0),text:i.getConstant("Chart"),tooltipText:i.getConstant("Chart"),id:t+"_chart"}),this.parent.allowCellFormatting&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:t+"_separator_12"},{template:this.getClearDDB(t),tooltipText:i.getConstant("Clear"),id:t+"_clear"}),(this.parent.allowSorting||this.parent.allowFiltering)&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getSortFilterDDB(t),tooltipText:i.getConstant("SortAndFilter"),id:t+"_sorting"}),this.parent.allowFindAndReplace&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getFindBtn(t),prefixIcon:"e-tbar-search-icon tb-icons",tooltipText:i.getConstant("FindReplaceTooltip"),id:t+"_find"}),r},s.prototype.getPasteBtn=function(e,t){var i=this,r=this.parent.element.appendChild(this.parent.createElement("button",{id:e+"_paste",attrs:{type:"button"}}));return this.pasteSplitBtn=new FM({iconCss:"e-icons e-paste-icon",items:[{text:t.getConstant("All"),id:"All"},{text:t.getConstant("Values"),id:"Values"},{text:t.getConstant("Formats"),id:"Formats"}],createPopupOnClick:!0,select:function(n){i.pasteSplitBtn.element.setAttribute("aria-label",t.getConstant("Paste")+" "+n.item.text),i.parent.notify(Ia,{type:n.item.id,isAction:!0,isInternal:!0})},click:function(){r.setAttribute("aria-label",t.getConstant("Paste")),i.parent.notify(Ia,{isAction:!0,isInternal:!0})},beforeOpen:function(n){n.element.setAttribute("aria-label",t.getConstant("Paste"))}}),this.pasteSplitBtn.createElement=this.parent.createElement,this.pasteSplitBtn.appendTo(r),r.parentElement},s.prototype.getHyperlinkDlg=function(){var e=ee(this.parent.getActiveSheet().activeCell),t=this.parent.sheets[this.parent.activeSheetIndex].rows[e[0]],i;m(t)||(i=t.cells[e[1]]),m(i)&&Ht(e[0],e[1],this.parent.getActiveSheet(),i,!1),i&&i.hyperlink?this.parent.notify($f,null):this.parent.notify(Gf,null)},s.prototype.passwordProtectDlg=function(){this.parent.password.length>0?this.parent.notify(p0,null):document.getElementById(this.parent.element.id+"_protectworkbook").classList.contains("e-active")?(document.getElementById(this.parent.element.id+"_protectworkbook").classList.remove("e-active"),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled")):this.parent.notify(d0,null)},s.prototype.getLocaleText=function(e){var t,i=this.parent.serviceLocator.getService(de),r=this.parent.getActiveSheet();return r["show"+e]?t=i.getConstant("Hide"+e):t=i.getConstant("Show"+e),t},s.prototype.getLocaleProtectText=function(e,t){var i,r=this.parent.serviceLocator.getService(de),n=this.parent.getActiveSheet();return n.isProtected?(t&&this.parent.getMainContent().classList.remove("e-hide-"+e.toLowerCase()),i=r.getConstant("Unprotect"+e)):(t&&this.parent.getMainContent().classList.add("e-hide-"+e.toLowerCase()),i=r.getConstant("Protect"+e)),i},s.prototype.getLocaleProtectWorkbook=function(e,t){var i,r=this.parent.serviceLocator.getService(de);return this.parent.isProtected?(t&&this.parent.getMainContent().classList.remove("e-hide-"+e.toLowerCase()),i=r.getConstant(e)):(t&&this.parent.getMainContent().classList.add("e-hide-"+e.toLowerCase()),i=r.getConstant(e)),i},s.prototype.insertDesignChart=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.ribbon.items.length-1,r=t.getConstant("ChartDesign");if(this.parent.allowChart&&this.ribbon.items[i]&&this.ribbon.items[i].header.text!==r){this.preTabIdx=this.ribbon.selectedTab;var n=this.parent.element.id,a=[{header:{text:r},content:[{template:this.getAddChartEleDBB(n),tooltipText:t.getConstant("AddChartElement"),id:n+"add_chart_ element_chart"},{type:"Separator"},{prefixIcon:"e-switch-row-column-icon",text:t.getConstant("SwitchRowColumn"),tooltipText:t.getConstant("SwitchRowColumn"),id:n+"switch_row_column_chart",click:function(){e.parent.notify(Yh,{switchRowColumn:!0,triggerEvent:!0})}},{type:"Separator"},{template:this.getChartThemeDDB(n),tooltipText:t.getConstant("ChartTheme"),id:n+"_chart_theme"},{type:"Separator"},{template:this.getChartDDB(n,!1),tooltipText:t.getConstant("ChartType"),id:n+"_chart_type"}]}];this.addRibbonTabs({items:a}),this.ribbon.tabObj.select(this.ribbon.items.length)}},s.prototype.removeDesignChart=function(){var e=this.parent.serviceLocator.getService(de),t=this.ribbon.items.length-1;this.ribbon.items[t]&&this.ribbon.items[t].header.text===e.getConstant("ChartDesign")&&(this.ribbon.tabObj.select(this.preTabIdx+1),this.parent.hideRibbonTabs([e.getConstant("ChartDesign")],!0),document.getElementsByClassName("e-addchart-ddb").length>0&&document.getElementsByClassName("e-addchart-ddb")[0].remove(),document.getElementsByClassName("e-chart-type-ddb").length>0&&document.getElementsByClassName("e-chart-type-ddb")[0].remove(),document.getElementsByClassName("e-charttheme-ddb").length>0&&document.getElementsByClassName("e-charttheme-ddb")[0].remove(),delete this.ribbon.items[t].content[0],this.ribbon.items.length=this.ribbon.items.length-1)},s.prototype.createRibbon=function(e){var t=this.parent.createElement("div",{id:this.parent.element.id+"_ribbon"});this.ribbon=new UY({selectedTab:0,menuItems:this.getRibbonMenuItems(),items:this.getRibbonItems(),fileMenuItemSelect:this.fileMenuItemSelect.bind(this),beforeOpen:this.fileMenuBeforeOpen.bind(this),beforeClose:this.fileMenuBeforeClose.bind(this),clicked:this.toolbarClicked.bind(this),created:this.ribbonCreated.bind(this),selecting:this.tabSelecting.bind(this),expandCollapse:this.expandCollapseHandler.bind(this),beforeFileMenuItemRender:this.beforeRenderHandler.bind(this)}),this.ribbon.createElement=this.parent.createElement,e?this.parent.element.insertBefore(t,e):this.parent.element.appendChild(t),this.ribbon.appendTo(t)},s.prototype.tabSelecting=function(e){if(e.selectingIndex!==this.ribbon.selectedTab){var t=this.parent.serviceLocator.getService(de);if(this.ribbon.items[e.selectingIndex]&&this.ribbon.items[e.selectingIndex].header.text===t.getConstant("Insert")&&this.createChartDdb(document.getElementById(this.parent.element.id+"_chart-btn"),!0),this.ribbon.items[e.selectedIndex]&&this.ribbon.items[e.selectedIndex].header.text===t.getConstant("Insert")){for(var i=this.ribbon.items[e.selectedIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&n.classList.contains("e-dropdown-btn")&&this.destroyComponent(n,"dropdown-btn");break}}this.refreshRibbonContent(e.selectingIndex),this.parent.notify(k1,{activeTab:e.selectingIndex})}},s.prototype.beforeRenderHandler=function(e){var t=this.parent.serviceLocator.getService(de);e.item.text===t.getConstant("Open")&&(!this.parent.openUrl||!this.parent.allowOpen)&&e.element.classList.add("e-disabled"),e.item.text===t.getConstant("SaveAs")&&(!this.parent.saveUrl||!this.parent.allowSave)&&e.element.classList.add("e-disabled")},s.prototype.getChartThemeDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("button",{id:e+"_chart_theme",attrs:{type:"button"},className:"e-ss-ddb"});r.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"}));var n="Material",a=this.parent.element.querySelector(".e-ss-overlay-active");if(a){var o=a.querySelector(".e-chart");o?n=Ct(o,"chart").theme:(o=a.querySelector(".e-accumulationchart"),o&&(n=Ct(o,"accumulationchart").theme))}var l=new Or({items:this.getChartThemeDdbItems(n),content:i.getConstant("Material"),createPopupOnClick:!0,select:function(h){t.parent.notify(Gs,{type:"mousedown"}),(!h.element||!h.element.querySelector(".e-selected-icon"))&&(l.content=h.item.text,l.dataBind(),t.parent.notify(Yh,{chartTheme:h.item.id,triggerEvent:!0}),l.setProperties({items:t.getChartThemeDdbItems(h.item.id)},!0))},cssClass:"e-flat e-charttheme-ddb",beforeOpen:function(h){t.tBarDdbBeforeOpen(h.element,h.items,t.parent.serviceLocator.getService(de).getConstant("Chart"))}});return l.createElement=this.parent.createElement,l.appendTo(r),r},s.prototype.getNumFormatDDB=function(e,t){var i=this,r=this.parent.createElement("button",{id:e+"_number_format",attrs:{type:"button"},className:"e-ss-ddb"}),n=this.parent.createElement("span",{className:"e-tbar-btn-text"});n.innerText=t.getConstant("General"),r.appendChild(n);var a=["General","0","0.00","#,##0","#,##0.00","#,##0_);(#,##0)","#,##0_);[Red](#,##0)","#,##0.00_);(#,##0.00)","#,##0.00_);[Red](#,##0.00)",en.currency[4],en.currency[2],en.currency[3],en.currency[5],"0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","dd-MM-yy","dd-MMM-yy","dd-MMM","MMM-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","dd-MM-yy h:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",en.accounting[1],'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',en.accounting[0],'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'];return this.numFormatDDB=new Or({items:this.getNumFormatDdbItems(e),createPopupOnClick:!0,select:function(o){var l=i.parent.serviceLocator.getService(de);if(o.item.text===l.getConstant("Custom"))i.renderCustomFormatDialog(a);else{var h=o.item.id.split(i.parent.element.id+"_")[1];i.applyNumFormat(Ki(h),o.item.text);var u=i.parent.getActiveSheet(),c=xe(u.activeCell);i.refreshTextAlign(u,Y(c[0],c[1],u,!1,!0),h,c),i.numFormatDDB.element.setAttribute("aria-label",h)}},open:function(o){return i.numDDBOpen(o)},beforeItemRender:function(o){return i.previewNumFormat(o)},cssClass:"e-flat e-numformat-ddb",beforeOpen:function(o){i.tBarDdbBeforeOpen(o.element,o.items,i.parent.serviceLocator.getService(de).getConstant("NumberFormat"))}}),this.numFormatDDB.createElement=this.parent.createElement,this.numFormatDDB.appendTo(r),r},s.prototype.getFontSizeDDB=function(e){var t=this;return this.fontSizeDdb=new Or({cssClass:"e-font-size-ddb",content:"11",createPopupOnClick:!0,items:[{text:"8"},{text:"9"},{text:"10"},{text:"11"},{text:"12"},{text:"14"},{text:"16"},{text:"18"},{text:"20"},{text:"22"},{text:"24"},{text:"26"},{text:"28"},{text:"36"},{text:"48"},{text:"72"}],beforeOpen:function(i){t.tBarDdbBeforeOpen(i.element,i.items,t.parent.serviceLocator.getService(de).getConstant("FontSize")),t.refreshSelected(t.fontSizeDdb,i.element,"content","text")},select:function(i){var r={style:{fontSize:i.item.text+"pt"},onActionUpdate:!0};t.parent.notify(Ri,r),r.cancel||(t.fontSizeDdb.content=r.style.fontSize.split("pt")[0],t.fontSizeDdb.dataBind()),t.fontSizeDdb.element.setAttribute("aria-label",i.item.text)}}),this.fontSizeDdb.createElement=this.parent.createElement,this.fontSizeDdb.appendTo(this.parent.createElement("button",{id:e+"_font_size",attrs:{type:"button"},className:"e-ss-ddb"})),this.fontSizeDdb.element},s.prototype.getChartDDB=function(e,t){var i=this.parent.serviceLocator.getService(de),r;if(t){r=this.parent.createElement("button",{id:e+"_chart-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:e+"_chart"});n.innerText=i.getConstant("Chart"),r.appendChild(n)}else{r=this.parent.createElement("button",{id:e+"_chart-type-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:e+"_chart_type"});n.innerText=i.getConstant("ChartType"),r.appendChild(n),this.createChartDdb(r,!1)}return r},s.prototype.closeDropdownPopup=function(e){if(e.altKey&&e.keyCode===38||e.keyCode===27){var t=this[1];t&&(t.toggle(),Fe(t.element))}},s.prototype.createChartDdb=function(e,t){var i=this,r=this.parent.serviceLocator.getService(de),n=t?"e-chart-menu":"e-chart-type-menu",a=this.parent.createElement("ul",{id:""+this.parent.element.id+(t?"_chart_menu":"_chart_type_menu")}),o,l=new Or({iconCss:"e-icons "+(t?"e-chart-icon":"e-chart-type-icon"),cssClass:t?"e-chart-ddb":"e-chart-type-ddb",target:a,createPopupOnClick:!0,beforeOpen:function(h){o=i.createChartMenu(a,n,r,l),i.tBarDdbBeforeOpen(h.element,o.items,i.parent.serviceLocator.getService(de).getConstant("Chart")),I.add(a,"keydown",i.closeDropdownPopup,[i,l])},open:function(){return Fe(a)},beforeClose:function(h){h.event&&U(h.event.target,"."+n)?h.cancel=!0:(I.remove(a,"keydown",i.closeDropdownPopup),o.destroy())}});l.createElement=this.parent.createElement,l.appendTo(e)},s.prototype.createChartMenu=function(e,t,i,r){var n=this,a=new rc({cssClass:t,items:[{iconCss:"e-icons e-column",text:i.getConstant("Column"),items:[{id:"column_chart"}]},{iconCss:"e-icons e-bar",text:i.getConstant("Bar"),items:[{id:"bar_chart"}]},{iconCss:"e-icons e-area",text:i.getConstant("Area"),items:[{id:"area_chart"}]},{iconCss:"e-icons e-pie-doughnut",text:i.getConstant("PieAndDoughnut"),items:[{id:"pie_doughnut_chart"}]},{iconCss:"e-icons e-line",text:i.getConstant("Line"),items:[{id:"line_chart"}]},{iconCss:"e-icons e-scatter",text:i.getConstant("Scatter"),items:[{id:"scatter_chart"}]}],orientation:"Vertical",beforeOpen:function(Ae){var Be;Ae.parentItem.text===i.getConstant("Column")?(Ae.element.firstChild.appendChild(o),Be="e-column-chart"):Ae.parentItem.text===i.getConstant("Bar")?(Ae.element.firstChild.appendChild(y),Be="e-bar-chart"):Ae.parentItem.text===i.getConstant("Area")?(Ae.element.firstChild.appendChild(L),Be="e-area-chart"):Ae.parentItem.text===i.getConstant("Line")?(Ae.element.firstChild.appendChild(F),Be="e-line-chart"):Ae.parentItem.text===i.getConstant("PieAndDoughnut")?(Ae.element.firstChild.appendChild(Ne),Be="e-pie-doughnut-chart"):Ae.parentItem.text===i.getConstant("Radar")?(Ae.element.firstChild.appendChild(he),Be="e-radar-chart"):Ae.parentItem.text===i.getConstant("Scatter")&&(Ae.element.firstChild.appendChild(si),Be="e-scatter-chart"),Be&&(Ae.element.parentElement.classList.add(Be),I.add(Ae.element,"keydown",n.menuIconKeyDown.bind(n,Be+" .e-menu-icon",0)))},select:function(Ae){return n.chartSelected(Ae,r)},beforeItemRender:function(Ae){Ae.item.text||Ae.element.removeAttribute("tabindex")},beforeClose:function(Ae){Ae.event&&Ae.event.keyCode===37?Ae.cancel=!0:I.remove(Ae.element,"keydown",n.menuIconKeyDown)}}),o=this.parent.createElement("div",{id:"column_main",className:"e-column-main"}),l=this.parent.createElement("div",{id:"column1_text",className:"e-column1-text"});l.innerText=i.getConstant("Column");var h=this.parent.createElement("div",{id:"column1_cont",className:"e-column1-cont"}),u=this.parent.createElement("div",{id:"column2_cont",className:"e-column2-cont"});o.appendChild(l),o.appendChild(h);var c=i.getConstant("ClusteredColumn"),d=this.parent.createElement("span",{id:"clusteredColumn",className:"e-clusteredcolumn e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedColumn");var p=this.parent.createElement("span",{id:"stackedColumn",className:"e-stackedcolumn e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedColumn100");var f=this.parent.createElement("span",{id:"stackedColumn100",className:"e-stackedcolumn100 e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}}),v=this.parent.createElement("span",{id:"clusteredColumn3D",className:"e-clusteredColumn3D e-column-icon"}),g=this.parent.createElement("span",{id:"stackedColumn3D",className:"e-stackedColumn3D e-column-icon"}),b=this.parent.createElement("span",{id:"stackedColumn1003D",className:"e-stackedColumn1003D e-column-icon"});h.appendChild(d),h.appendChild(p),h.appendChild(f),u.appendChild(v),u.appendChild(g),u.appendChild(b);var y=this.parent.createElement("div",{id:"bar_main",className:"e-bar-main"}),C=this.parent.createElement("div",{id:"bar1_text",className:"e-bar1-text"});C.innerText=i.getConstant("Bar");var x=this.parent.createElement("div",{id:"bar1_cont",className:"e-bar1-cont"}),w=this.parent.createElement("div",{id:"bar2_cont",className:"e-bar2-cont"});y.appendChild(C),y.appendChild(x),c=i.getConstant("ClusteredBar");var M=this.parent.createElement("span",{id:"clusteredBar",className:"e-clusteredbar e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedBar");var E=this.parent.createElement("span",{id:"stackedBar",className:"e-stackedbar e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedBar100");var T=this.parent.createElement("span",{id:"stackedBar100",className:"e-stackedbar100 e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}}),D=this.parent.createElement("span",{id:"clusteredBar3D",className:"e-clusteredBar3D e-bar-icon"}),N=this.parent.createElement("span",{id:"stackedBar3D",className:"e-stackedBar3D e-bar-icon"}),A=this.parent.createElement("span",{id:"stackedBar1003D",className:"e-stackedBar1003D e-bar-icon"});x.appendChild(M),x.appendChild(E),x.appendChild(T),w.appendChild(D),w.appendChild(N),w.appendChild(A);var L=this.parent.createElement("div",{id:"area_main",className:"e-area-main"}),k=this.parent.createElement("div",{id:"area_text",className:"e-area-text"});k.innerText=i.getConstant("Area");var O=this.parent.createElement("div",{id:"area_cont",className:"e-area-cont"});L.appendChild(k),L.appendChild(O),c=i.getConstant("Area");var R=this.parent.createElement("span",{id:"area",className:"e-area e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedArea");var j=this.parent.createElement("span",{id:"stackedArea",className:"e-stackedarea e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedArea100");var P=this.parent.createElement("span",{id:"stackedArea100",className:"e-stackedarea100 e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});O.appendChild(R),O.appendChild(j),O.appendChild(P);var F=this.parent.createElement("div",{id:"line_main",className:"e-line-main"}),z=this.parent.createElement("div",{id:"line_text",className:"e-line-text"});z.innerText=i.getConstant("Line");var q=this.parent.createElement("div",{id:"line_cont",className:"e-line-cont"}),X=this.parent.createElement("div",{id:"line_cont_marker",className:"e-line-cont"});F.appendChild(z),F.appendChild(q),F.appendChild(X),c=i.getConstant("Line");var G=this.parent.createElement("span",{id:"line",className:"e-line e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine");var Z=this.parent.createElement("span",{id:"stackedLine",className:"e-stackedline e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine100");var se=this.parent.createElement("span",{id:"stackedLine100",className:"e-stackedline100 e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("LineMarker");var oe=this.parent.createElement("span",{id:"lineMarker",className:"e-line-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLineMarker");var fe=this.parent.createElement("span",{id:"stackedLineMarker",className:"e-stackedline-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine100Marker");var be=this.parent.createElement("span",{id:"stackedLine100Marker",className:"e-stackedline100-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});q.appendChild(G),q.appendChild(Z),q.appendChild(se),X.appendChild(oe),X.appendChild(fe),X.appendChild(be);var Ne=this.parent.createElement("div",{id:"pie_main",className:"e-pie-main"}),we=this.parent.createElement("div",{id:"pie_text",className:"e-pie-text"});we.innerText=i.getConstant("Pie");var H=this.parent.createElement("div",{id:"pie_cont",className:"e-pie-cont"});Ne.appendChild(we),Ne.appendChild(H),c=i.getConstant("Pie");var V=this.parent.createElement("span",{id:"pie",className:"e-pie e-pie-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("Doughnut");var re=this.parent.createElement("span",{id:"doughnut",className:"e-doughnut e-pie-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});H.appendChild(V),H.appendChild(re);var he=this.parent.createElement("div",{id:"radar_main",className:"e-radar-main"}),Ie=this.parent.createElement("div",{id:"radar_text",className:"e-radar-text"});Ie.innerText=i.getConstant("Radar");var Te=this.parent.createElement("div",{id:"radar_cont",className:"e-radar-cont"});he.appendChild(Ie),he.appendChild(Te);var rt=this.parent.createElement("span",{id:"radar",className:"e-radar e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}}),Tt=this.parent.createElement("span",{id:"radar_markers",className:"e-radar-markers e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}});rt.title=i.getConstant("BlueDataBar"),Tt.title=i.getConstant("GreenDataBar"),Te.appendChild(rt),Te.appendChild(Tt);var si=this.parent.createElement("div",{id:"scatter_main",className:"e-scatter-main"}),K=this.parent.createElement("div",{id:"scatter_text",className:"e-scatter-text"});c=i.getConstant("Scatter"),K.innerText=c;var ue=this.parent.createElement("div",{id:"scatter_cont",className:"e-scatter-cont"});si.appendChild(K),si.appendChild(ue);var Me=this.parent.createElement("span",{id:"scatter",className:"e-scatter e-scatter-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});return ue.appendChild(Me),a.createElement=this.parent.createElement,a.appendTo(e),e.classList.add("e-ul"),a},s.prototype.getAddChartEleDBB=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("ul",{id:e+"_add_chart_menu"}),n;this.addChartDdb=new Or({iconCss:"e-icons e-addchart-icon",cssClass:"e-addchart-ddb",target:r,createPopupOnClick:!0,close:function(){return Fe(t.parent.element)},beforeOpen:function(l){n=t.createAddChartMenu(r,i),t.tBarDdbBeforeOpen(l.element,n.items),I.add(r,"keydown",t.closeDropdownPopup,[t,t.addChartDdb])},open:function(){return Fe(r)},beforeClose:function(l){l.event&&U(l.event.target,".e-addchart-menu")?l.cancel=!0:(I.remove(r,"keydown",t.closeDropdownPopup),n.destroy())}}),this.addChartDdb.createElement=this.parent.createElement;var a=this.parent.createElement("button",{id:e+"_addchart",attrs:{type:"button"}}),o=this.parent.createElement("span",{id:e+"_chart"});return o.innerText=i.getConstant("AddChartElement"),a.appendChild(o),this.addChartDdb.appendTo(a),this.addChartDdb.element},s.prototype.createAddChartMenu=function(e,t){var i=this,r=new rc({cssClass:"e-addchart-menu",title:t.getConstant("AddChartElement"),items:[{iconCss:"e-icons e-axes",text:t.getConstant("Axes"),items:[{iconCss:"e-icons e-ph-axes",id:"PHAxes",text:t.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axes",id:"PVAxes",text:t.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-axis-title",text:t.getConstant("AxisTitle"),items:[{iconCss:"e-icons e-ph-axistitle",id:"PHAxisTitle",text:t.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axistitle",id:"PVAxisTitle",text:t.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-chart-title",text:t.getConstant("ChartTitle"),items:[{iconCss:"e-icons e-ct-none",id:"ChartTitleNone",text:t.getConstant("None")},{iconCss:"e-icons e-ct-abovechart",id:"ChartTitleAbove",text:t.getConstant("AboveChart")}]},{iconCss:"e-icons e-data-labels",id:this.parent.element.id+"data-labels",text:t.getConstant("DataLabels"),items:[{iconCss:"e-icons e-dl-none",id:"DLNone",text:t.getConstant("None")},{iconCss:"e-icons e-dl-center",id:"DLCenter",text:t.getConstant("Center")},{iconCss:"e-icons e-dl-insideend",id:"DLInsideend",text:t.getConstant("InsideEnd")},{iconCss:"e-icons e-dl-insidebase",id:"DLInsidebase",text:t.getConstant("InsideBase")},{iconCss:"e-icons e-dl-outsideend",id:"DLOutsideend",text:t.getConstant("OutsideEnd")}]},{iconCss:"e-icons e-gridlines",text:t.getConstant("Gridlines"),items:[{iconCss:"e-icons e-gl-major-horizontal",id:"GLMajorHorizontal",text:t.getConstant("PrimaryMajorHorizontal")},{iconCss:"e-icons e-gl-major-vertical",id:"GLMajorVertical",text:t.getConstant("PrimaryMajorVertical")},{iconCss:"e-icons e-gl-minor-horizontal",id:"GLMinorHorizontal",text:t.getConstant("PrimaryMinorHorizontal")},{iconCss:"e-icons e-gl-minor-vertical",id:"GLMinorVertical",text:t.getConstant("PrimaryMinorVertical")}]},{iconCss:"e-icons e-legends",text:t.getConstant("Legends"),items:[{iconCss:"e-icons e-legends-none",id:"LegendNone",text:t.getConstant("None")},{iconCss:"e-icons e-legends-right",id:"LegendsRight",text:t.getConstant("Right")},{iconCss:"e-icons e-legends-left",id:"LegendsLeft",text:t.getConstant("Left")},{iconCss:"e-icons e-legends-bottom",id:"LegendsBottom",text:t.getConstant("Bottom")},{iconCss:"e-icons e-legends-top",id:"LegendsTop",text:t.getConstant("Top")}]}],orientation:"Vertical",select:this.addChartEleSelected.bind(this),beforeOpen:function(n){if(n.parentItem.id===i.parent.element.id+"data-labels"){var a=i.parent.element.querySelector(".e-ss-overlay-active");if(a){var o=a.querySelector(".e-chart");if(o){var l=Ct(o,"chart");if(l.series[0].type.includes("Line")){var h=function(c,d){if(c){var p=c.parentElement;p.innerHTML="",p.appendChild(c),p.appendChild(document.createTextNode(t.getConstant(d)))}};h(n.element.querySelector(".e-dl-insideend"),"Above"),h(n.element.querySelector(".e-dl-insidebase"),"Below");var u=n.element.querySelector(".e-dl-outsideend");u&&(u.parentElement.style.display="none")}}}}}});return r.createElement=this.parent.createElement,r.appendTo(e),e.classList.add("e-ul"),r},s.prototype.getCFDBB=function(e){var t=this,i=this.parent.createElement("ul",{id:e+"_cf_menu"}),r;return this.cfDdb=new Or({iconCss:"e-icons e-conditionalformatting-icon",cssClass:"e-cf-ddb",target:i,createPopupOnClick:!0,close:function(){return Fe(t.parent.element)},beforeOpen:function(n){r=t.createCFMenu(i),t.tBarDdbBeforeOpen(n.element,r.items,t.parent.serviceLocator.getService(de).getConstant("ConditionalFormatting")),I.add(i,"keydown",t.closeDropdownPopup,[t,t.cfDdb])},open:function(){return Fe(i)},beforeClose:function(n){n.event&&U(n.event.target,".e-cf-menu")?n.cancel=!0:(r.destroy(),I.remove(i,"keydown",t.closeDropdownPopup))}}),this.cfDdb.createElement=this.parent.createElement,this.cfDdb.appendTo(this.parent.createElement("button",{id:e+"_conditionalformatting",attrs:{type:"button"}})),this.cfDdb.element},s.prototype.createCFMenu=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=function(d,p,f){var v;d.forEach(function(g){v=i.getConstant(g+p),f.appendChild(t.parent.createElement("span",{id:g+p,className:"e-"+g.toLowerCase()+" e-cf-icon",attrs:{title:v,"aria-label":v,tabindex:"-1"}}))})},n=new rc({cssClass:"e-cf-menu",items:[{iconCss:"e-icons e-hlcellrules",text:i.getConstant("HighlightCellsRules"),items:[{iconCss:"e-icons e-greaterthan",id:"cf_greaterthan_dlg",text:i.getConstant("GreaterThan")+"..."},{iconCss:"e-icons e-lessthan",id:"cf_lessthan_dlg",text:i.getConstant("LessThan")+"..."},{iconCss:"e-icons e-between",id:"cf_between_dlg",text:i.getConstant("Between")+"..."},{iconCss:"e-icons e-equalto",id:"cf_eqaulto_dlg",text:i.getConstant("CFEqualTo")+"..."},{iconCss:"e-icons e-textcontains",id:"cf_textcontains_dlg",text:i.getConstant("TextThatContains")+"..."},{iconCss:"e-icons e-adateoccuring",id:"cf_adateoccuring_dlg",text:i.getConstant("ADateOccuring")+"..."},{iconCss:"e-icons e-duplicate",id:"cf_duplicatevalues_dlg",text:i.getConstant("DuplicateValues")+"..."}]},{iconCss:"e-icons e-topbottomrules",text:i.getConstant("TopBottomRules"),items:[{iconCss:"e-icons e-top10items",id:"cf_top10items_dlg",text:i.getConstant("Top10Items")+"..."},{iconCss:"e-icons e-top10",id:"cf_top10_dlg",text:i.getConstant("Top10")+" %..."},{iconCss:"e-icons e-bottom10items",id:"cf_bottom10items_dlg",text:i.getConstant("Bottom10Items")+"..."},{iconCss:"e-icons e-bottom10",id:"cf_bottom10_dlg",text:i.getConstant("Bottom10")+" %..."},{iconCss:"e-icons e-aboveaverage",id:"cf_aboveaverage_dlg",text:i.getConstant("AboveAverage")+"..."},{iconCss:"e-icons e-belowaverage",id:"cf_belowaverage_dlg",text:i.getConstant("BelowAverage")+"..."}]},{iconCss:"e-icons e-databars",text:i.getConstant("DataBars"),items:[{id:"db_icons1"},{id:"db_icons2"}]},{iconCss:"e-icons e-colorscales",text:i.getConstant("ColorScales"),items:[{id:"cs_icons1"},{id:"cs_icons2"},{id:"cs_icons3"}]},{iconCss:"e-icons e-iconsets",text:i.getConstant("IconSets"),items:[{id:"is_icons"}]},{iconCss:"e-icons e-clearrules",text:i.getConstant("ClearRules"),items:[{id:"cf_cr_cells",text:i.getConstant("SelectedCells")},{id:"cf_cr_sheet",text:i.getConstant("EntireSheet")}]}],orientation:"Vertical",beforeOpen:function(d){d.parentItem.iconCss==="e-icons e-databars"?(d.element.parentElement.classList.add("e-databars"),r(["Blue","Green","Red"],"DataBar",d.element.firstChild),r(["Orange","LightBlue","Purple"],"DataBar",d.element.lastChild),I.add(d.element,"keydown",t.menuIconKeyDown.bind(t,"e-cf-icon",3))):d.parentItem.iconCss==="e-icons e-colorscales"?(d.element.parentElement.classList.add("e-colorscales"),r(["GYR","RYG","GWR","RWG"],"ColorScale",d.element.firstChild),r(["BWR","RWB","WR","RW"],"ColorScale",d.element.querySelector("#cs_icons2")),r(["GW","WG","GY","YG"],"ColorScale",d.element.lastChild),I.add(d.element,"keydown",t.menuIconKeyDown.bind(t,"e-cf-icon",4))):d.parentItem.iconCss==="e-icons e-iconsets"&&(d.element.parentElement.classList.add("e-iconsets"),d.element.firstChild.appendChild(a),I.add(d.element,"keydown",t.menuIconKeyDown.bind(t,"e-is-wrapper",0)))},select:this.cfSelected.bind(this),beforeItemRender:function(d){(d.item.id.includes("db_icons")||d.item.id.includes("cs_icons")||d.item.id==="is_icons")&&d.element.removeAttribute("tabindex")},beforeClose:function(d){var p=["e-icons e-databars","e-icons e-colorscales","e-icons e-iconsets"].indexOf(d.parentItem.iconCss)>-1;d.cancel=d.event&&d.event.keyCode===37&&p,p&&!d.cancel&&I.remove(d.element,"keydown",t.menuIconKeyDown)}});n.createElement=this.parent.createElement;var a=this.parent.createElement("div",{id:"is",className:"e-is"}),o=[{hdr:"Directional"},{cont:[{cls:"3arrows",key:"ThreeArrowsColor",id:"ThreeArrows",count:3},{cls:"3arrowsgray",key:"ThreeArrowsGray",count:3},{cls:"3triangles",key:"ThreeTriangles",count:3},{cls:"4arrowsgray",key:"FourArrowsGray",count:4},{cls:"4arrows",key:"FourArrowsColor",id:"FourArrows",count:4},{cls:"5arrowsgray",key:"FiveArrowsGray",count:5},{cls:"5arrows",key:"FiveArrowsColor",id:"FiveArrows",count:5}]},{hdr:"Shapes"},{cont:[{cls:"3trafficlights",key:"ThreeTrafficLights1",count:3},{cls:"3rafficlights2",key:"ThreeTrafficLights2",count:3},{cls:"3signs",key:"ThreeSigns",count:3},{cls:"4trafficlights",key:"FourTrafficLights",count:4},{cls:"4redtoblack",key:"RedToBlack",id:"FourRedToBlack",count:4}]},{hdr:"Indicators"},{cont:[{cls:"3symbols",key:"ThreeSymbols1",id:"ThreeSymbols",count:3},{cls:"3symbols2",key:"ThreeSymbols2",count:3},{cls:"3flags",key:"ThreeFlags",count:3}]},{hdr:"Ratings"},{cont:[{cls:"3stars",key:"ThreeStars",count:3},{cls:"4rating",key:"FourRatings",id:"FourRating",count:4},{cls:"5quarters",key:"FiveQuarters",count:5},{cls:"5rating",key:"FiveRatings",id:"FiveRating",count:5},{cls:"5boxes",key:"FiveBoxes",count:5}]}],l,h,u,c;return o.forEach(function(d,p){l=t.parent.createElement("div",{id:"is"+(p+1),className:"e-is"+(p+1)}),d.hdr?l.innerText=i.getConstant(d.hdr):d.cont.forEach(function(f){for(u=i.getConstant(f.key),h=t.parent.createElement("div",{id:f.id||f.key,className:"e-"+f.cls+" e-is-wrapper",attrs:{title:u,"aria-label":u,tabindex:"-1"}}),c=0;c<f.count;c++)h.appendChild(t.createElement("span","e-"+f.cls+"-"+(c+1)+" e-iconsetspan"));l.appendChild(h)}),a.appendChild(l)}),n.createElement=this.parent.createElement,n.appendTo(e),e.classList.add("e-ul"),n},s.prototype.menuIconKeyDown=function(e,t,i){var r,n=[];if(!i)r=0,n=[].slice.call(document.querySelectorAll("."+e));else if(i.keyCode===40||i.keyCode===39||i.keyCode===38||i.keyCode===37){if(i.preventDefault(),n=[].slice.call(document.querySelectorAll("."+e)),r=n.indexOf(i.target),r===-1)r=0;else if(i.keyCode===39)r++,r===n.length&&(r=0);else if(i.keyCode===37)r--,r===-1&&(r=n.length-1);else if(!e.includes("e-menu-icon")){var a=n.length,o=void 0,l=void 0;t||(t=2,i.keyCode===40?(o=[6,11,14,19],l=[5,10,13]):(o=[7,12,15],l=[8,13,16]),a--),i.keyCode===40?r===a-1?r=0:(r+=o&&o.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:t,o&&a++,r>=a&&(r=r-a+1)):r===0?r=a-1:(r-=o&&o.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:t,r<0&&(r=o?a:a+r-1))}}n[r]&&Fe(n[r])},s.prototype.createElement=function(e,t){return this.parent.createElement(e,{className:t})},s.prototype.getBordersDBB=function(e){var t=this,i=this.parent.createElement("ul",{id:e+"_borders_menu"});this.cPickerEle=this.parent.createElement("input",{id:e+"_cell_border_color",attrs:{type:"color"}}),this.parent.element.appendChild(this.cPickerEle),this.colorPicker=new PM({cssClass:"e-border-colorpicker",mode:"Palette",inline:!0,beforeTileRender:function(n){n.element.tabIndex=-1},change:function(n){var a=t.border.split(" ");a[2]=n.currentValue.hex,t.border=a.join(" ")}}),this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(this.cPickerEle);var r;return this.bordersDdb=new Or({iconCss:"e-icons e-bottom-borders",cssClass:"e-borders-ddb",target:i,createPopupOnClick:!0,beforeOpen:function(n){r=t.createBorderMenu(i),t.tBarDdbBeforeOpen(n.element,r.items,t.parent.serviceLocator.getService(de).getConstant("Borders"),1),I.add(i,"keydown",t.closeDropdownPopup,[t,t.bordersDdb])},open:function(){return Fe(i)},beforeClose:function(n){n.event&&U(n.event.target,".e-borders-menu")?n.cancel=!0:(I.remove(i,"keydown",t.closeDropdownPopup),r.destroy())},close:function(){return Fe(t.bordersDdb.element)}}),this.bordersDdb.createElement=this.parent.createElement,this.bordersDdb.appendTo(this.parent.createElement("button",{id:e+"_borders",attrs:{type:"button"}})),this.bordersDdb.element},s.prototype.createBorderMenu=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.element.id,n=new rc({cssClass:"e-borders-menu",items:[{iconCss:"e-icons e-top-borders",text:i.getConstant("TopBorders"),id:r+"_border_topborders"},{iconCss:"e-icons e-left-borders",text:i.getConstant("LeftBorders"),id:r+"_border_leftborders"},{iconCss:"e-icons e-right-borders",text:i.getConstant("RightBorders"),id:r+"_border_rightborders"},{iconCss:"e-icons e-bottom-borders",text:i.getConstant("BottomBorders"),id:r+"_border_bottomborders"},{iconCss:"e-icons e-all-borders",text:i.getConstant("AllBorders"),id:r+"_border_allborders"},{iconCss:"e-icons e-horizontal-borders",text:i.getConstant("HorizontalBorders"),id:r+"_border_horizontalborders"},{iconCss:"e-icons e-vertical-borders",text:i.getConstant("VerticalBorders"),id:r+"_border_verticalborders"},{iconCss:"e-icons e-outside-borders",text:i.getConstant("OutsideBorders"),id:r+"_border_outsideborders"},{iconCss:"e-icons e-inside-borders",text:i.getConstant("InsideBorders"),id:r+"_border_insideborders"},{iconCss:"e-icons e-no-borders",text:i.getConstant("NoBorders"),id:r+"_border_noborders"},{separator:!0},{text:i.getConstant("BorderColor"),items:[{id:r+"_border_colors"}],id:r+"_border_bordercolor"},{text:i.getConstant("BorderStyle"),items:[{iconCss:"e-icons e-selected-icon",id:r+"_1px"},{id:r+"_2px"},{id:r+"_3px"},{id:r+"_dashed"},{id:r+"_dotted"},{id:r+"_double"}]}],orientation:"Vertical",beforeOpen:function(a){if(a.parentItem.id===r+"_border_bordercolor"){t.colorPicker.refresh();var o=t.colorPicker.element.parentElement;a.element.firstElementChild.appendChild(o),o.style.display="inline-block",a.element.parentElement.classList.add("e-border-color"),a.element.firstElementChild.removeAttribute("tabindex")}else a.element.classList.add("e-border-style")},beforeClose:function(a){if(a.event&&a.parentItem.id===r+"_border_bordercolor")if(!U(a.event.target,".e-border-colorpicker")||U(a.event.target,".e-apply")||U(a.event.target,".e-cancel")){t.colorPicker=Ct(t.cPickerEle,"colorpicker"),t.colorPicker.mode==="Picker"&&(t.colorPicker.mode="Palette",t.colorPicker.dataBind());var o=t.colorPicker.element.parentElement;o.style.display="",t.parent.element.appendChild(o)}else a.cancel=!0},onOpen:function(a){if(a.parentItem.id===r+"_border_bordercolor"){a.element.parentElement.style.overflow="visible";var o=a.element.querySelector(".e-color-palette .e-palette");o&&Fe(o)}},onClose:function(){return Fe(n.element)},select:function(a){t.borderSelected(a,n)}});return n.createElement=this.parent.createElement,n.appendTo(e),e.classList.add("e-ul"),n},s.prototype.chartSelected=function(e,t){var i=!m(U(e.element,".e-chart-menu")),r=e.element.id;if("column_chartbar_chartarea_chartpie_doughnut_chartline_chartradar_chartscatter_chart".includes(r)){e.item&&(!e.item.items||!e.item.items.length)&&t.toggle();var n=e.event.target.id;this.parent.notify(fM,{action:r,id:n,isChart:i})}},s.prototype.addChartEleSelected=function(e){var t=e.element.id;this.parent.notify(Yh,{addChartEle:t,triggerEvent:!0}),e.item&&(!e.item.items||!e.item.items.length)&&this.addChartDdb.toggle()},s.prototype.cfSelected=function(e){var t=this.parent.getActiveSheet();if(e.item.id.includes("_dlg"))this.parent.notify(oM,{action:e.item.text});else if(e.item.id.includes("icons")){var i=e.event.target;this.parent.notify(vd,{cfModel:{type:i.id||i.parentElement.id,range:t.selectedRange},isAction:!0})}else e.item.id==="cf_cr_cells"?this.parent.notify(no,{range:t.selectedRange,isAction:!0}):e.item.id==="cf_cr_sheet"&&(this.parent.conditionalFormat=null,this.parent.notify(no,{isAction:!0}));e.item&&(!e.item.items||!e.item.items.length)&&this.cfDdb.toggle()},s.prototype.borderSelected=function(e,t){this.bordersDdb.element.setAttribute("aria-label",e.item.text);var i=this.parent.element.id;if(!(e.item.items.length||e.item.id===i+"_border_colors")){if(!e.item.text){var r=this.border.split(" "),n=r[1]==="solid"?i+"_"+r[0]:i+"_"+r[1];if(n===e.item.id)return;e.item.id===i+"_1px"||e.item.id===i+"_2px"||e.item.id===i+"_3px"?(r[0]=e.item.id.split(i+"_")[1],r[1]="solid"):(r[1]=e.item.id.split(i+"_")[1],r[0]=r[1]==="double"?"3px":"1px"),this.border=r.join(" "),t.items[12].items.forEach(function(a){a.id===n&&(a.iconCss=null),a.id===e.item.id&&(a.iconCss="e-icons e-selected-icon")}),t.setProperties({items:t.items},!0);return}switch(this.bordersDdb.toggle(),this.parent.showSpinner(),e.item.id){case i+"_border_topborders":this.parent.notify(Ri,{style:{borderTop:this.border},onActionUpdate:!0});break;case i+"_border_leftborders":this.parent.notify(Ri,{style:{borderLeft:this.border},onActionUpdate:!0});break;case i+"_border_rightborders":this.parent.notify(Ri,{style:{borderRight:this.border},onActionUpdate:!0});break;case i+"_border_bottomborders":this.parent.notify(Ri,{style:{borderBottom:this.border},onActionUpdate:!0});break;case i+"_border_allborders":this.parent.notify(Ri,{style:{border:this.border},onActionUpdate:!0});break;case i+"_border_horizontalborders":this.parent.notify(Ri,{style:{border:this.border},onActionUpdate:!0,borderType:"Horizontal"});break;case i+"_border_verticalborders":this.parent.notify(Ri,{style:{border:this.border},onActionUpdate:!0,borderType:"Vertical"});break;case i+"_border_outsideborders":this.parent.notify(Ri,{style:{border:this.border},onActionUpdate:!0,borderType:"Outer"});break;case i+"_border_insideborders":this.parent.notify(Ri,{style:{border:this.border},onActionUpdate:!0,borderType:"Inner"});break;case i+"_border_noborders":this.parent.notify(Ri,{style:{border:""},onActionUpdate:!0});break}this.parent.hideSpinner()}},s.prototype.getFontNameDDB=function(e){var t=this,i=this.parent.createElement("button",{id:e+"_font_name",attrs:{type:"button"},className:"e-ss-ddb"}),r=this.parent.createElement("span",{className:"e-tbar-btn-text"});return r.innerText="Calibri",i.appendChild(r),this.fontNameDdb=new Or({cssClass:"e-font-family",items:this.getFontFamilyItems(),createPopupOnClick:!0,select:function(n){var a={style:{fontFamily:n.item.text},onActionUpdate:!0};t.parent.notify(Ri,a),i.setAttribute("aria-label",n.item.text),a.cancel||t.refreshFontNameSelection(a.style.fontFamily)},beforeOpen:function(n){t.tBarDdbBeforeOpen(n.element,n.items,t.parent.serviceLocator.getService(de).getConstant("Font"))}}),this.fontNameDdb.createElement=this.parent.createElement,this.fontNameDdb.appendTo(i),i},s.prototype.getBtn=function(e,t,i,r){r===void 0&&(r=!0);var n=new Ql({iconCss:"e-icons e-"+t+"-icon",cssClass:"e-flat",isToggle:!0});return n.createElement=this.parent.createElement,n.appendTo(this.parent.createElement("button",{id:e+"_"+t,attrs:{"aria-label":i,type:"button"}})),r&&n.element.addEventListener("click",this.toggleBtnClicked.bind(this)),n.element},s.prototype.datavalidationDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r;return this.datavalidationDdb=new Or({cssClass:"e-datavalidation-ddb",iconCss:"e-datavalidation-icon e-icons",content:i.getConstant("DataValidation"),items:[{text:i.getConstant("DataValidation")},{text:i.getConstant("HighlightInvalidData")},{text:i.getConstant("ClearHighlight")},{text:i.getConstant("ClearValidation")}],createPopupOnClick:!0,beforeOpen:function(n){t.refreshSelected(t.datavalidationDdb,n.element,"iconCss"),n.element.setAttribute("aria-label",i.getConstant("DataValidation"))},select:function(n){switch(n.item.text){case i.getConstant("DataValidation"):t.parent.notify(Z1,null);break;case i.getConstant("HighlightInvalidData"):t.parent.notify(Zf,{isRemoveHighlight:!1});break;case i.getConstant("ClearHighlight"):t.parent.notify(Zf,{isRemoveHighlight:!0});break;case i.getConstant("ClearValidation"):t.parent.notify(Jf,{isAction:!0});break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",t.parent.notify(vu,{sortOptions:{sortDescriptors:{order:r}}});break}t.datavalidationDdb.element.setAttribute("aria-label",n.item.text)}}),this.datavalidationDdb.createElement=this.parent.createElement,this.datavalidationDdb.appendTo(this.parent.createElement("button",{id:e+"_datavalidation",attrs:{type:"button"},className:"e-ss-ddb"})),this.datavalidationDdb.element},s.prototype.getTextAlignDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de);return this.textAlignDdb=new Or({cssClass:"e-align-ddb",iconCss:"e-icons e-left-icon",items:[{iconCss:"e-icons e-left-icon"},{iconCss:"e-icons e-center-icon"},{iconCss:"e-icons e-right-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(r){t.refreshSelected(t.textAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment"))},select:function(r){var n={style:{textAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};t.parent.notify(Ri,n),n.cancel||(t.textAlignDdb.iconCss="e-icons e-"+n.style.textAlign+"-icon",t.textAlignDdb.dataBind()),t.textAlignDdb.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment")+" "+i.getConstant("Align"+t.getAlignText(r)))}}),this.textAlignDdb.createElement=this.parent.createElement,this.textAlignDdb.appendTo(this.parent.createElement("button",{id:e+"_text_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.textAlignDdb.element},s.prototype.getVerticalAlignDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de);return this.verticalAlignDdb=new Or({cssClass:"e-align-ddb",iconCss:"e-icons e-bottom-icon",items:[{iconCss:"e-icons e-top-icon"},{iconCss:"e-icons e-middle-icon"},{iconCss:"e-icons e-bottom-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(r){t.refreshSelected(t.verticalAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("VerticalAlignment"))},select:function(r){var n={style:{verticalAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};t.parent.notify(Ri,n),n.cancel||(t.verticalAlignDdb.iconCss="e-icons e-"+n.style.verticalAlign+"-icon",t.verticalAlignDdb.dataBind()),t.verticalAlignDdb.element.setAttribute("aria-label",i.getConstant("VerticalAlignment")+" "+i.getConstant("Align"+t.getAlignText(r)))}}),this.verticalAlignDdb.createElement=this.parent.createElement,this.verticalAlignDdb.appendTo(this.parent.createElement("button",{id:e+"_vertical_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.verticalAlignDdb.element},s.prototype.getMergeSplitBtn=function(e){var t=this;this.parent.element.appendChild(this.parent.createElement("button",{id:e+"_merge",attrs:{type:"button"}}));var i=this.parent.serviceLocator.getService(de);return this.mergeSplitBtn=new FM({cssClass:"e-merge-ddb",iconCss:"e-icons e-merge-icon",createPopupOnClick:!0,items:[{text:i.getConstant("MergeAll"),id:e+"_merge_all"},{text:i.getConstant("MergeHorizontally"),id:e+"_merge_horizontally"},{text:i.getConstant("MergeVertically"),id:e+"_merge_vertically"},{separator:!0,id:e+"_merge_separator"},{text:i.getConstant("Unmerge"),id:e+"_unmerge"}],select:this.mergeSelectHandler.bind(this),click:function(r){r.element.setAttribute("aria-label",i.getConstant("MergeCells")),r.element.classList.contains("e-active")?t.unMerge():t.merge(t.parent.element.id+"_merge_all")},created:function(){t.mergeSplitBtn.element.title=i.getConstant("MergeCells"),t.mergeSplitBtn.element.nextElementSibling.title=i.getConstant("SelectMergeType")},beforeOpen:function(r){return r.element.setAttribute("aria-label",i.getConstant("MergeCells"))}}),this.mergeSplitBtn.createElement=this.parent.createElement,this.mergeSplitBtn.appendTo("#"+e+"_merge"),this.mergeSplitBtn.element.parentElement},s.prototype.mergeSelectHandler=function(e){e.item.id===this.parent.element.id+"_unmerge"?this.unMerge():this.merge(e.item.id),this.mergeSplitBtn.element.setAttribute("aria-label",e.item.text)},s.prototype.unMerge=function(e){this.parent.showSpinner();var t=this.parent.getActiveSheet().selectedRange;this.parent.notify(Fn,{merge:!1,range:e&&e.range||t,isAction:!0,refreshRibbon:!0,type:"All"}),this.toggleActiveState(!1),this.parent.hideSpinner()},s.prototype.merge=function(e){for(var t=this,i=this.parent.getActiveSheet(),r=ee(i.selectedRange),n,a,o=e.includes("merge_all"),l=r[0];l<=r[2];l++)for(var h=r[1];h<=r[3];h++)l===r[0]&&h===r[1]&&o||l===r[0]&&e.includes("merge_vertically")||h===r[1]&&e.includes("_merge_horizontally")||(n=Y(l,h,i)||{},(n.value||n.formula)&&(a=!0));if(!a){this.performMerge(e),o&&this.toggleActiveState(!0);return}var u=this.parent.serviceLocator.getService(At);u.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-merge-alert-dlg",content:this.parent.serviceLocator.getService(de).getConstant("MergeCellsAlert"),beforeOpen:function(c){var d={dialogName:"MergeAlertDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel?c.cancel=!0:Fe(t.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(de).getConstant("Ok"),isPrimary:!0},click:function(){u.hide(),t.performMerge(e),o&&t.toggleActiveState(!0)}}]})},s.prototype.performMerge=function(e){var t=this.parent.element.id;switch(this.parent.showSpinner(),e){case t+"_merge_all":this.parent.notify(Fn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"All",isAction:!0,refreshRibbon:!0});break;case t+"_merge_horizontally":this.parent.notify(Fn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Horizontally",isAction:!0});break;case t+"_merge_vertically":this.parent.notify(Fn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Vertically",isAction:!0});break}this.parent.hideSpinner()},s.prototype.getSortFilterDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r;return this.sortingDdb=new Or({cssClass:"e-sort-filter-ddb",iconCss:"e-icons e-sort-filter-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom"},{separator:!0},{text:i.getConstant("Filter"),iconCss:"e-icons e-filter-apply",id:e+"_applyfilter"},{text:i.getConstant("ClearAllFilter"),iconCss:"e-icons e-filter-clear",id:e+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:e+"_reapplyfilter"}],createPopupOnClick:!0,beforeItemRender:function(n){var a={isFiltered:!1,isClearAll:!0};t.parent.notify(r0,a),!t.parent.allowSorting&&(n.item.text===i.getConstant("SortAscending")||n.item.text===i.getConstant("SortDescending")||n.item.text===i.getConstant("CustomSort")+"...")&&n.element.classList.add("e-disabled"),!t.parent.allowFiltering&&n.item.text===i.getConstant("Filter")&&n.element.classList.add("e-disabled"),(n.item.id===e+"_clearfilter"||n.item.id===e+"_reapplyfilter")&&(a.isFiltered?n.element.classList.remove("e-disabled"):n.element.classList.add("e-disabled"))},beforeOpen:function(n){t.refreshSelected(t.sortingDdb,n.element,"iconCss"),n.element.setAttribute("aria-label",t.parent.serviceLocator.getService(de).getConstant("SortAndFilter"))},select:function(n){switch(n.item.text){case i.getConstant("Filter"):t.parent.notify(so,{});break;case i.getConstant("ClearAllFilter"):t.parent.notify(Kf,{isAction:!0});break;case i.getConstant("ReapplyFilter"):t.parent.notify(i0,null);break;case i.getConstant("CustomSort")+"...":t.parent.notify(Ky,null);break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",t.parent.notify(vu,{sortOptions:{sortDescriptors:{order:r}}});break}t.sortingDdb.element.setAttribute("aria-label",n.item.text)}}),this.sortingDdb.createElement=this.parent.createElement,this.sortingDdb.appendTo(this.parent.createElement("button",{id:e+"_sorting",attrs:{type:"button"},className:"e-ss-ddb"})),this.sortingDdb.element},s.prototype.getFindBtn=function(e){var t=this,i=this.parent.createElement("button",{id:e+"_findbtn",attrs:{type:"button","aria-label":this.parent.serviceLocator.getService(de).getConstant("FindReplaceTooltip")}});return this.findDdb=new Ql({cssClass:"e-spreadsheet-find-ddb e-flat",iconCss:"e-icons e-search-icon"}),this.findDdb.createElement=this.parent.createElement,this.findDdb.appendTo(i),i.onclick=function(r){t.parent.notify(su,{event:r})},this.findDdb.element},s.prototype.getClearDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(de);return this.clearDdb=new Or({cssClass:"e-clear-ddb",iconCss:"e-icons e-clear-icon",items:[{text:i.getConstant("ClearAll"),id:e+"_Clear All"},{text:i.getConstant("ClearFormats"),id:e+"_Clear Formats"},{text:i.getConstant("ClearContents"),id:e+"_Clear Contents"},{text:i.getConstant("ClearHyperlinks"),id:e+"_Clear Hyperlinks"}],createPopupOnClick:!0,beforeOpen:function(r){r.element.setAttribute("aria-label",t.parent.serviceLocator.getService(de).getConstant("Clear"))},select:function(r){t.parent.notify(ev,{options:{type:r.item.id.replace(e+"_","")},isAction:!0}),t.clearDdb.element.setAttribute("aria-label",r.item.text)}}),this.clearDdb.createElement=this.parent.createElement,this.clearDdb.appendTo(this.parent.createElement("button",{id:e+"_clear",attrs:{type:"button"},className:"e-ss-ddb"})),this.clearDdb.element},s.prototype.ribbonCreated=function(){var e=this.parent.serviceLocator.getService(de).getConstant("CollapseToolbar");De(this.ribbon.element.querySelector(".e-drop-icon"),{role:"button",tabindex:"-1",title:e,"aria-label":e}),this.ribbon.toolbarObj&&(this.ribbon.toolbarObj.allowKeyboard=this.parent.enableKeyboardNavigation,this.ribbon.toolbarObj.dataBind())},s.prototype.alignItemRender=function(e){e.element.title=this.parent.serviceLocator.getService(de).getConstant("Align"+this.getAlignText(e))},s.prototype.getAlignText=function(e){var t=e.item.iconCss.split(" e-")[1].split("-icon")[0];return t[0].toUpperCase()+t.slice(1,t.length)},s.prototype.toggleBtnClicked=function(e){var t=U(e.target,".e-btn"),i=this.parent.element.id,r=t.id,n=Ri,a,o,l,h,u;switch(r){case i+"_bold":o={fontWeight:"normal"},l={fontWeight:"bold"},u="fontWeight";break;case i+"_italic":o={fontStyle:"normal"},l={fontStyle:"italic"},u="fontStyle";break;case i+"_line-through":n=ld,o={textDecoration:"line-through"},l=o,u="textDecoration";break;case i+"_underline":n=ld,o={textDecoration:"underline"},l=o,u="textDecoration";break}t.classList.contains("e-active")?(a=l[""+u],h={style:l,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&t.classList.remove("e-active")):(a=o[""+u],h={style:o,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&t.classList.add("e-active")),!h.cancel&&a!==h.style[""+u]&&this.refreshToggleBtn(xe(this.parent.getActiveSheet().activeCell))},s.prototype.getCellStyleValue=function(e,t){var i=Y(t[0],t[1],this.parent.getActiveSheet()),r=this.parent.cellStyle[""+e];return i&&i.style&&i.style[""+e]&&(r=i.style[""+e]),r},s.prototype.refreshSelected=function(e,t,i,r){r===void 0&&(r=i);for(var n=0;n<e.items.length;n++)if(e.items[n][""+r]===e[""+i]){t.children[n].classList.add("e-selected");break}},s.prototype.expandCollapseHandler=function(e){var t=this.ribbon.element.querySelector(".e-drop-icon"),i=this.parent.serviceLocator.getService(de);e.expanded?(t.title=i.getConstant("CollapseToolbar"),t.setAttribute("aria-label",i.getConstant("ExpandToolbar"))):(t.title=i.getConstant("ExpandToolbar"),t.setAttribute("aria-label",i.getConstant("CollapseToolbar"))),this.parent.setPanelSize()},s.prototype.getChartThemeDdbItems=function(e){var t=this.parent.serviceLocator.getService(de),i=[],r=["Material","Fabric","Bootstrap","HighContrastLight","MaterialDark","FabricDark","HighContrast","BootstrapDark","Bootstrap4","Bootstrap5Dark","Bootstrap5","TailwindDark","Tailwind","FluentDark","Fluent","Material3","Material3Dark"];return r.forEach(function(n){i.push({id:n,text:t.getConstant(n),iconCss:n===e?"e-icons e-selected-icon":""})}),i},s.prototype.getNumFormatDdbItems=function(e){var t=this.parent.serviceLocator.getService(de);return[{id:e+"_General",text:t.getConstant("General")},{id:e+"_Number",text:t.getConstant("Number")},{id:e+"_Currency",text:t.getConstant("Currency")},{id:e+"_Accounting",text:t.getConstant("Accounting")},{id:e+"_ShortDate",text:t.getConstant("ShortDate")},{id:e+"_LongDate",text:t.getConstant("LongDate")},{id:e+"_Time",text:t.getConstant("Time")},{id:e+"_Percentage",text:t.getConstant("Percentage")},{id:e+"_Fraction",text:t.getConstant("Fraction")},{id:e+"_Scientific",text:t.getConstant("Scientific")},{id:e+"_Text",text:t.getConstant("Text")},{id:e+"_Custom",text:t.getConstant("Custom")}]},s.prototype.getFontFamilyItems=function(){return[{text:"Arial"},{text:"Arial Black"},{text:"Axettac Demo"},{text:"Batang"},{text:"Book Antiqua"},{text:"Calibri",iconCss:"e-icons e-selected-icon"},{text:"Comic Sans MS"},{text:"Courier"},{text:"Courier New"},{text:"Din Condensed"},{text:"Georgia"},{text:"Helvetica"},{text:"Helvetica New"},{text:"Roboto"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Verdana"}]},s.prototype.applyNumFormat=function(e,t){var i=this.parent.getActiveSheet(),r={format:e,range:i.selectedRange,cancel:!1,requestType:"NumberFormat"},n={range:i.name+"!"+r.range,format:r.format,requestType:"NumberFormat"};this.parent.trigger("beforeCellFormat",r),this.parent.notify(li,{eventArgs:r,action:"format"}),!r.cancel&&(this.parent.notify(Rf,r),this.parent.notify(Gs,{type:"mousedown"}),this.refreshNumFormatSelection(t),this.parent.notify(yt,{eventArgs:n,action:"format"}))},s.prototype.renderCustomFormatDialog=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("div"),n=this.parent.createElement("div",{className:"e-custom-dialog"}),a=this.parent.createElement("button",{className:"e-btn",attrs:{type:"button"}});a.innerText=i.getConstant("Apply");var o=this.parent.createElement("div",{className:"e-custom-sample"});o.innerText=i.getConstant("CustomFormatTypeList")+":";var l=this.parent.createElement("input",{className:"e-input e-dialog-input",attrs:{type:"text",name:"input",placeholder:i.getConstant("CustomFormatPlaceholder"),spellcheck:"false"}}),h=this.parent.createElement("div",{className:"e-custom-listview"}),u=this.parent.serviceLocator.getService(At),c=new Ib({dataSource:e,select:function(g){l.value=g.text,g.event&&g.event.type==="keydown"&&g.item&&g.item.focus()}});n.appendChild(l),n.appendChild(a),n.appendChild(o),n.appendChild(h),c.appendTo(h);var d=function(g){e.indexOf(g.format)===-1&&e.push(g.format)};this.parent.on(y1,d,this),a.addEventListener("click",function(){var g=l.value;t.applyNumFormat(g,i.getConstant("Custom")),c.destroy(),u.hide(),d({format:g})}),u.show({header:i.getConstant("CustomFormat"),cssClass:"e-custom-format-dlg",height:this.parent.cssClass.indexOf("e-bigger")>-1?502:480,width:440,isModal:!0,showCloseIcon:!0,content:n,footerTemplate:r,beforeOpen:function(){return Fe(t.parent.element)}});var p=this.parent.getActiveSheet(),f=xe(p.activeCell),v=Y(f[0],f[1],p);v&&v.format&&c.selectItem(v.format)},s.prototype.tBarDdbBeforeOpen=function(e,t,i,r){r===void 0&&(r=0);var n=this.parent.viewport.height,a=parseInt(getComputedStyle(e.firstElementChild).height,10)*(t.length-r)+parseInt(getComputedStyle(e).paddingTop,10)*2;if(r){var o=getComputedStyle(e.querySelector(".e-separator"));a+=r*(parseInt(o.borderBottomWidth,10)+parseInt(o.marginTop,10)*2)}a>n?(e.style.height=n+"px",e.style.overflowY="auto"):e.style.height&&(e.style.height="",e.style.overflowY=""),e.setAttribute("aria-label",i)},s.prototype.numDDBOpen=function(e){this.numPopupWidth=0;for(var t=e.element.querySelectorAll("span.e-numformat-preview-text"),i=0,r=t.length;i<r;i++)this.numPopupWidth<t[i].offsetWidth&&(this.numPopupWidth=t[i].offsetWidth);var n=this.numPopupWidth+160;document.querySelector(".e-numformat-ddb.e-dropdown-popup").style.width=n+"px"},s.prototype.previewNumFormat=function(e){if(!e.item.id.includes("_Custom")){var t=this.parent.createElement("div",{className:"e-numformat-text",styles:"width:100%",innerHTML:e.element.innerHTML});e.element.innerHTML="";var i=this.parent.getActiveSheet(),r=xe(i.activeCell),n=Y(r[0],r[1],i,!1,!0);if(!m(n.value)||n.value!==""){var a=Ki(e.item.id.split(this.parent.element.id+"_")[1]),o={type:e.item.text,formattedText:"",value:n.value,format:a,cell:{value:n.value,format:a},skipFormatCheck:ea(this.parent)};this.parent.notify(jn,o);var l=this.parent.createElement("span",{className:"e-numformat-preview-text",styles:"float:right;"});l.innerText=o.formattedText,t.appendChild(l)}e.element.appendChild(t)}},s.prototype.refreshRibbonContent=function(e){if(this.ribbon){m(e)&&(e=this.ribbon.selectedTab);var t=this.parent.serviceLocator.getService(de),i=this.parent.getActiveSheet();switch(this.ribbon.items[e].header.text){case t.getConstant("Home"):this.refreshHomeTabContent(xe(i.activeCell));break;case t.getConstant("Insert"):break;case t.getConstant("Formulas"):break;case t.getConstant("Data"):this.refreshDataTabContent(e);break;case t.getConstant("View"):this.refreshViewTabContent(e);break}}},s.prototype.refreshHomeTabContent=function(e){m(document.getElementById(this.parent.element.id+"_number_format"))||(this.numFormatDDB=Ct(document.getElementById(this.parent.element.id+"_number_format"),Or));var t=this.parent.getActiveSheet(),i=xe(this.parent.getActiveSheet().activeCell),r=this.parent.serviceLocator.getService(de),n=Y(i[0],i[1],this.parent.getActiveSheet())||{},a=rh(n.format||"General",!0);if(this.numFormatDDB&&(t.isProtected&&!t.protectSettings.formatCells?(a="General",this.refreshNumFormatSelection(a)):(n.format&&a==="General"&&n.format!=="General"&&(a="Custom"),this.refreshNumFormatSelection(r.getConstant(a)))),this.fontNameDdb&&(t.isProtected&&!t.protectSettings.formatCells?this.refreshFontNameSelection("Calibri"):this.refreshFontNameSelection(this.getCellStyleValue("fontFamily",e))),this.fontSizeDdb){var o=this.getCellStyleValue("fontSize",e);t.isProtected&&!t.protectSettings.formatCells?this.fontSizeDdb.content="11":(o=o.includes("pt")?o.split("pt")[0]:"11",o!==this.fontSizeDdb.content&&(this.fontSizeDdb.content=o,this.fontSizeDdb.dataBind()))}if(this.refreshTextAlign(t,n,a,e),this.verticalAlignDdb){var o="e-icons e-"+this.getCellStyleValue("verticalAlign",e).toLowerCase()+"-icon";t.isProtected&&!t.protectSettings.formatCells?this.verticalAlignDdb.iconCss="e-icons e-bottom-icon":o!==this.verticalAlignDdb.iconCss&&(this.verticalAlignDdb.iconCss=o,this.verticalAlignDdb.dataBind())}if(this.refreshToggleBtn(e),!t.isProtected&&(n.rowSpan>1||n.colSpan>1))this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),this.toggleActiveState(!0);else{var l=ee(t.selectedRange);this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:l[0]!==l[2]||l[1]!==l[3]}]),this.toggleActiveState(!1)}},s.prototype.refreshTextAlign=function(e,t,i,r){if(this.textAlignDdb){var n=this.getCellStyleValue("textAlign",r);if(e.isProtected&&!e.protectSettings.formatCells)this.textAlignDdb.iconCss="e-icons e-left-icon";else{t.value!==void 0&&n==="left"&&(i==="Accounting"||He(t.value)&&i!=="Text")&&(n="right");var a="e-icons e-"+n.toLowerCase()+"-icon";a!==this.textAlignDdb.iconCss&&(this.textAlignDdb.iconCss=a,this.textAlignDdb.dataBind())}}},s.prototype.toggleActiveState=function(e){var t=this.parent.serviceLocator.getService(de);this.parent.getActiveSheet().isProtected||(e?(this.mergeSplitBtn.element.classList.add("e-active"),this.mergeSplitBtn.element.title=t.getConstant("UnmergeCells")):(this.mergeSplitBtn.element.classList.contains("e-active")&&this.mergeSplitBtn.element.classList.remove("e-active"),this.mergeSplitBtn.element.title=t.getConstant("MergeCells")))},s.prototype.refreshToggleBtn=function(e){var t=this,i=this.parent.getActiveSheet(),r,n=this.parent.element.id,a,o,l=Y(e[0],e[1],i),h=["fontWeight","fontStyle","textDecoration","textDecoration"];["bold","italic","line-through","underline","wrap"].forEach(function(u,c){r=document.getElementById(n+"_"+u),r&&(i.isProtected&&!i.protectSettings.formatCells?r.classList.remove("e-active"):u==="wrap"?o=l&&l.wrap:(a=t.getCellStyleValue(h[c],e).toLowerCase(),o=a.indexOf(u)>-1),o?r.classList.add("e-active"):r.classList.contains("e-active")&&r.classList.remove("e-active"))})},s.prototype.refreshFontNameSelection=function(e){e=e.split('"').join(""),this.fontNameDdb.element.firstElementChild.textContent=e;for(var t=0;t<this.fontNameDdb.items.length;t++)if(this.fontNameDdb.items[t].text===e){this.fontNameDdb.items[t].iconCss="e-icons e-selected-icon",t!==this.fontNameIndex&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.setProperties({items:this.fontNameDdb.items},!0),this.fontNameIndex=t;break}["Arial","Arial Black","Axettac Demo","Batang","Book Antiqua","Calibri","Comic Sans MS","Courier","Courier New","Din Condensed","Georgia","Helvetica","Helvetica New","Roboto","Tahoma","Times New Roman","Verdana"].indexOf(e)<0&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.element.setAttribute("aria-label",e)},s.prototype.refreshNumFormatSelection=function(e){for(var t=0;t<this.numFormatDDB.items.length;t++)this.numFormatDDB.items[t].iconCss!==""&&(this.numFormatDDB.items[t].iconCss=""),this.numFormatDDB.items[t].text===e&&(this.numFormatDDB.items[t].iconCss="e-icons e-selected-icon");this.numFormatDDB.element.firstElementChild.textContent=e,this.numFormatDDB.setProperties({items:this.numFormatDDB.items},!0),this.numFormatDDB.element.setAttribute("aria-label",e)},s.prototype.fileMenuItemSelect=function(e){var t=this,i=me({cancel:!1},e);this.parent.trigger("fileMenuItemSelect",i);var r=this.parent.element.id,n;if(!i.cancel)switch(e.item.id){case r+"_Open":$("#"+r+"_fileUpload",this.parent.element).click(),Fe(this.parent.element);break;case r+"_Xlsx":case r+"_Xls":case r+"_Csv":case r+"_Pdf":this.parent.notify(Lf,e);break;case r+"_New":n=this.parent.serviceLocator.getService(At),n.show({height:200,width:400,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(de).getConstant("DestroyAlert"),beforeOpen:function(a){var o={dialogName:"DestroySheetDialog",element:a.element,target:a.target,cancel:a.cancel};t.parent.trigger("dialogBeforeOpen",o),o.cancel?a.cancel=!0:Fe(t.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(de).getConstant("Ok"),isPrimary:!0},click:function(){n.hide(),t.parent.refresh(!0)}}]});break}},s.prototype.toolbarClicked=function(e){if(e.item&&e.item.id!=="spreadsheet_find"){var t=this.parent.element.id,i=this.parent.getActiveSheet(),r=void 0,n=void 0,a=void 0,o=void 0;switch(e.item.id){case t+"_headers":if(r={isShow:!i.showHeaders,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(yt,{eventArgs:r,action:"headers"}),r.cancel)return;this.parent.setSheetPropertyOnMute(i,"showHeaders",!i.showHeaders),this.parent.serviceLocator.getService("sheet").showHideHeaders(),this.toggleRibbonItems({props:"Headers",activeTab:this.ribbon.selectedTab});break;case t+"_gridlines":if(n={isShow:!i.showGridLines,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(yt,{eventArgs:n,action:"gridLines"}),n.cancel)return;this.parent.setSheetPropertyOnMute(i,"showGridLines",!i.showGridLines),this.toggleRibbonItems({props:"GridLines",activeTab:this.ribbon.selectedTab});break;case t+"_protect":this.parent.notify(y0,{});break;case t+"_undo":this.parent.notify(Fa,{isUndo:!0});break;case t+"_redo":this.parent.notify(Fa,{isUndo:!1});break;case t+"_freezepanes":a=xe(i.topLeftCell),o=i.frozenRows||i.frozenColumns?a:xe(i.activeCell),this.parent.notify(Zp,{row:o[0]-a[0],column:o[1]-a[1],triggerEvent:!0});break;case t+"_freezerows":this.parent.notify(Zp,{row:i.frozenRows?0:xe(i.activeCell)[0]-xe(i.topLeftCell)[0],column:i.frozenColumns,triggerEvent:!0});break;case t+"_freezecolumns":this.parent.notify(Zp,{row:i.frozenRows,column:i.frozenColumns?0:xe(i.activeCell)[1]-xe(i.topLeftCell)[1],triggerEvent:!0});break;case t+"_protectworkbook":this.parent.password.length>0?this.parent.notify(p0,null):this.parent.isProtected?(this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}),this.parent.notify(yt,{action:"protectWorkbook",eventArgs:{isProtected:!1}})):this.parent.element.querySelector(".e-add-sheet-tab").classList.contains("e-disabled")?this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}):this.parent.notify(d0,null);break}this.parent.notify(Qf,e)}},s.prototype.toggleRibbonItems=function(e){var t="",i=this.parent.serviceLocator.getService(de).getConstant("View"),r=this.parent.serviceLocator.getService(de).getConstant("Data");if(this.ribbon.items[this.ribbon.selectedTab].header.text===i){if(m(e.activeTab)){for(var n=0,a=this.ribbon.items.length;n<a;n++)if(this.ribbon.items[n].header.text===i){e.activeTab=n;break}}var o=this.getLocaleText(e.props);e.props==="GridLines"&&this.parent.serviceLocator.getService("sheet").toggleGridlines();for(var l=this.parent.element.id+"_"+e.props.toLowerCase(),h=this.ribbon.items[e.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[e.activeTab].content[n].type!=="Separator"&&this.ribbon.items[e.activeTab].content[n].id===l&&(this.ribbon.items[e.activeTab].content[n].text=o,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===i&&e.props!=="Protect"&&this.updateToggleText(e.props.toLowerCase(),o)}if(this.ribbon.items[this.ribbon.selectedTab].header.text===r){if(m(e.activeTab)){for(var n=0,u=this.ribbon.items.length;n<u;n++)if(this.ribbon.items[n].header.text===r){e.activeTab=n;break}}var l=this.parent.element.id+"_"+e.props.toLowerCase();if(l===this.parent.element.id+"_protect"){var c=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<c&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protect";d++);t=this.getLocaleProtectText("Sheet",!0)}else if(l===this.parent.element.id+"_protectworkbook"){var p=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<p&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protectworkbook";d++);this.parent.isProtected||this.parent.password.length>0?t=this.getLocaleProtectWorkbook("UnprotectWorkbook"):this.parent.isProtected||(t=this.getLocaleProtectWorkbook("ProtectWorkbook"))}for(var h=this.ribbon.items[e.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[e.activeTab].content[n].type!=="Separator"&&this.ribbon.items[e.activeTab].content[n].id===l&&(this.ribbon.items[e.activeTab].content[n].text=t,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===r&&this.updateToggleText(e.props.toLowerCase(),t)}},s.prototype.enableFileMenuItems=function(e){this.ribbon.enableMenuItems(e.items,e.enable,e.isUniqueId)},s.prototype.hideRibbonTabs=function(e){this.ribbon.hideTabs(e.tabs,e.hide)},s.prototype.addRibbonTabs=function(e){this.ribbon.addTabs(e.items,e.insertBefore);var t=$(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide",this.parent.element);t&&this.parent.updateActiveBorder(ze(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)",this.parent.element)[this.ribbon.selectedTab])},s.prototype.updateToggleText=function(e,t){var i=$("#"+this.parent.element.id+"_"+e+" .e-tbar-btn-text",this.ribbon.element);if(e==="protect"||e==="protectworkbook"?i.parentElement.setAttribute("aria-label",t):i.parentElement.setAttribute("aria-label",i.textContent),Vi(function(){i&&(i.textContent=t)}),e==="headers"){var r=this.parent.element.getElementsByClassName("e-findtool-dlg")[0];r&&r.classList.contains("e-popup-open")&&this.parent.notify(su,{refreshPosition:!0,dialogEle:r})}},s.prototype.refreshViewTabContent=function(e){for(var t=this.parent.element.id,i=this.parent.getActiveSheet(),r=this.parent.serviceLocator.getService(de),n,a=0;a<this.ribbon.items[e].content.length;a++)n=this.ribbon.items[e].content[a],n.type!=="Separator"&&(n.id===t+"_headers"&&this.updateViewTabContent(e,"Headers",a),n.id===t+"_gridlines"&&this.updateViewTabContent(e,"GridLines",a),n.id===t+"_freezepanes"&&(i.frozenRows||i.frozenColumns?n.text===r.getConstant("FreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Unfreeze","Panes",a,e)):n.text===r.getConstant("UnfreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Freeze","Panes",a,e))),n.id===t+"_freezerows"&&(i.frozenRows?n.text===r.getConstant("FreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Unfreeze","Rows",a,e)):n.text===r.getConstant("UnfreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Freeze","Rows",a,e))),n.id===t+"_freezecolumns"&&(i.frozenColumns?n.text===r.getConstant("FreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Unfreeze","Columns",a,e)):n.text===r.getConstant("UnfreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Freeze","Columns",a,e))))},s.prototype.updateViewTabContent=function(e,t,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(de);r["show"+t]?this.ribbon.items[e].content[i].text===n.getConstant("Show"+t)&&this.updateToggleText(t.toLowerCase(),this.updateRibbonItemText("Hide",t,i,e)):this.ribbon.items[e].content[i].text===n.getConstant("Hide"+t)&&this.updateToggleText(t.toLowerCase(),this.updateRibbonItemText("Show",t,i,e))},s.prototype.updateRibbonItemText=function(e,t,i,r){var n=this.parent.serviceLocator.getService(de),a=n.getConstant(e+t);return this.ribbon.items[r].content[i].text=a,this.ribbon.setProperties({items:this.ribbon.items},!0),a},s.prototype.refreshDataTabContent=function(e){for(var t=this.parent.element.id,i,r=0;r<this.ribbon.items[e].content.length;r++)if(this.ribbon.items[e].content[r].type!=="Separator"){if(this.ribbon.items[e].content[r].id===t+"_protect"){if(this.updateDataTabContent(e,"Sheet",r),i)break;i=!0}this.ribbon.items[e].content[r].id===t+"_protectworkbook"&&this.updateDataTabContent(e,"Workbook",r)}},s.prototype.updateDataTabContent=function(e,t,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(de);if(t==="Sheet")r.isProtected?this.ribbon.items[e].content[i].text===n.getConstant("Protect"+t)&&(this.ribbon.items[e].content[i].cssClass="e-active",this.updateProtectBtn("Unprotect",t,i,e)):this.updateProtectBtn("Protect",t,i,e);else if(t==="Workbook"){var a=this.parent.serviceLocator.getService(de);this.parent.isProtected?this.ribbon.items[e].content[i].text===a.getConstant("Protect"+t)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Unprotect",t,i,e)):this.ribbon.items[e].content[i].text===a.getConstant("Unprotect"+t)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Protect",t,i,e))}},s.prototype.updateProtectBtn=function(e,t,i,r){var n=this.parent.serviceLocator.getService(de),a=n.getConstant(e+t);this.ribbon.items[r].content[i].text=a,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protect",a)},s.prototype.updateProtectWorkbookBtn=function(e,t,i,r){var n=this.parent.serviceLocator.getService(de),a=n.getConstant(e);this.ribbon.items[r].content[i].text=a,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protectworkbook",a)},s.prototype.addToolbarItems=function(e){var t=this.parent.serviceLocator.getService(de);this.ribbon.addToolbarItems(t.getConstant(e.tab),e.items,e.index)},s.prototype.enableToolbarItems=function(e){var t=this;e.forEach(function(i){t.ribbon.enableItems(i.tab||t.ribbon.items[t.ribbon.selectedTab].header.text,i.items,i.enable)})},s.prototype.createMobileView=function(){var e=this,t=this.parent.element.id,i=this.parent.createElement("div",{className:"e-header-toolbar"}),r=this.parent.createElement("ul");i.appendChild(r);var n=new ov({items:[{prefixIcon:"e-tick-icon",align:"Left",id:t+"focused_tick",cssClass:"e-focused-tick"},{template:r,align:"Right",id:t+"file_menu"}],clicked:function(a){switch(a.item.id){case t+"focused_tick":e.parent.element.classList.remove("e-mobile-focused"),e.parent.renderModule.setSheetPanelSize();break}},created:function(){var a=new rc({cssClass:"e-mobile e-file-menu",enableRtl:!0,showItemOnClick:!0,items:e.getRibbonMenuItems(),select:e.fileMenuItemSelect.bind(e),beforeOpen:function(o){o.element.parentElement.classList.remove("e-rtl"),e.fileMenuBeforeOpen(o)},beforeClose:e.fileMenuBeforeClose.bind(e)});a.createElement=e.parent.createElement,a.appendTo(r)}});n.createElement=this.parent.createElement,n.appendTo(i),this.parent.element.insertBefore(i,this.parent.element.firstElementChild),this.renderMobileToolbar()},s.prototype.renderMobileToolbar=function(){var e=this,t=this.parent.createElement("div",{className:"e-toolbar-panel e-ribbon"}),i=this.parent.createElement("div"),r=this.parent.createElement("button",{attrs:{type:"button"}});t.appendChild(i),t.appendChild(r),t.style.display="block",this.parent.element.appendChild(t);var n=new Or({cssClass:"e-caret-hide",content:this.ribbon.items[0].header.text,items:[{text:this.ribbon.items[0].header.text},{text:this.ribbon.items[1].header.text},{text:this.ribbon.items[2].header.text},{text:this.ribbon.items[3].header.text}],createPopupOnClick:!0,select:function(o){o.item.text!==n.content&&(a.element.style.display="none",n.content=o.item.text,n.dataBind(),a.items=e.ribbon.items[n.items.indexOf(o.item)+1].content,a.width="calc(100% - "+r.getBoundingClientRect().width+"px)",a.element.style.display="",a.dataBind(),a.items[0].text=o.item.text,a.dataBind())},open:function(o){var l=o.element.parentElement,h=l.getBoundingClientRect(),u=Fr(n.element,"right","bottom");l.style.left=u.left-h.width+"px",l.style.top=u.top-h.height+"px";for(var c=0;c<n.items.length;c++)if(n.content===n.items[c].text){o.element.children[c].classList.add("e-selected");break}},close:function(){return Fe(e.parent.element)}});n.createElement=this.parent.createElement,n.appendTo(r);var a=new ov({width:"calc(100% - "+r.getBoundingClientRect().width+"px)",items:this.ribbon.items[0].content,clicked:this.toolbarClicked.bind(this)});a.createElement=this.parent.createElement,a.appendTo(i),t.style.display=""},s.prototype.fileMenuBeforeOpen=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r,n=[".xlsx",".xls",".csv",".pdf"];e.parentItem.text===i.getConstant("SaveAs")&&[].slice.call(e.element.children).forEach(function(a,o){r=t.parent.createElement("div",{innerHTML:a.innerHTML}),a.innerHTML="";var l=t.parent.createElement("span",{className:"e-extension"});l.innerText=n[o],r.appendChild(l),a.appendChild(r)}),this.parent.trigger("fileMenuBeforeOpen",e),e.element.setAttribute("aria-label",this.parent.serviceLocator.getService(de).getConstant("File"))},s.prototype.enableRibbonTabs=function(e){this.ribbon.enableTabs(e.tabs,e.enable)},s.prototype.fileMenuBeforeClose=function(e){var t=this;this.parent.trigger("fileMenuBeforeClose",e),e.parentItem&&e.event&&e.event.keyCode===37&&e.parentItem.id===this.parent.element.id+"_File"&&Vi(function(){var i=t.ribbon.element.querySelector(".e-tab-header .e-toolbar-item .e-tab-wrap");if(i){Fe(i);var r=i.querySelector(".e-menu-item.e-focused");r&&r.classList.remove("e-focused")}})},s.prototype.hideFileMenuItems=function(e){this.ribbon.hideMenuItems(e.items,e.hide,e.isUniqueId)},s.prototype.addFileMenuItems=function(e){this.ribbon.addMenuItems(e.items,e.text,e.insertAfter,e.isUniqueId)},s.prototype.hideToolbarItems=function(e){this.ribbon.hideToolbarItems(e.tab,e.indexes,e.hide)},s.prototype.protectSheetHandler=function(e){var t=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(de);t.isProtected&&t.protectSettings.formatCells||!t.isProtected?(this.parent.allowCellFormatting?this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(2,14),enable:!1}]),this.parent.allowWrap||this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(14,15),enable:!1}]),this.parent.allowNumberFormatting||this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(2,3),enable:!1}]),this.parent.notify(iM,null)):this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.disableHomeBtnId,enable:!1}]),t.isProtected&&t.protectSettings.insertLink||!t.isProtected?!this.parent.allowHyperlink||t.isProtected&&t.protectSettings.insertLink?this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId.slice(0,1),enable:!1}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.findBtnId,enable:!t.isProtected||t.protectSettings.selectCells||t.protectSettings.selectUnLockedCells}]);var r=this.ribbon.items[this.ribbon.selectedTab].content.length,n;for(n=0;n<r&&this.ribbon.items[this.ribbon.selectedTab].content[n].id!==this.parent.element.id+"_protectworkbook";n++);t.isProtected?(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.imageBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:e.dataValidationBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:e.enableFrmlaBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.chartBtnId,enable:!1}])):(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.imageBtnId,enable:this.parent.allowImage}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:e.dataValidationBtnId,enable:this.parent.allowDataValidation}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:e.enableFrmlaBtnId,enable:!0}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.chartBtnId,enable:this.parent.allowChart}]))},s.prototype.updateMergeItem=function(e){if(e.type==="mousemove"||e.type==="pointermove"||e.type==="touchmove"||e.shiftKey&&(e.type==="mousedown"||e.type==="touchend")){var t=ee(this.parent.getActiveSheet().selectedRange);(t[1]!==t[3]||t[0]!==t[2])&&!this.parent.getActiveSheet().isProtected&&this.parent.allowMerge&&(this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(de).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),this.toggleActiveState(!1))}},s.prototype.onPropertyChanged=function(e){var t=this.parent.serviceLocator.getService(de),i=this.parent.element.id;switch(e){case"allowFreezePane":this.ribbon.enableItems(t.getConstant("View"),[i+"_freezepanes",i+"_freezerows",i+"_freezecolumns"],this.parent.allowFreezePane);break;case"showRibbon":this.parent.showRibbon?this.initialize(!0):this.ribbon&&this.destroy();break;case"allowImage":this.ribbon.enableItems(t.getConstant("Insert"),[i+"_image"],this.parent.allowImage);break;case"allowChart":this.ribbon.enableItems(t.getConstant("Insert"),[i+"_chart"],this.parent.allowChart),this.parent.allowChart||this.removeDesignChart();break}},s.prototype.addEventListener=function(){this.parent.on(Wh,this.ribbonOperation,this),this.parent.on(nh,this.enableToolbarItems,this),this.parent.on(sa,this.refreshRibbonContent,this),this.parent.on(Ah,this.toggleRibbonItems,this),this.parent.on(P1,this.enableFileMenuItems,this),this.parent.on(B1,this.hideRibbonTabs,this),this.parent.on(V1,this.addRibbonTabs,this),this.parent.on(U1,this.addToolbarItems,this),this.parent.on(z1,this.hideFileMenuItems,this),this.parent.on(j1,this.addFileMenuItems,this),this.parent.on(_1,this.hideToolbarItems,this),this.parent.on(H1,this.enableRibbonTabs,this),this.parent.on(J1,this.protectSheetHandler,this),this.parent.on(Gs,this.updateMergeItem,this),this.parent.on(Oa,this.refreshRibbonContent,this),this.parent.on(c0,this.insertDesignChart,this),this.parent.on(qh,this.removeDesignChart,this),this.parent.on(RA,this.unMerge,this)},s.prototype.destroy=function(){var e=this.parent.element,t=this.ribbon?this.ribbon.element:null,i=this.cPickerEle,r=e.id;["bold","italic","line-through","underline"].forEach(function(n){a7($("#"+(r+"_"+n),e),Ql)}),this.pasteSplitBtn&&this.pasteSplitBtn.destroy(),this.pasteSplitBtn=null,this.mergeSplitBtn&&this.mergeSplitBtn.destroy(),this.mergeSplitBtn=null,this.numFormatDDB&&this.numFormatDDB.destroy(),this.numFormatDDB=null,this.fontSizeDdb&&this.fontSizeDdb.destroy(),this.fontSizeDdb=null,this.fontNameDdb&&this.fontNameDdb.destroy(),this.fontNameDdb=null,this.textAlignDdb&&this.textAlignDdb.destroy(),this.textAlignDdb=null,this.verticalAlignDdb&&this.verticalAlignDdb.destroy(),this.verticalAlignDdb=null,this.sortingDdb&&this.sortingDdb.destroy(),this.sortingDdb=null,this.clearDdb&&this.clearDdb.destroy(),this.clearDdb=null,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=null,this.destroyComponent(r+"_borders_menu","menu"),this.bordersDdb&&this.bordersDdb.destroy(),this.bordersDdb=null,this.findDdb&&this.findDdb.destroy(),this.findDdb=null,this.destroyComponent(r+"_chart_menu","menu"),this.destroyComponent(r+"_chart_type_menu","menu"),this.destroyComponent(r+"_chart-btn","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.destroyComponent(r+"_cf_menu","menu"),this.cfDdb&&this.cfDdb.destroy(),this.cfDdb=null,this.detachPopupElement(r),this.parent.notify("destroyRibbonComponents",null),this.ribbon&&this.ribbon.destroy(),t&&ne(t),this.ribbon=null,i&&ne(i),this.cPickerEle=null,this.datavalidationDdb&&this.datavalidationDdb.destroy(),this.datavalidationDdb=null,this.removeEventListener()},s.prototype.destroyComponent=function(e,t){var i=typeof e=="string"?document.getElementById(e):e;if(i){if(t!=="menu"||i.childElementCount){var r=Ct(i,t);if(r&&(r.destroy(),t==="dropdown-btn")){var n=document.getElementById(i.id+"-popup");n&&ne(n)}}t==="menu"&&ne(i)}},s.prototype.detachPopupElement=function(e){["_conditionalformatting","_chart-type-btn","_chart-btn","_borders"].forEach(function(t){var i=document.getElementById(""+e+t+"-popup");i&&ne(i)})},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Wh,this.ribbonOperation),this.parent.off(nh,this.enableToolbarItems),this.parent.off(sa,this.refreshRibbonContent),this.parent.off(Ah,this.toggleRibbonItems),this.parent.off(P1,this.enableFileMenuItems),this.parent.off(B1,this.hideRibbonTabs),this.parent.off(V1,this.addRibbonTabs),this.parent.off(U1,this.addToolbarItems),this.parent.off(z1,this.hideFileMenuItems),this.parent.off(j1,this.addFileMenuItems),this.parent.off(_1,this.hideToolbarItems),this.parent.off(H1,this.enableRibbonTabs),this.parent.off(J1,this.protectSheetHandler),this.parent.off(Gs,this.updateMergeItem),this.parent.off(Oa,this.refreshRibbonContent),this.parent.off(c0,this.insertDesignChart),this.parent.off(qh,this.removeDesignChart),this.parent.off(RA,this.unMerge),this.parent.off(y1))},s}(),qY=function(){function s(e){this.categoryCollection=[],this.formulaCollection=[],this.isGoto=!1,this.parent=e,this.addEventListener()}return s.prototype.getModuleName=function(){return"formulaBar"},s.prototype.createFormulaBar=function(e){var t=this;if(!this.parent.showFormulaBar&&this.insertFnRipple){this.destroy();return}var i=this.parent.serviceLocator.getService(de),r=this.parent.element.id,n=this.parent.createElement("div",{className:"e-formula-bar-panel"});if(!this.parent.isMobileView()){var a=this.parent.createElement("input",{id:r+"_name_box",attrs:{type:"text"}});n.appendChild(a),this.comboBoxInstance=new Xz({value:"A1",cssClass:"e-name-box",width:"",noRecordsTemplate:wy(function(){return""}),fields:{text:"name",value:"refersTo"},beforeOpen:this.nameBoxBeforeOpen.bind(this),blur:this.nameBoxBlur.bind(this),select:this.nameBoxSelect.bind(this),open:function(c){t.isDevice&&(window.browserDetails.isDevice=!0)},change:function(){}}),this.comboBoxInstance.createElement=this.parent.createElement,this.comboBoxInstance.appendTo(a),this.comboBoxInstance.element.parentElement.title=i.getConstant("NameBox")}var o=n.appendChild(this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-insert-function",attrs:{title:i.getConstant("InsertFunction"),type:"button"}}));o.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons"})),this.insertFnRipple=yr(n,{selector:".e-insert-function"}),n.appendChild(this.parent.createElement("div",{className:"e-separator"}));var l=i.getConstant("FormulaBar"),h=n.appendChild(this.parent.createElement("textarea",{className:"e-formula-bar e-css",id:r+"_formula_input",attrs:{title:l,"aria-label":l,spellcheck:"false"}}));if(h.rows=1,this.parent.isMobileView())h.placeholder=i.getConstant("MobileFormulaBarPlaceHolder"),I.add(h,"focus",this.textAreaFocusIn,this),I.add(h,"blur",this.textAreaFocusOut,this);else{var u=i.getConstant("ExpandFormulaBar");n.appendChild(this.parent.createElement("span",{className:"e-drop-icon e-icons",attrs:{title:u,role:"button",tabindex:"-1","aria-label":u}}))}e&&e.uiUpdate?this.parent.element.insertBefore(n,document.getElementById(r+"_sheet_panel")):this.parent.element.appendChild(n)},s.prototype.textAreaFocusIn=function(){var e=this.parent.element.querySelector(".e-formula-bar-panel"),t=this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-formula-submit",attrs:{type:"button"}});t.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-tick-icon"})),e.classList.add("e-focused"),e.appendChild(t)},s.prototype.textAreaFocusOut=function(){var e=this.parent.element.querySelector(".e-formula-bar-panel");e.classList.remove("e-focused"),ne(e.querySelector(".e-formula-submit"))},s.prototype.keyDownHandler=function(e){var t=e.target;if(this.parent.isEdit&&(!this.parent.getActiveSheet().isProtected||t.classList.contains("e-formula-bar")&&!t.disabled)){if((Bt(t.value)||t.validity&&t.value.toString().indexOf("=")===0)&&e.keyCode===16)return;t.classList.contains("e-formula-bar")&&(!e.shiftKey||e.shiftKey&&!Gh(e.keyCode))&&this.parent.notify(Jt,{action:"refreshEditor",value:t.value,refreshEditorElem:!0})}},s.prototype.keyUpHandler=function(e){if(this.parent.isEdit){var t=e.target;if(t.classList.contains("e-formula-bar")){var i={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,i),i.editedValue!==t.value&&e.keyCode!==16&&(!e.shiftKey||e.shiftKey&&!Gh(e.keyCode))&&this.parent.notify(Jt,{action:"refreshEditor",value:t.value,refreshEditorElem:!0})}}},s.prototype.nameBoxBeforeOpen=function(e){this.comboBoxInstance.element.classList.contains("e-name-editing")?e.cancel=!0:(this.comboBoxInstance.element.select(),this.isDevice=window.browserDetails.isDevice,this.isDevice&&(window.browserDetails.isDevice=!1))},s.prototype.nameBoxBlur=function(){this.comboBoxInstance.element.classList.contains("e-name-editing")&&(this.comboBoxInstance.element.classList.remove("e-name-editing"),this.UpdateValueAfterMouseUp())},s.prototype.nameBoxSelect=function(e){if(e.isInteracted&&(!e.e||e.e.type!=="keydown"||e.e.keyCode!==40&&e.e.keyCode!==38)){var t=e.itemData.refersTo.substr(1),i=gt(this.parent,Ms(t));if(i===void 0)return;var r=nu(t),n=Pe(this.parent,i),a=void 0,o=void 0;if(r.indexOf(":")===-1)a=o=r.replace("$","");else{var l=r.indexOf(":");a=r.substr(0,l).replace("$",""),o=r.substr(l+1,r.length).replace("$","")}o.match(/\D/g)&&!o.match(/[0-9]/g)&&a.match(/\D/g)&&!a.match(/[0-9]/g)?(a=a+"1",o=o+n.rowCount,r=a+":"+o):!o.match(/\D/g)&&o.match(/[0-9]/g)&&!a.match(/\D/g)&&a.match(/[0-9]/g)&&(a=Je(parseInt(a,10)-1,0),o=Je(parseInt(o,10)-1,n.colCount-1),r=a+":"+o),i===this.parent.activeSheetIndex?(this.parent.selectRange(r),Fe(this.parent.element)):(Xp(this.parent,r,n),this.parent.activeSheetIndex=i)}},s.prototype.formulaBarUpdateHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r=i.selectedRange.split(":"),n,a={action:"getElement",element:null};this.parent.notify(Jt,a);var o=this.parent.element.querySelector(".e-formula-bar");if(e.type==="mousemove"||e.type==="pointermove"){var l=ee(r[0]),h=ee(r[1]);n=Math.abs(l[0]-h[0])+1+"R x "+(Math.abs(l[1]-h[1])+1)+"C",this.parent.isEdit&&(e.target&&!e.target.classList.contains("e-spreadsheet-edit")?this.parent.notify(h0,null):a.element&&(o.value=a.element.textContent))}else{n=r[0];var u=Ns(this.parent)+"!"+n;$s(this.parent,u,!1,!0).then(function(c){if(t.parent){var d="",p;c.forEach(function(f){if(f)if(f.formula)d=f.formula;else if(!m(f.value)&&f.value!==""){var v={},g=f.format&&yd(f.format,!0,v,!0)&&v.type;if(g==="date"||g==="time"||g==="datetime"){if(p=Nl(Number(f.value)),p&&p.toString()!=="Invalid Date"&&p.getFullYear()>=1900){var b=new _t,y=f.format.toLowerCase();g==="time"&&y.includes("m")&&!y.includes(":m")&&!y.includes("m:")&&!y.includes("[m")&&!y.includes("am")&&(g="date");var C=f.value.toString().split("."),x=C.length===2,w=x?Nl(parseFloat(C[0]+1+"."+C[1])||Number(f.value)):p;if(g==="date"){var M={type:"date"};M.skeleton="yMd",d=b.formatDate(p,M),x&&(d+=" "+b.formatDate(w,{type:"dateTime",skeleton:"hms"}))}else(Number(f.value)>=1||g==="datetime")&&(d=b.formatDate(p,{type:"dateTime",skeleton:"yMd"})+" "),d+=b.formatDate(w,{type:"dateTime",skeleton:"hms"})}}else f.format&&f.format.includes("%")&&He(f.value)&&(d=t.parent.getDisplayText(f),d.includes("%")||(d=""));if(!d){if(d=f.value.toString(),d.toLowerCase()==="true"||d.toLowerCase()==="false")d=d.toUpperCase();else if(t.parent.locale!=="en-US"){var E=Lo(t.parent.locale).decimal;E!=="."&&He(d)&&d.includes(".")&&(d=d.replace(".",E))}}}else f.hyperlink&&(d=typeof f.hyperlink=="string"?f.hyperlink:f.hyperlink.address||"");var T={action:"getCurrentEditValue",editedValue:""};t.parent.notify(Jt,T);var D=document.getElementById(t.parent.element.id+"_formula_input");D.value=d,(!T.editedValue||!Bt(T.editedValue.toString(),!0))&&t.parent.notify(Jt,{action:"refreshEditor",value:d,refreshEditorElem:!0}),t.parent.isEdit&&(e.target&&!e.target.classList.contains("e-spreadsheet-edit")?t.parent.notify(h0,null):a.element&&(o.value=a.element.textContent))})}})}this.updateComboBoxValue(n)},s.prototype.UpdateValueAfterMouseUp=function(){this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(":")[0])},s.prototype.updateComboBoxValue=function(e){var t=this.parent.getActiveSheet(),i=Ns(this.parent)+"!"+t.selectedRange,r={action:"getNameFromRange",range:i,definedName:null};if(this.parent.notify(Ho,r),r.definedName&&(e=r.definedName.name),!this.parent.isMobileView()){if(this.comboBoxInstance.text===e)return;this.comboBoxInstance.text=e,this.comboBoxInstance.dataBind()}},s.prototype.disabletextarea=function(){var e=this.getFormulaBar();this.parent.getActiveSheet().isProtected&&!this.parent.isEdit?e.disabled=!0:e.disabled=!1},s.prototype.formulaBarScrollEdit=function(){var e=ee(this.parent.getActiveSheet().selectedRange),t=xe(this.parent.getActiveSheet().topLeftCell);e[0]<t[0]&&(this.parent.goTo(this.parent.getActiveSheet().selectedRange),this.isGoto=!0),this.parent.notify(Jt,{action:"startEdit",refreshCurPos:!1})},s.prototype.formulaBarClickHandler=function(e){var t=e.target,i=this.parent.getActiveSheet(),r=i.isProtected,n=xe(i.activeCell),a=Y(n[0],n[1],i),o=Cn(a,oi(i,n[1]));if(t.classList.contains("e-drop-icon")&&t.parentElement.classList.contains("e-formula-bar-panel"))this.toggleFormulaBar(t);else if(t.classList.contains("e-formula-bar"))!this.parent.isEdit&&(!r||r&&!o)||this.parent.isEdit&&r&&!t.disabled?this.formulaBarScrollEdit():r&&o&&this.parent.notify(Ta,null);else if(t.parentElement&&t.parentElement.classList.contains("e-name-box"))if(t.classList.contains("e-ddl-icon")){var l={action:"getNames",names:[]};if(this.parent.notify(Ho,l),this.comboBoxInstance.dataSource.length!==l.names.length||this.comboBoxInstance.value===this.comboBoxInstance.text){var h=this.comboBoxInstance.text;this.comboBoxInstance.dataSource=l.names;var u=l.names.find(function(c){return c.name==h});this.comboBoxInstance.value=u?u.refersTo:this.comboBoxInstance.value,this.comboBoxInstance.dataBind()}}else this.comboBoxInstance.element.classList.add("e-name-editing"),this.comboBoxInstance.element.select();!m(t.offsetParent)&&(t.offsetParent.classList.contains("e-insert-function")||t.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===t.offsetParent.id||this.parent.element.id+"_insert_function"===t.id||t.parentElement.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===t.parentElement.id)&&this.renderInsertDlg()},s.prototype.renderInsertDlg=function(){var e=this,t=this.parent.getActiveSheet();if(t.isProtected){var i=xe(t.activeCell);if(Cn(Y(i[0],i[1],t),oi(t,i[1]))&&!this.parent.isEdit){this.parent.notify(Ta,null);return}}var r=this.parent.serviceLocator.getService(de),n=!this.parent.isEdit,a={action:"getCurrentEditValue",editedValue:""};if(!n){var o={action:"isFormulaEditing",isFormulaEdit:!1};this.parent.notify(Ho,o),n=o.isFormulaEdit,this.parent.notify(Jt,a)}if(n||a.editedValue===""){a.editedValue===""&&this.parent.notify(Jt,{action:"refreshEditor",value:"="});var l=this.parent.createElement("div",{className:"e-formula-description",id:this.parent.element.id+"_description_content"}),h=this.parent.createElement("div",{className:"e-category-content",id:this.parent.element.id+"_category_content"});h.innerText=r.getConstant("PickACategory");var u=this.parent.createElement("input",{className:"e-formula-category",id:this.parent.element.id+"_formula_category"}),c=this.parent.createElement("div",{className:"e-formula-list",id:this.parent.element.id+"_formula_list"}),d=this.parent.createElement("div",{className:"e-description-content"});d.innerText=r.getConstant("Description");var p=this.parent.createElement("div",{className:"e-header-content"});p.innerText=r.getConstant("InsertFunction");var f={action:"getFormulaCategory",categoryCollection:[]};this.parent.notify(xt,f),this.categoryCollection=f.categoryCollection;var v;this.categoryList=new Na({dataSource:this.categoryCollection,cssClass:"e-ss-formula-category",index:0,width:"285px",popupHeight:"210px",select:this.dropDownSelect.bind(this),open:function(){return v=!0},close:function(){return v=!1}});var g={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,g),this.formulaCollection=g.formulaCollection,this.formulaList=new Ib({dataSource:this.formulaCollection.sort(),actionComplete:this.updateFormulaList.bind(this),select:this.listSelected.bind(this),width:"285px",height:"200px"}),this.dialog=this.parent.serviceLocator.getService(At),this.parent.element.querySelector(".e-spreadsheet-function-dlg")||(this.dialog.show({header:p.outerHTML,content:h.outerHTML+u.outerHTML+c.outerHTML+d.outerHTML+l.outerHTML,width:"320px",height:"485px",cssClass:"e-spreadsheet-function-dlg",showCloseIcon:!0,isModal:!0,beforeOpen:function(b){var y={dialogName:"InsertFunctionDialog",element:b.element,target:b.target,cancel:b.cancel};e.parent.trigger("dialogBeforeOpen",y),y.cancel&&(b.cancel=!0),Fe(e.parent.element)},open:this.dialogOpen.bind(this),beforeClose:this.dialogBeforeClose.bind(this),close:this.dialogClose.bind(this),buttons:[{click:function(b){b&&b.keyCode===13&&!v||e.selectFormula()},buttonModel:{content:r.getConstant("Ok"),isPrimary:!0}}]}),this.categoryList.appendTo("#"+this.parent.element.id+"_formula_category"),this.formulaList.appendTo("#"+this.parent.element.id+"_formula_list"),I.add(this.formulaList.element,"dblclick",this.formulaClickHandler,this))}},s.prototype.toggleFormulaBar=function(e){var t=e.parentElement,i=this.parent.serviceLocator.getService(de);t.classList.contains("e-expanded")?(t.classList.remove("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=1,e.title=i.getConstant("ExpandFormulaBar"),e.setAttribute("aria-label",i.getConstant("CollapseFormulaBar"))):(t.classList.add("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=3,e.title=i.getConstant("CollapseFormulaBar"),e.setAttribute("aria-label",i.getConstant("ExpandFormulaBar"))),this.parent.setPanelSize()},s.prototype.dialogOpen=function(){var e=this;Vi(function(){var t=e.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary"),i=e.parent.serviceLocator.getService(de);t.setAttribute("aria-label",i.getConstant("InsertFunction")+" "+i.getConstant("Ok")),e.categoryList&&Fe(e.categoryList.element)})},s.prototype.dialogClose=function(){var e={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,e),e.editedValue.toString().trim()==="="&&this.parent.notify(Jt,{action:"refreshEditor",value:""})},s.prototype.dialogBeforeClose=function(){I.remove(this.formulaList.element,"dblclick",this.formulaClickHandler);var e=document.getElementsByClassName("e-spreadsheet-function-dlg")[0].querySelector(".e-dlg-content");e.parentNode.removeChild(e),this.categoryList.destroy(),this.categoryList=null,this.formulaList.destroy(),this.formulaList=null},s.prototype.selectFormula=function(){var e=this.formulaList.getSelectedItems().text,t=Pe(this.parent,this.parent.activeSheetIndex);this.parent.isEdit?this.parent.notify(Jt,{action:"refreshEditor",value:e+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(Jt,{action:"startEdit",value:"="+e+"(",address:t.activeCell}),this.parent.notify(Po,{action:"refreshFormulabar",value:"="+e+"("})),this.dialog.dialogInstance.storeActiveElement=document.getElementById(this.parent.element.id+"_edit"),this.dialog.hide()},s.prototype.listSelected=function(e){this.updateFormulaDescription(),e.isInteracted&&e.item&&e.item.focus()},s.prototype.updateFormulaList=function(){this.activeListFormula(),this.updateFormulaDescription()},s.prototype.dropDownSelect=function(e){this.formulaCollection=[];var t={action:"getLibraryFormulas",formulaCollection:[]};if(e.item.textContent==="All")this.parent.notify(xt,t),this.formulaCollection=t.formulaCollection;else{var i=e.item.textContent,r={action:"dropDownSelectFormulas",formulaCollection:[],selectCategory:i};this.parent.notify(xt,r),this.formulaCollection=r.formulaCollection}this.formulaList.dataSource=this.formulaCollection.sort()},s.prototype.activeListFormula=function(){var e=document.getElementById(this.parent.element.id+"_formula_list"),t=e.children[0].children[0].firstElementChild;this.formulaList.selectItem(t)},s.prototype.updateFormulaDescription=function(){var e=this.formulaList.getSelectedItems().text,t={action:"getFormulaDescription",description:"",selectedList:e,isCustom:!1};this.parent.notify(xt,t);var i=this.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary");i.hasAttribute("aria-label")&&i.removeAttribute("aria-label");var r=document.getElementById(this.parent.element.id+"_description_content");e=e==="AND"?"CalculateAND":e==="OR"?"CalculateOR":e,r.textContent=t.isCustom?t.description:this.parent.serviceLocator.getService(de).getConstant(e)},s.prototype.formulaClickHandler=function(e){var t=e.target,i=Pe(this.parent,this.parent.activeSheetIndex);(t.offsetParent.classList.contains("e-text-content")||t.classList.contains("e-list-item"))&&(this.parent.isEdit?this.parent.notify(Jt,{action:"refreshEditor",value:t.innerText+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(Jt,{action:"startEdit",value:"="+t.innerText+"(",address:i.activeCell}),this.parent.notify(Po,{action:"refreshFormulabar",value:"="+t.innerText+"("})),this.dialog.hide())},s.prototype.addEventListener=function(){this.parent.on(Wf,this.createFormulaBar,this),this.parent.on(hu,this.formulaBarClickHandler,this),this.parent.on(Ra,this.keyDownHandler,this),this.parent.on(wM,this.renderInsertDlg,this),this.parent.on(Xn,this.keyUpHandler,this),this.parent.on(Gs,this.formulaBarUpdateHandler,this),this.parent.on(D1,this.UpdateValueAfterMouseUp,this),this.parent.on(Po,this.editOperationHandler,this),this.parent.on(rM,this.disabletextarea,this),this.parent.on(bd,this.isFormulaBarEdit,this)},s.prototype.destroy=function(){this.removeEventListener(),this.comboBoxInstance&&this.comboBoxInstance.destroy(),this.comboBoxInstance=null,this.categoryCollection=null,this.formulaCollection=null,this.dialog=null,this.isGoto=null,this.insertFnRipple&&this.insertFnRipple(),this.insertFnRipple=null;var e=this.parent.element.querySelector(".e-formula-bar-panel");e&&(b0(e),ne(e))},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Wf,this.createFormulaBar),this.parent.off(hu,this.formulaBarClickHandler),this.parent.off(wM,this.renderInsertDlg),this.parent.off(Ra,this.keyDownHandler),this.parent.off(Xn,this.keyUpHandler),this.parent.off(Gs,this.formulaBarUpdateHandler),this.parent.off(D1,this.UpdateValueAfterMouseUp),this.parent.off(Po,this.editOperationHandler),this.parent.off(rM,this.disabletextarea),this.parent.off(bd,this.isFormulaBarEdit))},s.prototype.editOperationHandler=function(e){var t=e.action;switch(t){case"refreshFormulabar":this.getFormulaBar().value=Re(e.value)?"":e.value;break;case"getElement":e.element=this.getFormulaBar();break}},s.prototype.isFormulaBarEdit=function(e){var t=this.parent.isEdit;t&&this.isGoto?e.isEdit=!0:e.isEdit=!1},s.prototype.getFormulaBar=function(){return $("#"+this.parent.element.id+"_formula_input",this.parent.element)},s}(),YY=function(){function s(e){this.isFormulaBar=!1,this.isFormula=!1,this.isPopupOpened=!1,this.isPreventClose=!1,this.isSubFormula=!1,this.parent=e,this.addEventListener()}return s.prototype.getModuleName=function(){return"formula"},s.prototype.destroy=function(){this.removeEventListener(),this.autocompleteInstance&&(this.autocompleteInstance.destroy(),this.autocompleteInstance.element&&this.autocompleteInstance.element.remove()),this.autocompleteInstance=null,this.parent=null},s.prototype.addEventListener=function(){this.parent.on(Ho,this.performFormulaOperation,this),this.parent.on(Xn,this.keyUpHandler,this),this.parent.on(Ra,this.keyDownHandler,this),this.parent.on(hu,this.formulaClick,this),this.parent.on(K1,this.refreshFormulaDatasource,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ho,this.performFormulaOperation),this.parent.off(Xn,this.keyUpHandler),this.parent.off(Ra,this.keyDownHandler),this.parent.off(hu,this.formulaClick),this.parent.off(K1,this.refreshFormulaDatasource))},s.prototype.performFormulaOperation=function(e){var t=this,i=e.action,r=this.parent.serviceLocator.getService(de),n,a;switch(i){case"renderAutoComplete":this.renderAutoComplete();break;case"endEdit":this.endEdit();break;case"addDefinedName":e.isAdded=this.addDefinedName(e.definedName);break;case"getNames":e.sheetName||(e.sheetName=Ns(this.parent)),e.names=this.getNames(e.sheetName);break;case"getNameFromRange":e.definedName=this.getNameFromRange(e.range);break;case"isFormulaEditing":e.isFormulaEdit=this.isFormula;break;case"isCircularReference":n=this.parent.serviceLocator.getService(At),a=r.getConstant("CircularReference"),n.dialogInstance&&n.dialogInstance.visible&&n.dialogInstance.content===a||n.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:r.getConstant("CircularReference"),beforeOpen:function(o){var l={dialogName:"CircularReferenceDialog",element:o.element,target:o.target,cancel:o.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel&&(o.cancel=!0)}}),e.argValue="0";break}},s.prototype.renderAutoComplete=function(){if(!$("#"+this.parent.element.id+"_ac",this.parent.element)){var e=this.parent.createElement("input",{id:this.parent.element.id+"_ac",className:"e-ss-ac"});this.parent.element.appendChild(e);var t={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,t);var i={dataSource:t.formulaCollection,cssClass:"e-ss-atc",popupWidth:"130px",allowFiltering:!0,filterType:"StartsWith",sortOrder:"Ascending",open:this.onSuggestionOpen.bind(this),close:this.onSuggestionClose.bind(this),select:this.onSelect.bind(this),actionComplete:this.onSuggestionComplete.bind(this)};this.autocompleteInstance=new Kz(i,e),this.autocompleteInstance.createElement=this.parent.createElement}},s.prototype.onSuggestionOpen=function(e){var t=this;this.isPopupOpened=!0,e.popup.relateTo=this.getRelateToElem(),e.popup.element.firstChild.style.maxHeight="180px",new Promise(function(i,r){setTimeout(function(){i()},100)}).then(function(){t.triggerKeyDownEvent(Cs.DOWN)})},s.prototype.onSuggestionClose=function(e){this.isPreventClose?e.cancel=!0:this.isPopupOpened=!1},s.prototype.onSelect=function(e){var t="="+e.itemData.value+"(";if(this.isSubFormula){var i=this.getEditingValue(),r=i.lastIndexOf(this.getArgumentSeparator());r>-1?t=i.slice(0,r+1):(r=i.lastIndexOf("("),r>-1&&(t=i.slice(0,r+1))),t+=e.itemData.value+"("}if(this.parent.notify(Jt,{action:"refreshEditor",value:t,refreshFormulaBar:!0,refreshEditorElem:!0,refreshCurPos:!this.isFormulaBar}),this.isPopupOpened){this.hidePopUp();var n=$("#"+this.parent.element.id+"_ac_popup");n&&ne(n),this.isPopupOpened=!1}},s.prototype.onSuggestionComplete=function(e){this.isPreventClose=e.result.length>0,this.isPreventClose||(e.cancel=!0,this.hidePopUp())},s.prototype.refreshFormulaDatasource=function(){var e={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,e),this.autocompleteInstance&&(this.autocompleteInstance.dataSource=e.formulaCollection)},s.prototype.keyUpHandler=function(e){if(this.parent.isEdit){var t=this.getEditingValue();this.isFormula=Bt(t),(this.isFormula||this.isPopupOpened)&&(e.keyCode!==Cs.TAB&&this.isFormula&&(t=this.getSuggestionKeyFromFormula(t)),this.refreshFormulaSuggestion(e,t))}else this.isPopupOpened&&this.hidePopUp()},s.prototype.keyDownHandler=function(e){var t=e.keyCode;if(this.isFormula){if(this.isPopupOpened)switch(t){case Cs.UP:case Cs.DOWN:e.preventDefault(),this.triggerKeyDownEvent(t);break;case Cs.TAB:e.preventDefault(),this.triggerKeyDownEvent(Cs.ENTER);break}}else{var i=e.target;if(i.id===this.parent.element.id+"_name_box")switch(t){case Cs.ENTER:document.querySelector(".e-name-box.e-popup-open")||(this.addDefinedName({name:i.value}),Fe(this.parent.element));break;case Cs.ESC:Fe(this.parent.element);break}}},s.prototype.formulaClick=function(e){if(this.parent.isEdit){var t=e.target;this.isFormulaBar=t.classList.contains("e-formula-bar")}},s.prototype.refreshFormulaSuggestion=function(e,t){if(t.length>0){var i=this.autocompleteInstance.element,r=e.keyCode,n=this.isPopupOpened;Gh(r)||(i.value=t,i.dispatchEvent(new Event("input")),i.dispatchEvent(new Event("keyup")),n&&this.triggerKeyDownEvent(Cs.DOWN))}else this.isPopupOpened&&(this.isPreventClose=!1,this.hidePopUp())},s.prototype.endEdit=function(){if(this.isSubFormula=!1,this.isPreventClose=!1,this.isFormula=!1,this.isFormulaBar=!1,this.isPopupOpened){this.hidePopUp();var e=$("#"+this.parent.element.id+"_ac_popup");e&&ne(e),this.isPopupOpened=!1}},s.prototype.hidePopUp=function(){this.autocompleteInstance.hidePopup()},s.prototype.getSuggestionKeyFromFormula=function(e){var t="";if(e=e.substr(1),e){var i=e.lastIndexOf("(");e=e.substr(i+1);var r=e.split(this.getArgumentSeparator());r.length===1?(t=r[0],this.isSubFormula=i>-1):(t=r[r.length-1],this.isSubFormula=!0);var n=t.match(/\w/);(!n||n&&n.index!==0)&&(t="")}return t},s.prototype.getRelateToElem=function(){var e={action:"getElement"};return this.isFormulaBar?this.parent.notify(Po,e):this.parent.notify(Jt,e),e.element},s.prototype.getEditingValue=function(){var e={action:"getCurrentEditValue",editedValue:""};return this.parent.notify(Jt,e),e.editedValue},s.prototype.triggerKeyDownEvent=function(e){var t=this.autocompleteInstance.element;t.dispatchEvent(new Event("input"));var i=new Event("keydown");i.keyCode=e,i.which=e,i.altKey=!1,i.shiftKey=!1,i.ctrlKey=!1,t.dispatchEvent(i)},s.prototype.getArgumentSeparator=function(){var e={action:"getArgumentSeparator",argumentSeparator:""};return this.parent.notify(xt,e),e.argumentSeparator},s.prototype.getNames=function(e){var t=this.parent.definedNames.filter(function(i){return i.scope==="Workbook"||i.scope===""||i.scope===e});return t},s.prototype.getNameFromRange=function(e){var t=e.slice(0,e.indexOf(":")),i=e.slice(e.indexOf("!")+1).split(":"),r=i.length>1&&i[0]===i[1],n=this.parent.definedNames.filter(function(a){var o=a.refersTo.split("!");o[0].includes("'")&&o[0].match(/^='.*'$/)&&(o[0]="="+o[0].slice(2,-1));var l=o[0]+"!"+o[1].split("$").join("");return r&&l==="="+t?!0:l==="="+e});return n&&n[0]},s.prototype.addDefinedName=function(e){var t=this,i=e.name,r=!1;if(i&&ur(i.toUpperCase()))return this.parent.goTo(i),r;if(!e.refersTo){var n=Pe(this.parent,this.parent.activeSheetIndex),a=Ns(this.parent);a=a.indexOf(" ")!==-1?"'"+a+"'":a;var o=n.selectedRange;if(!m(o)){var l=o.indexOf(":"),h=o.substr(0,l),u=o.substr(l+1,o.length);parseInt(u.replace(/\D/g,""),10)===n.rowCount&&parseInt(h.replace(/\D/g,""),10)===1?(u=u.replace(/[0-9]/g,""),h=h.replace(/[0-9]/g,""),o="$"+h+":$"+u):xe(u)[1]===n.colCount-1&&xe(h)[1]===0?(u=u.replace(/\D/g,""),h=h.replace(/\D/g,""),o="$"+h+":$"+u):o=h===u?h:o}e.refersTo=a+"!"+o,e.scope="Workbook"}if(i.length>0&&/^([a-zA-Z_0-9.]){0,255}$/.test(i)){var c={action:"addDefinedName",definedName:e,isAdded:!1};this.parent.notify(xt,c),r=c.isAdded,c.isAdded||this.parent.serviceLocator.getService(At).show({content:this.parent.serviceLocator.getService(de).getConstant("DefineNameExists"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameExistsDialog",element:d.element,target:d.target,cancel:d.cancel};t.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}})}else this.parent.serviceLocator.getService(At).show({content:this.parent.serviceLocator.getService(de).getConstant("DefineNameInValid"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameInValidDialog",element:d.element,target:d.target,cancel:d.cancel};t.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}});return r},s}(),QY=function(){function s(e){this.aggregateContent="",this.selaggregateCnt="Sum",this.parent=e,this.addEventListener()}return s.prototype.getModuleName=function(){return"sheetTabs"},s.prototype.createSheetTabs=function(){var e=this;if(!this.parent.showSheetTabs&&this.tabInstance){this.destroy();return}var t=this.parent.serviceLocator.getService(de),i=this.parent.createElement("div",{className:"e-sheet-tab-panel",id:this.parent.element.id+"_sheet_tab_panel"}),r=this.parent.createElement("button",{className:"e-add-sheet-tab e-btn e-css e-flat e-icon-btn"+(this.parent.allowInsert?"":" e-disabled"),attrs:{title:t.getConstant("AddSheet"),type:"button"}});r.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-add-icon"})),r.addEventListener("click",this.addSheetTab.bind(this)),r.disabled=!this.parent.allowInsert,i.appendChild(r),this.addBtnRipple=yr(i,{selector:".e-add-sheet-tab"});var n=this.parent.createElement("button",{attrs:{title:t.getConstant("ListAllSheets"),type:"button"}});i.appendChild(n),this.parent.element.appendChild(i);var a=this.getSheetTabItems();this.dropDownInstance=new Or({iconCss:"e-icons",items:a.ddbItems,createPopupOnClick:!0,beforeItemRender:function(p){var f=e.parent.sheets[e.dropDownInstance.items.indexOf(p.item)];f.state==="Hidden"?p.element.classList.add("e-hide"):f.state==="VeryHidden"&&(p.element.style.display="none")},select:function(p){return e.updateSheetTab({idx:e.dropDownInstance.items.indexOf(p.item)})},beforeOpen:function(p){return e.beforeOpenHandler(e.dropDownInstance,p.element,t.getConstant("ListAllSheets"))},open:function(p){return e.openHandler(e.dropDownInstance,p.element,"left")},cssClass:"e-sheets-list e-flat e-caret-hide",close:function(){return e.focusTab(e.tabInstance.element)}}),this.dropDownInstance.createElement=this.parent.createElement,this.dropDownInstance.appendTo(n);var o=this.parent.createElement("div",{className:"e-sheet-tab"}),l;this.tabInstance=new UI({selectedItem:this.parent.activeSheetIndex,overflowMode:"Scrollable",items:a.tabItems,scrollStep:250,selecting:function(p){if(p.selectingIndex!==p.selectedIndex)if(l)l=!1;else{var f={currentSheetIndex:p.selectingIndex,previousSheetIndex:p.selectedIndex,cancel:!1};e.parent.notify(li,{eventArgs:f,action:"gotoSheet"}),l=f.cancel}},selected:function(p){p.isInteracted||(p.preventFocus=!0),e.goToSheet(p,l,!0)},created:function(){var p=e.tabInstance.element.querySelector(".e-toolbar-items");p.classList.add("e-sheet-tabs-items"),I.add(p,"dblclick",e.renameSheetTab,e)}}),i.appendChild(o),this.tabInstance.createElement=this.parent.createElement,this.tabInstance.appendTo(o),I.remove(this.tabInstance.element,"keydown",this.tabInstance.spaceKeyDown);for(var h=a.tabItems.length,u,c=0;c<h;c++){u=Pe(this.parent,c);var d={action:"addSheet",sheetName:"Sheet"+u.id,sheetId:u.id,visibleName:u.name};this.parent.notify(xt,d)}this.parent.notify(xt,{action:"initiateDefinedNames"}),this.parent.notify(Wc,null)},s.prototype.goToSheet=function(e,t,i){var r=this;if(e.selectedIndex!==e.previousIndex){if(t){this.tabInstance.selectedItem=e.previousIndex,this.tabInstance.dataBind(),Fe(this.parent.element);return}if(this.parent.notify(qh,{}),this.parent.isEdit){var n=window.getSelection(),a={action:"getCurrentEditValue",editedValue:""};this.parent.notify(Jt,a);var o=a.editedValue?Bt(a.editedValue,!0):!1;!o&&n&&n.focusNode&&n.focusNode.classList&&n.focusNode.classList.contains("e-formula-bar-panel")&&(o=Bt(this.parent.element.querySelector(".e-formula-bar").value,!0)),o||this.parent.endEdit()}this.parent.activeSheetIndex=e.selectedIndex,this.parent.dataBind(),this.updateDropDownItems(e.selectedIndex,e.previousIndex);var l={action:"registerGridInCalc",sheetID:(e.selectedIndex+1).toString()};this.parent.notify(xt,l),i&&(this.parent.notify(yt,{eventArgs:{previousSheetIndex:e.previousIndex,currentSheetIndex:e.selectedIndex},action:"gotoSheet"}),Vi(function(){return Fe(r.parent.element)}))}},s.prototype.updateDropDownItems=function(e,t){t>-1&&(this.dropDownInstance.items[t].iconCss=""),this.dropDownInstance.items[e].iconCss="e-selected-icon e-icons",this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0)},s.prototype.beforeOpenHandler=function(e,t,i){var r=this.parent.viewport.height,n=parseInt(getComputedStyle(t.firstElementChild).height,10)*e.items.length+parseInt(getComputedStyle(t).paddingTop,10)*2;n>r&&(t.style.height=r+"px",t.style.overflowY="auto"),t.parentElement.style.visibility="hidden",i&&t.setAttribute("aria-label",i)},s.prototype.openHandler=function(e,t,i){var r=t.parentElement,n,a=Qa(r);if(a.indexOf("bottom")===-1){n=t.style.overflowY==="auto"?this.parent.viewport.height:r.getBoundingClientRect().height;var o=Fr(e.element,i,"top");i==="right"&&(o.left-=r.getBoundingClientRect().width),r.style.left=o.left+"px",r.style.top=o.top-n+"px"}r.style.visibility="",Fe(t)},s.prototype.getSheetTabItems=function(){var e=this,t=[],i=[],r;return this.parent.sheets.forEach(function(n,a){r=Ns(e.parent,a).replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.push({header:{text:r},visible:n.state==="Visible"}),i.push({text:r,iconCss:a===e.parent.activeSheetIndex?"e-selected-icon e-icons":""})}),{tabItems:t,ddbItems:i}},s.prototype.refreshSheetTab=function(){var e=this.getSheetTabItems();this.dropDownInstance.items=e.ddbItems,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.items=e.tabItems,this.tabInstance.selectedItem=this.parent.activeSheetIndex,this.tabInstance.dataBind()},s.prototype.addSheetTab=function(){this.parent.notify(Js,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1})},s.prototype.insertSheetTab=function(e){this.parent.notify(qh,{}),(!e.preventUpdate||e.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss="");for(var t=e.startIdx;t<=e.endIdx;t++){var i=this.parent.sheets[t].name.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.dropDownInstance.items.splice(t,0,{text:i}),this.tabInstance.addTab([{header:{text:i},content:""}],t)}(!e.preventUpdate||e.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[e.startIdx].iconCss="e-selected-icon e-icons"),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),e.preventUpdate?e.startIdx!==this.tabInstance.selectedItem&&this.refreshSheetTab():this.updateSheetTab({idx:e.startIdx,preventDataBind:!0})},s.prototype.updateSheetTab=function(e){if(e.name==="activeSheetChanged")e.idx=this.parent.skipHiddenSheets(e.idx);else if(this.parent.sheets[e.idx].state==="Hidden"){if(this.parent.isProtected)return;this.showSheet({sheetIndex:e.idx,triggerEvent:!0})}this.tabInstance.selectedItem=e.idx,e.preventDataBind||this.tabInstance.dataBind(),this.parent.notify(Wc,null)},s.prototype.showSheet=function(e){this.parent.setSheetPropertyOnMute(this.parent.sheets[e.sheetIndex],"state","Visible"),this.tabInstance.hideTab(e.sheetIndex,!1),e.triggerEvent&&this.parent.notify(yt,{action:"showSheet",eventArgs:{sheetIndex:e.sheetIndex}})},s.prototype.switchSheetTab=function(e){var t=U(e.event.target,".e-toolbar-item");if(t){for(var i=t.querySelector(".e-tab-text").textContent,r=[],n=this.parent.element.id+"_cmenu",a=0,o=this.parent.sheets.length;a<o;a++)if(this.parent.sheets[a].name===i){this.parent.activeSheetIndex!==a&&this.updateSheetTab({idx:a});break}e.element.classList.contains("e-contextmenu")&&e.items[0]&&e.items[0].id===this.parent.element.id+"_cmenu_insert_sheet"&&(this.skipHiddenSheets()===1&&r.push(n+"_hide_sheet",n+"_delete_sheet"),(!this.parent.allowInsert||this.parent.isProtected)&&r.push(n+"_insert_sheet"),!this.parent.allowDelete&&r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet")),(this.parent.password.length>0||this.parent.isProtected)&&(r.indexOf(n+"_insert_sheet")>-1&&r.push(n+"_insert_sheet"),r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet"),r.push(n+"_duplicate",n+"_rename",n+"_hide_sheet",n+"_delete_sheet",n+"_insert_sheet",n+"_move_left",n+"_move_right")),this.parent.enableContextMenuItems(r,!1,!0)}},s.prototype.skipHiddenSheets=function(){var e=this.parent.sheets.length;return this.parent.sheets.forEach(function(t){t.state!=="Visible"&&--e}),e},s.prototype.renameSheetTab=function(){var e=this.tabInstance.element.querySelector(".e-toolbar-item.e-active");if(e){e=e.querySelector(".e-text-wrap");var t=e.querySelector(".e-tab-text").textContent,i={eventArgs:{name:t,index:this.parent.getActiveSheet().id},action:"renameSheet",cancel:!1};if(this.parent.trigger("actionBegin",i),i.cancel||this.parent.isProtected)return;var r=this.parent.createElement("input",{id:this.parent.element.id+"_rename_input",className:"e-input e-sheet-rename",styles:"width: "+e.getBoundingClientRect().width+"px",attrs:{type:"text",name:"Rename",required:"",value:t,spellcheck:"false",maxlength:"31"}});e.firstElementChild.style.display="none",e.appendChild(r),I.add(document,"mousedown touchstart",this.renameInputFocusOut,this),I.add(r,"keydown",this.renameKeyDown,this),I.add(r,"input",this.updateWidth,this),r.focus(),r.setSelectionRange(0,t.length),I.remove(U(e,".e-toolbar-items"),"dblclick",this.renameSheetTab)}},s.prototype.updateWidth=function(e){var t=e.target,i=t.value.length,r=t.value.split(" ");if(r.length){var n=r.length-1;i-=n,i+=n*.5}t.style.width=i+"ch"},s.prototype.renameKeyDown=function(e){e.keyCode===32?e.stopPropagation():e.keyCode===27?(this.removeRenameInput(e.target),this.focusTab(this.tabInstance.element)):e.keyCode===13&&this.renameInputFocusOut(e)},s.prototype.renameInputFocusOut=function(e){var t=e.target;if(!((e.type==="mousedown"||e.type==="touchstart")&&(t.classList.contains("e-sheet-rename")||U(t,".e-dlg-container")))){t=document.getElementById(this.parent.element.id+"_rename_input");var i=t.value,r=this.parent.serviceLocator.getService(de);if(i){var n=this.tabInstance.selectedItem;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*")))this.showRenameDialog(t,r.getConstant("SheetRenameInvalidAlert"));else{if(this.parent.sheets[n].name!==i){for(var a=0,o=this.parent.sheets.length;a<o;a++)if(a!==this.parent.activeSheetIndex&&this.parent.sheets[a].name.toLowerCase()===i.toLowerCase()){this.showRenameDialog(t,r.getConstant("SheetRenameAlreadyExistsAlert"));return}}var l=this.removeRenameInput(t);this.parent.sheets[n].name!==i&&(this.parent.setSheetPropertyOnMute(this.parent.sheets[n],"name",i),this.updateSheetName({value:i,idx:n,items:l})),e.type==="keydown"?this.focusTab(l):U(e.target,".e-spreadsheet")&&Fe(this.parent.element)}}else this.showRenameDialog(t,r.getConstant("SheetRenameEmptyAlert"));this.parent.notify(yt,{eventArgs:{index:this.parent.getActiveSheet().id,value:i},action:"renameSheet"})}},s.prototype.focusTab=function(e){Fe($(".e-toolbar-item.e-active .e-tab-wrap",e))},s.prototype.updateSheetName=function(e){var t=this.tabInstance.items[e.idx].header.text.replace(/&lt;/g,"<").replace(/&gt;/g,">"),i=e.value.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.tabInstance.items[e.idx].header.text=i,this.dropDownInstance.items[e.idx].text=i,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0);var r=e.items.querySelectorAll(".e-toolbar-item")[e.idx].querySelector(".e-tab-text");if(r.textContent="",r.appendChild(document.createTextNode(e.value)),e.value.indexOf("  ")>-1?this.tabInstance.setProperties({items:this.tabInstance.items},!0):this.tabInstance.dataBind(),this.parent.notify(xt,{action:"renameUpdation",value:e.value,pName:t}),this.parent.allowChart){var n;this.parent.chartColl.forEach(function(a){a.range.includes("!")&&(n=a.range.split("!"),n[0].toLowerCase()===t.toLowerCase()&&(n[0]=e.value,a.range=n.join("!")))})}},s.prototype.hideSheet=function(e){var t={action:"hideSheet",eventArgs:{sheetIndex:e.sheetIndex,cancel:!1}};e.triggerEvent&&(this.parent.notify(li,t),t.eventArgs.cancel)||(this.parent.setSheetPropertyOnMute(Pe(this.parent,e.sheetIndex),"state","Hidden"),this.tabInstance.hideTab(e.sheetIndex),e.triggerEvent&&(delete t.eventArgs.cancel,this.parent.notify(yt,t)))},s.prototype.removeRenameInput=function(e){var t=e.parentElement.querySelector(".e-tab-text"),i=U(e,".e-toolbar-items");return I.add(i,"dblclick",this.renameSheetTab,this),I.remove(document,"mousedown touchstart",this.renameInputFocusOut),I.remove(e,"keydown",this.renameKeyDown),I.remove(e,"input",this.updateWidth),pt(e),t.style.display="",i},s.prototype.showRenameDialog=function(e,t){var i=this,r=this.parent.serviceLocator.getService(At);r.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:t,beforeOpen:function(n){var a={dialogName:"SheetRenameDialog",element:n.element,target:n.target,cancel:n.cancel};i.parent.trigger("dialogBeforeOpen",a),a.cancel&&(n.cancel=!0),n.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",t+" "+i.parent.serviceLocator.getService(de).getConstant("Ok")),e.focus()},close:function(){return e.setSelectionRange(0,e.value.length)}})},s.prototype.focusRenameInput=function(){var e=document.getElementById(this.parent.element.id+"_rename_input");e&&e.focus()},s.prototype.removeSheetTab=function(e){var t=this;if(!(e.count&&e.count===this.parent.sheets.length)){var i=this.parent.serviceLocator.getService(de);if(this.skipHiddenSheets()>1){var r=e.sheetName?Pe(this.parent,gt(this.parent,e.sheetName)):this.parent.getActiveSheet(),n=m(e.index)?gt(this.parent,r.name):e.index,a={index:n,sheetCount:this.parent.sheets.length,sheetName:r.name},o=r.rows&&r.rows.length?r.rows.length===1?!!(r.rows[0].cells&&r.rows[0].cells.length):!0:!1;if(o){var l=this.parent.serviceLocator.getService(At);e.clicked?this.forceDelete(n):l.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-delete-sheet-dlg",content:i.getConstant("DeleteSheetAlert"),beforeOpen:function(h){var u={dialogName:"DeleteSheetDialog",element:h.element,target:h.target,cancel:h.cancel};t.parent.trigger("dialogBeforeOpen",u),u.cancel&&(h.cancel=!0),h.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",i.getConstant("DeleteSheetAlert")+" "+i.getConstant("Ok")),Fe(t.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){l.hide(),t.forceDelete(n),t.parent.notify(mu,null),e&&!e.isAction&&(a.sheetCount=t.parent.sheets.length,t.parent.notify(yt,{eventArgs:a,action:"removeSheet"}))}}]})}else this.parent.notify(xt,{action:"deleteSheetTab",sheetId:Pe(this.parent,n).id}),this.destroySheet(n),this.parent.notify(mu,null),e&&!e.isAction&&(a.sheetCount=this.parent.sheets.length,this.parent.notify(yt,{eventArgs:a,action:"removeSheet"}))}else this.parent.serviceLocator.getService(At).show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:i.getConstant("DeleteSingleLastSheetAlert"),beforeOpen:function(h){var u={dialogName:"DeleteSingleSheetDialog",element:h.element,target:h.target,cancel:h.cancel};t.parent.trigger("dialogBeforeOpen",u),u.cancel&&(h.cancel=!0)}})}},s.prototype.forceDelete=function(e){this.parent.notify(qh,{}),this.parent.notify(xt,{action:"deleteSheetTab",sheetId:Pe(this.parent,e).id}),this.destroySheet(e)},s.prototype.destroySheet=function(e){var t=m(e)?this.parent.activeSheetIndex:e;this.parent.removeSheet(t),this.parent.notify(Jl,{sheetIndex:t}),this.dropDownInstance.items.splice(t,1),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.removeTab(t);var i=this.parent.skipHiddenSheets(this.tabInstance.selectedItem);this.parent.activeSheetIndex=i,this.parent.setProperties({activeSheetIndex:i},!0),this.parent.renderModule.refreshSheet(),this.tabInstance.selectedItem=i,this.tabInstance.dataBind(),this.updateDropDownItems(i),this.parent.notify(Wc,null)},s.prototype.showAggregate=function(){var e=this;if(!Af(ee(this.parent.getActiveSheet().selectedRange))){var t={Count:0,Sum:"0",Avg:"0",Min:"0",Max:"0",countOnly:!0};if(this.parent.notify(Gp,t),t.Count>1){this.aggregateContent=t.countOnly?"Count":this.selaggregateCnt,t.countOnly&&(this.aggregateContent="Count",delete t.Sum,delete t.Avg,delete t.Min,delete t.Max);var i=t.countOnly?"e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide":"e-aggregate-list e-flat";delete t.countOnly;var r=this.aggregateContent,n=r+": "+t[r.toString()];if(this.aggregateDropDown)this.updateAggregateContent(n,t);else{var a=this.parent.createElement("button",{id:this.parent.element.id+"_aggregate",attrs:{type:"button"}});document.getElementById(this.parent.element.id+"_sheet_tab_panel").appendChild(a),this.aggregateDropDown=new Or({content:n,items:this.getAggregateItems(t),createPopupOnClick:!0,select:function(o){e.parent.notify(Gp,t),e.updateAggregateContent(o.item.text,{Count:t.Count,Sum:t.Sum,Avg:t.Avg,Min:t.Min,Max:t.Max},!0)},beforeOpen:function(o){return e.beforeOpenHandler(e.aggregateDropDown,o.element)},open:function(o){return e.openHandler(e.aggregateDropDown,o.element,"right")},close:function(){return Fe(e.parent.element)},cssClass:i}),this.aggregateDropDown.createElement=this.parent.createElement,this.aggregateDropDown.appendTo(a)}}else this.removeAggregate()}},s.prototype.getAggregateItems=function(e){var t=this,i=[],r,n,a;return Object.keys(e).forEach(function(o){a=e[""+o],a!==Gp&&(r=o+": "+a,n=o===t.aggregateContent?"e-selected-icon e-icons":"",i.push({text:r,iconCss:n}))}),i},s.prototype.updateAggregateContent=function(e,t,i){this.aggregateContent=e.split(": ")[0],i&&(this.selaggregateCnt=e.split(": ")[0]),this.aggregateDropDown.content=e,this.aggregateDropDown.dataBind(),this.aggregateDropDown.setProperties({items:this.getAggregateItems(t)},!0)},s.prototype.removeAggregate=function(){m(this.aggregateDropDown)||(this.aggregateDropDown.destroy(),pt(this.aggregateDropDown.element),this.aggregateDropDown=null)},s.prototype.addEventListener=function(){this.parent.on(Gy,this.createSheetTabs,this),this.parent.on(Wl,this.refreshSheetTab,this),this.parent.on(A1,this.insertSheetTab,this),this.parent.on(Xy,this.removeSheetTab,this),this.parent.on(N1,this.renameSheetTab,this),this.parent.on(uu,this.switchSheetTab,this),this.parent.on(fu,this.updateSheetTab,this),this.parent.on(sa,this.removeAggregate,this),this.parent.on(qf,this.focusRenameInput,this),this.parent.on(Yf,this.focusRenameInput,this),this.parent.on(Zy,this.updateSheetName,this),this.parent.on(Jy,this.hideSheet,this),this.parent.on(wd,this.showAggregate,this),this.parent.on(sM,this.goToSheet,this),this.parent.on(aM,this.showSheet,this)},s.prototype.destroy=function(){this.removeEventListener(),this.dropDownInstance&&this.dropDownInstance.destroy(),this.dropDownInstance=null,this.tabInstance&&this.tabInstance.destroy(),this.tabInstance=null,this.removeAggregate(),this.aggregateContent=null,this.addBtnRipple&&this.addBtnRipple(),this.addBtnRipple=null,I.remove(document,"mousedown touchstart",this.renameInputFocusOut);var e=document.getElementById(this.parent.element.id+"_sheet_tab_panel");e&&pt(e),this.parent=null},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Gy,this.createSheetTabs),this.parent.off(Wl,this.refreshSheetTab),this.parent.off(A1,this.insertSheetTab),this.parent.off(Xy,this.removeSheetTab),this.parent.off(N1,this.renameSheetTab),this.parent.off(uu,this.switchSheetTab),this.parent.off(fu,this.updateSheetTab),this.parent.off(sa,this.removeAggregate),this.parent.off(qf,this.focusRenameInput),this.parent.off(Yf,this.focusRenameInput),this.parent.off(Zy,this.updateSheetName),this.parent.off(Jy,this.hideSheet),this.parent.off(wd,this.showAggregate),this.parent.off(sM,this.goToSheet),this.parent.off(aM,this.showSheet))},s}(),GY=function(){function s(e){this.isImportedFile=!1,this.unProtectSheetIdx=[],this.parent=e,this.addEventListener(),this.renderFileUpload()}return s.prototype.addEventListener=function(){this.parent.on(Ty,this.openSuccess,this),this.parent.on(t1,this.openFailed,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ty,this.openSuccess),this.parent.off(t1,this.openFailed))},s.prototype.renderFileUpload=function(){var e=this.parent.element.id+"_fileUpload";this.parent.element.appendChild(this.parent.createElement("input",{id:e,attrs:{type:"file",accept:".xls, .xlsx, .csv, .xlsm, .xlsb",name:"fileUpload"}}));var t=document.getElementById(e);t.onchange=this.fileSelect.bind(this),t.onerror=this.openFailed.bind(this),t.style.display="none"},s.prototype.fileSelect=function(e){var t=e.target.files[0];if(!(t&&t.length<1)){var i={file:t};this.parent.open(i),document.getElementById(this.parent.element.id+"_fileUpload").value=""}},s.prototype.openSuccess=function(e){var t=this,i=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],r=function(u){t.parent.serviceLocator.getService(At).hide(!0);var c=new File([],e.guid,{type:u.toLowerCase()});t.parent.open({file:c,guid:e.guid,password:e.eventArgs.password,orginalFile:e.eventArgs.file})};if(i.indexOf(e.data)>-1){var n=this.parent.serviceLocator.getService(de);if(i[2]===e.data)this.parent.element.querySelector(".e-importprotectworkbook-dlg")||this.parent.notify(yM,e.eventArgs);else if(i[3]===e.data){var a=this.parent.createElement("span",{className:"e-importprotectpwd-alert-span"});a.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-importprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(a)}else if(i[4]===e.data){var a=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});a.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(a)}else if(i[5]===e.data){this.parent.isOpen=!1,this.parent.notify(SM,null);var o=this.parent.serviceLocator.getService(At);o.hide(),this.parent.hideSpinner()}else if(i[8]===e.data){var o=this.parent.serviceLocator.getService(At);o.hide(!0);var l=e.data.includes("ExternalWorkbook");this.parent.serviceLocator.getService(At).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("ExternalWorkbook"),width:"350",buttons:l?[{click:r.bind(this,e.data+"Yes"),buttonModel:{content:n.getConstant("Yes"),isPrimary:!0}},{click:r.bind(this,e.data+"No"),buttonModel:{content:n.getConstant("No")}}]:[],beforeOpen:function(c){var d={dialogName:"OpenDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel&&(c.cancel=!0)}},l?!0:null),this.parent.hideSpinner();return}else{var o=this.parent.serviceLocator.getService(At);o.hide(!0);var h=e.data.includes("LimitExceeded");this.parent.serviceLocator.getService(At).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant(e.data),width:"300",buttons:h?[{click:r.bind(this,e.data+"Open"),buttonModel:{content:n.getConstant("Ok"),isPrimary:!0}},{click:r.bind(this,e.data+"Cancel"),buttonModel:{content:n.getConstant("Cancel")}}]:[],beforeOpen:function(c){var d={dialogName:"OpenDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel&&(c.cancel=!0)}},h?!0:null),this.parent.hideSpinner();return}}else{var o=this.parent.serviceLocator.getService(At);o.hide(),this.parent.showSpinner()}this.parent.element&&i[5]!==e.data&&(e.isOpenFromJson||(this.parent.trigger("openComplete",{response:e}),this.parent.notify(yt,{response:e,action:"import"})),this.parent.notify(cd,{cellRef:null,isOpen:!0}),this.parent.isProtected&&this.parent.showSheetTabs&&e.isOpenFromJson&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.renderModule.refreshSheet(e.isOpenFromJson,!1,!1,!1,e),this.parent.notify(Wl,null),this.isImportedFile=!0,this.preventFormatCheck=e.eventArgs&&e.eventArgs.file&&e.eventArgs.file.name&&!e.eventArgs.file.name.includes(".csv"),this.unProtectSheetIdx=[],this.parent.hideSpinner())},s.prototype.openFailed=function(e){this.parent.trigger("openFailure",e),this.parent.hideSpinner()},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"open"},s}(),$Y=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(kf,this.initiateSave,this),this.parent.on(Of,this.saveCompleted,this),this.parent.on(f1,this.showErrorDialog,this),this.parent.on(Lf,this.exportDialog,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(kf,this.initiateSave),this.parent.off(Of,this.saveCompleted),this.parent.off(f1,this.showErrorDialog),this.parent.off(Lf,this.exportDialog))},s.prototype.getModuleName=function(){return"save"},s.prototype.initiateSave=function(){this.parent.showSpinner()},s.prototype.saveCompleted=function(){this.parent.hideSpinner()},s.prototype.showErrorDialog=function(e){var t=this,i=this.parent.serviceLocator.getService(At);i.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:e.content,beforeOpen:function(){return Fe(t.parent.element)}})},s.prototype.exportDialog=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.serviceLocator.getService(At),n=e?e.item.id.split(this.parent.element.id+"_")[1]:"xlsx";if(m(this.parent.element.querySelector(".e-find-dlg"))){var a={isModal:!0,showCloseIcon:!0,cssClass:"e-open-dlg",header:i.getConstant("SaveAs"),beforeOpen:function(o){var l={dialogName:i.getConstant("SaveAs"),element:o.element,target:o.target,cancel:o.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel&&(o.cancel=!0),r.dialogInstance.content=t.OpenContent(n),r.dialogInstance.dataBind(),t.parent.element.querySelector(".e-text-open").setSelectionRange(0,t.parent.element.querySelector(".e-text-open").value.length),Fe(t.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Save"),isPrimary:!0,cssClass:"e-btn-open-ok"},click:function(){var o=t.parent.element.querySelector(".e-text-open").value;if(t.checkValidName(o)){r.hide();var l=e?e.item.id.split(t.parent.element.id+"_")[1]:"Xlsx";t.parent.save({saveType:l,fileName:o})}else{var h=t.parent.element.querySelector(".e-btn-open-ok"),u=Ct(h,"btn");u.disabled=!0;var c=t.parent.serviceLocator.getService(de),d=o.length===0?c.getConstant("EmptyFileName"):o.length>218?c.getConstant("LargeName"):c.getConstant("FileNameError"),p=t.parent.createElement("span",{className:"e-file-alert-span"});p.innerText=d,t.parent.element.querySelector(".e-file-alert-span")&&t.parent.element.querySelector(".e-file-alert-span").remove(),t.parent.element.querySelector(".e-open-dlg").querySelector(".e-dlg-content").appendChild(p)}}}],close:function(){r.hide()}};r.show(a)}else r.hide()},s.prototype.checkValidName=function(e){var t=!0;return(e.match(new RegExp('.*[\\[\\]\\*\\\\/\\?\\:\\<\\>\\|\\"].*'))||e.length<1||e.length>218)&&(t=!1),t},s.prototype.OpenContent=function(e){var t=this,i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("div",{className:"e-open-dialog"}),n=this.parent.createElement("div",{className:"e-open-head"}),a=this.parent.createElement("div",{className:"e-input-group"});r.appendChild(n),r.appendChild(a);var o=i.getConstant("FileName"),l=this.parent.element.id+"_filename",h=this.parent.createElement("p",{className:"e-header",id:l,attrs:{"aria-label":i.getConstant("SaveAs")+" "+o}});h.innerText=o;var u=this.parent.createElement("input",{className:"e-input e-text-open",attrs:{type:"Text","aria-labelledby":l}}),c=this.parent.createElement("span",{className:"e-input-group-icon"});return u.onkeyup=function(d){if(t.parent.element.querySelector(".e-file-alert-span")&&d.keyCode!==13){var p=t.parent.element.querySelector(".e-btn-open-ok"),f=Ct(p,"btn");f.disabled=!1,t.parent.element.querySelector(".e-file-alert-span").remove()}},n.appendChild(h),c.textContent="."+e.toLowerCase(),a.appendChild(u),u.setAttribute("value","Sample"),a.appendChild(c),r},s}(),XY=function(){function s(e){this.parent=e,this.init()}return s.prototype.init=function(){this.initContextMenu(),this.addEventListener()},s.prototype.initContextMenu=function(){var e=document.createElement("ul");e.id=this.parent.element.id+"_contextmenu",this.parent.element.appendChild(e),this.contextMenuInstance=new Wz({cssClass:"e-spreadsheet-contextmenu",target:"#"+this.parent.element.id,filter:"e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items",select:this.selectHandler.bind(this),beforeOpen:this.beforeOpenHandler.bind(this),beforeClose:this.beforeCloseHandler.bind(this),beforeItemRender:function(t){t.element.setAttribute("aria-label",t.item.text)}},e),e.setAttribute("role","menu")},s.prototype.beforeCloseHandler=function(e){var t=this;this.parent.trigger("contextMenuBeforeClose",e),this.parent.enableKeyboardShortcut&&e.event&&e.event.keyCode===27&&Vi(function(){return Fe(t.parent.element)})},s.prototype.selectHandler=function(e){var t=me({cancel:!1},e);this.parent.trigger("contextMenuItemSelect",t);var i=this.parent.element.id+"_cmenu",r;if(!t.cancel){var n=void 0;switch(e.item.id){case i+"_cut":this.parent.notify(du,{invokeCopy:!0,promise:Promise});break;case i+"_copy":this.parent.notify(pu,{invokeCopy:!0,promise:Promise});break;case i+"_paste":this.parent.notify(Ia,{isAction:!0,isInternal:!0,focus:!0});break;case i+"_pastevalues":this.parent.notify(Ia,{type:"Values",isAction:!0,isInternal:!0,focus:!0});break;case i+"_pasteformats":this.parent.notify(Ia,{type:"Formats",isAction:!0,isInternal:!0,focus:!0});break;case i+"_rename":this.parent.notify(N1,{});break;case i+"_delete_sheet":this.parent.notify(Xy,{}),Fe(this.parent.element);break;case i+"_insert_sheet":this.parent.notify(Js,{model:this.parent,start:this.parent.activeSheetIndex,end:this.parent.activeSheetIndex,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex});break;case i+"_hide_sheet":this.parent.notify(Jy,{sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0});break;case i+"_duplicate":MI(this.parent,void 0,!0),Fe(this.parent.element);break;case i+"_move_right":Qy(this.parent,this.parent.activeSheetIndex+1,null,!0),Fe(this.parent.element);break;case i+"_move_left":Qy(this.parent,this.parent.activeSheetIndex-1,null,!0),Fe(this.parent.element);break;case i+"_ascending":this.parent.notify(vu,{sortOptions:{sortDescriptors:{order:"Ascending"}}});break;case i+"_descending":this.parent.notify(vu,{sortOptions:{sortDescriptors:{order:"Descending"}}});break;case i+"_customsort":this.parent.notify(Ky,null);break;case i+"_filtercellvalue":this.parent.notify($1,null);break;case i+"_clearfilter":r=Ur(xe(this.parent.getActiveSheet().activeCell)[1]+1),this.parent.notify(Kf,{field:r});break;case i+"_reapplyfilter":this.parent.notify(i0,null);break;case i+"_hide_row":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(nn,{startIndex:n[0],endIndex:n[2],hide:!0,isCol:!1,actionUpdate:!0});break;case i+"_unhide_row":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(nn,{startIndex:n[0],endIndex:n[2],hide:!1,isCol:!1,actionUpdate:!0});break;case i+"_hide_column":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(nn,{startIndex:n[1],endIndex:n[3],hide:!0,isCol:!0,actionUpdate:!0});break;case i+"_unhide_column":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(nn,{startIndex:n[1],endIndex:n[3],hide:!1,isCol:!0,actionUpdate:!0});break;case i+"_insert_row_above":case i+"_delete_row":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(e.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:n[0],end:n[2],modelType:"Row",isAction:!0,insertType:"above"});break;case i+"_insert_row_below":n=lt(ee(this.parent.getActiveSheet().selectedRange)),this.parent.notify(Js,{model:this.parent.getActiveSheet(),start:n[2]+1,end:n[2]+1+(n[2]-n[0]),modelType:"Row",isAction:!0,insertType:"below"});break;case i+"_insert_column_before":case i+"_delete_column":n=ee(this.parent.getActiveSheet().selectedRange),this.parent.notify(e.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:n[1],end:n[3],modelType:"Column",isAction:!0,insertType:"before"});break;case i+"_insert_column_after":n=lt(ee(this.parent.getActiveSheet().selectedRange)),this.parent.notify(Js,{model:this.parent.getActiveSheet(),start:n[3]+1,end:n[3]+1+(n[3]-n[1]),modelType:"Column",isAction:!0,insertType:"after"});break;case i+"_hyperlink":this.parent.notify(Gf,null);break;case i+"_editHyperlink":this.parent.notify($f,null);break;case i+"_openHyperlink":this.parent.notify(Q1,null);break;case i+"_removeHyperlink":this.parent.notify(Xf,{range:this.parent.getActiveSheet().selectedRange});break;case i+"_protect":this.parent.notify(y0,{});break}}},s.prototype.getInsertModel=function(e,t){for(var i=[],r=e;r<=t;r++)r===e?i.push({index:r}):i.push({});return i},s.prototype.beforeOpenHandler=function(e){var t=e.event.target,i=this.getTarget(t),r;if(e.element.classList.contains("e-contextmenu")){var n=this.parent.getActiveSheet();if(e.event.target&&(t.classList.contains("e-rowresize")||t.classList.contains("e-colresize"))){var a=ee(n.selectedRange);if(!(t.classList.contains("e-rowresize")?a[1]===0&&a[3]===n.colCount-1:a[0]===0&&a[2]===n.rowCount-1)){e.cancel=!0;return}(t.classList.contains("e-rowresize")?this.parent.hiddenCount(a[0],a[2])!==Math.abs(a[2]-a[0])+1:this.parent.hiddenCount(a[1],a[3],"columns")!==Math.abs(a[3]-a[1])+1)?r=this.getDataSource(i):r=this.getDataSource(i,t)}else{if(i==="Content"){var a=ee(n.selectedRange),o=a[1]===0&&a[3]===n.colCount-1,l=a[0]===0&&a[2]===n.rowCount-1;i=o&&l?"SelectAll":o?"RowHeader":l?"ColumnHeader":"Content"}r=this.getDataSource(i)}this.contextMenuInstance.items=r,this.contextMenuInstance.dataBind()}else r=e.items;if(this.parent.selectionSettings.mode==="None"&&i==="Content"&&this.parent.enableContextMenuItems(["Filter"],!1,!1),i==="ColumnHeader"||i==="RowHeader"){if(e.element&&e.element.childElementCount>0){var h=i==="ColumnHeader"?e.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_column"):e.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_row"),u=i==="ColumnHeader"?e.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_column"):e.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_row");this.parent.allowInsert&&h.classList.contains("e-disabled")?h.classList.remove("e-disabled"):(!this.parent.allowInsert||this.parent.element.querySelector(".e-selectall.e-highlight"))&&!h.classList.contains("e-disabled")&&h.classList.add("e-disabled"),this.parent.allowDelete&&u.classList.contains("e-disabled")?u.classList.remove("e-disabled"):!this.parent.allowDelete&&!u.classList.contains("e-disabled")&&u.classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&(i==="ColumnHeader"&&this.parent.enableContextMenuItems(["Insert Column","Delete Column","Hide Column"],!1,!1),i==="RowHeader"&&this.parent.enableContextMenuItems(["Insert Row","Delete Row","Hide Row"],!1,!1))}}else if(i==="Footer"){var c=gt(this.parent,t.textContent);c===0&&e.element.querySelector("#"+this.parent.element.id+"_cmenu_move_left").classList.add("e-disabled"),c===this.parent.sheets.length-1&&e.element.querySelector("#"+this.parent.element.id+"_cmenu_move_right").classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&this.parent.enableContextMenuItems(["Insert"],!1,!1)}this.parent.trigger("contextMenuBeforeOpen",e),this.parent.notify(uu,me(e,{target:i,items:r}))},s.prototype.getTarget=function(e){return U(e,".e-sheet-content")?"Content":U(e,".e-column-header")?e.classList.contains("e-header-cell")?"ColumnHeader":"Content":U(e,".e-row-header")?e.classList.contains("e-header-cell")?"RowHeader":"Content":U(e,".e-sheet-tabs-items")?"Footer":U(e,".e-selectall-container")?e.classList.contains("e-header-cell")?U(e,".e-header-row")?"ColumnHeader":"RowHeader":U(e,".e-select-all-cell")?"SelectAll":"Content":""},s.prototype.getDataSource=function(e,t){var i=this.parent.serviceLocator.getService(de),r=[],n=this.parent.element.id+"_cmenu";if(e==="Content")this.setClipboardData(r,i,n),r.push({separator:!0}),this.setFilterItems(r,n),this.setSortItems(r,n),r.push({separator:!0}),this.setHyperLink(r,n);else if(e==="RowHeader"){this.setClipboardData(r,i,n);var a=this.parent.getActiveSheet(),o=ee(a.selectedRange);this.setInsertDeleteItems(r,i,"Row",n,[o[0],o[2]],["Above","Below"]),(!t||t.classList.contains("e-rowresize")||!t.parentElement||!t.parentElement.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Row",n,[o[0],o[2]])}else if(e==="ColumnHeader"){this.setClipboardData(r,i,n);var a=this.parent.getActiveSheet(),o=ee(a.selectedRange);this.setInsertDeleteItems(r,i,"Column",n,[o[1],o[3]],["Before","After"]),(!t||!t.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Column",n,[o[1],o[3]])}else e==="SelectAll"?(this.setClipboardData(r,i,n),this.setFilterItems(r,n),this.setSortItems(r,n)):e==="Footer"&&(r.push({text:i.getConstant("Insert"),id:n+"_insert_sheet"}),r.push({text:i.getConstant("Delete"),iconCss:"e-icons e-delete",id:n+"_delete_sheet"}),r.push({text:i.getConstant("DuplicateSheet"),id:n+"_duplicate"}),r.push({text:i.getConstant("Rename"),id:n+"_rename"}),r.push({text:i.getConstant("Hide"),id:n+"_hide_sheet"}),this.setProtectSheetItems(r,n),r.push({text:i.getConstant("MoveRight"),id:n+"_move_right"}),r.push({text:i.getConstant("MoveLeft"),id:n+"_move_left"}));return r},s.prototype.setProtectSheetItems=function(e,t){var i=this.parent.serviceLocator.getService(de);this.parent.getActiveSheet().isProtected?e.push({text:i.getConstant("UnprotectSheet"),id:t+"_protect",iconCss:"e-icons e-protect-icon"}):e.push({text:i.getConstant("ProtectSheet"),id:t+"_protect",iconCss:"e-icons e-protect-icon"})},s.prototype.setFilterItems=function(e,t){if(this.parent.allowFiltering){var i=this.parent.serviceLocator.getService(de),r={clearFilterText:null,isFiltered:!1};this.parent.notify(r0,r),e.push({text:i.getConstant("Filter"),id:t+"_filter",iconCss:"",items:[{text:r.clearFilterText,iconCss:"e-icons e-filter-clear",id:t+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:t+"_reapplyfilter"},{separator:!0},{text:i.getConstant("FilterCellValue"),iconCss:"",id:t+"_filtercellvalue"}]})}},s.prototype.setSortItems=function(e,t){var i=this.parent.serviceLocator.getService(de);this.parent.allowSorting&&e.push({text:i.getConstant("Sort"),id:t+"_sort",iconCss:"e-icons e-sort-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc",id:t+"_ascending"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc",id:t+"_descending"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom",id:t+"_customsort"}]})},s.prototype.setHyperLink=function(e,t){if(this.parent.getActiveSheet(),this.parent.allowHyperlink){var i=this.parent.serviceLocator.getService(de);!document.activeElement.getElementsByClassName("e-hyperlink")[0]&&!document.activeElement.classList.contains("e-hyperlink")?e.push({text:i.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:t+"_hyperlink"}):e.push({text:i.getConstant("EditHyperlink"),iconCss:"e-icons e-edithyperlink-icon",id:t+"_editHyperlink"},{text:i.getConstant("OpenHyperlink"),iconCss:"e-icons e-openhyperlink-icon",id:t+"_openHyperlink"},{text:i.getConstant("RemoveHyperlink"),iconCss:"e-icons e-removehyperlink-icon",id:t+"_removeHyperlink"})}},s.prototype.setClipboardData=function(e,t,i){this.parent.enableClipboard&&(e.push({text:t.getConstant("Cut"),iconCss:"e-icons e-cut-icon",id:i+"_cut"}),e.push({text:t.getConstant("Copy"),iconCss:"e-icons e-copy-icon",id:i+"_copy"}),e.push({text:t.getConstant("Paste"),iconCss:"e-icons e-paste-icon",id:i+"_paste"}),e.push({text:t.getConstant("PasteSpecial"),id:i+"_pastespecial",items:[{text:t.getConstant("Values"),id:i+"_pastevalues"},{text:t.getConstant("Formats"),id:i+"_pasteformats"}]}))},s.prototype.setInsertDeleteItems=function(e,t,i,r,n,a){e.push({separator:!0}),["Insert","Delete"].forEach(function(o){n[0]===n[1]?e.push({text:t.getConstant(""+o+i),id:r+("_"+o.toLowerCase()+"_"+i.toLowerCase())}):e.push({text:t.getConstant(""+o+i+"s"),id:r+("_"+o.toLowerCase()+"_"+i.toLowerCase())}),o==="Insert"&&(e[e.length-1].items=[],a.forEach(function(l){e[e.length-1].items.push({text:t.getConstant(l),id:e[e.length-1].id+"_"+l.toLowerCase()})}))})},s.prototype.setHideShowItems=function(e,t,i,r,n){if(n[0]===n[1])e.push({text:t.getConstant("Hide"+i),id:r+("_hide_"+i.toLowerCase())});else{var a=n[0];n[0]=n[0]>n[1]?n[1]:n[0],n[1]=n[1]>a?n[1]:a,e.push({text:t.getConstant("Hide"+i+"s"),id:r+("_hide_"+i.toLowerCase())})}this.parent.hiddenCount(n[0],n[1],i.toLowerCase()+"s")&&e.push({text:t.getConstant("Unhide"+i+"s"),id:r+("_unhide_"+i.toLowerCase())})},s.prototype.addEventListener=function(){this.parent.on(O1,this.addItemsHandler,this),this.parent.on(R1,this.removeItemsHandler,this),this.parent.on(F1,this.enableItemsHandler,this)},s.prototype.addItemsHandler=function(e){e.insertAfter?this.contextMenuInstance.insertAfter(e.items,e.text,e.isUniqueId):this.contextMenuInstance.insertBefore(e.items,e.text,e.isUniqueId)},s.prototype.removeItemsHandler=function(e){this.contextMenuInstance.removeItems(e.items,e.isUniqueId)},s.prototype.enableItemsHandler=function(e){this.contextMenuInstance.enableItems(e.items,e.enable,e.isUniqueId)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(O1,this.addItemsHandler),this.parent.off(R1,this.removeItemsHandler),this.parent.off(F1,this.enableItemsHandler))},s.prototype.getModuleName=function(){return"contextMenu"},s.prototype.destroy=function(){this.removeEventListener(),this.contextMenuInstance.destroy();var e=document.getElementById(this.parent.element.id+"_contextmenu");e&&ne(e),this.contextMenuInstance=null,this.parent=null},s}(),KY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.refreshCellElement=function(e){e.cellEle&&this.parent.refreshNode(e.cellEle,e)},s.prototype.getTextSpace=function(e){e.width=_r(e.char,e.cell.style,this.parent.cellStyle)},s.prototype.rowFillHandler=function(e){var t=e.cellEle;if(t){var i=_r(e.repeatChar,e.cell.style,this.parent.cellStyle),r=e.colIdx;if(e.cell.colSpan>1){var n={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(cr,n),r=n.range[3]}var a=Ad(this.parent.getActiveSheet(),e.rowIdx,e.colIdx,r);t.innerText="",e.beforeFillText&&(t.innerText=e.beforeFillText,a-=_r(e.beforeFillText,e.cell.style,this.parent.cellStyle));var o=this.parent.createElement("span",{className:"e-fill"});if(t.appendChild(o),e.afterFillText){var l=this.parent.createElement("span",{className:"e-fill-sec"});l.innerText=e.afterFillText,t.appendChild(l),a-=_r(e.afterFillText,e.cell.style,this.parent.cellStyle)}var h=parseInt((a/i).toString(),10);e.formattedText=h>0?e.repeatChar.repeat(h):"",o.textContent=e.formattedText}},s.prototype.addEventListener=function(){this.parent.on(Zw,this.refreshCellElement,this),this.parent.on(Hy,this.rowFillHandler,this),this.parent.on(Vy,this.getTextSpace,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Zw,this.refreshCellElement),this.parent.off(Hy,this.rowFillHandler),this.parent.off(Vy,this.getTextSpace))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"numberFormat"},s}(),ZY=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.addEventListener=function(){this.parent.on(vu,this.applySortHandler,this),this.parent.on($p,this.sortCompleteHandler,this),this.parent.on(Ky,this.initiateCustomSortHandler,this),this.parent.on(Ey,this.sortImport,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vu,this.applySortHandler),this.parent.off($p,this.sortCompleteHandler),this.parent.off(Ky,this.initiateCustomSortHandler),this.parent.off(Ey,this.sortImport))},s.prototype.getModuleName=function(){return"sort"},s.prototype.isValidSortRange=function(){var e=this.parent.getActiveSheet(),t=lt(ir(e.selectedRange));return!(t[0]>e.usedRange.rowIndex||t[1]>e.usedRange.colIndex)},s.prototype.sortImport=function(e){for(var t=this.parent.sortCollection,i,r=this.parent.getActiveSheet().usedRange.rowIndex-1,n=e?e.sheetIdx:this.parent.activeSheetIndex,a=0;a<t.length;a++)if(t[a].sheetIndex===n){for(var o=0;o<r;o++)if(i=this.parent.getCell(o,t[a].columnIndex),i&&i.querySelector(".e-filter-icon")){t[a].order==="Ascending"||t[a].order==="OnTop"?i.querySelector(".e-filter-icon").classList.contains("e-sortasc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"):i.querySelector(".e-filter-icon").classList.contains("e-sortdesc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter");return}}},s.prototype.sortRangeAlertHandler=function(e){var t=this,i=this.parent.serviceLocator.getService(At),r=this.parent.serviceLocator.getService(de);i.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:e.error,beforeOpen:function(n){var a={dialogName:e.error===r.getConstant("MultiRangeSortError")?"MultiRangeSortDialog":"SortRangeDialog",content:e.error,element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?n.cancel=!0:Fe(t.parent.element),i.dialogInstance.content=a.content}}),this.parent.hideSpinner()},s.prototype.initiateCustomSortHandler=function(){var e=this,t=this.parent.serviceLocator.getService(de),i=this.parent.getActiveSheet();if(!this.isValidSortRange()||i.rows.length===0){this.sortRangeAlertHandler({error:t.getConstant("SortOutOfRangeError")});return}if(TM(i.selectedRange)){this.sortRangeAlertHandler({error:t.getConstant("MultiRangeSortError")});return}var r=this.parent.serviceLocator.getService(At),n;r.show({height:400,width:560,isModal:!0,showCloseIcon:!0,cssClass:"e-customsort-dlg",header:t.getConstant("CustomSort"),beforeOpen:function(a){var o={dialogName:"CustomSortDialog",element:a.element,target:a.target,cancel:a.cancel};e.parent.trigger("dialogBeforeOpen",o),o.cancel&&(a.cancel=!0),r.dialogInstance.content=e.customSortContent(),r.dialogInstance.dataBind(),Fe(e.parent.element)},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){var a=r.dialogInstance.content,o=Ct(a.getElementsByClassName("e-list-sort e-listview e-lib")[0],"listview"),l=o.dataSource;e.clearError();var h=a.getElementsByClassName("e-sort-error")[0];h.style.display="block",e.validateError(l,a,h)||(n={sortDescriptors:l,containsHeader:a.getElementsByClassName("e-sort-checkheader")[0].checked,caseSensitive:a.getElementsByClassName("e-sort-checkcase")[0].checked},r.hide())}}],close:function(){n&&Vi(function(){return e.applySortHandler({sortOptions:n})})}})},s.prototype.validateError=function(e,t,i){var r=this.parent.serviceLocator.getService(de),n=e.some(function(d){return d.field.toString()===""});if(n)return Array.prototype.some.call(t.getElementsByClassName("e-sort-field"),function(d){var p=!Ct(d,"dropdownlist").value;return p&&d.parentElement.classList.add("e-error"),p}),i.innerText=r.getConstant("SortEmptyFieldError"),!0;var a=new Set,o="",l=e.some(function(d){return o=d.field.toString(),a.size===a.add(d.field).size}),h="";if(l){var u=0;Array.prototype.some.call(t.getElementsByClassName("e-sort-field"),function(d){var p=Ct(d,"dropdownlist");return p.value===o&&(d.parentElement.classList.add("e-error"),h=p.text,u++),u===2}),i.innerText="";var c=this.parent.createElement("strong");return c.innerText=h,i.appendChild(c),i.appendChild(document.createTextNode(r.getConstant("SortDuplicateFieldError"))),!0}return!1},s.prototype.customSortContent=function(){var e=this.parent.createElement("div",{className:"e-sort-dialog"}),t=this.getFields(),i=mi("customSort"),r=this.getCustomListview(i);this.setHeaderTab(e,r,t);var n=this.parent.createElement("div",{className:"e-sort-listsection",styles:""});e.appendChild(n);var a=this.parent.createElement("div",{className:"e-list-sort",styles:""});n.appendChild(a),r.createElement=this.parent.createElement,r.appendTo(a),a.removeAttribute("tabindex"),this.renderListItem(i,r,!0,t);var o=this.parent.createElement("div",{className:"e-sort-error"});return e.appendChild(o),e},s.prototype.getFields=function(){var e=this.parent.getActiveSheet(),t=lt(ir(e.selectedRange));if(t[0]===t[2]&&t[2]-t[0]===0){t[0]=0,t[1]=0,t[3]=e.usedRange.colIndex;var i={filterRange:[],hasFilter:!1};this.parent.notify(xd,i),i.hasFilter&&i.filterRange&&(t[0]=i.filterRange[0])}var r=[],n,a;for(t[1];t[1]<=t[3];t[1]++){var o=Y(t[0],t[1],e);if(a="Column "+Ur(t[1]+1),o&&o.value){if(n=o.value,o.format){var l={formattedText:n,value:n,format:o.format,rowIndex:t[0],colIndex:t[1]};this.parent.notify(jn,l),n=l.formattedText}}else n=a;r.push({text:n,value:a})}return r},s.prototype.setHeaderTab=function(e,t,i){var r=this,n=this.parent.serviceLocator.getService(de),a=this.parent.createElement("div",{className:"e-sort-header"});e.appendChild(a);var o=this.parent.createElement("button",{className:"e-btn e-sort-addbtn e-flat",attrs:{type:"button"}});o.innerText=n.getConstant("AddColumn");var l=this.parent.element.querySelector(".e-customsort-dlg .e-footer-content");l.insertBefore(o,l.firstElementChild),o.addEventListener("click",function(){if(t){var p=mi("customSort");t.addItem([{id:p,text:n.getConstant("ThenBy"),field:"",order:"ascending"}]),r.renderListItem(p,t,h.checked,i,!0)}});var h=new Vo({label:n.getConstant("ContainsHeader"),checked:!0,change:function(p){var f=p.checked?{text:"text",value:"value"}:{text:"value"};Array.prototype.forEach.call(e.getElementsByClassName("e-sort-field e-dropdownlist e-lib"),function(v){var g=Ct(v,"dropdownlist");g.dataSource=null,g.dataSource=i,g.fields=f,g.dataBind()})},cssClass:"e-sort-headercheckbox"}),u=this.parent.createElement("input",{className:"e-sort-checkheader",attrs:{type:"checkbox"}});a.appendChild(u),h.createElement=this.parent.createElement,h.appendTo(u);var c=new Vo({label:n.getConstant("CaseSensitive"),checked:!1,cssClass:"e-sort-casecheckbox"}),d=this.parent.createElement("input",{className:"e-sort-checkcase",attrs:{type:"checkbox"}});a.appendChild(d),c.createElement=this.parent.createElement,c.appendTo(d)},s.prototype.getCustomListview=function(e){var t=this.parent.serviceLocator.getService(de),i=[{id:e,text:t.getConstant("SortBy"),field:"",order:"ascending"}];Q_(!1);var r=new Ib({dataSource:i,fields:{id:"id"},height:"100%",template:wy(function(n){return'<div class="e-sort-listwrapper">'+('<span class="text">'+n.text+"</span>")+'<div class="e-sort-row"><div class="e-sort-field"></div><div class="e-sort-order">'+('<span class="e-sort-ordertxt" style="display:none;">'+n.order+"</span></div>")+'<span class="e-icons e-sort-delete" tabindex="0"></span></div>'}),cssClass:"e-sort-template"});return r},s.prototype.deleteHandler=function(e,t){var i=e.getElementsByClassName("e-sort-delete")[0];i.addEventListener("click",function(){e&&t.removeItem(e)})},s.prototype.renderListItem=function(e,t,i,r,n){var a=this,o=this.parent.serviceLocator.getService(de),l=t.element.querySelector("li[data-uid="+e+"]"),h=i?{text:"text",value:"value"}:{text:"value"},u=l.getElementsByClassName("e-sort-field")[0],c=new Na({dataSource:r,width:"auto",cssClass:"e-sort-field-ddl",fields:h,placeholder:o.getConstant("SelectAColumn"),change:function(C){C.value&&(Array.prototype.some.call(t.dataSource,function(x){return x.id===e&&(x.field=C.value.toString().replace("Column ","")),x.id===e}),a.clearError())}});c.createElement=this.parent.createElement,c.appendTo(u),n||(c.index=0);var d=l.getElementsByClassName("e-sort-order")[0],p=d.getElementsByClassName("e-sort-ordertxt")[0],f=p.innerText.toLocaleLowerCase()==="ascending",v=new E0({label:o.getConstant("SortAscending"),name:"sortAZ_"+e,value:"ascending",checked:f,cssClass:"e-sort-radiobutton",change:function(C){a.setRadioBtnValue(t,e,C.value)}}),g=this.parent.createElement("input",{id:"orderAsc_"+e,className:"e-sort-radioasc",styles:"",attrs:{type:"radio"}});d.appendChild(g),v.createElement=this.parent.createElement,v.appendTo(g);var b=new E0({label:o.getConstant("SortDescending"),name:"sortAZ_"+e,value:"descending",checked:!f,cssClass:"e-sort-radiobutton",change:function(C){a.setRadioBtnValue(t,e,C.value)}}),y=this.parent.createElement("input",{id:"orderDesc_"+e,className:"e-sort-radiodesc",styles:"",attrs:{type:"radio"}});d.appendChild(y),b.createElement=this.parent.createElement,b.appendTo(y),this.deleteHandler(l,t)},s.prototype.setRadioBtnValue=function(e,t,i){i&&Array.prototype.some.call(e.dataSource,function(r){return r.id===t&&(r.order=i),r.id===t})},s.prototype.clearError=function(){var e=document.getElementsByClassName("e-sort-dialog")[0],t=e.getElementsByClassName("e-sort-error")[0];t.style.display!=="none"&&t.innerHTML!==""&&(t.style.display="none",Array.prototype.forEach.call(e.getElementsByClassName("e-error"),function(i){i.classList.remove("e-error")}))},s.prototype.applySortHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r=e&&e.range||i.selectedRange,n=lt(ir(r)),a=e&&e.sortOptions||{sortDescriptors:{}},o=n[0]===n[2],l={filterRange:[],hasFilter:!1,sheetIdx:this.parent.activeSheetIndex};this.parent.notify(xd,l),l.hasFilter&&(o?Sa(l.filterRange,n[0],n[1]):l.filterRange[0]===n[0]&&(this.parent.element.querySelector(".e-selectall.e-highlight")||n[1]>=l.filterRange[1]&&n[1]<=l.filterRange[3]||n[3]>=l.filterRange[1]&&n[3]<=l.filterRange[3]))&&(n[0]=l.filterRange[0],n[1]=l.filterRange[1],n[2]=i.usedRange.rowIndex,n[3]=i.usedRange.colIndex,a.containsHeader=!0,o=!1),r=je(n);var h={range:r,sortOptions:a,cancel:!1};if(this.parent.trigger(XW,h),!h.cancel){this.parent.notify(li,{eventArgs:h,action:"beforeSort"}),this.parent.showSpinner();var u=new Promise(function(d,p){d(function(){}())}),c={args:{range:h.range,sortOptions:h.sortOptions,checkForHeader:o&&r!==h.range},promise:u,previousSort:e&&e.previousSort};this.parent.notify(Pf,c),c.promise.then(function(d){return t.sortCompleteHandler(d),t.parent.trigger($p,d),t.parent.notify(yt,{eventArgs:d,action:"sorting"}),document.activeElement.tagName==="BODY"&&Fe(t.parent.element),Promise.resolve(d)}).catch(function(d){return t.sortRangeAlertHandler({error:d}),Promise.reject(d)})}},s.prototype.sortCompleteHandler=function(e){var t,i,r=this.parent.activeSheetIndex;if(e.range.includes("!")){var n=e.range.split("!");r=gt(this.parent,n[0]),t=Pe(this.parent,r),i=ee(n[1])}else t=this.parent.getActiveSheet(),i=ee(e.range);for(var a=i[0];a<=i[2];a++)for(var o=i[1];o<=i[3];o++)this.parent.notify(xt,{action:"refreshCalculate",rowIndex:a,colIndex:o});this.parent.serviceLocator.getService("cell").refreshRange(i,!0,!0,!1,!1,ea(this.parent)),r===this.parent.activeSheetIndex&&t.conditionalFormats&&t.conditionalFormats.length&&this.parent.notify(er,{indexes:i}),this.parent.hideSpinner()},s}(),JY=function(){function s(e){this.intl=new _t,m(e)||(this.intl.culture=e)}return s.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},s.prototype.getParserFunction=function(e){return e.type?this.intl.getDateParser(e):this.intl.getNumberParser(e)},s.prototype.fromView=function(e,t,i){return(i==="date"||i==="datetime"||i==="number")&&!m(t)?t(e):e},s.prototype.toView=function(e,t){var i=e;return!m(t)&&!m(e)&&(i=t(e)),i},s.prototype.setCulture=function(e){m(e)||D_(e)},s}(),Bk="actionBegin",Qm="actionComplete",Hk="filterchoicerequest",e8="filterAfterOpen",t8="filterBeforeOpen",i8="filterSearchBegin",O0="filterDialogCreated",r8="filter-menu-close",fx="generateQuery",n8="foreignKeyData",Zz="dataStateChange",s8="beforeCustomFilterOpen",a8="cbox-filter-begin",Vk="cbox-filter-complete",hv="filter-Prevent",BM="before-filter-cmenu-open",HM="filter-cbox-value",o8="beforeCheckboxRenderer",Lh="filter-dialog-close",Uk="refresh-cutsom-filter-ok-button",l8="refresh-cutsom-filter-clear-button",_k="render-responsive-cmenu",VM="filter-cmenu-select",h8="custom-filter-close",u8="before-checkbox-renderer-query",c8="after-filter-column-menu-close",d8="beforeCheckboxfilterRenderer",p8="colgroup",Gm="open",$m="change",Xm="focus";function f8(s,e,t){return m(s)||s===""?"":ce.getObject(s,e)}function Sp(s,e,t,i){for(var r=me(s,e,t),n=Object.keys(r),a=0;a<n.length;a++)i&&i.indexOf(n[parseInt(a.toString(),10)])!==-1&&delete r[n[parseInt(a.toString(),10)]];return r}function Wk(s){return s instanceof ke?ie("properties",s):s}function Br(s,e,t){for(var i=s;i&&!(t?i.id===e:i.classList.contains(e));)i=i.parentElement;return i}var v8=0;function Oo(s){return s+v8++}function sc(s,e){for(var t=0,i=e.length;t<i;t++)i===e.length?s.appendChild(e[parseInt(t.toString(),10)]):s.appendChild(e[0]);return s}function Io(s){return s.split(".").length>1}function ul(s){return s===void 0&&(s=""),s.replace(/\./g,"___")}function m8(s){for(var e={},t=[],i=0;i<s.length;i++)s[parseInt(i.toString(),10)]in e||(t.push(s[parseInt(i.toString(),10)].toString()),e[s[parseInt(i.toString(),10)]]=1);return t}function g8(s,e){var t=e.element.style.display;e.element.style.display="block";var i=e.width,r=pz(s,e.element);e.element.style.display=t,e.element.style.top=r.top+s.getBoundingClientRect().height-5+"px";var n=r.left-i+s.clientWidth;n<1?e.element.style.left=i+n-16+"px":e.element.style.left=n+-4+"px"}function ac(s){var e=s.querySelector(".e-frame"),t=e.previousSibling;e.classList.contains("e-check")?(t.checked=!1,br(e,["e-uncheck"],["e-check"])):(t.checked=!0,br(e,["e-check"],["e-uncheck"]))}function Km(s,e){s.checked=e}function Ml(s,e,t){var i=St("div",{className:t});return i.appendChild(e),i.setAttribute("uid",s),i}function y8(s,e){te([s],["e-check","e-stop","e-uncheck"]),e?s.classList.add("e-check"):s.classList.add("e-uncheck")}function b8(s,e,t,i){var r=s.foreignKeyField,n=m(t)?f8(s.field,e):t;n=m(n)?"":n;var a=new $e,o=i||(s.dataSource instanceof ge&&s.dataSource.dataSource.json.length?s.dataSource.dataSource.json:s.columnData);return n.getDay?a.where(oc({field:r,operator:"equal",value:n,matchCase:!1})):a.where(r,"==",n,!1),new ge(o).executeLocal(a)}function C8(s,e){var t;return e.some(function(i){return t=i,i.foreignKeyValue===s})&&t}function R0(s){return s<10?"0"+s:String(s)}function oc(s,e,t){var i,r,n,a=me({},Wk(s)),o=me({},Wk(s));if(m(s.value)||s.value==="")return i=new It(a.field,a.operator,a.value,!1),i;var l=new Date(s.value);if(e==="dateonly"&&!t){typeof a.value=="string"&&(a.value=new Date(a.value));var h=a.value.getFullYear()+"-"+R0(a.value.getMonth()+1)+"-"+R0(a.value.getDate()),u=new It(a.field,a.operator,h,!1);i=u}else if(s.operator==="equal"||s.operator==="notequal"){e==="datetime"?(r=new Date(l.setSeconds(l.getSeconds()-1)),n=new Date(l.setSeconds(l.getSeconds()+2)),s.value=new Date(l.setSeconds(n.getSeconds()-1))):(r=new Date(l.setHours(0)-1),n=new Date(l.setHours(24))),a.value=r,o.value=n,s.operator==="equal"?(a.operator="greaterthan",o.operator="lessthan"):s.operator==="notequal"&&(a.operator="lessthanorequal",o.operator="greaterthanorequal");var c=new It(a.field,a.operator,a.value,!1),d=new It(o.field,o.operator,o.value,!1);i=s.operator==="equal"?c.and(d):c.or(d)}else{e==="date"&&(s.operator==="lessthanorequal"||s.operator==="greaterthan")&&(a.value=new Date(l.setHours(24)-1)),typeof a.value=="string"&&(a.value=new Date(a.value));var u=new It(a.field,a.operator,a.value,!1);i=u}return s.setProperties?s.setProperties({ejpredicate:i},!0):s.ejpredicate=i,i}function qk(s,e){if(s===void 0&&(s=""),s){for(var t=e,i=s.split("."),r=0;r<i.length&&!m(t);r++)if(t=t[i[parseInt(r.toString(),10)]],Re(t)){var n=i[parseInt(r.toString(),10)].charAt(0).toUpperCase()+i[parseInt(r.toString(),10)].slice(1);t=e[""+n]||e[(""+n).charAt(0).toLowerCase()+(""+n).slice(1)]}return t}}function Yk(s,e){var t=new _t,i,r="format",n="type";return e==="date"?i=typeof s=="object"?t.getDatePattern({type:s[""+n]?s[""+n]:"date",format:s[""+r]},!1):t.getDatePattern({type:"dateTime",skeleton:s},!1):i=typeof s=="object"?t.getDatePattern({type:s[""+n]?s[""+n]:"dateTime",format:s[""+r]},!1):t.getDatePattern({type:"dateTime",skeleton:s},!1),i}function S8(s,e,t,i){var r=s||{},n=arguments.length;i&&(n=n-1);for(var a=1;a<n;a++)if(arguments[parseInt(a.toString(),10)])for(var o=arguments[parseInt(a.toString(),10)],l=Object.keys(Object.getPrototypeOf(o)).length?Object.keys(o).concat(x8(o)):Object.keys(o),h=0;h<l.length;h++){var u=r[l[parseInt(h.toString(),10)]],c=o[l[parseInt(h.toString(),10)]],d=void 0;i&&(na(c)||Array.isArray(c))?na(c)?(d=u||{},r[l[parseInt(h.toString(),10)]]=me({},d,c,i)):(d=u||[],r[l[parseInt(h.toString(),10)]]=me([],d,c,i)):r[l[parseInt(h.toString(),10)]]=c}return r}function x8(s){for(var e=[];Object.getPrototypeOf(s)&&Object.keys(Object.getPrototypeOf(s)).length;)e=e.concat(Object.keys(Object.getPrototypeOf(s))),s=Object.getPrototypeOf(s);return e}var Ac;(function(s){s.timer=null})(Ac||(Ac={}));function Qk(s,e){s.classList.contains("e-bigger")&&e.classList.add("e-bigger")}function Jz(s,e){var t=w8(e),i=new xa;return t.dataSource=i.resolve,t.action=s,{state:t,deffered:i}}function w8(s){var e=new oo,t=new ge({url:"",adaptor:new oo}),i=e.processQuery(t,s),r=JSON.parse(i.data);return r}function Gk(s,e){for(var t,i=s.split(".").length,r=s.split("."),n=e,a=0;a<i;a++)t=n[r[parseInt(a.toString(),10)]],n=t;return t}function $k(s,e,t,i){i.eventHandlers[""+s]={};for(var r=0;r<e.length;r++)i.eventHandlers[""+s][e[parseInt(r.toString(),10)]]=t[e[parseInt(r.toString(),10)]]}function Xk(s,e,t){for(var i=0;i<e.length&&!s.isDestroyed;i++)s.removeEventListener(e[parseInt(i.toString(),10)],t.eventHandlers[s.element.id][e[parseInt(i.toString(),10)]])}function e2(s,e){s.destroyTemplate(e),s.isReact&&s.renderTemplates()}var t2=function(){function s(e){this.isExecuteLocal=!1,this.existingPredicate={},this.foreignKeyQuery=new $e,this.filterState=!0,this.values={},this.renderEmpty=!1,this.isCheckboxFilterTemplate=!1,this.infiniteRenderMod=!1,this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1,this.infinitePermenantLocalData=[],this.infiniteQueryExecutionPending=!1,this.infiniteSkipCnt=0,this.infiniteScrollAppendDiff=0,this.prevInfiniteScrollDirection="",this.infiniteLoadedElem=[],this.infiniteDataCount=0,this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteManualSelectMaintainPred=[],this.parent=e,this.id=this.parent.element.id,this.valueFormatter=new JY(this.parent.locale),this.cBoxTrue=M0(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=M0(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Q([this.cBoxTrue,this.cBoxFalse],["e-rtl"]),this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Q([this.cBoxTrue,this.cBoxFalse],this.parent.cssClass.split(" ")):Q([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass]))}return s.prototype.destroy=function(){this.closeDialog()},s.prototype.wireEvents=function(){I.add(this.dlg,"click",this.clickHandler,this),I.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=dP(this.searchBoxKeyUp,200);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&(I.add(e,"keyup",this.searchHandler,this),I.add(e,"input",this.searchHandler,this))},s.prototype.unWireEvents=function(){I.remove(this.dlg,"click",this.clickHandler),I.remove(this.dlg,"keyup",this.keyupHandler);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&(I.remove(e,"keyup",this.searchHandler),I.remove(e,"input",this.searchHandler))},s.prototype.foreignKeyFilter=function(e,t,i){var r=this,n={},a=[],o=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(o.where(i)).then(function(l){r.options.column.columnData=l.result,r.parent.notify(fx,{predicate:n,column:r.options.column}),e.ejpredicate=n.predicate.predicates;for(var h=n.predicate.predicates,u=0;u<h.length;u++)a.push({field:h[parseInt(u.toString(),10)].field,predicate:"or",matchCase:h[parseInt(u.toString(),10)].ignoreCase,ignoreAccent:h[parseInt(u.toString(),10)].ignoreAccent,operator:h[parseInt(u.toString(),10)].operator,value:h[parseInt(u.toString(),10)].value,type:r.options.type});e.filterCollection=a.length?a:t.filter(function(c){return c.field=r.options.field}),r.options.handler(e)})},s.prototype.foreignFilter=function(e,t){var i=this.options.isRemote?this.options.column.type==="string"?"contains":"equal":this.options.column.type?"contains":"equal",r=new It(this.options.column.foreignKeyValue,i,t,!0,this.options.ignoreAccent);this.foreignKeyFilter(e,[e.filterCollection],r)},s.prototype.searchBoxClick=function(e){var t=e.target;t.classList.contains("e-searchclear")&&(this.sInput.value=t.classList.contains("e-chkcancel-icon")?"":this.sInput.value,this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},s.prototype.searchBoxKeyUp=function(e){(m(e)||e.key!=="ArrowUp"&&e.key!=="ArrowDown"&&e.key!=="Tab"&&!(e.key==="Tab"&&e.shiftKey))&&(!m(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&this.parent.showMaskRow(void 0,this.dialogObj.element),this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon())},s.prototype.updateSearchIcon=function(){this.sInput.value.length?(br(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]),m(document.body.querySelector(".e-chkcancel-icon"))||document.body.querySelector(".e-chkcancel-icon").setAttribute("title",this.localeObj.getConstant("Clear"))):(br(this.sIcon,["e-search-icon"],["e-chkcancel-icon"]),m(document.body.querySelector(".e-searchclear.e-search-icon"))||document.body.querySelector(".e-searchclear.e-search-icon").setAttribute("title",this.localeObj.getConstant("Search")))},s.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},s.prototype.updateDataSource=function(){var e=this.options.dataSource,t="object";if(!(e instanceof ge)){for(var i=0;i<e.length;i++)if(typeof e!==t){var r={};r[this.options.field]=e[parseInt(i.toString(),10)],e[parseInt(i.toString(),10)]=r}}},s.prototype.updateModel=function(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new $e,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.options.disableHtmlEncode=e.column.disableHtmlEncode||!1,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length,this.infiniteRenderMod=!!(this.parent.filterSettings&&this.parent.filterSettings.enableInfiniteScrolling),this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[]},s.prototype.getAndSetChkElem=function(e){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!e.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search"),cssClass:this.parent.cssClass}};ye.createInput(t,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},s.prototype.showDialog=function(e){var t={requestType:t8,columnName:this.options.field,columnType:this.options.type,cancel:!1},i="filterModel";if(t[""+i]=this,this.parent.notify(a8,t),t.cancel){e.cancel=t.cancel;return}this.dialogObj=new Tv({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!m(Br(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""});var r="isStringTemplate";this.dialogObj[""+r]=!0,this.renderResponsiveFilter(e);var n=this.parent.filterSettings&&this.parent.filterSettings.type==="CheckBox"?this.getLocalizedLabel("CheckBoxFilterDialogARIA"):this.getLocalizedLabel("ExcelFilterDialogARIA");if(this.dlg.setAttribute("aria-label",n),e.isResponsiveFilter){var a=document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv");a.appendChild(this.dlg)}else this.parent.element.appendChild(this.dlg);this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=e.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show();var o=this.dialogObj.element.querySelector(".e-dlg-content");o.appendChild(this.sBox),this.wireEvents(),!m(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&!this.infiniteRenderMod?this.parent.showMaskRow(void 0,this.dialogObj.element):this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"?this.showMask():(this.infiniteRenderMod&&(this.cBox.style.marginTop=this.getListHeight(this.cBox)+"px"),Nd({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),Ol(this.spinner)),this.getAllData()},s.prototype.renderResponsiveFilter=function(e){e.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},s.prototype.dialogCreated=function(e){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":B.isDevice?this.dialogObj.position={X:"center",Y:"center"}:g8(this.options.target,this.dialogObj),this.options.column.showColumnMenu&&this.parent.notify(O0,e)},s.prototype.openDialog=function(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)},s.prototype.closeDialog=function(){if(this.infiniteRenderMod&&this.infinitePermenantLocalData.length&&!this.options.isRemote&&(this.options.dataSource.dataSource.json=this.infinitePermenantLocalData),this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var e=this.options.columns.filter(function(i){return i.getFilterItemTemplate()}),t=this.parent.registeredTemplate;e.length&&!m(t)&&t.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&e2(this.parent,["filterItemTemplate"]),this.parent.notify(r8,{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),pt(this.dlg),this.dlg=null,this.parent.notify(Lh,{})}},s.prototype.clearFilter=function(e){var t={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(hv,t),!t.cancel&&this.options.handler({action:"clear-filter",field:e?e.field:this.options.field})},s.prototype.btnClick=function(e){if(this.filterState){if(e.target.tagName.toLowerCase()==="input"&&e.target.classList.contains("e-searchinput")||e.keyCode===13)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var t=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===t?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===t&&this.clearFilter()}this.closeDialog()}else e.target.tagName.toLowerCase()!=="input"&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify(c8,{})},s.prototype.fltrBtnHandler=function(){var e=this;this.infiniteRenderMod&&(this.cBox.innerHTML="",sc(this.cBox,this.infiniteLoadedElem.slice()));var t=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)")),i=t,r="equal",n=this.dialogObj.element.querySelector(".e-dropdownlist");n&&(this.options.operator=r=n.ej2_instances[0].value),this.isMenuNotEqual=this.options.operator==="notequal";var a;this.options.hideSearchbox||(a=this.searchBox.querySelector(".e-searchinput"));var o=this.options.allowCaseSensitive,l={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:r,type:this.options.type,matchCase:o,ignoreAccent:this.options.ignoreAccent},h=this.itemsCnt!==t.length&&this.itemsCnt-t.length<t.length;h&&a&&a.value===""&&(r=this.isMenuNotEqual?"equal":"notequal",t=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),l.predicate=this.isMenuNotEqual?"or":"and",l.operator=r);var u,c,d,p,f=[];if(t.length!==this.itemsCnt||a&&a.value&&a.value!==""||this.infiniteRenderMod){if(this.infiniteRenderMod)this.infiniteRenderMod&&this.infiniteFltrBtnHandler(f);else for(var v=0;v<t.length;v++)u=this.values[Br(t[parseInt(v.toString(),10)],"e-ftrchk").getAttribute("uid")],p=me({},{value:u},l),u&&!u.toString().length&&(p.operator=h?"notequal":"equal"),u===""||m(u)?f=f.concat(s.generateNullValuePredicates(l)):f.push(p),this.notifyFilterPrevEvent(p);(this.options.type==="date"||this.options.type==="datetime")&&i.length&&(d=i.length-1,c=this.values[Br(i[parseInt(d.toString(),10)],"e-ftrchk").getAttribute("uid")],m(c)&&h&&f.push({field:l.field,matchCase:l.matchCase,operator:"equal",predicate:"and",value:null}));var g=this.infiniteRenderMod?this.sBox.querySelector(".e-add-current"):this.cBox.querySelector(".e-add-current");if(g&&g.classList.contains("e-check")){var b=this.existingPredicate[this.options.field];if(b)for(var y=function(w){f.some(function(M){return M.value===b[parseInt(w.toString(),10)].value})||f.push(b[parseInt(w.toString(),10)])},C=0;C<b.length;C++)y(C);else return}if(!this.infiniteRenderMod)this.initiateFilter(f);else if(f.length)this.initiateFilter(f);else if(this.sBox.querySelector(".e-selectall").classList.contains("e-check")&&!f.length){var x=this.options.filteredColumns.some(function(w){return e.options.field===w.field});x&&this.clearFilter()}}else{var x=this.options.filteredColumns.some(function(M){return e.options.field===M.field});x&&this.clearFilter()}},s.prototype.infiniteFltrBtnHandler=function(e){var t;if(this.infiniteManualSelectMaintainPred.length)for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(t=r.value+"",t===""||m(t)){var n={predicate:r.predicate,field:r.field,type:r.type,uid:r.uid,operator:r.operator,matchCase:r.matchCase,ignoreAccent:r.ignoreAccent};e.push.apply(e,s.generateNullValuePredicates(n))}else e.push(this.infiniteManualSelectMaintainPred[i]);this.notifyFilterPrevEvent(this.infiniteManualSelectMaintainPred[i])}if(!this.localInfiniteSelectAllClicked&&this.sInput.value===""&&!(!this.options.parentCurrentViewDataCount&&e.length))for(var i=0;i<this.infiniteUnloadParentExistPred.length;i++)e.unshift(this.infiniteUnloadParentExistPred[i]),this.notifyFilterPrevEvent(this.existingPredicate[this.options.field][i]);this.sInput.value!==""&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll)&&(this.infiniteSearchPred.predicate="or",e.unshift(this.infiniteSearchPred),this.notifyFilterPrevEvent(this.infiniteSearchPred))},s.prototype.notifyFilterPrevEvent=function(e){var t={instance:this,handler:this.fltrBtnHandler,arg1:e.field,arg2:e.predicate,arg3:e.operator,arg4:e.matchCase,arg5:e.ignoreAccent,arg6:e.value,cancel:!1};this.parent.notify(hv,t),t.cancel},s.generateNullValuePredicates=function(e){var t=[];return e.type==="string"&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t},s.prototype.initiateFilter=function(e){var t=e[0],i;if(!m(t)){i=t.ejpredicate?t.ejpredicate:new It(t.field,t.operator,t.value,!t.matchCase,t.ignoreAccent);for(var r=1;r<e.length;r++)i=e[parseInt(r.toString(),10)].ejpredicate!==void 0?i[e[parseInt(r.toString(),10)].predicate](e[parseInt(r.toString(),10)].ejpredicate):i[e[parseInt(r.toString(),10)].predicate](e[parseInt(r.toString(),10)].field,e[parseInt(r.toString(),10)].operator,e[parseInt(r.toString(),10)].value,!e[parseInt(r.toString(),10)].matchCase,e[parseInt(r.toString(),10)].ignoreAccent);var n={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:It.or(i)};this.options.handler(n)}},s.prototype.isForeignColumn=function(e){return e.isForeignColumn?e.isForeignColumn():!1},s.prototype.refreshCheckboxes=function(){var e=this,t=this.sInput.value,i=this.options.column,r=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),n=this.options.query.clone(),a=r.queries.filter(function(C){return C&&C.fn==="onWhere"})[0];r.queries=[],n.queries=[];var o=this.options.type!=="string"&&parseFloat(t)?parseFloat(t):t,l=this.options.isRemote?this.options.type==="string"?"contains":"equal":this.options.type?"contains":"equal",h=!0,u=this.options.ignoreAccent,c=this.isForeignColumn(i)?i.foreignKeyValue:i.field;o=o===""||o===void 0?void 0:o;var d=[],p={field:c,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:h,ignoreAccent:u},f,v=this.options.dataManager.adaptor.getModuleName;if(this.options.type==="boolean"&&(o!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(o.toLowerCase())!==-1?o="true":o!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(o.toLowerCase())!==-1&&(o="false"),o!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(o.toLowerCase())!==-1&&v?o=(v(),!0):o!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(o.toLowerCase())!==-1&&v&&(o=(v(),!1)),l="equal"),(this.options.type==="date"||this.options.type==="datetime"||this.options.type==="dateonly")&&this.options.format){var g=new _t,b=typeof this.options.format=="string"?this.options.format:this.options.format.format;b?o=g.parseDate(t,{format:b})||new Date(t):o=new Date(t),this.options.type==="dateonly"&&(o=o.getFullYear()+"-"+R0(o.getMonth()+1)+"-"+R0(o.getDate()))}this.infiniteSearchValChange=!0,this.infiniteLoadedElem=[],this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteSkipCnt=0,this.infiniteDataCount=0,this.infiniteManualSelectMaintainPred=[],this.sInput.value===""?(this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[],this.options.parentTotalDataCount=this.options.parentTotalDataCount):this.infiniteUnloadParentExistPred=[],this.addDistinct(r);var y={requestType:i8,filterModel:this,columnName:c,column:i,operator:l,matchCase:h,ignoreAccent:u,filterChoiceCount:null,query:r,value:o};this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(y.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(Bk,y,function(C){if(C.operator=C.operator,f=new It(c,C.operator,y.value,C.matchCase,C.ignoreAccent),e.options.type==="date"||e.options.type==="datetime"||e.options.type==="dateonly"){l="equal";var x={field:c,operator:l,value:o,matchCase:h,ignoreAccent:u};m(o)||(f=oc(x,e.options.type))}if(t&&typeof t=="string"&&e.isBlanks&&e.getLocalizedLabel("Blanks").toLowerCase().indexOf(t.toLowerCase())>=0){d=d.concat(s.generateNullValuePredicates(p));var w=s.generatePredicate(d);w.predicates.push(f),f=w,r.where(w)}else t.length?(f=m(a)?f:f.and(a.e),r.where(f)):m(a)||(f=a.e,r.where(a.e));e.infiniteSearchPred=f,C.filterChoiceCount=m(C.filterChoiceCount)?1e3:C.filterChoiceCount,e.infiniteRenderMod&&e.parent.filterSettings.itemsCount!==C.filterChoiceCount&&(e.parent.filterSettings.itemsCount=y.filterChoiceCount);var M={};if(Ol(e.spinner),e.renderEmpty=!1,e.isForeignColumn(i)&&t.length){var E="result"in i.dataSource?new ge(i.dataSource.result):i.dataSource;E.executeQuery(r).then(function(T){var D=e.options.column.columnData;e.options.column.columnData=T.result,e.parent.notify(fx,{predicate:M,column:i}),M.predicate.predicates.length?n.where(M.predicate):e.renderEmpty=!0,e.options.column.columnData=D,e.infiniteRenderMod?(e.infiniteInitialLoad=!!m(e.fullData),e.makeInfiniteScrollRequest(n),n.requiresCount()):n.take(C.filterChoiceCount),e.search(C,n)})}else e.infiniteRenderMod&&e.parent.filterSettings.itemsCount?(e.infiniteInitialLoad=!!m(e.fullData),e.makeInfiniteScrollRequest(r),r.requiresCount()):r.take(C.filterChoiceCount),e.search(C,r)})},s.prototype.search=function(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)},s.prototype.getPredicateFromCols=function(e,t){for(var i=s.getPredicate(e,t),r=[],n={},a=this.parent.getForeignKeyColumns!==void 0,o=a?this.parent.getForeignKeyColumns():[],l=0,h=Object.keys(i);l<h.length;l++){var u=h[l],c=void 0;a&&!this.parent.getColumnByField(u)&&(c=C8(u,o)),c?(this.parent.notify(fx,{predicate:n,column:c}),n.predicate.predicates.length&&r.push(It.or(n.predicate.predicates))):r.push(i[""+u])}return r.length&&It.and(r)},s.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new $e},s.prototype.getAllData=function(){var e=this;this.customQuery=!1;var t=this.getQuery();t.requiresCount(),this.addDistinct(t);var i={requestType:Hk,query:t,filterChoiceCount:null},r="filterModel";i[""+r]=this,this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(i.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(Bk,i,function(n){n.filterChoiceCount=m(n.filterChoiceCount)?1e3:n.filterChoiceCount,e.infiniteRenderMod&&e.parent.filterSettings.itemsCount!==n.filterChoiceCount&&(e.parent.filterSettings.itemsCount=n.filterChoiceCount),e.infiniteRenderMod||t.take(n.filterChoiceCount),(!n.query.distincts.length||e.infiniteRenderMod)&&(e.customQuery=!0,e.queryGenerate(t)),e.infiniteRenderMod&&(e.infiniteInitialLoad=!!m(e.fullData),e.makeInfiniteScrollRequest(t)),e.parent.dataSource&&"result"in e.parent.dataSource?e.filterEvent(n,t):e.processDataOperation(t,!0)})},s.prototype.addDistinct=function(e){var t=this,i,r=ce.distinct(this.options.filteredColumns,"field");if(r.indexOf(this.options.column.field)<=-1&&(r=r.concat(this.options.column.field)),this.infiniteRenderMod||e.distinct(r),this.infiniteRenderMod&&!this.options.isRemote&&this.sInput.value==="")this.options.dataSource=this.options.dataSource instanceof ge?this.options.dataSource:new ge(this.options.dataSource),this.infinitePermenantLocalData=this.options.dataSource.dataSource.json.slice(),this.options.dataSource.dataSource.json=ce.distinct((i=this.options.parentFilteredLocalRecords).concat.apply(i,this.infinitePermenantLocalData),this.options.column.field,!0),this.isForeignColumn(this.options.column)&&(this.options.column.dataSource=this.options.column.dataSource instanceof ge?this.options.column.dataSource:new ge(this.options.column.dataSource),this.options.dataSource.dataSource.json=this.options.dataSource.dataSource.json.map(function(a,o){return Object.assign({},a,t.options.column.dataSource.dataSource.json[o])}));else if(this.infiniteRenderMod&&this.options.isRemote){e.select(this.options.column.field),e.sortBy(this.options.column.field,"ascending");var n=this.options.dataManager.adaptor.getModuleName;n&&n()&&(n()==="ODataV4Adaptor"||n()==="WebApiAdaptor"||n()==="CustomDataAdaptor"||n()==="GraphQLAdaptor"||n()==="ODataAdaptor")&&e.distinct(r)}return e},s.prototype.filterEvent=function(e,t){var i=this,r=Jz(e,t);this.parent.trigger(Zz,r.state);var n=r.deffered;n.promise.then(function(a){i.dataSuccess(a)})},s.prototype.infiniteScrollMouseKeyDownHandler=function(){I.remove(this.cBox,"scroll",this.infiniteScrollHandler)},s.prototype.infiniteScrollMouseKeyUpHandler=function(e){var t=this;I.add(this.cBox,"scroll",this.infiniteScrollHandler,this);var i=this.cBox;i.children.length>1&&(i.scrollTop>=i.scrollHeight-i.offsetHeight||i.scrollTop<=0)&&this.infiniteScrollHandler(),Ac.timer=setTimeout(function(){t.clickHandler(e),Ac.timer=null},0)},s.prototype.getListHeight=function(e){var t=St("div",{className:"e-ftrchk",styles:"visibility: hidden"});t.innerHTML='<div class="e-checkbox-wrapper"><span class="e-label e-checkboxfiltertext">A</div></span>',e.appendChild(t);var i=t.getBoundingClientRect();e.removeChild(t);var r=Math.round(i.height);return r},s.prototype.getShimmerTemplate=function(){return'<span class="e-mask e-skeleton e-skeleton-text e-shimmer-wave"></span>'},s.prototype.showMask=function(){var e=5,t,i=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxMaskList",className:"e-checkboxlist e-fields e-infinite-list e-masklist",styles:"z-index: 10;"}),r=this.cBox;if(this.removeMask(),r){var n=getComputedStyle(r),a=r.children.length?parseInt(n.height):Math.floor(parseInt(n.height.split("px")[0]))-5,o=this.isExcel&&!r.children.length&&!this.dlg.classList.contains("e-excelfilter")?"":getComputedStyle(this.dlg.querySelector(".e-dlg-content")).backgroundColor;i.style.cssText="width: "+n.width+"; min-height: "+n.minHeight+"; height: "+a+"px; margin: "+n.margin+"; border-style: "+n.borderStyle+"; border-width: "+n.borderWidth+"; border-color: "+n.borderColor+"; position: absolute; background-color: "+o+";";var l=this.getListHeight(r);e=Math.floor(a/l),e=r.children.length>e?r.children.length:e,t=l+"px"}var h='<div class="e-ftrchk e-mask-ftrchk" style="width: 100%; height:'+t+';"><div class="e-checkbox-wrapper" style="width: 100%;"><input class="e-chk-hidden">'+this.getShimmerTemplate()+this.getShimmerTemplate()+"</div></div>";if(i.innerHTML="",!r.children.length){this.spinner.insertAdjacentHTML("beforebegin",h);var u=[].slice.call(this.spinner.parentElement.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));u[0].classList.add("e-mask-checkbox-filter-intent"),u[1].classList.add("e-mask-checkbox-filter-span-intent")}this.spinner.insertBefore(i,this.cBox);for(var c=0;e&&c<e;c++){i.innerHTML+=h;var u=[].slice.call(i.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));u[0].classList.add("e-mask-checkbox-filter-intent"),u[1].classList.add("e-mask-checkbox-filter-span-intent")}this.cBox&&(i.scrollTop=this.cBox.scrollTop)},s.prototype.removeMask=function(){var e=this.dialogObj.element.querySelectorAll(".e-mask-ftrchk");if(e.length)for(var t=0;t<e.length;t++)pt(e[t]);var i=this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist");i&&pt(this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist"))},s.prototype.infiniteScrollHandler=function(){var e=this.cBox;e.scrollTop>=e.scrollHeight-e.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length<=this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3&&(!this.infiniteDataCount||this.infiniteDataCount>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)?(this.makeInfiniteScrollRequest(),this.prevInfiniteScrollDirection="down"):e.scrollTop>=e.scrollHeight-e.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(this.infiniteRemoveElements([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt+=this.prevInfiniteScrollDirection==="down"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,sc(this.cBox,this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.parent.filterSettings.itemsCount+this.infiniteSkipCnt)),this.prevInfiniteScrollDirection="down"):e.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.infiniteLoadedElem.length>this.parent.filterSettings.itemsCount*3&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(this.infiniteRemoveElements([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt-=this.prevInfiniteScrollDirection==="up"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,this.infiniteAppendElements([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount))),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up"):e.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.cBox.children.length<this.parent.filterSettings.itemsCount*3&&(this.infiniteRemoveElements([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.infiniteDataCount%this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt=(Math.floor(this.infiniteDataCount/this.parent.filterSettings.itemsCount)-3)*this.parent.filterSettings.itemsCount,this.infiniteAppendElements([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount))),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up")},s.prototype.infiniteRemoveElements=function(e){for(var t=0;t<e.length;t++)pt(e[t])},s.prototype.infiniteAppendElements=function(e){for(var t=0;t<e.length;t++)this.cBox.insertBefore(e[t],this.cBox.children[t])},s.prototype.makeInfiniteScrollRequest=function(e){var t=this;!this.infiniteInitialLoad&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"?setTimeout(function(){t.infiniteQueryExecutionPending&&t.showMask()},500):this.infiniteInitialLoad||(Nd({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),Ol(this.spinner));var i="fn";if(this.infiniteQuery&&this.infiniteQuery.queries&&this.infiniteQuery.queries.length)for(var r=0;r<this.infiniteQuery.queries.length;r++)(this.infiniteQuery.queries[r][""+i]==="onTake"||this.infiniteQuery.queries[r][""+i]==="onSkip")&&(this.infiniteQuery.queries.splice(r,1),r--);var n=!!e;e=e||this.infiniteQuery,this.infiniteInitialLoad||this.infiniteSearchValChange?this.infiniteSkipCnt=0:this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount,e.skip(this.infiniteSkipCnt),this.infiniteInitialLoad||this.infiniteSearchValChange?(e.take(this.parent.filterSettings.itemsCount*3),this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount*2):e.take(this.parent.filterSettings.itemsCount),n||(this.processDataOperation(e),this.infiniteQueryExecutionPending=!0)},s.prototype.processDataOperation=function(e,t){var i=this;this.options.dataSource=this.options.dataSource instanceof ge?this.options.dataSource:new ge(this.options.dataSource);var r=[],n=[];if(this.isForeignColumn(this.options.column)&&t){var a="result"in this.options.column.dataSource?new ge(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,r.push(a.executeQuery(this.foreignKeyQuery)),n.push(function(l){return i.foreignKeyData=l})}if(this.infiniteRenderMod&&(this.infiniteQuery=e.clone(),this.infiniteInitialLoad?(this.cBox.classList.add("e-checkbox-infinitescroll"),I.add(this.cBox,"scroll",this.infiniteScrollHandler,this),I.add(this.cBox,"mouseup",this.infiniteScrollMouseKeyUpHandler,this),I.add(this.cBox,"mousedown",this.infiniteScrollMouseKeyDownHandler,this)):this.infiniteSearchValChange&&(this.cBox.innerHTML="")),this.infiniteRenderMod&&this.infiniteInitialLoad&&!this.options.isRemote){var o=this.isForeignColumn(this.options.column)?this.options.foreignKeyValue:this.options.column.field;this.options.dataSource.executeQuery(new $e().sortBy(o,ce.fnAscending)).then(function(l){i.options.dataSource.dataSource.json=l.result,i.executeQueryOperations(e,r,n)})}else this.executeQueryOperations(e,r,n)},s.prototype.executeQueryOperations=function(e,t,i){var r=this;t.push(this.options.dataSource.executeQuery(e)),i.push(this.dataSuccess.bind(this));var n=0;Promise.all(t).then(function(a){r.infiniteQueryExecutionPending=r.infiniteRenderMod?!1:r.infiniteQueryExecutionPending;for(var o=0;o<a.length;o++)r.infiniteDataCount=r.infiniteRenderMod&&!r.infiniteDataCount?a[o].count:r.infiniteDataCount,i[n++](a[parseInt(o.toString(),10)].result)}).catch(function(){r.infiniteRenderMod&&r.parent.filterSettings&&r.parent.filterSettings.loadingIndicator==="Shimmer"&&r.parent.showMaskRow(void 0,r.dialogObj.element)})},s.prototype.dataSuccess=function(e){if(!(!this.infiniteInitialLoad&&this.infiniteDataCount&&(this.infiniteSkipCnt>=this.infiniteDataCount&&!this.infiniteSearchValChange||e.length===0))){this.fullData=e;var t={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify(o8,t),t.executeQuery){var i=new $e;this.customQuery||(this.isExecuteLocal=!0,this.queryGenerate(i),this.isExecuteLocal=!1);var r=new ge(t.dataSource).executeLocal(i),n=this.options.column;this.filteredData=s.getDistinct(r,this.options.field,n,this.foreignKeyData,this).records||[]}var a=t.executeQuery?this.filteredData:t.dataSource;this.processDataSource(null,!0,a,t),this.sInput&&(this.infiniteRenderMod&&this.infiniteInitialLoad||!this.infiniteRenderMod)&&this.sInput.focus(),(this.infiniteInitialLoad||this.infiniteSearchValChange)&&(this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1);var o={requestType:e8,columnName:this.options.field,columnType:this.options.type},l="filterModel";o[""+l]=this,this.parent.notify(Vk,o),this.isCheckboxFilterTemplate&&kd(this.spinner)}},s.prototype.queryGenerate=function(e){if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var t=this.parent.searchSettings,i=t.fields.length?t.fields:this.options.columns.map(function(l){return l.field});e.search(t.key,i,t.operator,t.ignoreCase,t.ignoreAccent)}if(this.options.filteredColumns.length){for(var r=[],n=0;n<this.options.filteredColumns.length;n++){var a=this.options.filteredColumns[parseInt(n.toString(),10)];this.options.uid?(a.uid=a.uid||this.parent.getColumnByField(a.field).uid,a.uid!==this.options.uid&&r.push(this.options.filteredColumns[parseInt(n.toString(),10)])):a.field!==this.options.field&&r.push(this.options.filteredColumns[parseInt(n.toString(),10)])}var o=this.getPredicateFromCols(r,this.isExecuteLocal);o&&e.where(o)}},s.prototype.processDataSource=function(e,t,i,r){Ol(this.spinner),this.isExecuteLocal=!0,this.updateResult(),this.isExecuteLocal=!1;var n={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify(d8,n),this.isCheckboxFilterTemplate=n.isCheckboxFilterTemplate,this.isCheckboxFilterTemplate?this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask():this.createFilterItems(i,t,r)},s.prototype.processSearch=function(e){this.processDataOperation(e)},s.prototype.updateResult=function(){this.result={};var e=this.infiniteRenderMod&&this.existingPredicate[this.options.field]?this.getPredicateFromCols(this.existingPredicate[this.options.field],this.isExecuteLocal):this.getPredicateFromCols(this.options.filteredColumns,this.isExecuteLocal),t=new $e;e&&t.where(e),this.parent.notify(u8,{query:t});for(var i=new ge(this.fullData).executeLocal(t),r=0,n=i;r<n.length;r++){var a=n[r];this.result[qk(this.options.field,a)]=!0}},s.prototype.clickHandler=function(e){var t;m(Ac.timer)||clearTimeout(Ac.timer);var i=e.target;if(!(!m(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&Br(i,"e-mask-ftrchk"))){var r=Br(i,"e-checkbox-wrapper");if(Br(i,"e-searchbox")&&this.searchBoxClick(e),r&&!this.isCheckboxFilterTemplate){var n=r.querySelector(".e-selectall");if(n)this.updateAllCBoxes(!n.classList.contains("e-check"));else if(ac(r.parentElement),this.infiniteRenderMod&&!r.parentElement.querySelector(".e-add-current")){this.localInfiniteSelectionInteracted=!0;var a=this.options.allowCaseSensitive,o=r.parentElement.querySelector(".e-frame"),l=o.previousSibling,h=l.checked?"equal":"notequal",u=l.checked?"or":"and",c={field:this.options.field,predicate:u,uid:this.options.uid,operator:h,type:this.options.type,matchCase:a,ignoreAccent:this.options.ignoreAccent},d=this.values[Br(l,"e-ftrchk").getAttribute("uid")];if(this.updateInfiniteManualSelectPred(c,d),this.infiniteRenderMod&&!this.options.isRemote&&this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length){var p=this.getPredicateFromCols((t=this.options.filteredColumns).concat.apply(t,this.infiniteManualSelectMaintainPred),!0),f=new $e;p&&f.where(p);var v=new ge(this.infinitePermenantLocalData).executeLocal(f);this.options.parentTotalDataCount!==v.length&&(this.options.parentTotalDataCount=v.length),!this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length&&(this.infiniteUnloadParentExistPred=[])}this.infiniteUnloadParentExistPred.length&&(this.options.parentTotalDataCount===this.infiniteDataCount||!this.options.parentTotalDataCount)&&(this.infiniteUnloadParentExistPred=[])}this.updateIndeterminatenBtn(),r.querySelector(".e-chk-hidden").focus()}this.setFocus(Br(r,"e-ftrchk"))}},s.prototype.updateInfiniteManualSelectPred=function(e,t){for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(r.value+""==t+""&&(r.operator==="equal"||r.operator==="notequal")){this.infiniteManualSelectMaintainPred.splice(i,1);break}}(e.predicate==="or"&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll)||e.predicate==="and"&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll))&&(this.infiniteManualSelectMaintainPred.push(me({},{value:t},e)),e.predicate==="or"?this.options.parentTotalDataCount++:this.options.parentTotalDataCount--)},s.prototype.keyupHandler=function(e){(e.key==="Tab"&&e.shiftKey||e.key==="Tab"||e.key==="ArrowUp"||e.key==="ArrowDown")&&this.setFocus(Br(e.target,"e-ftrchk"))},s.prototype.setFocus=function(e){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e!==t&&e.classList.add("e-chkfocus")},s.prototype.updateAllCBoxes=function(e){this.infiniteRenderMod&&(this.localInfiniteSelectAllClicked=!0,this.infiniteLocalSelectAll=e,this.infiniteUnloadParentExistPred=[],this.infiniteManualSelectMaintainPred=[]);for(var t=this.infiniteRenderMod?this.infiniteLoadedElem.map(function(a){return a.querySelector(".e-frame")}):[].slice.call(this.cBox.querySelectorAll(".e-frame:not(.e-add-current)")),i=0,r=t;i<r.length;i++){var n=r[i];y8(n,e),Km(n.previousSibling,e)}},s.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},s.prototype.createCheckbox=function(e,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);Km(r.querySelector("input"),t);var n=r.querySelector(".e-label"),a=S8({},i,{column:this.options.column,parent:this.parent}),o=this.options.disableHtmlEncode?"textContent":"innerHTML";n[""+o]=!m(e)&&e.toString().length?this.parent.enableHtmlSanitizer?Fi.sanitize(e):e:this.getLocalizedLabel("Blanks");var l=Oo("cbox");if(n.setAttribute("id",l+"cboxLabel"),r.querySelector("input").setAttribute("aria-labelledby",n.id),n.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),typeof e=="boolean"&&(n.innerHTML=e===!0?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),Q([n],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&i[this.options.column.field]!==this.getLocalizedLabel("AddCurrentSelection")){n.innerHTML="";var h=this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string",u=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;h||u?(this.options.template(a,this.parent,"filterItemTemplate",null,null,null,n),this.parent.renderTemplates()):sc(n,this.options.template(a,this.parent,"filterItemTemplate"))}return r},s.prototype.updateIndeterminatenBtn=function(){var e=this.infiniteRenderMod?this.infiniteLoadedElem.length:this.cBox.children.length-1,t=[],i=!1,r=this.infiniteRenderMod?this.sBox.querySelector(".e-selectall"):this.cBox.querySelector(".e-selectall"),n=this.infiniteRenderMod?this.infiniteLoadedElem.filter(function(l){return l.querySelector(".e-check")}).length:this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)").length;this.cBox.querySelector(".e-add-current")&&(e-=1);var a;this.options.isResponsiveFilter||(a=this.dialogObj.btnObj[0],a.disabled=!1);var o=r.previousSibling;Km(o,!1),o.indeterminate=!1,this.infiniteRenderMod&&this.sInput.value===""&&!this.options.parentCurrentViewDataCount&&!this.localInfiniteSelectionInteracted&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll&&!n)&&(e!==n||e===n)?n=0:this.infiniteRenderMod&&this.infiniteLoadedElem.length<this.infiniteDataCount&&this.infiniteUnloadParentExistPred.length&&(!n||e===n)&&this.infiniteLocalSelectAll&&(n?e+=this.infiniteUnloadParentExistPred.length:n+=this.infiniteUnloadParentExistPred.length),e===n?(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),t=["e-check"],Km(o,!0)):n?(t=["e-stop"],o.indeterminate=!0):(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!1,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),t=["e-uncheck"],i=!0,a&&(a.disabled=!0)),a&&(this.filterState=!a.disabled,a.dataBind()),te([r],["e-check","e-stop","e-uncheck"]),Q([r],t),this.parent.notify(Uk,{disabled:i})},s.prototype.createFilterItems=function(e,t,i){var r,n,a,o=this.parent.createElement("div"),l,h=!1;this.options.isResponsiveFilter||(l=this.dialogObj.btnObj[0]);var u=-1,c="ejValue";i.executeQuery||(c=i.field);for(var d=0;d<e.length;d++){var p=ie(c,e[parseInt(d.toString(),10)]);(p===""||m(p))&&(u=u+1)}if(this.infiniteRenderMod||(this.itemsCnt=u!==-1?e.length-u:e.length),this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask(),e.length&&!this.renderEmpty){var f=this.getLocalizedLabel("SelectAll"),v=this.cBox.querySelector(".e-checkfltrnmdiv");v&&v.classList.remove("e-checkfltrnmdiv");var g=this.createCheckbox(f,!1,(r={},r[this.options.field]=f,r));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Q([g],this.parent.cssClass.split(" ")):Q([g],[this.parent.cssClass])),this.infiniteInitialLoad||!this.infiniteRenderMod){var b=Ml(Oo("cbox"),g,"e-ftrchk");b.querySelector(".e-frame").classList.add("e-selectall"),this.infiniteRenderMod?this.sBox.insertBefore(b,this.spinner):o.appendChild(b)}else this.sBox.querySelector(".e-ftrchk .e-selectall")&&(this.sBox.querySelector(".e-ftrchk .e-selectall").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-selectall").parentElement.classList.remove("e-checkbox-disabled"));var y=new It("field","equal",this.options.field);this.options.foreignKeyValue&&(y=y.or("field","equal",this.options.foreignKeyValue));var C=new ge(this.options.filteredColumns).executeLocal(new $e().where(y)).length;if(this.sInput.value){var x=this.createCheckbox(this.getLocalizedLabel("AddCurrentSelection"),!1,(n={},n[this.options.field]=this.getLocalizedLabel("AddCurrentSelection"),n));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Q([x],this.parent.cssClass.split(" ")):Q([x],[this.parent.cssClass])),this.infiniteRenderMod&&!m(this.sBox.children[2])&&this.sBox.children[2].innerText!=="Add current selection to filter"||!this.infiniteRenderMod){var w=Ml(Oo("cbox"),x,"e-ftrchk");if(w.querySelector(".e-frame").classList.add("e-add-current"),this.infiniteRenderMod){this.sBox.insertBefore(w,this.spinner);var M=this.spinner.querySelector(".e-checkboxlist"),E=Math.ceil(w.getBoundingClientRect().height);M.style.height=parseInt(getComputedStyle(M).height.split("px")[0])-E+"px",M.style.minHeight=M.style.height}else o.appendChild(w)}else this.sBox.querySelector(".e-ftrchk .e-add-current")&&(this.sBox.querySelector(".e-ftrchk .e-add-current").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-add-current").parentElement.classList.remove("e-checkbox-disabled"))}else if(this.infiniteRenderMod&&!m(this.sBox.children[2])&&this.sBox.children[2].innerText==="Add current selection to filter"){var M=this.spinner.querySelector(".e-checkboxlist"),T=Math.ceil(this.sBox.children[2].getBoundingClientRect().height);M.style.height=parseInt(getComputedStyle(M).height.split("px")[0])+T+"px",M.style.minHeight=M.style.height,pt(this.sBox.children[2])}for(var D=void 0,d=0;d<e.length;d++){var N=Oo("cbox");this.values[""+N]=ie(c,e[parseInt(d.toString(),10)]);var A=ie(this.options.field,e[parseInt(d.toString(),10)]);this.options.formatFn&&(A=this.valueFormatter.toView(A,this.options.formatFn));var L={value:A,column:this.options.column,data:e[parseInt(d.toString(),10)]};if(this.parent.notify(HM,L),A=L.value,A===""||m(A)){if(D)continue;D=!0}this.infiniteRenderMod&&this.updateInfiniteUnLoadedCheckboxExistPred(A,this.infiniteUnloadParentExistPred);var k=this.localInfiniteSelectAllClicked?this.createCheckbox(A,this.infiniteLocalSelectAll,ie("dataObj",e[d])):this.createCheckbox(A,this.getCheckedState(C,this.values[""+N]),ie("dataObj",e[d]));o.appendChild(Ml(N,k,"e-ftrchk")),this.infiniteRenderMod&&(o.lastChild.style.height=this.getListHeight(this.cBox)+"px")}var O=this.cBox.scrollTop;!this.infiniteRenderMod||this.infiniteSearchValChange?this.cBox.innerHTML="":this.infiniteRenderMod&&this.cBox.children.length&&this.infiniteRemoveElements([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteRenderMod&&((a=this.infiniteLoadedElem).push.apply(a,[].slice.call(o.children)),this.itemsCnt=u!==-1?this.infiniteLoadedElem.length-u:this.infiniteLoadedElem.length),this.infiniteUnloadParentExistPred.length&&(this.infiniteLoadedElem.length>=this.infiniteDataCount||!this.options.parentCurrentViewDataCount||this.options.parentTotalDataCount===this.infiniteDataCount&&this.options.parentCurrentViewDataCount)&&(this.infiniteUnloadParentExistPred=[]),sc(this.cBox,[].slice.call(o.children)),this.infiniteRenderMod&&!this.infiniteScrollAppendDiff&&(this.infiniteScrollAppendDiff=Math.round(O-this.cBox.scrollTop)),this.updateIndeterminatenBtn(),this.infiniteRenderMod?l.disabled?h=!0:h=!1:(l&&(l.disabled=!1),h=!1)}else{if(o.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.infiniteRenderMod){var b=this.sBox.querySelector(".e-ftrchk .e-selectall");if(b){var R=b.parentElement.parentElement;b.classList.contains("e-check")?ac(R):b.classList.contains("e-stop")&&(ac(R),b.classList.remove("e-stop"),ac(R)),b.previousSibling.disabled=!0,b.parentElement.classList.add("e-checkbox-disabled")}var j=this.sBox.querySelector(".e-ftrchk .e-add-current");if(j){var P=j.parentElement.parentElement;j.classList.contains("e-check")&&ac(P),j.previousSibling.disabled=!0,j.parentElement.classList.add("e-checkbox-disabled")}}this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),sc(this.cBox.children[0],[].slice.call(o.children)),l&&(l.disabled=!0),h=!0,this.filterState=!h}l&&e.length&&(this.filterState=!l.disabled,l.dataBind());var F={requestType:Hk,dataSource:this.renderEmpty?[]:e},z="filterModel";F[""+z]=this,this.parent.notify(Vk,F),this.parent.notify(Uk,{disabled:h}),this.infiniteRenderMod&&this.infiniteInitialLoad&&(this.cBox.style.marginTop="0px"),kd(this.spinner)},s.prototype.updateInfiniteUnLoadedCheckboxExistPred=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e===r.value&&(r.operator==="equal"||r.operator==="notequal")&&(this.infiniteManualSelectMaintainPred.push(t[i]),t.splice(i,1),i--)}},s.prototype.getCheckedState=function(e,t){if(!this.isFiltered||!e)return!0;var i=this.sInput.value?!0:this.result[""+t];return this.infiniteRenderMod?i:this.options.operator==="notequal"?!i:i},s.getDistinct=function(e,t,i,r,n){for(var a=e.length,o=[],l,h="ejValue",u={},c=i&&i.isForeignColumn?i.isForeignColumn():!1;a--;){if(l=e[parseInt(a.toString(),10)],i&&i.type==="dateonly"&&typeof l[""+t]=="string"&&l[""+t]){var d=l[""+t].split(/[^0-9.]/);l[""+t]=new Date(parseInt(d[0],10),parseInt(d[1],10)-1,parseInt(d[2],10))}l=qk(t,l);var p=typeof l=="string"&&!m(n)&&!m(n.parent)&&!m(n.parent.filterSettings)&&!m(n.parent.filterSettings.enableCaseSensitivity)?l.toLowerCase():l;if(!(p in u)){var f={};if(f[""+h]=l,u[""+p]=!0,c){var v=b8(i,{},l,r)[0];kt(n8,v,e[parseInt(a.toString(),10)]),l=ie(i.foreignKeyValue,v)}kt(t,m(l)?null:l,f),kt("dataObj",e[parseInt(a.toString(),10)],f),o.push(f)}}return ce.group(ce.sort(o,t,ce.fnAscending),"ejValue")},s.getPredicate=function(e,t){for(var i=ce.distinct(e,"field",!0)||[],r=[],n={},a=0;a<i.length;a++)r=new ge(e).executeLocal(new $e().where("field","equal",i[parseInt(a.toString(),10)].field)),r.length!==0&&(n[i[parseInt(a.toString(),10)].field]=s.generatePredicate(r,t));return n},s.generatePredicate=function(e,t){var i=e?e.length:0,r,n="or",a=s.updateDateFilter(e[0]);a.ignoreAccent=m(a.ignoreAccent)?!1:a.ignoreAccent,a.type==="date"||a.type==="datetime"||a.type==="dateonly"?r=oc(a,a.type,t):r=a.ejpredicate?a.ejpredicate:new It(a.field,a.operator,a.value,!s.getCaseValue(a),a.ignoreAccent);for(var o=1;o<i;o++)e[parseInt(o.toString(),10)]=s.updateDateFilter(e[parseInt(o.toString(),10)]),i>2&&o>1&&(e[o].predicate==="or"&&e[o-1].predicate==="or"||e[o].predicate==="and"&&e[o-1].predicate==="and")?e[o].type==="date"||e[o].type==="datetime"||e[o].type==="dateonly"?r.predicates.push(oc(e[parseInt(o.toString(),10)],e[o].type,t)):r.predicates.push(new It(e[o].field,e[parseInt(o.toString(),10)].operator,e[parseInt(o.toString(),10)].value,!s.getCaseValue(e[parseInt(o.toString(),10)]),e[parseInt(o.toString(),10)].ignoreAccent)):e[o].type==="date"||e[o].type==="datetime"||e[o].type==="dateonly"?e[parseInt(o.toString(),10)].predicate==="and"&&e[parseInt(o.toString(),10)].operator==="equal"?r=r[""+n](oc(e[parseInt(o.toString(),10)],e[parseInt(o.toString(),10)].type,t),e[parseInt(o.toString(),10)].type,e[parseInt(o.toString(),10)].ignoreAccent):r=r[e[parseInt(o.toString(),10)].predicate](oc(e[parseInt(o.toString(),10)],e[parseInt(o.toString(),10)].type,t),e[parseInt(o.toString(),10)].type,e[parseInt(o.toString(),10)].ignoreAccent):r=e[parseInt(o.toString(),10)].ejpredicate?r[e[parseInt(o.toString(),10)].predicate](e[parseInt(o.toString(),10)].ejpredicate):r[e[parseInt(o.toString(),10)].predicate](e[parseInt(o.toString(),10)].field,e[parseInt(o.toString(),10)].operator,e[parseInt(o.toString(),10)].value,!s.getCaseValue(e[parseInt(o.toString(),10)]),e[parseInt(o.toString(),10)].ignoreAccent);return r||null},s.getCaseValue=function(e){return m(e.matchCase)?!(e.type==="string"||m(e.type)&&typeof e.value=="string"):e.matchCase},s.updateDateFilter=function(e){return(e.type==="date"||e.type==="datetime"||e.type==="dateonly"||e.value instanceof Date)&&(e.type=e.type||"date"),e},s}(),i2=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Us="e-other-month",vx="e-other-year",xp="e-calendar",Kk="e-device",M8="e-header",Zk="e-rtl",E8="e-content",mx="e-year",gx="e-month",Jk="e-decade",eL="e-icons",I8="e-prev",T8="e-next",D8="e-date-icon-prev",A8="e-date-icon-next ",N8="e-icon-container",ar="e-disabled",cl="e-overlay",k8="e-weekend",yx="e-week-number",Xr="e-selected",ss="e-focused-date",Zm="e-month-hide",tL="e-today",L8="e-title",iL="e-day",rL="e-cell",O8="e-week-header",Jm="e-zoomin",R8="e-footer-container",F8="e-btn",P8="e-flat",z8="e-css",j8="e-primary",nL="e-calendar-day-header-lg",bx=864e5,B8=6e4,H8=function(s){i2(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.effect="",r.isPopupClicked=!1,r.isDateSelected=!0,r.isTodayClicked=!1,r.preventChange=!1,r.isAngular=!1,r.previousDates=!1,r}return e.prototype.render=function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),this.calendarMode==="Islamic"&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new _t(this.locale),(m(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date(new Date().setHours(0,0,0,0)),this.getModuleName()==="calendar"?(this.element.classList.add(xp),this.enableRtl&&this.element.classList.add(Zk),B.isDevice&&this.element.classList.add(Kk),De(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(xp),this.enableRtl&&this.calendarElement.classList.add(Zk),B.isDevice&&this.calendarElement.classList.add(Kk),De(this.calendarElement,{"data-role":"calendar"})),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.createHeader(),this.createContent(),this.wireEvents()},e.prototype.rangeValidation=function(t,i){m(t)&&this.setProperties({min:new Date(1900,0,1)},!0),m(i)&&this.setProperties({max:new Date(2099,11,31)},!0)},e.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs},e.prototype.validateDate=function(t){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date(new Date().setHours(0,0,0,0)),!m(t)&&this.min<=this.max&&t>=this.min&&t<=this.max&&(this.currentDate=new Date(this.checkValue(t)))},e.prototype.setOverlayIndex=function(t,i,r,n){if(n&&!m(i)&&!m(r)&&!m(t)){var a=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(a-1).toString(),t.style.zIndex=a.toString()}},e.prototype.minMaxUpdate=function(t){+this.min<=+this.max?te([this.element],cl):(this.setProperties({min:this.min},!0),Q([this.element],cl)),this.min=m(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=m(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&t&&+t<=+this.max&&+t>=+this.min?this.currentDate=new Date(this.checkValue(t)):+this.min<=+this.max&&!t&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))},e.prototype.createHeader=function(){var t={"aria-disabled":"false","aria-label":"previous month"},i={"aria-disabled":"false","aria-label":"next month"},r={"aria-atomic":"true","aria-live":"assertive","aria-label":"title"};this.headerElement=this.createElement("div",{className:M8});var n=this.createElement("div",{className:N8});this.previousIcon=this.createElement("button",{className:""+I8,attrs:{type:"button"}}),yr(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),De(this.previousIcon,t),this.nextIcon=this.createElement("button",{className:""+T8,attrs:{type:"button"}}),yr(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.getModuleName()==="daterangepicker"&&(De(this.previousIcon,{tabIndex:"-1"}),De(this.nextIcon,{tabIndex:"-1"})),De(this.nextIcon,i),this.headerTitleElement=this.createElement("div",{className:""+iL+" "+L8}),De(this.headerTitleElement,r),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:""+D8+" "+eL})),this.nextIcon.appendChild(this.createElement("span",{className:""+A8+" "+eL})),n.appendChild(this.previousIcon),n.appendChild(this.nextIcon),this.headerElement.appendChild(n),this.getModuleName()==="calendar"?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()},e.prototype.createContent=function(){this.contentElement=this.createElement("div",{className:E8}),this.table=this.createElement("table",{attrs:{tabIndex:"0",role:"grid","aria-activedescendant":"","aria-labelledby":this.element.id}}),this.getModuleName()==="calendar"?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter()},e.prototype.getCultureValues=function(){var t=[],i,r="days.stand-alone."+this.dayHeaderFormat.toLowerCase();if(this.locale==="en"||this.locale==="en-US"?i=ie(r,xl()):i=this.getCultureObjects(hr,""+this.locale),!m(i))for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];t.push(ie(o,i))}return t},e.prototype.toCapitalize=function(t){return!m(t)&&t.length?t[0].toUpperCase()+t.slice(1):t},e.prototype.createContentHeader=function(){this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content .e-week-header")[0])||ne(this.element.querySelectorAll(".e-content .e-week-header")[0]):m(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||ne(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var t=6,i="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:O8}),this.weekNumber&&(i+='<th class="e-week-number" aria-hidden="true"></th>',this.getModuleName()==="calendar"?Q([this.element],""+yx):Q([this.calendarElement],""+yx));var r=this.getCultureValues().length>0&&this.getCultureValues()?this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek):null;if(!m(r))for(var n=0;n<=t;n++)i+='<th  class="">'+this.toCapitalize(r[n])+"</th>";i="<tr>"+i+"</tr>",this.tableHeadElement.innerHTML=i,this.table.appendChild(this.tableHeadElement)},e.prototype.createContentBody=function(){switch(this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content tbody")[0])||ne(this.element.querySelectorAll(".e-content tbody")[0]):m(this.calendarElement.querySelectorAll(".e-content tbody")[0])||ne(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}},e.prototype.updateFooter=function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today"))},e.prototype.createContentFooter=function(){if(this.showTodayButton){var t=new Date(+this.min),i=new Date(+this.max),r={today:"Today"};this.globalize=new _t(this.locale),this.l10=new In(this.getModuleName(),r,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),yr(this.todayElement),this.updateFooter(),Q([this.todayElement],[F8,tL,P8,j8,z8]),(!(+new Date(t.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(i.setHours(0,0,0,0)))||this.todayDisabled)&&Q([this.todayElement],ar),this.footer=this.createElement("div",{className:R8}),this.footer.appendChild(this.todayElement),this.getModuleName()==="calendar"&&this.element.appendChild(this.footer),this.getModuleName()==="datepicker"&&this.calendarElement.appendChild(this.footer),this.getModuleName()==="datetimepicker"&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(ar)||I.add(this.todayElement,"click",this.todayButtonClick,this)}},e.prototype.wireEvents=function(t,i,r,n){I.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=me(this.defaultKeyConfigs,this.keyConfigs),this.getModuleName()==="calendar"?this.keyboardModule=new wr(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):this.keyboardModule=new wr(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.dateWireEvents=function(t,i,r,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=me(this.defaultKeyConfigs,r),this.serverModuleName=n},e.prototype.todayButtonClick=function(t,i,r){this.showTodayButton&&(this.currentView()===this.depth?this.effect="":this.effect="e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(i)),r):this.navigateTo("Month",new Date(this.checkValue(i)),r))},e.prototype.resetCalendar=function(){this.calendarElement&&ne(this.calendarElement),this.tableBodyElement&&ne(this.tableBodyElement),this.table&&ne(this.table),this.tableHeadElement&&ne(this.tableHeadElement),this.nextIcon&&ne(this.nextIcon),this.previousIcon&&ne(this.previousIcon),this.footer&&ne(this.footer),this.todayElement=null,this.renderDayCellArgs=null,this.calendarElement=this.tableBodyElement=this.footer=this.tableHeadElement=this.nextIcon=this.previousIcon=this.table=null},e.prototype.keyActionHandle=function(t,i,r){var n=this.tableBodyElement.querySelector("tr td.e-focused-date"),a;r?!m(n)&&+i===parseInt(n.getAttribute("id").split("_")[0],10)?a=n:a=this.tableBodyElement.querySelector("tr td.e-selected"):a=this.tableBodyElement.querySelector("tr td.e-selected");var o=this.getViewNumber(this.currentView()),l=this.getViewNumber(this.depth),h=o===l&&this.getViewNumber(this.start)>=l;switch(this.effect="",t.action){case"moveLeft":this.keyboardNavigate(-1,o,t,this.max,this.min),t.preventDefault();break;case"moveRight":this.keyboardNavigate(1,o,t,this.max,this.min),t.preventDefault();break;case"moveUp":o===0?this.keyboardNavigate(-7,o,t,this.max,this.min):this.keyboardNavigate(-4,o,t,this.max,this.min),t.preventDefault();break;case"moveDown":o===0?this.keyboardNavigate(7,o,t,this.max,this.min):this.keyboardNavigate(4,o,t,this.max,this.min),t.preventDefault();break;case"select":if(t.target===this.todayElement)this.todayButtonClick(t,i);else{var u=m(n)?a:n;if(!m(u)&&!u.classList.contains(ar))if(h){var c=new Date(parseInt(""+u.id,0));this.selectDate(t,c,u)}else this.contentClick(null,--o,u,i)}break;case"controlUp":this.title(),t.preventDefault();break;case"controlDown":(!m(n)&&!h||!m(a)&&!h)&&this.contentClick(null,--o,n||a,i),t.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),ne(this.tableBodyElement),o===0?this.renderMonths(t):o===1?this.renderYears(t):this.renderDecades(t),t.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,o),ne(this.tableBodyElement),o===0?this.renderMonths(t):o===1?this.renderYears(t):this.renderDecades(t),t.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),t.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),t.preventDefault();break}this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.keyboardNavigate=function(t,i,r,n,a){var o=new Date(this.checkValue(this.currentDate));switch(i){case 2:this.addYears(this.currentDate,t),this.isMonthYearRange(this.currentDate)?(ne(this.tableBodyElement),this.renderDecades(r)):this.currentDate=o;break;case 1:this.addMonths(this.currentDate,t),this.calendarMode==="Gregorian"?this.isMonthYearRange(this.currentDate)?(ne(this.tableBodyElement),this.renderYears(r)):this.currentDate=o:this.isMonthYearRange(this.currentDate)?(ne(this.tableBodyElement),this.renderYears(r)):this.currentDate=o;break;case 0:this.addDay(this.currentDate,t,r,n,a),this.isMinMaxRange(this.currentDate)?(ne(this.tableBodyElement),this.renderMonths(r)):this.currentDate=o;break}},e.prototype.preRender=function(t){var i=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(r){i.triggerNavigate(r)}},e.prototype.minMaxDate=function(t){var i=new Date(new Date(+t).setHours(0,0,0,0)),r=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return(+i==+r||+i==+n)&&(+t<+this.min&&(t=new Date(+this.min)),+t>+this.max&&(t=new Date(+this.max))),t},e.prototype.renderMonths=function(t,i,r){var n=this.weekNumber?8:7,a;this.calendarMode==="Gregorian"?a=this.renderDays(this.currentDate,i,null,null,r,t):a=this.islamicModule.islamicRenderDays(this.currentDate,i),this.createContentHeader(),this.calendarMode==="Gregorian"?this.renderTemplate(a,n,gx,t,i):this.islamicModule.islamicRenderTemplate(a,n,gx,t,i)},e.prototype.renderDays=function(t,i,r,n,a,o){var l=[],h=42,u=a?new Date(+t):this.getDate(new Date,this.timezone),c=new Date(this.checkValue(t)),d,p=c.getMonth();this.titleUpdate(t,"days");var f=c;for(c=new Date(f.getFullYear(),f.getMonth(),0,f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds());c.getDay()!==this.firstDayOfWeek;)this.setStartDate(c,-1*bx);for(var v=0;v<h;++v){var g=this.createElement("td",{className:rL}),b=this.createElement("span");if(v%7===0&&this.weekNumber){var y=this.weekRule==="FirstDay"?6:this.weekRule==="FirstFourDayWeek"?3:0,C=new Date(c.getFullYear(),c.getMonth(),c.getDate()+y);b.textContent=""+this.getWeek(C),g.appendChild(b),Q([g],""+yx),l.push(g)}d=new Date(+c),c=this.minMaxDate(c);var x={type:"dateTime",skeleton:"full"},w=this.globalize.parseDate(this.globalize.formatDate(c,x),x),M=this.dayCell(c),E=this.globalize.formatDate(c,{type:"date",skeleton:"full"}),T=this.createElement("span");T.textContent=this.globalize.formatDate(c,{format:"d",type:"date",skeleton:"yMd"});var D=this.min>c||this.max<c;D?(Q([M],ar),Q([M],cl)):T.setAttribute("title",""+E),p!==c.getMonth()&&(Q([M],Us),T.setAttribute("aria-disabled","true")),(c.getDay()===0||c.getDay()===6)&&Q([M],k8),M.appendChild(T),this.renderDayCellArgs={date:c,isDisabled:!1,element:M,isOutOfRange:D};var N=this.renderDayCellArgs;if(this.renderDayCellEvent(N),N.isDisabled){var A=new Date(this.checkValue(i)),L=new Date(this.checkValue(N.date));if(r){if(!m(n)&&n.length>0)for(var k=0;k<n.length;k++){var O=+new Date(this.globalize.formatDate(N.date,{type:"date",skeleton:"yMd"})),R=+new Date(this.globalize.formatDate(n[k],{type:"date",skeleton:"yMd"}));O===R&&(n.splice(k,1),k=-1)}}else A&&+A==+L&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!M.classList.contains(Xr)&&(Q([M],ar),Q([M],cl),T.setAttribute("aria-disabled","true"),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var j=M.classList.contains(Us),P=M.classList.contains(ar);P||I.add(M,"click",this.clickHandler,this);var F=void 0;if(!m(o)&&o.type==="click"&&(F=o.currentTarget),r&&!m(n)&&!P){for(var z=0;z<n.length;z++){var q=this.calendarMode==="Gregorian"?"gregorian":"islamic",X={format:null,type:"date",skeleton:"short",calendar:q},O=this.globalize.formatDate(c,X),R=this.globalize.formatDate(n[z],X);if((O===R&&this.getDateVal(c,n[z])||this.getDateVal(c,i))&&Q([M],Xr),!m(F)&&F.innerText===M.innerText&&this.previousDates&&M.classList.contains(Xr)&&F.classList.contains(Xr)){te([M],Xr),this.previousDates=!1;for(var G=this.copyValues(n),Z=0;Z<G.length;Z++){var se=this.calendarMode==="Gregorian"?"gregorian":"islamic",oe={format:null,type:"date",skeleton:"short",calendar:se},fe=this.globalize.formatDate(w,oe),be=this.globalize.formatDate(G[Z],oe);if(fe===be){var k=G.indexOf(G[Z]);G.splice(k,1),n.splice(k,1)}}this.setProperties({values:G},!0)}else this.updateFocus(j,P,c,M,t)}n.length<=0&&this.updateFocus(j,P,c,M,t)}else!P&&this.getDateVal(c,i)&&Q([M],Xr);this.updateFocus(j,P,c,M,t),!m(w)&&w.getFullYear()===u.getFullYear()&&w.getMonth()===u.getMonth()&&w.getDate()===u.getDate()&&Q([M],tL),l.push(this.renderDayCellArgs.element),c=new Date(+d),this.addDay(c,1,null,this.max,this.min)}return l},e.prototype.updateFocus=function(t,i,r,n,a){a.getDate()===r.getDate()&&!t&&!i?Q([n],ss):(a>=this.max&&parseInt(n.id,0)===+this.max&&!t&&!i&&Q([n],ss),a<=this.min&&parseInt(n.id,0)===+this.min&&!t&&!i&&Q([n],ss))},e.prototype.renderYears=function(t,i){this.removeTableHeadElement();var r=4,n=[],a=m(i),o=new Date(this.checkValue(this.currentDate)),l=o.getMonth(),h=o.getFullYear(),u=o,c=u.getFullYear(),d=new Date(this.checkValue(this.min)).getFullYear(),p=new Date(this.checkValue(this.min)).getMonth(),f=new Date(this.checkValue(this.max)).getFullYear(),v=new Date(this.checkValue(this.max)).getMonth();u.setMonth(0),this.titleUpdate(this.currentDate,"months"),u.setDate(1);for(var g=0;g<12;++g){var b=this.dayCell(u),y=this.createElement("span"),C=i&&i.getMonth()===u.getMonth(),x=i&&i.getFullYear()===h&&C,w=this.globalize.formatDate(u,{type:"date",format:"MMM y"});y.textContent=this.toCapitalize(this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"MMM"})),this.min&&(c<d||g<p&&c===d)||this.max&&(c>f||g>v&&c>=f)?Q([b],ar):!a&&x?Q([b],Xr):u.getMonth()===l&&this.currentDate.getMonth()===l&&Q([b],ss),u.setDate(1),u.setMonth(u.getMonth()+1),b.classList.contains(ar)||(I.add(b,"click",this.clickHandler,this),y.setAttribute("title",""+w)),b.appendChild(y),n.push(b)}this.renderTemplate(n,r,mx,t,i)},e.prototype.renderDecades=function(t,i){this.removeTableHeadElement();var r=4,n=12,a=[],o=new Date(this.checkValue(this.currentDate));o.setMonth(0),o.setDate(1);var l=o.getFullYear(),h=new Date(o.setFullYear(l-l%10)),u=new Date(o.setFullYear(l-l%10+9)),c=h.getFullYear(),d=u.getFullYear(),p=this.globalize.formatDate(h,{format:null,type:"dateTime",skeleton:"y"}),f=this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=p+" - "+f;for(var v=new Date(l-l%10-1,0,1),g=v.getFullYear(),b=0;b<n;++b){var y=g+b;o.setFullYear(y);var C=this.dayCell(o),x=this.createElement("span");x.textContent=this.globalize.formatDate(o,{format:null,type:"dateTime",skeleton:"y"}),y<c||y>d?(Q([C],vx),x.setAttribute("aria-disabled","true"),!m(i)&&o.getFullYear()===i.getFullYear()&&Q([C],Xr),(y<new Date(this.checkValue(this.min)).getFullYear()||y>new Date(this.checkValue(this.max)).getFullYear())&&Q([C],ar)):y<new Date(this.checkValue(this.min)).getFullYear()||y>new Date(this.checkValue(this.max)).getFullYear()?Q([C],ar):!m(i)&&o.getFullYear()===i.getFullYear()?Q([C],Xr):o.getFullYear()===this.currentDate.getFullYear()&&!C.classList.contains(ar)&&Q([C],ss),C.classList.contains(ar)||(I.add(C,"click",this.clickHandler,this),x.setAttribute("title",""+x.textContent)),C.appendChild(x),a.push(C)}this.renderTemplate(a,r,"e-decade",t,i)},e.prototype.dayCell=function(t){var i=this.calendarMode==="Gregorian"?"gregorian":"islamic",r={skeleton:"full",type:"dateTime",calendar:i},n=this.globalize.parseDate(this.globalize.formatDate(t,r),r),a;m(n)||(a=n.valueOf());var o={className:rL,attrs:{id:""+mi(""+a),"aria-selected":"false"}};return this.createElement("td",o)},e.prototype.firstDay=function(t){var i=this.currentView()!=="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+Us):this.tableBodyElement.querySelectorAll("td:not(."+vx);if(i.length){for(var r=0;r<i.length;r++)if(!i[r].classList.contains(ar)){t=new Date(parseInt(i[r].id,0));break}}return t},e.prototype.lastDay=function(t,i){var r=new Date(t.getFullYear(),t.getMonth()+1,0);if(i!==2){var n=Math.abs(r.getTimezoneOffset()-this.firstDay(t).getTimezoneOffset());return n&&r.setHours(this.firstDay(t).getHours()+n/60),this.findLastDay(r)}else return this.findLastDay(this.firstDay(r))},e.prototype.checkDateValue=function(t){return!m(t)&&t instanceof Date&&!isNaN(+t)?t:null},e.prototype.findLastDay=function(t){var i=this.currentView()==="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+vx):this.tableBodyElement.querySelectorAll("td:not(."+Us);if(i.length){for(var r=i.length-1;r>=0;r--)if(!i[r].classList.contains(ar)){t=new Date(parseInt(i[r].id,0));break}}return t},e.prototype.removeTableHeadElement=function(){this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content table thead")[0])||ne(this.tableHeadElement):m(this.calendarElement.querySelectorAll(".e-content table thead")[0])||ne(this.tableHeadElement)},e.prototype.renderTemplate=function(t,i,r,n,a){var o=this.getViewNumber(this.currentView()),l;this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),te([this.contentElement,this.headerElement],[gx,Jk,mx]),Q([this.contentElement,this.headerElement],[r]);for(var h=41,u=35,c=6,d=i,p=0,f=0;f<t.length/i;++f){for(l=this.createElement("tr"),p=0+p;p<d;p++)!t[p].classList.contains("e-week-number")&&!m(t[p].children[0])&&(Q([t[p].children[0]],[iL]),yr(t[p].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(t[p]),this.weekNumber&&p===c+1&&t[c+1].classList.contains(Us)&&Q([l],Zm),!this.weekNumber&&p===c&&t[c].classList.contains(Us)&&Q([l],Zm),this.weekNumber?p===h&&t[h].classList.contains(Us)&&Q([l],Zm):p===u&&t[u].classList.contains(Us)&&Q([l],Zm);d=d+i,p=p+0,this.tableBodyElement.appendChild(l)}this.table.querySelector("tbody").className=this.effect,this.calendarMode==="Gregorian"?this.iconHandler():this.islamicModule.islamicIconHandler(),(o!==this.getViewNumber(this.currentView())||o===0&&o!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()},e.prototype.clickHandler=function(t,i){this.clickEventEmitter(t);var r=t.currentTarget,n=this.getViewNumber(this.currentView());r.classList.contains(Us)?this.contentClick(t,0,null,i):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(t,1,null,i):n===2?this.contentClick(t,1,null,i):!r.classList.contains(Us)&&n===0?this.selectDate(t,this.getIdValue(t,null),null):this.contentClick(t,0,r,i),this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.clickEventEmitter=function(t){t.preventDefault()},e.prototype.contentClick=function(t,i,r,n){var a=this.getViewNumber(this.currentView()),o=this.getIdValue(t,r);switch(i){case 0:a===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(ne(this.tableBodyElement),this.currentDate=o,this.effect=Jm,this.renderMonths(t)):(this.calendarMode==="Gregorian"?(this.currentDate.setMonth(o.getMonth()),o.getMonth()>0&&this.currentDate.getMonth()!==o.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(o.getFullYear())):this.currentDate=o,this.effect=Jm,ne(this.tableBodyElement),this.renderMonths(t));break;case 1:if(a===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(t,o,null);else{if(this.calendarMode==="Gregorian")this.currentDate.setFullYear(o.getFullYear());else{this.islamicPreviousHeader=this.headerElement.textContent;var l=this.islamicModule.getIslamicDate(o);this.currentDate=this.islamicModule.toGregorian(l.year,l.month,1)}this.effect=Jm,ne(this.tableBodyElement),this.renderYears(t)}}},e.prototype.switchView=function(t,i,r,n){switch(t){case 0:ne(this.tableBodyElement),this.renderMonths(i,null,n);break;case 1:ne(this.tableBodyElement),this.renderYears(i);break;case 2:ne(this.tableBodyElement),this.renderDecades(i)}},e.prototype.getModuleName=function(){return"calendar"},e.prototype.requiredModules=function(){var t=[];return this&&t.push({args:[this],member:"islamic"}),t},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i,r,n){this.effect="";for(var a=0,o=Object.keys(t);a<o.length;a++){var l=o[a];switch(l){case"enableRtl":t.enableRtl?this.getModuleName()==="calendar"?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):this.getModuleName()==="calendar"?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.getModuleName()!=="datepicker"?this.createContentHeader():this.calendarElement&&this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),l==="min"?this.setProperties({min:this.checkDateValue(new Date(this.checkValue(t.min)))},!0):this.setProperties({max:this.checkDateValue(new Date(this.checkValue(t.max)))},!0),this.setProperties({start:this.currentView()},!0),this.tableBodyElement&&ne(this.tableBodyElement),this.minMaxUpdate(),r&&this.validateValues(r,n),this.getModuleName()!=="datepicker"?this.createContentBody():this.calendarElement&&this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(ne(this.todayElement),ne(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(te([this.todayElement],ar),ne(this.todayElement),ne(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody());break;case"locale":if(this.globalize=new _t(this.locale),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody()),this.getModuleName()==="calendar"){var h={today:"Today"};this.l10=new In(this.getModuleName(),h,this.locale)}this.l10.setLocale(this.locale),this.showTodayButton&&this.updateFooter();break;case"showTodayButton":t.showTodayButton?this.createContentFooter():!m(this.todayElement)&&!m(this.footer)&&(ne(this.todayElement),ne(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:t.showTodayButton},!0);break}}},e.prototype.validateValues=function(t,i){if(t&&!m(i)&&i.length>0){for(var r=this.copyValues(i),n=0;n<r.length;n++){var a=r[n],o=this.calendarMode==="Gregorian"?"gregorian":"islamic",l=void 0;this.calendarMode==="Gregorian"?l=this.globalize.formatDate(a,{type:"date",skeleton:"yMd"}):l=this.globalize.formatDate(a,{type:"dateTime",skeleton:"full",calendar:"islamic"});var h={type:"date",skeleton:"yMd",calendar:o},u=this.globalize.formatDate(this.min,h),c=u,d={type:"date",skeleton:"yMd",calendar:o},p=this.globalize.formatDate(this.max,d),f=p;(+new Date(l)<+new Date(c)||+new Date(l)>+new Date(f))&&(r.splice(n,1),n=-1)}this.setProperties({values:r},!0)}},e.prototype.setValueUpdate=function(){m(this.tableBodyElement)||(ne(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())},e.prototype.copyValues=function(t){var i=[];if(!m(t)&&t.length>0)for(var r=0;r<t.length;r++)i.push(new Date(+t[r]));return i},e.prototype.titleUpdate=function(t,i){var r=new _t(this.locale),n,a,o=this.calendarMode==="Gregorian"?"gregorian":"islamic";switch(this.calendarMode==="Gregorian"?(n=r.formatDate(t,{type:"dateTime",skeleton:"yMMMM",calendar:o}),a=r.formatDate(t,{format:null,type:"dateTime",skeleton:"y",calendar:o})):(n=r.formatDate(t,{type:"dateTime",format:"MMMM y",calendar:o}),a=r.formatDate(t,{type:"dateTime",format:"y",calendar:o})),i){case"days":this.headerTitleElement.textContent=this.toCapitalize(n);break;case"months":this.headerTitleElement.textContent=a}},e.prototype.setActiveDescendant=function(){var t,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n=this.calendarMode==="Gregorian"?"gregorian":"islamic",a,o=this.currentView();return o==="Month"?a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"full",calendar:n}):o==="Year"?n!=="islamic"?a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"yMMMM",calendar:n}):a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"GyMMM",calendar:n}):a=this.globalize.formatDate(this.currentDate,{format:null,type:"date",skeleton:"y",calendar:n}),(r||i)&&(m(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",a),t=(i||r).getAttribute("id")),t},e.prototype.iconHandler=function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}},e.prototype.destroy=function(){this.getModuleName()==="calendar"&&this.element?te([this.element],[xp]):this.calendarElement&&this.element&&te([this.element],[xp]),this.getModuleName()==="calendar"&&this.element&&(m(this.headerTitleElement)||I.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&I.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),m(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element&&(this.element.innerHTML=""),this.todayElement=null,this.tableBodyElement=null,this.todayButtonEvent=null,this.renderDayCellArgs=null,this.headerElement=null,this.nextIcon=null,this.table=null,this.tableHeadElement=null,this.previousIcon=null,this.headerTitleElement=null,this.footer=null,this.contentElement=null,s.prototype.destroy.call(this)},e.prototype.title=function(t){var i=this.getViewNumber(this.currentView());this.effect=Jm,this.switchView(++i,t)},e.prototype.getViewNumber=function(t){return t==="Month"?0:t==="Year"?1:2},e.prototype.navigateTitle=function(t){t.preventDefault(),this.title(t),this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.previous=function(){this.effect="";var t=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(t);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(t);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(t);break}},e.prototype.navigatePrevious=function(t){!B.isDevice&&t.preventDefault(),this.calendarMode==="Gregorian"?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(t),this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.next=function(){this.effect="";var t=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(t);break;case"Year":this.addYears(this.currentDate,1),this.switchView(t);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(t);break}},e.prototype.navigateNext=function(t){!B.isDevice&&t.preventDefault(),this.calendarMode==="Gregorian"?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(t),this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.navigateTo=function(t,i,r){+i>=+this.min&&+i<=+this.max&&(this.currentDate=i),+i<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+i>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(t)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(t))&&(t=this.depth),this.switchView(this.getViewNumber(t),null,null,r)},e.prototype.currentView=function(){return!m(this.contentElement)&&this.contentElement.classList.contains(mx)?"Year":!m(this.contentElement)&&this.contentElement.classList.contains(Jk)?"Decade":"Month"},e.prototype.getDateVal=function(t,i){return!m(i)&&t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()},e.prototype.getCultureObjects=function(t,i){var r=".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),n=".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase(),a="main.";return this.calendarMode==="Gregorian"?ie(a+""+this.locale+r,t):ie("main."+this.locale+n,t)},e.prototype.getWeek=function(t){var i=new Date(this.checkValue(t)).valueOf(),r=new Date(t.getFullYear(),0,1).valueOf();return Math.ceil((i-r+bx)/bx/7)},e.prototype.setStartDate=function(t,i){var r=t.getTimezoneOffset(),n=new Date(t.getTime()+i),a=n.getTimezoneOffset()-r;t.setTime(n.getTime()+a*B8)},e.prototype.addMonths=function(t,i){if(this.calendarMode==="Gregorian"){var r=t.getDate();t.setDate(1),t.setMonth(t.getMonth()+i),t.setDate(Math.min(r,this.getMaxDays(t)))}else{var n=this.islamicModule.getIslamicDate(t);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+i,1)}},e.prototype.addYears=function(t,i){if(this.calendarMode==="Gregorian"){var r=t.getDate();t.setDate(1),t.setFullYear(t.getFullYear()+i),t.setDate(Math.min(r,this.getMaxDays(t)))}else{var n=this.islamicModule.getIslamicDate(t);this.currentDate=this.islamicModule.toGregorian(n.year+i,n.month,1)}},e.prototype.getIdValue=function(t,i){var r;t?r=t.currentTarget:r=i;var n=this.calendarMode==="Gregorian"?"gregorian":"islamic",a={type:"dateTime",skeleton:"full",calendar:n},o=this.globalize.formatDate(new Date(parseInt(""+r.getAttribute("id"),0)),a),l=this.globalize.parseDate(o,a),h=l.valueOf()-l.valueOf()%1e3;return new Date(h)},e.prototype.adjustLongHeaderSize=function(){te([this.element],nL),this.dayHeaderFormat==="Wide"&&Q([this.getModuleName()==="calendar"?this.element:this.calendarElement],nL)},e.prototype.selectDate=function(t,i,r,n,a){var o=r||t.currentTarget;if(this.isDateSelected=!1,this.currentView()==="Decade")this.setDateDecade(this.currentDate,i.getFullYear());else if(this.currentView()==="Year")this.setDateYear(this.currentDate,i);else{if(n&&!this.checkPresentDate(i,a)){var l=this.copyValues(a);!m(a)&&l.length>0?(l.push(new Date(this.checkValue(i))),this.setProperties({values:l},!0),this.setProperties({value:a[a.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(i))]},!0)}else this.setProperties({value:new Date(this.checkValue(i))},!0);this.currentDate=new Date(this.checkValue(i))}var h=U(o,"."+xp);if(m(h)&&(h=this.tableBodyElement),!n&&!m(h.querySelector("."+Xr))&&te([h.querySelector("."+Xr)],Xr),!n&&!m(h.querySelector("."+ss))&&te([h.querySelector("."+ss)],ss),n){for(var l=this.copyValues(a),u=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),c=0;c<u.length;c++){var d=h.querySelectorAll("td."+ss)[0],p=h.querySelectorAll("td."+Xr)[0];u[c]===d&&te([u[c]],ss),u[c]===p&&!this.checkPresentDate(new Date(parseInt(p.getAttribute("id").split("_")[0],10)),a)&&te([u[c]],Xr)}if(o.classList.contains(Xr)){te([o],Xr);for(var f=0;f<l.length;f++){var v=this.calendarMode==="Gregorian"?"gregorian":"islamic",g={format:null,type:"date",skeleton:"short",calendar:v},b=this.globalize.formatDate(i,g),y=this.globalize.formatDate(l[f],g);if(b===y){var c=l.indexOf(l[f]);l.splice(c,1),Q([o],ss)}}this.setProperties({values:l},!0)}else Q([o],Xr)}else Q([o],Xr);this.isDateSelected=!0},e.prototype.checkPresentDate=function(t,i){var r=!1;if(!m(i))for(var n=0;n<i.length;n++){var a=this.calendarMode==="Gregorian"?"gregorian":"islamic",o=this.globalize.formatDate(t,{format:null,type:"date",skeleton:"short",calendar:a}),l=this.globalize.formatDate(i[n],{format:null,type:"date",skeleton:"short",calendar:a});o===l&&(r=!0)}return r},e.prototype.setAriaActiveDescendant=function(){De(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})},e.prototype.previousIconHandler=function(t){t?m(this.previousIcon)||(I.remove(this.previousIcon,"click",this.navigatePreviousHandler),Q([this.previousIcon],""+ar),Q([this.previousIcon],""+cl),this.previousIcon.setAttribute("aria-disabled","true")):(I.add(this.previousIcon,"click",this.navigatePreviousHandler),te([this.previousIcon],""+ar),te([this.previousIcon],""+cl),this.previousIcon.setAttribute("aria-disabled","false"))},e.prototype.renderDayCellEvent=function(t){me(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",t)},e.prototype.navigatedEvent=function(t){me(this.navigatedArgs,{name:"navigated",event:t}),this.trigger("navigated",this.navigatedArgs)},e.prototype.triggerNavigate=function(t){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(t)},e.prototype.nextIconHandler=function(t){t?m(this.previousIcon)||(I.remove(this.nextIcon,"click",this.navigateNextHandler),Q([this.nextIcon],ar),Q([this.nextIcon],cl),this.nextIcon.setAttribute("aria-disabled","true")):(I.add(this.nextIcon,"click",this.navigateNextHandler),te([this.nextIcon],ar),te([this.nextIcon],cl),this.nextIcon.setAttribute("aria-disabled","false"))},e.prototype.compare=function(t,i,r){var n=i.getFullYear(),a,o;return a=n,o=0,r&&(n=n-n%r,a=n-n%r+r-1),t.getFullYear()>a?o=1:t.getFullYear()<n&&(o=-1),o},e.prototype.isMinMaxRange=function(t){return+t>=+this.min&&+t<=+this.max},e.prototype.isMonthYearRange=function(t){if(this.calendarMode==="Gregorian")return t.getMonth()>=this.min.getMonth()&&t.getFullYear()>=this.min.getFullYear()&&t.getMonth()<=this.max.getMonth()&&t.getFullYear()<=this.max.getFullYear();var i=this.islamicModule.getIslamicDate(t);return i.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&i.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&i.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&i.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year},e.prototype.compareYear=function(t,i){return this.compare(t,i,0)},e.prototype.compareDecade=function(t,i){return this.compare(t,i,10)},e.prototype.shiftArray=function(t,i){return t.slice(i).concat(t.slice(0,i))},e.prototype.addDay=function(t,i,r,n,a){var o=i,l=new Date(+t);if(!m(this.tableBodyElement)&&!m(r)){for(;this.findNextTD(new Date(+t),o,n,a);)o+=i;var h=new Date(l.setDate(l.getDate()+o));o=+h>+n||+h<+a?o===i?i-i:i:o}t.setDate(t.getDate()+o)},e.prototype.findNextTD=function(t,i,r,n){var a=new Date(t.setDate(t.getDate()+i)),o=[],l=!1;if((!m(a)&&a.getMonth())===(!m(this.currentDate)&&this.currentDate.getMonth())){var h=void 0;this.calendarMode==="Gregorian"?h=this.renderDays(a):h=this.islamicModule.islamicRenderDays(this.currentDate,a),o=h.filter(function(c){return c.classList.contains(ar)})}else o=this.tableBodyElement.querySelectorAll("td."+ar);if(+a<=+r&&+a>=+n&&o.length)for(var u=0;u<o.length&&(l=+a==+new Date(parseInt(o[u].id,0)),!l);u++);return l},e.prototype.getMaxDays=function(t){var i,r=new Date(this.checkValue(t));i=28;for(var n=r.getMonth();r.getMonth()===n;)++i,r.setDate(i);return i-1},e.prototype.setDateDecade=function(t,i){t.setFullYear(i),this.setProperties({value:new Date(this.checkValue(t))},!0)},e.prototype.setDateYear=function(t,i){t.setFullYear(i.getFullYear(),i.getMonth(),t.getDate()),i.getMonth()!==t.getMonth()&&(t.setDate(0),this.currentDate=new Date(this.checkValue(i))),this.setProperties({value:new Date(this.checkValue(t))},!0)},e.prototype.compareMonth=function(t,i){var r;return t.getFullYear()>i.getFullYear()?r=1:t.getFullYear()<i.getFullYear()?r=-1:r=t.getMonth()===i.getMonth()?0:t.getMonth()>i.getMonth()?1:-1,r},e.prototype.checkValue=function(t){return t instanceof Date?t.toUTCString():""+t},e.prototype.checkView=function(){this.start!=="Decade"&&this.start!=="Year"&&this.setProperties({start:"Month"},!0),this.depth!=="Decade"&&this.depth!=="Year"&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)},e.prototype.getDate=function(t,i){return i&&(t=new Date(t.toLocaleString("en-US",{timeZone:i}))),t},Wi([S(new Date(1900,0,1))],e.prototype,"min",void 0),Wi([S(!0)],e.prototype,"enabled",void 0),Wi([S(null)],e.prototype,"cssClass",void 0),Wi([S(new Date(2099,11,31))],e.prototype,"max",void 0),Wi([S(null)],e.prototype,"firstDayOfWeek",void 0),Wi([S("Gregorian")],e.prototype,"calendarMode",void 0),Wi([S("Month")],e.prototype,"start",void 0),Wi([S("Month")],e.prototype,"depth",void 0),Wi([S(!1)],e.prototype,"weekNumber",void 0),Wi([S("FirstDay")],e.prototype,"weekRule",void 0),Wi([S(!0)],e.prototype,"showTodayButton",void 0),Wi([S("Short")],e.prototype,"dayHeaderFormat",void 0),Wi([S(!1)],e.prototype,"enablePersistence",void 0),Wi([S(null)],e.prototype,"keyConfigs",void 0),Wi([S(null)],e.prototype,"serverTimezoneOffset",void 0),Wi([_()],e.prototype,"created",void 0),Wi([_()],e.prototype,"destroyed",void 0),Wi([_()],e.prototype,"navigated",void 0),Wi([_()],e.prototype,"renderDayCell",void 0),e=Wi([Ot],e),e}(Pi),V8=function(s){i2(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.render=function(){if(this.calendarMode==="Islamic"&&this.islamicModule===void 0&&jc("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&typeof this.values=="object"&&!m(this.values)&&this.values.length>0){for(var t=[],i=[],r=0;r<this.values.length;r++)t.indexOf(+this.values[r])===-1&&(t.push(+this.values[r]),i.push(this.values[r]));this.setProperties({values:i},!0);for(var n=0;n<this.values.length;n++)if(!this.checkDateValue(this.values[n]))if(typeof this.values[n]=="string"&&this.checkDateValue(new Date(this.checkValue(this.values[n])))){var a=new Date(this.checkValue(this.values[n]));this.values.splice(n,1),this.values.splice(n,0,a)}else this.values.splice(n,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),this.getModuleName()==="calendar"&&(this.setEnable(this.enabled),this.setClass(this.cssClass)),s.prototype.render.call(this),this.getModuleName()==="calendar"){var o=U(this.element,"form");o&&I.add(o,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()},e.prototype.setEnable=function(t){t?te([this.element],ar):Q([this.element],ar)},e.prototype.setClass=function(t,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(t)||(t=t.replace(/\s+/g," ").trim()),!m(i)&&i!==""&&te([this.element],i.split(" ")),m(t)||Q([this.element],t.split(" "))},e.prototype.isDayLightSaving=function(){var t=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(i,t)},e.prototype.setTimeZone=function(t){if(!m(this.serverTimezoneOffset)&&this.value){var i=t,r=new Date().getTimezoneOffset()/60,n=i+r;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3)}},e.prototype.formResetHandler=function(){this.setProperties({value:null},!0)},e.prototype.validateDate=function(){typeof this.value=="string"&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),s.prototype.validateDate.call(this,this.value),!m(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)},e.prototype.minMaxUpdate=function(){this.getModuleName()==="calendar"&&(!m(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!m(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),this.getModuleName()!=="calendar"&&!m(this.value)?!m(this.value)&&this.value<this.min&&this.min<=this.max?s.prototype.minMaxUpdate.call(this,this.min):!m(this.value)&&this.value>this.max&&this.min<=this.max&&s.prototype.minMaxUpdate.call(this,this.max):s.prototype.minMaxUpdate.call(this,this.value)},e.prototype.generateTodayVal=function(t){var i=new Date;return m(this.timezone)||(i=s.prototype.getDate.call(this,i,this.timezone)),t&&m(this.timezone)?(i.setHours(t.getHours()),i.setMinutes(t.getMinutes()),i.setSeconds(t.getSeconds()),i.setMilliseconds(t.getMilliseconds())):i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0),i},e.prototype.todayButtonClick=function(t){if(this.showTodayButton){var i=this.generateTodayVal(this.value);if(this.setProperties({value:i},!0),this.isTodayClicked=!0,this.todayButtonEvent=t,this.isMultiSelection){var r=this.copyValues(this.values);s.prototype.checkPresentDate.call(this,i,this.values)||(r.push(i),this.setProperties({values:r}))}s.prototype.todayButtonClick.call(this,t,new Date(+this.value))}},e.prototype.keyActionHandle=function(t){s.prototype.keyActionHandle.call(this,t,this.value,this.isMultiSelection)},e.prototype.preRender=function(){var t=this;this.changeHandler=function(i){t.triggerChange(i)},this.checkView(),s.prototype.preRender.call(this,this.value)},e.prototype.createContent=function(){this.previousDate=this.value,this.previousDateTime=this.value,s.prototype.createContent.call(this)},e.prototype.minMaxDate=function(t){return s.prototype.minMaxDate.call(this,t)},e.prototype.renderMonths=function(t,i,r){s.prototype.renderMonths.call(this,t,this.value,r)},e.prototype.renderDays=function(t,i,r,n,a,o){var l=s.prototype.renderDays.call(this,t,this.value,this.isMultiSelection,this.values,a,o);return this.isMultiSelection&&s.prototype.validateValues.call(this,this.isMultiSelection,this.values),l},e.prototype.renderYears=function(t){this.calendarMode==="Gregorian"?s.prototype.renderYears.call(this,t,this.value):this.islamicModule.islamicRenderYears(t,this.value)},e.prototype.renderDecades=function(t){this.calendarMode==="Gregorian"?s.prototype.renderDecades.call(this,t,this.value):this.islamicModule.islamicRenderDecade(t,this.value)},e.prototype.renderTemplate=function(t,i,r,n){this.calendarMode==="Gregorian"?s.prototype.renderTemplate.call(this,t,i,r,n,this.value):this.islamicModule.islamicRenderTemplate(t,i,r,n,this.value),this.changedArgs={value:this.value,values:this.values},n&&n.type==="click"&&n.currentTarget.classList.contains(Us)?this.changeHandler(n):this.changeHandler()},e.prototype.clickHandler=function(t){var i=t.currentTarget;if(this.isPopupClicked=!0,i.classList.contains(Us))if(this.isMultiSelection){var r=this.copyValues(this.values);r.toString().indexOf(this.getIdValue(t,null).toString())===-1?(r.push(this.getIdValue(t,null)),this.setProperties({values:r},!0),this.setProperties({value:this.values[this.values.length-1]},!0)):this.previousDates=!0}else this.setProperties({value:this.getIdValue(t,null)},!0);var n=this.currentView();s.prototype.clickHandler.call(this,t,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!m(this.tableBodyElement.querySelectorAll("."+ss)[0])&&n==="Year"&&this.tableBodyElement.querySelectorAll("."+ss)[0].classList.remove(ss)},e.prototype.switchView=function(t,i,r,n){s.prototype.switchView.call(this,t,i,this.isMultiSelection,n)},e.prototype.getModuleName=function(){return s.prototype.getModuleName.call(this),"calendar"},e.prototype.getPersistData=function(){s.prototype.getPersistData.call(this);var t=["value","values"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){this.effect="",this.rangeValidation(this.min,this.max);for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"value":this.isDateSelected&&(typeof t.value=="string"?this.setProperties({value:new Date(this.checkValue(t.value))},!0):t.value=new Date(this.checkValue(t.value)),isNaN(+this.value)&&this.setProperties({value:i.value},!0),this.update());break;case"values":if(this.isDateSelected){if(typeof t.values=="string"||typeof t.values=="number")this.setProperties({values:null},!0);else{for(var o=this.copyValues(this.values),l=0;l<o.length;l++){var h=o[l];this.checkDateValue(h)&&!s.prototype.checkPresentDate.call(this,h,o)&&o.push(h)}this.setProperties({values:o},!0),this.values.length>0&&this.setProperties({value:t.values[t.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:t.isMultiSelection},!0),this.update());break;case"enabled":this.setEnable(this.enabled);break;case"cssClass":this.getModuleName()==="calendar"&&this.setClass(t.cssClass,i.cssClass);break;default:s.prototype.onPropertyChanged.call(this,t,i,this.isMultiSelection,this.values)}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},e.prototype.destroy=function(){if(s.prototype.destroy.call(this),this.getModuleName()==="calendar"){this.changedArgs=null;var t=U(this.element,"form");t&&I.remove(t,"reset",this.formResetHandler.bind(this))}},e.prototype.navigateTo=function(t,i,r){this.minMaxUpdate(),s.prototype.navigateTo.call(this,t,i,r)},e.prototype.currentView=function(){return s.prototype.currentView.call(this)},e.prototype.addDate=function(t){if(typeof t!="string"&&typeof t!="number"){var i=this.copyValues(this.values);if(typeof t=="object"&&t.length>0)for(var r=t,n=0;n<r.length;n++)this.checkDateValue(r[n])&&!s.prototype.checkPresentDate.call(this,r[n],i)&&(!m(i)&&i.length>0?i.push(r[n]):i=[new Date(+r[n])]);else this.checkDateValue(t)&&!s.prototype.checkPresentDate.call(this,t,i)&&(!m(i)&&i.length>0?i.push(t):i=[new Date(+t)]);this.setProperties({values:i},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,i),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},e.prototype.removeDate=function(t){if(typeof t!="string"&&typeof t!="number"&&!m(this.values)&&this.values.length>0){var i=this.copyValues(this.values);if(typeof t=="object"&&t.length>0)for(var r=t,n=0;n<r.length;n++)for(var a=0;a<i.length;a++)+i[a]==+r[n]&&i.splice(a,1);else for(var a=0;a<i.length;a++)+i[a]==+t&&i.splice(a,1);this.setProperties({values:i},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},e.prototype.setTodayDate=function(t){var i=new Date(+t);this.setProperties({value:i},!0),s.prototype.todayButtonClick.call(this,null,i,!0)},e.prototype.update=function(){this.validateDate(),this.minMaxUpdate(),s.prototype.setValueUpdate.call(this)},e.prototype.selectDate=function(t,i,r){s.prototype.selectDate.call(this,t,i,r,this.isMultiSelection,this.values),this.isMultiSelection&&!m(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(t)},e.prototype.changeEvent=function(t){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))},e.prototype.triggerChange=function(t){!m(this.todayButtonEvent)&&this.isTodayClicked&&(t=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=t||null,this.changedArgs.isInteracted=!m(t),m(this.value)||this.setProperties({value:this.value},!0),!this.isMultiSelection&&+this.value!==Number.NaN&&(!m(this.value)&&!m(this.previousDate)||this.previousDate===null&&!isNaN(+this.value))?this.changeEvent(t):!m(this.values)&&this.previousValues!==this.values.length&&(this.changeEvent(t),this.previousValues=this.values.length)},Wi([S(null)],e.prototype,"value",void 0),Wi([S(null)],e.prototype,"values",void 0),Wi([S(!1)],e.prototype,"isMultiSelection",void 0),Wi([_()],e.prototype,"change",void 0),e=Wi([Ot],e),e}(H8),U8=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),wi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},_8="e-date-wrapper",eg="e-datepicker",W8="e-lib",q8="e-control",sL="e-popup-wrapper",Y8="e-input-group-icon",Q8="e-popup",G8="e-input-group",Cx="e-input-focus",$8="e-input",aL="e-error",tg="e-active",oL="e-date-overflow",X8="e-date-icon",K8="e-icons",Z8=300,J8=4,ig="e-selected",eQ="e-focused-date",Sx="e-non-edit",lL=["title","class","style"],r2=function(s){U8(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.isDateIconClicked=!1,r.isAltKeyPressed=!1,r.isInteracted=!0,r.invalidValueString=null,r.checkPreviousValue=null,r.maskedDateValue="",r.isAngular=!1,r.preventChange=!1,r.isIconClicked=!1,r.isDynamicValueChanged=!1,r.moduleName=r.getModuleName(),r.isFocused=!1,r.isBlur=!1,r.isKeyAction=!1,r.datepickerOptions=t,r}return e.prototype.render=function(){this.initialize(),this.bindEvents(),this.floatLabelType==="Auto"&&ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete(),this.setTimeZone(this.serverTimezoneOffset)},e.prototype.setTimeZone=function(t){if(!m(this.serverTimezoneOffset)&&this.value){var i=new Date().getTimezoneOffset()/60,r=t,n=r+i;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3),this.updateInput()}},e.prototype.isDayLightSaving=function(){var t=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(t,i)},e.prototype.setAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):De(this.inputElement,{readonly:""}),this.updateIconState()},e.prototype.updateIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?te([this.inputWrapper.container],[Sx]):Q([this.inputWrapper.container],[Sx]):this.inputWrapper&&te([this.inputWrapper.container],[Sx])},e.prototype.initialize=function(){this.checkInvalidValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)?(this.updateInput(!0),this.updateInputValue(this.maskedDateValue)):this.enableMask||this.updateInput(!0),this.previousElementValue=this.inputElement.value,this.previousDate=m(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value},e.prototype.createInput=function(){var t={"aria-atomic":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false","aria-label":this.getModuleName()};if(this.getModuleName()==="datepicker"){var i={placeholder:this.placeholder};this.globalize=new _t(this.locale),this.l10n=new In("datepicker",i,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}this.fullScreenMode&&B.isDevice&&(this.cssClass+=" e-popup-expand");var r=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim());var n=!this.enableMask;this.inputWrapper=ye.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,bindClearAction:n,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:r,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[Y8+" "+X8+" "+K8]},this.createElement),this.setWidth(this.width),this.inputElement.name!==""?this.inputElement.setAttribute("name",""+this.inputElement.getAttribute("name")):this.inputElement.setAttribute("name",""+this.element.id),De(this.inputElement,t),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),ye.addAttributes({"aria-label":"select",role:"button"},this.inputWrapper.buttons[0]),Q([this.inputWrapper.container],_8)},e.prototype.updateInput=function(t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r;if(this.value&&!this.isCalendar()&&this.disabledDates(t,i),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(s.prototype.validateDate.call(this),this.minMaxUpdates(),s.prototype.minMaxUpdate.call(this)),!m(this.value)){var n=this.value,a=void 0,o=m(this.formatString)?this.dateTimeFormat:this.formatString;if(this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?a=this.globalize.formatDate(this.value,{format:o,type:"dateTime",skeleton:"yMd"}):a=this.globalize.formatDate(this.value,{format:o,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},a=this.globalize.formatDate(this.value,r)),+n<=+this.max&&+n>=+this.min)this.updateInputValue(a);else{var l=+n>=+this.max||!+this.value||!+this.value||+n<=+this.min;!this.strictMode&&l&&this.updateInputValue(a)}}m(this.value)&&this.strictMode&&(this.enableMask?(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})):this.updateInputValue("")),!this.strictMode&&m(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()},e.prototype.minMaxUpdates=function(){!m(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!m(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})},e.prototype.checkStringValue=function(t){var i=null,r=null,n=null;if(this.getModuleName()==="datetimepicker"){var a=new _t(this.locale);this.calendarMode==="Gregorian"?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},n={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return i=this.checkDateValue(this.globalize.parseDate(t,r)),m(i)&&this.getModuleName()==="datetimepicker"&&(i=this.checkDateValue(this.globalize.parseDate(t,n))),i},e.prototype.checkInvalidValue=function(t){if(!(t instanceof Date)&&!m(t)){var i=null,r=t;if(typeof t=="number"&&(r=t.toString()),this.getModuleName()==="datetimepicker"){var n=new _t(this.locale);this.calendarMode==="Gregorian"?(this.dateTimeFormat,n.getDatePattern({skeleton:"yMd"})):(this.dateTimeFormat,n.getDatePattern({skeleton:"yMd"}))}else this.calendarMode==="Gregorian"?this.formatString:this.formatString;var a=!1;if(typeof r!="string")r=null,a=!0;else if(typeof r=="string"&&(r=r.trim()),i=this.checkStringValue(r),!i){var o=null,l=null;o=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,l=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!o.test(r)&&!l.test(r)||/^[a-zA-Z0-9- ]*$/.test(r)||isNaN(+new Date(this.checkValue(r)))?a=!0:i=new Date(r)}a?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0)):this.setProperties({value:i},!0)}},e.prototype.bindInputEvent=function(){(!m(this.formatString)||this.enableMask)&&(this.enableMask||this.formatString.indexOf("y")===-1?I.add(this.inputElement,"input",this.inputHandler,this):I.remove(this.inputElement,"input",this.inputHandler))},e.prototype.bindEvents=function(){I.add(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler,this),I.add(this.inputElement,"mouseup",this.mouseUpHandler,this),I.add(this.inputElement,"focus",this.inputFocusHandler,this),I.add(this.inputElement,"blur",this.inputBlurHandler,this),I.add(this.inputElement,"keyup",this.keyupHandler,this),this.enableMask&&I.add(this.inputElement,"keydown",this.keydownHandler,this),this.bindInputEvent(),I.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&I.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&I.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=me(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new wr(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.keydownHandler=function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&(t.code!=="Delete"&&t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t}));break}},e.prototype.unBindEvents=function(){m(this.inputWrapper)||I.remove(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler),I.remove(this.inputElement,"mouseup",this.mouseUpHandler),I.remove(this.inputElement,"focus",this.inputFocusHandler),I.remove(this.inputElement,"blur",this.inputBlurHandler),I.remove(this.inputElement,"change",this.inputChangeHandler),I.remove(this.inputElement,"keyup",this.keyupHandler),this.enableMask&&I.remove(this.inputElement,"keydown",this.keydownHandler),this.showClearButton&&this.inputWrapper.clearButton&&I.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&I.remove(this.formElement,"reset",this.resetFormHandler)},e.prototype.resetFormHandler=function(){if(this.enabled&&!this.inputElement.disabled){var t=this.inputElement.getAttribute("value");(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(t="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(t),this.errorClass())}},e.prototype.restoreValue=function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=m(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})},e.prototype.inputChangeHandler=function(t){this.enabled&&t.stopPropagation()},e.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&I.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){this.enabled&&(t.preventDefault(),this.clear(t))},e.prototype.mouseUpHandler=function(t){this.enableMask&&(t.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"}))},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.enableMask||this.updateInputValue("");var i={event:t};if(this.trigger("cleared",i),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(t),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}),U(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},e.prototype.preventEventBubbling=function(t){t.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")},e.prototype.updateInputValue=function(t){ye.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.dateIconHandler=function(t){this.enabled&&(this.isIconClicked=!0,B.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),t.preventDefault(),this.readonly||(this.isCalendar()?this.hide(t):(this.isDateIconClicked=!0,this.show(null,t),this.getModuleName()==="datetimepicker"&&this.inputElement.focus(),this.inputElement.focus(),Q([this.inputWrapper.container],[Cx]),Q(this.inputWrapper.buttons,tg))),this.isIconClicked=!1)},e.prototype.updateHtmlAttributeToWrapper=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(!m(this.htmlAttributes[""+r])&&lL.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&Q([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var a=this.inputWrapper.container.getAttribute(r);m(a)?a=this.htmlAttributes[""+r]:a.charAt(a.length-1)===";"?a=a+this.htmlAttributes[""+r]:a=a+";"+this.htmlAttributes[""+r],this.inputWrapper.container.setAttribute(r,a)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateHtmlAttributeToElement=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];lL.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateCssClass=function(t,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(t)||(t=t.replace(/\s+/g," ").trim()),ye.setCssClass(t,[this.inputWrapper.container],i),this.popupWrapper&&ye.setCssClass(t,[this.popupWrapper],i)},e.prototype.calendarKeyActionHandle=function(t){switch(t.action){case"escape":this.isCalendar()?this.hide(t):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value!=+this.currentDate&&!this.isCalendar()&&this.inputWrapper.container.children[this.index].focus():this.show(null,t),this.getModuleName()==="datetimepicker"&&this.inputElement.focus();break;case"tab":this.hide(t)}},e.prototype.inputFocusHandler=function(){if(this.isFocused=!0,!!this.enabled){this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length);var t={model:this};this.isDateIconClicked=!1,this.trigger("focus",t),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}},e.prototype.inputHandler=function(){this.isPopupClicked=!1,this.enableMask&&this.notify("inputHandler",{module:"MaskedDateTime"})},e.prototype.inputBlurHandler=function(t){if(this.enabled){if(this.strictModeUpdate(),this.inputElement.value===""&&m(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.isBlur=!0,this.updateInput(!1,!0),this.isBlur=!1,this.popupUpdate(),this.changeTrigger(t),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value===this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&this.updateInputValue(""),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(t),this.getModuleName()==="datepicker"){var i={model:this};this.trigger("blur",i)}this.isCalendar()&&(this.defaultKeyConfigs=me(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new wr(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.calendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}},e.prototype.documentHandler=function(t){!m(this.popupObj)&&!m(this.inputWrapper)&&(this.inputWrapper.container.contains(t.target)&&t.type!=="mousedown"||this.popupObj.element&&this.popupObj.element.contains(t.target))&&t.type!=="touchstart"&&t.preventDefault();var i=t.target;!U(i,".e-datepicker.e-popup-wrapper")&&!m(this.inputWrapper)&&U(i,"."+G8)!==this.inputWrapper.container&&!i.classList.contains("e-day")&&!i.classList.contains("e-dlg-overlay")?(this.hide(t),this.focusOut()):U(i,".e-datepicker.e-popup-wrapper")&&(i.classList.contains("e-day")&&!m(t.target.parentElement)&&t.target.parentElement.classList.contains("e-selected")&&U(i,".e-content")&&U(i,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(t):U(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(+this.value)==+s.prototype.generateTodayVal.call(this,this.value)&&this.hide(t))},e.prototype.inputKeyActionHandle=function(t){var i=this.currentView();switch(t.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(t),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(t),this.getModuleName()==="datepicker"&&this.show(null,t);break;case"escape":this.hide(t);break;case"enter":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(t),this.errorClass(),!this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(t),this.isCalendar()&&(t.preventDefault(),t.stopPropagation());break;case"tab":case"shiftTab":{var r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd;if(this.enableMask&&!this.popupObj&&!this.readonly){var a=this.inputElement.value.length;(r===0&&n===a||n!==a&&t.action==="tab"||r!==0&&t.action==="shiftTab")&&t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t}),r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd}this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(t),this.errorClass(),this.enableMask&&(this.inputElement.selectionStart=r,this.inputElement.selectionEnd=n),this.hide(t);break}default:this.defaultAction(t),t.action==="select"&&i===this.depth&&this.hide(t)}},e.prototype.defaultAction=function(t){this.previousDate=!m(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(s.prototype.keyActionHandle.call(this,t),this.isCalendar()&&De(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))},e.prototype.popupUpdate=function(){if((m(this.value)&&!m(this.previousDate)||+this.value!=+this.previousDate)&&(this.popupObj&&this.popupObj.element.querySelectorAll("."+ig).length>0&&te(this.popupObj.element.querySelectorAll("."+ig),[ig]),!m(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){var t=new Date(this.checkValue(this.value));s.prototype.navigateTo.call(this,"Month",t)}},e.prototype.strictModeUpdate=function(){var t,i=/^y/,r=/[^a-zA-Z]/,n;if(this.getModuleName()==="datetimepicker"?t=m(this.formatString)?this.dateTimeFormat:this.formatString:(!i.test(this.formatString)||r.test(this.formatString))&&(t=m(this.formatString)?this.formatString:this.formatString.replace("dd","d")),m(t))t=this.formatString;else{var a=t.split("M").length-1;a<3&&(t=t.replace("MM","M"))}var o;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?o={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:o={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(this.calendarMode==="Gregorian"?n={format:t,type:"dateTime",skeleton:"yMd"}:n={format:t,type:"dateTime",skeleton:"yMd",calendar:"islamic"},o=n);var l;typeof this.inputElement.value=="string"&&(this.inputElement.value=this.inputElement.value.trim()),this.getModuleName()==="datetimepicker"?this.checkDateValue(this.globalize.parseDate(this.inputElement.value,o))?l=this.globalize.parseDate(this.inputElement.value.toLocaleUpperCase(),o):(this.calendarMode==="Gregorian"?n={format:t,type:"dateTime",skeleton:"yMd"}:n={format:t,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.inputElement.value,n)):(l=this.globalize.parseDate(this.inputElement.value,o),l=!m(l)&&isNaN(+l)?null:l,!m(this.formatString)&&this.inputElement.value!==""&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&this.formatString.indexOf("y")===-1&&l.setFullYear(this.value.getFullYear())),this.getModuleName()==="datepicker"&&this.value&&!isNaN(+this.value)&&l&&l.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&l?(this.updateInputValue(this.globalize.formatDate(l,o)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0),this.strictMode&&!l&&this.inputElement.value===(this.enableMask?this.maskedDateValue:"")&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),m(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)))},e.prototype.createCalendar=function(){var t=this;this.popupWrapper=this.createElement("div",{className:""+eg+" "+sL,id:this.inputElement.id+"_options"}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),m(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),B.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=""+eg+" e-date-modal",document.body.className+=" "+oL,this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new za(this.popupWrapper,{content:this.calendarElement,relateTo:B.isDevice?document.body:this.inputWrapper.container,position:B.isDevice?{X:"center",Y:"center"}:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},offsetY:J8,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:B.isDevice?{X:"fit",Y:"fit"}:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},open:function(){B.isDevice&&t.fullScreenMode&&(t.iconRight=parseInt(window.getComputedStyle(t.calendarElement.querySelector(".e-header.e-month .e-prev")).marginRight,10)>16,t.touchModule=new Pn(t.calendarElement.querySelector(".e-content.e-month"),{swipe:t.CalendarSwipeHandler.bind(t)}),I.add(t.calendarElement.querySelector(".e-content.e-month"),"touchstart",t.TouchStartHandler,t)),t.getModuleName()!=="datetimepicker"&&document.activeElement!==t.inputElement&&(t.defaultKeyConfigs=me(t.defaultKeyConfigs,t.keyConfigs),t.calendarElement.children[1].firstElementChild.focus(),t.calendarKeyboardModules=new wr(t.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:t.calendarKeyActionHandle.bind(t),keyConfigs:t.defaultKeyConfigs}),t.calendarKeyboardModules=new wr(t.inputWrapper.container.children[t.index],{eventName:"keydown",keyAction:t.calendarKeyActionHandle.bind(t),keyConfigs:t.defaultKeyConfigs}))},close:function(){t.isDateIconClicked&&t.inputWrapper.container.children[t.index].focus(),t.value&&t.disabledDates(),t.popupObj&&t.popupObj.destroy(),t.resetCalendar(),ne(t.popupWrapper),t.popupObj=t.popupWrapper=null,t.preventArgs=null,t.calendarKeyboardModules=null,t.setAriaAttributes()},targetExitViewport:function(){B.isDevice||t.hide()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()},e.prototype.CalendarSwipeHandler=function(t){var i=0;if(this.iconRight)switch(t.swipeDirection){case"Left":i=1;break;case"Right":i=-1;break}else switch(t.swipeDirection){case"Up":i=1;break;case"Down":i=-1;break}this.touchStart&&(i===1?this.navigateNext(t):i===-1&&this.navigatePrevious(t),this.touchStart=!1)},e.prototype.TouchStartHandler=function(t){this.touchStart=!0},e.prototype.setAriaDisabled=function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)},e.prototype.modelHeader=function(){var t,i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),a=this.createElement("span",{className:"e-model-day"}),o=this.createElement("span",{className:"e-model-month"});if(this.calendarMode==="Gregorian"?t={format:"y",skeleton:"dateTime"}:t={format:"y",skeleton:"dateTime",calendar:"islamic"},r.textContent=""+this.globalize.formatDate(this.value||new Date,t),this.calendarMode==="Gregorian"?t={format:"E",skeleton:"dateTime"}:t={format:"E",skeleton:"dateTime",calendar:"islamic"},a.textContent=""+this.globalize.formatDate(this.value||new Date,t)+", ",this.calendarMode==="Gregorian"?t={format:"MMM d",skeleton:"dateTime"}:t={format:"MMM d",skeleton:"dateTime",calendar:"islamic"},o.textContent=""+this.globalize.formatDate(this.value||new Date,t),this.fullScreenMode){var l=this.createElement("span",{className:"e-popup-close"});I.add(l,"mousedown touchstart",this.modelCloseHandler,this);var h=this.calendarElement.querySelector("button.e-today");n.classList.add("e-day-wrapper"),h.classList.add("e-outline"),i.appendChild(l),i.appendChild(h)}this.fullScreenMode||i.appendChild(r),n.appendChild(a),n.appendChild(o),i.appendChild(n),this.calendarElement.insertBefore(i,this.calendarElement.firstElementChild)},e.prototype.modelCloseHandler=function(t){this.hide()},e.prototype.changeTrigger=function(t){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.isDynamicValueChanged&&this.isCalendar()&&this.popupUpdate(),this.changedArgs.value=this.value,this.changedArgs.event=t||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!m(t),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0),this.isKeyAction=!1},e.prototype.navigatedEvent=function(){this.trigger("navigated",this.navigatedArgs)},e.prototype.keyupHandler=function(t){this.isKeyAction=this.inputElement.value!==this.previousElementValue},e.prototype.changeEvent=function(t){!this.isIconClicked&&!(this.isBlur||this.isKeyAction)&&this.selectCalendar(t),(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())?(this.changedArgs.event=t||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.isDynamicValueChanged||this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.isDynamicValueChanged||this.hide(t),this.previousElementValue=this.inputElement.value,this.errorClass()):t&&this.hide(t),this.isKeyAction=!1},e.prototype.requiredModules=function(){var t=[];return this&&t.push({args:[this],member:"islamic"}),this.enableMask&&t.push({args:[this],member:"MaskedDateTime"}),t},e.prototype.selectCalendar=function(t){var i,r,n;this.getModuleName()==="datetimepicker"?r=m(this.formatString)?this.dateTimeFormat:this.formatString:r=this.formatString,this.value&&(this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n={format:r,type:"dateTime",skeleton:"yMd"}:n={format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)):(this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})),m(i)||(this.updateInputValue(i),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}))},e.prototype.isCalendar=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+sL))},e.prototype.setWidth=function(t){typeof t=="number"?this.inputWrapper.container.style.width=qe(this.width):typeof t=="string"?this.inputWrapper.container.style.width=t.match(/px|%|em/)?this.width:qe(this.width):this.inputWrapper.container.style.width="100%"},e.prototype.show=function(t,i){var r=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var n=!0,a=void 0;!m(this.value)&&!(+this.value>=+new Date(this.checkValue(this.min))&&+this.value<=+new Date(this.checkValue(this.max)))?(a=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)):a=this.value||null,this.isCalendar()||(s.prototype.render.call(this),this.setProperties({value:a||null},!0),this.previousDate=a,this.createCalendar()),B.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){n=!1},popup:this.popupObj,event:i||null,cancel:!1,appendTo:B.isDevice?this.mobilePopupWrapper:document.body};var o=this.preventArgs;if(this.trigger("open",o,function(h){if(r.preventArgs=h,n&&!r.preventArgs.cancel){Q(r.inputWrapper.buttons,tg),r.preventArgs.appendTo.appendChild(r.popupWrapper),r.popupObj.refreshPosition(r.inputElement);var u={name:"FadeIn",duration:B.isDevice?0:Z8};r.zIndex===1e3?r.popupObj.show(new ri(u),r.element):r.popupObj.show(new ri(u),null),s.prototype.setOverlayIndex.call(r,r.mobilePopupWrapper,r.popupObj.element,r.modal,B.isDevice),r.setAriaAttributes()}else r.popupObj.destroy(),r.popupWrapper=r.popupObj=null;!m(r.inputElement)&&r.inputElement.value===""&&!m(r.tableBodyElement)&&r.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(Q([r.tableBodyElement.querySelector("td.e-selected")],eQ),te(r.tableBodyElement.querySelectorAll("td.e-selected"),ig)),I.add(document,"mousedown touchstart",r.documentHandler,r)}),B.isDevice){var l=this.createElement("div",{className:"e-dlg-overlay"});l.style.zIndex=(this.zIndex-1).toString(),this.mobilePopupWrapper.appendChild(l)}}},e.prototype.hide=function(t){var i=this;if(m(this.popupWrapper))B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var r=!0;this.preventArgs={preventDefault:function(){r=!1},popup:this.popupObj,event:t||null,cancel:!1},te(this.inputWrapper.buttons,tg),te([document.body],oL);var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,function(a){i.closeEventCallback(r,a)}):this.closeEventCallback(r,n)}},e.prototype.closeEventCallback=function(t,i){this.preventArgs=i,this.isCalendar()&&t&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),te(this.inputWrapper.buttons,tg)),this.setAriaAttributes(),B.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),B.isDevice&&!m(this.mobilePopupWrapper)&&t&&(m(this.preventArgs)||!this.preventArgs.cancel)&&(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null),I.remove(document,"mousedown touchstart",this.documentHandler),B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.focusIn=function(t){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),Q([this.inputWrapper.container],[Cx]))},e.prototype.focusOut=function(){document.activeElement===this.inputElement&&(te([this.inputWrapper.container],[Cx]),this.inputElement.blur())},e.prototype.currentView=function(){var t;return this.calendarElement&&(t=s.prototype.currentView.call(this)),t},e.prototype.navigateTo=function(t,i){this.calendarElement&&s.prototype.navigateTo.call(this,t,i)},e.prototype.destroy=function(){this.unBindEvents(),s.prototype.destroy.call(this),m(this.keyboardModules)||this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains(Q8)&&s.prototype.destroy.call(this);var t={"aria-atomic":"true","aria-disabled":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-label":this.getModuleName()};this.inputElement&&(ye.removeAttributes(t,this.inputElement),m(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),I.remove(this.inputElement,"blur",this.inputBlurHandler),I.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&ne(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),this.ngTag===null&&(this.inputElement&&(m(this.inputWrapper)||this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),te([this.inputElement],[$8])),te([this.element],[eg]),m(this.inputWrapper)||ne(this.inputWrapper.container)),this.formElement&&I.remove(this.formElement,"reset",this.resetFormHandler),this.inputWrapper=null,this.keyboardModules=null},e.prototype.ensureInputAttribute=function(){for(var t=[],i=0;i<this.inputElement.attributes.length;i++)t[i]=this.inputElement.attributes[i].name;for(var i=0;i<t.length;i++)m(this.inputElementCopy.getAttribute(t[i]))?(t[i].toLowerCase()==="value"&&(this.inputElement.value=""),this.inputElement.removeAttribute(t[i])):(t[i].toLowerCase()==="value"&&(this.inputElement.value=this.inputElementCopy.getAttribute(t[i])),this.inputElement.setAttribute(t[i],this.inputElementCopy.getAttribute(t[i])))},e.prototype.preRender=function(){this.inputElementCopy=this.element.cloneNode(!0),te([this.inputElementCopy],[eg,q8,W8]),this.inputElement=this.element,this.formElement=U(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?this.ngTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):this.getModuleName()==="datetimepicker"?(this.element.id=mi("ej2-datetimepicker"),this.ngTag!==null&&De(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=mi("ej2-datepicker"),this.ngTag!==null&&De(this.inputElement,{id:this.element.id+"_input"})),this.ngTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),s.prototype.preRender.call(this)},e.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs},e.prototype.validationAttribute=function(t,i){var r=t.getAttribute("name")?t.getAttribute("name"):t.getAttribute("id");i.setAttribute("name",r),t.removeAttribute("name");for(var n=["required","aria-required","form"],a=0;a<n.length;a++)if(!m(t.getAttribute(n[a]))){var o=t.getAttribute(n[a]);i.setAttribute(n[a],o),t.removeAttribute(n[a])}},e.prototype.checkFormat=function(){var t=new _t(this.locale);if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(this.format.skeleton!==""&&!m(this.format.skeleton)){var i=this.format.skeleton;this.getModuleName()==="datetimepicker"?this.formatString=t.getDatePattern({skeleton:i,type:"dateTime"}):this.formatString=t.getDatePattern({skeleton:i,type:"date"})}else this.getModuleName()==="datetimepicker"?this.formatString=this.dateTimeFormat:this.formatString=null;else this.formatString=null},e.prototype.checkHtmlAttributes=function(t){this.globalize=new _t(this.locale),this.checkFormat(),this.checkView();var i=t?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"],r;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?r={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(var n=0,a=i;n<a.length;n++){var o=a[n];if(!m(this.inputElement.getAttribute(o)))switch(o){case"disabled":if(m(this.datepickerOptions)||this.datepickerOptions.enabled===void 0||t){var l=!(this.inputElement.getAttribute(o)==="disabled"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true");this.setProperties({enabled:l},!t)}break;case"readonly":if(m(this.datepickerOptions)||this.datepickerOptions.readonly===void 0||t){var h=this.inputElement.getAttribute(o)==="readonly"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true";this.setProperties({readonly:h},!t)}break;case"placeholder":(m(this.datepickerOptions)||this.datepickerOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.inputElement.getAttribute(o)},!t);break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(o));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(o));break;case"value":if(m(this.datepickerOptions)||this.datepickerOptions.value===void 0||t){var u=this.inputElement.getAttribute(o);this.setProperties(kt(o,this.globalize.parseDate(u,r),{}),!t)}break;case"min":if(+this.min==+new Date(1900,0,1)||t){var c=this.inputElement.getAttribute(o);this.setProperties(kt(o,this.globalize.parseDate(c),{}),!t)}break;case"max":if(+this.max==+new Date(2099,11,31)||t){var d=this.inputElement.getAttribute(o);this.setProperties(kt(o,this.globalize.parseDate(d),{}),!t)}break;case"type":this.inputElement.getAttribute(o)!=="text"&&this.inputElement.setAttribute("type","text");break}}},e.prototype.getModuleName=function(){return"datepicker"},e.prototype.disabledDates=function(t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r,n,a=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value)),o=this.previousDate;this.minMaxUpdates(),(!t||t&&!m(this.renderDayCell))&&s.prototype.render.call(this),this.previousDate=o;var l=a&&+a,h='*[id^="/id"]'.replace("/id",""+l);this.strictMode||(typeof this.value=="string"||typeof this.value=="object"&&+this.value!=+a)&&this.setProperties({value:a},!0),!m(this.calendarElement)&&!m(this.calendarElement.querySelectorAll(h)[0])&&this.calendarElement.querySelectorAll(h)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date(new Date().setHours(0,0,0,0))));var u;this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n=this.globalize.formatDate(a,{format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}):n=this.globalize.formatDate(a,{format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),u=n):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},u=this.globalize.formatDate(a,r)),this.popupObj||(this.updateInputValue(u),this.enableMask&&(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime",isBlur:i})))},e.prototype.setAriaAttributes=function(){this.isCalendar()?(ye.addAttributes({"aria-expanded":"true"},this.inputElement),De(this.inputElement,{"aria-owns":this.inputElement.id+"_options"}),De(this.inputElement,{"aria-controls":this.inputElement.id}),this.value&&De(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(ye.addAttributes({"aria-expanded":"false"},this.inputElement),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),this.inputElement.removeAttribute("aria-activedescendant"))},e.prototype.errorClass=function(){var t='*[id^="/id"]'.replace("/id",""+ +this.value),i=this.calendarElement&&this.calendarElement.querySelectorAll(t)[0]&&this.calendarElement.querySelectorAll(t)[0].classList.contains("e-disabled");!m(this.value)&&!m(this.min)&&!m(this.max)&&!(new Date(this.value).setMilliseconds(0)>=new Date(this.min).setMilliseconds(0)&&new Date(this.value).setMilliseconds(0)<=new Date(this.max).setMilliseconds(0))||!this.strictMode&&this.inputElement.value!==""&&this.inputElement.value!==this.maskedDateValue&&m(this.value)||i?(Q([this.inputWrapper.container],aL),De(this.inputElement,{"aria-invalid":"true"})):m(this.inputWrapper)||(te([this.inputWrapper.container],aL),De(this.inputElement,{"aria-invalid":"false"}))},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"value":this.isDynamicValueChanged=!0,this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(t.value),t.value=this.value,this.previousElementValue=this.inputElement.value,m(this.value)&&(this.enableMask?this.updateInputValue(this.maskedDateValue):this.updateInputValue(""),this.currentDate=new Date(new Date().setHours(0,0,0,0))),this.updateInput(!0),+this.previousDate!=+this.value&&this.changeTrigger(null),this.isInteracted=!0,this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||this.updateInputValue(this.maskedDateValue));break;case"allowEdit":this.setAllowEdit();break;case"placeholder":ye.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":ye.setReadonly(this.readonly,this.inputElement);break;case"enabled":ye.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new _t(this.locale),this.l10n.setLocale(this.locale),this.datepickerOptions&&this.datepickerOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ye.setPlaceholder(this.placeholder,this.inputElement)),this.updateInput(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"enableRtl":ye.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&s.prototype.onPropertyChanged.call(this,t,i);break;case"zIndex":this.setProperties({zIndex:t.zIndex},!0);break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"showClearButton":ye.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(t.width),ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"floatLabelType":this.floatLabelType=t.floatLabelType,ye.removeFloating(this.inputWrapper),ye.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue),this.bindInputEvent()):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break;default:this.calendarElement&&this.isCalendar()&&s.prototype.onPropertyChanged.call(this,t,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},wi([S(null)],e.prototype,"width",void 0),wi([S(null)],e.prototype,"value",void 0),wi([S(null)],e.prototype,"cssClass",void 0),wi([S(!1)],e.prototype,"strictMode",void 0),wi([S(null)],e.prototype,"format",void 0),wi([S(!0)],e.prototype,"enabled",void 0),wi([S(!1)],e.prototype,"fullScreenMode",void 0),wi([S({})],e.prototype,"htmlAttributes",void 0),wi([S(null)],e.prototype,"values",void 0),wi([S(!1)],e.prototype,"isMultiSelection",void 0),wi([S(!0)],e.prototype,"showClearButton",void 0),wi([S(!0)],e.prototype,"allowEdit",void 0),wi([S(null)],e.prototype,"keyConfigs",void 0),wi([S(!1)],e.prototype,"enablePersistence",void 0),wi([S(1e3)],e.prototype,"zIndex",void 0),wi([S(!1)],e.prototype,"readonly",void 0),wi([S(null)],e.prototype,"placeholder",void 0),wi([S("Never")],e.prototype,"floatLabelType",void 0),wi([S(null)],e.prototype,"serverTimezoneOffset",void 0),wi([S(!1)],e.prototype,"openOnFocus",void 0),wi([S(!1)],e.prototype,"enableMask",void 0),wi([S({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],e.prototype,"maskPlaceholder",void 0),wi([_()],e.prototype,"open",void 0),wi([_()],e.prototype,"cleared",void 0),wi([_()],e.prototype,"close",void 0),wi([_()],e.prototype,"blur",void 0),wi([_()],e.prototype,"focus",void 0),wi([_()],e.prototype,"created",void 0),wi([_()],e.prototype,"destroyed",void 0),e=wi([Ot],e),e}(V8),n2=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Vt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},tQ="e-time-wrapper",iQ="e-popup",hL="e-error",uL="240px",cL=new Date().getDate(),dL=new Date().getMonth(),pL=new Date().getFullYear(),rg="e-timepicker",rQ="e-lib",nQ="e-control",sQ="e-content",wh="e-active",xx="e-hover",wx="e-navigation",fa="e-disabled",aQ="e-icon-anim",Mx="e-input-focus",To="e-list-item",fL=2,vL=50,mL="e-time-overflow",oQ=4,Ex="e-non-edit",gL=["title","class","style"],UM;(function(s){function e(t,i,r,n,a,o){this.calendarMode;var l,h=o*6e4,u=[],c=[];l=+i.setMilliseconds(0);for(var d=+r.setMilliseconds(0);d>=l;)c.push(l),u.push(n.formatDate(new Date(l),{format:a,type:"time"})),l+=h;var p=Et.createList(t,u,null,!0);return{collection:c,list:p}}s.createListItems=e})(UM||(UM={}));(function(s){n2(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Vt([S("day")],e.prototype,"day",void 0),Vt([S("month")],e.prototype,"month",void 0),Vt([S("year")],e.prototype,"year",void 0),Vt([S("day of the week")],e.prototype,"dayOfTheWeek",void 0),Vt([S("hour")],e.prototype,"hour",void 0),Vt([S("minute")],e.prototype,"minute",void 0),Vt([S("second")],e.prototype,"second",void 0),e})(ke);(function(s){n2(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.liCollections=[],r.timeCollections=[],r.disableItemCollection=[],r.invalidValueString=null,r.isAngular=!1,r.preventChange=!1,r.maskedDateValue="",r.moduleName=r.getModuleName(),r.timeOptions=t,r}return e.prototype.preRender=function(){this.keyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.cloneElement=this.element.cloneNode(!0),te([this.cloneElement],[rg,nQ,rQ]),this.inputElement=this.element,this.angularTag=null,this.formElement=U(this.element,"form"),this.element.tagName==="EJS-TIMEPICKER"&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.openPopupEventArgs={appendTo:document.body}},e.prototype.render=function(){this.initialize(),this.createInputElement(),this.updateHtmlAttributeToWrapper(),this.setTimeAllowEdit(),this.setEnable(),this.validateInterval(),this.bindEvents(),this.validateDisable(),this.setTimeZone(),this.setValue(this.getFormattedValue(this.value)),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.checkErrorState(this.maskedDateValue)),this.anchor=this.inputElement,this.inputElement.setAttribute("value",this.inputElement.value),this.inputEleValue=this.getDateObject(this.inputElement.value),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete()},e.prototype.setTimeZone=function(){if(!m(this.serverTimezoneOffset)&&this.value){var t=new Date().getTimezoneOffset()/60,i=this.serverTimezoneOffset,r=i+t;r=this.isDayLightSaving()?r--:r,this.value=new Date(this.value.getTime()+r*60*60*1e3)}},e.prototype.isDayLightSaving=function(){var t=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(t,i)},e.prototype.setTimeAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):De(this.inputElement,{readonly:""}),this.clearIconState()},e.prototype.clearIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?te([this.inputWrapper.container],[Ex]):Q([this.inputWrapper.container],[Ex]):this.inputWrapper&&te([this.inputWrapper.container],[Ex])},e.prototype.validateDisable=function(){this.setMinMax(this.initMin,this.initMax),m(this.value)||(this.popupCreation(),this.popupObj.destroy(),this.popupWrapper=this.popupObj=null),!isNaN(+this.value)&&this.value!==null&&(this.valueIsDisable(this.value)||(this.strictMode&&this.resetState(),this.initValue=null,this.initMax=this.getDateObject(this.initMax),this.initMin=this.getDateObject(this.initMin),this.timeCollections=this.liCollections=[],this.setMinMax(this.initMin,this.initMax)))},e.prototype.validationAttribute=function(t,i){var r=t.getAttribute("name")?t.getAttribute("name"):t.getAttribute("id");i.setAttribute("name",r),t.removeAttribute("name");for(var n=["required","aria-required","form"],a=0;a<n.length;a++)if(!m(t.getAttribute(n[a]))){var o=t.getAttribute(n[a]);i.setAttribute(n[a],o),t.removeAttribute(n[a])}},e.prototype.initialize=function(){this.globalize=new _t(this.locale),this.defaultCulture=new _t("en"),this.checkTimeFormat(),this.checkInvalidValue(this.value),this.setProperties({value:this.checkDateValue(new Date(this.checkInValue(this.value)))},!0),this.setProperties({min:this.checkDateValue(new Date(this.checkInValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkInValue(this.max)))},!0),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(this.scrollTo)))},!0),this.angularTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.checkAttributes(!1);var t={placeholder:this.placeholder};this.l10n=new In("timepicker",t,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.initValue=this.checkDateValue(this.value),this.initMin=this.checkDateValue(this.min),this.initMax=this.checkDateValue(this.max),this.isNavigate=this.isPreventBlur=this.isTextSelected=!1,this.activeIndex=this.valueWithMinutes=this.prevDate=null,m(this.element.getAttribute("id"))?(this.element.id=mi("ej2_timepicker"),this.angularTag!==null&&De(this.inputElement,{id:this.element.id+"_input"})):this.angularTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"),m(this.inputElement.getAttribute("name"))&&De(this.inputElement,{name:this.element.id}),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})},e.prototype.checkTimeFormat=function(){if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(!m(this.format.skeleton)&&this.format.skeleton!==""){var t=this.format.skeleton;this.formatString=this.globalize.getDatePattern({type:"time",skeleton:t})}else this.formatString=this.globalize.getDatePattern({type:"time",skeleton:"short"});else this.formatString=null},e.prototype.checkDateValue=function(t){return!m(t)&&t instanceof Date&&!isNaN(+t)?t:null},e.prototype.createInputElement=function(){this.fullScreenMode&&B.isDevice&&(this.cssClass+=" e-popup-expand");var t=this.cssClass,i=!this.enableMask;!m(this.cssClass)&&this.cssClass!==""&&(t=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=ye.createInput({element:this.inputElement,bindClearAction:i,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:t,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[" e-input-group-icon e-time-icon e-icons"]},this.createElement),this.inputWrapper.container.style.width=this.setWidth(this.width),De(this.inputElement,{"aria-autocomplete":"list",tabindex:"0","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"false","aria-invalid":"false"}),this.isNullOrEmpty(this.inputStyle)||ye.addAttributes({style:this.inputStyle},this.inputElement),Q([this.inputWrapper.container],tQ)},e.prototype.getCldrDateTimeFormat=function(){var t=new _t(this.locale),i,r=t.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?i=r+" "+this.cldrFormat("time"):i=this.formatString,i},e.prototype.checkInvalidValue=function(t){var i=!1;if(typeof t!="object"&&!m(t)){var r=t;typeof r=="string"&&(r=r.trim());var n=null,a=null;if(typeof t=="number"?r=t.toString():typeof t=="string"&&(/^[a-zA-Z0-9- ]*$/.test(t)||(n=this.setCurrentDate(this.getDateObject(t)),m(n)&&(n=this.checkDateValue(this.globalize.parseDate(r,{format:this.getCldrDateTimeFormat(),type:"datetime"})),m(n)&&(n=this.checkDateValue(this.globalize.parseDate(r,{format:this.formatString,type:"dateTime",skeleton:"yMd"})))))),a=this.globalize.parseDate(r,{format:this.getCldrDateTimeFormat(),type:"datetime"}),n=!m(a)&&a instanceof Date&&!isNaN(+a)?a:null,m(n)&&r.replace(/\s/g,"").length){var o=null,l=null;o=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,l=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!o.test(r)&&!l.test(r)||/^[a-zA-Z0-9- ]*$/.test(t)||isNaN(+new Date(""+r))?i=!0:n=new Date(""+r)}i?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0),this.initValue=null):(this.setProperties({value:n},!0),this.initValue=this.value)}},e.prototype.requiredModules=function(){var t=[];return this.enableMask&&t.push({args:[this],member:"MaskedDateTime"}),t},e.prototype.cldrFormat=function(t){var i;return this.locale==="en"||this.locale==="en-US"?i=ie("timeFormats.short",xl()):i=this.getCultureTimeObject(hr,""+this.locale),i},e.prototype.destroy=function(){this.hide(),this.unBindEvents();var t={"aria-autocomplete":"list",tabindex:"0","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"true","aria-invalid":"false"};this.inputElement&&(ye.removeAttributes(t,this.inputElement),this.angularTag===null&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),m(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.enableElement([this.inputElement]),this.inputElement.classList.remove("e-input"),m(this.cloneElement.getAttribute("disabled"))&&ye.setEnabled(!0,this.inputElement,this.floatLabelType)),this.inputWrapper.container&&ne(this.inputWrapper.container),this.inputWrapper=this.popupWrapper=this.cloneElement=void 0,this.liCollections=this.timeCollections=this.disableItemCollection=[],m(this.rippleFn)||this.rippleFn(),s.prototype.destroy.call(this),this.formElement&&I.remove(this.formElement,"reset",this.formResetHandler),this.rippleFn=null,this.openPopupEventArgs=null,this.selectedElement=null,this.listTag=null,this.liCollections=null},e.prototype.ensureInputAttribute=function(){for(var t=[],i=0;i<this.inputElement.attributes.length;i++)t[i]=this.inputElement.attributes[i].name;for(var i=0;i<t.length;i++)m(this.cloneElement.getAttribute(t[i]))?(this.inputElement.removeAttribute(t[i]),t[i].toLowerCase()==="value"&&(this.inputElement.value="")):(this.inputElement.setAttribute(t[i],this.cloneElement.getAttribute(t[i])),t[i].toLowerCase()==="value"&&(this.inputElement.value=this.cloneElement.getAttribute(t[i])))},e.prototype.popupCreation=function(){this.popupWrapper=this.createElement("div",{className:rg+" "+iQ,attrs:{id:this.element.id+"_popup",style:"visibility:hidden"}}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),m(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),!m(this.step)&&this.step>0&&(this.generateList(),Ut([this.listWrapper],this.popupWrapper)),this.addSelection(),this.renderPopup(),ne(this.popupWrapper)},e.prototype.getPopupHeight=function(){var t=parseInt(uL,10),i=this.popupWrapper.getBoundingClientRect().height;return i>t?t:i},e.prototype.generateList=function(){this.createListItems(),this.wireListEvents();var t={duration:300,selector:"."+To};this.rippleFn=yr(this.listWrapper,t),this.liCollections=this.listWrapper.querySelectorAll("."+To)},e.prototype.renderPopup=function(){var t=this;if(this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),this.popupObj=new za(this.popupWrapper,{width:this.setPopupWidth(this.width),zIndex:this.zIndex,targetType:"relative",position:B.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},collision:B.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},enableRtl:this.enableRtl,relateTo:B.isDevice?document.body:this.inputWrapper.container,offsetY:oQ,open:function(){t.popupWrapper.style.visibility="visible",Q([t.inputWrapper.buttons[0]],wh)},close:function(){te([t.inputWrapper.buttons[0]],wh),t.unWireListEvents(),t.inputElement.removeAttribute("aria-activedescendant"),pt(t.popupObj.element),t.popupObj.destroy(),t.popupWrapper.innerHTML="",t.listWrapper=t.popupWrapper=t.listTag=void 0},targetExitViewport:function(){B.isDevice||t.hide()}}),B.isDevice||(this.popupObj.collision={X:"none",Y:"flip"}),B.isDevice&&this.fullScreenMode?(this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%"):this.popupObj.element.style.maxHeight=uL,B.isDevice&&this.fullScreenMode){var i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("span",{className:"e-model-title"});r.textContent="Select time";var n=this.createElement("span",{className:"e-popup-close"});I.add(n,"mousedown touchstart",this.timePopupCloseHandler,this),i.appendChild(n),i.appendChild(r),this.popupWrapper.insertBefore(i,this.popupWrapper.firstElementChild)}},e.prototype.timePopupCloseHandler=function(t){this.hide()},e.prototype.getFormattedValue=function(t){return m(this.checkDateValue(t))?null:this.globalize.formatDate(t,{skeleton:"medium",type:"time"})},e.prototype.getDateObject=function(t){if(!this.isNullOrEmpty(t)){var i=this.createDateObj(t),r=!this.isNullOrEmpty(this.initValue);if(this.checkDateValue(i)){var n=r?this.initValue.getDate():cL,a=r?this.initValue.getMonth():dL,o=r?this.initValue.getFullYear():pL;return new Date(o,a,n,i.getHours(),i.getMinutes(),i.getSeconds())}}return null},e.prototype.updateHtmlAttributeToWrapper=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(gL.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&Q([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var a=this.inputWrapper.container.getAttribute(r);a=m(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.inputWrapper.container.setAttribute(r,a)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateHtmlAttributeToElement=function(){if(!m(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];gL.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateCssClass=function(t,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(t)||(t=t.replace(/\s+/g," ").trim()),ye.setCssClass(t,[this.inputWrapper.container],i),this.popupWrapper&&ye.setCssClass(t,[this.popupWrapper],i)},e.prototype.removeErrorClass=function(){te([this.inputWrapper.container],hL),De(this.inputElement,{"aria-invalid":"false"})},e.prototype.checkErrorState=function(t){var i=this.getDateObject(t);this.validateState(i)&&!this.invalidValueString||this.enableMask&&this.inputElement.value===this.maskedDateValue?this.removeErrorClass():(Q([this.inputWrapper.container],hL),De(this.inputElement,{"aria-invalid":"true"}))},e.prototype.validateInterval=function(){!m(this.step)&&this.step>0?this.enableElement([this.inputWrapper.buttons[0]]):this.disableTimeIcon()},e.prototype.disableTimeIcon=function(){this.disableElement([this.inputWrapper.buttons[0]]),this.hide()},e.prototype.disableElement=function(t){Q(t,fa)},e.prototype.enableElement=function(t){te(t,fa)},e.prototype.selectInputText=function(){this.inputElement.setSelectionRange(0,this.inputElement.value.length)},e.prototype.setCursorToEnd=function(){this.inputElement.setSelectionRange(this.inputElement.value.length,this.inputElement.value.length)},e.prototype.getMeridianText=function(){var t;if(this.locale==="en"||this.locale==="en-US")t=ie("dayPeriods.format.wide",xl());else{var i=".dates.calendars.gregorian.dayPeriods.format.abbreviated",r="main.";t=ie(r+""+this.locale+i,hr)}return t},e.prototype.getCursorSelection=function(){var t=this.inputElement,i=0,r=0;return isNaN(t.selectionStart)||(i=t.selectionStart,r=t.selectionEnd),{start:Math.abs(i),end:Math.abs(r)}},e.prototype.getActiveElement=function(){return m(this.popupWrapper)?null:this.popupWrapper.querySelectorAll("."+wh)},e.prototype.isNullOrEmpty=function(t){return!!(m(t)||typeof t=="string"&&t.trim()==="")},e.prototype.setWidth=function(t){return typeof t=="number"?t=qe(t):typeof t=="string"?t=t.match(/px|%|em/)?t:qe(t):t="100%",t},e.prototype.setPopupWidth=function(t){if(t=this.setWidth(t),t.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(t)/100;t=i.toString()+"px"}return t},e.prototype.setScrollPosition=function(){var t=this.selectedElement;m(t)?this.popupWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(t)},e.prototype.findScrollTop=function(t){var i=this.getPopupHeight(),r=t.nextElementSibling,n=r?r.offsetTop:t.offsetTop,a=t.getBoundingClientRect().height;n+t.offsetTop>i?this.popupWrapper.scrollTop=r?n-(i/fL+a/fL):n:this.popupWrapper.scrollTop=0},e.prototype.setScrollTo=function(){var t;if(m(this.popupWrapper))this.popupWrapper.scrollTop=0;else{var i=this.popupWrapper.querySelectorAll("."+To);if(i.length){var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();t=i[Math.round((n-r)/(this.step*6e4))]}}m(t)?this.popupWrapper.scrollTop=0:this.findScrollTop(t)},e.prototype.getText=function(){return m(this.checkDateValue(this.value))?"":this.getValue(this.value)},e.prototype.getValue=function(t){return m(this.checkDateValue(t))?null:this.globalize.formatDate(t,{format:this.cldrTimeFormat(),type:"time"})},e.prototype.cldrDateFormat=function(){var t;return this.locale==="en"||this.locale==="en-US"?t=ie("dateFormats.short",xl()):t=this.getCultureDateObject(hr,""+this.locale),t},e.prototype.cldrTimeFormat=function(){var t;return this.isNullOrEmpty(this.formatString)?this.locale==="en"||this.locale==="en-US"?t=ie("timeFormats.short",xl()):t=this.getCultureTimeObject(hr,""+this.locale):t=this.formatString,t},e.prototype.dateToNumeric=function(){var t;return this.locale==="en"||this.locale==="en-US"?t=ie("timeFormats.medium",xl()):t=ie("main."+this.locale+".dates.calendars.gregorian.timeFormats.medium",hr),t},e.prototype.getExactDateTime=function(t){return m(this.checkDateValue(t))?null:this.globalize.formatDate(t,{format:this.dateToNumeric(),type:"time"})},e.prototype.setValue=function(t){var i=this.checkValue(t);!this.strictMode&&!this.validateState(i)?(this.checkDateValue(this.valueWithMinutes)===null&&(this.initValue=this.valueWithMinutes=null),this.validateMinMax(this.value,this.min,this.max)):this.isNullOrEmpty(i)?(this.initValue=null,this.validateMinMax(this.value,this.min,this.max)):this.initValue=this.compareFormatChange(i),this.updateInput(!0,this.initValue)},e.prototype.compareFormatChange=function(t){return m(t)?null:t!==this.getText()?this.getDateObject(t):this.getDateObject(this.value)},e.prototype.updatePlaceHolder=function(){ye.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)},e.prototype.updateInputValue=function(t){ye.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.preventEventBubbling=function(t){t.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnTimeIconClick")},e.prototype.popupHandler=function(t){this.enabled&&(B.isDevice&&this.inputElement.setAttribute("readonly",""),t.preventDefault(),this.isPopupOpen()?this.closePopup(0,t):(this.inputElement.focus(),this.show(t)))},e.prototype.mouseDownHandler=function(){this.enabled&&(this.readonly||(this.inputElement.setSelectionRange(0,0),I.add(this.inputElement,"mouseup",this.mouseUpHandler,this)))},e.prototype.mouseUpHandler=function(t){if(!this.readonly)if(t.preventDefault(),this.enableMask){t.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"});return}else{I.remove(this.inputElement,"mouseup",this.mouseUpHandler);var i=this.getCursorSelection();i.start===0&&i.end===this.inputElement.value.length||(this.inputElement.value.length>0&&(this.cursorDetails=this.focusSelection()),this.inputElement.setSelectionRange(this.cursorDetails.start,this.cursorDetails.end))}},e.prototype.focusSelection=function(){var t=new RegExp("^[a-zA-Z0-9]+$"),i=this.inputElement.value.split("");i.push(" ");var r=this.getCursorSelection(),n=0,a=0,o=!1;if(this.isTextSelected)n=r.start,a=r.end,this.isTextSelected=!1;else for(var l=0;l<i.length;l++)if(t.test(i[l])||(a=l,o=!0),o)if(r.start>=n&&r.end<=a){a=a,this.isTextSelected=!0;break}else n=l+1,o=!1;return{start:n,end:a}},e.prototype.inputHandler=function(t){if(!this.readonly&&this.enabled)switch(t.action=="right"||t.action=="left"||t.action=="tab"||(t.action=="home"||t.action=="end"||t.action=="up"||t.action=="down")&&!this.isPopupOpen()&&!this.enableMask||t.preventDefault(),t.action){case"home":case"end":case"up":case"down":this.isPopupOpen()||(this.popupCreation(),this.popupObj.destroy(),this.popupObj=this.popupWrapper=null),this.enableMask&&!this.readonly&&!this.isPopupOpen()&&(t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t})),this.isPopupOpen()&&this.keyHandler(t);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.updateValue(this.valueWithMinutes,t)):this.updateValue(this.inputElement.value,t),this.hide(),this.isNavigate=!1,this.isPopupOpen()&&t.stopPropagation();break;case"open":this.show(t);break;case"escape":this.updateInputValue(this.objToString(this.value)),this.enableMask&&(this.value||this.updateInputValue(this.maskedDateValue),this.createMask()),this.previousState(this.value),this.hide();break;case"close":this.hide();break;case"right":case"left":case"tab":case"shiftTab":!this.isPopupOpen()&&this.enableMask&&!this.readonly&&((this.inputElement.selectionStart===0&&this.inputElement.selectionEnd===this.inputElement.value.length||this.inputElement.selectionEnd!==this.inputElement.value.length&&t.action==="tab"||this.inputElement.selectionStart!==0&&t.action==="shiftTab"||t.action==="left"||t.action==="right")&&t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t}));break;default:this.isNavigate=!1;break}},e.prototype.onMouseClick=function(t){var i=t.target,r=this.selectedElement=U(i,"."+To);this.setSelection(r,t),r&&r.classList.contains(To)&&this.hide()},e.prototype.closePopup=function(t,i){var r=this;if(this.isPopupOpen()&&this.popupWrapper){var n={popup:this.popupObj,event:i||null,cancel:!1,name:"open"};te([document.body],mL),this.trigger("close",n,function(a){if(!a.cancel){var o={name:"FadeOut",duration:vL,delay:t||0};r.popupObj.hide(new ri(o)),te([r.inputWrapper.container],[aQ]),De(r.inputElement,{"aria-expanded":"false"}),r.inputElement.removeAttribute("aria-owns"),r.inputElement.removeAttribute("aria-controls"),r.inputElement.removeAttribute("aria-activedescendant"),I.remove(document,"mousedown touchstart",r.documentClickHandler)}B.isDevice&&r.modal&&(r.modal.style.display="none",r.modal.outerHTML="",r.modal=null),B.isDevice&&(m(r.mobileTimePopupWrap)||(r.mobileTimePopupWrap.remove(),r.mobileTimePopupWrap=null)),B.isDevice&&r.allowEdit&&!r.readonly&&r.inputElement.removeAttribute("readonly")})}else B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")},e.prototype.disposeServerPopup=function(){this.popupWrapper&&(this.popupWrapper.style.visibility="hidden",this.popupWrapper.style.top="-9999px",this.popupWrapper.style.left="-9999px",this.popupWrapper.style.width="0px",this.popupWrapper.style.height="0px")},e.prototype.checkValueChange=function(t,i){if(!this.strictMode&&!this.validateState(this.valueWithMinutes))this.checkDateValue(this.valueWithMinutes)===null&&(this.initValue=this.valueWithMinutes=null),this.setProperties({value:this.compareFormatChange(this.inputElement.value)},!0),this.initValue=this.valueWithMinutes=this.compareFormatChange(this.inputElement.value),this.prevValue=this.inputElement.value,+this.prevDate!=+this.value&&this.changeEvent(t);else if(!i)(this.prevValue!==this.inputElement.value||m(this.checkDateValue(this.value)))&&this.valueProcess(t,this.compareFormatChange(this.inputElement.value));else{var r=this.getDateObject(new Date(this.timeCollections[this.activeIndex]));+this.prevDate!=+r&&this.valueProcess(t,r)}},e.prototype.onMouseOver=function(t){var i=U(t.target,"."+To);this.setHover(i,xx)},e.prototype.setHover=function(t,i){this.enabled&&this.isValidLI(t)&&!t.classList.contains(i)&&(this.removeHover(i),Q([t],i),i===wx&&t.setAttribute("aria-selected","true"))},e.prototype.setSelection=function(t,i){this.isValidLI(t)&&(this.checkValue(t.getAttribute("data-value")),this.enableMask&&this.createMask(),this.selectedElement=t,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(t),this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Q([this.selectedElement],wh),this.selectedElement.setAttribute("aria-selected","true"),this.checkValueChange(i,!0))},e.prototype.onMouseLeave=function(){this.removeHover(xx)},e.prototype.scrollHandler=function(){this.getModuleName()==="timepicker"&&B.isDevice||this.hide()},e.prototype.setMinMax=function(t,i){m(this.checkDateValue(t))&&(this.initMin=this.getDateObject("12:00:00 AM")),m(this.checkDateValue(i))&&(this.initMax=this.getDateObject("11:59:59 PM"))},e.prototype.validateMinMax=function(t,i,r){var n=t instanceof Date?t:this.getDateObject(t);return m(this.checkDateValue(n))?+this.createDateObj(this.getFormattedValue(this.initMin))>+this.createDateObj(this.getFormattedValue(this.initMax))&&this.disableTimeIcon():t=this.strictOperation(this.initMin,this.initMax,t,n),this.strictMode&&(t=this.valueIsDisable(t)?t:null),this.checkErrorState(t),t},e.prototype.valueIsDisable=function(t){if(this.disableItemCollection.length>0){if(this.disableItemCollection.length===this.timeCollections.length)return!1;for(var i=t instanceof Date?this.objToString(t):t,r=0;r<this.disableItemCollection.length;r++)if(i===this.disableItemCollection[r])return!1}return!0},e.prototype.validateState=function(t){if(!this.strictMode)if(this.valueIsDisable(t)){var i=typeof t=="string"?this.setCurrentDate(this.getDateObject(t)):this.setCurrentDate(this.getDateObject(t)),r=this.setCurrentDate(this.getDateObject(this.initMax)),n=this.setCurrentDate(this.getDateObject(this.initMin));if(m(this.checkDateValue(i))){if(+r<+n||this.inputElement.value!=="")return!1}else if(+i>+r||+i<+n)return!1}else return!1;return!0},e.prototype.strictOperation=function(t,i,r,n){var a=this.createDateObj(this.getFormattedValue(i)),o=this.createDateObj(this.getFormattedValue(t)),l=this.createDateObj(this.getFormattedValue(n));if(this.strictMode){if(+o>+a)return this.disableTimeIcon(),this.initValue=this.getDateObject(a),this.updateInputValue(this.getValue(this.initValue)),this.enableMask&&this.createMask(),this.inputElement.value;if(+o>=+l)return this.getDateObject(o);if(+l>=+a||+o==+a)return this.getDateObject(a)}else if(+o>+a&&(this.disableTimeIcon(),!isNaN(+this.createDateObj(r))))return r;return r},e.prototype.bindEvents=function(){I.add(this.inputWrapper.buttons[0],"mousedown",this.popupHandler,this),I.add(this.inputElement,"blur",this.inputBlurHandler,this),I.add(this.inputElement,"focus",this.inputFocusHandler,this),I.add(this.inputElement,"change",this.inputChangeHandler,this),I.add(this.inputElement,"input",this.inputEventHandler,this),this.enableMask&&I.add(this.inputElement,"keydown",this.keydownHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&I.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this),this.formElement&&I.add(this.formElement,"reset",this.formResetHandler,this),B.isDevice||(this.keyConfigure=me(this.keyConfigure,this.keyConfigs),this.inputEvent=new wr(this.inputWrapper.container,{keyAction:this.inputHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.showClearButton&&this.inputElement&&I.add(this.inputElement,"mousedown",this.mouseDownHandler,this))},e.prototype.keydownHandler=function(t){switch(t.code){case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&this.notify("keyDownHandler",{module:"MaskedDateTime",e:t});break}},e.prototype.formResetHandler=function(){if(this.enabled&&!this.inputElement.disabled){var t=this.inputElement.getAttribute("value"),i=this.checkDateValue(this.inputEleValue);this.element.tagName==="EJS-TIMEPICKER"&&(i=null,t="",this.inputElement.setAttribute("value","")),this.setProperties({value:i},!0),this.prevDate=this.value,this.valueWithMinutes=this.value,this.initValue=this.value,this.inputElement&&(this.updateInputValue(t),this.enableMask&&(t||this.updateInputValue(this.maskedDateValue),this.createMask()),this.checkErrorState(t),this.prevValue=this.inputElement.value)}},e.prototype.inputChangeHandler=function(t){this.enabled&&t.stopPropagation()},e.prototype.inputEventHandler=function(){this.enableMask&&this.notify("inputHandler",{module:"MaskedDateTime"})},e.prototype.unBindEvents=function(){this.inputWrapper&&I.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.popupHandler),I.remove(this.inputElement,"blur",this.inputBlurHandler),I.remove(this.inputElement,"focus",this.inputFocusHandler),I.remove(this.inputElement,"change",this.inputChangeHandler),I.remove(this.inputElement,"input",this.inputEventHandler),this.inputEvent&&this.inputEvent.destroy(),I.remove(this.inputElement,"mousedown touchstart",this.mouseDownHandler),this.showClearButton&&!m(this.inputWrapper)&&!m(this.inputWrapper.clearButton)&&I.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.clearHandler),this.formElement&&I.remove(this.formElement,"reset",this.formResetHandler)},e.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&I.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this)},e.prototype.raiseClearedEvent=function(t){var i={event:t};this.trigger("cleared",i)},e.prototype.clearHandler=function(t){if(this.enabled&&(t.preventDefault(),m(this.value)?(this.resetState(),this.raiseClearedEvent(t)):this.clear(t),this.popupWrapper&&(this.popupWrapper.scrollTop=0),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}),U(this.element,"form"))){var i=this.element,r=document.createEvent("KeyboardEvent");r.initEvent("keyup",!1,!0),i.dispatchEvent(r)}},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.initValue=null,this.resetState(),this.raiseClearedEvent(t),this.changeEvent(t)},e.prototype.setZIndex=function(){this.popupObj&&(this.popupObj.zIndex=this.zIndex,this.popupObj.dataBind())},e.prototype.checkAttributes=function(t){for(var i=t?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["step","disabled","readonly","style","name","value","min","max","placeholder"],r,n=0,a=i;n<a.length;n++){var o=a[n];if(!m(this.inputElement.getAttribute(o)))switch(o){case"disabled":if(m(this.timeOptions)||this.timeOptions.enabled===void 0||t){var l=!(this.inputElement.getAttribute(o)==="disabled"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true");this.setProperties({enabled:l},!t)}break;case"style":this.inputStyle=this.inputElement.getAttribute(o);break;case"readonly":if(m(this.timeOptions)||this.timeOptions.readonly===void 0||t){var h=this.inputElement.getAttribute(o)==="readonly"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true";this.setProperties({readonly:h},!t)}break;case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(o));break;case"step":this.step=parseInt(this.inputElement.getAttribute(o),10);break;case"placeholder":(m(this.timeOptions)||this.timeOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.inputElement.getAttribute(o)},!t);break;case"min":(m(this.timeOptions)||this.timeOptions.min===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),m(this.checkDateValue(r))||this.setProperties({min:r},!t));break;case"max":(m(this.timeOptions)||this.timeOptions.max===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),m(this.checkDateValue(r))||this.setProperties({max:r},!t));break;case"value":(m(this.timeOptions)||this.timeOptions.value===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),m(this.checkDateValue(r))||(this.initValue=r,this.updateInput(!1,this.initValue),this.setProperties({value:r},!t)));break}}},e.prototype.setCurrentDate=function(t){return m(this.checkDateValue(t))?null:new Date(pL,dL,cL,t.getHours(),t.getMinutes(),t.getSeconds())},e.prototype.getTextFormat=function(){var t=0;if(this.cldrTimeFormat().split(" ")[0]==="a"||this.cldrTimeFormat().indexOf("a")===0)t=1;else if(this.cldrTimeFormat().indexOf("a")<0){for(var i=this.cldrTimeFormat().split(" "),r=0;r<i.length;r++)if(i[r].toLowerCase().indexOf("h")>=0){t=r;break}}return t},e.prototype.updateValue=function(t,i){var r;if(this.isNullOrEmpty(t))this.resetState();else if(r=this.checkValue(t),this.strictMode){var n=r===null&&t.trim().length>0?this.previousState(this.prevDate):this.inputElement.value;this.updateInputValue(n),this.enableMask&&(n||this.updateInputValue(this.maskedDateValue),m(r)&&t!==this.maskedDateValue&&this.createMask(),m(r)&&t===this.maskedDateValue&&this.updateInputValue(this.maskedDateValue))}this.checkValueChange(i,typeof t!="string")},e.prototype.previousState=function(t){for(var i=this.getDateObject(t),r=0;r<this.timeCollections.length;r++)if(+i===this.timeCollections[r]){this.activeIndex=r,this.selectedElement=this.liCollections[r],this.valueWithMinutes=new Date(this.timeCollections[r]);break}return this.prevValue},e.prototype.resetState=function(){this.removeSelection(),ye.setValue("",this.inputElement,this.floatLabelType,!1),this.valueWithMinutes=this.activeIndex=null,this.strictMode||this.checkErrorState(null)},e.prototype.objToString=function(t){return m(this.checkDateValue(t))?null:this.globalize.formatDate(t,{format:this.cldrTimeFormat(),type:"time"})},e.prototype.checkValue=function(t){if(!this.isNullOrEmpty(t)){var i=t instanceof Date?t:this.getDateObject(t);return this.validateValue(i,t)}return this.resetState(),this.valueWithMinutes=null},e.prototype.validateValue=function(t,i){var r,n=this.validateMinMax(i,this.min,this.max),a=this.getDateObject(n);if(this.getFormattedValue(a)!==this.getFormattedValue(this.value)?(this.valueWithMinutes=m(a)?null:a,r=this.objToString(this.valueWithMinutes)):(this.strictMode&&(t=a),this.valueWithMinutes=this.checkDateValue(t),r=this.objToString(this.valueWithMinutes)),!this.strictMode&&m(r)){var o=n.trim().length>0?n:"";this.updateInputValue(o),this.enableMask&&(o||this.updateInputValue(this.maskedDateValue))}else this.updateInputValue(r),this.enableMask&&(r===""&&this.updateInputValue(this.maskedDateValue),m(r)&&i!==this.maskedDateValue&&this.createMask(),m(r)&&i===this.maskedDateValue&&this.updateInputValue(this.maskedDateValue));return r},e.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},e.prototype.findNextElement=function(t){var i=this.inputElement.value,r=m(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,a=this.liCollections.length,o=this.timeCollections;if(!m(this.checkDateValue(r))||!m(this.activeIndex)){if(t.action==="home"){var l=this.validLiElement(0);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l}else if(t.action==="end"){var l=this.validLiElement(o.length-1,!0);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l}else if(t.action==="down"){for(var h=0;h<a;h++)if(+r<this.timeCollections[h]){var l=this.validLiElement(h);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}else if(h===a-1){var l=this.validLiElement(0);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}}else for(var h=a-1;h>=0;h--)if(+r>this.timeCollections[h]){var l=this.validLiElement(h,!0);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}else if(h===0){var l=this.validLiElement(a-1);n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}this.selectedElement=this.liCollections[this.activeIndex],this.elementValue(m(n)?null:new Date(n))}else this.selectNextItem(t)},e.prototype.selectNextItem=function(t){var i=this.validLiElement(0,t.action!=="down");this.activeIndex=i,this.selectedElement=this.liCollections[i],this.elementValue(new Date(this.timeCollections[i]))},e.prototype.elementValue=function(t){m(this.checkDateValue(t))||this.checkValue(t)},e.prototype.validLiElement=function(t,i){var r=null,n=m(this.popupWrapper)?this.liCollections:this.popupWrapper.querySelectorAll("."+To),a=!0;if(n.length)if(i)for(var o=t;o>=0;o--)if(n[o].classList.contains(fa))o===0&&a&&(t=o=n.length,a=!1);else{r=o;break}else for(var o=t;o<=n.length-1;o++)if(n[o].classList.contains(fa))o===n.length-1&&a&&(t=o=-1,a=!1);else{r=o;break}return r},e.prototype.keyHandler=function(t){if(!(m(this.step)||this.step<=0||!m(this.inputWrapper)&&this.inputWrapper.buttons[0].classList.contains(fa))){var i=this.timeCollections.length;if(m(this.getActiveElement())||this.getActiveElement().length===0)if(this.liCollections.length>0)if(m(this.value)&&m(this.activeIndex)){var r=this.validLiElement(0,t.action!=="down");this.activeIndex=r,this.selectedElement=this.liCollections[r],this.elementValue(new Date(this.timeCollections[r]))}else this.findNextElement(t);else this.findNextElement(t);else{var n=void 0;if(t.keyCode>=37&&t.keyCode<=40){var r=t.keyCode===40||t.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=r=this.activeIndex===i?0:this.activeIndex,this.activeIndex=r=this.activeIndex<0?i-1:this.activeIndex,this.activeIndex=r=this.validLiElement(this.activeIndex,!(t.keyCode===40||t.keyCode===39)),n=m(this.timeCollections[r])?this.timeCollections[0]:this.timeCollections[r]}else if(t.action==="home"){var r=this.validLiElement(0);this.activeIndex=r,n=this.timeCollections[r]}else if(t.action==="end"){var r=this.validLiElement(i-1,!0);this.activeIndex=r,n=this.timeCollections[r]}this.selectedElement=this.liCollections[this.activeIndex],this.elementValue(new Date(n))}this.isNavigate=!0,this.setHover(this.selectedElement,wx),this.setActiveDescendant(),this.enableMask&&this.selectInputText(),this.isPopupOpen()&&this.selectedElement!==null&&(!t||t.type!=="click")&&this.setScrollPosition()}},e.prototype.getCultureTimeObject=function(t,i){return ie("main."+i+".dates.calendars.gregorian.timeFormats.short",t)},e.prototype.getCultureDateObject=function(t,i){return ie("main."+i+".dates.calendars.gregorian.dateFormats.short",t)},e.prototype.wireListEvents=function(){I.add(this.listWrapper,"click",this.onMouseClick,this),B.isDevice||(I.add(this.listWrapper,"mouseover",this.onMouseOver,this),I.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},e.prototype.unWireListEvents=function(){this.listWrapper&&(I.remove(this.listWrapper,"click",this.onMouseClick),B.isDevice||(I.remove(this.listWrapper,"mouseover",this.onMouseOver),I.remove(this.listWrapper,"mouseout",this.onMouseLeave)))},e.prototype.valueProcess=function(t,i){var r=m(this.checkDateValue(i))?null:i;+this.prevDate!=+r&&(this.initValue=r,this.changeEvent(t))},e.prototype.changeEvent=function(t){this.addSelection(),this.updateInput(!0,this.initValue);var i={event:t||null,value:this.value,text:this.inputElement.value,isInteracted:!m(t),element:this.element};i.value=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.prevDate=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",i),this.invalidValueString=null,this.checkErrorState(this.value)},e.prototype.updateInput=function(t,i){t&&(this.prevValue=this.getValue(i)),this.prevDate=this.valueWithMinutes=i,(typeof i!="number"||(this.value&&+new Date(+this.value).setMilliseconds(0))!==+i)&&(this.setProperties({value:i},!0),this.enableMask&&this.value&&this.createMask()),!this.strictMode&&m(this.value)&&this.invalidValueString&&(this.checkErrorState(this.invalidValueString),this.updateInputValue(this.invalidValueString)),this.clearIconState()},e.prototype.setActiveDescendant=function(){!m(this.selectedElement)&&this.value?De(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")}):this.inputElement.removeAttribute("aria-activedescendant")},e.prototype.removeSelection=function(){if(this.removeHover(xx),!m(this.popupWrapper)){var t=this.popupWrapper.querySelectorAll("."+wh);t.length&&(te(t,wh),t[0].removeAttribute("aria-selected"))}},e.prototype.removeHover=function(t){var i=this.getHoverItem(t);i&&i.length&&(te(i,t),t===wx&&i[0].removeAttribute("aria-selected"))},e.prototype.getHoverItem=function(t){var i;return m(this.popupWrapper)||(i=this.popupWrapper.querySelectorAll("."+t)),i},e.prototype.setActiveClass=function(){if(!m(this.popupWrapper)){var t=this.popupWrapper.querySelectorAll("."+To);if(t.length){for(var i=0;i<t.length;i++)if(this.timeCollections[i]===+this.getDateObject(this.valueWithMinutes)){t[i].setAttribute("aria-selected","true"),this.selectedElement=t[i],this.activeIndex=i;break}}}},e.prototype.addSelection=function(){this.selectedElement=null,this.removeSelection(),this.setActiveClass(),m(this.selectedElement)||(Q([this.selectedElement],wh),this.selectedElement.setAttribute("aria-selected","true"))},e.prototype.isValidLI=function(t){return t&&t.classList.contains(To)&&!t.classList.contains(fa)},e.prototype.createDateObj=function(t){var i=null,r=this.globalize.formatDate(new Date,{format:i,skeleton:"short",type:"date"}),n=null;return typeof t=="string"?t.toUpperCase().indexOf("AM")>-1||t.toUpperCase().indexOf("PM")>-1?(r=this.defaultCulture.formatDate(new Date,{format:i,skeleton:"short",type:"date"}),n=isNaN(+new Date(r+" "+t))?null:new Date(new Date(r+" "+t).setMilliseconds(0)),m(n)&&(n=this.timeParse(r,t))):n=this.timeParse(r,t):t instanceof Date&&(n=t),n},e.prototype.timeParse=function(t,i){var r;return r=this.globalize.parseDate(t+" "+i,{format:this.cldrDateFormat()+" "+this.cldrTimeFormat(),type:"datetime"}),r=m(r)?this.globalize.parseDate(t+" "+i,{format:this.cldrDateFormat()+" "+this.dateToNumeric(),type:"datetime"}):r,r=m(r)?r:new Date(r.setMilliseconds(0)),r},e.prototype.createListItems=function(){var t=this;this.listWrapper=this.createElement("div",{className:sQ,attrs:{tabindex:"-1"}});var i,r=this.step*6e4,n=[];this.timeCollections=[],this.disableItemCollection=[],i=+this.getDateObject(this.initMin).setMilliseconds(0);for(var a=+this.getDateObject(this.initMax).setMilliseconds(0);a>=i;)this.timeCollections.push(i),n.push(this.globalize.formatDate(new Date(i),{format:this.cldrTimeFormat(),type:"time"})),i+=r;var o={itemCreated:function(l){var h={element:l.item,text:l.text,value:t.getDateObject(l.text),isDisabled:!1};t.trigger("itemRender",h,function(u){u.isDisabled&&u.element.classList.add(fa),u.element.classList.contains(fa)&&t.disableItemCollection.push(u.element.getAttribute("data-value"))})}};this.listTag=Et.createList(this.createElement,n,o,!0),De(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options",tabindex:"0"}),Ut([this.listTag],this.listWrapper)},e.prototype.documentClickHandler=function(t){var i=t.target;!m(this.popupObj)&&!m(this.inputWrapper)&&(this.inputWrapper.container.contains(i)&&t.type!=="mousedown"||this.popupObj.element&&this.popupObj.element.contains(i))&&t.type!=="touchstart"&&t.preventDefault(),!U(i,'[id="'+this.popupObj.element.id+'"]')&&i!==this.inputElement&&i!==(this.inputWrapper&&this.inputWrapper.buttons[0])&&i!==(this.inputWrapper&&this.inputWrapper.clearButton)&&i!==(this.inputWrapper&&this.inputWrapper.container)&&!i.classList.contains("e-dlg-overlay")?this.isPopupOpen()&&(this.hide(),this.focusOut()):i!==this.inputElement&&(B.isDevice||(this.isPreventBlur=(B.isIE||B.info.name==="edge")&&document.activeElement===this.inputElement&&i===this.popupWrapper))},e.prototype.setEnableRtl=function(){ye.setEnableRtl(this.enableRtl,[this.inputWrapper.container]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},e.prototype.setEnable=function(){ye.setEnabled(this.enabled,this.inputElement,this.floatLabelType),this.enabled?(te([this.inputWrapper.container],fa),De(this.inputElement,{"aria-disabled":"false"}),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.hide(),Q([this.inputWrapper.container],fa),De(this.inputElement,{"aria-disabled":"true"}),this.inputElement.tabIndex=-1)},e.prototype.getProperty=function(t,i){i==="min"?(this.initMin=this.checkDateValue(new Date(this.checkInValue(t.min))),this.setProperties({min:this.initMin},!0)):(this.initMax=this.checkDateValue(new Date(this.checkInValue(t.max))),this.setProperties({max:this.initMax},!0)),this.inputElement.value===""?this.validateMinMax(this.value,this.min,this.max):this.checkValue(this.inputElement.value),this.checkValueChange(null,!1)},e.prototype.inputBlurHandler=function(t){if(this.enabled){if(this.isPreventBlur&&this.isPopupOpen()){this.inputElement.focus();return}this.closePopup(0,t),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value===this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&this.updateInputValue(""),te([this.inputWrapper.container],[Mx]);var i={model:this};this.trigger("blur",i),this.getText()!==this.inputElement.value?this.updateValue(this.inputElement.value,t):this.inputElement.value.trim().length===0&&this.resetState(),this.cursorDetails=null,this.isNavigate=!1,this.inputElement.value===""&&(this.invalidValueString=null)}},e.prototype.focusOut=function(){if(document.activeElement===this.inputElement){this.inputElement.blur(),te([this.inputWrapper.container],[Mx]);var t={model:this};this.trigger("blur",t)}},e.prototype.isPopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+rg))},e.prototype.inputFocusHandler=function(){if(this.enabled){var t={model:this};!this.readonly&&!B.isDevice&&!this.enableMask&&this.selectInputText(),this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length),this.trigger("focus",t),this.clearIconState(),this.openOnFocus&&this.show()}},e.prototype.focusIn=function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()},e.prototype.hide=function(){this.closePopup(100,null),this.clearIconState()},e.prototype.show=function(t){var i=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupWrapper)){this.popupCreation(),B.isDevice&&this.listWrapper&&(this.modal=this.createElement("div"),this.modal.className=""+rg+" e-time-modal",document.body.className+=" "+mL,document.body.appendChild(this.modal)),B.isDevice&&(this.mobileTimePopupWrap=this.createElement("div",{className:"e-timepicker-mob-popup-wrap"}),document.body.appendChild(this.mobileTimePopupWrap)),this.openPopupEventArgs={popup:this.popupObj||null,cancel:!1,event:t||null,name:"open",appendTo:B.isDevice?this.mobileTimePopupWrap:document.body};var r=this.openPopupEventArgs;if(this.trigger("open",r,function(a){if(i.openPopupEventArgs=a,!i.openPopupEventArgs.cancel&&!i.inputWrapper.buttons[0].classList.contains(fa)){i.openPopupEventArgs.appendTo.appendChild(i.popupWrapper),i.popupAlignment(i.openPopupEventArgs),i.setScrollPosition(),B.isDevice||i.inputElement.focus();var o={name:"FadeIn",duration:vL};i.popupObj.refreshPosition(i.anchor),i.zIndex===1e3?i.popupObj.show(new ri(o),i.element):i.popupObj.show(new ri(o),null),i.setActiveDescendant(),De(i.inputElement,{"aria-expanded":"true"}),De(i.inputElement,{"aria-owns":i.inputElement.id+"_options"}),De(i.inputElement,{"aria-controls":i.inputElement.id}),Q([i.inputWrapper.container],Mx),I.add(document,"mousedown touchstart",i.documentClickHandler,i),i.setOverlayIndex(i.mobileTimePopupWrap,i.popupObj.element,i.modal,B.isDevice)}else i.popupObj.destroy(),i.popupWrapper=i.listTag=void 0,i.liCollections=i.timeCollections=i.disableItemCollection=[],i.popupObj=null}),B.isDevice){var n=this.createElement("div",{className:"e-dlg-overlay"});n.style.zIndex=(this.zIndex-1).toString(),this.mobileTimePopupWrap.appendChild(n)}}},e.prototype.setOverlayIndex=function(t,i,r,n){if(n&&!m(i)&&!m(r)&&!m(t)){var a=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(a-1).toString(),t.style.zIndex=a.toString()}},e.prototype.formatValues=function(t){var i;return typeof t=="number"?i=qe(t):typeof t=="string"&&(i=t.match(/px|%|em/)||isNaN(parseInt(t,10))?t:qe(t)),i},e.prototype.popupAlignment=function(t){if(t.popup.position.X=this.formatValues(t.popup.position.X),t.popup.position.Y=this.formatValues(t.popup.position.Y),(!isNaN(parseFloat(t.popup.position.X))||!isNaN(parseFloat(t.popup.position.Y)))&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.targetType="container"),isNaN(parseFloat(t.popup.position.X))||(this.popupObj.offsetX=parseFloat(t.popup.position.X)),isNaN(parseFloat(t.popup.position.Y))||(this.popupObj.offsetY=parseFloat(t.popup.position.Y)),B.isDevice)t.popup.position.X==="center"&&t.popup.position.Y==="center"&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.offsetY=0,this.popupObj.targetType="container",this.popupObj.collision={X:"fit",Y:"fit"});else{switch(t.popup.position.X){case"left":break;case"right":t.popup.offsetX=this.containerStyle.width;break;case"center":t.popup.offsetX=-(this.containerStyle.width/2);break}switch(t.popup.position.Y){case"top":break;case"bottom":break;case"center":t.popup.offsetY=-(this.containerStyle.height/2);break}t.popup.position.X==="center"&&t.popup.position.Y==="center"&&(this.popupObj.relateTo=this.inputWrapper.container,this.anchor=this.inputElement,this.popupObj.targetType="relative")}},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"timepicker"},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"placeholder":ye.setPlaceholder(t.placeholder,this.inputElement);break;case"readonly":ye.setReadonly(this.readonly,this.inputElement,this.floatLabelType),this.readonly&&this.hide(),this.setTimeAllowEdit();break;case"enabled":this.setProperties({enabled:t.enabled},!0),this.setEnable();break;case"allowEdit":this.setTimeAllowEdit();break;case"enableRtl":this.setProperties({enableRtl:t.enableRtl},!0),this.setEnableRtl();break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"zIndex":this.setProperties({zIndex:t.zIndex},!0),this.setZIndex();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"min":case"max":this.getProperty(t,a);break;case"showClearButton":ye.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"locale":this.setProperties({locale:t.locale},!0),this.globalize=new _t(this.locale),this.l10n.setLocale(this.locale),this.timeOptions&&this.timeOptions.placeholder==null&&this.updatePlaceHolder(),this.setValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"width":tt(this.inputWrapper.container,{width:this.setWidth(t.width)}),this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"format":this.setProperties({format:t.format},!0),this.checkTimeFormat(),this.setValue(this.value),this.enableMask&&(this.createMask(),this.value||this.updateInputValue(this.maskedDateValue));break;case"value":this.invalidValueString=null,this.checkInvalidValue(t.value),t.value=this.value,this.invalidValueString?(this.updateInputValue(this.invalidValueString),this.checkErrorState(this.invalidValueString)):(typeof t.value=="string"?(this.setProperties({value:this.checkDateValue(new Date(t.value))},!0),t.value=this.value):(t.value&&+new Date(+t.value).setMilliseconds(0))!==+this.value&&(t.value=this.checkDateValue(new Date(""+t.value))),this.initValue=t.value,t.value=this.compareFormatChange(this.checkValue(t.value))),this.enableMask&&m(t.value)&&(this.updateInputValue(this.maskedDateValue),this.checkErrorState(this.maskedDateValue)),this.checkValueChange(null,!1),this.isPopupOpen()&&this.setScrollPosition(),this.isAngular&&this.preventChange&&(this.preventChange=!1),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"floatLabelType":this.floatLabelType=t.floatLabelType,ye.removeFloating(this.inputWrapper),ye.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"strictMode":this.invalidValueString=null,t.strictMode&&this.checkErrorState(null),this.setProperties({strictMode:t.strictMode},!0),this.checkValue(this.inputElement.value),this.checkValueChange(null,!1);break;case"scrollTo":this.checkDateValue(new Date(this.checkInValue(t.scrollTo)))?(this.popupWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(t.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue)):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break}}},e.prototype.checkInValue=function(t){return t instanceof Date?t.toUTCString():""+t},Vt([S(null)],e.prototype,"width",void 0),Vt([S(null)],e.prototype,"cssClass",void 0),Vt([S(!1)],e.prototype,"strictMode",void 0),Vt([S(null)],e.prototype,"keyConfigs",void 0),Vt([S(null)],e.prototype,"format",void 0),Vt([S(!0)],e.prototype,"enabled",void 0),Vt([S(!1)],e.prototype,"fullScreenMode",void 0),Vt([S(!1)],e.prototype,"readonly",void 0),Vt([S({})],e.prototype,"htmlAttributes",void 0),Vt([S("Never")],e.prototype,"floatLabelType",void 0),Vt([S(null)],e.prototype,"placeholder",void 0),Vt([S(1e3)],e.prototype,"zIndex",void 0),Vt([S(!1)],e.prototype,"enablePersistence",void 0),Vt([S(!0)],e.prototype,"showClearButton",void 0),Vt([S(30)],e.prototype,"step",void 0),Vt([S(null)],e.prototype,"scrollTo",void 0),Vt([S(null)],e.prototype,"value",void 0),Vt([S(null)],e.prototype,"min",void 0),Vt([S(null)],e.prototype,"max",void 0),Vt([S(!0)],e.prototype,"allowEdit",void 0),Vt([S(!1)],e.prototype,"openOnFocus",void 0),Vt([S(!1)],e.prototype,"enableMask",void 0),Vt([S({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],e.prototype,"maskPlaceholder",void 0),Vt([S(null)],e.prototype,"serverTimezoneOffset",void 0),Vt([_()],e.prototype,"change",void 0),Vt([_()],e.prototype,"created",void 0),Vt([_()],e.prototype,"destroyed",void 0),Vt([_()],e.prototype,"open",void 0),Vt([_()],e.prototype,"itemRender",void 0),Vt([_()],e.prototype,"close",void 0),Vt([_()],e.prototype,"cleared",void 0),Vt([_()],e.prototype,"blur",void 0),Vt([_()],e.prototype,"focus",void 0),e=Vt([Ot],e),e})(Pi);var lQ=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ti=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},hQ="e-date-wrapper",uQ="e-datepicker",cQ="e-datetime-wrapper",dQ=new Date().getDate(),pQ=new Date().getMonth(),fQ=new Date().getFullYear(),vQ=new Date().getHours(),mQ=new Date().getMinutes(),gQ=new Date().getSeconds(),yQ=new Date().getMilliseconds(),wp="e-datetimepicker",yL="e-datetimepopup-wrapper",bQ="e-input-group-icon",bL="e-popup",CQ="e-time-icon",Mp="e-input-focus",CL="250px",SL="e-icon-anim",Ix="e-disabled",xL="e-error",SQ="e-content",xQ="e-navigation",dl="e-active",Tx="e-hover",wQ="e-icons",ng=2,pl="e-list-item",wL=100,ML="e-time-overflow",MQ=function(s){lQ(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.valueWithMinutes=null,r.scrollInvoked=!1,r.moduleName=r.getModuleName(),r.formatRegex=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|'[^']*'|'[^']*'/g,r.dateFormatString="",r.dateTimeOptions=t,r}return e.prototype.focusHandler=function(){this.enabled&&Q([this.inputWrapper.container],Mp)},e.prototype.focusIn=function(){s.prototype.focusIn.call(this)},e.prototype.focusOut=function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),te([this.inputWrapper.container],[Mp]))},e.prototype.blurHandler=function(t){if(this.enabled){if(this.isTimePopupOpen()&&this.isPreventBlur){this.inputElement.focus();return}te([this.inputWrapper.container],Mp);var i={model:this};this.isTimePopupOpen()&&this.hide(t),this.trigger("blur",i)}},e.prototype.destroy=function(){this.popupObject&&this.popupObject.element.classList.contains(bL)&&(this.popupObject.destroy(),ne(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],m(this.rippleFn)||this.rippleFn());var t={"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-expanded":"false",role:"combobox",autocomplete:"off"};this.inputElement&&ye.removeAttributes(t,this.inputElement),this.isCalendar()&&(this.popupWrapper&&ne(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),this.liCollections=null,this.rippleFn=null,this.selectedElement=null,this.listTag=null,this.timeIcon=null,this.popupObject=null,this.preventArgs=null,this.keyboardModule=null,s.prototype.destroy.call(this)},e.prototype.render=function(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,typeof this.min=="string"&&(this.min=this.checkDateValue(new Date(this.min))),typeof this.max=="string"&&(this.max=this.checkDateValue(new Date(this.max))),!m(U(this.element,"fieldset"))&&U(this.element,"fieldset").disabled&&(this.enabled=!1),s.prototype.updateHtmlAttributeToElement.call(this),this.checkAttributes(!1);var t={placeholder:this.placeholder};this.l10n=new In("datetimepicker",t,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),s.prototype.render.call(this),this.createInputElement(),s.prototype.updateHtmlAttributeToWrapper.call(this),this.bindInputEvents(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.setValue(!0),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)&&ye.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),this.element.tagName==="EJS-DATETIMEPICKER"&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.floatLabelType==="Auto"&&ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon"),this.renderComplete()},e.prototype.setValue=function(t){if(t===void 0&&(t=!1),this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){var i=this.validateMinMaxRange(this.initValue);ye.setValue(this.getFormattedValue(i),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:i},!0)}else m(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,s.prototype.updateInput.call(this,t)},e.prototype.validateMinMaxRange=function(t){var i=t;return this.isDateObject(t)?i=this.validateValue(t):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(i),i},e.prototype.checkValidState=function(t){this.isValidState=!0,this.strictMode||(+t>+this.max||+t<+this.min)&&(this.isValidState=!1),this.checkErrorState()},e.prototype.checkErrorState=function(){this.isValidState?te([this.inputWrapper.container],xL):Q([this.inputWrapper.container],xL),De(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.validateValue=function(t){var i=t;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),i=this.max):+t<+this.min?i=this.min:+t>+this.max&&(i=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),i=t),i},e.prototype.disablePopupButton=function(t){t?(Q([this.inputWrapper.buttons[0],this.timeIcon],Ix),this.hide()):te([this.inputWrapper.buttons[0],this.timeIcon],Ix)},e.prototype.getFormattedValue=function(t){var i;return m(t)?null:(this.calendarMode==="Gregorian"?i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd"}:i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(t,i))},e.prototype.isDateObject=function(t){return!m(t)&&!isNaN(+t)},e.prototype.createInputElement=function(){te([this.inputElement],uQ),te([this.inputWrapper.container],hQ),Q([this.inputWrapper.container],cQ),Q([this.inputElement],wp),this.renderTimeIcon()},e.prototype.renderTimeIcon=function(){this.timeIcon=ye.appendSpan(bQ+" "+CQ+" "+wQ,this.inputWrapper.container)},e.prototype.bindInputEvents=function(){I.add(this.timeIcon,"mousedown",this.timeHandler,this),I.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),I.add(this.inputElement,"blur",this.blurHandler,this),I.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=me(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new wr(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.unBindInputEvents=function(){I.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),I.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(I.remove(this.inputElement,"blur",this.blurHandler),I.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()},e.prototype.cldrTimeFormat=function(){var t;return this.isNullOrEmpty(this.timeFormat)?this.locale==="en"||this.locale==="en-US"?t=ie("timeFormats.short",xl()):t=this.getCultureTimeObject(hr,""+this.locale):t=this.timeFormat,t},e.prototype.cldrDateTimeFormat=function(){var t,i=new _t(this.locale),r=i.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?t=r+" "+this.getCldrFormat("time"):t=this.formatString,t},e.prototype.getCldrFormat=function(t){var i;return this.locale==="en"||this.locale==="en-US"?i=ie("timeFormats.short",xl()):i=this.getCultureTimeObject(hr,""+this.locale),i},e.prototype.isNullOrEmpty=function(t){return!!(m(t)||typeof t=="string"&&t.trim()==="")},e.prototype.getCultureTimeObject=function(t,i){return this.calendarMode==="Gregorian"?ie("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",t):ie("main."+this.locale+".dates.calendars.islamic.timeFormats.short",t)},e.prototype.timeHandler=function(t){this.enabled&&(this.isIconClicked=!0,B.isDevice&&this.inputElement.setAttribute("readonly",""),t.currentTarget===this.timeIcon&&t.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&s.prototype.hide.call(this,t),this.isTimePopupOpen()?this.closePopup(t):(this.inputElement.focus(),this.popupCreation("time",t),Q([this.inputWrapper.container],[Mp]))),this.isIconClicked=!1)},e.prototype.dateHandler=function(t){this.enabled&&(t.currentTarget===this.inputWrapper.buttons[0]&&t.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(t),m(this.popupWrapper)||this.popupCreation("date",t)))},e.prototype.show=function(t,i){this.enabled&&this.readonly||!this.enabled||(t==="time"&&!this.dateTimeWrapper?(this.isDatePopupOpen()&&this.hide(i),this.popupCreation("time",i)):this.popupObj||(this.isTimePopupOpen()&&this.hide(i),s.prototype.show.call(this),this.popupCreation("date",i)))},e.prototype.toggle=function(t){this.isDatePopupOpen()?(s.prototype.hide.call(this,t),this.show("time",null)):this.isTimePopupOpen()?(this.hide(t),s.prototype.show.call(this,null,t),this.popupCreation("date",null)):this.show(null,t)},e.prototype.listCreation=function(){var t;this.calendarMode==="Gregorian"?(this.cldrDateTimeFormat().replace(this.formatRegex,this.TimePopupFormat()),t=this.globalize.parseDate(this.inputElement.value,{format:this.dateFormatString,type:"datetime"})):t=this.globalize.parseDate(this.inputElement.value,{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});var i=m(this.value)?this.inputElement.value!==""?t:new Date:this.value;this.valueWithMinutes=i,this.listWrapper=St("div",{className:SQ,attrs:{tabindex:"0"}});var r=this.startTime(i),n=this.endTime(i),a=UM.createListItems(this.createElement,r,n,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=a.collection,this.listTag=a.list,De(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),Ut([a.list],this.listWrapper),this.wireTimeListEvents();var o={duration:300,selector:"."+pl};this.rippleFn=yr(this.listWrapper,o),this.liCollections=this.listWrapper.querySelectorAll("."+pl)},e.prototype.popupCreation=function(t,i){if(B.isDevice&&this.element.setAttribute("readonly","readonly"),t==="date")!this.readonly&&this.popupWrapper&&(Q([this.popupWrapper],yL),De(this.popupWrapper,{id:this.element.id+"_options"}));else if(!this.readonly&&(this.dateTimeWrapper=St("div",{className:wp+" "+bL,attrs:{id:this.element.id+"_timepopup",style:"visibility:hidden ; display:block"}}),m(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!m(this.step)&&this.step>0&&(this.listCreation(),Ut([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(i),(!B.isDevice||B.isDevice&&!this.fullScreenMode)&&this.popupObject.refreshPosition(this.inputElement),B.isDevice&&this.fullScreenMode&&(this.dateTimeWrapper.style.left="0px"),B.isDevice)){var r=this.createElement("div",{className:"e-dlg-overlay"});r.style.zIndex=(this.zIndex-1).toString(),this.timeModal.appendChild(r)}},e.prototype.openPopup=function(t){var i=this;this.preventArgs={cancel:!1,popup:this.popupObject,event:t||null};var r=this.preventArgs;this.trigger("open",r,function(n){if(i.preventArgs=n,!i.preventArgs.cancel&&!i.readonly){var a={name:"FadeIn",duration:wL};i.zIndex===1e3?i.popupObject.show(new ri(a),i.element):i.popupObject.show(new ri(a),null),Q([i.inputWrapper.container],[SL]),De(i.inputElement,{"aria-expanded":"true"}),De(i.inputElement,{"aria-owns":i.inputElement.id+"_options"}),De(i.inputElement,{"aria-controls":i.inputElement.id}),I.add(document,"mousedown touchstart",i.documentClickHandler,i)}})},e.prototype.documentClickHandler=function(t){var i=t.target;!m(this.popupObject)&&(this.inputWrapper.container.contains(i)&&t.type!=="mousedown"||this.popupObject.element&&this.popupObject.element.contains(i))&&t.type!=="touchstart"&&t.preventDefault(),!U(i,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))&&i!==this.inputElement&&i!==this.timeIcon&&!m(this.inputWrapper)&&i!==this.inputWrapper.container&&!i.classList.contains("e-dlg-overlay")?this.isTimePopupOpen()&&(this.hide(t),this.focusOut()):i!==this.inputElement&&(B.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(B.isIE||B.info.name==="edge")&&i===this.popupObject.element))},e.prototype.isTimePopupOpen=function(){return!!(this.dateTimeWrapper&&this.dateTimeWrapper.classList.contains(""+wp))},e.prototype.isDatePopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+yL))},e.prototype.renderPopup=function(){var t=this;this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),B.isDevice&&(this.timeModal=St("div"),this.timeModal.className=""+wp+" e-time-modal",document.body.className+=" "+ML,this.timeModal.style.display="block",document.body.appendChild(this.timeModal));var i=4;if(this.popupObject=new za(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:B.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:B.isDevice?document.body:this.inputWrapper.container,position:B.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:i,open:function(){t.dateTimeWrapper.style.visibility="visible",Q([t.timeIcon],dl),B.isDevice||(t.timekeyConfigure=me(t.timekeyConfigure,t.keyConfigs),t.inputEvent=new wr(t.inputWrapper.container,{keyAction:t.timeKeyActionHandle.bind(t),keyConfigs:t.timekeyConfigure,eventName:"keydown"}))},close:function(){te([t.timeIcon],dl),t.unWireTimeListEvents(),t.inputElement.removeAttribute("aria-activedescendant"),pt(t.popupObject.element),t.popupObject.destroy(),t.dateTimeWrapper.innerHTML="",t.listWrapper=t.dateTimeWrapper=void 0,t.inputEvent&&t.inputEvent.destroy()},targetExitViewport:function(){B.isDevice||t.hide()}}),B.isDevice&&this.fullScreenMode?(this.popupObject.element.style.display="flex",this.popupObject.element.style.maxHeight="100%",this.popupObject.element.style.width="100%"):this.popupObject.element.style.maxHeight=CL,B.isDevice&&this.fullScreenMode){var r=St("div",{className:"e-datetime-mob-popup-wrap"}),n=this.createElement("div",{className:"e-model-header"}),a=this.createElement("span",{className:"e-model-title"});a.textContent="Select time";var o=this.createElement("span",{className:"e-popup-close"});I.add(o,"mousedown touchstart",this.dateTimeCloseHandler,this);var l=this.dateTimeWrapper.querySelector(".e-content");n.appendChild(o),n.appendChild(a),r.appendChild(n),r.appendChild(l),this.dateTimeWrapper.insertBefore(r,this.dateTimeWrapper.firstElementChild)}},e.prototype.dateTimeCloseHandler=function(t){this.hide()},e.prototype.setDimension=function(t){return typeof t=="number"?t=qe(t):typeof t=="string"?t=t:t="100%",t},e.prototype.setPopupWidth=function(){var t=this.setDimension(this.width);if(t.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(t)/100;t=i.toString()+"px"}return t},e.prototype.wireTimeListEvents=function(){I.add(this.listWrapper,"click",this.onMouseClick,this),B.isDevice||(I.add(this.listWrapper,"mouseover",this.onMouseOver,this),I.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},e.prototype.unWireTimeListEvents=function(){this.listWrapper&&(I.remove(this.listWrapper,"click",this.onMouseClick),I.remove(document,"mousedown touchstart",this.documentClickHandler),B.isDevice||(I.add(this.listWrapper,"mouseover",this.onMouseOver,this),I.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))},e.prototype.onMouseOver=function(t){var i=U(t.target,"."+pl);this.setTimeHover(i,Tx)},e.prototype.onMouseLeave=function(){this.removeTimeHover(Tx)},e.prototype.setTimeHover=function(t,i){this.enabled&&this.isValidLI(t)&&!t.classList.contains(i)&&(this.removeTimeHover(i),Q([t],i))},e.prototype.getPopupHeight=function(){var t=parseInt(CL,10),i=this.dateTimeWrapper.getBoundingClientRect().height;return B.isDevice&&this.fullScreenMode?i:i>t?t:i},e.prototype.changeEvent=function(t){s.prototype.changeEvent.call(this,t),(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))},e.prototype.updateValue=function(t){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:t||null,isInteracted:!m(t),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.previousDate=this.value)},e.prototype.setTimeScrollPosition=function(){var t=this.selectedElement;m(t)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(t)},e.prototype.findScrollTop=function(t){var i=this.getPopupHeight(),r=t.nextElementSibling,n=r?r.offsetTop:t.offsetTop,a=t.getBoundingClientRect().height;if(n+t.offsetTop>i)if(B.isDevice&&this.fullScreenMode){var o=this.dateTimeWrapper.querySelector(".e-content");o.scrollTop=r?n-(i/ng+a/ng):n}else this.dateTimeWrapper.scrollTop=r?n-(i/ng+a/ng):n;else this.dateTimeWrapper.scrollTop=0},e.prototype.setScrollTo=function(){var t,i=this.dateTimeWrapper.querySelectorAll("."+pl);if(i.length>=0){this.scrollInvoked=!0;var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();t=i[Math.round((n-r)/(this.step*6e4))]}else this.dateTimeWrapper.scrollTop=0;m(t)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(t)},e.prototype.setInputValue=function(t){if(t==="date")this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{var i=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));ye.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0),this.enableMask&&this.createMask()}this.updateIconState()},e.prototype.getFullDateTime=function(){var t=null;return this.isDateObject(this.valueWithMinutes)?t=this.combineDateTime(this.valueWithMinutes):t=this.previousDate,this.validateMinMaxRange(t)},e.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},e.prototype.combineDateTime=function(t){if(this.isDateObject(t)){var i=this.previousDate.getDate(),r=this.previousDate.getMonth(),n=this.previousDate.getFullYear(),a=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return new Date(n,r,i,a,o,l)}else return this.previousDate},e.prototype.onMouseClick=function(t){var i=t.target,r=this.selectedElement=U(i,"."+pl);r&&r.classList.contains(pl)&&(this.timeValue=r.getAttribute("data-value"),this.hide(t)),this.setSelection(r,t)},e.prototype.setSelection=function(t,i){if(this.isValidLI(t)&&!t.classList.contains(dl)){this.selectedElement=t;var r=Array.prototype.slice.call(this.liCollections).indexOf(t);this.activeIndex=r,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Q([this.selectedElement],dl),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(i)}},e.prototype.setTimeActiveClass=function(){var t=m(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!m(t)){var i=t.querySelectorAll("."+pl);if(i.length){for(var r=0;r<i.length;r++)if(this.timeCollections[r]===+this.valueWithMinutes){i[r].setAttribute("aria-selected","true"),this.selectedElement=i[r],this.activeIndex=r,this.setTimeActiveDescendant();break}}}},e.prototype.setTimeActiveDescendant=function(){!m(this.selectedElement)&&this.value?De(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")}):this.inputElement.removeAttribute("aria-activedescendant")},e.prototype.addTimeSelection=function(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),m(this.selectedElement)||(Q([this.selectedElement],dl),this.selectedElement.setAttribute("aria-selected","true"))},e.prototype.removeTimeSelection=function(){if(this.removeTimeHover(Tx),!m(this.dateTimeWrapper)){var t=this.dateTimeWrapper.querySelectorAll("."+dl);t.length&&(te(t,dl),t[0].removeAttribute("aria-selected"))}},e.prototype.removeTimeHover=function(t){var i=this.getTimeHoverItem(t);i&&i.length&&te(i,t)},e.prototype.getTimeHoverItem=function(t){var i=m(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper,r;return m(i)||(r=i.querySelectorAll("."+t)),r},e.prototype.isValidLI=function(t){return t&&t.classList.contains(pl)&&!t.classList.contains(Ix)},e.prototype.calculateStartEnd=function(t,i,r){var n=t.getDate(),a=t.getMonth(),o=t.getFullYear(),l=t.getHours(),h=t.getMinutes(),u=t.getSeconds(),c=t.getMilliseconds();return i?r==="starttime"?new Date(o,a,n,0,0,0):new Date(o,a,n,23,59,59):new Date(o,a,n,l,h,u,c)},e.prototype.startTime=function(t){var i,r,n=this.min,a=t===null?new Date:t;return+a.getDate()==+n.getDate()&&+a.getMonth()==+n.getMonth()&&+a.getFullYear()==+n.getFullYear()||+new Date(a.getFullYear(),a.getMonth(),a.getDate())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.min):+a<+this.max&&+a>+this.min?(r=!0,i=a):+a>=+this.max&&(r=!0,i=this.max),this.calculateStartEnd(i,r,"starttime")},e.prototype.TimePopupFormat=function(){var t="",i=0,r=this;function n(a){switch(a){case"d":case"dd":case"ddd":case"dddd":case"M":case"MM":case"MMM":case"MMMM":case"y":case"yy":case"yyy":case"yyyy":t==""?t=t+a:t=t+"/"+a,i=i+1;break}return i>2&&(r.dateFormatString=t),t}return n},e.prototype.endTime=function(t){var i,r,n=this.max,a=t===null?new Date:t;return+a.getDate()==+n.getDate()&&+a.getMonth()==+n.getMonth()&&+a.getFullYear()==+n.getFullYear()||+new Date(a.getUTCFullYear(),a.getMonth(),a.getDate())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.max):+a<+this.max&&+a>+this.min?(r=!0,i=a):+a<=+this.min&&(r=!0,i=this.min),this.calculateStartEnd(i,r,"endtime")},e.prototype.hide=function(t){var i=this;if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:this.popupObj||this.popupObject,event:t||null};var r=this.preventArgs;m(this.popupObj)?this.trigger("close",r,function(n){i.dateTimeCloseEventCallback(t,n)}):this.dateTimeCloseEventCallback(t,r)}else B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.dateTimeCloseEventCallback=function(t,i){this.preventArgs=i,this.preventArgs.cancel||(this.isDatePopupOpen()?s.prototype.hide.call(this,t):this.isTimePopupOpen()&&(this.closePopup(t),te([document.body],ML),B.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.closePopup=function(t){if(this.isTimePopupOpen()&&this.popupObject){var i={name:"FadeOut",duration:wL,delay:0};this.popupObject.hide(new ri(i)),this.inputWrapper.container.classList.remove(SL),De(this.inputElement,{"aria-expanded":"false"}),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),I.remove(document,"mousedown touchstart",this.documentClickHandler)}},e.prototype.preRender=function(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),s.prototype.preRender.call(this),te([this.inputElementCopy],[wp])},e.prototype.getProperty=function(t,i){i==="min"?this.setProperties({min:this.validateValue(t.min)},!0):this.setProperties({max:this.validateValue(t.max)},!0)},e.prototype.checkAttributes=function(t){for(var i=t?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"],r,n=0,a=i;n<a.length;n++){var o=a[n];if(!m(this.inputElement.getAttribute(o)))switch(o){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(o));break;case"step":this.step=parseInt(this.inputElement.getAttribute(o),10);break;case"readonly":if(m(this.dateTimeOptions)||this.dateTimeOptions.readonly===void 0||t){var l=this.inputElement.getAttribute(o)==="disabled"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(m(this.dateTimeOptions)||this.dateTimeOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.inputElement.getAttribute(o)},!t);break;case"min":(m(this.dateTimeOptions)||this.dateTimeOptions.min===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({min:r},!t));break;case"disabled":if(m(this.dateTimeOptions)||this.dateTimeOptions.enabled===void 0||t){var h=!(this.inputElement.getAttribute(o)==="disabled"||this.inputElement.getAttribute(o)==="true"||this.inputElement.getAttribute(o)==="");this.setProperties({enabled:h},!t)}break;case"value":(m(this.dateTimeOptions)||this.dateTimeOptions.value===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({value:r},!t));break;case"max":(m(this.dateTimeOptions)||this.dateTimeOptions.max===void 0||t)&&(r=new Date(this.inputElement.getAttribute(o)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({max:r},!t));break}}},e.prototype.requiredModules=function(){var t=[];return this&&t.push({args:[this],member:"islamic"}),this.enableMask&&t.push(this.maskedDateModule()),t},e.prototype.maskedDateModule=function(){var t={args:[this],member:"MaskedDateTime"};return t},e.prototype.getTimeActiveElement=function(){return m(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll("."+dl)},e.prototype.createDateObj=function(t){return t instanceof Date?t:null},e.prototype.getDateObject=function(t){if(!this.isNullOrEmpty(t)){var i=this.createDateObj(t),r=this.valueWithMinutes,n=!m(r);if(this.checkDateValue(i)){var a=n?r.getDate():dQ,o=n?r.getMonth():pQ,l=n?r.getFullYear():fQ,h=n?r.getHours():vQ,u=n?r.getMinutes():mQ,c=n?r.getSeconds():gQ,d=n?r.getMilliseconds():yQ;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(l,o,a,i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(l,o,a,h,u,c,d)}}return null},e.prototype.findNextTimeElement=function(t){var i=this.inputElement.value,r=m(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,a=this.liCollections.length;if(!m(this.activeIndex)||!m(this.checkDateValue(r))){if(t.action==="home")n=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if(t.action==="end")n=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if(t.action==="down"){for(var o=0;o<a;o++)if(+r<this.timeCollections[o]){n=+this.createDateObj(new Date(this.timeCollections[o])),this.activeIndex=o;break}}else for(var o=a-1;o>=0;o--)if(+r>this.timeCollections[o]){n=+this.createDateObj(new Date(this.timeCollections[o])),this.activeIndex=o;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(m(n)?null:new Date(n))}},e.prototype.setTimeValue=function(t,i){var r,n,a=this.validateMinMaxRange(i),o=this.createDateObj(a);return this.getFormattedValue(o)!==(m(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=m(o)?null:o,n=new Date(+this.valueWithMinutes)):(this.strictMode&&(t=o),this.valueWithMinutes=this.checkDateValue(t),n=new Date(+this.valueWithMinutes)),this.calendarMode==="Gregorian"?r=this.globalize.formatDate(n,{format:m(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd"}):r=this.globalize.formatDate(n,{format:m(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&m(n)?ye.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton):ye.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton),n},e.prototype.timeElementValue=function(t){if(!m(this.checkDateValue(t))&&!this.isNullOrEmpty(t)){var i=t instanceof Date?t:this.getDateObject(t);return this.setTimeValue(i,t)}return null},e.prototype.timeKeyHandler=function(t){if(!(m(this.step)||this.step<=0)){var i=this.timeCollections.length;if(m(this.getTimeActiveElement())||this.getTimeActiveElement().length===0)this.liCollections.length>0&&(m(this.value)&&m(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(t));else{var r=void 0;if(t.keyCode>=37&&t.keyCode<=40){var n=t.keyCode===40||t.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=n=this.activeIndex===i?0:this.activeIndex,this.activeIndex=n=this.activeIndex<0?i-1:this.activeIndex,r=m(this.timeCollections[n])?this.timeCollections[0]:this.timeCollections[n]}else t.action==="home"?(this.activeIndex=0,r=this.timeCollections[0]):t.action==="end"&&(this.activeIndex=i-1,r=this.timeCollections[i-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(r))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,xQ),this.setTimeActiveDescendant(),this.isTimePopupOpen()&&this.selectedElement!==null&&(!t||t.type!=="click")&&this.setTimeScrollPosition()}},e.prototype.timeKeyActionHandle=function(t){if(this.enabled)switch(t.action!=="right"&&t.action!=="left"&&t.action!=="tab"&&t.preventDefault(),t.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(t);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(t),this.hide(t),Q([this.inputWrapper.container],Mp),this.isNavigate=!1,t.stopPropagation();break;case"escape":this.hide(t);break;default:this.isNavigate=!1;break}},e.prototype.inputKeyAction=function(t){switch(t.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(t);break}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];switch(a){case"value":this.isDynamicValueChanged=!0,this.invalidValueString=null,this.checkInvalidValue(t.value),t.value=this.value,t.value=this.validateValue(t.value),this.enableMask?ye.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton):ye.setValue(this.getFormattedValue(t.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=t.value,this.setProperties({value:t.value},!0),this.popupObj&&this.popupUpdate(),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null),this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.value&&this.notify("createMask",{module:"MaskedDateTime"});break;case"min":case"max":this.getProperty(t,a),this.updateInput();break;case"enableRtl":ye.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":m(i.cssClass)||(i.cssClass=i.cssClass.replace(/\s+/g," ").trim()),m(t.cssClass)||(t.cssClass=t.cssClass.replace(/\s+/g," ").trim()),ye.setCssClass(t.cssClass,[this.inputWrapper.container],i.cssClass),this.dateTimeWrapper&&ye.setCssClass(t.cssClass,[this.dateTimeWrapper],i.cssClass);break;case"locale":this.globalize=new _t(this.locale),this.l10n.setLocale(this.locale),this.dateTimeOptions&&this.dateTimeOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ye.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)),this.dateTimeFormat=this.cldrDateTimeFormat(),s.prototype.updateInput.call(this);break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:t.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||ye.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;case"placeholder":ye.setPlaceholder(t.placeholder,this.inputElement);break;case"enabled":ye.setEnabled(this.enabled,this.inputElement),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(t.width),ye.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"readonly":ye.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,ye.removeFloating(this.inputWrapper),ye.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(t.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(t.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),ye.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton)):this.inputElement.value===this.maskedDateValue&&(this.maskedDateValue="",ye.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;default:s.prototype.onPropertyChanged.call(this,t,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},e.prototype.getModuleName=function(){return"datetimepicker"},e.prototype.restoreValue=function(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=m(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)},ti([S(null)],e.prototype,"timeFormat",void 0),ti([S(30)],e.prototype,"step",void 0),ti([S(null)],e.prototype,"scrollTo",void 0),ti([S(1e3)],e.prototype,"zIndex",void 0),ti([S(null)],e.prototype,"value",void 0),ti([S(null)],e.prototype,"keyConfigs",void 0),ti([S({})],e.prototype,"htmlAttributes",void 0),ti([S(!1)],e.prototype,"enablePersistence",void 0),ti([S(!0)],e.prototype,"allowEdit",void 0),ti([S(!1)],e.prototype,"isMultiSelection",void 0),ti([S(null)],e.prototype,"values",void 0),ti([S(!0)],e.prototype,"showClearButton",void 0),ti([S(null)],e.prototype,"placeholder",void 0),ti([S(!1)],e.prototype,"strictMode",void 0),ti([S(!1)],e.prototype,"fullScreenMode",void 0),ti([S(null)],e.prototype,"serverTimezoneOffset",void 0),ti([S(new Date(1900,0,1))],e.prototype,"min",void 0),ti([S(new Date(2099,11,31))],e.prototype,"max",void 0),ti([S(null)],e.prototype,"firstDayOfWeek",void 0),ti([S("Gregorian")],e.prototype,"calendarMode",void 0),ti([S("Month")],e.prototype,"start",void 0),ti([S("Month")],e.prototype,"depth",void 0),ti([S(!1)],e.prototype,"weekNumber",void 0),ti([S(!0)],e.prototype,"showTodayButton",void 0),ti([S("Short")],e.prototype,"dayHeaderFormat",void 0),ti([S(!1)],e.prototype,"openOnFocus",void 0),ti([S(!1)],e.prototype,"enableMask",void 0),ti([S({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],e.prototype,"maskPlaceholder",void 0),ti([_()],e.prototype,"open",void 0),ti([_()],e.prototype,"close",void 0),ti([_()],e.prototype,"cleared",void 0),ti([_()],e.prototype,"blur",void 0),ti([_()],e.prototype,"focus",void 0),ti([_()],e.prototype,"created",void 0),ti([_()],e.prototype,"destroyed",void 0),e=ti([Ot],e),e}(r2),EQ=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),IQ=function(s){EQ(e,s);function e(t,i){var r=s.call(this,t)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.focusedMenuItem=null,r.customFilterOperators=i,r.isExcel=!0,r}return e.prototype.getCMenuDS=function(t,i){var r={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","NotContains","","CustomFilter"]};r.date=r.number,r.datetime=r.number,r.dateonly=r.number;for(var n=[],a=0;a<r[""+t].length;a++)r[""+t][parseInt(a.toString(),10)].length?i?n.push({text:this.getLocalizedLabel(r[""+t][parseInt(a.toString(),10)])+"...",iconCss:"e-icons e-icon-check "+(i===r[""+t][parseInt(a.toString(),10)].toLowerCase()?"":"e-emptyicon")}):n.push({text:this.getLocalizedLabel(r[""+t][parseInt(a.toString(),10)])+"..."}):n.push({separator:!0});return n},e.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),s.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var t=this.menuObj.element.querySelector("li.e-focused");t&&Br(t,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},e.prototype.createMenu=function(t,i,r,n){var a={string:"TextFilter",date:"DateFilter",dateonly:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"};this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),this.parent.cssClass&&this.menu.classList.add(this.parent.cssClass);var o=this.parent.createElement("ul"),l=i?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&this.parent.getModuleName()==="grid"&&!this.options.isResponsiveFilter){var h=this.parent.getColumnHeaderByUid(n.uid).getAttribute("aria-sort"),u=this.parent.getColumnByField(n.field).allowSorting,c=!u||h==="ascending"?"e-disabled e-excel-ascending":"e-excel-ascending",d=!u||h==="descending"?"e-disabled e-excel-descending":"e-excel-descending",p=t==="string"?this.getLocalizedLabel("SortAtoZ"):t==="datetime"||t==="date"?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),f=t==="string"?this.getLocalizedLabel("SortZtoA"):t==="datetime"||t==="date"?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");o.appendChild(this.createMenuElem(p,c,"e-sortascending")),o.appendChild(this.createMenuElem(f,d,"e-sortdescending"));var v=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});o.appendChild(v)}this.options.isResponsiveFilter||o.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),i?"":"e-disabled",l)),t!=="boolean"&&o.appendChild(this.createMenuElem(this.getLocalizedLabel(a[""+t]),"e-submenu",r&&this.ensureTextFilter()?"e-icon-check":l+" e-emptyicon",!0)),this.menu.appendChild(o),this.parent.notify(BM,{element:this.menu}),this.parent.notify(l8,{isFiltered:i})},e.prototype.createMenuElem=function(t,i,r,n){var a=this.parent.createElement("li",{className:i+" e-menu-item"});return a.innerHTML=t,a.tabIndex=a.classList.contains("e-disabled")?-1:0,a.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r,attrs:{"aria-hidden":"true"}}),a.firstChild),n&&a.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),a},e.prototype.wireExEvents=function(){I.add(this.dlg,"mouseover",this.hoverHandler,this),I.add(this.dlg,"click",this.clickExHandler,this),I.add(this.dlg,"keyup",this.keyUp,this),I.add(this.dlg,"keydown",this.keyDown,this)},e.prototype.unwireExEvents=function(){I.remove(this.dlg,"mouseover",this.hoverHandler),I.remove(this.dlg,"click",this.clickExHandler),I.remove(this.dlg,"keyup",this.keyUp),I.remove(this.dlg,"keydown",this.keyDown)},e.prototype.clickExHandler=function(t){var i={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},r=Br(t.target,"e-menu-item");r&&(this.getLocalizedLabel("ClearFilter")===r.innerText.trim()?(this.clearFilter(),this.closeDialog()):this.options.isResponsiveFilter&&this.getLocalizedLabel(i[this.options.type])===r.innerText.trim()&&this.hoverHandler(t))},e.prototype.focusNextOrPrevElement=function(t,i,r){var n=t.key==="ArrowUp"||t.key==="Tab"&&t.shiftKey?i.indexOf(document.activeElement)-1:i.indexOf(document.activeElement)+1,a=i[(n+i.length)%i.length];if(a){a.focus();var o=a.classList.contains("e-chk-hidden")?"e-chkfocus":r,l=a.classList.contains("e-chk-hidden")?Br(a,"e-ftrchk"):Br(a,"e-menu-item");this.excelSetFocus(l,o)}},e.prototype.keyUp=function(t){if(t.key==="Tab"&&t.shiftKey||t.key==="Tab"){var i=t.target.classList.contains("e-chk-hidden")?"e-chkfocus":"e-menufocus",r=t.target.classList.contains("e-menu-item")?Br(t.target,"e-menu-item"):Br(t.target,"e-ftrchk");this.excelSetFocus(r,i)}else if(t.key==="ArrowUp"||t.key==="ArrowDown"){t.preventDefault();var n=Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(t,n,"e-menufocus")}else(t.key==="Enter"||t.code==="ArrowRight")&&t.target.classList.contains("e-menu-item")&&(t.preventDefault(),t.target.click(),t.target.classList.contains("e-submenu")&&(this.hoverHandler(t),this.menuObj.element.querySelector(".e-menu-item").focus(),this.excelSetFocus(Br(this.menuObj.element.querySelector(".e-menu-item"),"e-menu-item"),"e-focused"),this.focusedMenuItem=this.menuObj.element.querySelector(".e-menu-item")))},e.prototype.keyDown=function(t){(t.key==="ArrowUp"||t.key==="ArrowDown")&&t.preventDefault()},e.prototype.excelSetFocus=function(t,i){var r=document.querySelector("."+i);r&&r.classList.remove(i),t&&t.classList.add(i)},e.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),I.remove(this.menuObj.element,"keydown",this.contextKeyDownHandler),pt(this.cmenu),this.parent.notify(_k,{target:null,header:"",isOpen:!1,col:this.options.column}))},e.prototype.hoverHandler=function(t){if(!(this.options.isResponsiveFilter&&t.type==="mouseover")){var i=t.target.querySelector(".e-contextmenu"),r=Br(t.target,"e-menu-item"),n=this.menu.querySelector(".e-focused"),a;if(n&&n.classList.remove("e-focused"),r&&(r.classList.add("e-focused"),a=r.classList.contains("e-submenu")),!i){if(!a){var o=this.menu.querySelector(".e-submenu");m(o)||o.classList.remove("e-selected"),this.destroyCMenu()}var l=this.ensureTextFilter();if(!this.isCMenuOpen&&a){r.classList.add("e-selected"),this.isCMenuOpen=!0;var h={items:this.getCMenuDS(this.options.type,l?l.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,animationSettings:{effect:"None"},beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""};this.parent.element.appendChild(this.cmenu),this.menuObj=new Wz(h,this.cmenu),I.add(this.menuObj.element,"keydown",this.contextKeyDownHandler,this);var u=this.menu.querySelector(".e-submenu").getBoundingClientRect(),c={top:0,left:0};if(this.options.isResponsiveFilter){var d={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},p=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),f=p.offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+f+"px)",this.menuObj.open(f,0,document.body);var v=this.getLocalizedLabel(d[this.options.type]);this.parent.notify(_k,{target:this.menuObj.element.parentElement,header:v,isOpen:!0})}else{if(B.isDevice){this.isDevice=!0;var g=this.getContextBounds();c.top=(window.innerHeight-g.height)/2,c.left=(window.innerWidth-g.width)/2,this.closeDialog(),this.isDevice=!1}else c.top=B.isIE?window.pageYOffset+u.top:window.scrollY+u.top,c.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(c.top,c.left,t.target)}Qk(this.parent.element,this.menuObj.element.parentElement)}}}},e.prototype.contextKeyDownHandler=function(t){if(t.key==="Tab"&&t.shiftKey||t.key==="Tab"){t.preventDefault();var i=Array.from(this.menuObj.element.querySelectorAll('[tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(t,i,"e-focused")}else(t.key==="ArrowLeft"||t.key==="Escape")&&(t.preventDefault(),this.menuObj.close(),this.focusedMenuItem=null,document.querySelector(".e-submenu.e-menu-item").classList.remove("e-selected"),document.querySelector(".e-submenu.e-menu-item").focus())},e.prototype.ensureTextFilter=function(){var t,i=this.existingPredicate[this.options.field];return i&&i.length===2?i[0].operator==="greaterthanorequal"&&i[1].operator==="lessthanorequal"?t="between":t="customfilter":i&&i.length===1&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],t=i[0].operator),t},e.prototype.preventClose=function(t){if(this.options&&this.options.isResponsiveFilter&&t.event){var i=t.event.target,r=i.classList.contains("e-resfilterback")||i.classList.contains("e-res-back-btn")||i.classList.contains("e-menu-item");t.cancel=!r}else t.event instanceof MouseEvent&&t.event.target.classList.contains("e-submenu")&&(t.cancel=!0)},e.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},e.prototype.getCMenuYPosition=function(t){var i=this.getContextBounds().width,r=t.getBoundingClientRect(),n=r.right+i-this.parent.element.clientWidth,a=t.offsetWidth-t.clientWidth;return a=a?a+1:0,n<1?r.right+1-a:r.left-i-1+a},e.prototype.openDialog=function(t){var i=this;if(this.updateModel(t),this.getAndSetChkElem(t),this.showDialog(t),!t.cancel){this.dialogObj.dataBind();var r=this.existingPredicate[t.field]&&this.existingPredicate[t.field].length||this.options.filteredColumns.filter(function(n){return i.options.field===n.field}).length;this.createMenu(t.type,r>0,r===1||r===2,t),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),t.column.showColumnMenu&&this.parent.notify(O0,{}),this.wireExEvents()}},e.prototype.closeDialog=function(){this.destroy()},e.prototype.selectHandler=function(t){t.item&&(this.parent.notify(VM,{}),this.menuItem=t.item,this.closeDialog(),this.renderDialogue(t))},e.prototype.renderDialogue=function(t){var i=this,r=t?t.element:void 0,n=this.options.field,a=!m(n)&&Io(n),o=!m(n)&&ul(n),l=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:a?o+"-xlflmenu":n+"-xlflmenu"});if(this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:a?o+"-xlfldlg":n+"-xlfldlg"}),this.options.isResponsiveFilter){var h=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv");h.appendChild(this.dlgDiv)}else this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new Tv({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,locale:this.parent.locale,closeOnEscape:!0,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){for(var c=[].slice.call(i.dlgObj.element.querySelectorAll("table.e-xlfl-table tr.e-xlfl-fields")),d=0;d<c.length;d++){var p=c[d].children[1].querySelector(".e-control"),f=c[d].querySelector(".e-dropdownlist.e-control").ej2_instances[0];f.value==="isempty"||f.value==="isnotempty"||f.value==="isnull"||f.value==="isnotnull"?p.ej2_instances[0].enabled=!1:p&&!m(p.getAttribute("disabled"))&&(p.ej2_instances[0].enabled=!0)}var v=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");if(i.options.column.filterTemplate){var g=Io(i.options.column.field)?ul(i.options.column.field):i.options.column.field,b=i.parent.isReact&&typeof i.options.column.filterTemplate!="string",y=i.parent.parentDetails&&i.parent.parentDetails.parentInstObj&&i.parent.parentDetails.parentInstObj.isReact;b||y?i.parent.renderTemplates(function(){v.querySelector("#"+g+"-xlfl-frstvalue").focus()}):v.querySelector("#"+g+"-xlfl-frstvalue").focus()}},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,r,n),buttons:[{click:this.filterBtnClick.bind(this,n),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:l,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});var u="isStringTemplate";this.dlgObj[""+u]=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.push(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},e.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var t=document.querySelector(".e-row-responsive-filter");t&&t.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},e.prototype.removeDialog=function(){this.parent.notify(h8,{}),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&e2(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),pt(this.dlgDiv),this.parent.notify(Lh,{})},e.prototype.createdDialog=function(t,i){if(this.renderCustomFilter(t,i),this.dlgObj.element.style.left="0px",!this.options.isResponsiveFilter)this.dlgObj.element.style.top="0px";else{var r=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),n=r.offsetHeight+4;this.dlgObj.element.style.top=n+"px"}!this.options.isResponsiveFilter&&B.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify(s8,{column:i,dialog:this.dialogObj}),this.dlgObj.show(),Qk(this.parent.element,this.dlgObj.element.parentElement)},e.prototype.renderCustomFilter=function(t,i){var r=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),n=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});r.appendChild(n);var a=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});r.appendChild(a),this.renderFilterUI(i,r)},e.prototype.filterBtnClick=function(t){var i=!m(t)&&Io(t),r=!m(t)&&ul(t),n=i?r:t,a=this.dlgDiv.querySelector("#"+n+"-xlfl-frstvalue").ej2_instances[0],o=this.dlgDiv.querySelector("#"+n+"-xlfl-frstoptr").ej2_instances[0],l=this.dlgDiv.querySelector("#"+n+"-xlfl-secndvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+n+"-xlfl-secndoptr").ej2_instances[0],u;if(this.options.type==="string"){var c=this.dlgDiv.querySelector("#"+n+"-xlflmtcase").ej2_instances[0];u=c.checked}var d=this.dlgDiv.querySelector("#"+n+"e-xlfl-frstpredicate").ej2_instances[0],p=d.checked?"and":"or";l.value===null&&(p="or"),this.filterByColumn(this.options.field,o.value,a.value,p,u,this.options.ignoreAccent,h.value,l.value),this.removeDialog()},e.prototype.filterByColumn=function(t,i,r,n,a,o,l,h){var u=this.parent.getColumnByField?this.parent.getColumnByField(t):this.options.column,c=this.isForeignColumn(u)?u.foreignKeyValue:t,d=[],p,f={instance:this,handler:this.filterByColumn,arg1:t,arg2:i,arg3:r,arg4:n,arg5:a,arg6:o,arg7:l,arg8:h,cancel:!1};if(this.parent.notify(hv,f),!f.cancel){d.push({field:c,predicate:n,matchCase:a,ignoreAccent:o,operator:i,value:f.arg3,type:this.options.type}),p=new It(c,i.toLowerCase(),f.arg3,!a,o),!m(h)&&!m(l)&&(d.push({field:c,predicate:n,matchCase:a,ignoreAccent:o,operator:l,value:f.arg8,type:this.options.type}),p=p[""+n](c,l.toLowerCase(),h,!a,o));var v={action:"filtering",filterCollection:d,field:this.options.field,ejpredicate:p,actualPredicate:d};this.isForeignColumn(u)?this.foreignKeyFilter(v,d,p):this.options.handler(v)}},e.prototype.renderOperatorUI=function(t,i,r,n,a){var o=this.parent.createElement("tr",{className:"e-xlfl-fields",attrs:{role:"row"}});i.appendChild(o);var l=this.parent.createElement("td",{className:"e-xlfl-optr"});o.appendChild(l);var h=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),u=!m(t)&&Io(t),c=!m(t)&&ul(t),d=this.parent.createElement("input",{id:u?c+r:t+r});h.appendChild(d),l.appendChild(h);var p=this.options.type+"Operator",f=this.customFilterOperators[""+p];this.optrData=f;var v=this.dropSelectedVal(this.options.column,n,a),g="";this.menuItem&&(g=this.menuItem.text.slice(0,-3),g!==this.getLocalizedLabel("CustomFilter")&&(v=a?g:void 0),g===this.getLocalizedLabel("Between")&&(v=this.getLocalizedLabel(a?"GreaterThanOrEqual":"LessThanOrEqual")));var b=this.options.column,y=new Na(Sp({dataSource:f,fields:{text:"text",value:"value"},text:v,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},b.filter.params));this.childRefs.push(y);var C={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};$k(d.id,[Gm,$m],C,this),y.addEventListener(Gm,this.eventHandlers[d.id][Gm]),y.addEventListener($m,this.eventHandlers[d.id][$m]),y.appendTo(d);var x=this.getSelectedValue(v);return{fieldElement:o,operator:x}},e.prototype.removeHandlersFromComponent=function(t){t.element.classList.contains("e-dropdownlist")?Xk(t,[Gm,$m],this):t.element.classList.contains("e-autocomplete")&&Xk(t,[Qm,Xm],this)},e.prototype.dropDownOpen=function(t){t.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},e.prototype.dropDownValueChange=function(t){t.element.id.includes("-xlfl-frstoptr")?this.firstOperator=t.value.toString():this.secondOperator=t.value.toString();var i=t.element.closest(".e-xlfl-fields").children[1].querySelector(".e-control"),r=t.element.ej2_instances[0];r.value==="isempty"||r.value==="isnotempty"||r.value==="isnull"||r.value==="isnotnull"?i.ej2_instances[0].enabled=!1:m(i.getAttribute("disabled"))||(i.ej2_instances[0].enabled=!0)},e.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},e.prototype.getSelectedValue=function(t){var i=new ge(this.optrData).executeLocal(new $e().where("text","equal",t));return m(i[0])?"":i[0].value},e.prototype.dropSelectedVal=function(t,i,r){var n;return i&&i.length>0?n=i.length===2?r?i[0].operator:i[1].operator:r?i[0].operator:void 0:r&&t.type==="string"&&!t.filter.operator?n="startswith":n=r?t.filter.operator||"equal":void 0,this.getSelectedText(n)},e.prototype.getSelectedText=function(t){var i=new ge(this.optrData).executeLocal(new $e().where("value","equal",t));return m(i[0])?"":i[0].text},e.prototype.renderFilterUI=function(t,i){var r=this.existingPredicate[""+t],n=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}});i.appendChild(n);var a=this.parent.createElement(p8);a.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',n.appendChild(a);var o=this.renderOperatorUI(t,n,"-xlfl-frstoptr",r,!0);this.firstOperator=o.operator,this.renderFlValueUI(t,o,"-xlfl-frstvalue",r,!0);var l=this.parent.createElement("tr",{className:"e-xlfl-predicate",attrs:{role:"row"}});n.appendChild(l),this.renderRadioButton(t,l,r),o=this.renderOperatorUI(t,n,"-xlfl-secndoptr",r,!1),this.secondOperator=o.operator,this.renderFlValueUI(t,o,"-xlfl-secndvalue",r,!1)},e.prototype.renderRadioButton=function(t,i,r){var n=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});i.appendChild(n);var a=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),o=!m(t)&&Io(t),l=!m(t)&&ul(t),h=this.parent.createElement("input",{id:o?l+"e-xlfl-frstpredicate":t+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),u=this.parent.createElement("input",{id:o?l+"e-xlfl-secndpredicate":t+"e-xlfl-secndpredicate",attrs:{type:"radio"}});a.appendChild(h),a.appendChild(u),n.appendChild(a),this.options.type==="string"&&this.renderMatchCase(t,i,n,"-xlflmtcase",r);var c=new E0({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(c);var d=new E0({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(d);var p=r&&r.length===2?r[1].predicate:"and";p==="and"?(c.checked=!0,d.checked=!1):(d.checked=!0,c.checked=!1),c.appendTo(h),d.appendTo(u),c.element.nextElementSibling.classList.add("e-xlfl-radio-and"),d.element.nextElementSibling.classList.add("e-xlfl-radio-or")},e.prototype.removeObjects=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n&&!n.isDestroyed&&(this.removeHandlersFromComponent(n),n.destroy())}},e.prototype.renderFlValueUI=function(t,i,r,n,a){var o=this.parent.createElement("td",{className:"e-xlfl-value"});i.fieldElement.appendChild(o);var l=!m(t)&&Io(t),h=!m(t)&&ul(t),u=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),c=this.options.filteredColumns.some(function(E){return t===E.field}),d=this.options.filteredColumns.filter(function(E){return E.field===t});if(this.options.column.filterTemplate){var p={},f=this.options.column;c&&r&&(p=this.getExcelFilterData(r,p,f,n,d));var v=this.parent.isReact&&typeof this.options.column.filterTemplate!="string",g=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,b=this.parent.element.id+f.uid+"filterTemplate";if(v||g)this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",b,null,null,u);else{var y=this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",b);sc(u,y)}v||g?this.parent.renderTemplates(function(){u.querySelector("input").id=l?h+r:t+r,o.appendChild(u)}):((this.parent.isAngular?u.children[0]:u.querySelector("input")).id=l?h+r:t+r,o.appendChild(u))}else{var C=this.parent.createElement("input",{id:l?h+r:t+r});u.appendChild(C),o.appendChild(u);var x=void 0,w=void 0;n&&n.length>0&&(w=n.length===2?a?n[0]:n[1]:a?n[0]:void 0,x=w&&w.operator===i.operator?w.value:void 0,m(x)&&(x=void 0));var M={string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),dateonly:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)};M[this.options.type](this.options,t,C,x,this.parent.enableRtl)}},e.prototype.getExcelFilterData=function(t,i,r,n,a){var o=t==="-xlfl-frstvalue"?0:1;if(t==="-xlfl-frstvalue"||a.length>1){i={column:n instanceof Array?n[parseInt(o.toString(),10)]:n};var l=this.options.column.columnData&&a.length>1?this.options.column.columnData.length===1?0:1:o;i[this.options.field]=r.foreignKeyValue?this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue]:a[parseInt(l.toString(),10)].value,this.options.foreignKeyValue&&(i[this.options.foreignKeyValue]=this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue])}return i},e.prototype.renderMatchCase=function(t,i,r,n,a){var o=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),l=!m(t)&&Io(t),h=!m(t)&&ul(t),u=this.parent.createElement("input",{id:l?h+n:t+n,attrs:{type:"checkbox"}});o.appendChild(u),r.appendChild(o);var c=a&&a.length>0?a&&a.length===2?a[1].matchCase:a[0].matchCase:!1,d=new Vo({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:c,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(d),d.appendTo(u)},e.prototype.renderDate=function(t,i,r,n,a){var o=Yk(t.format,t.type)||t.format,l=new r2(Sp({format:o,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:a,value:new Date(n),locale:this.parent.locale},t.column.filter.params));this.childRefs.push(l),l.appendTo(r)},e.prototype.renderDateTime=function(t,i,r,n,a){var o=Yk(t.format,t.type),l=new MQ(Sp({format:o,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:a,value:new Date(n),locale:this.parent.locale},t.column.filter.params));this.childRefs.push(l),l.appendTo(r)},e.prototype.completeAction=function(t){t.result=m8(t.result)},e.prototype.renderNumericTextBox=function(t,i,r,n,a){var o=new to(Sp({format:t.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:a,value:n,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},t.column.filter.params));this.childRefs.push(o),o.appendTo(r)},e.prototype.renderAutoComplete=function(t,i,r,n,a){var o=this.options.column,l=this.isForeignColumn(o),h=l?o.dataSource:t.dataSource,u={value:l?o.foreignKeyValue:i},c=new Kz(Sp({dataSource:h instanceof ge?h:new ge(h),fields:u,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:a,text:n},o.filter.params));if(h&&"result"in h){var d=Jz({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger(Zz,d.state);var p=d.deffered;p.promise.then(function(v){c.dataSource=new ge(v)})}this.childRefs.push(c);var f={actionComplete:this.acActionComplete(c,i),focus:this.acFocus(c,i,t,r)};$k(r.id,[Qm,Xm],f,this),c.addEventListener(Xm,this.eventHandlers[r.id][Xm]),c.addEventListener(Qm,this.eventHandlers[r.id][Qm]),c.appendTo(r)},e.prototype.acActionComplete=function(t,i){return function(r){var n=!m(i)&&Io(i);r.result=r.result.filter(function(a,o,l){return l.map(function(h){return n?Gk(t.fields.value,h):h[t.fields.value]}).indexOf(n?Gk(t.fields.value,a):a[t.fields.value])===o})}},e.prototype.acFocus=function(t,i,r,n){var a=this;return function(){var o=!m(i)&&Io(i),l=!m(i)&&ul(i),h=o?l:i;t.filterType=a.dlgDiv.querySelector("#"+h+(n.id===h+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,t.ignoreCase=r.type==="string"?!a.dlgDiv.querySelector("#"+h+"-xlflmtcase").ej2_instances[0].checked:!0,t.filterType=m(t.filterType)?"equal":t.filterType}},e}(t2),TQ=function(){function s(e){this.parent=e,this.filterCollection=new Map,this.filterRange=new Map,this.filterBtn=e.createElement("div",{className:"e-filter-btn e-control e-btn e-lib e-filter-iconbtn e-icon-btn"}),this.filterBtn.appendChild(e.createElement("span",{className:"e-btn-icon e-icons e-filter-icon"})),this.addEventListener()}return s.prototype.destroy=function(){this.removeEventListener(),this.filterRange=null,this.filterCollection=null,this.filterBtn=null,this.parent=null},s.prototype.addEventListener=function(){this.parent.on(NA,this.filterRangeAlertHandler,this),this.parent.on(so,this.initiateFilterUIHandler,this),this.parent.on(Qo,this.filterMouseDownHandler,this),this.parent.on(Kp,this.renderFilterCellHandler,this),this.parent.on(BM,this.beforeFilterMenuOpenHandler,this),this.parent.on(VM,this.closeDialog,this),this.parent.on(i0,this.reapplyFilterHandler,this),this.parent.on($1,this.filterByCellValueHandler,this),this.parent.on(Kf,this.clearFilterHandler,this),this.parent.on(r0,this.getFilteredColumnHandler,this),this.parent.on(uu,this.cMenuBeforeOpenHandler,this),this.parent.on(HM,this.filterCboxValueHandler,this),this.parent.on(xd,this.getFilterRangeHandler,this),this.parent.on(n0,this.filterCellKeyDownHandler,this),this.parent.on(Qp,this.getFilteredCollection,this),this.parent.on(tn,this.updateFilter,this),this.parent.on(LA,this.updateFilter,this),this.parent.on(Hf,this.beforeInsertHandler,this),this.parent.on(Vf,this.beforeDeleteHandler,this),this.parent.on(Jl,this.deleteSheetHandler,this),this.parent.on(md,this.clearHandler,this),this.parent.on(O0,this.filterDialogCreatedHandler,this),this.parent.on(Lh,this.removeFilterClass,this),this.parent.on(g1,this.duplicateSheetFilterHandler,this),this.parent.on(hv,this.beforeFilteringHandler,this)},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(NA,this.filterRangeAlertHandler),this.parent.off(so,this.initiateFilterUIHandler),this.parent.off(Qo,this.filterMouseDownHandler),this.parent.off(Kp,this.renderFilterCellHandler),this.parent.off(BM,this.beforeFilterMenuOpenHandler),this.parent.off(VM,this.closeDialog),this.parent.off(i0,this.reapplyFilterHandler),this.parent.off($1,this.filterByCellValueHandler),this.parent.off(Kf,this.clearFilterHandler),this.parent.off(r0,this.getFilteredColumnHandler),this.parent.off(uu,this.cMenuBeforeOpenHandler),this.parent.on(HM,this.filterCboxValueHandler),this.parent.off(xd,this.getFilterRangeHandler),this.parent.off(n0,this.filterCellKeyDownHandler),this.parent.off(Qp,this.getFilteredCollection),this.parent.off(tn,this.updateFilter),this.parent.off(LA,this.updateFilter),this.parent.off(Hf,this.beforeInsertHandler),this.parent.off(Vf,this.beforeDeleteHandler),this.parent.off(Jl,this.deleteSheetHandler),this.parent.off(md,this.clearHandler),this.parent.off(O0,this.filterDialogCreatedHandler),this.parent.off(Lh,this.removeFilterClass),this.parent.off(g1,this.duplicateSheetFilterHandler),this.parent.off(hv,this.beforeFilteringHandler))},s.prototype.getModuleName=function(){return"filter"},s.prototype.isInValidFilterRange=function(e,t){var i=lt(ir(t||e.selectedRange)),r=!1;return e.usedRange.colIndex===0&&e.usedRange.rowIndex===0&&m(e.rows[e.usedRange.rowIndex])&&(r=!0),i[0]>e.usedRange.rowIndex||i[1]>e.usedRange.colIndex||r},s.prototype.filterRangeAlertHandler=function(e){var t=this,i=this.parent.serviceLocator.getService(At);i.show({content:e.error,isModal:!0,height:180,width:400,showCloseIcon:!0,beforeOpen:function(r){var n={dialogName:"FilterRangeDialog",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:Fe(t.parent.element)}}),this.parent.hideSpinner()},s.prototype.beforeFilterMenuOpenHandler=function(e){var t=this.parent.serviceLocator.getService(de);e.element.classList.add("e-spreadsheet-contextmenu");var i=e.element.querySelector("ul");this.addMenuItem(i,t.getConstant("SortDescending"),"e-filter-sortdesc","e-sort-desc"),this.addMenuItem(i,t.getConstant("SortAscending"),"e-filter-sortasc","e-sort-asc"),e.element.appendChild(i)},s.prototype.addMenuItem=function(e,t,i,r){var n=this.parent.createElement("li",{className:i+" e-menu-item"});n.innerText=t,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r}),n.firstChild),e.insertBefore(n,e.firstChild)},s.prototype.initiateFilterUIHandler=function(e){var t=this,i=e?e.predicates:null,r=e.sIdx;!r&&r!==0&&(r=this.parent.activeSheetIndex);var n;e.promise&&(n=new xa,e.promise=n.promise);var a=function(){n&&n.resolve()},o=e.isInternal||e.isCut;if(this.filterRange.size>0&&this.filterRange.has(r)&&!this.parent.isOpen&&!i){this.removeFilter(r,o,!1),a();return}var l=Pe(this.parent,r);if(this.isInValidFilterRange(l,e.range)){var h=this.parent.serviceLocator.getService(de);this.filterRangeAlertHandler({error:h.getConstant("FilterOutOfRangeError")}),a();return}var u=e.range||l.selectedRange,c,d;if(!o){if(c={range:u,sheetIndex:r,cancel:!1},e.predicates?(c.predicates=e.predicates,c.previousPredicates=this.filterCollection.get(r)&&[].slice.call(this.filterCollection.get(r))):c.filterOptions={predicates:e.predicates},c.useFilterRange=!1,d={action:"filter",eventArgs:c},this.parent.notify(li,d),c.cancel){a();return}delete c.cancel,e.useFilterRange=c.useFilterRange}if(!e.range&&(o||u===c.range)){var p=ee(u);p[0]===p[2]&&p[1]===p[3]&&(p=iz(p[0],p[1],l),u=je(p),o||(c.range=u))}else o||(u=c.range);if(i)if(i.length){var f=this.filterRange.get(r);f&&(e.useFilterRange=f.useFilterRange),this.processRange(l,r,u,!0,e.useFilterRange);var v=this.filterRange.get(r).range.slice();v[0]=v[0]+1,e.useFilterRange||(v[2]=l.usedRange.rowIndex),v[1]=v[3]=Rn(i[0].field);var g=l.name+"!"+this.getPredicateRange(v,i.slice(1,i.length)),b=je(v);$s(this.parent,g,!0,!0,null,!0,null,null,!1,b).then(function(y){t.filterSuccessHandler(new ge(y),{action:"filtering",filterCollection:i,field:i[0].field,sIdx:e.sIdx,isInternal:o,prevPredicates:c&&c.previousPredicates}),a()});return}else this.clearFilterHandler({sheetIndex:r}),a();else this.processRange(l,r,u,!1,e.useFilterRange),a();o||(this.parent.notify(yt,d),Fe(this.parent.element))},s.prototype.processRange=function(e,t,i,r,n){var a=lt(ir(i||e.selectedRange));a[0]===a[2]&&a[1]===a[3]?(a[0]=0,a[1]=0,a[2]=e.usedRange.rowIndex,a[3]=e.usedRange.colIndex):a[3]>e.usedRange.colIndex&&(a[3]=e.usedRange.colIndex),this.filterRange.set(t,{useFilterRange:n,range:a}),this.filterCollection.set(t,[]),r||this.refreshFilterRange(a,!1,t)},s.prototype.removeFilter=function(e,t,i){var r=this.filterRange.get(e).range.slice(),n=je(r),a;if(!t){if(a={action:"filter",eventArgs:{range:n,sheetIndex:e,cancel:!1}},this.parent.notify(li,a),a.eventArgs.cancel)return;delete a.eventArgs.cancel}if((this.filterCollection.get(e).length||i)&&this.clearFilterHandler({preventRefresh:i,sheetIndex:e}),this.filterRange.delete(e),this.filterCollection.delete(e),this.refreshFilterRange(r,!0,e),this.parent.filterCollection)for(var o=0,l=void 0,h=0,u=this.parent.filterCollection.length;h<u;h++)l=this.parent.filterCollection[o],l.sheetIndex===e&&l.filterRange===n?this.parent.filterCollection.splice(o,1):o++;t||this.parent.notify(yt,a)},s.prototype.filterByCellValueHandler=function(){var e=this,t=this.parent.activeSheetIndex,i=this.parent.getActiveSheet();if(this.isInValidFilterRange(i)){var r=this.parent.serviceLocator.getService(de);this.filterRangeAlertHandler({error:r.getConstant("FilterOutOfRangeError")});return}var n=ee(i.activeCell);this.isFilterRange(t,n[0],n[1])||this.processRange(i,t);var a=this.filterRange.get(t).range.slice();a[0]=a[0]+1,a[2]=i.usedRange.rowIndex,a[1]=a[3]=n[1];var o=Ur(n[1]+1),l=Y(n[0],n[1],i),h=M1(this.parent,l,n[0],n[1]);He(h)&&!(l.format&&l.format==="@")&&(h=parseFloat(h));var u=[{field:o,operator:"equal",type:this.getColumnType(i,n[1],n).type,matchCase:!1,value:h}],c=i.name+"!"+this.getPredicateRange(a,this.filterCollection.get(t)),d=je(a);$s(this.parent,c,!0,!0,null,!0,null,null,!1,d).then(function(p){e.filterSuccessHandler(new ge(p),{action:"filtering",filterCollection:u,field:o,isFilterByValue:!0})})},s.prototype.renderFilterCellHandler=function(e){var t=m(e.sIdx)?this.parent.activeSheetIndex:e.sIdx;if(t===this.parent.activeSheetIndex&&this.isFilterCell(t,e.rowIndex,e.colIndex)){if(!e.td)return;var i=e.td.querySelector(".e-filter-icon");i?i.className="e-btn-icon e-icons e-filter-icon"+this.getFilterSortClassName(e.colIndex,t):(i=this.filterBtn.cloneNode(!0),i.firstElementChild.className+=this.getFilterSortClassName(e.colIndex,t),e.td.insertBefore(i,e.td.firstChild))}},s.prototype.getFilterSortClassName=function(e,t){for(var i=Ur(e+1),r="",n=this.filterCollection.get(t),a=this.parent.sortCollection,o=0;o<n.length;o++)if(n[o].field===i){r=" e-filtered";break}if(a){for(var o=0;o<a.length;o++)if(a[o].sheetIndex===t&&a[o].columnIndex===e){r+=a[o].order==="Ascending"?" e-sortasc-filter":" e-sortdesc-filter";break}}return r},s.prototype.refreshFilterRange=function(e,t,i){var r=i;!r&&r!==0&&(r=this.parent.activeSheetIndex),!e&&!this.filterRange.get(r)&&(e=[0,0,0,0]);for(var n=e||this.filterRange.get(r).range.slice(),a=n[1];a<=n[3];a++){var o=this.parent.getCell(n[0],a);if(t){if(o&&o.hasChildNodes()){var l=o.querySelector(".e-filter-btn");l&&l.parentElement.removeChild(l)}}else this.renderFilterCellHandler({td:o,rowIndex:n[0],colIndex:a,sIdx:r})}this.parent.sortCollection&&this.parent.notify(Ey,null)},s.prototype.isFilterCell=function(e,t,i){var r=this.filterRange.get(e)&&this.filterRange.get(e).range;return r&&r[0]===t&&r[1]<=i&&r[3]>=i},s.prototype.isFilterRange=function(e,t,i){var r=this.filterRange.get(e)&&this.filterRange.get(e).range;return r&&r[0]<=t&&r[2]>=t&&r[1]<=i&&r[3]>=i},s.prototype.getFilteredColumnHandler=function(e){var t=Re(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=this.parent.serviceLocator.getService(de);if(e.clearFilterText=i.getConstant("ClearFilter"),this.filterRange.has(t)){var r=this.filterCollection.get(t);if(e.isClearAll){e.isFiltered=r&&r.length>0;return}var n=this.filterRange.get(t).range.slice(),a=Pe(this.parent,t),o=xe(a.activeCell);if(this.isFilterRange(t,o[0],o[1])){e.field=Ur(o[1]+1);var l=Y(n[0],o[1],a),h=this.parent.getDisplayText(l);e.clearFilterText=i.getConstant("ClearFilterFrom")+'"'+(h?h.toString():"Column "+e.field)+'"',r.some(function(u){return e.isFiltered=u.field===e.field,e.isFiltered})}}},s.prototype.cMenuBeforeOpenHandler=function(e){var t=this.parent.element.id+"_cmenu";if(e.parentItem&&e.parentItem.id===t+"_filter"&&e.target===""){var i={isFiltered:!1};this.getFilteredColumnHandler(i),this.parent.enableContextMenuItems([t+"_clearfilter",t+"_reapplyfilter"],!!i.isFiltered,!0)}},s.prototype.closeDialog=function(){var e=document.querySelector(".e-filter-popup");if(e&&e.id.includes(this.parent.element.id)){var t=Ct(e,"dialog");I.remove(e,Dd(),this.filterMouseDownHandler),t&&t.hide(),this.parent.notify(Lh,null)}},s.prototype.removeFilterClass=function(){this.parent.element.style.position==="relative"&&(this.parent.element.style.position=""),this.parent.element.classList.contains("e-filter-open")&&this.parent.element.classList.remove("e-filter-open")},s.prototype.isPopupOpened=function(){var e=document.getElementsByClassName("e-filter-popup")[0];return e&&e.id.includes(this.parent.element.id)&&e.style.display!=="none"},s.prototype.filterCellKeyDownHandler=function(e){var t=this.parent.getActiveSheet(),i=xe(t.activeCell);if(this.isFilterCell(this.parent.activeSheetIndex,i[0],i[1])){if(e.closePopup)this.closeDialog();else if(e.isFilterCell=!0,!this.isPopupOpened()){var r=this.parent.getCell(i[0],i[1]);r&&this.openDialog(r)}}},s.prototype.filterMouseDownHandler=function(e){if(!(B.isDevice&&e.type==="mousedown"||this.parent.getActiveSheet().isProtected)){var t=e.target;if(t.classList.contains("e-filter-icon")||t.classList.contains("e-filter-btn"))this.isPopupOpened()&&this.closeDialog(),this.openDialog(Br(t,"e-cell"));else if(this.isPopupOpened()){var i=t.offsetParent;!t.classList.contains("e-searchinput")&&!t.classList.contains("e-searchclear")&&i&&!i.classList.contains("e-filter-popup")&&!i.classList.contains("e-text-content")&&!i.classList.contains("e-checkboxtree")&&!i.classList.contains("e-checkbox-wrapper")?this.closeDialog():this.selectSortItemHandler(t)}}},s.prototype.cboxListSelected=function(e,t,i,r,n){var a=Br(r.target,"e-ftrchk");if(a){var o=n&&a.querySelector(".e-add-current");if(o){o.classList.contains("e-check")?(br(o,["e-uncheck"],["e-check"]),t.length||(e.btnObj.element.disabled=!0)):(br(o,["e-check"],["e-uncheck"]),e.btnObj.element.disabled=!1);return}var l=a.querySelector(".e-selectall");if(l){a.querySelector(".e-chk-hidden").indeterminate=!1;for(var h=a.querySelector(".e-frame").classList.contains("e-check"),u=void 0,c=void 0,d=n?2:1,p=e.element.childElementCount;d<p;d++)u=e.element.children[d].querySelector(".e-frame"),te([u],["e-check","e-stop","e-uncheck"]),h?(e.element.children[d].querySelector(".e-chk-hidden").checked=!1,u.classList.add("e-uncheck"),t.splice(0,1)):(e.element.children[d].querySelector(".e-chk-hidden").checked=!0,u.classList.add("e-check"),c=e.element.children[d].querySelector(".e-checkboxfiltertext").textContent,t.indexOf(c)===-1&&t.push(c))}else{var c=a.querySelector(".e-checkboxfiltertext").textContent;a.querySelector(".e-frame").classList.contains("e-check")?t.splice(t.indexOf(c),1):t.push(c),ac(a),l=e.element.querySelector(".e-selectall")}this.updateState(e,l,l.parentElement.querySelector(".e-chk-hidden"),t.length!==i,t.length)}},s.prototype.initCboxList=function(e,t){var i=this,r=new ge(e.dataSource).executeLocal(new $e().sortBy("value","ascending")),n=[],a=e.column.field,o=this.parent.getActiveSheet(),l=this.parent.serviceLocator.getService(de),h=document.createDocumentFragment(),u=this.createSelectAll(e,t);h.appendChild(u);var c={},d,p=[],f=[],v;r.forEach(function(M){if(M[a]===""){if(!c.isBlank){c.isBlank=!0;var E={};E[e.column.field]=l.getConstant("Blanks"),d=Aa(o,Number(M.__rowIndex)-1);var T=Ml(Oo("cbox"),t.createCheckbox(E[e.column.field],!d,E),"e-ftrchk");h.childElementCount===1?h.appendChild(T):h.insertBefore(T,h.children[1]),n.splice(0,0,E[e.column.field]),d||(p.push(E[e.column.field]),f.push(E[e.column.field]))}}else c[M[a]]||(c[M[a]]=!0,d=Aa(o,Number(M.__rowIndex)-1),v=M[a].toString(),h.appendChild(Ml(Oo("cbox"),t.createCheckbox(v,!d,M),"e-ftrchk")),n.push(v),d||(p.push(v),f.push(v)))}),e.element.appendChild(h);var g=u.querySelector(".e-frame");g.classList.add("e-selectall");var b=u.querySelector(".e-chk-hidden");this.updateState(e,g,b,f.length!==n.length,f.length);var y=[].slice.call(e.element.childNodes),C;e.element.addEventListener("click",function(M){C?i.cboxListSelected(e,C,e.element.childElementCount-2,M,!0):i.cboxListSelected(e,f,n.length,M)});var x=function(M){var E;if(M.event.type==="keyup")E=M.event.target.value.toLowerCase();else if(M.event.target.classList.contains("e-search-icon"))return;var T=document.createDocumentFragment();if(T.appendChild(u),E)if(C=[],n.forEach(function(k){if(k.toLowerCase().includes(E)){var O={};O[e.column.field]=k,T.appendChild(Ml(Oo("cbox"),t.createCheckbox(k,!0,O),"e-ftrchk")),C.push(k)}}),C.length){i.updateState(e,g,b,!1,0),u.classList.remove("e-hide");var A={};A[e.column.field]=l.getConstant("AddCurrentSelection");var L=Ml(Oo("cbox"),t.createCheckbox(A[e.column.field],!1,A),"e-ftrchk");T.insertBefore(L,T.children[1]),L.querySelector(".e-frame").classList.add("e-add-current")}else{u.classList.add("e-hide");var D=i.parent.createElement("div",{className:"e-checkfltrnmdiv"}),N=i.parent.createElement("span");N.innerText=l.getConstant("NoResult"),D.appendChild(N),T.appendChild(D),e.btnObj.element.disabled=!0}else y&&(C=null,i.updateState(e,g,b,f.length!==n.length,f.length),u.classList.remove("e-hide"),y.forEach(function(k){T.appendChild(k)}));e.element.innerHTML="",e.element.appendChild(T)},w=function(){var M=e.element.querySelector(".e-add-current");if(M)if(M.classList.contains("e-check")){var E,T=void 0,D=void 0;f=p;for(var N=2,A=e.element.childElementCount;N<A;N++)E=e.element.children[N],T=E.querySelector(".e-checkboxfiltertext").textContent,E.querySelector(".e-frame").classList.contains("e-check")?f.indexOf(T)===-1&&f.push(T):(D=f.indexOf(T),D>-1&&f.splice(D,1))}else f=C;var L=f.length;if(L===n.length)i.filterSuccessHandler(new ge(e.dataSource),{action:"clear-filter",field:e.column.field});else{var k=[],O={field:a,ignoreAccent:!1,matchCase:!1},R=ad(de,jd),j=Lo(i.parent.locale),P=function(F){var z=e.type;z==="number"&&(F===l.getConstant("Blanks")?(F="",z="string"):He(yb([F],i.parent.locale,R,j)[0])||(z="string")),k.push(Object.assign({value:F,type:z},O))};if(L>n.length/2){O.operator="notequal",O.predicate="and";for(var N=0,A=n.length;N<A;N++)f.indexOf(n[N])===-1&&P(n[N])}else{O.operator="equal",O.predicate="or";for(var N=0,A=L;N<A;N++)P(f[N])}t.initiateFilter(k)}};this.wireFilterEvents(e,w,x.bind(this))},s.prototype.createSelectAll=function(e,t){var i={};i[e.column.field]=this.parent.serviceLocator.getService(de).getConstant("SelectAll");var r=Ml(Oo("cbox"),t.createCheckbox(i[e.column.field],!1,i),"e-ftrchk");return r},s.prototype.updateState=function(e,t,i,r,n){if(te([t],["e-check","e-stop","e-uncheck"]),e.btnObj.element.disabled&&(e.btnObj.element.disabled=!1),r)if(n)t.classList.add("e-stop");else{t.classList.add("e-uncheck");var a=e.element.querySelector(".e-add-current");e.btnObj.element.disabled=!a||!a.classList.contains("e-check")}else t.classList.add("e-check");i.indeterminate=r,i.checked=!r},s.prototype.beforeFilteringHandler=function(e){e.instance&&e.instance.options&&e.instance.options.isFormatted&&(He(e.arg3)&&(e.arg3=e.arg3.toString()),He(e.arg8)&&(e.arg3=e.arg3.toString()))},s.prototype.wireFilterEvents=function(e,t,i){var r=this;e.btnObj.element.addEventListener("click",t.bind(this)),e.searchBox.addEventListener("keydown",function(a){a.keyCode===13&&t()});var n=function(a){r.parent.off(YA,i),r.parent.off(Lh,n),Fe(r.parent.element)};this.parent.on(Lh,n,this),this.parent.on(YA,i,this)},s.prototype.initTreeView=function(e,t){var i=this,r=[],n=[],a={},o=[],l=[],h=[],u=[],c,d,p,f,v,g,b,y=["January","February","March","April","May","June","July","August","September","October","November","December"],C,x=!1,w=this.parent.getActiveSheet(),M=function(R){a[""+g]=!0,Aa(w,Number(R.__rowIndex)-1)?x=!0:r.push(g),n.push(g)};e.dataSource.forEach(function(R){f=R[e.column.field],typeof f=="object"&&Date.parse(f.toString())?(c=f.getFullYear().toString(),a[""+c]||(C={__rowIndex:c,hasChild:!0},C[e.column.field]=c,o.push(C),a[""+c]=!0),b=f.getMonth(),d=y[b],v=c+" "+d,a[""+v]||(C={__rowIndex:v,pId:c,hasChild:!0,month:b},C[e.column.field]=d,l.push(C),a[""+v]=!0),p=f.getDate(),g=v+" "+p.toString(),a[""+g]||(C={__rowIndex:g,pId:v},C[e.column.field]=p,h.push(C),M(R))):(!R[e.column.field]&&R[e.column.field]!==0?(g="blanks",c=i.parent.serviceLocator.getService(de).getConstant("Blanks")):(g="text "+R[e.column.field].toString().toLowerCase(),c=R[e.column.field]),a[""+g]||(C={__rowIndex:g},C[e.column.field]=c,u.push(C),M(R)))}),o=new ge(o).executeLocal(new $e().sortBy(e.column.field,"decending")),l=new ge(l).executeLocal(new $e().sortBy("month","ascending")),h=new ge(h).executeLocal(new $e().sortBy(e.column.field,"ascending")),h=o.concat(l.concat(h)),u.length&&(u=new ge(u).executeLocal(new $e().sortBy(e.column.field,"ascending")),h=h.concat(u));var E=function(R){var j=[R.node];if(R.event.target.classList.contains("e-fullrow")||R.event.key=="Enter"){var P=k.getNode(R.node);P.isChecked==="true"?k.uncheckAll(j):k.checkAll(j)}},T=function(){A.indeterminate=!1,N.classList.contains("e-check")?(k.uncheckAll(),N.classList.add("e-uncheck"),A.checked=!1):(k.checkAll(),N.classList.add("e-check"),A.checked=!0)},D=this.createSelectAll(e,t);D.addEventListener("click",T.bind(this)),D.classList.add("e-spreadsheet-ftrchk");var N=D.querySelector(".e-frame");N.classList.add("e-selectall"),e.element.appendChild(D);var A=D.querySelector(".e-chk-hidden"),L=this.parent.createElement("div"),k=new Yz({fields:{dataSource:h,id:"__rowIndex",parentID:"pId",text:e.column.field,hasChildren:"hasChild"},enableRtl:this.parent.enableRtl,showCheckBox:!0,cssClass:"e-checkboxtree",checkedNodes:r,nodeClicked:E.bind(this),keyPress:E.bind(this),nodeChecked:function(R){R.action!=="indeterminate"&&(x=k.checkedNodes.length!==k.fields.dataSource.length,i.updateState(e,N,A,x,k.checkedNodes.length))}});k.createElement=this.parent.createElement,k.appendTo(L),e.element.appendChild(L),r=k.checkedNodes,this.updateState(e,N,A,x,k.checkedNodes.length);var O=function(){k.checkedNodes.length===h.length?i.filterSuccessHandler(new ge(e.dataSource),{action:"clear-filter",field:e.column.field}):i.generatePredicate(k.checkedNodes,u.length?"string":e.type,e.column.field,t,n,k.checkedNodes.length>h.length/2)};this.wireFilterEvents(e,O,this.refreshCheckbox.bind(this,h,k,r))},s.prototype.generatePredicate=function(e,t,i,r,n,a){var o=[],l,h={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},u,c,d,p,f=function(){u[0]==="blanks"?o.push(Object.assign({value:"",type:t},l)):u[0]==="text"&&(u.splice(0,1),d=u.join(" "),isNaN(Number(d))?p="string":(d=Number(d),p="number"),o.push(Object.assign({value:d,type:p},l)))},v=function(){c=new Date(Number(u[0]),h[u[1]],Number(u[2])),c.getDate()?o.push(Object.assign({value:c,type:t},l)):f()};if(a){l={field:i,ignoreAccent:!1,matchCase:!1,predicate:"and",operator:"notequal"};for(var g=0,b=n.length;g<b;g++)e.indexOf(n[g])===-1&&(u=n[g].split(" "),v())}else{l={field:i,ignoreAccent:!1,matchCase:!1,predicate:"or",operator:"equal"};for(var g=0,b=e.length;g<b;g++)u=e[g].split(" "),u.length===3?v():f()}r.initiateFilter(o)},s.prototype.refreshCheckbox=function(e,t,i,r){var n;if(r.event.type==="keyup")n=r.event.target.value;else if(r.event.target.classList.contains("e-search-icon"))return;var a,o=function(){if(a.length&&!t.fields.dataSource.length){var M=t.element.parentElement;M.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.remove("e-hide"),ne(M.getElementsByClassName("e-checkfltrnmdiv")[0])}t.fields.dataSource=a,t.dataBind()};if(n){a=new ge(e).executeLocal(new $e().where(new It(t.fields.text,"contains",n,!0)));var l={},h=[],u=void 0,c=void 0,d=isNaN(Number(n)),p=void 0,f=void 0;if(d){for(var v=0;v<a.length;v++)a[v].hasChild&&(h.push(new It("pId","equal",a[v].__rowIndex,!1)),u=a[v].pId,l[""+u]||(h.push(new It("__rowIndex","equal",u,!1)),l[""+u]=!0));c=a,f=1}else{var g=void 0,b={};p=[];for(var v=0;v<a.length;v++)u=a[v].pId,u?(g=u.split(" ")[0],l[""+u]||(h.push(new It("__rowIndex","equal",u,!1)),l[""+u]=!0,p.push(g),p.push(u)),b[""+g]||(l[""+g]||(h.push(new It("__rowIndex","equal",g,!1)),l[""+g]=!0),h.push(new It("__rowIndex","equal",a[v].__rowIndex,!1)))):(u=a[v].__rowIndex,b[""+u]||(h.push(new It("__rowIndex","contains",u,!1)),b[""+u]=!0));c=[]}if(a.length){h.length&&(a=c.concat(new ge(e).executeLocal(new $e().where(It.or(h))))),o(),t.checkAll();var y=t.animation.expand.duration;t.animation.expand.duration=0,t.expandAll(p,f),t.animation.expand.duration=y}else if(t.fields.dataSource.length){o();var C=t.element.parentElement;C.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.add("e-hide");var x=this.parent.createElement("div",{className:"e-checkfltrnmdiv"}),w=this.parent.createElement("span");w.innerText=this.parent.serviceLocator.getService(de).getConstant("NoResult"),x.appendChild(w),C.appendChild(x)}}else a=e,o(),t.checkedNodes=i,t.dataBind()},s.prototype.openDialog=function(e){var t=this,i=parseInt(e.getAttribute("aria-colindex"),10),r=Ur(i);this.parent.showSpinner();var n=this.parent.activeSheetIndex,a=this.filterRange.get(n),o=a.range.slice(),l=this.parent.getActiveSheet(),h=Y(o[0],i-1,l),u=this.parent.getDisplayText(h);o[0]=o[0]+1,a.useFilterRange||(o[2]=l.usedRange.rowIndex);var c=[o[0],i-1,o[2],i-1],d=this.getPredicateRange(c,this.filterCollection.get(n),i-1),p=d.otherColPredicate,f;d.curPredicate.length&&(f={},f[r]=d.curPredicate);var v=l.name+"!"+d.address,g=je(c),b=this.getColumnType(l,i-1,o),y=b.type,C,x=y==="date"||b.isDateAvail,w=x||b.numFormatApplied;w&&!d.filteredCol&&(C=[]),$s(this.parent,v,!0,!0,null,!0,null,null,!1,g,null,C,b.numFormatApplied&&r).then(function(M){var E;if(t.parent.element.style.position="relative",t.parent.element.classList.add("e-filter-open"),w){if(C||!p.length)E=new ge(C||M);else{var T=new ge(M).executeLocal(new $e().where(It.and(t.getPredicates(p))));E=new ge(T)}var D=function(z){t.parent.off(qA,D),z.isCheckboxFilterTemplate=!0,x?t.initTreeView(z,L):t.initCboxList(z,L)};t.parent.on(qA,D,t)}else M.some(function(z,q){return z&&(E=new ge(M.slice(q))),!!z});var N=e.querySelector(".e-filter-btn"),A={type:y,field:r,format:y==="date"?t.getDateFormatFromColumn(l,i,o):null,displayName:u||"Column "+r,dataSource:E||[],height:t.parent.element.classList.contains("e-bigger")?800:500,columns:[],hideSearchbox:!1,filteredColumns:t.filterCollection.get(n),column:{field:r,filter:{}},handler:t.filterSuccessHandler.bind(t,new ge(M)),target:N,position:{X:0,Y:0},localeObj:t.parent.serviceLocator.getService(de),actualPredicate:f,isFormatted:w&&!x},L=new IQ(t.parent,t.getLocalizedCustomOperators());L.openDialog(A);var k=document.querySelector(".e-filter-popup");if(k&&k.id.includes(t.parent.element.id)){I.add(k,Dd(),t.filterMouseDownHandler,t);var O=t.parent.element.getBoundingClientRect(),R=N.getBoundingClientRect(),j=k.getBoundingClientRect(),P=R.right-O.left-j.width;P<0&&(P=R.left-O.left),k.style.left=P+"px",k.style.top="0px",k.style.visibility="hidden",k.classList.contains("e-hide")&&k.classList.remove("e-hide");var F=R.bottom-O.top;j.height-(O.bottom-R.bottom)>0&&(F-=j.height-(O.bottom-R.bottom),F<0&&(F=0)),k.style.top=F+"px",k.style.visibility=""}t.parent.hideSpinner()})},s.prototype.getPredicateRange=function(e,t,i){var r=je(e),n,a=[],o=[];if(t&&t.length){var l,h;t.forEach(function(u){u.field&&(l=""+u.field+(e[0]+1)+":"+u.field+(e[2]+1),h=Rn(u.field),r.includes(l)||(r+=","+l,h<e[1]&&(e[1]=h),h>e[3]&&(e[3]=h)),i!==void 0&&(h===i?(n=!0,o.push(u)):a.push(u)))})}else n=!0;return i===void 0?r:{address:r,filteredCol:n,otherColPredicate:a,curPredicate:o}},s.prototype.filterDialogCreatedHandler=function(){var e=document.querySelector(".e-filter-popup");e&&e.id.includes(this.parent.element.id)&&e.classList.contains("e-popup-close")&&e.classList.add("e-hide")},s.prototype.filterCboxValueHandler=function(e){if(e.column&&e.data){var t=e.column.field;if(e.value){var i=xe(t+e.data.dataObj.__rowIndex),r=Y(i[0],i[1],this.parent.getActiveSheet());r&&r.format&&(e.value=this.parent.getDisplayText(r))}}},s.prototype.selectSortItemHandler=function(e){var t=this.parent.serviceLocator.getService(de),i=e.classList.contains("e-filter-sortasc")?"Ascending":e.classList.contains("e-filter-sortdesc")?"Descending":null;if(i==="Ascending"?e.setAttribute("aria-label",t.getConstant("SortAscending")):e.setAttribute("aria-label",t.getConstant("SortDescending")),!!i){var r=this.parent.getActiveSheet(),n=this.parent.activeSheetIndex,a=this.filterRange.get(n),o=a.range.slice();o[0]=o[0]+1,a.useFilterRange||(o[2]=r.usedRange.rowIndex),this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[];for(var l,h=0;h<this.parent.sortCollection.length;h++)this.parent.sortCollection[h]&&this.parent.sortCollection[h].sheetIndex===n&&(l=this.parent.sortCollection[h],this.parent.sortCollection.splice(h,1));this.parent.sortCollection.push({sortRange:je(o),columnIndex:ir(r.activeCell)[1],order:i,sheetIndex:n}),l||(l={order:""}),this.parent.notify(vu,{sortOptions:{sortDescriptors:{order:i},containsHeader:!1},previousSort:l,range:je(o)}),this.refreshFilterRange(),this.closeDialog()}},s.prototype.filterSuccessHandler=function(e,t){var i=t.sIdx;!i&&i!==0&&(i=this.parent.activeSheetIndex);var r=t.prevPredicates||[].slice.call(this.filterCollection.get(i));t.isFilterByValue&&!r.length&&(r=void 0);var n=this.filterCollection.get(i);if(this.updatePredicate(n,t.field),!(t.action==="clear-filter"&&n.length===r.length)){if(t.action==="filtering"&&(n=n.concat(t.filterCollection),n.length))for(var a=0;a<n.length;a++)t.field=n[a].field;this.filterCollection.set(i,n);var o={datasource:e,predicates:this.getPredicates(this.filterCollection.get(i))},l=this.filterRange.get(i);l.useFilterRange||(l.range[2]=Pe(this.parent,i).usedRange.rowIndex),this.applyFilter(o,je(l.range),i,r,!1,t.isInternal)}},s.prototype.updatePredicate=function(e,t){for(var i=new ge(e),r=new $e,n=i.executeLocal(r.where("field","equal",t)),a=0;a<n.length;a++){for(var o=-1,l=0;l<e.length;l++)if(e[l].field===n[a].field){o=l;break}o!==-1&&e.splice(o,1)}},s.prototype.applyFilter=function(e,t,i,r,n,a){var o=this,l={range:t,predicates:[].slice.call(this.filterCollection.get(i)),previousPredicates:r,sheetIndex:i,cancel:!1};if(!(!a&&(this.parent.notify(li,{action:"filter",eventArgs:l}),l.cancel))){t.indexOf("!")<0&&(t=this.parent.sheets[i].name+"!"+t),this.parent.showSpinner();var h=new Promise(function(c,d){c(function(){}())}),u={args:{range:t,filterOptions:e},promise:h,refresh:n};this.parent.notify(Ny,u),u.promise.then(function(c){return o.refreshFilterRange(),o.parent.notify(Qp,null),o.parent.hideSpinner(),a||(delete l.cancel,o.parent.notify(yt,{action:"filter",eventArgs:l}),document.activeElement.id!==o.parent.element.id+"_SearchBox"&&Fe(o.parent.element)),Promise.resolve(c)}).catch(function(c){return o.filterRangeAlertHandler({error:c}),Promise.reject(c)})}},s.prototype.getPredicates=function(e){for(var t=[],i=t2.getPredicate(e),r=0,n=Object.keys(i);r<n.length;r++){var a=n[r];t.push(i[""+a])}return t},s.prototype.getColumnType=function(e,t,i){for(var r=0,n=0,a=0,o=0,l,h,u=i[0];u<=i[2];u++)if(h=Y(u,t,e),h)if(h.format&&h.format!=="General"){var c=rh(h.format).toLowerCase();switch(c){case"number":case"currency":case"accounting":case"percentage":l=!0,r++;break;case"shortdate":case"longdate":a++;break;case"time":r++;break;default:var d={};yd(h.format,!0,d)?d.type==="date"?a++:r++:He(h.value)?(l=!0,r++):h.value&&n++;break}}else He(h.value)?r++:h.value&&n++;return{type:r>n&&r>a&&r>o?"number":n>=r&&n>=a&&n>=o?"string":a>r&&a>n&&a>o?"date":"datetime",isDateAvail:!!a,numFormatApplied:l}},s.prototype.getDateFormatFromColumn=function(e,t,i){for(var r,n=i[0];n<=i[2];n++){var a=Y(n,t-1,e);if(a&&a.format){var o=rh(a.format);o==="ShortDate"?r=a.format.split("m").join("M"):o==="LongDate"?r="EEEE, MMMM d, y":r=a.format;break}}return r},s.prototype.clearFilterHandler=function(e){var t=e&&e.sheetIndex!==void 0?e.sheetIndex:this.parent.activeSheetIndex;if(e&&e.field){var i=[].slice.call(this.filterCollection.get(t));i&&i.length&&(this.updatePredicate(i,e.field),this.initiateFilterUIHandler({predicates:i,range:je(this.filterRange.get(t).range),sIdx:t}))}else{var r=e&&e.isAction,n={isFiltered:!1,isClearAll:!0,sheetIndex:t};if(this.getFilteredColumnHandler(n),n.isFiltered||e&&e.preventRefresh){var a=void 0,o=Pe(this.parent,t),l=this.filterRange.get(t),h=l.range;if(r&&(a={range:je(h),predicates:[],previousPredicates:this.filterCollection.get(t),sheetIndex:t,cancel:!1},this.parent.notify(li,{action:"filter",eventArgs:a}),a.cancel))return;this.filterCollection.set(t,[]);for(var u=this.parent.filterCollection,c=0,d=u&&u.length;c<d;c++)if(u[c].sheetIndex===t){u.splice(c,1);break}var p=l.useFilterRange?h[2]:o.usedRange.rowIndex;if(this.parent.scrollSettings.enableVirtualization&&p-h[0]+1>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2){for(var c=0;c<=p;c++)Ts(o,c,{hidden:!1,isFiltered:!1});(!e||!e.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else{this.refreshFilterRange(null,null,t);var f={startIndex:h[0],hide:!1,isFiltering:!0,refreshUI:!1,endIndex:l.useFilterRange?h[2]:o.usedRange.rowIndex,sheetIndex:t};this.parent.notify(nn,f),f.refreshUI&&(!e||!e.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}r&&(delete a.cancel,this.parent.notify(yt,{action:"filter",eventArgs:a}),Fe(this.parent.element))}}},s.prototype.reapplyFilterHandler=function(e,t){var i=this,r=this.parent.activeSheetIndex;if(this.filterRange.has(r)){var n=this.filterCollection.get(r);if(n&&n.length){var a=Pe(this.parent,r),o=this.filterRange.get(this.parent.activeSheetIndex),l=o.range.slice();l[0]=l[0]+1,o.useFilterRange||(l[2]=a.usedRange.rowIndex),l[1]=l[3]=Rn(n[0].field);var h=a.name+"!"+this.getPredicateRange(l,n.slice(1,n.length));$s(this.parent,h,!0,!0,null,!0,null,null,!1,je(l)).then(function(u){var c=i.getPredicates(i.filterCollection.get(r));i.applyFilter({predicates:c,datasource:new ge(u)},je(o.range),r,[].slice.call(n),t,e)})}}},s.prototype.getFilterRangeHandler=function(e){var t=e.sheetIdx;this.filterRange&&this.filterRange.has(t)?(e.hasFilter=!0,e.filterRange=this.filterRange.get(t).range):(e.hasFilter=!1,e.filterRange=null)},s.prototype.getLocalizedCustomOperators=function(){var e=this.parent.serviceLocator.getService(de),t=[{value:"equal",text:e.getConstant("Equal")},{value:"greaterthan",text:e.getConstant("GreaterThan")},{value:"greaterthanorequal",text:e.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:e.getConstant("LessThan")},{value:"lessthanorequal",text:e.getConstant("LessThanOrEqual")},{value:"notequal",text:e.getConstant("NotEqual")}],i={stringOperator:[{value:"startswith",text:e.getConstant("StartsWith")},{value:"endswith",text:e.getConstant("EndsWith")},{value:"contains",text:e.getConstant("Contains")},{value:"equal",text:e.getConstant("Equal")},{value:"isempty",text:e.getConstant("IsEmpty")},{value:"doesnotstartwith",text:e.getConstant("NotStartsWith")},{value:"doesnotendwith",text:e.getConstant("NotEndsWith")},{value:"doesnotcontain",text:e.getConstant("NotContains")},{value:"notequal",text:e.getConstant("NotEqual")},{value:"isnotempty",text:e.getConstant("IsNotEmpty")}],numberOperator:t,dateOperator:t,datetimeOperator:t,booleanOperator:[{value:"equal",text:e.getConstant("Equal")},{value:"notequal",text:e.getConstant("NotEqual")}]};return i},s.prototype.getFilteredCollection=function(){for(var e=this.parent.sheets.length,t=[],i,r=0;r<e;r++){var n=void 0,a=void 0,o={sheetIdx:r,filterRange:n,hasFilter:a};if(this.getFilterRangeHandler(o),o.hasFilter){for(var l=[],h=[],u=[],c=[],d=[],p=this.filterCollection.get(o.sheetIdx),f=0;f<p.length;f++)if(p[f].field&&p[f].operator){var v=xe(p[f].field+"1")[1];l.push(v),h.push(p[f].operator),u.push(m(p[f].value)?"":p[f].value),c.push(p[f].type),d.push(p[f].predicate)}var g=je(o.filterRange);i={sheetIndex:o.sheetIdx,filterRange:g,hasFilter:o.hasFilter,column:l,criteria:h,value:u,dataType:c,predicates:d},t.push(i)}}i&&(this.parent.filterCollection=t)},s.prototype.updateFilter=function(e){if(this.parent.filterCollection&&(e.initLoad||e.isOpen)){for(var t=0;t<this.parent.filterCollection.length;t++){var i=this.parent.filterCollection[t],r=i.sheetIndex;t===0&&!this.parent.isOpen&&!e.isOpen&&(r=0);var n=[];if(i.column)for(var a=0;a<i.column.length;a++){var o={field:Je(0,i.column[a]).charAt(0),operator:this.getFilterOperator(i.criteria[a]),value:typeof i.value[a]=="string"?i.value[a].split("*").join(""):i.value[a],predicate:i.predicates&&i.predicates[a],type:i.dataType&&i.dataType[a]};n.push(o)}for(var l=0;l<n.length-1;l++)n[l].field===n[l+1].field&&(n[l].predicate||(n[l].predicate="or"),n[l+1].predicate||(n[l+1].predicate="or"));this.parent.notify(so,{predicates:n.length?n:void 0,range:i.filterRange,sIdx:r,isInternal:!0})}this.parent.sortCollection&&this.parent.notify(Ey,null)}},s.prototype.getFilterOperator=function(e){switch(e){case"BeginsWith":e="startswith";break;case"Less":e="lessthan";break;case"EndsWith":e="endswith";break;case"Equal":e="equal";break;case"Notequal":e="notEqual";break;case"Greater":e="greaterthan";break;case"Contains":e="contains";break;case"LessOrEqual":e="lessthanorequal";break;case"GreaterOrEqual":e="greaterthanorequal";break;case"NotContains":e="doesnotcontain";break;case"NotBeginsWith":e="doesnotstartwith";break;case"NotEndsWith":e="doesnotendwith";break;case"Empty":e="isempty";break;case"NotEmpty":e="isnotempty";break}return e},s.prototype.beforeInsertHandler=function(e){if(e.modelType==="Column"){var t=Re(e.activeSheetIndex)?this.parent.activeSheetIndex:e.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(t)){var i=this.filterRange.get(t).range;(this.isFilterCell(t,i[0],e.index)||e.index<i[1])&&(i[3]+=e.model.length,e.index<=i[1]&&(i[1]+=e.model.length),this.filterCollection.get(t).forEach(function(l){var h=Rn(l.field);e.index<=h&&(l.field=Ur(h+e.model.length+1))}),this.parent.sortCollection&&this.parent.sortCollection.forEach(function(l){l.sheetIndex===t&&e.index<=l.columnIndex&&(l.columnIndex+=e.model.length)}),this.getFilteredCollection())}}else if(e.modelType==="Sheet"){for(var r=!1,n=0,a=Array.from(this.filterRange.keys()).sort().reverse();n<a.length;n++){var o=a[n];e.index<=o&&(r=!0,this.filterRange.set(o+e.model.length,this.filterRange.get(o)),this.filterRange.delete(o),this.filterCollection.set(o+e.model.length,this.filterCollection.get(o)),this.filterCollection.delete(o))}this.parent.sortCollection&&this.parent.sortCollection.forEach(function(l){e.index<=l.sheetIndex&&(l.sheetIndex+=e.model.length)}),r&&this.getFilteredCollection()}},s.prototype.beforeDeleteHandler=function(e){if(e.modelType==="Column"){var t=this.parent.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(t)){var i=!0,r=this.filterRange.get(t).range;if(e.start>=r[1]&&e.end<=r[3]?r[3]-=e.end-e.start+1:e.start<r[1]&&e.end<r[1]?(r[1]-=e.end-e.start+1,r[3]-=e.end-e.start+1):e.start<r[1]&&e.end>r[1]&&e.end<r[3]?(r[1]=e.start,r[3]-=e.end-e.start+1):i=!1,i){for(var n=this.filterCollection.get(t),a=void 0,o=n.length-1;o>=0;o--){var l=Rn(n[o].field);e.end<l?n[o].field=Ur(l-(e.end-e.start+1)+1):e.start<=l&&e.end>=l&&(a=!0,n.splice(o,1))}var h=this.parent.sortCollection;if(h){for(var o=0;o<h.length;o++)if(h[o].sheetIndex===t){if(e.end<h[o].columnIndex){h[o].columnIndex=h[o].columnIndex-(e.end-e.start+1);break}else if(e.start<=h[o].columnIndex&&e.end>=h[o].columnIndex){h.splice(o,1);break}}}r.some(function(u){return u<0})?(this.removeFilter(t,!0,!0),e.refreshSheet=!0):a&&(n&&n.length?(this.reapplyFilterHandler(!0,!0),e.refreshSheet=!1):(this.clearFilterHandler({preventRefresh:!0}),e.refreshSheet=!0)),this.getFilteredCollection()}}}},s.prototype.deleteSheetHandler=function(e){if(Re(e.sheetIndex))this.filterRange.get(this.parent.activeSheetIndex)&&(this.filterRange.delete(this.parent.activeSheetIndex),this.filterCollection.delete(this.parent.activeSheetIndex));else{for(var t=void 0,i=0,r=Array.from(this.filterRange.keys()).sort().reverse();i<r.length;i++){var n=r[i];t=!0,e.sheetIndex===n?(this.filterRange.delete(n),this.filterCollection.delete(n)):e.sheetIndex<n?(this.filterRange.set(n-1,this.filterRange.get(n)),this.filterRange.delete(n),this.filterCollection.set(n-1,this.filterCollection.get(n)),this.filterCollection.delete(n)):t=!1}var a=this.parent.sortCollection;if(a)for(var o=a.length-1;o>=0;o--)e.sheetIndex===a[o].sheetIndex?a.splice(o,1):e.sheetIndex<a[o].sheetIndex&&(a[o].sheetIndex-=1);t&&this.getFilteredCollection()}},s.prototype.clearHandler=function(e){var t=this.parent.getAddressInfo(e.range);if(this.filterRange.has(t.sheetIndex)){var i=this.filterRange.get(t.sheetIndex).range.slice();Sa(t.indices,i[0],i[1])&&Sa(t.indices,i[0],i[3])&&this.removeFilter(t.sheetIndex)}},s.prototype.duplicateSheetFilterHandler=function(e){this.filterCollection.has(e.sheetIndex)&&this.filterCollection.set(e.newSheetIndex,this.filterCollection.get(e.sheetIndex)),this.filterRange.has(e.sheetIndex)&&this.filterRange.set(e.newSheetIndex,this.filterRange.get(e.sheetIndex))},s}(),DQ=function(){function s(e){this.parent=e,this.addEventListener(),this.renderImageUpload()}return s.prototype.addEventListener=function(){this.parent.on(uM,this.insertImage,this),this.parent.on(Md,this.refreshImgCellObj,this),this.parent.on(Da,this.createImageElement,this),this.parent.on(Xs,this.deleteImage,this),this.parent.on(u0,this.refreshInsDelImagePosition,this)},s.prototype.renderImageUpload=function(){var e=this.parent.element.appendChild(this.parent.createElement("input",{id:this.parent.element.id+"_imageUpload",styles:"display: none;",attrs:{type:"file",accept:".image, .jpg, .png, .gif ,jpeg",name:"fileUpload"}}));e.onchange=this.imageSelect.bind(this)},s.prototype.imageSelect=function(e){var t=e.target.files[0];t&&(t.type.includes("image")?this.insertImage({file:t}):this.parent.serviceLocator.getService(At).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("UnsupportedFile"),width:"300"}),e.target.value="")},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(uM,this.insertImage),this.parent.off(Md,this.refreshImgCellObj),this.parent.off(Da,this.createImageElement),this.parent.off(Xs,this.deleteImage),this.parent.off(u0,this.refreshInsDelImagePosition))},s.prototype.insertImage=function(e,t){var i=this;this.binaryStringVal(e).then(function(r){return i.createImageElement({options:{src:r},range:t,isPublic:!0})})},s.prototype.binaryStringVal=function(e){return new Promise(function(t,i){var r=new FileReader;r.readAsDataURL(e.file),r.onload=function(){return t(r.result)},r.onerror=function(n){return i(n)}})},s.prototype.createImageElement=function(e){var t=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,i=e.range&&e.range.indexOf("!")>0?gt(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,r=this.parent.serviceLocator.getService(II),n=e.options.imageId?e.options.imageId:mi(this.parent.element.id+"_overlay_picture_"),a=ee(t),o=Re(i)?this.parent.getActiveSheet():this.parent.sheets[i];if(!this.parent.element.querySelector("#"+n)){var l={requestType:"beforeInsertImage",range:o.name+"!"+t,imageData:e.options.src,sheetIndex:i};if(e.isPublic&&this.parent.notify("actionBegin",{eventArgs:l,action:"beforeInsertImage"}),!l.cancel){var h=r.insertOverlayElement(n,t,i);h.element.style.backgroundImage="url('"+e.options.src+"')",(e.options.height||e.options.left)&&(h.element.style.height=e.options.height+"px",h.element.style.width=e.options.width+"px",m(e.options.top)||(h.element.style.top=Number(oh(e.options.top).toFixed(2))+"px"),m(e.options.left)||(h.element.style.left=Number(oh(e.options.left).toFixed(2))+"px")),(o.frozenRows||o.frozenColumns)&&r.adjustFreezePaneSize(e.options,h.element,t);var u={src:e.options.src,id:n,height:parseFloat(h.element.style.height.replace("px","")),width:parseFloat(h.element.style.width.replace("px","")),top:o.frozenRows||o.frozenColumns?a[0]?Ei(o,0,a[0]-1):0:m(e.options.top)?h.top:e.options.top,left:o.frozenRows||o.frozenColumns?a[1]?ci(o,0,a[1]-1):0:m(e.options.left)?h.left:e.options.left};this.parent.setUsedRange(a[0],a[1]),(e.isPublic||e.isUndoRedo)&&this.parent.notify(Py,{options:[u],range:o.name+"!"+t});var c=Y(a[0],a[1],o);c.image[c.image.length-1].id||(c.image[c.image.length-1].id=u.id),!e.isUndoRedo&&e.isPublic&&(l={requestType:"insertImage",range:o.name+"!"+t,imageHeight:e.options.height?e.options.height:300,imageWidth:e.options.width?e.options.width:400,imageData:e.options.src,id:n,sheetIndex:i},this.parent.notify("actionComplete",{eventArgs:l,action:"insertImage"}))}}},s.prototype.refreshInsDelImagePosition=function(e){for(var t=e.count,i=e.sheetIdx,r=this.parent.sheets[i],n,a=Y(e.rowIdx,e.colIdx,r),o=a.image.length,l,h,u=0;u<o;u++)n=document.getElementById(a.image[u].id),l=e.type==="Row"?e.status==="insert"?a.image[u].top+t*20:a.image[u].top-t*20:a.image[u].top,h=e.type==="Column"?e.status==="insert"?a.image[u].left+t*64:a.image[u].left-t*64:a.image[u].left,a.image[u].top=l,a.image[u].left=h,n.style.top=l+"px",n.style.left=h+"px"},s.prototype.refreshImgCellObj=function(e){var t=Re(e.sheetIdx)?this.parent.activeSheetIndex:e.sheetIdx,i=Pe(this.parent,t),r=Y(e.prevRowIdx,e.prevColIdx,i),n=Y(e.currentRowIdx,e.currentColIdx,i),a=r?r.image:[],o,l,h=a&&a.length?a.length:0;if(r&&r.image&&a.length>0){for(var u=0;u<h;u++)a[u]&&a[u].id===e.id&&(o=a[u],o.height=e.currentHeight,o.width=e.currentWidth,o.top=e.currentTop,o.left=e.currentLeft,a.splice(u,1));if(n&&n.image&&(l=n.image,o&&l.push(o)),l?Ht(e.currentRowIdx,e.currentColIdx,i,{image:l},!0):Ht(e.currentRowIdx,e.currentColIdx,i,{image:[o]},!0),e.requestType==="imageRefresh"&&!e.isUndoRedo){var c={requestType:"imageRefresh",currentRowIdx:e.currentRowIdx,currentColIdx:e.currentColIdx,prevRowIdx:e.prevRowIdx,prevColIdx:e.prevColIdx,prevTop:e.prevTop,prevLeft:e.prevLeft,currentTop:e.currentTop,currentLeft:e.currentLeft,currentHeight:e.currentHeight,currentWidth:e.currentWidth,prevHeight:e.prevHeight,prevWidth:e.prevWidth,id:e.id,sheetIdx:this.parent.activeSheetIndex};this.parent.notify("actionComplete",{eventArgs:c,action:"imageRefresh"})}}},s.prototype.deleteImage=function(e){var t=e.sheet||this.parent.getActiveSheet(),i=document.getElementById(e.id),r=e.rowIdx,n=e.colIdx,a;if(i){if(e.rowIdx===void 0&&e.colIdx===void 0){var o=void 0,l=void 0;if(t.frozenRows||t.frozenColumns){var h=i.getBoundingClientRect();o={clientY:h.top},l={clientX:h.left},h.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(o.target=this.parent.getColumnHeaderContent()),h.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else o={clientY:parseFloat(i.style.top),isImage:!0},l={clientX:parseFloat(i.style.left),isImage:!0};this.parent.notify(lo,o),this.parent.notify(ho,l),r=o.clientY,n=l.clientX}if(a=t.name+"!"+Je(r,n),!e.preventEventTrigger){var u={address:a,cancel:!1};if(this.parent.notify(li,{action:"deleteImage",eventArgs:u}),u.cancel)return}document.getElementById(e.id).remove()}else if(!e.sheet){var c=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,d=e.range&&e.range.indexOf("!")>0?gt(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,p=ee(c);r=p[0],n=p[1],t=this.parent.sheets[d]}for(var f=Y(r,n,t),v=f.image,g=v.length,b={},y=0;y<g;y++)v[y].id===e.id&&(b=v.splice(y,1)[0]);Ht(r,n,t,{image:v},!0),e.preventEventTrigger||this.parent.notify(yt,{action:"deleteImage",eventArgs:{address:a,id:b.id,imageData:b.src,imageWidth:b.width,imageHeight:b.height,cancel:!1}})},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s.prototype.getModuleName=function(){return"spreadsheetImage"},s}(),zr=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Le=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Nc=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("Line")],e.prototype,"type",void 0),Le([S(null)],e.prototype,"color",void 0),Le([S(1)],e.prototype,"width",void 0),Le([S(null)],e.prototype,"length",void 0),Le([S("")],e.prototype,"dashArray",void 0),e}(ke),AQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("transparent")],e.prototype,"color",void 0),Le([S(0)],e.prototype,"width",void 0),Le([S(.8)],e.prototype,"cornerRadius",void 0),e}(ke),EL=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("Normal")],e.prototype,"fontStyle",void 0),Le([S("15px")],e.prototype,"size",void 0),Le([S("500")],e.prototype,"fontWeight",void 0),Le([S("")],e.prototype,"color",void 0),Le([S("Center")],e.prototype,"textAlignment",void 0),Le([S("Segoe UI")],e.prototype,"fontFamily",void 0),Le([S(1)],e.prototype,"opacity",void 0),Le([S("Wrap")],e.prototype,"textOverflow",void 0),Le([S("Top")],e.prototype,"position",void 0),Le([S(0)],e.prototype,"x",void 0),Le([S(0)],e.prototype,"y",void 0),Le([S("transparent")],e.prototype,"background",void 0),Le([Ee({},AQ)],e.prototype,"border",void 0),e}(ke),s2=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(0)],e.prototype,"x",void 0),Le([S(0)],e.prototype,"y",void 0),e}(ke),cs=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("Normal")],e.prototype,"fontStyle",void 0),Le([S("16px")],e.prototype,"size",void 0),Le([S("Normal")],e.prototype,"fontWeight",void 0),Le([S("")],e.prototype,"color",void 0),Le([S("Center")],e.prototype,"textAlignment",void 0),Le([S("Segoe UI")],e.prototype,"fontFamily",void 0),Le([S(1)],e.prototype,"opacity",void 0),Le([S("Wrap")],e.prototype,"textOverflow",void 0),e}(ke),Bn=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("")],e.prototype,"color",void 0),Le([S(1)],e.prototype,"width",void 0),e}(ke),NQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(0)],e.prototype,"x",void 0),Le([S(0)],e.prototype,"y",void 0),e}(ke),kQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([Ee({},Bn)],e.prototype,"border",void 0),Le([S("transparent")],e.prototype,"background",void 0),Le([S(1)],e.prototype,"opacity",void 0),Le([S(null)],e.prototype,"backgroundImage",void 0),Le([S(null)],e.prototype,"width",void 0),e}(ke),Ab=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(B.isDevice?5:10)],e.prototype,"left",void 0),Le([S(B.isDevice?5:10)],e.prototype,"right",void 0),Le([S(B.isDevice?5:10)],e.prototype,"top",void 0),Le([S(B.isDevice?5:10)],e.prototype,"bottom",void 0),e}(ke),LQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(0)],e.prototype,"left",void 0),Le([S(0)],e.prototype,"right",void 0),Le([S(0)],e.prototype,"top",void 0),Le([S(0)],e.prototype,"bottom",void 0),e}(ke),WI=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(!0)],e.prototype,"enable",void 0),Le([S(1e3)],e.prototype,"duration",void 0),Le([S(0)],e.prototype,"delay",void 0),e}(ke),a2=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(0)],e.prototype,"series",void 0),Le([S(0)],e.prototype,"point",void 0),e}(ke),OQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(0)],e.prototype,"topLeft",void 0),Le([S(0)],e.prototype,"topRight",void 0),Le([S(0)],e.prototype,"bottomLeft",void 0),Le([S(0)],e.prototype,"bottomRight",void 0),e}(ke),RQ=function(){function s(e,t){this.series=e,this.point=t}return s}(),o2=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(null)],e.prototype,"fill",void 0),Le([Ee({color:"transparent",width:0},Bn)],e.prototype,"border",void 0),Le([S("Gap")],e.prototype,"mode",void 0),e}(ke),FQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(!1)],e.prototype,"enable",void 0),Le([S(null)],e.prototype,"minY",void 0),Le([S(null)],e.prototype,"maxY",void 0),Le([S(null)],e.prototype,"fill",void 0),e}(ke),PQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(null)],e.prototype,"text",void 0),Le([Ee({fontFamily:null,size:"16px",fontStyle:"Normal",fontWeight:"600",color:null},cs)],e.prototype,"textStyle",void 0),Le([S(null)],e.prototype,"hoverTextFormat",void 0),e}(ke),l2=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(!1)],e.prototype,"enable",void 0),Le([S(!0)],e.prototype,"enableMarker",void 0),Le([S(!1)],e.prototype,"shared",void 0),Le([S(null)],e.prototype,"fill",void 0),Le([S(null)],e.prototype,"header",void 0),Le([S(null)],e.prototype,"opacity",void 0),Le([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:null,color:null},cs)],e.prototype,"textStyle",void 0),Le([S(null)],e.prototype,"format",void 0),Le([S(null)],e.prototype,"template",void 0),Le([S(!0)],e.prototype,"enableAnimation",void 0),Le([S(300)],e.prototype,"duration",void 0),Le([S(1e3)],e.prototype,"fadeOutDuration",void 0),Le([S("Move")],e.prototype,"fadeOutMode",void 0),Le([S(!1)],e.prototype,"enableTextWrap",void 0),Le([S(!0)],e.prototype,"showNearestPoint",void 0),Le([Ee({color:null,width:null},Bn)],e.prototype,"border",void 0),Le([Ee({x:null,y:null},s2)],e.prototype,"location",void 0),e}(ke);(function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(!1)],e.prototype,"enable",void 0),Le([S(!0)],e.prototype,"enableMarker",void 0),Le([S(!1)],e.prototype,"shared",void 0),Le([S(null)],e.prototype,"fill",void 0),Le([S(null)],e.prototype,"header",void 0),Le([S(.75)],e.prototype,"opacity",void 0),Le([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:null,color:null},cs)],e.prototype,"textStyle",void 0),Le([S(null)],e.prototype,"format",void 0),Le([S(null)],e.prototype,"template",void 0),Le([S(!0)],e.prototype,"enableAnimation",void 0),Le([S(300)],e.prototype,"duration",void 0),Le([S(1e3)],e.prototype,"fadeOutDuration",void 0),Le([S("Move")],e.prototype,"fadeOutMode",void 0),Le([S(!1)],e.prototype,"enableTextWrap",void 0),Le([S(!0)],e.prototype,"showNearestPoint",void 0),Le([Ee({color:null,width:null},Bn)],e.prototype,"border",void 0),Le([S("Fixed")],e.prototype,"position",void 0),e})(ke);var zQ=function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S("Years")],e.prototype,"intervalType",void 0),Le([S(1)],e.prototype,"interval",void 0),Le([S(null)],e.prototype,"text",void 0),Le([S(!1)],e.prototype,"selected",void 0),e}(ke);(function(s){zr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Le([S(43)],e.prototype,"height",void 0),Le([S("Bottom")],e.prototype,"position",void 0),Le([ii([],zQ)],e.prototype,"periods",void 0),e})(ke);var Nu=function(){function s(e){this.svgLink="http://www.w3.org/2000/svg",this.rootId=e}return s.prototype.getOptionValue=function(e,t){return e[t]},s.prototype.createSvg=function(e){return m(e.id)&&(e.id=this.rootId+"_svg"),this.svgObj=document.getElementById(e.id),m(document.getElementById(e.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(e,this.svgObj),this.setSVGSize(e.width,e.height),this.svgObj},s.prototype.setSVGSize=function(e,t){var i=document.getElementById(this.rootId),r=m(i)?null:i.getBoundingClientRect();m(this.width)||this.width<=0?this.svgObj.setAttribute("width",e?e.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),m(this.height)||this.height<=0?this.svgObj.setAttribute("height",t?t.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},s.prototype.drawPath=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"path")),t=this.setElementAttributes(e,t),t},s.prototype.drawLine=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"line")),t=this.setElementAttributes(e,t),t},s.prototype.drawRectangle=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"rect")),t=this.setElementAttributes(e,t),t},s.prototype.drawCircle=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"circle")),t=this.setElementAttributes(e,t),t},s.prototype.drawPolyline=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"polyline")),t=this.setElementAttributes(e,t),t},s.prototype.drawEllipse=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"ellipse")),t=this.setElementAttributes(e,t),t},s.prototype.drawPolygon=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"polygon")),t=this.setElementAttributes(e,t),t},s.prototype.drawImage=function(e){var t=document.createElementNS(this.svgLink,"image");return t.setAttributeNS(null,"height",e.height.toString()),t.setAttributeNS(null,"width",e.width.toString()),t.setAttributeNS("http://www.w3.org/1999/xlink","href",e.href),t.setAttributeNS(null,"x",e.x.toString()),t.setAttributeNS(null,"y",e.y.toString()),t.setAttributeNS(null,"id",e.id),t.setAttributeNS(null,"visibility",e.visibility),m(this.getOptionValue(e,"clip-path"))||t.setAttributeNS(null,"clip-path",this.getOptionValue(e,"clip-path")),m(e.preserveAspectRatio)||t.setAttributeNS(null,"preserveAspectRatio",e.preserveAspectRatio),t},s.prototype.createText=function(e,t){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(e,i),m(t)||(i.textContent=t),i},s.prototype.createTSpan=function(e,t){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(e,i),m(t)||(i.textContent=t),i},s.prototype.createTitle=function(e){var t=document.createElementNS(this.svgLink,"title");return t.textContent=e,t},s.prototype.createDefs=function(){var e=document.createElementNS(this.svgLink,"defs");return e},s.prototype.createClipPath=function(e){var t=document.createElementNS(this.svgLink,"clipPath");return t=this.setElementAttributes(e,t),t},s.prototype.createForeignObject=function(e){var t=document.createElementNS(this.svgLink,"foreignObject");return t=this.setElementAttributes(e,t),t},s.prototype.createGroup=function(e){var t=document.createElementNS(this.svgLink,"g");return t=this.setElementAttributes(e,t),t},s.prototype.createPattern=function(e,t){var i=document.createElementNS(this.svgLink,t);return i=this.setElementAttributes(e,i),i},s.prototype.createRadialGradient=function(e,t,i){var r;if(m(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",n,e),r="url(#"+this.rootId+"_"+t+"radialGradient)"}return r},s.prototype.createLinearGradient=function(e,t,i){var r;if(m(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",n,e),r="url(#"+this.rootId+"_"+t+"linearGradient)"}return r},s.prototype.drawGradient=function(e,t,i){var r=this.createDefs(),n=document.createElementNS(this.svgLink,e);n=this.setElementAttributes(t,n);for(var a=0;a<i.length;a++){var o=document.createElementNS(this.svgLink,"stop");o.setAttribute("offset",i[a].colorStop),o.setAttribute("stop-color",i[a].color),o.setAttribute("stop-opacity",i[a].opacity?i[a].opacity:"1"),m(i[a].style)||(o.style.cssText=i[a].style),n.appendChild(o)}return r.appendChild(n),r},s.prototype.drawClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Rect";var r=this.drawRectangle(e);return i.appendChild(r),t.appendChild(i),t},s.prototype.drawCircularClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Circle";var r=this.drawCircle(e);return i.appendChild(r),t.appendChild(i),t},s.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=0;r<i.length;r++)i[r]==="style"?t.style.cssText=e[i[r]]:t.setAttribute(i[r],e[i[r]]);return t},s.prototype.createCanvas=function(){return null},s}(),h2=function(){function s(e){this.rootId=e}return s.prototype.getOptionValue=function(e,t){return e[t]},s.prototype.createCanvas=function(e){var t=document.createElement("canvas");return t.setAttribute("id",this.rootId+"_canvas"),this.ctx=t.getContext("2d"),this.canvasObj=t,this.setCanvasSize(e.width,e.height),this.canvasObj},s.prototype.setCanvasSize=function(e,t){var i=document.getElementById(this.rootId),r=m(i)?null:i.getBoundingClientRect();m(this.width)?this.canvasObj.setAttribute("width",e?e.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),m(this.height)?this.canvasObj.setAttribute("height",t?t.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},s.prototype.setAttributes=function(e){this.ctx.lineWidth=this.getOptionValue(e,"stroke-width");var t=this.getOptionValue(e,"stroke-dasharray");if(!m(t)){var i=t.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(e,"stroke")},s.prototype.drawLine=function(e){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.moveTo(e.x1,e.y1),this.ctx.lineTo(e.x2,e.y2),this.ctx.stroke(),this.ctx.restore()},s.prototype.drawRectangle=function(e,t){var i=this.ctx,r=e.rx;return this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=this.getOptionValue(e,"opacity"),this.setAttributes(e),this.ctx.rect(e.x,e.y,e.width,e.height),r!==null&&r>=0?this.drawCornerRadius(e):(e.fill==="none"&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj},s.prototype.drawCornerRadius=function(e){var t=e.rx,i=e.x,r=e.y,n=e.width,a=e.height;e.fill==="none"&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,n<2*t&&(t=n/2),a<2*t&&(t=a/2),this.ctx.beginPath(),this.ctx.moveTo(i+n-t,r),this.ctx.arcTo(i+n,r,i+n,r+a,t),this.ctx.arcTo(i+n,r+a,i,r+a,t),this.ctx.arcTo(i,r+a,i,r,t),this.ctx.arcTo(i,r,i+n,r,t),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()},s.prototype.drawPath=function(e,t){var i=e.d,r=i.split(" "),n=this.getOptionValue(e,"stroke-width"),a=this.ctx,o=!0;this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=e.opacity?e.opacity:this.getOptionValue(e,"fill-opacity"),this.setAttributes(e);for(var l=0;l<r.length;l=l+3){var h=parseFloat(r[l+1]),u=parseFloat(r[l+2]);switch(r[l]){case"M":!e.innerR&&!e.cx&&this.ctx.moveTo(h,u);break;case"L":e.innerR||this.ctx.lineTo(h,u);break;case"Q":var c=parseFloat(r[l+3]),d=parseFloat(r[l+4]);this.ctx.quadraticCurveTo(h,u,c,d),l=l+2;break;case"C":var p=parseFloat(r[l+3]),f=parseFloat(r[l+4]),v=parseFloat(r[l+5]),g=parseFloat(r[l+6]);this.ctx.bezierCurveTo(h,u,p,f,v,g),l=l+4;break;case"A":e.innerR?o&&(this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.arc(e.x,e.y,e.innerR,e.end,e.start,!e.counterClockWise),o=!1):e.cx?this.ctx.arc(e.cx,e.cy,e.radius,0,2*Math.PI,e.counterClockWise):(this.ctx.moveTo(e.x,e.y),this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.lineTo(e.x,e.y)),l=l+5;break;case"z":case"Z":this.ctx.closePath(),l=l-2;break}}return e.fill!=="none"&&e.fill!==void 0&&(this.ctx.fillStyle=e.fill,this.ctx.fill()),n>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=a,this.canvasObj},s.prototype.createText=function(e,t,i,r,n,a){var o=this.getOptionValue(e,"font-weight");!m(o)&&o.toLowerCase()==="regular"&&(o="normal");var l=this.getOptionValue(e,"font-size"),h=this.getOptionValue(e,"font-family"),u=this.getOptionValue(e,"font-style").toLowerCase(),c=u+" "+o+" "+l+" "+h,d=this.getOptionValue(e,"text-anchor"),p=e.opacity!==void 0?e.opacity:1;if(d==="middle"&&(d="center"),this.ctx.save(),this.ctx.fillStyle=e.fill,this.ctx.font=c,this.ctx.textAlign=d,this.ctx.globalAlpha=p,e.baseline&&(this.ctx.textBaseline=e.baseline),!a){var f=0;this.ctx.translate(e.x+f/2+(i||0),e.y+(r||0)),this.ctx.rotate(e.labelRotation*Math.PI/180)}return this.ctx.fillText(t,a?e.x:0,a?n:0),this.ctx.restore(),this.canvasObj},s.prototype.drawCircle=function(e,t){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.cx,e.cy,e.r,0,2*Math.PI),this.ctx.fillStyle=e.fill,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),t&&this.ctx.translate(t[0],t[1]),this.setAttributes(e),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},s.prototype.drawPolyline=function(e){this.ctx.save(),this.ctx.beginPath();for(var t=e.points.split(" "),i=0;i<t.length-1;i++){var r=t[i].split(","),n=parseFloat(r[0]),a=parseFloat(r[1]);i===0?this.ctx.moveTo(n,a):this.ctx.lineTo(n,a)}this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore()},s.prototype.drawEllipse=function(e,t){var i=this.ctx,r=Math.max(e.rx,e.ry),n=e.rx/r,a=e.ry/r;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(e.cx,e.cy),t&&this.ctx.translate(t[0],t[1]),this.ctx.save(),this.ctx.scale(n,a),this.ctx.arc(0,0,r,0,2*Math.PI,!1),this.ctx.fillStyle=e.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i},s.prototype.drawImage=function(e){this.ctx.save();var t=new Image;m(e.href)||(t.src=e.href,this.ctx.drawImage(t,e.x,e.y,e.width,e.height)),this.ctx.restore()},s.prototype.createLinearGradient=function(e){var t;m(e[0].colorStop)||(t=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height));var i=this.setGradientValues(e,t);return i},s.prototype.createRadialGradient=function(e){var t;m(e[0].colorStop)||(t=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height));var i=this.setGradientValues(e,t);return i},s.prototype.setGradientValues=function(e,t){var i;if(m(e[0].colorStop))i=e[0].color.toString();else{for(var r=0;r<=e.length-1;r++){var n=e[r].color,a=e[r].colorStop.slice(0,-1),o=parseInt(a,10)/100;t.addColorStop(o,n)}i=t.toString()}return i},s.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=Object.keys(e).map(function(a){return e[a]}),n=0;n<i.length;n++)t.setAttribute(i[n],r[n]);return null},s.prototype.updateCanvasAttributes=function(e){this.setElementAttributes(e,this.canvasObj);var t=this.ctx;if(!m(this.dataUrl)){var i=new Image;i.onload=function(){t.drawImage(i,0,0)},i.src=this.dataUrl}},s.prototype.clearRect=function(e){this.ctx.restore(),this.ctx.clearRect(e.x,e.y,e.width,e.height)},s.prototype.createGroup=function(){return null},s.prototype.drawClipPath=function(){return null},s.prototype.drawCircularClipPath=function(){return null},s.prototype.canvasClip=function(e){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(e.x,e.y,e.width,e.height),this.ctx.fill(),this.ctx.clip()},s.prototype.canvasRestore=function(){this.ctx.restore()},s.prototype.drawPolygon=function(){return null},s.prototype.createDefs=function(){return null},s.prototype.createClipPath=function(){return null},s.prototype.createSvg=function(){return null},s}();function jQ(s){var e;switch(s){case"Highcontrast":case"HighContrast":e={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",textStyle:{fontFamily:"Segoe UI",color:"#000000"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":e={tooltipFill:s==="MaterialDark"?"#F4F4F4":s==="FabricDark"?"#A19F9D":"#F0F0F0",tooltipBoldLabel:s==="MaterialDark"?"rgba(18, 18, 18, 1)":s==="FabricDark"?"#DADADA":"#1A1A1A",tooltipLightLabel:s==="MaterialDark"?"rgba(18, 18, 18, 1)":s==="FabricDark"?"#DADADA":"#1A1A1A",tooltipHeaderLine:"#9A9A9A",textStyle:s==="MaterialDark"?{fontFamily:"Roboto",color:"rgba(18, 18, 18, 1)"}:s==="FabricDark"?{fontFamily:"Segoe UI",color:"#DADADA"}:{fontFamily:"Helvetica",color:"#1A1A1A"}};break;case"Bootstrap4":e={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)",textStyle:{fontFamily:"Helvetica",color:"#F9FAFB"}};break;case"Tailwind":e={tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",textStyle:{fontFamily:"Inter",color:"#F9FAFB"}};break;case"TailwindDark":e={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",textStyle:{fontFamily:"Inter",color:"#1F2937"}};break;case"Bootstrap5":e={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF",textStyle:{fontFamily:"Helvetica",color:"#F9FAFB"}};break;case"Bootstrap5Dark":e={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD",textStyle:{fontFamily:"Helvetica",color:"#212529"}};break;case"Fluent":e={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",textStyle:{fontFamily:"Segoe UI",color:"#323130"}};break;case"FluentDark":e={tooltipFill:"#323130",tooltipBoldLabel:"#F3F2F2",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#F3F2F1"}};break;case"Material3":e={tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",textStyle:{fontFamily:"Roboto",color:"#F4EFF4"}};break;case"Material3Dark":e={tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",textStyle:{fontFamily:"Roboto",color:"#313033"}};break;default:e={tooltipFill:s==="Material"?"#000816":s==="Fabric"?"#FFFFFF":"#212529",tooltipBoldLabel:s==="Material"?"rgba(249, 250, 251, 1)":s==="Fabric"?"#333333":"#F9FAFB",tooltipLightLabel:s==="Material"?"rgba(249, 250, 251, 1)":s==="Fabric"?"#333333":"#F9FAFB",tooltipHeaderLine:s==="Fabric"?"#D2D0CE":"#ffffff",textStyle:s==="Material"?{fontFamily:"Roboto",color:"rgba(249, 250, 251, 1)"}:s==="Fabric"?{fontFamily:"Segoe UI",color:"#333333"}:{fontFamily:"Helvetica",color:"#F9FAFB"}};break}return e}var u2=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function ht(s,e,t){var i=s||"",r=document.getElementById("chartmeasuretext");if(r===null&&(r=St("text",{id:"chartmeasuretext"}),document.body.appendChild(r)),typeof s=="string"&&(s.indexOf("<")>-1||s.indexOf(">")>-1)){for(var n=s.split(" "),a=0;a<n.length;a++)n[a].indexOf("<br/>")===-1&&(n[a]=n[a].replace(/[<>]/g,"&"));s=n.join(" ")}return r.innerHTML=i.indexOf("<br>")>-1||i.indexOf("<br/>")>-1?i:s,r.style.position="fixed",r.style.fontSize=e.size,r.style.fontWeight=e.fontWeight,r.style.fontStyle=e.fontStyle,r.style.fontFamily=e.fontFamily||t.fontFamily,r.style.visibility="hidden",r.style.top="-100",r.style.left="0",r.style.whiteSpace="nowrap",r.style.lineHeight="normal",new ei(r.clientWidth,r.clientHeight)}function IL(s,e,t,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),s>=t.x-i&&s<=t.x+t.width+i&&e>=t.y-r&&e<=t.y+t.height+r}function BQ(s,e,t,i,r,n,a,o,l,h,u){u===void 0&&(u="");var c="",d=t.x,p=t.y,f=t.x+t.width,v=t.y+t.height;return n?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+s)+" "+p+"  L "+(f-s)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+e)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-s)+" "+v),r!==0&&(u==="RangeNavigator"?i.x-r>f/2?(c=c.concat(" L "+(i.x+r)+" "+v),c=c.concat(" L "+(l+r)+" "+(v+r)+" L "+i.x+" "+v)):(c=c.concat(" L "+i.x+" "+v),c=c.concat(" L "+(l-r)+" "+(v+r)+" L "+(i.x-r)+" "+v)):(c=c.concat(" L "+(i.x+r)+" "+v),c=c.concat(" L "+l+" "+(v+r)+" L "+(i.x-r)+" "+v))),i.x-r>d||r===0?c=c.concat(" L "+(d+s)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z"):c=c.concat(" L "+d+" "+(v+e)+" z")):a?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+s)+" "+p+" L "+(i.x-r)+" "+p),c=c.concat(" L "+l+" "+i.y),c=c.concat(" L "+(i.x+r)+" "+p),c=c.concat(" L "+(f-s)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+e)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-s)+" "+v+" L "+(d+s)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z")):o?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+s)+" "+p),c=c.concat(" L "+(f-s)+" "+p+" Q "+f+" "+p+" "+f+" "+((u==="RangeNavigator"?0:p+e)+" L "+f+" "+(u==="RangeNavigator"?0:i.y-r))),c=u==="RangeNavigator"?c.concat(" L "+(f+r)+" 0"):c.concat(" L "+(f+r)+" "+h),c=u==="RangeNavigator"?c.concat(" L "+f+" "+(i.y-e)):c.concat(" L "+f+" "+(i.y+r)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-s)+" "+v),c=c.concat(" L "+(d+s)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z")):(c=c.concat("M "+(d+s)+" "+p+" Q "+d+" "+p+" "+d+" "+((u==="RangeNavigator"?0:p+e)+" L "+d+" "+(u==="RangeNavigator"?0:i.y-r))),c=u==="RangeNavigator"?c.concat(" L "+(d-r)+" 0"):c.concat(" L "+(d-r)+" "+h),c=u==="RangeNavigator"?c.concat(" L "+d+" "+(i.y-e)):c.concat(" L "+d+" "+(i.y+r)),c=c.concat(" L "+d+" "+(v-e)+" Q "+d+" "+v+" "+(d+s)+" "+v),c=c.concat(" L "+(f-s)+" "+v+" Q "+f+" "+v+" "+f+" "+(v-e)+" L "+f+" "+(p+e)+" Q "+f+" "+p+" "+(f-s)+" "+p+" z")),c}var ei=function(){function s(e,t){this.width=e,this.height=t}return s}(),Ve=function(){function s(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return s}(),HQ=function(){function s(e,t){this.isRight=t,this.isBottom=e}return s}(),c2=function(){function s(e){this.id=e}return s}(),Sn=function(s){u2(e,s);function e(t,i,r,n,a,o,l,h){o===void 0&&(o="");var u=s.call(this,t)||this;return u.transform="",u.baseLine="auto",u.labelRotation=0,u.x=i,u.y=r,u.anchor=n,u.text=a,u.transform=o,u.baseLine=l,u.labelRotation=h,u}return e}(c2);function Un(s){return document.getElementById(s)}function sg(s){var e=Un(s);e&&pt(e)}function VQ(s,e,t,i,r,n){var a=new Nu(""),o=UQ(s,t,e,r,i),l=a["draw"+o.functionName](o.renderOption);return l.setAttribute("aria-label",n),l}function UQ(s,e,t,i,r){var n,a="Path",o=e.width,l=e.height,h=s.x,u=s.y,c=s.x+-o/2,d=s.y+-l/2;switch(t){case"Circle":case"Bubble":a="Ellipse",bt(i,{rx:o/2,ry:l/2,cx:h,cy:u});break;case"Plus":n="M "+c+" "+u+" L "+(h+o/2)+" "+u+" M "+h+" "+(u+l/2)+" L "+h+" "+(u+-l/2),bt(i,{d:n,stroke:i.fill});break;case"Cross":n="M "+c+" "+(u+-l/2)+" L "+(h+o/2)+" "+(u+l/2)+" M "+c+" "+(u+l/2)+" L "+(h+o/2)+" "+(u+-l/2),bt(i,{d:n,stroke:i.fill});break;case"HorizontalLine":n="M "+c+" "+u+" L "+(h+o/2)+" "+u,bt(i,{d:n,stroke:i.fill});break;case"VerticalLine":n="M "+h+" "+(u+l/2)+" L "+h+" "+(u+-l/2),bt(i,{d:n,stroke:i.fill});break;case"Diamond":n="M "+c+" "+u+" L "+h+" "+(u+-l/2)+" L "+(h+o/2)+" "+u+" L "+h+" "+(u+l/2)+" L "+c+" "+u+" z",bt(i,{d:n});break;case"Rectangle":n="M "+c+" "+(u+-l/2)+" L "+(h+o/2)+" "+(u+-l/2)+" L "+(h+o/2)+" "+(u+l/2)+" L "+c+" "+(u+l/2)+" L "+c+" "+(u+-l/2)+" z",bt(i,{d:n});break;case"Triangle":n="M "+c+" "+(u+l/2)+" L "+h+" "+(u+-l/2)+" L "+(h+o/2)+" "+(u+l/2)+" L "+c+" "+(u+l/2)+" z",bt(i,{d:n});break;case"InvertedTriangle":n="M "+(h+o/2)+" "+(u-l/2)+" L "+h+" "+(u+l/2)+" L "+(h-o/2)+" "+(u-l/2)+" L "+(h+o/2)+" "+(u-l/2)+" z",bt(i,{d:n});break;case"Pentagon":for(var p=72,f=void 0,v=void 0,g=0;g<=5;g++)f=o/2*Math.cos(Math.PI/180*(g*p)),v=l/2*Math.sin(Math.PI/180*(g*p)),g===0?n="M "+(h+f)+" "+(u+v)+" ":n=n.concat("L "+(h+f)+" "+(u+v)+" ");n=n.concat("Z"),bt(i,{d:n});break;case"Image":a="Image",bt(i,{href:r,height:l,width:o,x:c,y:d});break}return{renderOption:i,functionName:a}}var Er=function(s){u2(e,s);function e(t,i,r,n,a,o,l){var h=s.call(this,t)||this;return h.opacity=a,h.fill=i,h.stroke=n,h["stroke-width"]=r,h["stroke-dasharray"]=o,h.d=l,h}return e}(c2);function _Q(s,e,t,i,r){var n={},a=new Nu("");n={id:s.id,x:s.x,y:s.y,fill:t,"font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily||r.fontFamily,"font-weight":e.fontWeight,"text-anchor":s.anchor,transform:s.transform,opacity:e.opacity,"dominant-baseline":s.baseLine};var o=typeof s.text=="string"?s.text:s.text[0],l=a.createText(n,o);return i&&i.appendChild(l),l}var kn=function(){function s(e,t){this.x=e,this.y=t}return s}(),Nv=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),dt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},WQ=function(s){Nv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return dt([S(null)],e.prototype,"size",void 0),dt([S("")],e.prototype,"color",void 0),dt([S("Segoe UI")],e.prototype,"fontFamily",void 0),dt([S("Normal")],e.prototype,"fontWeight",void 0),dt([S("Normal")],e.prototype,"fontStyle",void 0),dt([S(1)],e.prototype,"opacity",void 0),e}(ke),qQ=function(s){Nv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return dt([S("")],e.prototype,"color",void 0),dt([S(1)],e.prototype,"width",void 0),dt([S("")],e.prototype,"dashArray",void 0),e}(ke),YQ=function(s){Nv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return dt([S(0)],e.prototype,"x",void 0),dt([S(0)],e.prototype,"y",void 0),dt([S(0)],e.prototype,"width",void 0),dt([S(0)],e.prototype,"height",void 0),e}(ke),TL=function(s){Nv(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return dt([S(0)],e.prototype,"x",void 0),dt([S(0)],e.prototype,"y",void 0),e}(ke),QQ=function(s){Nv(e,s);function e(t,i){return s.call(this,t,i)||this}return e.prototype.preRender=function(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()},e.prototype.initPrivateVariable=function(){this.renderer=new Nu(this.element.id),this.themeStyle=jQ(this.theme),this.formattedText=[],this.padding=5,this.highlightPadding=3,this.areaMargin=10,this.isFirst=!0,this.markerPoint=[]},e.prototype.removeSVG=function(){var t=document.getElementById(this.element.id+"_svg"),i=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&Yp(this.element.id+"parent_template_blazorTemplate"),t&&t.parentNode&&pt(t),i&&i.parentNode&&pt(i)},e.prototype.render=function(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst);var t={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",t);var i=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(i.isBottom,i.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});var r=document.getElementById("chartmeasuretext");r&&pt(r),this.allowServerDataBinding=!0},e.prototype.createTooltipElement=function(){if(this.textElements=[],!this.template||this.shared){this.enableRTL&&this.element.setAttribute("dir","ltr");var t=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(t);var i=document.getElementById(this.element.id+"_group");i||(i=this.renderer.createGroup({id:this.element.id+"_group"}),i.setAttribute("transform","translate(0,0)")),t.appendChild(i);var r=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":(this.theme==="Fabric"||this.theme==="Fluent")&&!this.border.width?1:this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:(this.theme==="TailwindDark"||this.theme==="Tailwind"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark")&&this.opacity===.75?1:this.opacity,stroke:this.border.color||(this.theme==="Fabric"||this.theme==="Fluent"?"#D2D0CE":this.border.color)});i.appendChild(r)}},e.prototype.drawMarker=function(t,i,r){if(this.shapes.length<=0)return null;var n,a=0,o=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),l=Un(this.element.id+"_group");if(!l)return null;for(var h=(this.enableRTL?this.elementSize.width-r/2:this.marginX*2+r/2)+(i?this.arrowPadding:0),u=0,c=this.shapes;u<c.length;u++){var d=c[u];if(d!=="None"){if(n=new Er(this.element.id+"_Trackball_"+a,this.palette[a],1,"#cccccc",1,null),this.markerPoint[a]){var p=0;this.header.indexOf("<br")>-1&&(p=this.header.split(/<br.*?>/g).length+a),o.appendChild(VQ(new kn(h,this.markerPoint[a]-this.padding+(t?this.arrowPadding:p)),d,new ei(r,r),"",n,null))}a++}}l.appendChild(o)},e.prototype.renderTooltipElement=function(t,i){var r=Un(this.element.id),n=new kn(0,0),a=new kn(0,0),o=Un(this.element.id+"_svg"),l=Un(this.element.id+"_group"),h=Un(this.element.id+"_path"),u,c=!1,d=!1,p=!1,f=0,v=0;if(!m(l)){if(this.header!==""&&(this.elementSize.height+=this.marginY),this.isFixed){var g=this.elementSize.width+2*this.marginX,b=this.elementSize.height+2*this.marginY;u=new Ve(i.x,i.y,g,b)}else this.content.length>1?(u=this.sharedTooltipLocation(t,this.location.x,this.location.y),c=!0):(u=this.tooltipLocation(t,i,n,a),this.inverted?(d=u.x<i.x+this.clipBounds.x,f=d?0:this.arrowPadding,this.allowHighlight&&(u.x+=d?this.highlightPadding:-(2*this.highlightPadding))):(c=u.y<i.y+this.clipBounds.y,p=!c,v=c?0:this.arrowPadding));if(this.header!==""){var y=2,C=0,x=this.isWrap?this.wrappedText:this.header;if(this.isWrap&&typeof x=="string"&&(x.indexOf("<")>-1||x.indexOf(">")>-1)){var w=x.split("<br>");y=w.length}this.header.indexOf("<br")>-1&&(C=5*(this.header.split(/<br.*?>/g).length-1));var M="properties",E=me({},this.textStyle,null,!0)[M],T=ht(this.isWrap?this.wrappedText:this.header,E,this.themeStyle.textStyle).height+this.marginY*y+(p?this.arrowPadding:0)+(this.isWrap?5:C),D=this.marginX*3+(!d&&!c&&!p?this.arrowPadding:0),N="M "+D+" "+T+"L "+(u.width+(!d&&!c&&!p?this.arrowPadding:0)-this.marginX*2)+" "+T,A=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:this.theme==="Material3"?.2:.8,stroke:this.themeStyle.tooltipHeaderLine,d:N});l.appendChild(A)}var L=this.border.width/2,k=new Ve(L+f,L+v,u.width-L,u.height-L);if(l.setAttribute("opacity","1"),this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(r,u):this.updateDiv(r,u.x,u.y),o.setAttribute("height",(u.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),o.setAttribute("width",(u.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),o.setAttribute("opacity","1"),m(this.tooltipPlacement)||(c=this.tooltipPlacement.indexOf("Top")>-1,p=this.tooltipPlacement.indexOf("Bottom")>-1,d=this.tooltipPlacement.indexOf("Left")>-1),h.setAttribute("d",BQ(this.rx,this.ry,k,n,this.arrowPadding,c,p,d,a.x,a.y,this.controlName)),this.enableShadow&&this.theme!=="Bootstrap4"){var O=this.element.id+"_shadow";this.theme==="Tailwind"||this.theme==="TailwindDark"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"?h.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):h.setAttribute("filter",B.isIE?"":"url(#"+O+")");var R='<filter id="'+O+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';R+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',R+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var j=this.renderer.createDefs();j.setAttribute("id",this.element.id+"SVG_tooltip_definition"),l.appendChild(j),j.innerHTML=R}var P=(this.theme==="Fabric"||this.theme==="Fluent")&&!this.border.color?"#D2D0CE":this.border.color;h.setAttribute("stroke",P),m(this.border.dashArray)||h.setAttribute("stroke-dasharray",this.border.dashArray),this.changeText(new kn(f,v),p,!d&&!c&&!p),this.revert&&(this.inverted=!this.inverted,this.revert=!1)}return new HQ(p,!d&&!c&&!p)},e.prototype.changeText=function(t,i,r){var n=document.getElementById(this.element.id+"_text");i&&n.setAttribute("transform","translate(0,"+this.arrowPadding+")"),r&&n.setAttribute("transform","translate("+this.arrowPadding+" 0)")},e.prototype.findFormattedText=function(){this.formattedText=[],this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)},e.prototype.renderText=function(t){var i=0,r=0,n=0,a,o="properties",l=me({},this.textStyle,null,!0)[o],h=Un(this.element.id+"_group"),u,c,d="",p,f;this.findFormattedText(),this.isWrap=!1;var v=document.body.getAttribute("dir")==="rtl",g=v&&!this.enableRTL?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var b=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),y=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,C=ht(this.formattedText[0],l,this.themeStyle.textStyle).width+2*this.marginX+this.arrowPadding,x=this.location.x-C<this.location.x,w=this.areaBounds.x+this.areaBounds.width<this.location.x+C,M,E=b!==""?this.marginY:0,T=!0,D=!0;this.markerPoint=[];var N=this.shapes.length>0?10:0,A=this.shapes.length>0?5:0,L=4,k,O="12px",R="400",j=this.themeStyle.tooltipLightLabel,P=22/parseFloat(O)*parseFloat(l.size),F=[],z=0;(!t||this.isCanvas)&&(sg(this.element.id+"_text"),sg(this.element.id+"_header_path"),sg(this.element.id+"_trackball_group"),sg(this.element.id+"SVG_tooltip_definition")),this.controlName==="Chart"&&parseFloat(O)<parseFloat(l.size)&&(z=parseFloat(l.size)-parseFloat(O));for(var q=new Sn(this.element.id+"_text",this.marginX*2,z+this.marginY*2+this.padding*2+(this.marginY===2?this.controlName==="RangeNavigator"?5:3:0),g,""),X=_Q(q,l,l.color||this.themeStyle.tooltipBoldLabel,h,this.themeStyle.textStyle),G=this.formattedText.length===1&&this.formattedText[0].indexOf(" : <b>")>-1,Z=this.header!=="",se=Z&&y?16:13,oe=0,fe=this.formattedText.length;oe<fe;oe++)if(c=this.formattedText[oe].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),this.isTextWrap&&this.header!==this.formattedText[oe]&&this.formattedText[oe].indexOf("<br")===-1&&(k=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/se:this.rightSpace/se),c=this.formattedText[oe].match(new RegExp(".{1,"+k+"}","g"))),oe===0&&!G&&this.isTextWrap&&(this.leftSpace<C||x)&&(this.rightSpace<C||w)&&(k=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/se:this.rightSpace/se),M=b!==""?b:this.formattedText[oe],c=M.match(new RegExp(".{1,"+k+"}","g")),this.wrappedText=y?"<b>"+c.join("<br>")+"</b>":c.join("<br>"),this.isWrap=c.length>1),c[0]!==""){(oe!==0||b==="")&&this.markerPoint.push((b!==""?this.marginY:0)+q.y+i-(z!==0?z/this.markerSize*(parseFloat(l.size)/this.markerSize):0));for(var be=0,Ne=c.length;be<Ne;be++){a=c[be].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,this.enableRTL?"<br>‎: <br>":"<br>‎:<br>").split("<br>"),this.enableRTL&&a.length>0&&c[be].match(/:/g)&&(a[0]=a[0].trim(),a.reverse()),n=0,D=!0,i+=P;for(var we=0,H=a.length;we<H;we++)if(p=a[we],this.enableRTL&&p!==""&&this.isRTLText(p)&&(p=p.concat("‎")),!/\S/.test(p)&&p!==""&&(p=" "),!D&&p===" "||p.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""){n+=p!==" "?L:0,D&&!T?(this.header.indexOf("<br")>-1&&oe!==0&&(E+=this.header.split(/<br.*?>/g).length),f={x:this.marginX*2+(N+A),dy:P+(D?E:0),fill:""},E=null):T&&D?f={x:b===""?this.marginX*2+(N+A):this.marginX*2+(this.isWrap?N+A:0)}:f={},D=!1,u=this.renderer.createTSpan(f,""),X.appendChild(u),p.indexOf("<b>")>-1||y&&we===0&&oe===0&&(Z||this.isWrap)?(R="600",j=this.themeStyle.tooltipBoldLabel,d="font-weight:"+R,l.fontWeight=R,u.setAttribute("fill",this.textStyle.color||j)):(d=R==="600"?"font-weight:"+R:"",l.fontWeight=R,u.setAttribute("fill",this.textStyle.color||j)),(p.indexOf("</b>")>-1||y&&we===H-1&&oe===0&&(Z||this.isWrap))&&(R="Normal",j=this.themeStyle.tooltipLightLabel),d!==""&&(u.style.fontWeight=d.split("font-weight:")[1],u.style.color=u.getAttribute("fill")),u.style.fontFamily="inherit",u.style.fontStyle="inherit",u.style.fontSize=this.header===this.formattedText[oe]?l.size:this.textStyle.size,u.style.fontWeight=this.header===this.formattedText[oe]&&(this.header.indexOf("<b>")||this.header.indexOf("</b>"))===-1?this.textStyle.fontWeight||"600":p.indexOf("<b>")>-1||p.indexOf("</b>")>-1?"bold":this.textStyle.fontWeight||l.fontWeight;var V=me({},this.textStyle,null,!0)[o];V.fontWeight=u.style.fontWeight,T=!1,u.textContent=p=this.getTooltipTextContent(p),n+=ht(p,V,this.themeStyle.textStyle).width}n-=L,r=Math.max(r,n),F.push(n)}}this.elementSize=new ei(r+(r>0?2*this.marginX:0),i),this.elementSize.width+=N+A;var re=X.childNodes[0];if(b!==""&&re&&!this.isWrap){l.fontWeight="600";var he=(this.elementSize.width+2*this.padding)/2-ht(b,l,this.themeStyle.textStyle).width/2;re.setAttribute("x",he.toString())}this.renderContentRTL(X,Z,N+A,F)},e.prototype.renderContentRTL=function(t,i,r,n){if(this.enableRTL)for(var a=void 0,o=i?1:0,l=0;l<t.childNodes.length;l++)a=t.childNodes[l],(!i||l>0)&&!m(a.getAttribute("x"))&&(a.setAttribute("x",(this.elementSize.width-(r+n[o])).toString()),o++)},e.prototype.getTooltipTextContent=function(t){var i=t.match(/<[a-zA-Z\/](.|\n)*?>/g);if(m(i))return t;for(var r=this.isRTLText(t),n=0;n<i.length;n++)this.isValidHTMLElement(i[n].replace("<","").replace("/","").replace(">","").trim())&&(t=t.replace(i[n],r?"‎":""));return t},e.prototype.isValidHTMLElement=function(t){return document.createElement(t).toString()!=="[object HTMLUnknownElement]"},e.prototype.isRTLText=function(t){return/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(t)},e.prototype.createTemplate=function(t,i){var r={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",r);var n=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();var a=n.firstElementChild;if(a&&pt(a),r.cancel)pt(Un(this.element.id+"_tooltip"));else{var o=St("div",{id:this.element.id+"parent_template"}),l=void 0;if(this.controlName==="Chart"&&this.shared)for(var h=0;h<this.data.length;h++){var u=this.templateFn(this.data[h],this.controlInstance,o.id,o.id+"_blazorTemplate","");h===0?l=u:l[l.length-1].outerHTML+=u[0].outerHTML}else l=this.templateFn(this.data,this.controlInstance,o.id,o.id+"_blazorTemplate","");for(;l&&l.length>0;)l.length===1?(o.appendChild(l[0]),l=null):o.appendChild(l[0]);n.appendChild(o);var c=this.isCanvas?o:this.element,d=c.getBoundingClientRect();this.padding=0,this.elementSize=new ei(d.width,d.height);var p=this.shared?this.sharedTooltipLocation(t,this.location.x,this.location.y):this.tooltipLocation(t,i,new kn(0,0),new kn(0,0));if(this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(this.element,p):this.updateDiv(c,p.x,p.y),this.blazorTemplate){var f=function(){var g=Un(v.element.id).getBoundingClientRect();v.elementSize=new ei(g.width,g.height);var b=v.tooltipLocation(t,i,new kn(0,0),new kn(0,0));v.updateDiv(Un(v.element.id),b.x,b.y)},v=this;f.bind(v,t,i),this.element.id+"",this.blazorTemplate.name,this.blazorTemplate.parent}}},e.prototype.sharedTooltipLocation=function(t,i,r){var n=this.elementSize.width+2*this.marginX,a=this.elementSize.height+2*this.marginY,o=new Ve(i+2*this.padding,r-a-this.padding,n,a);return o.y<t.y&&(o.y+=o.height+2*this.padding),o.y+o.height>t.y+t.height&&(o.y=Math.max(t.y+t.height-(o.height+2*this.padding),t.y)),o.x+o.width>t.x+t.width&&(o.x=t.x+this.location.x-(o.width+4*this.padding)),o.x<t.x&&(o.x=t.x),o},e.prototype.getCurrentPosition=function(t,i,r,n){var a=this.tooltipPlacement,o=this.clipBounds.x,l=this.clipBounds.y,h=this.offset,u=this.elementSize.width+2*this.marginX,c=this.elementSize.height+2*this.marginY,d=new kn(i.x,i.y);return a==="Top"||a==="Bottom"?(d=new kn(d.x+o-this.elementSize.width/2-this.padding,d.y+l-this.elementSize.height-2*this.padding-this.arrowPadding-h),r.x=n.x=u/2,a==="Bottom"&&(d.y=i.y+l+h),t.x+t.width<d.x+u?(d.x=t.width>u?t.x+t.width-u+6:t.x,r.x=n.x=t.width>u?t.x+i.x-d.x:i.x):t.x>d.x&&(d.x=t.x,r.x=n.x=i.x)):(d=new kn(d.x+o+h,d.y+l-this.elementSize.height/2-this.padding),r.y=n.y=c/2,a==="Left"&&(d.x=i.x+o-h-(u+this.arrowPadding)),t.y+t.height<d.y+c?(d.y=t.height>c?t.y+t.height-c+6:t.y,r.y=n.y=t.height>c?t.y+i.y-d.y:i.y):t.y>d.y&&(d.y=t.y,r.y=n.y=i.y)),new Ve(d.x,d.y,u,c)},e.prototype.tooltipLocation=function(t,i,r,n){if(!m(this.tooltipPlacement)){var a=this.getCurrentPosition(t,i,r,n);return a}var o=new kn(i.x,i.y),l=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY,u=this.offset,c=this.clipBounds.x,d=this.clipBounds.y,p=t.x,f=t.y;return this.outOfBounds=!1,this.inverted?(o=new kn(o.x+c+u,o.y+d-this.elementSize.height/2-this.padding),r.y=n.y=h/2,(o.x+l+this.arrowPadding>p+t.width||this.isNegative)&&(o.x=(i.x>t.width+t.x?t.width:i.x)+c-u-(l+this.arrowPadding)),o.x<p&&(o.x=(i.x<0?0:i.x)+c+u),o.x+l+this.arrowPadding>p+t.width&&(o.x=(i.x>t.width+t.x?t.width:i.x)+c-u-(l+this.arrowPadding)),o.y<=f&&(r.y-=f-o.y,n.y-=f-o.y,o.y=f),o.y+h>=f+t.height&&(r.y+=o.y+h-(f+t.height),n.y+=o.y+h-(f+t.height),o.y-=o.y+h-(f+t.height)),r.y+this.arrowPadding>h-this.ry&&(r.y=h-this.ry-this.arrowPadding,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=n.y=this.ry+this.arrowPadding),this.controlName==="Chart"&&((o.y+r.y<this.areaMargin+this.arrowPadding||t.y+t.height-(o.y+r.y)<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!IL(o.x,o.y,t)||this.outOfBounds)&&(this.inverted=!this.inverted,o=new kn(i.x+c-this.padding-this.elementSize.width/2,i.y+d-this.elementSize.height-2*this.padding-u-this.arrowPadding),this.revert=!0,n.x=r.x=l/2,n.y=r.y=0,(o.y<f||this.isNegative)&&(o.y=(i.y<0?0:i.y)+u+d),o.y+this.arrowPadding+h>f+t.height&&(o.y=Math.min(i.y,f+t.height)+d-this.elementSize.height-2*this.padding-u-this.arrowPadding),n.x=l/2,o.x<p&&(n.x-=p-o.x,r.x-=p-o.x,o.x=p),o.x+l>t.width+p&&(r.x+=o.x+l-(t.width+p),n.x+=o.x+l-(t.width+p),o.x-=o.x+l-(t.width+p)),this.arrowPadding+r.x>l-this.rx&&(n.x=l-this.rx-this.arrowPadding,r.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding)))):(o=new kn(o.x+c-this.elementSize.width/2-this.padding,o.y+d-this.elementSize.height-2*(this.allowHighlight?this.highlightPadding:this.padding)-this.arrowPadding-u),r.x=n.x=l/2,(o.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(o.y=(i.y<0?0:i.y)+d+u),o.y+h+this.arrowPadding>f+t.height&&(o.y=Math.min(i.y,f+t.height)+d-this.elementSize.height-2*this.padding-this.arrowPadding-u),(o.x+l>p+t.width&&o.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(o.y=(i.y<0?0:i.y)+d+u),n.x=l/2,o.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-o.x,n.x-=p-o.x,o.x=p),o.x+l>p+t.width&&this.controlName!=="Progressbar"&&(r.x+=o.x+l-(p+t.width),n.x+=o.x+l-(p+t.width),o.x-=o.x+l-(p+t.width)),o.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-o.x,n.x-=p-o.x,o.x=p),r.x+this.arrowPadding>l-this.rx&&(r.x=l-this.rx-this.arrowPadding,n.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding),this.controlName==="Chart"&&((t.x+t.width-(o.x+r.x)<this.areaMargin+this.arrowPadding||o.x+r.x<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!IL(o.x,o.y,t)||this.outOfBounds)&&(this.inverted=!this.inverted,this.revert=!0,o=new kn(i.x+u+c,i.y+d-this.elementSize.height/2-this.padding),n.x=r.x=0,n.y=r.y=h/2,(o.x+this.arrowPadding+l>p+t.width||this.isNegative)&&(o.x=(i.x>p+t.width?t.width:i.x)+c-u-(this.arrowPadding+l)),o.x<p&&(o.x=(i.x<0?0:i.x)+u+c),o.y<=f&&(n.y-=f-o.y,r.y-=f-o.y,o.y=f),o.y+h>=t.height+f&&(r.y+=o.y+h-(t.height+f),n.y+=o.y+h-(t.height+f),o.y-=o.y+h-(t.height+f)),this.arrowPadding+r.y>h-this.ry&&(r.y=h-this.arrowPadding-this.ry,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=this.arrowPadding+this.ry,n.y=0)))),new Ve(o.x,o.y,l,h)},e.prototype.animateTooltipDiv=function(t,i){var r=this,n=parseFloat(t.style.left),a=parseFloat(t.style.top),o;new ri({}).animate(t,{duration:this.duration===0&&vi==="Enable"?300:this.duration,progress:function(l){o=l.timeStamp/l.duration,t.style.animation=null,r.controlName==="Chart"&&r.shared&&!r.enableRTL?(t.style.transition="transform 0.1s",t.style.transform="translate("+(n+o*(i.x-n))+"px,"+(a+o*(i.y-a))+"px)",t.style.left="",t.style.top=""):(t.style.left=n+o*(i.x-n)+"px",t.style.top=a+o*(i.y-a)+"px",t.style.transform=r.controlName==="RangeNavigator"?t.style.transform:"")},end:function(l){r.updateDiv(t,i.x,i.y),r.trigger("animationComplete",{tooltip:r})}})},e.prototype.updateDiv=function(t,i,r){this.controlName==="Chart"&&this.shared&&!this.crosshair&&!this.enableRTL?(t.style.transform="translate("+i+"px,"+r+"px)",t.style.left="",t.style.top=""):(t.style.left=i+"px",t.style.top=r+"px",t.style.transform=this.controlName==="RangeNavigator"?t.style.transform:"")},e.prototype.updateTemplateFn=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length?this.templateFn=pi(document.querySelector(this.template).innerHTML.trim()):this.templateFn=pi(this.template)}catch{this.templateFn=pi(this.template)}},e.prototype.fadeOut=function(){var t=this,i=this.isCanvas&&!this.template?Un(this.element.id+"_svg"):Un(this.element.id),r=Un(this.element.id);if(i){var n=i.firstChild;if(n.nodeType!==Node.ELEMENT_NODE&&(n=i.firstElementChild),this.isCanvas&&!this.template&&(n=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):n),!n)return null;var a=parseFloat(n.getAttribute("opacity"));a=m(a)?1:a,new ri({}).animate(n,{duration:200,progress:function(o){t.progressAnimation(n,a,o.timeStamp/o.duration)},end:function(){t.fadeOuted=!0,t.endAnimation(n),r.style.transition=""}})}},e.prototype.progressAnimation=function(t,i,r){t.style.animation="",t.setAttribute("opacity",(i-r).toString())},e.prototype.endAnimation=function(t){t.setAttribute("opacity","0"),this.template&&(t.style.display="none"),this.trigger("animationComplete",{tooltip:this})},e.prototype.getPersistData=function(){var t=[];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.destroy=function(){s.prototype.destroy.call(this),this.element.classList.remove("e-tooltip")},e.prototype.onPropertyChanged=function(t,i){this.blazorTemplate&&Yp(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()},dt([S(!1)],e.prototype,"enable",void 0),dt([S(!1)],e.prototype,"shared",void 0),dt([S(!1)],e.prototype,"crosshair",void 0),dt([S(!1)],e.prototype,"enableShadow",void 0),dt([S(null)],e.prototype,"fill",void 0),dt([S("")],e.prototype,"header",void 0),dt([S(.75)],e.prototype,"opacity",void 0),dt([Ee({size:"12px",fontWeight:null,color:null,fontStyle:"Normal",fontFamily:null},WQ)],e.prototype,"textStyle",void 0),dt([S(null)],e.prototype,"template",void 0),dt([S(!0)],e.prototype,"enableAnimation",void 0),dt([S(300)],e.prototype,"duration",void 0),dt([S(!1)],e.prototype,"inverted",void 0),dt([S(!1)],e.prototype,"isNegative",void 0),dt([Ee({color:null,width:null},qQ)],e.prototype,"border",void 0),dt([S([])],e.prototype,"content",void 0),dt([S(10)],e.prototype,"markerSize",void 0),dt([Ee({x:0,y:0},TL)],e.prototype,"clipBounds",void 0),dt([S([])],e.prototype,"palette",void 0),dt([S([])],e.prototype,"shapes",void 0),dt([Ee({x:0,y:0},TL)],e.prototype,"location",void 0),dt([S(0)],e.prototype,"offset",void 0),dt([S(4)],e.prototype,"rx",void 0),dt([S(4)],e.prototype,"ry",void 0),dt([S(5)],e.prototype,"marginX",void 0),dt([S(5)],e.prototype,"marginY",void 0),dt([S(7)],e.prototype,"arrowPadding",void 0),dt([S(null)],e.prototype,"data",void 0),dt([S("Material")],e.prototype,"theme",void 0),dt([Ee({x:0,y:0,width:0,height:0},YQ)],e.prototype,"areaBounds",void 0),dt([S(null)],e.prototype,"availableSize",void 0),dt([S()],e.prototype,"blazorTemplate",void 0),dt([S(!1)],e.prototype,"isCanvas",void 0),dt([S(!1)],e.prototype,"isTextWrap",void 0),dt([S(!1)],e.prototype,"isFixed",void 0),dt([S(null)],e.prototype,"tooltipPlacement",void 0),dt([S(null)],e.prototype,"controlInstance",void 0),dt([S("")],e.prototype,"controlName",void 0),dt([_()],e.prototype,"tooltipRender",void 0),dt([_()],e.prototype,"loaded",void 0),dt([_()],e.prototype,"animationComplete",void 0),dt([S(!1)],e.prototype,"enableRTL",void 0),dt([S(!1)],e.prototype,"allowHighlight",void 0),e=dt([Ot],e),e}(Pi),qa=function(){function s(e,t){e<t?(this.mStart=e,this.mEnd=t):(this.mStart=t,this.mEnd=e)}return Object.defineProperty(s.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),s}(),d2=function(){function s(e){this.isColumn=0,this.isStacking=!1,this.chart=e}return s.prototype.calculateNumericNiceInterval=function(e,t,i){var r=D2(i,e),n=t/r;if(!m(e.desiredIntervals)&&this.isAutoIntervalOnBothAxis(e))return n;for(var a=Math.pow(10,Math.floor(ch(n,10))),o=0,l=e.intervalDivs;o<l.length;o++){var h=l[o],u=a*h;if(r<t/u)break;n=u}return n},s.prototype.isAutoIntervalOnBothAxis=function(e){return!((e.zoomFactor<1||e.zoomPosition>0)&&e.enableAutoIntervalOnZooming)},s.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),!e.startFromZero&&this.isColumn>0?(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.max=e.doubleRange.end+e.actualRange.interval,e.doubleRange.start-e.actualRange.interval<0&&e.doubleRange.start>0?e.actualRange.min=0:e.actualRange.min=e.doubleRange.start-(this.isStacking?0:e.actualRange.interval)):(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end)},s.prototype.initializeDoubleRange=function(e){e.minimum!==null?this.min=e.minimum:(this.min===null||this.min===Number.POSITIVE_INFINITY)&&(this.min=0),e.maximum!==null?this.max=e.maximum:(this.max===null||this.max===Number.NEGATIVE_INFINITY)&&(this.max=5),this.min===this.max&&(this.max=e.valueType.indexOf("Category")>-1?this.max:this.min+1),e.doubleRange=new qa(this.min,this.max),e.actualRange={}},s.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)},s.prototype.calculateRange=function(e){/*! Generate axis range */if(this.min=null,this.max=null,!qM(e))for(var t=0,i=e.series;t<i.length;t++){var r=i[t];r.visible&&(this.paddingInterval=0,m(r.points)||(e.maxPointLength=r.points.length),e.maxPointLength=r.points.length,((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&e.orientation==="Horizontal"||r.type.indexOf("Bar")>-1&&e.orientation==="Vertical")&&(r.xAxis.valueType==="Double"||r.xAxis.valueType==="DateTime")&&r.xAxis.rangePadding==="Auto"&&(this.paddingInterval=T2(r.xAxis,e.series)*.5),e.orientation==="Horizontal"&&(this.chart.requireInvertedAxis?this.yAxisRange(e,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),e.orientation==="Vertical"&&(this.isColumn+=r.type.indexOf("Column")!==-1||r.type.indexOf("Bar")!==-1||r.drawType==="Column"?1:0,this.isStacking=r.type.indexOf("Stacking")!==-1,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(e,r)))}},s.prototype.yAxisRange=function(e,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=e.visibleRange.max&&(t.yMax=this.chart.dragY+e.visibleRange.interval),this.chart.dragY<=e.visibleRange.min&&(t.yMin=this.chart.dragY-e.visibleRange.interval)),this.findMinMax(t.yMin,t.yMax)},s.prototype.findMinMax=function(e,t){(this.min===null||this.min>e)&&(this.min=e),(this.max===null||this.max<t)&&(this.max=t),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},s.prototype.applyRangePadding=function(e,t){var i=e.actualRange.min,r=e.actualRange.max;if(!qM(e)){var n=e.actualRange.interval,a=e.getRangePadding(this.chart);a==="Additional"||a==="Round"?this.findAdditional(e,i,r,n,t):a==="Normal"?this.findNormal(e,i,r,n,t):this.updateActualRange(e,i,r,n)}e.actualRange.delta=e.actualRange.max-e.actualRange.min,this.calculateVisibleRange(t,e)},s.prototype.updateActualRange=function(e,t,i,r){e.actualRange={min:e.minimum!=null?e.minimum:t,max:e.maximum!=null?e.maximum:i,interval:e.interval!=null?e.interval:r,delta:e.actualRange.delta}},s.prototype.findAdditional=function(e,t,i,r,n){var a,o;if(a=Math.floor(t/r)*r,o=Math.ceil(i/r)*r,e.rangePadding==="Additional"&&(a-=r,o+=r),!m(e.desiredIntervals)){var l=o-a;r=this.calculateNumericNiceInterval(e,l,n)}this.updateActualRange(e,a,o,r)},s.prototype.findNormal=function(e,t,i,r,n){var a,o,l,h=t;t<0?(h=0,o=t+t*.05,a=r+o%r,.365*r>=a&&(o-=r),o%r<0&&(o=o-r-o%r)):(o=t<5/6*i?0:t-(i-t)*.5,o%r>0&&(o-=o%r)),l=i>0?i+(i-h)*.05:i-(i-h)*.05,a=r-l%r,.365*r>=a&&(l+=r),l%r>0&&(l=l+r-l%r),e.doubleRange=new qa(o,l),(o===0||o<0&&l<0)&&(r=this.calculateNumericNiceInterval(e,e.doubleRange.delta,n),l=Math.ceil(l/r)*r),this.updateActualRange(e,o,l,r)},s.prototype.calculateVisibleRange=function(e,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},this.chart.chartAreaType==="Cartesian"){var i=m(t.zoomingScrollBar)?!1:t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(e),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateNumericNiceInterval(t,t.doubleRange.delta,e):t.visibleRange.interval)}if(t.maximum&&t.orientation==="Vertical"&&t.rangePadding==="Auto"){for(var r=void 0,n=t.visibleRange.min;n<=t.visibleRange.max&&r!==n;n+=t.visibleRange.interval)r=n;r<t.visibleRange.max&&(t.visibleRange.max=r+t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},s.prototype.calculateVisibleLabels=function(e,t){/*! Generate axis labels */e.visibleLabels=[];var i=e.visibleRange.min,r,n=t.getModuleName(),a=n==="chart"&&t.chartAreaType==="PolarRadar";!a&&(e.zoomFactor<1||e.zoomPosition>0||this.paddingInterval)&&(i=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var o=this.getFormat(e),l=o.match("{value}")!==null,h=0,u=0;e.labelFormat&&e.labelFormat.indexOf("n")>-1&&(u=parseInt(e.labelFormat.substring(1,e.labelFormat.length),10)),e.format=t.intl.getNumberFormat({format:l?"":o,useGrouping:t.useGroupingSeparator}),e.startLabel=e.format(e.visibleRange.min),e.endLabel=e.format(e.visibleRange.max),e.visibleRange.interval&&(e.visibleRange.interval+"").indexOf(".")>=0&&(h=(e.visibleRange.interval+"").split(".")[1].length);for(var c;i<=e.visibleRange.max&&c!==i;i+=e.visibleRange.interval)c=i,r=me({},ie("properties",e.labelStyle),null,!0),Kh(i,e.visibleRange)&&WM(t,i,this.formatValue(e,l,o,i),r,e);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(u||h)?+i.toFixed(u||h):i,i<=e.visibleRange.max&&WM(t,i,this.formatValue(e,l,o,i),r,e)),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},s.prototype.getFormat=function(e){return e.labelFormat?e.labelFormat.indexOf("p")===0&&e.labelFormat.indexOf("{value}")===-1&&e.isStack100?"{value}%":e.labelFormat:e.isStack100?"{value}%":""},s.prototype.formatValue=function(e,t,i,r){var n=r%1?Number(r.toLocaleString().split(",").join("")):r;return t?i.replace("{value}",e.format(n)):i?e.format(r):e.format(n)},s}(),bl="legendClick",F0="load",GQ="animationComplete",DL="legendRender",P0="textRender",uh="pointRender",Dx="sharedTooltipRender",z0="seriesRender",AL="axisLabelRender",$Q="axisLabelClick",NL="axisRangeCalculated",j0="tooltipRender",p2="chartMouseMove",f2="chartMouseClick",v2="chartDoubleClick",m2="pointClick",XQ="pointDoubleClick",g2="pointMove",y2="chartMouseLeave",b2="chartMouseDown",C2="chartMouseUp",B0="resized",S2="beforeResize",kL="beforePrint",H0=/~\d+~/g,LL=/\^\d+\^/g,ku=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ot=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},KQ=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S("0")],e.prototype,"x",void 0),ot([S("0")],e.prototype,"y",void 0),ot([S(null)],e.prototype,"content",void 0),ot([S("Center")],e.prototype,"horizontalAlignment",void 0),ot([S("Pixel")],e.prototype,"coordinateUnits",void 0),ot([S("Chart")],e.prototype,"region",void 0),ot([S("Middle")],e.prototype,"verticalAlignment",void 0),ot([S(null)],e.prototype,"xAxisName",void 0),ot([S(null)],e.prototype,"yAxisName",void 0),ot([S(null)],e.prototype,"description",void 0),e}(ke),x2=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S("")],e.prototype,"color",void 0),ot([S(1)],e.prototype,"width",void 0),ot([S("Rectangle")],e.prototype,"type",void 0),e}(ke),ZQ=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S(null)],e.prototype,"start",void 0),ot([S(null)],e.prototype,"end",void 0),ot([S("")],e.prototype,"text",void 0),ot([S(null)],e.prototype,"maximumTextWidth",void 0),ot([S(null)],e.prototype,"customAttributes",void 0),ot([S("")],e.prototype,"type",void 0),e}(ke),JQ=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S(!0)],e.prototype,"visible",void 0),ot([S(!1)],e.prototype,"startFromAxis",void 0),ot([S(null)],e.prototype,"start",void 0),ot([S(null)],e.prototype,"end",void 0),ot([S(null)],e.prototype,"size",void 0),ot([S("#808080")],e.prototype,"color",void 0),ot([S(null)],e.prototype,"dashArray",void 0),ot([S("Auto")],e.prototype,"sizeType",void 0),ot([S(!1)],e.prototype,"isRepeat",void 0),ot([S(null)],e.prototype,"repeatEvery",void 0),ot([S(null)],e.prototype,"repeatUntil",void 0),ot([S(!1)],e.prototype,"isSegmented",void 0),ot([S(null)],e.prototype,"segmentStart",void 0),ot([S(null)],e.prototype,"segmentEnd",void 0),ot([S(null)],e.prototype,"segmentAxisName",void 0),ot([Ee({color:"transparent",width:1},Bn)],e.prototype,"border",void 0),ot([S("")],e.prototype,"text",void 0),ot([S(null)],e.prototype,"rotation",void 0),ot([S("Middle")],e.prototype,"horizontalAlignment",void 0),ot([S("Middle")],e.prototype,"verticalAlignment",void 0),ot([Ee({size:"12px",color:null,fontStyle:"Normal",fontWeight:"400",fontFamily:null},cs)],e.prototype,"textStyle",void 0),ot([S("Behind")],e.prototype,"zIndex",void 0),ot([S(1)],e.prototype,"opacity",void 0),ot([S("")],e.prototype,"imageUrl",void 0),e}(ke),eG=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S("Center")],e.prototype,"alignment",void 0),ot([S("Wrap")],e.prototype,"overflow",void 0),ot([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"textStyle",void 0),ot([Ee({color:null,width:1,type:"Rectangle"},x2)],e.prototype,"border",void 0),ot([ii([],ZQ)],e.prototype,"categories",void 0),e}(ke),tG=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S(null)],e.prototype,"minimum",void 0),ot([S(null)],e.prototype,"maximum",void 0),e}(ke),iG=function(s){ku(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return ot([S(!1)],e.prototype,"enable",void 0),ot([S(null)],e.prototype,"pointsLength",void 0),ot([Ee({},tG)],e.prototype,"range",void 0),ot([S(null)],e.prototype,"trackColor",void 0),ot([S(0)],e.prototype,"scrollbarRadius",void 0),ot([S(null)],e.prototype,"scrollbarColor",void 0),ot([S(0)],e.prototype,"trackRadius",void 0),ot([S(null)],e.prototype,"gripColor",void 0),ot([S(16)],e.prototype,"height",void 0),ot([S(!0)],e.prototype,"enableZoom",void 0),e}(ke),Zo=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ye=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},rG=function(s){Zo(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t}return e.prototype.computeSize=function(t,i,r,n){var a=0,o=t.labelPosition==="Inside"&&n.axes.indexOf(t)>-1?-5:5;t.visible&&t.internalVisibility&&(a+=t.findTickSize(t.crossInAxis)+i+t.findLabelSize(t.crossInAxis,o,r,n)+t.lineStyle.width*.5),t.isAxisOpposedPosition?this.farSizes.push(a):this.nearSizes.push(a)},Ye([S("100%")],e.prototype,"height",void 0),Ye([Ee({},Bn)],e.prototype,"border",void 0),e}(ke),nG=function(s){Zo(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t.padding=0,t}return e.prototype.computeSize=function(t,i,r,n){var a=0,o=5;t.visible&&t.internalVisibility&&(a+=t.findTickSize(t.crossInAxis)+i+t.findLabelSize(t.crossInAxis,o,r,n)+t.lineStyle.width*.5),t.isAxisOpposedPosition?this.farSizes.push(a):this.nearSizes.push(a)},Ye([S("100%")],e.prototype,"width",void 0),Ye([Ee({},Bn)],e.prototype,"border",void 0),e}(ke),sG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(1)],e.prototype,"width",void 0),Ye([S("")],e.prototype,"dashArray",void 0),Ye([S(null)],e.prototype,"color",void 0),e}(ke),aG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(.7)],e.prototype,"width",void 0),Ye([S("")],e.prototype,"dashArray",void 0),Ye([S(null)],e.prototype,"color",void 0),e}(ke),oG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(1)],e.prototype,"width",void 0),Ye([S("")],e.prototype,"dashArray",void 0),Ye([S(null)],e.prototype,"color",void 0),e}(ke),lG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(1)],e.prototype,"width",void 0),Ye([S(5)],e.prototype,"height",void 0),Ye([S(null)],e.prototype,"color",void 0),e}(ke),hG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(.7)],e.prototype,"width",void 0),Ye([S(5)],e.prototype,"height",void 0),Ye([S(null)],e.prototype,"color",void 0),e}(ke),uG=function(s){Zo(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Ye([S(!1)],e.prototype,"enable",void 0),Ye([S(null)],e.prototype,"fill",void 0),Ye([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"textStyle",void 0),e}(ke),ag=function(s){Zo(e,s);function e(t,i,r,n){var a=s.call(this,t,i,r,n)||this;return a.visibleLabels=[],a.series=[],a.rect=new Ve(void 0,void 0,0,0),a.axisBottomLine=null,a.intervalDivs=[10,5,2,1],a.isStack100=!1,a.crossAt=null,a.updatedRect=null,a.multiLevelLabelHeight=0,a.isChart=!0,a.isIntervalInDecimal=!0,a.titleCollection=[],a.titleSize=new ei(0,0),a.internalVisibility=!0,a.isRTLEnabled=!1,a.angle=a.labelRotation,a}return e.prototype.findTickSize=function(t){return this.tickPosition==="Inside"||t&&(!t.visibleRange||this.isInside(t.visibleRange))?0:this.majorTickLines.height},e.prototype.isInside=function(t){return Op(this.crossAt,t)||!this.isAxisOpposedPosition&&this.crossAt>=t.max||this.isAxisOpposedPosition&&this.crossAt<=t.min},e.prototype.findLabelSize=function(t,i,r,n){var a=0,o=this.orientation==="Horizontal";if(this.title){var l=this.titleRotation;if(m(l)?(this.titleSize=ht(this.title,this.titleStyle,n.themeStyle.axisTitleFont),a=this.titleSize.height+i):(this.titleSize=Ng(this.titleStyle,this.title,l,n),a=(this.orientation==="Vertical"?this.titleSize.width:this.titleSize.height)+i),this.rect.width||this.rect.height){var h=o?this.rect.width:this.rect.height;this.titleCollection=Od(this.title,this.titleStyle,h,n.enableRtl,n.themeStyle.legendLabelFont),a=a*this.titleCollection.length}}var u,c,d=a+i+this.titlePadding+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(t&&this.placeNextToAxisLine){var p=t.visibleRange,f=t.orientation==="Horizontal"?t.rect.width:t.rect.height;if(!p||!f)return 0;this.isInside(p)&&(c=this.findDifference(t),u=c*(f/p.delta),u=c*((f-(u<d?d-u:0))/p.delta),d=u<d?d-u:0)}return this.isAxisOpposedPosition?r.insideFarSizes.push(d):r.insideNearSizes.push(d),this.labelPosition==="Inside"?a+i:d},e.prototype.updateCrossValue=function(){var t=this.crossAt;if(t===null||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var i=this.crossInAxis.visibleRange;this.isAxisOpposedPosition?this.crossAt<i.min&&(t=i.min):this.crossAt>i.max&&(t=i.max),this.updatedRect=me({},this.rect,null,!0),this.orientation==="Horizontal"?(t=this.crossInAxis.rect.height-mn(t,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+t):(t=mn(t,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+t)},e.prototype.findDifference=function(t){var i=0;return this.isAxisOpposedPosition?i=t.isAxisInverse?t.visibleRange.min:t.visibleRange.max:i=t.isAxisInverse?t.visibleRange.max:t.visibleRange.min,Math.abs(this.crossAt-i)},e.prototype.calculateVisibleRangeOnZooming=function(t){if(Rp(this)){var i=this.actualRange,r=void 0,n=void 0;this.isAxisInverse?(r=this.actualRange.max-this.zoomPosition*this.actualRange.delta,n=r-this.zoomFactor*this.actualRange.delta):(r=this.actualRange.min+this.zoomPosition*this.actualRange.delta,n=r+this.zoomFactor*this.actualRange.delta),r<i.min&&(n=n+(i.min-r),r=i.min),n>i.max&&(r=r-(n-i.max),n=i.max),this.doubleRange=new qa(r,n),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},e.prototype.triggerRangeRender=function(t,i,r,n){var a={cancel:!1,name:NL,axis:this,minimum:i,maximum:r,interval:n};t.trigger(NL,a),a.cancel||(this.visibleRange={min:a.minimum,max:a.maximum,interval:a.interval,delta:a.maximum-a.minimum})},e.prototype.getRangePadding=function(t){var i=this.rangePadding;if(i!=="Auto")return i;switch(this.orientation){case"Horizontal":t.requireInvertedAxis?i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":i="None";break;case"Vertical":t.requireInvertedAxis?i="None":i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal";break}return i},e.prototype.getMaxLabelWidth=function(t){var i,r=0,n=!1,a;this.angle=this.labelRotation,this.maxLabelSize=new ei(0,0);for(var o=this.labelIntersectAction,l,h=0,u=this.visibleLabels.length;h<u;h++){l=this.visibleLabels[h],a=Xh(l.originalText),a?(l.size=ht(l.originalText.replace(/<br>/g," "),this.labelStyle,t.themeStyle.axisLabelFont),l.breakLabelSize=ht(this.enableTrim?l.text.join("<br>"):l.originalText,this.labelStyle,t.themeStyle.axisLabelFont)):l.size=ht(l.text,this.labelStyle,t.themeStyle.axisLabelFont);var c=a?l.breakLabelSize.width:l.size.width;c>this.maxLabelSize.width&&(this.maxLabelSize.width=c,this.rotatedLabel=l.text);var d=a?l.breakLabelSize.height:l.size.height;if(d>this.maxLabelSize.height&&(this.maxLabelSize.height=d),a&&(l.text=this.enableTrim?l.text:l.originalText.split("<br>")),!(o==="None"||o==="Hide"||o==="Trim")&&(o!=="None"||this.angle%360===0)&&this.orientation==="Horizontal"&&this.rect.width>0&&!n){var p=a?l.breakLabelSize.width:l.size.width;switch(i=mn(l.value,this)*this.rect.width+this.rect.x,i-=p/2,this.edgeLabelPlacement==="Shift"&&(h===0&&i<this.rect.x&&(i=this.rect.x),h===this.visibleLabels.length-1&&i+p>this.rect.x+this.rect.width&&(i=this.rect.x+this.rect.width-p)),o){case"MultipleRows":h>0&&this.findMultiRows(h,i,l,a);break;case"Rotate45":case"Rotate90":h>0&&(this.isAxisInverse?i+p>=r:i<=r)&&(this.angle=o==="Rotate45"?45:90,n=!0);break;default:if(a){for(var f=void 0,v=[],g=void 0,b=0;b<l.text.length;b++)if(f=dh(l.text[b],this.rect.width/this.visibleLabels.length,this.labelStyle,t.enableRtl,null,null,t.themeStyle.axisLabelFont),f.length>1)for(var y=0;y<f.length;y++)g=f[y],v.push(g);else v.push(f[0]);l.text=v}else l.text=dh(l.text,this.rect.width/this.visibleLabels.length,this.labelStyle,t.enableRtl,null,null,t.themeStyle.axisLabelFont);var C=l.size.height*l.text.length;C>this.maxLabelSize.height&&(this.maxLabelSize.height=C);break}r=this.isAxisInverse?i:i+p}}if(this.angle!==0&&this.orientation==="Horizontal"){this.rotatedLabel=m(this.rotatedLabel)?"":this.rotatedLabel;var x=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!x&&Xh(this.rotatedLabel)?this.maxLabelSize=new ei(this.maxLabelSize.height,this.maxLabelSize.width):t.stockChart||(this.maxLabelSize=Ng(this.labelStyle,this.rotatedLabel,this.angle,t))}else if(this.angle!==0&&this.orientation==="Vertical"){this.rotatedLabel=m(this.rotatedLabel)?"":this.rotatedLabel;var x=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!x&&Xh(this.rotatedLabel)?this.maxLabelSize=new ei(this.maxLabelSize.height,this.maxLabelSize.width):t.stockChart||(this.maxLabelSize=Ng(this.labelStyle,this.rotatedLabel,this.angle,t))}t.multiLevelLabelModule&&this.multiLevelLabels.length>0&&t.multiLevelLabelModule.getMultilevelLabelsHeight(this)},e.prototype.findMultiRows=function(t,i,r,n){for(var a,o,l,h=[],u,c=t-1;c>=0;c--)a=this.visibleLabels[c],l=n?a.breakLabelSize.width:a.size.width,o=mn(a.value,this)*this.rect.width+this.rect.x,u=this.isAxisInverse?i+r.size.width>o-l*.5:i<o+l*.5,u?(h.push(a.index),r.index=r.index>a.index?r.index:a.index+1):r.index=h.indexOf(a.index)>-1?r.index:a.index;var d=(n?r.breakLabelSize.height:r.size.height)*r.index+5*(r.index-1);d>this.maxLabelSize.height&&(this.maxLabelSize.height=d)},e.prototype.getModule=function(t){this.valueType==="Double"?this.baseModule=new d2(t):this.baseModule=t[ao(this.valueType)+"Module"]},e.prototype.setIsInversedAndOpposedPosition=function(t){t===void 0&&(t=!1),this.isAxisOpposedPosition=this.opposedPosition||!t&&this.isRTLEnabled&&this.orientation==="Vertical",this.opposedPosition&&!t&&this.isRTLEnabled&&this.orientation==="Vertical"&&(this.isAxisOpposedPosition=!1),this.isAxisInverse=this.isInversed||this.isRTLEnabled&&this.orientation==="Horizontal",this.isInversed&&!t&&this.isRTLEnabled&&this.orientation==="Horizontal"&&(this.isAxisInverse=!1)},Ye([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"labelStyle",void 0),Ye([Ee({},uG)],e.prototype,"crosshairTooltip",void 0),Ye([S("")],e.prototype,"title",void 0),Ye([Ee({fontFamily:null,size:"14px",fontStyle:"Normal",fontWeight:"600",color:null},cs)],e.prototype,"titleStyle",void 0),Ye([S("")],e.prototype,"labelFormat",void 0),Ye([S("")],e.prototype,"skeleton",void 0),Ye([S("DateTime")],e.prototype,"skeletonType",void 0),Ye([S("Center")],e.prototype,"lineBreakAlignment",void 0),Ye([S(0)],e.prototype,"plotOffset",void 0),Ye([S(null)],e.prototype,"plotOffsetLeft",void 0),Ye([S(null)],e.prototype,"plotOffsetTop",void 0),Ye([S(null)],e.prototype,"plotOffsetRight",void 0),Ye([S(null)],e.prototype,"plotOffsetBottom",void 0),Ye([S(!1)],e.prototype,"isIndexed",void 0),Ye([S(10)],e.prototype,"logBase",void 0),Ye([S(0)],e.prototype,"columnIndex",void 0),Ye([S(0)],e.prototype,"rowIndex",void 0),Ye([S(1)],e.prototype,"span",void 0),Ye([S(null)],e.prototype,"desiredIntervals",void 0),Ye([S(3)],e.prototype,"maximumLabels",void 0),Ye([S(1)],e.prototype,"zoomFactor",void 0),Ye([S(0)],e.prototype,"zoomPosition",void 0),Ye([S(!0)],e.prototype,"enableScrollbarOnZooming",void 0),Ye([S(!1)],e.prototype,"opposedPosition",void 0),Ye([S(!0)],e.prototype,"enableAutoIntervalOnZooming",void 0),Ye([S("Auto")],e.prototype,"rangePadding",void 0),Ye([S("Double")],e.prototype,"valueType",void 0),Ye([S("None")],e.prototype,"edgeLabelPlacement",void 0),Ye([S("Auto")],e.prototype,"intervalType",void 0),Ye([S("BetweenTicks")],e.prototype,"labelPlacement",void 0),Ye([S("Outside")],e.prototype,"tickPosition",void 0),Ye([S("Outside")],e.prototype,"labelPosition",void 0),Ye([S("")],e.prototype,"name",void 0),Ye([S(!0)],e.prototype,"visible",void 0),Ye([S(0)],e.prototype,"minorTicksPerInterval",void 0),Ye([S(0)],e.prototype,"labelRotation",void 0),Ye([S(null)],e.prototype,"titleRotation",void 0),Ye([S(null)],e.prototype,"crossesAt",void 0),Ye([S(!0)],e.prototype,"placeNextToAxisLine",void 0),Ye([S(null)],e.prototype,"crossesInAxis",void 0),Ye([S(null)],e.prototype,"minimum",void 0),Ye([S(null)],e.prototype,"maximum",void 0),Ye([S(null)],e.prototype,"interval",void 0),Ye([S(34)],e.prototype,"maximumLabelWidth",void 0),Ye([S(!1)],e.prototype,"enableTrim",void 0),Ye([S(5)],e.prototype,"labelPadding",void 0),Ye([S(5)],e.prototype,"titlePadding",void 0),Ye([Ee({},lG)],e.prototype,"majorTickLines",void 0),Ye([Ee({},hG)],e.prototype,"minorTickLines",void 0),Ye([Ee({},sG)],e.prototype,"majorGridLines",void 0),Ye([Ee({},aG)],e.prototype,"minorGridLines",void 0),Ye([Ee({},oG)],e.prototype,"lineStyle",void 0),Ye([S(B.isDevice?"Rotate45":"Trim")],e.prototype,"labelIntersectAction",void 0),Ye([S(!1)],e.prototype,"isInversed",void 0),Ye([S(100)],e.prototype,"coefficient",void 0),Ye([S(0)],e.prototype,"startAngle",void 0),Ye([S(!0)],e.prototype,"startFromZero",void 0),Ye([S(null)],e.prototype,"description",void 0),Ye([S(2)],e.prototype,"tabIndex",void 0),Ye([ii([],JQ)],e.prototype,"stripLines",void 0),Ye([ii([],eG)],e.prototype,"multiLevelLabels",void 0),Ye([Ee({color:null,width:0,type:"Rectangle"},x2)],e.prototype,"border",void 0),Ye([Ee({},iG)],e.prototype,"scrollbarSettings",void 0),e}(ke),cG=function(){function s(e,t,i,r,n,a,o){n===void 0&&(n=new ei(0,0)),a===void 0&&(a=new ei(0,0)),o===void 0&&(o=1),this.text=e,this.originalText=r,this.value=t,this.labelStyle=i,this.size=n,this.breakLabelSize=a,this.index=o}return s}(),w2=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function M2(s,e,t){for(var i=me([],s,null),r=0;r<i.length;r++)for(var n=0;n<e.length;n++)i[r][e[n]]instanceof Date&&(i[r][e[n]]=i[r][e[n]].getTime());return i.sort(function(a,o){for(var l=0,h=0,u=0;u<e.length;u++)l+=a[e[u]],h+=o[e[u]];return!t&&l<h||t&&l>h?-1:l===h?0:1}),i}function Xh(s){return s.indexOf("<br>")!==-1}function jh(s){for(var e=me([],s.points,null,!0),t=[],i,r=0,n=0;n<e.length;n++)i=e[n],!m(i.x)&&(i.index=r++,t.push(i));return t}function Ng(s,e,t,i){var r=i.element.style.transform;r&&(i.element.style.transform="");var n=new Nu(i.element.id),a,o=[],l,h,u,c,d={id:"rotate_text",x:i.initialClipRect.x,y:i.initialClipRect.y,"font-size":s.size,"font-style":s.fontStyle,"font-family":s.fontFamily,"font-weight":s.fontWeight,transform:"rotate("+t+", 0, 0)","text-anchor":"middle"};Xh(e)?(o=e.split("<br>"),a=o[0]):a=e;var p=n.createText(d,a);if(!i.delayRedraw&&!i.redraw&&i.element.appendChild(i.svgObject),typeof o!="string"&&o.length>1)for(var f=1,v=o.length;f<v;f++)l=ht(o[f],s,i.themeStyle.axisLabelFont).height,h=d.y+f*l,u=o[f],c=n.createTSpan({x:d.x,id:d.id,y:h},u),p.appendChild(c);i.svgObject.appendChild(p);var g=p.getBoundingClientRect();if(r&&(i.element.style.transform=r),pt(p),!i.delayRedraw&&!i.redraw&&pt(i.svgObject),i.enableCanvas){var b=ht(e,s,i.themeStyle.axisLabelFont).width,y=ht(e,s,i.themeStyle.axisLabelFont).height,C=t*Math.PI/180,x=Math.abs(Math.cos(C)*b)+Math.abs(Math.sin(C)*y),w=Math.abs(Math.sin(C)*b)+Math.abs(Math.cos(C)*y);return new ei(x,w)}return new ei(g.right-g.left,g.bottom-g.top)}function di(s){if(!s)return null;var e=typeof s=="string"?Qe(s):s;e&&pt(e)}function ch(s,e){return Math.log(s)/Math.log(e)}function Ld(s,e,t,i,r,n,a,o){var l=document.getElementById(r),h=ht(s,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),u=h.width+5;if(e=e+u>i?e-(u+15):e,t=o?t-h.height/2:t+15,l)l.innerText=s,l.style.top=t.toString()+"px",l.style.left=(e+15).toString()+"px";else{l=St("div",{id:r,styles:"top:"+t.toString()+"px;left:"+(e+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),l.innerText=s,n.appendChild(l);var c=parseInt(l.style.left.replace("px",""),10);c<0&&(l.style.left="0px")}a&&setTimeout(function(){di(r)},1500)}function Op(s,e){return s<e.max&&s>e.min}function Kh(s,e){return s<=e.max&&s>=e.min}function tf(s,e){return e.valueType==="Logarithmic"?ch(s,e.logBase):s}function Jo(s,e,t,i){var r=tf(e.xValue,i.xAxis),n=s?tf(s.xValue,i.xAxis):r,a=t?tf(t.xValue,i.xAxis):r,o=Math.floor(i.xAxis.visibleRange.min),l=Math.ceil(i.xAxis.visibleRange.max);return n>=o&&n<=l||r>=o&&r<=l||a>=o&&a<=l||o>=n&&o<=a}function dn(s){for(var e=0,t=0,i=s;t<i.length;t++){var r=i[t];e+=r}return e}function Ga(s,e){return s.x+=e.left,s.y+=e.top,s.width-=e.left+e.right,s.height-=e.top+e.bottom,s}function dG(s,e){return s.x+=e.x,s.y+=e.y,s.width-=e.x+e.width,s.height-=e.y+e.height,s}function Jr(s,e,t){var i=s*Math.PI/180;return new ut(Math.cos(i)*e+t.x,Math.sin(i)*e+t.y)}function og(s){return s*(Math.PI/180)}function _M(s,e,t,i){for(var r=[],n=0;n<4;n++){var a=s[n],o=a.x-e,l=a.y-t,h=o*Math.cos(og(i))-l*Math.sin(og(i)),u=o*Math.sin(og(i))+l*Math.cos(og(i));a.x=h+e,a.y=u+t,r.push(new ut(a.x,a.y))}return r}function E2(s,e){var t=[s,e],i,r,n,a,o,l,h,u;for(a=0;a<t.length;a++){var c=t[a];for(o=0;o<c.length;o++){var d=(o+1)%c.length,p=c[o],f=c[d],v=new ut(f.y-p.y,p.x-f.x);for(i=r=void 0,l=0;l<s.length;l++)n=v.x*s[l].x+v.y*s[l].y,(m(i)||n<i)&&(i=n),(m(r)||n>r)&&(r=n);for(h=u=void 0,l=0;l<e.length;l++)n=v.x*e[l].x+v.y*e[l].y,(m(h)||n<h)&&(h=n),(m(u)||n>u)&&(u=n);if(r<h||u<i)return!1}}return!0}function pG(s,e,t,i,r,n){var a=Jr(270,t,new ut(s,e)),o=Jr(270,t,new ut(s+r/10,e));return"M "+s+" "+e+" L "+(s+t)+" "+e+" A "+t+" "+t+" 0 1 1 "+a.x+" "+a.y+" Z M "+(s+r/10)+" "+(e-i/10)+" L"+(s+t)+" "+(e-i/10)+" A "+t+" "+t+" 0 0 0 "+o.x+" "+o.y+" Z"}function fG(s,e){var t=Math.atan2(e.y-s.y,e.x-s.x);return t=t<0?6.283+t:t,t*(180/Math.PI)}function fl(s,e){for(var t=[],i=0;i<=e-1;i++)t.push(s[i]);return t}function mn(s,e){var t=e.visibleRange,i=(s-t.min)/t.delta,r=e.isChart?e.isAxisInverse:e.isInversed;return r?1-i:i}function kv(s,e,t,i,r,n){s=t.valueType==="Logarithmic"?ch(s>1?s:1,t.logBase):s,e=i.valueType==="Logarithmic"?ch(e>1?e:1,i.logBase):e,s+=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"&&n.type!=="Radar"?.5:0;var a=n.chart.radius*mn(e,i),o=vG(I2(s,t),n.chart.primaryXAxis.startAngle);return{x:n.clipRect.width/2+n.clipRect.x+a*o.x,y:n.clipRect.height/2+n.clipRect.y+a*o.y}}function uv(s,e){e===void 0&&(e=!1);var t=["NaN","NaN"];return s.indexOf("_Point_")>-1?t=s.split("_Series_")[1].split("_Point_"):s.indexOf("_shape_")>-1&&(!e||e&&s.indexOf("_legend_")===-1)?(t=s.split("_shape_"),t[0]="0"):s.indexOf("_text_")>-1&&(!e||e&&s.indexOf("_legend_")===-1)&&(t=s.split("_text_"),t[0]="0"),new RQ(parseInt(t[0],10),parseInt(t[1],10))}function vG(s,e){e=e<0?e+360:e;var t=Math.PI*(1.5-2*s);return t=t+e*Math.PI/180,{x:Math.cos(t),y:Math.sin(t)}}function I2(s,e){var t=e.visibleRange,i,r;return e.valueType!=="Category"?(i=t.max-(e.valueType==="DateTime"?e.dateTimeInterval:t.interval)-t.min,r=e.visibleLabels.length-1,i=i===0?1:i):(i=e.visibleLabels.length===1?1:e.visibleLabels[e.visibleLabels.length-1].value-e.visibleLabels[0].value,r=e.visibleLabels.length),e.isAxisInverse?(s-t.min)/i*(1-1/r):1-(s-t.min)/i*(1-1/r)}function mG(s,e,t,i,r,n){for(var a=5,o=e.isAxisOpposedPosition,l=r?"start":"auto",h,u=s.availableSize.width,c,d,p,f=3,v,g,b=e.scrollbarSettings.enable||e.zoomingScrollBar&&e.zoomingScrollBar.svgObject?e.scrollBarHeight:0,y=0;y<2;y++){if(h=ht(y?e.endLabel:e.startLabel,e.labelStyle,s.themeStyle.axisLabelFont),r?(v=y?new ut(n.x-b,n.y+f):new ut(e.rect.x-b,n.y+n.height-f),d=n.x+(o?n.width+a+b:-(h.width+a+a+b)),p=n.y+(y?0:n.height-h.height-a),d+=d<0||u<d+h.width+a?o?-(h.width/2):h.width/2:0,g=OL(f,f,new Ve(d,p,h.width+a,h.height+a),v,a,!1,!1,!o,v.x,v.y+(y?-f:f))):(v=y?new ut(n.x+n.width-f,n.y+n.height+b):new ut(n.x+f,n.y+n.height+b),d=n.x+(y?n.width-h.width-a:0),p=o?n.y-h.height-10-b:n.y+n.height+a+b,g=OL(f,f,new Ve(d,p,h.width+a,h.height+a),v,a,o,!o,!1,v.x+(y?f:-f),v.y)),d=d+a/2,p=p+3*(h.height/4)+a/2,c=s.renderer.drawPath({id:s.element.id+"_Zoom_"+i+"_AxisLabel_Shape_"+y,fill:s.themeStyle.crosshairFill,width:2,color:s.themeStyle.crosshairFill,opacity:1,"stroke-dasharray":null,d:g},null),t.appendChild(c),s.theme==="Fluent"||s.theme==="FluentDark"){var C=s.element.id+"_shadow";c.setAttribute("filter",B.isIE?"":"url(#"+C+")");var x='<filter id="'+C+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';x+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',x+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var w=s.renderer.createDefs();w.setAttribute("id",s.element.id+"SVG_tooltip_definition"),t.appendChild(w),w.innerHTML=x,c.setAttribute("stroke","#cccccc"),c.setAttribute("stroke-width","0.5")}bn(s.renderer,new Sn(s.element.id+"_Zoom_"+i+"_AxisLabel_"+y,d,p,l,y?e.endLabel:e.startLabel),{color:s.themeStyle.crosshairLabelFont.color,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},s.themeStyle.crosshairLabelFont.color,t,null,null,null,null,null,null,null,null,null,null,s.themeStyle.crosshairLabelFont)}return t}function OL(s,e,t,i,r,n,a,o,l,h){var u="",c=t.x,d=t.y,p=t.x+t.width,f=t.y+t.height;return n?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+s)+" "+d),u=u.concat(" L "+(p-s)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-s)+" "+f),r!==0&&(u=u.concat(" L "+(i.x+r/2)+" "+f),u=u.concat(" L "+l+" "+(f+r)+" L "+(i.x-r/2)+" "+f)),i.x-r/2>c||r===0?u=u.concat(" L "+(c+s)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z"):u=u.concat(" L "+c+" "+(f+e)+" z")):a?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+s)+" "+d+" L "+(i.x-r/2)+" "+d),u=u.concat(" L "+l+" "+i.y),u=u.concat(" L "+(i.x+r/2)+" "+d),u=u.concat(" L "+(p-s)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-s)+" "+f),u=u.concat(" L "+(c+s)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z")):o?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+s)+" "+d),u=u.concat(" L "+(p-s)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)+" L "+p+" "+(i.y-r/2)),u=u.concat(" L "+(p+r)+" "+h),u=u.concat(" L "+p+" "+(i.y+r/2)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-s)+" "+f),u=u.concat(" L "+(c+s)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z")):(u=u.concat("M "+(c+s)+" "+d+" Q "+c+" "+d+" "+c+" "+(d+e)+" L "+c+" "+(i.y-r/2)),u=u.concat(" L "+(c-r)+" "+h),u=u.concat(" L "+c+" "+(i.y+r/2)),u=u.concat(" L "+c+" "+(f-e)+" Q "+c+" "+f+" "+(c+s)+" "+f),u=u.concat(" L "+(p-s)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-e)),u=u.concat(" L "+p+" "+(d+e)+" Q "+p+" "+d+" "+(p-s)+" "+d+" z")),u}function Mn(s,e,t,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),s>=t.x-i&&s<=t.x+t.width+i&&e>=t.y-r&&e<=t.y+t.height+r}function gG(s,e,t){var i=t.isAxisInverse?1-s/e:s/e;return i*t.visibleRange.delta+t.visibleRange.min}function yG(s,e,t){var i=t.isAxisInverse?s/e:1-s/e;return i*t.visibleRange.delta+t.visibleRange.min}function bG(s,e){e===void 0&&(e=!1);var t=s.clipRect;e&&(s.type==="Polar"||s.type==="Radar")?s.drawType==="Scatter"?(t.x=s.xAxis.rect.x,t.y=s.yAxis.rect.y,t.width=s.xAxis.rect.width,t.height=s.yAxis.rect.height):(t.x=s.xAxis.rect.x/2,t.y=s.yAxis.rect.y/2,t.width=s.xAxis.rect.width,t.height=s.yAxis.rect.height):s.chart.requireInvertedAxis?(t.x=s.yAxis.rect.x,t.y=s.xAxis.rect.y,t.width=s.yAxis.rect.width,t.height=s.xAxis.rect.height):(t.x=s.xAxis.rect.x,t.y=s.yAxis.rect.y,t.width=s.xAxis.rect.width,t.height=s.yAxis.rect.height)}function ao(s){return s.substr(0,1).toLowerCase()+s.substr(1)}function T2(s,e){for(var t=Number.MAX_VALUE,i,r,n,a=0;a<e.length;a++){var o=e[a];if(i=[],o.visible&&(s.name===o.xAxisName||s.name==="primaryXAxis"&&o.xAxisName===null||s.name===o.chart.primaryXAxis.name&&!o.xAxisName))if(i=o.points.map(function(u){return u.xValue}),i.sort(function(u,c){return u-c}),i.length===1)n=s.valueType==="DateTime"&&o.xMin===o.xMax?o.xMin-2592e4:o.xMin,r=i[0]-(m(n)?s.visibleRange.min:n),r!==0&&(t=Math.min(t,r));else for(var l=0;l<i.length;l++){var h=i[l];l>0&&h&&(r=h-i[l-1],r!==0&&(t=Math.min(t,r)))}}return t===Number.MAX_VALUE&&(t=1),t}function qI(s){var e;switch(s){case"Linear":e=gn;break}return e}function gn(s,e,t,i){return-t*Math.cos(s/i*(Math.PI/2))+t+e}function cv(s,e,t,i,r,n,a){var o=n.x,l=n.y,h=0;s.style.visibility="hidden";var u=s.getAttribute("transform");new ri({}).animate(s,{duration:t,delay:e,progress:function(c){c.timeStamp>c.delay&&(c.element.style.visibility="visible",h=(c.timeStamp-c.delay)/c.duration,s.setAttribute("transform","translate("+o+" "+l+") scale("+h+") translate("+-o+" "+-l+")"))},end:function(){s.style.visibility="",s.setAttribute("transform",u||""),(i.type==="Scatter"||i.type==="Bubble")&&!a&&r===i.points.length-1&&i.chart.trigger("animationComplete",{series:i.chart.isBlazor?{}:i})}})}function CG(s,e,t,i,r){var n=function(a){s.setAttribute("x",a.x+""),s.setAttribute("y",a.y+""),s.setAttribute("width",a.width+""),s.setAttribute("height",a.height+"")};new ri({}).animate(St("div"),{duration:t,delay:e,progress:function(a){n(new Ve(gn(a.timeStamp,r.x,i.x-r.x,a.duration),gn(a.timeStamp,r.y,i.y-r.y,a.duration),gn(a.timeStamp,r.width,i.width-r.width,a.duration),gn(a.timeStamp,r.height,i.height-r.height,a.duration)))},end:function(){n(i)}})}function Nb(s,e,t,i,r){if(!t||!i&&!s)return null;var n=300;r&&(n=r);var a=i||s.getAttribute("d"),o=a.split(/(?=[LMCZAQ])/),l=e.split(/(?=[LMCZAQ])/),h,u=[],c=[],d,p;s.setAttribute("d",a),new ri({}).animate(St("div"),{duration:n,progress:function(f){h="",o.map(function(v,g){if(u=v.split(" "),c=l[g]?l[g].split(" "):u,u[0]==="Z"?h+="Z ":u[0]===""?h="":h+=u[0]+" "+gn(f.timeStamp,+u[1],+c[1]-+u[1],f.duration)+" "+gn(f.timeStamp,+u[2],+c[2]-+u[2],f.duration)+" ",u[0]==="C"||u[0]==="Q")for(d=3,p=u[0]==="Q"?4:6;d<p;)h+=gn(f.timeStamp,+u[d],+c[d]-+u[d],f.duration)+" "+gn(f.timeStamp,+u[++d],+c[d]-+u[d],f.duration)+" ",++d;u[0]==="A"&&(h+="0 0 1 "+gn(f.timeStamp,+u[6],+c[6]-+u[6],f.duration)+" "+gn(f.timeStamp,+u[7],+c[7]-+u[7],f.duration)+" ")}),s.setAttribute("d",h)},end:function(){s.setAttribute("d",e)}})}function Cu(s,e,t,i){i===void 0&&(i="drawClipPath");var r=ga(s,e.id,e,t);if(r){var n=t.createDefs();return n.appendChild(r),n}else return t[i](e)}function WM(s,e,t,i,r){var n={cancel:!1,name:AL,axis:r,text:t,value:e,labelStyle:i};if(s.trigger(AL,n),!n.cancel){var a=n.text.indexOf("<br>")!==-1,o=r.enableTrim?a?kG(r.maximumLabelWidth,n.text,r.labelStyle,s.themeStyle.axisLabelFont):ta(r.maximumLabelWidth,n.text,r.labelStyle,s.enableRtl,s.themeStyle.axisLabelFont):n.text;r.visibleLabels.push(new cG(o,n.value,n.labelStyle,n.text))}}function qM(s){return s.minimum!=null&&s.maximum!=null}function Rp(s){return s.zoomFactor<1&&s.zoomPosition>=0}function D2(s,e){var t=e.orientation==="Horizontal"?s.width:s.height;if(m(e.desiredIntervals)){var i=(e.orientation==="Horizontal"?.533:1)*e.maximumLabels;return i=Math.max(t*(i/100),1),i}else return e.desiredIntervals}function YI(s,e,t,i,r){new ri({}).animate(s,{duration:t,delay:e,name:i,progress:function(n){n.element.style.visibility="visible"},end:function(n){r?pt(n.element):n.element.style.visibility="visible"}})}function gs(s,e,t,i,r,n,a,o,l,h){var u=a||new Nu(""),c=SG(s,t,e,r,i,l,h),d=u["draw"+c.functionName](c.renderOption,o?new Int32Array([o.x,o.y]):null);return d}function SG(s,e,t,i,r,n,a){var o,l="Path",h=n,u=h&&t==="Circle"?e.width-2:e.width,c=h&&t==="Circle"?e.height-2:e.height,d=h?a.targetWidth:0,p=s.x,f=s.y,v=s.y+-c/2,g=s.x+-u/2,b=72,y,C;switch(t){case"Bubble":case"Circle":l="Ellipse",bt(i,{rx:u/2,ry:c/2,cx:p,cy:f});break;case"Plus":o="M "+g+" "+f+" L "+(p+u/2)+" "+f+" M "+p+" "+(f+c/2)+" L "+p+" "+(f+-c/2),bt(i,{d:o});break;case"Cross":o="M "+g+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" M "+g+" "+(f+c/2)+" L "+(p+u/2)+" "+(f+-c/2),bt(i,{d:o});break;case"Multiply":o="M "+(p-d)+" "+(f-d)+" L "+(p+d)+" "+(f+d)+" M "+(p-d)+" "+(f+d)+" L "+(p+d)+" "+(f-d),bt(i,{d:o,stroke:i.fill});break;case"HorizontalLine":o="M "+g+" "+f+" L "+(p+u/2)+" "+f,bt(i,{d:o});break;case"VerticalLine":o="M "+p+" "+(f+c/2)+" L "+p+" "+(f+-c/2),bt(i,{d:o});break;case"Diamond":o="M "+g+" "+f+" L "+p+" "+(f+-c/2)+" L "+(p+u/2)+" "+f+" L "+p+" "+(f+c/2)+" L "+g+" "+f+" z",bt(i,{d:o});break;case"ActualRect":o="M "+g+" "+(f+-c/8)+" L "+(p+d)+" "+(f+-c/8)+" L "+(p+d)+" "+(f+c/8)+" L "+g+" "+(f+c/8)+" L "+g+" "+(f+-c/8)+" z",bt(i,{d:o});break;case"TargetRect":o="M "+(g+d)+" "+(f+-c/2)+" L "+(p+d/2)+" "+(f+-c/2)+" L "+(p+d/2)+" "+(f+c/2)+" L "+(g+d)+" "+(f+c/2)+" L "+(g+d)+" "+(f+-c/2)+" z",bt(i,{d:o});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"RangeStepArea":case"StackingStepArea":case"Square":case"Flag":o="M "+g+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" L "+g+" "+(f+c/2)+" L "+g+" "+(f+-c/2)+" z",bt(i,{d:o});break;case"Pyramid":case"Triangle":o="M "+g+" "+(f+c/2)+" L "+p+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" L "+g+" "+(f+c/2)+" z",bt(i,{d:o});break;case"Funnel":case"InvertedTriangle":o="M "+(p+u/2)+" "+(f-c/2)+" L "+p+" "+(f+c/2)+" L "+(p-u/2)+" "+(f-c/2)+" L "+(p+u/2)+" "+(f-c/2)+" z",bt(i,{d:o});break;case"Pentagon":for(var x=0;x<=5;x++)y=u/2*Math.cos(Math.PI/180*(x*b)),C=c/2*Math.sin(Math.PI/180*(x*b)),x===0?o="M "+(p+y)+" "+(f+C)+" ":o=o.concat("L "+(p+y)+" "+(f+C)+" ");o=o.concat("Z"),bt(i,{d:o});break;case"Image":l="Image",bt(i,{href:r,height:c,width:u,x:g,y:v});break}return i=NG(s,new ei(u,c),t,i).renderOption,{renderOption:i,functionName:l}}function Qe(s){return document.getElementById(s)}function xG(s){var e=null;try{typeof s!="function"&&document.querySelectorAll(s).length?e=pi(document.querySelector(s).innerHTML.trim()):e=pi(s)}catch{e=pi(s)}return e}function wG(s,e,t,i,r,n,a,o,l,h){var u=s.getBoundingClientRect();e.accumulationDataLabelModule.calculateLabelSize(t,s,n,i,r,a,o,l,h,u,!0)}function MG(s,e,t,i,r,n){var a=document.getElementById(e.element.id+"_Series_"+(i.index===void 0?i.category:i.index)+"_DataLabelCollections");a&&(t.index===0&&(e.dataLabelCollections=[]),e.dataLabelModule.calculateTemplateLabelSize(a,s,t,i,i.marker.dataLabel,r,i.clipRect,n,!0))}function A2(s,e,t,i,r,n,a,o,l,h,u,c,d,p,f){var v=xG(t),g;try{var b="Blazor",y=window[b]?a?r:{point:r}:{chart:i,series:n,point:r},C=a?a+"_template":"template",x=v?v(y,i,C,a||s.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(x.length){g=Array.prototype.slice.call(x);for(var w=g.length,M=0;M<w;M++)s.appendChild(g[M])}var E=void 0;i.getModuleName()==="accumulationchart"?(E=wG.bind(this,s,i,h,u,l,u[e],c,d,p,f),i.isReact&&i.renderReactTemplates(E)):i.getModuleName()==="chart"&&(E=r&&n?MG.bind(this,s,i,r,n,o,f):E,i.isReact&&i.renderReactTemplates(E))}catch{return s}return s}function N2(s){var e="";return e="font-size:"+s.size+"; font-style:"+s.fontStyle+"; font-weight:"+s.fontWeight+"; font-family:"+s.fontFamily+";opacity:"+s.opacity+"; color:"+s.color+";",e}function k2(s,e,t){e===void 0&&(e=!1),t||document.body.appendChild(s);var i=s.getBoundingClientRect();return e?pt(s):t||di(s.id),i}function EG(s,e){for(var t,i=0,r=s.length;i<r;i++)if(s[i].id.indexOf(e)>-1){t=s[i];continue}return t}function Yn(s,e,t,i,r){s=t.valueType==="Logarithmic"?ch(s>0?s:Math.pow(t.logBase,t.visibleRange.min),t.logBase):s,e=i.valueType==="Logarithmic"?ch(e>0?e:Math.pow(i.logBase,i.visibleRange.min),i.logBase):e,s=mn(s,t),e=mn(e,i);var n=r?t.rect.height:t.rect.width,a=r?i.rect.width:i.rect.height,o=r?e*a:s*n,l=r?(1-s)*n:(1-e)*a;return new ut(o,l)}function Mt(s,e,t,i,r,n,a,o,l,h,u,c,d,p){if(r===void 0&&(r=!1),n===void 0&&(n="x"),a===void 0&&(a="y"),h===void 0&&(h=!1),u===void 0&&(u=!1),c===void 0&&(c=null),p===void 0&&(p=!1),s)return null;var f=p?null:e.querySelector("#"+t.id),v=f||Qe(t.id),g=t,b=d||300;if(i&&r&&v)if(o=o||(v.tagName==="DIV"?new ut(+v.style[n].split("px")[0],+v.style[a].split("px")[0]):new ut(+v.getAttribute(n),+v.getAttribute(a))),l&&l!=="undefined")Nb(t,t.getAttribute("d"),i,l,b);else if(u&&c)CG(g,0,b,new Ve(+v.getAttribute("x"),+v.getAttribute("y"),+v.getAttribute("width"),+v.getAttribute("height")),c);else{var y=g.tagName==="DIV"?new ut(+g.style[n].split("px")[0],+g.style[a].split("px")[0]):new ut(+g.getAttribute(n),+g.getAttribute(a));LG(g,b,o,y,n,a)}else i&&r&&!v&&h&&YI(g,0,600,"FadeIn");f?e.replaceChild(g,v):e.appendChild(g)}function IG(s,e,t){var i=e.marker.dataLabel.format?e.marker.dataLabel.format:e.yAxis.labelFormat,r=[],n=i.match("{value}")!==null;switch(e.seriesType){case"XY":e.chart.chartAreaType==="PolarRadar"?e.drawType.indexOf("Stacking")!==-1?(e.yAxis.valueType==="Logarithmic"&&tf(e.stackedValues.endValues[s.index],e.yAxis)||Kh(e.stackedValues.endValues[s.index],e.yAxis.visibleRange))&&r.push(s.text||s.yValue.toString()):(e.yAxis.valueType==="Logarithmic"&&tf(s.yValue,e.yAxis)||Kh(s.yValue,e.yAxis.visibleRange))&&r.push(s.text||s.yValue.toString()):r.push(s.text||s.yValue.toString());break;case"HighLow":r.push(s.text||Math.max(s.high,s.low).toString()),r.push(s.text||Math.min(s.high,s.low).toString());break;case"HighLowOpenClose":r.push(s.text||Math.max(s.high,s.low).toString()),r.push(s.text||Math.min(s.high,s.low).toString()),r.push(s.text||Math.max(s.open,s.close).toString()),r.push(s.text||Math.min(s.open,s.close).toString());break;case"BoxPlot":r.push(s.text||s.median.toString()),r.push(s.text||s.maximum.toString()),r.push(s.text||s.minimum.toString()),r.push(s.text||s.upperQuartile.toString()),r.push(s.text||s.lowerQuartile.toString());for(var a=0,o=s.outliers;a<o.length;a++){var l=o[a];r.push(s.text||l.toString())}break}if((i||t.useGroupingSeparator)&&!s.text){e.yAxis.format=t.intl.getNumberFormat({format:n?"":i,useGrouping:t.useGroupingSeparator});for(var h=0;h<r.length;h++)r[h]=n?i.replace("{value}",e.yAxis.format(parseFloat(r[h]))):e.yAxis.format(parseFloat(r[h]))}return r}function L2(s){window.clearInterval(s)}function Ep(s,e,t){var i=new Ve(s.x+t.x,s.y+t.y,s.width,s.height),r=e.some(function(n){return i.x<n.x+n.width&&i.x+i.width>n.x&&i.y<n.y+n.height&&i.height+i.y>n.y});return r}function pn(s,e){return s.x<e.x+e.width&&s.x+s.width>e.x&&s.y<e.y+e.height&&s.height+s.y>e.y}function TG(s,e){return s.x<=e.x&&s.x+s.width>=e.x+e.width&&s.y<=e.y&&s.height+s.y>=e.y+e.height}function lg(s,e,t){return new Ve(s.x-e.width/2-t.left,s.y-e.height/2-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}function O2(s){return"#"+Gc(s.r)+Gc(s.g)+Gc(s.b)}function Gc(s){var e=s.toString(16);return e.length===1?"0"+e:e}function dv(s){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return e?new V0(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):new V0(255,255,255)}function qn(s){s=s==="transparent"?"white":s,document.body.appendChild(St("text",{id:"chartmeasuretext"}));var e=document.getElementById("chartmeasuretext");e.style.color=s,s=window.getComputedStyle(e).color,pt(e);var t=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/,i=t.exec(s);return O2(new V0(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function DG(s){return/(rgba?\((?:\d{1,3}[,)]){3}(?:\d+\.\d+\))?)|(^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$)/gmi.test(s)}function AG(s,e){s=qn(s),s=s.replace(/[^0-9a-f]/gi,""),s.length<6&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),e=e||0;for(var t="#",i,r=0;r<3;r++)i=parseInt(s.substr(r*2,2),16),i=Math.round(Math.min(Math.max(0,i+i*e),255)),t+=("00"+i.toString(16)).substr(i.toString(16).length);return t}function Mh(s,e){var t=dv(s);return t.r=parseInt(Math.floor(t.r*e).toString(),10),t.g=parseInt(Math.floor(t.g*e).toString(),10),t.b=parseInt(Math.floor(t.b*e).toString(),10),"#"+Gc(t.r).toUpperCase()+Gc(t.g).toUpperCase()+Gc(t.b).toUpperCase()}function NG(s,e,t,i){var r=10,n="",a=2,o=e.height,l=e.width,h=s.x,u=s.y;switch(t){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(h+-l*(3/4))+" "+u+" L "+(h+l*(3/4))+" "+u,bt(i,{d:n});break;case"StepLine":i.fill="transparent",n="M "+(h+-l/2-r/4)+" "+(u+o/2)+" L "+(h+-l/2+l/10)+" "+(u+o/2)+" L "+(h+-l/2+l/10)+" "+u+" L "+(h+-l/10)+" "+u+" L "+(h+-l/10)+" "+(u+o/2)+" L "+(h+l/5)+" "+(u+o/2)+" L "+(h+l/5)+" "+(u+-o/2)+" L "+(h+l/2)+" "+(u+-o/2)+"L "+(h+l/2)+" "+(u+o/2)+" L"+(h+l/2+r/4)+" "+(u+o/2),bt(i,{d:n});break;case"UpArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+-l/2)+" "+(u+o/2)+" L "+h+" "+(u-o/2)+" L "+(h+l/2)+" "+(u+o/2)+"L "+(h+l/2-a)+" "+(u+o/2)+" L "+h+" "+(u-o/2+2*a)+"L"+(h-l/2+a)+" "+(u+o/2)+" Z",bt(i,{d:n});break;case"DownArrow":n="M "+(h-l/2)+" "+(u-o/2)+" L "+h+" "+(u+o/2)+" L "+(h+l/2)+" "+(u-o/2)+"L "+(h+l/2-a)+" "+(u-o/2)+" L "+h+" "+(u+o/2-2*a)+"L"+(h-l/2+a)+" "+(u-o/2)+" Z",bt(i,{d:n});break;case"RightArrow":n="M "+(h+-l/2)+" "+(u-o/2)+" L "+(h+l/2)+" "+u+" L "+(h+-l/2)+" "+(u+o/2)+" L "+(h+-l/2)+" "+(u+o/2-a)+" L "+(h+l/2-2*a)+" "+u+" L"+(h+-l/2)+" "+(u-o/2+a)+" Z",bt(i,{d:n});break;case"LeftArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+l/2)+" "+(u-o/2)+" L "+(h+-l/2)+" "+u+" L "+(h+l/2)+" "+(u+o/2)+" L "+(h+l/2)+" "+(u+o/2-a)+" L "+(h+-l/2+2*a)+" "+u+" L"+(h+l/2)+" "+(u-o/2+a)+" Z",bt(i,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(h-3*(l/5))+" "+(u-o/5)+" L "+(h+3*(-l/10))+" "+(u-o/5)+" L "+(h+3*(-l/10))+" "+(u+o/2)+" L "+(h-3*(l/5))+" "+(u+o/2)+" Z M "+(h+-l/10-l/20)+" "+(u-o/4-r/2)+" L "+(h+l/10+l/20)+" "+(u-o/4-r/2)+" L "+(h+l/10+l/20)+" "+(u+o/2)+" L "+(h+-l/10-l/20)+" "+(u+o/2)+" Z M "+(h+3*(l/10))+" "+u+" L "+(h+3*(l/5))+" "+u+" L "+(h+3*(l/5))+" "+(u+o/2)+" L "+(h+3*(l/10))+" "+(u+o/2)+" Z",bt(i,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(h+-l/2+-r/4)+" "+(u-3*(o/5))+" L "+(h+3*(l/10))+" "+(u-3*(o/5))+" L "+(h+3*(l/10))+" "+(u-3*(o/10))+" L "+(h-l/2+-r/4)+" "+(u-3*(o/10))+" Z M "+(h+-l/2+-r/4)+" "+(u-o/5+r/20)+" L "+(h+l/2+r/4)+" "+(u-o/5+r/20)+" L "+(h+l/2+r/4)+" "+(u+o/10+r/20)+" L "+(h-l/2+-r/4)+" "+(u+o/10+r/20)+" Z M "+(h-l/2+-r/4)+" "+(u+o/5+r/10)+" L "+(h+-l/4)+" "+(u+o/5+r/10)+" L "+(h+-l/4)+" "+(u+o/2+r/10)+" L "+(h-l/2+-r/4)+" "+(u+o/2+r/10)+" Z",bt(i,{d:n});break;case"Spline":i.fill="transparent",n="M "+(h-l/2)+" "+(u+o/5)+" Q "+h+" "+(u-o)+" "+h+" "+(u+o/5)+" M "+h+" "+(u+o/5)+" Q "+(h+l/2)+" "+(u+o/2)+" "+(h+l/2)+" "+(u-o/2),bt(i,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(h-l/2-r/4)+" "+(u+o/2)+" L "+(h+-l/4+-r/8)+" "+(u-o/2)+" L "+h+" "+(u+o/4)+" L "+(h+l/4+r/8)+" "+(u+-o/2+o/4)+" L "+(h+o/2+r/4)+" "+(u+o/2)+" Z",bt(i,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(h-l/2)+" "+(u+o/5)+" Q "+h+" "+(u-o)+" "+h+" "+(u+o/5)+" Z M "+h+" "+(u+o/5)+" Q "+(h+l/2)+" "+(u+o/2)+" "+(h+l/2)+" "+(u-o/2)+"  Z",bt(i,{d:n});break;case"Pie":case"Doughnut":i.stroke="transparent";var c=Math.min(o,l)/2;n=pG(h,u,c,o,l),bt(i,{d:n});break}return{renderOption:i}}function ta(s,e,t,i,r){var n=e,a=ht(e,t,r).width;if(a>s){for(var o=e.length,l=o-1;l>=0;--l)if(n=i?"..."+e.substring(0,l):e.substring(0,l)+"...",a=ht(n,t,r).width,a<=s)return n}return n}function kG(s,e,t,i){for(var r=[],n=e.split("<br>"),a=0;a<n.length;a++){e=n[a];var o=ht(e,t,i).width;if(o>s){for(var l=e.length,h=l-1;h>=0;--h)if(e=e.substring(0,h)+"...",o=ht(e,t,i).width,o<=s){r.push(e);break}}else r.push(e)}return r}function xi(s,e){return s!=null?s.indexOf("%")!==-1?e/100*parseInt(s,10):parseInt(s,10):null}function ga(s,e,t,i){if(!s)return null;var r=Qe(e);return r&&t&&i.setElementAttributes(t,r.tagName==="clipPath"?r.childNodes[0]:r),r}function LG(s,e,t,i,r,n){r===void 0&&(r="x"),n===void 0&&(n="y");var a=s.tagName==="DIV",o=function(l,h){a?(s.style[r]=l+"px",s.style[n]=h+"px"):(s.setAttribute(r,l+""),s.setAttribute(n,h+""))};o(t.x,t.y),new ri({}).animate(St("div"),{duration:e,progress:function(l){o(gn(l.timeStamp,t.x,i.x-t.x,l.duration),gn(l.timeStamp,t.y,i.y-t.y,l.duration))},end:function(){o(i.x,i.y)}})}function bn(s,e,t,i,r,n,a,o,l,h,u,c,d,p,f,v){n===void 0&&(n=!1),l===void 0&&(l=!1);var g={},b,y,C,x,w=0,M,E=0;if(e.text.length>1&&f){for(var T=0,D=e.text.length;T<D;T++)E=Math.max(E,ht(e.text[T],t,v).width);w=ht(e.text[0],t,v).width}M=e.text.length>1&&f?e.x+E/2-w/2:e.x,g={id:e.id,x:M,y:e.y,fill:i||"black","font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily||v.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,labelRotation:e.labelRotation,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine};var N=typeof e.text=="string"?e.text:n?e.text[e.text.length-1]:e.text[0],A=u?u.x:0,L=u?u.y:0,k=s.createText(g,N,A,L);if(typeof e.text!="string"&&e.text.length>1)for(var T=1,D=e.text.length;T<D;T++)y=ht(e.text[T],t,v).height,w=ht(e.text[T],t,v).width,C=e.y+(n?-(T*y):T*y),M=f?e.x+E/2-w/2:e.x,x=n?e.text[e.text.length-(T+1)]:e.text[T],p?b=s.createText(g,x,null,null,C,!0):(b=s.createTSpan({x:M,id:e.id,y:C},x),k.appendChild(b));return d||Mt(s instanceof h2,r,k,a,o,"x","y",null,null,l,!1,null,h),k}function R2(s){var e=s.element.clientWidth||s.element.offsetWidth,t=s.element.clientHeight;s.stockChart&&(e=s.stockChart.availableSize.width,t=s.stockChart.availableSize.height);var i=450,r;if(s.getModuleName()==="rangeNavigator"){var n=s,a=n.tooltip.enable?35:0,o=n.periodSelectorSettings.periods.length?n.periodSelectorSettings.height:0;r=n.margin.top+n.margin.bottom+a;var l=ht("tempString",n.labelStyle,n.themeStyle.axisLabelFont).height,h=15;i=(s.series.length?B.isDevice?80:120:(n.enableGrouping?40+h+l:40)+r)+o,n.disableRangeSelector&&(i=o)}if(s.availableSize=new ei(xi(s.width,e)||e||600,xi(s.height,t||i)||t||i),s.getModuleName()==="chart"){var u=1,c=1;if(s.width===""||s.width===null||s.width==="100%"){u=s.element.getBoundingClientRect().width>0?s.element.getBoundingClientRect().width/s.availableSize.width:1,c=s.element.getBoundingClientRect().height>0?s.element.getBoundingClientRect().height/s.availableSize.height:1;var d=s.element.style.transform;if(d){var p=parseFloat(d.match(/scale\((.*?)\)/)[1]);u=p?u/p:u,c=p?c/p:c}s.availableSize.width=s.availableSize.width*u,s.availableSize.height=s.availableSize.height*c,s.scaleX=u,s.scaleY=c}}}function F2(s){s.canvasRender=new h2(s.element.id),s.renderer=s.enableCanvas?s.canvasRender:new Nu(s.element.id),R2(s),s.stockChart&&s.getModuleName()==="chart"?s.svgObject=s.stockChart.chartObject:s.stockChart&&s.getModuleName()==="rangeNavigator"?s.svgObject=s.stockChart.selectorObject:s.enableCanvas?s.svgObject=s.renderer.createCanvas({id:s.element.id+"_canvas",width:s.availableSize.width,height:s.availableSize.height}):s.svgObject=s.renderer.createSvg({id:s.element.id+"_svg",width:s.availableSize.width,height:s.availableSize.height}),s.enableCanvas&&(s.renderer.ctx.direction=s.enableRtl?"rtl":"ltr")}function Od(s,e,t,i,r){var n=[];switch(e.textOverflow){case"Wrap":n=dh(s,t,e,i,null,null,r);break;case"Trim":n.push(ta(t,s,e,i,r));break;default:n.push(s);break}return n}function $c(s,e){var t;return e.textAlignment==="Near"?t=s.x:e.textAlignment==="Center"?t=s.x+s.width/2:t=s.x+s.width,t}function dh(s,e,t,i,r,n,a){if(r)return OG(s,e,t,a);for(var o=s.split(" "),l="",h=[],u=void 0,c=0,d=o.length;c<d;c++)u=o[c],ht(l.concat(l===""?"":" "+u),t,a).width<e?l=l.concat((l===""?"":" ")+u):l!==""?(h.push(n?l:ta(e,l,t,i,a)),l=u):(h.push(n?u:ta(e,u,t,i,a)),u=""),l&&c===d-1&&h.push(n?l:ta(e,l,t,i,a));return h}function OG(s,e,t,i){var r=ht(s,t,i).width,n=[];if(r>e){for(var a="",o=0,l=1;l<s.length;)a=s.substring(o,l),r=ht(a,t,i).width,r<e?l++:r===e?(o=l,n.push(a),l++,a=""):r>e&&(a=a.slice(0,-1),o=l-1,n.push(a),a="");a.length>0&&n.push(a)}else n.push(s);return n}function RL(s,e){for(var t=s.replace(e," "),i=s.match(e),r=" ",n=" ",a=0,o={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"},l={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"},h=0;h<=t.length-1;h++)if(t[h]===" "){r=e===H0?i[a].replace(/~/g,""):i[a].replace(/\^/g,"");for(var u=0;u<r.length;u++)n+=e===H0?o[r[u]]:l[r[u]];a++}else n+=t[h];return n.trim()}function kb(s){for(var e=0;e<s.annotations.length;e++)Yp((s.element.id+"_Annotation_"+e).replace(/[^a-zA-Z0-9]/g,""));Yp(s.element.id+"_tooltipparent_template_blazorTemplate"),Yp(s.element.id+"_DataLabel")}var RG=function(){function s(e,t){this.startValues=e,this.endValues=t}return s}(),aa=function(s){w2(e,s);function e(t,i,r,n,a,o,l,h,u){var c=s.call(this,t,i,r.width,r.color,n,u)||this;return c.y=a.y,c.x=a.x,c.height=a.height,c.width=a.width,c.rx=o||0,c.ry=l||0,c.transform=h||"",c.stroke=r.width!==0&&c.stroke!==""?r.color===null?"":r.color:"transparent",c}return e}(Er),YM=function(){function s(e,t,i,r,n,a,o,l){this.height=e,this.width=t,this.href=i,this.x=r,this.y=n,this.id=a,this.visibility=o,this.preserveAspectRatio=l}return s}(),QI=function(s){w2(e,s);function e(t,i,r,n,a,o,l){var h=s.call(this,t,i,r.width,r.color,n)||this;return h.cy=o,h.cx=a,h.r=l,h}return e}(Er),ut=function(){function s(e,t){this.x=e,this.y=t}return s}(),$a=function(){function s(e,t,i,r){this.left=e,this.right=t,this.top=i,this.bottom=r}return s}(),V0=function(){function s(e,t,i){this.r=e,this.g=t,this.b=i}return s}(),rf=function(){function s(e,t,i){i===void 0&&(i=0),this.point=e,this.series=t,this.lierIndex=i}return s}(),nf=function(){function s(e,t,i){i===void 0&&(i=0),this.point=e,this.series=t,this.index=i}return s}();function FG(s,e){var t="",i;return Number(e)===s.start?t=s.colors[0]:Number(e)===s.end?t=s.colors[s.colors.length-1]:(i=PG(Number(e),s),t=O2(i)),t}function PG(s,e){var t=e.start,i=e.end,r=0,n=i-t,a;r=(s-t)/n;var o,l;if(e.colors.length<=2)o=e.colors[0].charAt(0)==="#"?e.colors[0]:qn(e.colors[0]),l=e.colors[e.colors.length-1].charAt(0)==="#"?e.colors[e.colors.length-1]:qn(e.colors[e.colors.length-1]);else{o=e.colors[0].charAt(0)==="#"?e.colors[0]:qn(e.colors[0]),l=e.colors[e.colors.length-1].charAt(0)==="#"?e.colors[e.colors.length-1]:qn(e.colors[e.colors.length-1]);for(var h=n/(e.colors.length-1),u=void 0,c=void 0,d=e.colors.length-1,p=[],f={},v=1;v<d;v++)c=v*h,u=t+c,f={b:u,color:e.colors[v]},p.push(f);for(var g=0;g<p.length;g++)t<=s&&s<=p[g].b&&g===0?(a=p[g].color.charAt(0)==="#"?p[g].color:qn(p[g].color),l=a,r=s<=p[g].b?1-Math.abs((s-p[g].b)/h):(s-p[g].b)/h):p[g].b<=s&&s<=i&&g===p.length-1&&(a=p[g].color.charAt(0)==="#"?p[g].color:qn(p[g].color),o=a,r=s<p[g].b?1-Math.abs((s-p[g].b)/h):(s-p[g].b)/h),g!==p.length-1&&g<p.length&&p[g].b<=s&&s<=p[g+1].b&&(a=p[g].color.charAt(0)==="#"?p[g].color:qn(p[g].color),o=a,l=p[g+1].color.charAt(0)==="#"?p[g+1].color:qn(p[g+1].color),r=Math.abs(s-p[g+1].b)/h)}return zG(r,o,l)}function zG(s,e,t){var i=t.split("#")[1],r=e.split("#")[1],n=Ax(s,parseInt(r.substr(0,2),16),parseInt(i.substr(0,2),16)),a=Ax(s,parseInt(r.substr(2,2),16),parseInt(i.substr(2,2),16)),o=Ax(s,parseInt(r.substr(4,2),16),parseInt(i.substr(4,2),16));return new V0(n,a,o)}function Ax(s,e,t){var i=t-e;return Math.round(e+i*s)}function Zh(s,e){switch(s){case"Near":return e?"end":"start";case"Far":return e?"start":"end";default:return"middle"}}var FL;(function(s){s.stockEventFont={size:"13px",fontWeight:"400",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}})(FL||(FL={}));function P2(s){var e;switch(s){case"Fabric":e=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Bootstrap":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"HighContrast":e=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":e=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":e=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":e=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":e=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":e=["#6355C7","#FFB400","#2196F5","#F7523F","#963C70","#4BE0BC","#FD7400","#C9E422","#DE3D8A","#162F88"];break;case"Bootstrap5Dark":e=["#8F80F4","#FFD46D","#6CBDFF","#FF7F71","#FF6DB3","#63F5D2","#FCAA65","#ECFF77","#EF8EFF","#5F82FD"];break;case"FluentDark":e=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Fluent":e=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Material3":e=["#6355C7","#00AEE0","#FFB400","#F7523F","#963C70","#FD7400","#4BE0BC","#2196F5","#DE3D8A","#162F88"];break;case"Material3Dark":e=["#4EAAFF","#FA4EAB","#FFF500","#17EA58","#38FFE7","#FF9E45","#B3F32F","#B93CE4","#FC5664","#9B55FF"];break;default:e=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"];break}return e}function z2(s,e){var t,i=s==="MaterialDark"?"#383838":s==="FabricDark"?"#242424":"#1b1b1b";switch(s){case"HighContrastLight":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:e?"#000000":"transparent",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939",tabColor:"#FFD939",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#FFD939",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI"},axisLabelFont:{color:"#969696",fontFamily:"Segoe UI"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI"},legendLabelFont:{color:"#969696",fontFamily:"Segoe UI"},tooltipLabelFont:{color:"#000000",fontFamily:"Segoe UI"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI"},datalabelFont:{color:"#969696",fontFamily:"Segoe UI"},chartSubTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI"},crosshairLabelFont:{color:"#000000",fontFamily:"Segoe UI"},stripLineLabelFont:{color:"#969696",fontFamily:"Segoe UI"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:e?i:"transparent",areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:s==="MaterialDark"?"#F4F4F4":s==="FabricDark"?"#A19F9D":"#F0F0F0",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727",tabColor:s==="MaterialDark"?"#00B0FF":s==="FabricDark"?"#0074CC":"#0070F0",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:s==="MaterialDark"?"#00B0FF":s==="FabricDark"?"#0074CC":"#0070F0",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.87)":s==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},axisLabelFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.6)":s==="FabricDark"?"#A19F9D":"#CED4DA",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},legendTitleFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.87)":s==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},legendLabelFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.6)":s==="FabricDark"?"#A19F9D":"#676767",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},tooltipLabelFont:{color:s==="MaterialDark"?"rgba(18, 18, 18, 1)":s==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},axisTitleFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.87)":s==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},datalabelFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.6)":s==="FabricDark"?"#A19F9D":"#676767",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},chartSubTitleFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.87)":s==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},crosshairLabelFont:{color:s==="MaterialDark"?"rgba(18, 18, 18, 1)":s==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"},stripLineLabelFont:{color:s==="MaterialDark"?"rgba(255, 255, 255, 0.24)":s==="FabricDark"?"#6F6C6C":"#414141",fontFamily:s==="MaterialDark"?"Roboto":s==="FabricDark"?"Segoe UI":"Helvetica"}};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:e?"#FFFFFF":"transparent",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#212529",crosshairLabel:"#FFFFFF",tooltipFill:"#020202",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057",tabColor:"#007BFF",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#007BFF",toolkitFill:"#495057",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(-5,-5,26,26),chartTitleFont:{color:"#212529",fontFamily:"Helvetica"},axisLabelFont:{color:"#495057",fontFamily:"Helvetica"},legendTitleFont:{color:"#212529",fontFamily:"Helvetica"},legendLabelFont:{color:"#666666",fontFamily:"Helvetica"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica"},axisTitleFont:{color:"#212529",fontFamily:"Helvetica"},datalabelFont:{color:"#495057",fontFamily:"Helvetica"},chartSubTitleFont:{color:"#212529",fontFamily:"Helvetica"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Helvetica"}};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:e?"rgba(255,255,255, 0.0)":"transparent",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#4F46E5",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#4F46E5",toolkitFill:"#6B7280",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#374151",fontFamily:"Inter"},axisLabelFont:{color:"#6B7280",fontFamily:"Inter"},legendTitleFont:{color:"#374151",fontFamily:"Inter"},legendLabelFont:{color:"#374151",fontFamily:"Inter"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Inter"},axisTitleFont:{color:"#374151",fontFamily:"Inter"},datalabelFont:{color:"#6B7280",fontFamily:"Inter"},chartSubTitleFont:{color:"#374151",fontFamily:"Inter"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Inter"},stripLineLabelFont:{color:"#D1D5DB",fontFamily:"Inter"}};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:e?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727",tabColor:"#22D3EE",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#22D3EE",toolkitFill:"#D1D5DB",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#D1D5DB",fontFamily:"Inter"},axisLabelFont:{color:"#9CA3AF",fontFamily:"Inter"},legendTitleFont:{color:"#D1D5DB",fontFamily:"Inter"},legendLabelFont:{color:"#D1D5DB",fontFamily:"Inter"},tooltipLabelFont:{color:"#1F2937",fontFamily:"Inter"},axisTitleFont:{color:"#D1D5DB",fontFamily:"Inter"},datalabelFont:{color:"#9CA3AF",fontFamily:"Inter"},chartSubTitleFont:{color:"#D1D5DB",fontFamily:"Inter"},crosshairLabelFont:{color:"#1F2937",fontFamily:"Inter"},stripLineLabelFont:{color:"#6B7280",fontFamily:"Inter"}};break;case"Bootstrap5":t={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:e?"#FFFFFF":"transparent",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0D6EFD",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0D6EFD",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#343A40",fontFamily:"Helvetica"},axisLabelFont:{color:"#495057",fontFamily:"Helvetica"},legendTitleFont:{color:"#343A40",fontFamily:"Helvetica"},legendLabelFont:{color:"#343A40",fontFamily:"Helvetica"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica"},axisTitleFont:{color:"#343A40",fontFamily:"Helvetica"},datalabelFont:{color:"#495057",fontFamily:"Helvetica"},chartSubTitleFont:{color:"#343A40",fontFamily:"Helvetica"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica"},stripLineLabelFont:{color:"#ADB5BD",fontFamily:"Helvetica"}};break;case"Bootstrap5Dark":t={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:e?"#212529":"transparent",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0D6EFD",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0D6EFD",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#E9ECEF",fontFamily:"Helvetica"},axisLabelFont:{color:"#CED4DA",fontFamily:"Helvetica"},legendTitleFont:{color:"#E9ECEF",fontFamily:"Helvetica"},legendLabelFont:{color:"#E9ECEF",fontFamily:"Helvetica"},tooltipLabelFont:{color:"#212529",fontFamily:"Helvetica"},axisTitleFont:{color:"#E9ECEF",fontFamily:"Helvetica"},datalabelFont:{color:"#E9ECEF",fontFamily:"Helvetica"},chartSubTitleFont:{color:"#E9ECEF",fontFamily:"Helvetica"},crosshairLabelFont:{color:"#212529",fontFamily:"Helvetica"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Helvetica"}};break;case"Fluent":t={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:e?"#FFFFFF":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#A19F9D",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#201F1E",fontFamily:"Segoe UI"},axisLabelFont:{color:"#3B3A39",fontFamily:"Segoe UI"},legendTitleFont:{color:"#201F1E",fontFamily:"Segoe UI"},legendLabelFont:{color:"#49454E",fontFamily:"Segoe UI"},tooltipLabelFont:{color:"#323130",fontFamily:"Segoe UI"},axisTitleFont:{color:"#201F1E",fontFamily:"Segoe UI"},datalabelFont:{color:"#3B3A39",fontFamily:"Segoe UI"},chartSubTitleFont:{color:"#323129",fontFamily:"Segoe UI"},crosshairLabelFont:{color:"#323130",fontFamily:"Segoe UI"},stripLineLabelFont:{color:"#A19F9D",fontFamily:"Segoe UI"}};break;case"FluentDark":t={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#414040",minorGridLine:"#414040",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:e?"#383838":"transparent",areaBorder:"#414040",errorBar:"#D2D0CE",crosshairLine:"#D2D0CE",crosshairFill:"#323130",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#484644",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:"#C8C6C4",fontFamily:"Segoe UI"},axisLabelFont:{color:"#C8C6C4",fontFamily:"Segoe UI"},legendTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI"},legendLabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI"},tooltipLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI"},axisTitleFont:{color:"#F3F2F2",fontFamily:"Segoe UI"},datalabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI"},chartSubTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI"},crosshairLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI"},stripLineLabelFont:{color:"#484644",fontFamily:"Segoe UI"}};break;case"Material3":t={axisLabel:"#1E192B",axisTitle:"#1C1B1F",axisLine:"#C4C7C5",majorGridLine:"#C4C7C5",minorGridLine:"#C4C7C5",majorTickLine:"#C4C7C5",minorTickLine:" #C4C7C5",chartTitle:"#1C1B1F",legendLabel:"#49454E",background:e?"#FFFFFF":"transparent",areaBorder:"#E7E0EC",errorBar:"#79747E",crosshairLine:"#49454E",crosshairFill:"#313033",crosshairLabel:"#F4EFF4",tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",markerShadow:null,selectionRectFill:"rgb(98, 0, 238, 0.06)",selectionRectStroke:"#6200EE",selectionCircleStroke:"#79747E",tabColor:"#49454E",bearFillColor:"#5887FF",bullFillColor:"#F7523F",toolkitSelectionColor:"#49454E",toolkitFill:"#49454E",toolkitIconRectOverFill:"#EADDFF",toolkitIconRectSelectionFill:"#EADDFF",toolkitIconRect:new Ve(-4,-5,26,26),histogram:"#D21020",chartTitleFont:{color:"#1C1B1F",fontFamily:"Roboto"},axisLabelFont:{color:"#1E192B",fontFamily:"Roboto"},legendTitleFont:{color:"#1C1B1F",fontFamily:"Roboto"},legendLabelFont:{color:"#49454E",fontFamily:"Roboto"},tooltipLabelFont:{color:"#F4EFF4",fontFamily:"Roboto"},axisTitleFont:{color:"#1C1B1F",fontFamily:"Roboto"},datalabelFont:{color:"#49454E",fontFamily:"Roboto"},chartSubTitleFont:{color:"#49454E",fontFamily:"Roboto"},crosshairLabelFont:{color:"#F4EFF4",fontFamily:"Roboto"},stripLineLabelFont:{color:"#79747E",fontFamily:"Roboto"}};break;case"Material3Dark":t={axisLabel:"#E6E1E5",axisTitle:"#E6E1E5",axisLine:"#49454F",majorGridLine:"#444746",minorGridLine:"#444746",majorTickLine:"#444746",minorTickLine:" #444746",chartTitle:"#E6E1E5",legendLabel:"#CAC4D0",background:e?"#FFFFFF":"transparent",areaBorder:"#49454F",errorBar:"#938F99",crosshairLine:"#CAC4D0",crosshairFill:"#E6E1E5",crosshairLabel:"#313033",tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",markerShadow:null,selectionRectFill:"rgba(78, 170, 255, 0.06)",selectionRectStroke:"#4EAAFF",selectionCircleStroke:"#938F99",tabColor:"#CAC4D0",bearFillColor:"#B3F32F",bullFillColor:"#FF9E45",toolkitSelectionColor:"#CAC4D0",toolkitFill:"#CAC4D0",toolkitIconRectOverFill:"#4F378B",toolkitIconRectSelectionFill:"#4F378B",toolkitIconRect:new Ve(-4,-5,26,26),histogram:"#FF9E45",chartTitleFont:{color:"#E6E1E5",fontFamily:"Roboto"},axisLabelFont:{color:"#CAC4D0",fontFamily:"Roboto"},legendTitleFont:{color:"#E6E1E5",fontFamily:"Roboto"},legendLabelFont:{color:"#CAC4D0",fontFamily:"Roboto"},tooltipLabelFont:{color:"#313033",fontFamily:"Roboto"},axisTitleFont:{color:"#E6E1E5",fontFamily:"Roboto"},datalabelFont:{color:"#CAC4D0",fontFamily:"Roboto"},chartSubTitleFont:{color:"#CAC4D0",fontFamily:"Roboto"},crosshairLabelFont:{color:"#313033",fontFamily:"Roboto"},stripLineLabelFont:{color:"#938F99",fontFamily:"Roboto"}};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:e?"#FFFFFF":"transparent",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:s==="Material"?"#000816":s==="Fabric"?"#FFFFFF":"#212529",crosshairLabel:"#e5e5e5",tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2",tabColor:s==="Material"?"#ff4081":s==="Fabric"?"#0078D6":"#317AB9",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:s==="Material"?"#ff4081":s==="Fabric"?"#0078D6":"#317AB9",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ve(0,0,16,16),chartTitleFont:{color:s==="Material"?"rgba(0, 0, 0, 1)":s==="Fabric"?"#333333":"#212529",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},axisLabelFont:{color:s==="Material"?"rgba(97, 97, 97, 1)":s==="Fabric"?"#666666":"#676767",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},legendTitleFont:{color:s==="Material"?"rgba(0, 0, 0, 1)":s==="Fabric"?"#333333":"#212529",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},legendLabelFont:{color:s==="Material"?"rgba(97, 97, 97, 1)":"#666666",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},tooltipLabelFont:{color:s==="Material"?"rgba(249, 250, 251, 1)":s==="Fabric"?"#333333":"#F9FAFB",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},axisTitleFont:{color:s==="Material"?"rgba(0, 0, 0, 1)":s==="Fabric"?"#333333":"#212529",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},datalabelFont:{color:s==="Material"?"rgba(97, 97, 97, 1)":s==="Fabric"?"#666666":"#676767",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},chartSubTitleFont:{color:s==="Material"?"rgba(0, 0, 0, 1)":s==="Fabric"?"#333333":"#212529",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},crosshairLabelFont:{color:s==="Material"?"rgba(249, 250, 251, 1)":s==="Fabric"?"#333333":"#F9FAFB",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"},stripLineLabelFont:{color:s==="Material"?"rgba(158, 158, 158, 1)":s==="Fabric"?"#A6A6A6":"#676767",fontFamily:s==="Material"?"Roboto":s==="Fabric"?"Segoe UI":"Helvetica"}};break}return t}var PL=10,jG=function(){function s(e){this.chart=e,this.padding=5}return s.prototype.measureAxis=function(e){var t=this.chart,i=t.chartArea.width?xi(t.chartArea.width,t.availableSize.width):null;this.crossAt(t),this.seriesClipRect=new Ve(e.x,e.y,e.width,e.height),this.initialClipRect=e,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.initialClipRect=Ga(this.initialClipRect,new $a(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.initialClipRect=Ga(this.initialClipRect,new $a(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.seriesClipRect=Ga(this.seriesClipRect,new $a(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.seriesClipRect=Ga(this.seriesClipRect,new $a(0,0,this.topSize,this.bottomSize)),i&&this.calculateFixedChartArea(t,i),this.chart.delayRedraw||(t.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},s.prototype.calculateFixedChartArea=function(e,t){this.seriesClipRect.width=t,this.seriesClipRect.x=e.availableSize.width-e.margin.right-t-(e.legendSettings.position==="Right"?e.legendModule.legendBounds.width:0);for(var i=0,r=e.rows;i<r.length;i++){var n=r[i];this.seriesClipRect.x-=dn(n.farSizes)}},s.prototype.measureRowAxis=function(e,t){var i;this.calculateRowSize(t);for(var r=0,n=e.rows;r<n.length;r++){var a=n[r];i=a,i.nearSizes=[],i.farSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new ei(e.availableSize.width,i.computedHeight)),this.leftSize<dn(i.nearSizes)&&(this.leftSize=dn(i.nearSizes)),this.rightSize<dn(i.farSizes)&&(this.rightSize=dn(i.farSizes))}},s.prototype.measureColumnAxis=function(e,t){var i;this.calculateColumnSize(t);for(var r=0,n=e.columns;r<n.length;r++){var a=n[r];i=a,i.farSizes=[],i.nearSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new ei(i.computedWidth,e.availableSize.height)),this.bottomSize<dn(i.nearSizes)&&(this.bottomSize=dn(i.nearSizes)),this.topSize<dn(i.farSizes)&&(this.topSize=dn(i.farSizes))}},s.prototype.measureDefinition=function(e,t,i){for(var r,n=0,a=e.axes;n<a.length;n++){var o=a[n];r=o.scrollbarSettings.height,o.scrollBarHeight=t.scrollBarModule&&t.zoomModule&&t.zoomSettings.enableScrollbar&&o.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(o.zoomFactor<1||o.zoomPosition>0)?r:0,o.scrollBarHeight=t.scrollBarModule&&(t.zoomModule&&t.zoomSettings.enableScrollbar&&o.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(o.zoomFactor<1||o.zoomPosition>0)||o.scrollbarSettings.enable)?r:0,o.getModule(t),o.baseModule.calculateRangeAndInterval(i,o),e.computeSize(o,o.scrollBarHeight,e,t)}e.farSizes.length>0&&(e.farSizes[e.farSizes.length-1]-=PL),e.nearSizes.length>0&&(e.nearSizes[e.nearSizes.length-1]-=PL)},s.prototype.calculateAxisSize=function(e){var t=this.chart,i,r,n,a,o=0,l=0,h=0,u,c,d;this.calculateRowSize(e);for(var p=0,f=t.rows.length;p<f;p++){i=t.rows[p],o=0,l=0;for(var v=0,g=i.axes.length;v<g;v++){if(a=i.axes[v],d=a.plotOffset,a.rect.height===0){a.rect.height=i.computedHeight,h=0;for(var b=p+1,y=p+a.span;b<y;b++)n=t.rows[b],h+=n.computedHeight;a.rect.y=i.computedTop-h+(a.plotOffsetTop?a.plotOffsetTop:d),a.rect.height=a.rect.height+h-this.getAxisOffsetValue(a.plotOffsetTop,a.plotOffsetBottom,a.plotOffset),a.rect.width=0}a.isAxisOpposedPosition?(a.labelPosition==="Inside"&&a.orientation==="Vertical"?u=e.x+e.width-dn(fl(i.insideFarSizes,l)):u=e.x+e.width+dn(fl(i.farSizes,l)),a.rect.x=a.rect.x>=u?a.rect.x:u,l++):(a.labelPosition==="Inside"&&a.orientation==="Vertical"?u=e.x+dn(fl(i.insideNearSizes,o)):u=e.x-dn(fl(i.nearSizes,o)),a.rect.x=a.rect.x<=u?a.rect.x:u,o++)}}this.calculateColumnSize(e);for(var p=0,f=t.columns.length;p<f;p++){r=t.columns[p],o=0,l=0;for(var v=0,C=r.axes.length;v<C;v++){if(a=r.axes[v],d=a.plotOffset,a.rect.width===0){for(var b=p,x=p+a.span;b<x;b++)n=t.columns[b],a.rect.width+=n.computedWidth;a.rect.x=r.computedLeft+(a.plotOffsetLeft?a.plotOffsetLeft:d),a.rect.width-=this.getAxisOffsetValue(a.plotOffsetLeft,a.plotOffsetRight,a.plotOffset),a.rect.height=0}a.isAxisOpposedPosition?(a.labelPosition==="Inside"&&a.orientation==="Horizontal"?c=e.y+dn(fl(r.insideFarSizes,l)):c=e.y-dn(fl(r.farSizes,l)),a.rect.y=a.rect.y<=c?a.rect.y:c,l++):(a.labelPosition==="Inside"&&a.orientation==="Horizontal"?c=e.y+e.height-dn(fl(r.insideNearSizes,o)):c=e.y+e.height+dn(fl(r.nearSizes,o)),a.rect.y=a.rect.y>=c?a.rect.y:c,o++)}}},s.prototype.measure=function(){for(var e=this.chart,t,i,r,n,a,o=0,l=e.axisCollections;o<l.length;o++){var h=l[o];if(h.orientation==="Vertical"){e.verticalAxes.push(h),n=this.getActualRow(h),t=e.rows[n],this.pushAxis(t,h),a=n+h.span>e.rows.length?e.rows.length:n+h.span;for(var u=n+1;u<a;u++)r=e.rows[u],r.axes[t.axes.length-1]=h,e.rows[u]=r;e.rows[n]=t}else{e.horizontalAxes.push(h),n=this.getActualColumn(h),i=e.columns[n],this.pushAxis(i,h),a=n+h.span>e.columns.length?e.columns.length:n+h.span;for(var u=n+1;u<a;u++)r=e.columns[u],r.axes[i.axes.length-1]=h,e.columns[u]=r;e.columns[n]=i}h.isRTLEnabled=e.enableRtl,h.setIsInversedAndOpposedPosition()}},s.prototype.getAxisOffsetValue=function(e,t,i){var r=e?e+(t||i):t?t+i:2*i;return r},s.prototype.crossAt=function(e){for(var t=0,i=e.axisCollections;t<i.length;t++){var r=i[t];if(r.crossesAt!==null)if(r.crossesInAxis){for(var n=2,a=e.axisCollections.length;n<a;n++)if(r.crossesInAxis===e.axisCollections[n].name){r.crossInAxis=e.axisCollections[n],r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}else{e.requireInvertedAxis?r.crossInAxis=r.orientation==="Horizontal"?e.primaryXAxis:e.primaryYAxis:r.crossInAxis=r.orientation==="Horizontal"?e.primaryYAxis:e.primaryXAxis,r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}},s.prototype.updateCrossAt=function(e,t){switch(e.valueType){case"DateTime":var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);return Date.parse(r(n(new Date(ce.parse.parseJson({val:t}).val))));case"Category":return parseFloat(t)?parseFloat(t):e.labels.indexOf(t);case"Logarithmic":return ch(t,e.logBase);default:return t}},s.prototype.pushAxis=function(e,t){for(var i=0,r=e.axes.length;i<=r;i++)if(!e.axes[i]){e.axes[i]=t;break}},s.prototype.arrangeAxis=function(e){for(var t=[],i=0,r=e.axes.length;i<=r;i++)e.axes[i]&&t.push(e.axes[i]);e.axes=t},s.prototype.getActualColumn=function(e){var t=this.chart.columns.length,i=e.columnIndex,r=i>=t?t-1:i<0?0:i;return r},s.prototype.getActualRow=function(e){var t=this.chart.rows.length,i=e.rowIndex,r=i>=t?t-1:i<0?0:i;return r},s.prototype.calculateRowSize=function(e){/*! Calculate row size */for(var t=this.chart,i,r=e.y+e.height,n=0,a=Math.max(0,e.height),o=0,l=t.rows.length;o<l;o++)i=t.rows[o],i.height.indexOf("%")!==-1?n=Math.min(a,e.height*parseInt(i.height,10)/100):n=Math.min(a,parseInt(i.height,10)),n=o!==l-1?n:a,i.computedHeight=n,r-=n,i.computedTop=r,a-=n},s.prototype.calculateColumnSize=function(e){/*! Calculate column size */for(var t=this.chart,i,r=e.x,n=0,a=Math.max(0,e.width),o=0,l=t.columns.length;o<l;o++)i=t.columns[o],i.width.indexOf("%")!==-1?n=Math.min(a,e.width*parseInt(i.width,10)/100):n=Math.min(a,parseInt(i.width,10)),n=o!==l-1?n:a,i.computedWidth=n,i.computedLeft=r,r+=n,a-=n},s.prototype.renderAxes=function(){var e=this.chart,t,i=e.renderer.createGroup({id:e.element.id+"AxisInsideCollection"}),r=e.renderer.createGroup({id:e.element.id+"AxisOutsideCollection"});r&&r.setAttribute("aria-hidden","true");for(var n,a,o=0,l=e.axisCollections.length;o<l;o++){var h=!0;t=e.axisCollections[o],this.element=e.renderer.createGroup({id:e.element.id+"AxisGroup"+o+"Inside"}),this.element&&this.element.setAttribute("aria-hidden","true"),n=e.renderer.createGroup({id:e.element.id+"AxisGroup"+o+"Outside"}),n&&n.setAttribute("aria-hidden","true");for(var u=0,c=t.series;u<c.length;u++){var d=c[u];if(t.name===d.yAxisName||t.name===d.xAxisName){if(h=d.visible,d.category==="Pareto"&&!d.paretoOptions.showAxis&&d.type==="Line"&&(h=!1),h)break;continue}}h&&(a=this.findAxisPosition(t),t.orientation==="Horizontal"?(t.updateCrossValue(),t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,o,t.plotOffset,0,0,0,t.plotOffsetLeft,t.plotOffsetRight,a?n:this.element,t.updatedRect),(t.majorGridLines.width>0||t.majorTickLines.width>0||t.minorTickLines.width>0||t.minorGridLines.width>0)&&this.drawXAxisGridLine(t,o,a||t.tickPosition==="Inside"?n:this.element,t.updatedRect),t.visible&&t.internalVisibility&&(this.drawXAxisLabels(t,o,a||t.labelPosition==="Inside"?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawXAxisBorder(t,o,a||t.labelPosition==="Inside"?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawXAxisTitle(t,o,a?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect))):(t.updateCrossValue(),t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,o,0,t.plotOffset,t.plotOffsetBottom,t.plotOffsetTop,0,0,a?n:this.element,t.updatedRect),(t.majorGridLines.width>0||t.majorTickLines.width>0||t.minorTickLines.width>0||t.minorGridLines.width>0)&&this.drawYAxisGridLine(t,o,a||t.tickPosition==="Inside"?n:this.element,t.updatedRect),t.visible&&t.internalVisibility&&(this.drawYAxisLabels(t,o,a||t.labelPosition==="Inside"?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawYAxisBorder(t,o,a||t.labelPosition==="Inside"?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawYAxisTitle(t,o,a?n:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect))),this.chart.enableCanvas||(i.appendChild(this.element),n&&n.childNodes.length>0&&r.appendChild(n)),e.scrollBarModule&&(e.zoomSettings.enableScrollbar&&t.enableScrollbarOnZooming||t.scrollbarSettings.enable)&&this.renderScrollbar(e,t))}this.element=e.renderer.createGroup({id:e.element.id+"DefinitionLine"});for(var p=0,l=e.rows.length;p<l;p++){var f=e.rows[p];f.border.color&&this.drawBottomLine(f,p,!0)}for(var p=0,l=e.columns.length;p<l;p++){var v=e.columns[p];v.border.color&&this.drawBottomLine(v,p,!1)}return this.chart.enableCanvas||i.appendChild(this.element),Mt(e.enableCanvas,e.svgObject,i,e.redraw),r},s.prototype.renderScrollbar=function(e,t){var i=m(e.zoomModule)?!1:e.zoomModule.isZoomed;(i&&(t.zoomFactor<1||t.zoomPosition>0)||t.scrollbarSettings.enable&&(t.zoomFactor<=1||t.zoomPosition>=0))&&!t.zoomingScrollBar.isScrollUI?(e.scrollElement||(e.scrollElement=ga(e.redraw,e.element.id+"_scrollElement")||St("div",{id:e.element.id+"_scrollElement"})),Mt(!1,e.scrollElement,t.zoomingScrollBar.render(!0),!0)):t.zoomFactor===1&&t.zoomPosition===0&&t.zoomingScrollBar.svgObject&&!t.scrollbarSettings.enable?t.zoomingScrollBar.destroy():t.zoomingScrollBar.svgObject&&(t.zoomingScrollBar.svgObject.style.top=(t.isAxisOpposedPosition&&t.orientation==="Horizontal"?-16:0)+t.rect.y+Math.max(.5,t.lineStyle.width/2)+"px",t.zoomingScrollBar.svgObject.style.left=(t.isAxisOpposedPosition&&t.orientation!=="Horizontal"?16:0)+t.rect.x-(t.orientation==="Vertical"?t.scrollbarSettings.height:0)+"px"),t.zoomingScrollBar.isScrollUI&&(t.zoomingScrollBar.isScrollUI=!1)},s.prototype.findAxisPosition=function(e){return e.crossAt!==null&&e.isInside(e.crossInAxis.visibleRange)},s.prototype.drawBottomLine=function(e,t,i){var r=this.chart,n={},a,o,l,h,u;i?(e=e,l=h=e.computedTop+e.computedHeight,a=this.seriesClipRect.x,o=a+this.seriesClipRect.width,u="Row"):(e=e,a=o=e.computedLeft,l=this.seriesClipRect.y,h=l+this.seriesClipRect.height,u="Column"),n={id:r.element.id+"_AxisBottom_"+u+t,x1:a,y1:l,x2:o,y2:h,"stroke-width":e.border.width,stroke:e.border.color},this.htmlObject=r.renderer.drawLine(n),this.element.appendChild(this.htmlObject)},s.prototype.drawAxisLine=function(e,t,i,r,n,a,o,l,h,u){var c=this.chart,d={},p=Qe(c.element.id+"AxisLine_"+t),f=p?p.getAttribute("d"):"";p=null,d={id:c.element.id+"AxisLine_"+t,d:"M "+(u.x-i-o)+" "+(u.y-r-a)+" L "+(u.x+u.width+i+l)+" "+(u.y+u.height+r+n),"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||c.themeStyle.axisLine},this.htmlObject=c.renderer.drawPath(d),Mt(c.enableCanvas,h,this.htmlObject,c.redraw,!0,"x","y",null,f)},s.prototype.drawYAxisGridLine=function(e,t,i,r){var n=e.valueType==="Logarithmic",a=e.valueType.indexOf("Category")>-1,o,l=0,h="",u="",c,d=e.isAxisOpposedPosition,p=d?e.majorTickLines.height:-e.majorTickLines.height,f=d?e.lineStyle.width*.5:-e.lineStyle.width*.5,v=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?.5:0,g=m(e.crossesAt)?d?e.scrollBarHeight:-e.scrollBarHeight:0,b=e.tickPosition==="Inside",y=b?r.x-p-f:r.x+p+f+g,C=e.visibleLabels.length,x=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&e.labelPlacement==="BetweenTicks"&&C>0&&!this.chart.stockChart&&(C+=1);for(var w=e.minorGridLines,M=e.minorTickLines,E=0;E<C;E++)o=e.visibleLabels[E]?e.visibleLabels[E].value-v:e.visibleLabels[E-1].value+e.visibleRange.interval-v,l=mn(o,e)*r.height,l=l*-1+(r.y+r.height),l>=r.y&&r.y+r.height>=l&&((Op(o,e.visibleRange)||this.isBorder(e,E,l))&&(h="M "+this.seriesClipRect.x+" "+l+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+l,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",E,this.element,x.majorGridLine,e.majorGridLines.dashArray)),u="M "+(r.x+f+(b?g:0))+" "+l+" L "+y+" "+l,this.renderGridLine(e,t,u,e.majorTickLines,"_MajorTickLine_",E,i,x.majorTickLine),(w.width>0||M.width>0)&&e.minorTicksPerInterval>0&&(E===0&&Rp(e)&&!n&&!a&&this.renderMinorGridOnZooming(e,o,r,E,t,x,i),c=this.drawAxisMinorLine(e,o,r,E),this.renderGridLine(e,t,c[0],w,"_MinorGridLine_",E,this.element,x.minorGridLine,w.dashArray),this.renderGridLine(e,t,c[1],M,"_MinorTickLine_",E,i,x.minorTickLine),E===C-1&&Rp(e)&&n&&!a&&this.renderMinorGridOnZooming(e,o+e.visibleRange.interval,r,E,t,x,i)))},s.prototype.isBorder=function(e,t,i){var r=this.chart.chartArea.border,n=this.seriesClipRect,a=e.orientation,o=a==="Horizontal"?n.x:n.y,l=a==="Horizontal"?n.width:n.height,h=a==="Horizontal"?0:e.visibleLabels.length-1,u=a==="Horizontal"?e.visibleLabels.length-1:0;return e.plotOffset>0||(i===o||i===o+l)&&(r.width<=0||r.color==="transparent")?!0:i!==o&&t===h||i!==o+l&&t===u},s.prototype.drawYAxisLabels=function(e,t,i,r){var n=this.chart,a,o=0,l=0,h,u=e.labelPadding,c,d,p=e.labelPosition==="Inside",f=e.isAxisOpposedPosition,v,g=e.labelPosition===e.tickPosition?e.majorTickLines.height:0,b=g+u+e.lineStyle.width*.5,y=e.angle%360,C=y===-90||y===90||y===270||y===-270;b+=C?p?5:-5:0,b=f?b:-b;var x=n.renderer.createGroup({id:n.element.id+"AxisLabels"+t}),w=m(e.crossesAt)?e.scrollBarHeight*(f?1:-1):0,M,E,T,D=10,N=e.isAxisInverse,A=N?r.y:r.y+r.height,L,k,O,R,j=!f&&!p||f&&p;p?L=j?b:-b:L=j?b+w:-b+w;var P=[],F=[];e.visibleLabels.map(function(oe){P.push(oe.size.width),F.push(oe.breakLabelSize.width)});var z=Math.max.apply(Math,P),q=Math.max.apply(Math,F);v=z,y>=-45&&y<=45&&y!==0&&(v=z*Math.cos(y*Math.PI/180),v<0&&(v=-v));for(var X=0,G=e.visibleLabels.length;X<G;X++){switch(a=e.visibleLabels[X],d=Xh(e.visibleLabels[X].originalText),h=d?e.visibleLabels[X].breakLabelSize:e.visibleLabels[X].size,l=mn(e.visibleLabels[X].value,e)*r.height+(n.stockChart?7:0),l=Math.floor(l*-1+(r.y+r.height)),M=h.height/8*e.visibleLabels[X].text.length/2,E=n.requireInvertedAxis&&e.labelPosition==="Inside"?0:h.height/4*3+3,k=r.height/e.visibleLabels.length,O=(e.labelIntersectAction==="Trim"||e.labelIntersectAction==="Wrap")&&y!==0&&h.width>k?k:h.width,l=d?e.labelPosition==="Inside"?l-h.height/2-M+E:l-M:e.labelPosition==="Inside"?l+E:l,e.labelPosition==="Inside"&&(X===0&&!e.isInversed||X===G-1&&e.isInversed)&&(n.stockChart?l-=E:l-=E-(n.requireInvertedAxis&&e.labelPosition==="Inside"?0:e.opposedPosition?-b:b)),e.majorGridLines.width>e.majorTickLines.width?T=e.majorGridLines.width:T=e.majorTickLines.width,e.labelStyle.textAlignment==="Far"?l=l-T-D:e.labelStyle.textAlignment==="Near"?l=l+T+D:e.labelStyle.textAlignment==="Center"&&(l=l),p?R=L+(y===0?h.width:d?q:z)/2:R=L-(y===0?h.width:d?q:v)/2,o=f?r.x-R:r.x+R,C&&(o+=f?-10:10),R=L,c=new Sn(n.element.id+t+"_AxisLabel_"+X,o,l,"middle",a.text,"","middle",y),e.edgeLabelPlacement){case"None":break;case"Hide":((X===0||N&&X===G-1)&&c.y>r.y||(X===G-1||N&&X===0)&&c.y-h.height*.5<r.y)&&(c.text="");break;case"Shift":(X===0||N&&X===G-1)&&c.y>r.y+r.height?c.y=l=r.y+r.height:(X===G-1||N&&X===0)&&c.y<r.y&&(c.y=l=r.y+h.height*.5);break}var Z=c.y,se=c.y-O;d&&(Z=c.y-O/2,se=c.y+O/2),!((y===90||y===270)&&e.labelIntersectAction==="Hide"&&X!==0&&(N?se<=A:Z>=A))&&(A=N?Z:se,c.transform="rotate("+y+","+o+","+l+")",bn(n.renderer,c,a.labelStyle,a.labelStyle.color||n.themeStyle.axisLabelFont.color,x,!1,n.redraw,!0,!0,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisLabelFont))}this.chart.enableCanvas||(n.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,x,e,t,r):Mt(n.enableCanvas,i,x,n.redraw))},s.prototype.getAxisLabelXvalue=function(e,t,i){var r=t.lineBreakAlignment,n=t.labelPosition==="Inside",a=t.isAxisOpposedPosition;return a&&n||!a&&!n?r==="Right"?e:r==="Center"?e-i/2:e-i:r==="Left"?e:r==="Center"?e+i/2:e+i},s.prototype.drawYAxisBorder=function(e,t,i,r){if(e.border.width>0){var n=void 0,a=void 0,o=e.labelPosition==="Outside"?e.scrollBarHeight:0,l=e.isAxisOpposedPosition;o=(l?1:-1)*o;for(var h=r.height/e.visibleRange.delta*(e.valueType==="DateTime"?e.dateTimeInterval:e.visibleRange.interval),u=void 0,c=e.maxLabelSize.width+10+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),d="",p=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?-.5:0,f=l&&e.labelPosition==="Inside"||!l&&e.labelPosition==="Outside"?r.x-c+o:r.x+c+o,v=0,g=e.visibleLabels.length;v<g;v++)switch(a=mn(e.visibleLabels[v].value+p,e),a=(e.isAxisInverse?1-a:a)*r.height,e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?(n=a*-1+(r.y+r.height),u=a*-1-h+(r.y+r.height)):(n=a*-1+h/2+(r.y+r.height),u=a*-1-h/2+(r.y+r.height)),e.border.type){case"Rectangle":case"WithoutTopBorder":n>r.y+r.height?d+="M "+f+" "+(r.y+r.height)+" L "+f+" "+u+" ":Math.floor(r.y)>u?d+="M "+(r.x+o)+" "+n+" L "+f+" "+n+" L "+f+" "+r.y+" ":(d+="M "+(r.x+o)+" "+n+" L "+f+" "+n+" L "+f+" "+u+" ",v===e.visibleLabels.length-1&&(d+="M "+(r.x+o)+" "+u+" L "+f+" "+u+" "));break;case"WithoutTopandBottomBorder":!(n>r.y+r.height)&&!(u<Math.floor(r.y))&&(d+="M "+(r.x+o)+" "+n+" L "+f+" "+n+" M "+f+" "+u+" L "+(r.x+o)+" "+u);break}d+=e.border.type==="Rectangle"?"M "+(r.x+o)+" "+r.y+" L "+(r.x+o)+" "+(r.y+r.height)+" ":"",d!==""&&this.createAxisBorderElement(e,t,d,i)}for(var v=0;v<this.chart.visibleSeries.length;v++)if(e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.visibleSeries[v].visible){this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(e,t,i,r);break}},s.prototype.drawYAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,a=!1,o=e.isAxisOpposedPosition,l=(e.titleRotation==null?o?90:-90:e.titleRotation)%360,h=(e.tickPosition==="Inside"?0:e.majorTickLines.height+e.titlePadding)+(e.labelPosition==="Inside"?0:e.maxLabelSize.width+e.multiLevelLabelHeight+this.padding);h=o?h+e.scrollBarHeight:-h-e.scrollBarHeight,(l!==-90&&!o||l!==90&&o)&&(h+=e.isAxisOpposedPosition?e.titleSize.width/2+e.labelPadding:-e.titleSize.width/2-e.labelPadding,a=!0);var u=r.x+h,c=void 0,d=void 0;e.titleStyle.textAlignment==="Center"?(d="middle",c=r.y+r.height*.5):e.titleStyle.textAlignment==="Near"?(d=e.opposedPosition?"end":"start",c=r.height+r.y):(d=e.opposedPosition?"start":"end",c=r.y);var p=e.titleSize.height*(e.titleCollection.length-1),f=new Sn(n.element.id+"_AxisTitle_"+t,u,c+(a?-p:-e.labelPadding-p),d,e.titleCollection,"rotate("+l+","+u+","+c+")",null,l),v=bn(n.renderer,f,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,null,null,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont);v.setAttribute("aria-hidden","true")}},s.prototype.drawXAxisGridLine=function(e,t,i,r){var n=e.valueType==="Logarithmic",a=e.valueType.indexOf("Category")>-1,o,l=0,h="",u="",c,d=e.isAxisOpposedPosition,p=d?-e.majorTickLines.height:e.majorTickLines.height,f=d?-e.lineStyle.width*.5:e.lineStyle.width*.5,v=m(e.crossesAt)?d?-e.scrollBarHeight:e.scrollBarHeight:0,g=e.valueType.indexOf("Category")>-1&&e.labelPlacement==="BetweenTicks"&&!this.chart.stockChart?.5:0,b=e.visibleLabels.length,y=e.tickPosition==="Inside",C=y?r.y-p-f:r.y+p+f+v,x=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&b>0&&e.labelPlacement==="BetweenTicks"&&!this.chart.stockChart&&(b+=1);for(var w=0;w<b;w++)e.valueType!=="DateTimeCategory"?o=e.visibleLabels[w]?e.visibleLabels[w].value-g:e.visibleLabels[w-1].value+e.visibleRange.interval-g:o=e.visibleLabels[w]?e.visibleLabels[w].value-g:e.visibleRange.max,l=mn(o,e)*r.width+r.x,l>=r.x&&r.x+r.width>=l&&((Op(o,e.visibleRange)||this.isBorder(e,w,l))&&(h="M "+l+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+l+" "+this.seriesClipRect.y,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",w,this.element,x.majorGridLine,e.majorGridLines.dashArray)),u="M "+l+" "+(r.y+f+(y?v:0))+" L "+l+" "+C,this.renderGridLine(e,t,u,e.majorTickLines,"_MajorTickLine_",w,i,x.majorTickLine),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&(w===0&&Rp(e)&&!n&&!a&&this.renderMinorGridOnZooming(e,o,r,w,t,x,i),c=this.drawAxisMinorLine(e,o,r,w),this.renderGridLine(e,t,c[0],e.minorGridLines,"_MinorGridLine_",w,this.element,x.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,t,c[1],e.minorTickLines,"_MinorTickLine_",w,i,x.minorTickLine),w===b-1&&Rp(e)&&n&&!a&&this.renderMinorGridOnZooming(e,o+e.visibleRange.interval,r,w,t,x,i)))},s.prototype.renderMinorGridOnZooming=function(e,t,i,r,n,a,o){var l=this.drawAxisMinorLine(e,t,i,r,!0);this.renderGridLine(e,n,l[0],e.minorGridLines,"_MinorGridLine_",-1,this.element,a.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,n,l[1],e.minorTickLines,"_MinorTickLine_",-1,o,a.minorTickLine)},s.prototype.drawAxisMinorLine=function(e,t,i,r,n){var a=t,o=0,l=0,h=e.visibleRange,u=e.tickPosition==="Inside",c=[],d=e.isAxisOpposedPosition?-e.minorTickLines.height:e.minorTickLines.height,p,f,v=1,g=1,b=u?i.y-d:i.y+d,y=u?i.x+d:i.x-d,C="",x="",w=e.isAxisInverse;if(e.valueType==="Logarithmic"&&(p=Math.pow(e.logBase,a-h.interval),f=Math.pow(e.logBase,a),v=(f-p)/(e.minorTicksPerInterval+1),g=p+v),e.orientation==="Horizontal")for(var M=0;M<e.minorTicksPerInterval;M++)a=this.findLogNumeric(e,g,a,r,n),g+=v,Op(a,h)&&(l=(a-h.min)/(h.max-h.min),l=Math.ceil((w?1-l:l)*i.width),o=Math.floor(l+i.x),C=C.concat("M "+o+" "+this.seriesClipRect.y+"L "+o+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),o=Math.floor(l+i.x),x=x.concat("M "+o+" "+i.y+"L "+o+" "+(b+e.scrollBarHeight)));else for(var M=0;M<e.minorTicksPerInterval;M++)a=this.findLogNumeric(e,g,a,r,n),Op(a,h)&&(l=(a-h.min)/(h.max-h.min),l=Math.ceil((w?1-l:l)*i.height)*-1,o=Math.floor(l+i.y+i.height),C=C.concat("M "+this.seriesClipRect.x+" "+o+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+o+" "),o=Math.floor(l+i.y+i.height),x=x.concat("M "+i.x+" "+o+"L "+(y-e.scrollBarHeight)+" "+o+" ")),g+=v;return c.push(C),c.push(x),c},s.prototype.findLogNumeric=function(e,t,i,r,n){var a=e.visibleRange,o;if(e.valueType==="Logarithmic")i=ch(t,e.logBase);else if(e.valueType==="DateTime")o=e.dateTimeInterval/(e.minorTicksPerInterval+1),i=n?i-o:i+o;else if(e.valueType==="DateTimeCategory"){var l=e.labelPlacement==="BetweenTicks"?.5:0;i+=((e.visibleLabels[r+1]?e.visibleLabels[r+1].value-l:e.visibleRange.max)-(e.visibleLabels[r]?e.visibleLabels[r].value-l:e.visibleRange.min))/(e.minorTicksPerInterval+1)}else o=a.interval/(e.minorTicksPerInterval+1),i=n?i-o:i+o;return i},s.prototype.drawXAxisLabels=function(e,t,i,r){var n=this.chart,a=0,o=0,l=e.labelPadding,h,u,c,d,p=10,f=n.renderer.createGroup({id:n.element.id+"AxisLabels"+t}),v=e.labelPosition==="Inside",g=e.isAxisOpposedPosition,b=e.labelPosition===e.tickPosition?e.majorTickLines.height:0,y=b+l+e.lineStyle.width*.5,C=e.angle%360,x=C===0||C===-180||C===180,w,M,E=e.isAxisInverse,T,D=E?r.x+r.width:r.x,N=0,A=e.visibleLabels.length,L,k,O,R=e.scrollbarSettings.enable||!v&&m(e.crossesAt)&&(e.zoomFactor<1||e.zoomPosition>0)?e.scrollBarHeight:0,j=[],P=!1,F=[],z=new ei(0,0);y+=C===90||C===270||C===-90||C===-270?v?5:-5:0;for(var q=!g&&!v||g&&v,X=q?360>=C&&C>=180||-1>=C&&C>=-180:1<=C&&C<=180||-181>=C&&C>=-360,G=0,Z=A;G<Z;G++){k=e.visibleLabels[G],O=Xh(k.originalText)||e.labelIntersectAction==="Wrap"&&k.text.length>1,a=mn(k.value,e)*r.width+r.x,u=k.size,L=r.width/A,M=O?k.breakLabelSize.width:u.width,N=(e.labelIntersectAction==="Trim"||e.labelIntersectAction==="Wrap")&&C===0&&M>L?L:M,h=u.height/4,a-=O||C!==0?0:N/2,C!==0&&(O?a-=e.lineBreakAlignment==="Left"?k.breakLabelSize.width/2:e.lineBreakAlignment==="Right"?-(k.breakLabelSize.width/2):0:a-=C===-90||C===270?-h:C===90||C===-270?h:0),e.labelStyle.textAlignment==="Far"?a=a+N-p:e.labelStyle.textAlignment==="Near"?a=a-N+p:e.labelStyle.textAlignment==="Center"&&(a=a),O&&e.lineBreakAlignment!=="Center"&&C===0&&(a+=e.lineBreakAlignment==="Left"?-(N/2):N/2);var se=O?x?e.opposedPosition||v?0:u.height:k.breakLabelSize.width/2:0;if(y=O?b+l+e.lineStyle.width*.5:y,v&&C?O?o=g?r.y+y+se:r.y-y-se:o=g?r.y+y+h:r.y-y-h:(O?c=q?y+R+(C?se:3*h):-(y+R+se):c=q?y+R+(C?1:3)*h:-(y+R+(C?h:k.index>1?2*h:0)),o=r.y+c*k.index),O?d=this.getAnchor(e):d=n.enableRtl?X?"":"end":n.isRtlEnabled||X?"end":"",w=new Sn(n.element.id+t+"_AxisLabel_"+G,a,o,d),C!==0&&!n.stockChart&&(z=Ng(k.labelStyle,k.originalText,C,n),T=C<0&&C>-90||C<-180&&C>-270||C>90&&C<180||C>270&&C<360),e.edgeLabelPlacement)switch(e.edgeLabelPlacement){case"None":break;case"Hide":if((G===0||E&&G===Z-1)&&w.x<r.x||(G===Z-1||E&&G===0)&&w.x+(C===0?N:z.width)>r.x+r.width)continue;break;case"Shift":if((G===0||E&&G===Z-1)&&(w.x<r.x||C!==0&&T&&w.x-z.width<=r.x||e.lineBreakAlignment==="Center"&&w.x-k.size.width/k.text.length/2<r.x&&C===0))if(L-=r.x-w.x,d===""&&!E&&C===0)w.x<=0?a=w.x=0:a=w.x,L=r.width/A;else if(T&&C!==0)L=r.width/A,L>r.x+z.width?w.x=a=r.x+z.width:w.x=a=r.x+L-y;else if(O&&e.lineBreakAlignment==="Center"&&e.labelPlacement==="OnTicks"&&C===0){for(var oe=0,fe=0;fe<k.text.length;fe++){var be=ht(k.text[fe],e.labelStyle,n.themeStyle.axisLabelFont).width;be>oe&&(oe=be)}w.x=a=r.x+oe/2}else d==="start"&&w.x>0||(w.x=a=x?r.x:r.x+y);else(G===Z-1||E&&G===0)&&(w.x+N>r.x+r.width&&d!=="end"&&C===0||C!==0&&!T&&w.x+z.width>r.x+r.width||d==="end"&&w.x>r.x+r.width)&&(u.width>L&&e.labelIntersectAction==="Trim"&&C===0?L-=w.x+N-(r.x+r.width):C!==0?z.width<L&&(L=z.width):L=N,C!==0?w.x=a=r.x+r.width-L+y:w.x=a=x?r.x+r.width-L:r.x+r.width-L/2);break}w.text=this.getLabelText(k,e,L),w.labelRotation=C;var Ne=void 0,we=void 0;if(O&&C===0?e.lineBreakAlignment==="Right"?(Ne=w.x-N,we=w.x):e.lineBreakAlignment==="Center"?(Ne=w.x-N/2,we=w.x+N/2):(Ne=w.x,we=w.x+N):(Ne=w.x,we=w.x+N),!(C===0&&e.labelIntersectAction==="Hide"&&G!==0&&(E?we>=D:Ne<=D))){if(O?e.lineBreakAlignment==="Right"?D=E?w.x-N:w.x:e.lineBreakAlignment==="Center"?D=E?w.x-N/2:w.x+N/2:D=E?w.x:w.x+N:D=E?w.x:w.x+N,C!==0){var H=void 0,V=void 0;if(O){var re=0,he=0;H=k.breakLabelSize.height,he=k.breakLabelSize.height-4,e.lineBreakAlignment==="Center"?re=-(k.breakLabelSize.width/2):e.lineBreakAlignment==="Right"&&(re=-k.breakLabelSize.width),q&&(he=k.breakLabelSize.height/(w.text.length+1)),V=new Ve(w.x+re,w.y-he,k.breakLabelSize.width,H)}else H=o-(w.y-k.size.height/2),V=new Ve(w.x,w.y-(k.size.height/2-5),k.size.width,H);var Ie=this.getRectanglePoints(V),Te=O?V.x+V.width/2:a,rt=O?V.y+V.height/2:o-H/2;if(O?w.transform="rotate("+C+","+Te+","+rt+")":w.transform="rotate("+C+","+a+","+o+")",j.push(_M(Ie,Te,rt,C)),P=!1,e.labelIntersectAction!=="None"){for(var Tt=G;Tt>0;Tt--)if(j[G]&&j[Tt-1]&&E2(j[G],j[Tt-1])){P=!0,j[G]=null;break}}var si=C>0&&C<90||C>180&&C<270||C<-90&&C>-180||C<-270&&C>-360,K=new Ve(w.x,w.y-(u.height/2+y/2),k.size.width,H),ue=this.getRectanglePoints(K),Me=[];Me.push(new ut(si?this.chart.availableSize.width:this.padding,e.rect.y)),Me.push(new ut(si?this.chart.availableSize.width:this.padding,e.rect.y+e.maxLabelSize.height)),F.push(_M(ue,Te,rt,C));for(var Ae=new Ve(0,e.rect.y,this.chart.availableSize.width,e.maxLabelSize.height*2),Be=0;Be<F[G].length;Be++)if(!e.opposedPosition&&!Mn(F[G][Be].x,F[G][Be].y,Ae)&&typeof w.text=="string"){var _e=this.calculateIntersection(F[G][0],F[G][1],Me[0],Me[1]),it=si?this.chart.availableSize.width-a:a,Si=_e.y-e.rect.y,vr=Math.sqrt(it*it+Si*Si);w.text=ta(vr,k.text,k.labelStyle,n.enableRtl,n.themeStyle.axisLabelFont)}}bn(n.renderer,w,k.labelStyle,k.labelStyle.color||n.themeStyle.axisLabelFont.color,f,e.isAxisOpposedPosition!==(e.labelPosition==="Inside"),n.redraw,!0,null,null,null,k.size,P,n.enableCanvas,null,n.themeStyle.axisLabelFont)}}this.chart.enableCanvas||(n.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,f,e,t,r):i.appendChild(f))},s.prototype.calculateIntersection=function(e,t,i,r){var n=i.x-r.x,a=e.x-t.x,o=i.y-r.y,l=e.y-t.y,h=a*o-l*n,u=e.x*t.y-e.y*t.x,c=i.x*r.y-i.y*r.x,d=(u*n-a*c)/h,p=(u*o-l*c)/h,f={x:d,y:p};return f},s.prototype.getAnchor=function(e){return e.lineBreakAlignment==="Center"?"middle":this.chart.enableRtl?e.lineBreakAlignment==="Left"?"end":"start":e.lineBreakAlignment==="Left"?"start":"end"},s.prototype.getRectanglePoints=function(e){var t=new ut(e.x,e.y),i=new ut(e.x+e.width,e.y),r=new ut(e.x+e.width,e.y+e.height),n=new ut(e.x,e.y+e.height);return[t,i,r,n]},s.prototype.getLabelText=function(e,t,i){if(Xh(e.originalText)){for(var r=[],n=void 0,a=0;a<e.text.length;a++)n=this.findAxisLabel(t,e.text[a],i),r.push(n);return r}else return this.findAxisLabel(t,e.text,i)},s.prototype.drawXAxisBorder=function(e,t,i,r){if(e.border.width>0){for(var n=e.labelPosition==="Outside"?e.scrollBarHeight:0,a=e.isAxisOpposedPosition,o=void 0,l=r.y+(a?-1:1)*n,h=10,u=void 0,c=r.width/e.visibleRange.delta*(e.valueType==="DateTime"?e.dateTimeInterval:e.visibleRange.interval),d=void 0,p=e.maxLabelSize.height+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),f="",v=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?-.5:0,g=a&&e.labelPosition==="Inside"||!a&&e.labelPosition==="Outside"?r.y+p+h+n:r.y-p-h-n,b=0,y=e.visibleLabels.length;b<y;b++)switch(u=mn(e.visibleLabels[b].value+v,e),u=(e.isAxisInverse?1-u:u)*r.width,e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?(o=u+r.x,d=u+c+r.x):(o=u-c*.5+r.x,d=u+c*.5+r.x),e.border.type){case"Rectangle":case"WithoutTopBorder":o<r.x&&e.labelPlacement!=="OnTicks"?f+="M "+r.x+" "+g+" L "+d+" "+g+" ":Math.floor(d)>r.width+r.x&&e.visibleLabels.length!==1&&b!==e.visibleLabels.length-1?f+="M "+o+" "+l+" L "+o+" "+g+" L "+(r.width+r.x)+" "+g+" ":(o=b===0&&e.labelPlacement==="OnTicks"?r.x:o,d=b===e.visibleLabels.length-1&&e.labelPlacement==="OnTicks"?d-c*.5:d,f+="M "+o+" "+l+" L "+o+" "+g+" L "+d+" "+g+" ",b===0&&(f+="M "+o+" "+l+" L "+o+" "+g+" M "+o+" "+g+" L "+r.x+" "+g),b===e.visibleLabels.length-1&&(f+="M "+d+" "+l+" L "+d+" "+g+" M "+d+" "+g+" L "+(r.width+r.x)+" "+g));break;case"WithoutTopandBottomBorder":!(o<r.x)&&!(Math.floor(d)>r.width+r.x)&&(f+="M "+o+" "+l+" L "+o+" "+g+" M "+d+" "+l+" L "+d+" "+g);break}f+=e.border.type==="Rectangle"?"M  "+r.x+" "+l+"L "+(r.x+r.width)+" "+l:"",f!==""&&this.createAxisBorderElement(e,t,f,i)}for(var b=0;b<this.chart.visibleSeries.length;b++)if(this.chart.multiLevelLabelModule&&e.multiLevelLabels.length>0&&this.chart.visibleSeries[b].visible){this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(e,t,i,r);break}},s.prototype.createAxisBorderElement=function(e,t,i,r){var n=Qe(this.chart.element.id+"_BorderLine_"+t),a=n?n.getAttribute("d"):"",o=this.chart.renderer.drawPath(new Er(this.chart.element.id+"_BorderLine_"+t,"transparent",e.border.width,e.border.color||this.chart.themeStyle.axisLine,1,"",i));o.style.pointerEvents="none",Mt(this.chart.enableCanvas,r,o,this.chart.redraw,!1,"x","y",null,a,!0)},s.prototype.findAxisLabel=function(e,t,i){return e.labelIntersectAction==="Trim"&&e.angle%360===0&&!e.enableTrim?ta(i,t,e.labelStyle,this.chart.enableRtl,this.chart.themeStyle.axisLabelFont):t},s.prototype.drawXAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,a=ht(e.title,e.titleStyle,this.chart.themeStyle.axisTitleFont),o=m(e.crossesAt)?e.scrollBarHeight:0,l=(e.tickPosition==="Inside"?0:e.majorTickLines.height+e.titlePadding)+(e.labelPosition==="Inside"?0:e.maxLabelSize.height+e.multiLevelLabelHeight+e.labelPadding),h=e.titleSize.height*(e.titleCollection.length-1);l=e.isAxisOpposedPosition?-(l+a.height/4+o+h):l+3*a.height/4+o;var u=e.titleRotation?e.titleRotation:0,c=void 0,d=r.y+l,p=void 0;e.titleStyle.textAlignment==="Center"?(p="middle",c=r.x+r.width*.5):e.titleStyle.textAlignment==="Near"?(p="start",c=r.x):(p="end",c=r.x+r.width),u!==0&&(d+=e.opposedPosition?-(e.titleSize.height/2+a.height/4):e.titleSize.height/2-a.height/4);var f=new Sn(n.element.id+"_AxisTitle_"+t,c,d,p,e.titleCollection,"rotate("+u+","+c+","+d+")",null,u),v=bn(n.renderer,f,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,null,null,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont);v.setAttribute("aria-hidden","true")}},s.prototype.renderGridLine=function(e,t,i,r,n,a,o,l,h){h===void 0&&(h=null);var u=this.chart,c,d;r.width>0&&e.visible&&e.internalVisibility&&i&&(d=Qe(u.element.id+n+t+"_"+a),c=d?d.getAttribute("d"):null,d=null,this.htmlObject=u.renderer.drawPath(new Er(u.element.id+n+t+"_"+a,"transparent",r.width,r.color||l,null,h,i)),Mt(u.enableCanvas,o,this.htmlObject,u.redraw,!0,"x","y",null,c,!0))},s.prototype.findParentNode=function(e,t,i){return document.getElementById(e+"AxisGroup"+i+"Inside").contains(document.getElementById(t.id))?document.getElementById(e+"AxisGroup"+i+"Inside"):document.getElementById(e+"AxisGroup"+i+"Outside")},s.prototype.createZoomingLabel=function(e,t,i,r,n){var a=this.findParentNode(e.element.id,t,r);t.setAttribute("opacity","0.3");var o=e.renderer.createGroup({id:e.element.id+"AxisLabels_Zoom"+r});o=mG(e,i,o,r,i.orientation==="Vertical",n),a.replaceChild(t,document.getElementById(t.id)),Qe(e.element.id+"AxisLabels_Zoom"+r)?a.replaceChild(o,document.getElementById(o.id)):a.appendChild(o)},s}(),GI=function(){function s(e){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.commonXvalues=[],this.chart=e,this.lierIndex=0}return s.prototype.getData=function(){for(var e=this.chart,t=null,i=null,r,n,a,o,l=e.visibleSeries.length,h=l-1;h>=0;h--){if(i=e.visibleSeries[h],r=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.height+5)/2:0,n=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.width+5)/2:0,a=e.mouseX,o=e.mouseY,i.dragSettings.enable&&i.isRectSeries)if(!(i.type==="Bar"&&e.isTransposed)&&(e.isTransposed||i.type==="Bar")){var u=i.marker.width/2;a=i.yAxis.isAxisInverse?a+u:a-u}else{var c=i.marker.height/2;o=i.yAxis.isAxisInverse?o-c:o+c}if(i.visible&&Mn(a,o,i.clipRect,r,n)&&(t=this.getRectPoint(i,i.clipRect,a,o)),t)return new rf(t,i)}return new rf(t,i)},s.prototype.isSelected=function(e){return(e.selectionMode.indexOf("Drag")>-1||e.selectionMode.indexOf("Lasso")>-1)&&e.selectionModule&&e.selectionModule.rectPoints!==null},s.prototype.getRectPoint=function(e,t,i,r){var n=this.chart,a,o,l,h=0,u,c,d;if(n.isScrolling)return null;for(var p=0,f=e.points;p<f.length;p++){var v=f[p];if(!(!v.regionData&&(!v.regions||!v.regions.length))){if(v.regionData&&this.chart.chartAreaType==="PolarRadar"&&e.drawType.indexOf("Column")>-1&&(a=i-(e.clipRect.width/2+e.clipRect.x),o=r-(e.clipRect.height/2+e.clipRect.y),h=2*Math.PI*(v.regionData.currentXPosition<0?1+v.regionData.currentXPosition:v.regionData.currentXPosition),l=(Math.atan2(o,a)+.5*Math.PI-h)%(2*Math.PI),l=l<0?2*Math.PI+l:l,l=l+2*Math.PI*e.chart.primaryXAxis.startAngle,u=v.regionData.startAngle,u-=h,u=u<0?2*Math.PI+u:u,c=v.regionData.endAngle,c-=h,c=c<0?2*Math.PI+c:c,d=Math.sqrt(Math.pow(Math.abs(a),2)+Math.pow(Math.abs(o),2)),l>=u&&l<=c&&(d>=v.regionData.innerRadius&&d<=v.regionData.radius||d<=v.regionData.innerRadius&&d>=v.regionData.radius)&&d<=e.chart.radius))return v;if((e.dragSettings.enable&&e.isRectSeries||e.isRectSeries&&e.marker.visible)&&this.isPointInThresholdRegion(i,r,v,t,e))return this.insideRegion=!0,v;if(!this.insideRegion&&this.checkRegionContainsPoint(v.regions,t,i,r))return v;if(this.insideRegion&&this.checkRegionContainsPoint(v.regions,t,i,r))return v}}return null},s.prototype.checkRegionContainsPoint=function(e,t,i,r){var n=this;return e.some(function(a,o){return n.lierIndex=o,Mn(i,r,new Ve((n.chart.chartAreaType==="Cartesian"?t.x:0)+a.x,(n.chart.chartAreaType==="Cartesian"?t.y:0)+a.y,a.width,a.height))})},s.prototype.isPointInThresholdRegion=function(e,t,i,r,n){var a=this,o=n.type==="Bar",l=n.yAxis.isAxisInverse,h=n.chart.isTransposed,u=10,c=0,d=0,p,f=p=2*u;return l&&h?o?(c=i.regions[0].height-u,p=i.regions[0].width):(d=-u,f=i.regions[0].height):l||i.yValue<0?o?(d=-u,f=i.regions[0].height):(c=i.regions[0].height-u,p=i.regions[0].width):h?o?(c=-u,p=i.regions[0].width):(d=i.regions[0].width-u,f=i.regions[0].height):o?(d=i.regions[0].width-u,f=i.regions[0].height):(c=-u,p=i.regions[0].width),i.regions.some(function(v){return Mn(e,t,new Ve((a.chart.chartAreaType==="Cartesian"?r.x:0)+v.x+d,(a.chart.chartAreaType==="Cartesian"?r.y:0)+v.y+c,p,f))})},s.prototype.getClosest=function(e,t,i){var r,n,a=i||e.xData,o=a.length,l=.5,h=.5;if(e.xAxis.valueType==="DateTime"&&e.points.length===1){l=e.xAxis.visibleRange.min,h=e.xAxis.visibleRange.max;for(var u=0;u<e.chart.visibleSeries.length;u++){var c=e.chart.visibleSeries[u];c.xMin>=l&&c.xMin<e.xMin&&(l=c.xMin+.1),c.xMax<=h&&c.xMax>e.xMax&&(h=c.xMax-.1),c.points.length>1&&(c.xMax>=l&&c.xMax<e.xMin&&(l=c.xMax+.1),c.xMin<=h&&c.xMin>e.xMax&&(h=c.xMin-.1))}l!==e.xAxis.visibleRange.min&&(l=Math.abs(e.xMin-l)/2),h!==e.xAxis.visibleRange.max&&(h=Math.abs(e.xMax-h)/2)}if(t>=e.xMin-l&&t<=e.xMax+h)for(var d=0;d<o;d++)n=a[d],(r==null||Math.abs(n-t)<Math.abs(r-t))&&(r=n);var p=e.xData.indexOf(r)!==-1;return p?r:null},s.prototype.binarySearch=function(e,t){for(var i=0,r=t.length,n=-1,a=!1,o;a===!1&&i<=r;)o=Math.floor((i+r)/2),t[o].xValue===e?(a=!0,n=o):t[o].xValue>e?r=o-1:i=o+1;return n!==-1?t[n]:null},s.prototype.getClosestX=function(e,t,i){var r,n=t.clipRect;e.mouseX<=n.x+n.width&&e.mouseX>=n.x&&(e.requireInvertedAxis?r=yG(e.mouseY-n.y,n.height,t.xAxis):r=gG(e.mouseX-n.x,n.width,t.xAxis));var a=this.getClosest(t,r,i),o=(a||a===0)&&t.points.length>0?this.binarySearch(a,M2(t.points,["xValue"])):null;return o&&o.visible&&this.chart.chartAreaType==="Cartesian"&&(t.category=="Indicator"&&t.name=="Histogram"||o.symbolLocations&&o.symbolLocations.length>0&&o.symbolLocations[0].x>=0&&o.symbolLocations[0].x<=n.width)?new rf(o,t):null},s.prototype.mergeXvalues=function(e){if(e.length&&(!this.commonXvalues.length||this.commonXvalues.length!==e[0].xData.length)){this.commonXvalues=e[0].xData;for(var t=1;t<e.length;t++)this.commonXvalues=this.getDistinctValues(this.commonXvalues,e[t].xData)}return this.commonXvalues},s.prototype.commonXValue=function(e){for(var t=[],i=0;i<e.length;i++)for(var r=0;e[i].points&&r<e[i].points.length;r++){var n=e[i].points[r];n&&(n.index===0||n.index===e[i].points.length-1||n.symbolLocations&&n.symbolLocations.length>0)&&t.push(n.xValue)}return t},s.prototype.getDistinctValues=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]);var i={},r=[],n;for(n=0;n<e.length;n++){var a=e[n];i[a]||(i[a]=!0,r.push(a))}for(n=0;n<t.length;n++){var a=t[n];i[a]||(i[a]=!0,r.push(a))}return r},s}(),el=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Se=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},BG=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(!1)],e.prototype,"visible",void 0),Se([S(!0)],e.prototype,"showZero",void 0),Se([S(null)],e.prototype,"name",void 0),Se([S("transparent")],e.prototype,"fill",void 0),Se([S(null)],e.prototype,"format",void 0),Se([S(1)],e.prototype,"opacity",void 0),Se([S(0)],e.prototype,"angle",void 0),Se([S(!1)],e.prototype,"enableRotation",void 0),Se([S("Auto")],e.prototype,"position",void 0),Se([S(5)],e.prototype,"rx",void 0),Se([S(5)],e.prototype,"ry",void 0),Se([S("Center")],e.prototype,"alignment",void 0),Se([Ee({width:null,color:null},Bn)],e.prototype,"border",void 0),Se([Ee({left:5,right:5,top:5,bottom:5},Ab)],e.prototype,"margin",void 0),Se([Ee({size:"12px",color:null,fontStyle:"Normal",fontWeight:"400",fontFamily:null},cs)],e.prototype,"font",void 0),Se([S(null)],e.prototype,"template",void 0),Se([S("Hide")],e.prototype,"labelIntersectAction",void 0),e}(ke),$I=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(!1)],e.prototype,"visible",void 0),Se([S(null)],e.prototype,"shape",void 0),Se([S("")],e.prototype,"imageUrl",void 0),Se([S(5)],e.prototype,"height",void 0),Se([S(!1)],e.prototype,"isFilled",void 0),Se([S(5)],e.prototype,"width",void 0),Se([Ee({width:2,color:null},Bn)],e.prototype,"border",void 0),Se([Ee({x:0,y:0},NQ)],e.prototype,"offset",void 0),Se([S(null)],e.prototype,"fill",void 0),Se([S(!0)],e.prototype,"allowHighlight",void 0),Se([S(1)],e.prototype,"opacity",void 0),Se([Ee({},BG)],e.prototype,"dataLabel",void 0),e}(ke),HG=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(null)],e.prototype,"fill",void 0),Se([S(1)],e.prototype,"width",void 0),Se([S("0")],e.prototype,"dashArray",void 0),Se([Ee(null,$I)],e.prototype,"marker",void 0),Se([S(!0)],e.prototype,"showAxis",void 0),e}(ke),zL=function(){function s(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0,this.verticalError=null,this.verticalNegativeError=null,this.horizontalError=null,this.horizontalNegativeError=null,this.verticalPositiveError=null,this.horizontalPositiveError=null}return s}(),VG=function(s){el(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.clipRect=new Ve(0,0,0,0),t}return e.prototype.setDataSource=function(t,i){t&&(this.points=t.points),i.trendLineModule.initDataSource(this),i.visibleSeriesCount++},Se([S("")],e.prototype,"name",void 0),Se([S("")],e.prototype,"dashArray",void 0),Se([S(!0)],e.prototype,"visible",void 0),Se([S("Linear")],e.prototype,"type",void 0),Se([S(2)],e.prototype,"period",void 0),Se([S(2)],e.prototype,"polynomialOrder",void 0),Se([S(0)],e.prototype,"backwardForecast",void 0),Se([S(0)],e.prototype,"forwardForecast",void 0),Se([Ee({},WI)],e.prototype,"animation",void 0),Se([Ee({},$I)],e.prototype,"marker",void 0),Se([S(!0)],e.prototype,"enableTooltip",void 0),Se([S(null)],e.prototype,"intercept",void 0),Se([S("")],e.prototype,"fill",void 0),Se([S(1)],e.prototype,"width",void 0),Se([S("SeriesType")],e.prototype,"legendShape",void 0),e}(ke),UG=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(1)],e.prototype,"width",void 0),Se([S(10)],e.prototype,"length",void 0),Se([S(null)],e.prototype,"color",void 0),Se([S(1)],e.prototype,"opacity",void 0),e}(ke),_G=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(null)],e.prototype,"value",void 0),Se([S(null)],e.prototype,"color",void 0),Se([S("0")],e.prototype,"dashArray",void 0),e}(ke),WG=function(s){el(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Se([S(!1)],e.prototype,"visible",void 0),Se([S("Fixed")],e.prototype,"type",void 0),Se([S("Both")],e.prototype,"direction",void 0),Se([S("Vertical")],e.prototype,"mode",void 0),Se([S(null)],e.prototype,"color",void 0),Se([S(1)],e.prototype,"verticalError",void 0),Se([S(1)],e.prototype,"width",void 0),Se([S(1)],e.prototype,"horizontalError",void 0),Se([S(3)],e.prototype,"verticalPositiveError",void 0),Se([S(3)],e.prototype,"verticalNegativeError",void 0),Se([S(1)],e.prototype,"horizontalPositiveError",void 0),Se([S(1)],e.prototype,"horizontalNegativeError",void 0),Se([Ee(null,UG)],e.prototype,"errorBarCap",void 0),Se([S("")],e.prototype,"errorBarColorMapping",void 0),e}(ke),j2=function(s){el(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.rangeColorPoints=[],t.isAdvancedColor=void 0,t.currentViewData=[],t.clipRect=new Ve(0,0,0,0),t.seriesType="XY",t.isRectTypeSeries=!1,t}return e.prototype.processJsonData=function(){var t=0,i=new zL,r=this instanceof Lr&&this.type==="Histogram"?"x":this.xName,n=this instanceof Lr&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof Lr&&((this.type==="Waterfall"||this.type==="Histogram")&&(this.currentViewData=this.chart[ao(this.type)+"SeriesModule"].processInternalData(me([],this.currentViewData,null,!0),this)),this.category==="Pareto"&&(this.currentViewData=M2(me([],this.currentViewData,null,!0),[this.yName],!0),this.type==="Line"&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);var a=(this.currentViewData||[]).length;if(this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),this.xAxis.valueType==="Category")for(;t<a;)i=this.dataPoint(t,n,r),this.pushCategoryData(i,t,i.x),this.pushData(i,t),this.setEmptyPoint(i,t),this.rangeColorsInterior(i),t++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var o={skeleton:"full",type:"dateTime"},l=this.chart.intl.getDateParser(o),h=this.chart.intl.getDateFormat(o);t<a;)i=this.dataPoint(t,n,r),!m(i.x)&&i.x!==""?(i.x=new Date(ce.parse.parseJson({val:i.x}).val),this.xAxis.valueType==="DateTime"?i.xValue=Date.parse(i.x.toString()):this.chart.isBlazor?this.pushCategoryData(i,t,Date.parse(i.x.toString()).toString()):this.pushCategoryData(i,t,Date.parse(l(h(i.x))).toString()),this.pushData(i,t),this.setEmptyPoint(i,t)):i.visible=!1,t++;else for(;t<a;)i=this.dataPoint(t,n,r),i.xValue=i.x,this.pushData(i,t),this.setEmptyPoint(i,t),t++;if(this instanceof Lr&&!(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory")){if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&this.chart.chartAreaType==="PolarRadar"){var u=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,c=this.type.indexOf("Range")>-1;this.chart["spline"+(u?c?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this);this.type.indexOf("Histogram")>-1&&this.points.length===1&&(this.xMin=this.xMin-this.histogramValues.binWidth,this.xMax=this.xMax+this.histogramValues.binWidth)}},e.prototype.rangeColorsInterior=function(t){this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")&&(this.rangeColorPoints[t.interior]?this.rangeColorPoints[t.interior]!==void 0&&this.rangeColorPoints[t.interior].push(t):this.rangeColorPoints[t.interior]=[])},e.prototype.pushData=function(t,i){t.index=i,t.yValue=t.y,t.series=this,this.xMin=Math.min(this.xMin,t.xValue),this.xMax=Math.max(this.xMax,t.xValue),this.xData.push(t.xValue)},e.prototype.dataPoint=function(t,i,r){this.points[t]=new zL;var n=this.points[t],a=this.currentViewData[t],o=this.enableComplexProperty?ie:this.getObjectValue;return n.x=o(r,a),n.high=o(this.high,a),n.low=o(this.low,a),n.open=o(this.open,a),n.close=o(this.close,a),n.volume=o(this.volume,a),n.interior=o(this.pointColorMapping,a),this instanceof Lr&&(this.errorBar.visible&&(n.errorBarColor=o(this.errorBar.errorBarColorMapping,a),n.verticalError=typeof this.errorBar.verticalError=="string"?o(this.errorBar.verticalError,a):this.errorBar.verticalError,n.horizontalError=typeof this.errorBar.horizontalError=="string"?o(this.errorBar.horizontalError,a):this.errorBar.horizontalError,n.verticalNegativeError=typeof this.errorBar.verticalNegativeError=="string"?o(this.errorBar.verticalNegativeError,a):this.errorBar.verticalNegativeError,n.verticalPositiveError=typeof this.errorBar.verticalPositiveError=="string"?o(this.errorBar.verticalPositiveError,a):this.errorBar.verticalPositiveError,n.horizontalNegativeError=typeof this.errorBar.horizontalNegativeError=="string"?o(this.errorBar.horizontalNegativeError,a):this.errorBar.horizontalNegativeError,n.horizontalPositiveError=typeof this.errorBar.horizontalPositiveError=="string"?o(this.errorBar.horizontalPositiveError,a):this.errorBar.horizontalPositiveError),n.y=o(this.yName,a),n.size=o(this.size,a),n.text=o(i,a),n.tooltip=o(this.tooltipMappingName,a),this.isAdvancedColorSupported()&&(this.rangeColorName=this.colorName.length>0?this.colorName:this.yName,n.colorValue=o(this.rangeColorName,a),n.interior=this.getPointFillColor(n.interior,n.colorValue))),n},e.prototype.isAdvancedColorSupported=function(){return m(this.isAdvancedColor)&&(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")?this.isAdvancedColor=!0:this.isAdvancedColor=!1),this.isAdvancedColor},e.prototype.getPointFillColor=function(t,i){var r=t;if(i&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(var n=0,a=this.chart.rangeColorSettings;n<a.length;n++){var o=a[n];i>=o.start&&i<=o.end&&(o.colors.length>1?r=FG(o,i):r=o.colors[0])}return r},e.prototype.getObjectValue=function(t,i){return i[t]},e.prototype.setEmptyPoint=function(t,i){if(!this.findVisibility(t))return t.visible=!0,null;t.isEmpty=!0;var r=this instanceof Lr&&t.isPointInRange?this.emptyPointSettings.mode:"Drop";switch(r){case"Zero":t.visible=!0,this instanceof Lr&&this.seriesType.indexOf("HighLow")>-1?(t.high=t.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(t.open=t.close=0)):t.y=t.yValue=this.yData[i]=0;break;case"Average":this instanceof Lr&&(this.seriesType.indexOf("HighLow")>-1?(t.high=m(t.high)||isNaN(+t.high)?this.getAverage(this.high,i):t.high,t.low=m(t.low)||isNaN(+t.low)?this.getAverage(this.low,i):t.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(t.open=m(t.open)||isNaN(+t.open)?this.getAverage(this.open,i):t.open,t.close=m(t.close)||isNaN(+t.close)?this.getAverage(this.close,i):t.close)):t.y=t.yValue=this.yData[i]=this.getAverage(this.yName,i)),t.visible=!0;break;case"Drop":case"Gap":this.yData[i]=null,t.visible=!1;break}},e.prototype.findVisibility=function(t){var i=this instanceof Lr?this.seriesType:"HighLowOpenClose",r,n=this.yAxis.minimum,a=this.yAxis.maximum;switch(i){case"XY":return this.chart.chartAreaType==="PolarRadar"&&(!m(n)&&t.yValue<n||!m(a)&&t.yValue>a)?(t.isPointInRange=!1,!0):(this.setXYMinMax(t.yValue),this.yData.push(t.yValue),this instanceof Lr&&this.type==="Bubble"&&(this.sizeMax=Math.max(this.sizeMax,m(t.size)||isNaN(+t.size)?this.sizeMax:t.size)),m(t.x)||m(t.y)||isNaN(+t.y));case"HighLow":return this.setHiloMinMax(t.high,t.low),m(t.x)||m(t.low)||isNaN(+t.low)||m(t.high)||isNaN(+t.high);case"HighLowOpenClose":return this.setHiloMinMax(t.high,t.low),m(t.x)||m(t.low)||isNaN(+t.low)||m(t.open)||isNaN(+t.open)||m(t.close)||isNaN(+t.close)||m(t.high)||isNaN(+t.high);case"BoxPlot":return r=(t.y||[null]).filter(function(o){return!m(o)&&!isNaN(o)}).sort(function(o,l){return o-l}),t.y=r,this.yMin=Math.min(this.yMin,Math.min.apply(Math,r)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,r)),!r.length}},e.prototype.setXYMinMax=function(t){var i=this.yAxis.valueType==="Logarithmic"||this.xAxis.valueType==="Logarithmic",r=t<0||this.yAxis.rangePadding==="None",n;this.isRectTypeSeries&&!qM(this.yAxis)?n=i||r?t:0:n=t,this.yMin=i?Math.min(this.yMin,m(n)||isNaN(n)||n===0||n.toString()==="0"||n.toString()===""?this.yMin:n):Math.min(this.yMin,m(n)||isNaN(n)?this.yMin:n),this.yMax=Math.max(this.yMax,m(t)||isNaN(t)?this.yMax:t)},e.prototype.setHiloMinMax=function(t,i){this.yMin=Math.min(this.yMin,Math.min(m(i)||isNaN(i)?this.yMin:i,m(t)||isNaN(t)?this.yMin:t)),this.yMax=Math.max(this.yMax,Math.max(m(i)||isNaN(i)?this.yMax:i,m(t)||isNaN(t)?this.yMax:t))},e.prototype.getSeriesType=function(){var t;if(this instanceof Lr){var i=this.chart.chartAreaType==="PolarRadar"?this.drawType:this.type;if(i)switch(i){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":t="HighLow";break;case"HiloOpenClose":case"Candle":t="HighLowOpenClose";break;case"BoxAndWhisker":t="BoxPlot";break;default:t="XY"}}this.seriesType=t},e.prototype.pushCategoryData=function(t,i,r){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[i]?this.xAxis.labels[i]+=", "+r:this.xAxis.labels.push(r),t.xValue=i):(this.xAxis.indexLabels[r]===void 0&&(this.xAxis.indexLabels[r]=this.xAxis.labels.length,this.xAxis.labels.push(r)),t.xValue=this.xAxis.indexLabels[r])},e.prototype.getAverage=function(t,i,r){r===void 0&&(r=this.currentViewData);var n=r[i-1]&&r[i-1][t]||0,a=r[i+1]&&r[i+1][t]||0;return(n+a)/2},e.prototype.refreshDataManager=function(t){var i=this;this.chart=t;var r,n="isAngular";if(t[n]?r=Object.keys(this.dataSource).length?this.dataSource:t.dataSource:r=this.dataSource||t.dataSource,!(r instanceof ge)&&m(this.query)){this.dataManagerSuccess({result:r,count:r.length},!1);return}var a=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());a.then(function(o){return i.dataManagerSuccess(o)})},e.prototype.dataManagerSuccess=function(t,i){if(i===void 0&&(i=!0),this.currentViewData=t.count?t.result:[],this.chart.allowServerDataBinding=!1,this instanceof Lr){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var r={name:z0,series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger(z0,r),this.interior=r.fill,this.currentViewData=r.data}this.chart.stockChart&&!(this instanceof Lr)&&(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=t.count,this.refreshChart(i),this.currentViewData=null},e.prototype.refreshChart=function(t){var i=this.chart;if(this instanceof Lr&&(i.visibleSeriesCount+=t?1:0),i.refreshTechnicalIndicator(this),this instanceof Lr&&this.category!=="TrendLine")for(var r=0,n=this.trendlines;r<n.length;r++){var a=n[r];a.setDataSource(this,i)}i.visibleSeries.length===i.visibleSeriesCount&&(i.refreshBound(),i.trigger("loaded",{chart:i.isBlazor?{}:i}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof Lr&&(i.visibleSeriesCount+=t?0:1)},Se([S("")],e.prototype,"xName",void 0),Se([S("")],e.prototype,"colorName",void 0),Se([S("")],e.prototype,"high",void 0),Se([S("")],e.prototype,"low",void 0),Se([S("")],e.prototype,"open",void 0),Se([S("")],e.prototype,"close",void 0),Se([S("")],e.prototype,"volume",void 0),Se([S("")],e.prototype,"pointColorMapping",void 0),Se([S(!0)],e.prototype,"visible",void 0),Se([S(null)],e.prototype,"xAxisName",void 0),Se([S(null)],e.prototype,"yAxisName",void 0),Se([Ee(null,WI)],e.prototype,"animation",void 0),Se([S(null)],e.prototype,"fill",void 0),Se([S(1)],e.prototype,"width",void 0),Se([S("")],e.prototype,"dashArray",void 0),Se([S("")],e.prototype,"dataSource",void 0),Se([S()],e.prototype,"query",void 0),Se([ii([],_G)],e.prototype,"segments",void 0),Se([S("X")],e.prototype,"segmentAxis",void 0),Se([S(!1)],e.prototype,"enableComplexProperty",void 0),e}(ke),Lr=function(s){el(e,s);function e(t,i,r,n){var a=s.call(this,t,i,r,n)||this;return a.visibleSeriesCount=0,a.category="Series",a.isRectSeries=!1,a.drawPoints=[],a.lowDrawPoints=[],a.delayedAnimation=!1,a.rangeColorName=a.colorName.length>0?a.colorName:a.yName,a}return e.prototype.refreshAxisLabel=function(){if(this.xAxis.valueType!=="Category")return null;this.xAxis.labels=[],this.xAxis.indexLabels={};for(var t=0,i=this.xAxis.series;t<i.length;t++){var r=i[t];if(r.visible&&r.category!=="TrendLine"){r.xMin=1/0,r.xMax=-1/0;for(var n=0,a=r.points;n<a.length;n++){var o=a[n];r.pushCategoryData(o,o.index,o.x),r.xMin=Math.min(r.xMin,o.xValue),r.xMax=Math.max(r.xMax,o.xValue)}}}},e.prototype.findSeriesCollection=function(t,i,r){for(var n=[],a=0,o=i.axes;a<o.length;a++)for(var l=o[a],h=0,u=l.series;h<u.length;h++)for(var c=u[h],d=0,p=t.axes;d<p.length;d++)for(var f=p[d],v=0,g=f.series;v<g.length;v++){var b=g[v];b===c&&b.visible&&this.rectSeriesInChart(b,r)&&n.push(b)}return n},e.prototype.rectSeriesInChart=function(t,i){var r=t.type.toLowerCase();return r.indexOf("column")!==-1||r.indexOf("bar")!==-1||r.indexOf("histogram")!==-1||r.indexOf("hiloopenclose")!==-1||r.indexOf("candle")!==-1||r.indexOf("pareto")!==-1||r.indexOf("hilo")!==-1||t.drawType.indexOf("Column")!==-1||r.indexOf("waterfall")!==-1||r.indexOf("boxandwhisker")!==-1||i},e.prototype.calculateStackedValue=function(t,i){for(var r=0,n=i.columns;r<n.length;r++)for(var a=n[r],o=0,l=i.rows;o<l.length;o++){var h=l[o];this.calculateStackingValues(this.findSeriesCollection(a,h,!0),t)}},e.prototype.calculateStackingValues=function(t,i){var r,n,a=[],o=[],l=[],h,u,c,d=[];i&&(d=this.findFrequencies(t));for(var p=[],f=[],v=0;v<t.length;v++){var g=t[v];p[g.stackingGroup]?p[g.stackingGroup]!==void 0&&p[g.stackingGroup].push(g):(p[g.stackingGroup]=[],p[g.stackingGroup].push(g))}for(var b=Object.keys(p),y=0;y<b.length;y++){for(var C=[],x=[],w=p[b[y]],M=0,E=w;M<E.length;M++){var g=E[M];if(g.type.indexOf("Stacking")!==-1||g.drawType.indexOf("Stacking")!==-1&&g.chart.chartAreaType==="PolarRadar"){h=g.type.indexOf("StackingArea")!==-1?"StackingArea100":g.type.indexOf("StackingLine")!==-1?"StackingLine100":g.stackingGroup,o[h]||(o[h]=[],l[h]=[]),a=g.yData,r=[],n=[],C.push(g),f=jh(g);for(var T=0,D=f.length;T<D;T++)u=0,c=+a[T],o[h][f[T].xValue]===void 0&&(o[h][f[T].xValue]=0),l[h][f[T].xValue]===void 0&&(l[h][f[T].xValue]=0),i?(c=c/d[h][f[T].xValue]*100,c=isNaN(c)?0:c,f[T].percentage=+c.toFixed(2)):x[T]=x[T]?x[T]+Math.abs(c):Math.abs(c),c>=0?(u=o[h][f[T].xValue],o[h][f[T].xValue]+=c):(u=l[h][f[T].xValue],l[h][f[T].xValue]+=c),r.push(u),n.push(c+u),i&&n[T]>100&&(n[T]=100);g.stackedValues=new RG(r,n);var N=g.yAxis.valueType==="Logarithmic",A=g.type.indexOf("Column")!==-1||g.type.indexOf("Bar")!==-1;g.yMin=N&&A&&g.yMin<1?g.yMin:g.yAxis.startFromZero&&g.yAxis.rangePadding==="Auto"&&g.yMin>=0?0:parseFloat(Math.min.apply(0,i?r:n).toFixed(10)),g.yMax=Math.max.apply(0,n),g.yMin>Math.min.apply(0,n)&&(g.yMin=i?-100:N&&A&&g.yMin<1?g.yMin:Math.min.apply(0,n)),g.yMax<Math.max.apply(0,r)&&(g.yMax=0)}}this.findPercentageOfStacking(C,x,i)}},e.prototype.findPercentageOfStacking=function(t,i,r){for(var n=0,a=t;n<a.length;n++){var o=a[n];if(r)return null;for(var l=0,h=jh(o);l<h.length;l++){var u=h[l];u.percentage=Math.abs(+(u.y/i[u.index]*100).toFixed(2))}}},e.prototype.findFrequencies=function(t){for(var i=[],r,n=[],a=0,o=t;a<o.length;a++){var l=o[a];if(l.yAxis.isStack100=l.type.indexOf("100")!==-1,n=jh(l),l.type.indexOf("Stacking")!==-1){r=l.type.indexOf("StackingArea")!==-1?"StackingArea100":l.type.indexOf("StackingLine")!==-1?"StackingLine100":l.stackingGroup,i[r]||(i[r]=[]);for(var h=0,u=n.length;h<u;h++)i[r][n[h].xValue]===void 0&&(i[r][n[h].xValue]=0),l.yData[h]>0?i[r][n[h].xValue]+=l.yData[h]:i[r][n[h].xValue]-=l.yData[h]}}return i},e.prototype.renderSeries=function(t){if(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory"){for(var i=0;i<this.points.length;i++){var r=this.xAxis.labels.indexOf(Date.parse(this.points[i].x.toString()).toString());this.points[i].xValue=r,t.series.length>1&&(this.xData[i]=r,this.xMin=this.xMin>r?r:this.xMin,this.xMax=this.xMax<r?r:this.xMax)}if(this instanceof e&&this.type.indexOf("Spline")>-1){var n=this.type.indexOf("Area")>-1,a=this.type.indexOf("Range")>-1;this.chart["spline"+(n?a?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}}var o=ao(this.type);o=o.replace("100",""),t[o+"SeriesModule"]&&(this.category!=="Indicator"&&this.category!=="TrendLine"&&this.createSeriesElements(t),this.visiblePoints=jh(this),t[o+"SeriesModule"].render(this,this.xAxis,this.yAxis,t.requireInvertedAxis),this.category!=="Indicator"&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&t.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.appendSeriesElement(t.seriesElements,t)),this.chart.enableCanvas||this.performAnimation(t,o,this.errorBar,this.marker,this.marker.dataLabel))},e.prototype.createSeriesElements=function(t){if(this.category!=="Indicator"){var i=t.element.id,r=this.marker.border.width+8+5,n=this.type==="Bubble"||!this.marker.visible&&t.tooltip.shared&&t.enableCanvas?t.svgRenderer:t.renderer,a=this.index===void 0?this.category:this.index,o=void 0,l=void 0,h=void 0;if(this.type==="Scatter"||this.drawType==="Scatter"?(o=(this.marker.height+r)/2,l=(this.marker.width+r)/2):(o=0,l=0),t.chartAreaType==="PolarRadar"){var u=this.drawType==="Scatter"?Math.max(this.marker.width,this.marker.height):0;h=new QI(i+"_ChartSeriesClipRect_"+a,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,t.radius+u),this.clipRectElement=Cu(t.redraw,h,n,"drawCircularClipPath")}else h=new aa(i+"_ChartSeriesClipRect_"+a,"transparent",{width:1,color:"Gray"},1,{x:this.xAxis.columnIndex===0?-l:0,y:this.yAxis.rowIndex===t.rows.length-1?-o:0,width:this.clipRect.width+(this.xAxis.columnIndex===t.columns.length-1?l*2:l),height:this.clipRect.height+(this.yAxis.rowIndex===0?o*2:o)}),this.clipRectElement=Cu(t.redraw,h,n);var c=t.chartAreaType==="Cartesian"?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=n.createGroup({id:i+"SeriesGroup"+a,transform:c,"clip-path":"url(#"+i+"_ChartSeriesClipRect_"+a+")"}),this.seriesElement&&(this.seriesElement.setAttribute("role","region"),this.seriesElement.setAttribute("aria-label",this.name+","+this.type+" series with "+this.points.length+" data points"),this.seriesElement.setAttribute("aria-hidden","false")),(!this.chart.enableCanvas||this.type==="Bubble")&&(this.seriesElement.setAttribute("tabindex",a===0?"0":this.checkTabindex(t.visibleSeries,a)?"":"0"),this.seriesElement.setAttribute("style","outline: none"),this.seriesElement.appendChild(this.clipRectElement))}},e.prototype.checkTabindex=function(t,i){for(var r=0;r<i;r++)if(t[r].visible)return!0;return!1},e.prototype.appendSeriesElement=function(t,i){var r=this.marker,n=r.dataLabel,a=i.redraw;if(this.category!=="TrendLine"){Mt(i.enableCanvas,i.seriesElements,this.seriesElement,a);var o=this.errorBar;o.visible&&(i.chartAreaType==="PolarRadar"?Mt(i.enableCanvas,i.seriesElements,this.seriesElement,a):Mt(i.enableCanvas,i.seriesElements,this.errorBarElement,a))}r.visible&&(i.chartAreaType==="Cartesian"||this.drawType!=="Scatter"&&i.chartAreaType==="PolarRadar")&&this.type!=="Scatter"&&this.type!=="Bubble"&&this.type!=="Candle"&&this.type!=="Hilo"&&this.type!=="HiloOpenClose"&&this.symbolElement&&Mt(i.enableCanvas,i.seriesElements,this.symbolElement,a),n.visible&&this.textElement&&(Mt(i.enableCanvas,i.dataLabelElements,this.shapeElement,a),Mt(i.enableCanvas,i.dataLabelElements,this.textElement,a)),!i.enableCanvas&&i.dataLabelElements.hasChildNodes()&&i.seriesElements.appendChild(i.dataLabelElements)},e.prototype.performAnimation=function(t,i,r,n,a){(this.animation.enable&&vi!="Disable"||vi==="Enable")&&t.animateSeries&&(!t.stockChart||!t.stockChart.isStockChartRendered)&&(t[i+"SeriesModule"].doAnimation(this),r.visible&&t.errorBarModule.doErrorBarAnimation(this),n.visible&&t.markerRender.doMarkerAnimation(this),a.visible&&B.info.name!=="edge"&&!B.isIE&&t.dataLabelModule.doDataLabelAnimation(this))},e.prototype.setPointColor=function(t,i){return i=t.interior||i,t.isEmpty&&this.emptyPointSettings.fill||i},e.prototype.setBorderColor=function(t,i){return i.width=t.isEmpty&&this.emptyPointSettings.border.width||i.width,i.color=t.isEmpty&&this.emptyPointSettings.border.color||i.color,i},Se([S("")],e.prototype,"name",void 0),Se([S("")],e.prototype,"yName",void 0),Se([S("Line")],e.prototype,"drawType",void 0),Se([S(!0)],e.prototype,"isClosed",void 0),Se([S(null)],e.prototype,"bearFillColor",void 0),Se([S(null)],e.prototype,"bullFillColor",void 0),Se([S(!1)],e.prototype,"enableSolidCandles",void 0),Se([S("")],e.prototype,"size",void 0),Se([S(null)],e.prototype,"binInterval",void 0),Se([S(!1)],e.prototype,"showNormalDistribution",void 0),Se([S("")],e.prototype,"stackingGroup",void 0),Se([Ee({color:null,width:0},Bn)],e.prototype,"border",void 0),Se([S(1)],e.prototype,"opacity",void 0),Se([S(0)],e.prototype,"zOrder",void 0),Se([S("")],e.prototype,"groupName",void 0),Se([S("Line")],e.prototype,"type",void 0),Se([Ee(null,WG)],e.prototype,"errorBar",void 0),Se([Ee(null,$I)],e.prototype,"marker",void 0),Se([Ee(null,HG)],e.prototype,"paretoOptions",void 0),Se([Ee({},FQ)],e.prototype,"dragSettings",void 0),Se([ii([],VG)],e.prototype,"trendlines",void 0),Se([S(!0)],e.prototype,"enableTooltip",void 0),Se([S("")],e.prototype,"tooltipFormat",void 0),Se([S("")],e.prototype,"tooltipMappingName",void 0),Se([S("SeriesType")],e.prototype,"legendShape",void 0),Se([S("")],e.prototype,"legendImageUrl",void 0),Se([S(null)],e.prototype,"selectionStyle",void 0),Se([S(null)],e.prototype,"unSelectedStyle",void 0),Se([S(null)],e.prototype,"nonHighlightStyle",void 0),Se([S(1)],e.prototype,"minRadius",void 0),Se([S(3)],e.prototype,"maxRadius",void 0),Se([S("Natural")],e.prototype,"splineType",void 0),Se([S(.5)],e.prototype,"cardinalSplineTension",void 0),Se([Ee(null,o2)],e.prototype,"emptyPointSettings",void 0),Se([S(!0)],e.prototype,"showMean",void 0),Se([S("Normal")],e.prototype,"boxPlotMode",void 0),Se([S(null)],e.prototype,"columnWidth",void 0),Se([S(null)],e.prototype,"columnWidthInPixel",void 0),Se([S("Rectangle")],e.prototype,"columnFacet",void 0),Se([S(0)],e.prototype,"columnSpacing",void 0),Se([S("#C64E4A")],e.prototype,"negativeFillColor",void 0),Se([S("#4E81BC")],e.prototype,"summaryFillColor",void 0),Se([S()],e.prototype,"intermediateSumIndexes",void 0),Se([S()],e.prototype,"sumIndexes",void 0),Se([S("Left")],e.prototype,"step",void 0),Se([Ee({color:"black",width:2},Nc)],e.prototype,"connector",void 0),Se([Ee(null,OQ)],e.prototype,"cornerRadius",void 0),e}(j2),B2=function(){function s(e,t){this.initDataManager(e,t)}return s.prototype.initDataManager=function(e,t){this.dataManager=e instanceof ge?e:new ge(e),this.query=t instanceof $e?t:new $e},s.prototype.generateQuery=function(){var e=this.query.clone();return e},s.prototype.getData=function(e){var t=this;if(this.dataManager.ready){var i=new xa,r=this.dataManager.ready;return r.then(function(){t.dataManager.executeQuery(e).then(function(n){i.resolve(n)})}).catch(function(n){i.reject(n)}),i.promise}else return this.dataManager.executeQuery(e)},s}(),qG=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),YG=function(s){qG(e,s);function e(t){var i=s.call(this,t)||this;return i.elementId=t.element.id,i.commonXvalues=[],i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(B.touchEndEvent,this.mouseUpHandler,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMoveHandler),this.chart.off(B.touchEndEvent,this.mouseUpHandler))},e.prototype.mouseUpHandler=function(){var t=this.chart;t.isTouch&&!t.crosshair.enable&&!this.isSelected(t)&&this.markerMove(!0)},e.prototype.mouseMoveHandler=function(){var t=this.chart;(t.highlightMode!=="None"||t.tooltip.enable)&&(!t.isTouch||t.startMove)&&!this.isSelected(t)&&this.markerMove(!1)},e.prototype.markerMove=function(t){var i=this,r=this.chart;this.currentPoints=[];var n,a,o,l;if(!r.tooltip.shared||!r.tooltip.enable)n=this.getData(),l=n.series,a=this.previousPoints[0],o=l&&(l.type==="Bubble"||l.drawType==="Scatter"||l.type==="Scatter"||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose"&&l.marker.visible&&l.marker.width!==0&&l.marker.height!==0),n.lierIndex=this.lierIndex,n.point&&o&&(!a||a.point!==n.point||a&&a.lierIndex>3&&a.lierIndex!==this.lierIndex)&&this.currentPoints.push(n),n.point&&o&&r.isPointMouseDown&&this.currentPoints.push(n);else{if(!Mn(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))return null;if(r.tooltip.enable){var h=r.chartAreaType==="PolarRadar"?this.getData():null;if(!this.chart.tooltip.showNearestPoint)this.currentPoints=this.chart.tooltipModule.currentPoints;else for(var u=0,c=r.visibleSeries;u<c.length;u++){var d=c[u];!d.enableTooltip||d.category==="Indicator"||(r.chartAreaType==="Cartesian"&&d.visible?n=this.getClosestX(r,d,this.commonXValue(this.chart.visibleSeries)):r.chartAreaType==="PolarRadar"&&d.visible&&h.point!==null&&(n=new rf(d.points[h.point.index],d)),n&&(this.currentPoints.push(n),n=null))}}}var p=this.previousPoints.length;if((this.currentPoints.length>0||p>0&&r.tooltip.shared)&&(p===0||r.isPointMouseDown||p>0&&(this.currentPoints.length==0||this.previousPoints[0].point!==this.currentPoints[0].point))){if(p>0)for(var f=0,v=this.previousPoints;f<v.length;f++){var g=v[f];m(g)||this.removeHighlightedMarker(g.series,g.point)}for(var b=function(M){(M&&M.point||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose")&&(L2(y.markerExplode),y.isRemove=!0,M.point.symbolLocations.map(function(E,T){M.series.marker.allowHighlight&&(!M.series.isRectSeries||M.point.marker.visible)&&i.drawTrackBall(M.series,M.point,E,T)}))},y=this,C=0,x=this.currentPoints;C<x.length;C++){var w=x[C];b(w)}this.previousPoints=me([],this.currentPoints,null,!0)}!r.tooltip.enable&&(this.currentPoints.length===0&&this.isRemove||t&&this.isRemove||!Mn(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))&&(this.isRemove=!1,m(this.previousPoints[0])||(this.markerExplode=+setTimeout(function(){i.previousPoints[0]&&i.removeHighlightedMarker(i.previousPoints[0].series,i.previousPoints[0].point)},2e3))),this.currentPoints=[]},e.prototype.animationDuration=function(){var t=200;return this.chart.maxPointCount>100?t=10:this.chart.maxPointCount>50&&(t=100),t},e.prototype.drawTrackBall=function(t,i,r,n){var a=i.marker,o=t.marker,l=a.shape||o.shape||"Circle",h;if(l==="None"||l==="Image")return null;var u=t.symbolElement||t.seriesElement,c;this.chart.highlightModule&&this.chart.highlightMode!=="None"&&(c=this.chart.highlightModule.generateStyle(t)),this.chart.selectionModule&&this.chart.selectionMode!=="None"&&(c=this.chart.selectionModule.generateStyle(t));var d=this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Trackball"+(n||""),p=new ei((a.width||o.width)+3,(a.height||o.height)+3),f=a.border||t.border,v=t.type==="BoxAndWhisker"||t.type==="Bubble"||t.type==="Scatter",g=f.color&&f.color!=="transparent"?f.color:a.fill||i.interior||(v?i.color:t.interior),b=dv(qn(g)),y=a.border?a.border.width:o.border.width,C=t.chart.themeStyle.markerShadow||"rgba("+b.r+","+b.g+","+b.b+",0.2)",x=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Symbol");if(m(x)||x.setAttribute("visibility","hidden"),this.chart.enableCanvas){var w=document.getElementById(this.chart.element.id+"_Secondary_Element");h=this.chart.svgRenderer.createSvg({id:this.chart.element.id+"_trackball_svg",width:this.chart.availableSize.width,height:this.chart.availableSize.height}),h.style.cssText="position: absolute; pointer-events: none",w.appendChild(h)}for(var M=0;M<2;M++){var E=new Er(d+"_"+M,M?a.fill||i.color||(v?t.interior:"#ffffff"):"transparent",y+(M?0:8),M?g:C,a.opacity||o.opacity,null,null),T=gs(r,l,p,a.imageUrl,E,"",this.chart.svgRenderer,t.clipRect);T.setAttribute("class",this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index);var D=u.id.indexOf("Symbol")!==-1?"_Symbol":"",N=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+D);c!==""&&!m(c)&&!m(N)&&N.hasAttribute("class")&&c===N.getAttribute("class")&&T.classList.add(c),T.setAttribute("clip-path",u.getAttribute("clip-path")),T.setAttribute("transform",u.getAttribute("transform")),this.chart.enableCanvas?h.appendChild(T):this.chart.svgObject.appendChild(T)}this.doAnimation(t,i,!1)},e.prototype.doAnimation=function(t,i,r){r===void 0&&(r=!1);for(var n=this.animationDuration(),a=t.animation.delay,o=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index),l=0,h=o.length;l<h;l++)this.trackballAnimate(o[l],a,n,t,i.index,i.symbolLocations[0],!1,r)},e.prototype.trackballAnimate=function(t,i,r,n,a,o,l,h){var u=o.x,c=o.y,d=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.x:0,p=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.y:0,f=t.getAttribute("transform");new ri({}).animate(t,{duration:r,delay:i,progress:function(v){v.timeStamp>v.delay&&(v.element.style.visibility="visible",(v.timeStamp-v.delay)/v.duration,t.setAttribute("transform","translate("+(u+d)+" "+(c+p)+") scale(1) translate("+-u+" "+-c+")"))},end:function(){t.style.visibility="",t.setAttribute("transform",f),!l&&a===n.points.length-1&&n.chart.trigger("animationComplete",{series:n.chart.isBlazor?{}:n}),h&&pt(t)}})},e.prototype.removeHighlightedMarker=function(t,i,r){if(t===void 0&&(t=null),i===void 0&&(i=null),r===void 0&&(r=!1),!m(t)&&!m(i)){for(var n=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Symbol"),a=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index),o=0,l=a.length;o<l;o++)pt(a[0]);m(n)||n.setAttribute("visibility","visible")}else for(var h=0,u=t.points;h<u.length;h++)for(var c=u[h],d=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+c.index),n=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+c.index+"_Symbol"),o=0,l=d.length;o<l;o++)m(n)||n.setAttribute("visibility","visible"),pt(d[0]);r&&(this.previousPoints=[])},e}(GI),QG=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),H2=["Circle","Triangle","Diamond","Rectangle","Pentagon","InvertedTriangle","VerticalLine","Cross","Plus","HorizontalLine"],GG=function(s){QG(e,s);function e(t){var i=s.call(this,t)||this;return i.addEventListener(),i}return e.prototype.render=function(t){var i=this,r=t.chart.redraw;this.createElement(t,r);for(var n=function(h){h.visible&&h.symbolLocations&&h.symbolLocations.length&&h.symbolLocations.map(function(u,c){t.marker.shape!=="None"&&i.renderMarker(t,h,u,c,r)})},a=0,o=t.points;a<o.length;a++){var l=o[a];n(l)}},e.prototype.renderMarker=function(t,i,r,n,a){var o=t.index===void 0?t.category:t.index,l=t.marker;t.marker.shape=t.marker.shape?t.marker.shape:H2[o%10];var h={color:l.border.color,width:l.border.width},u=l.border.color,c,d,p,f;r.x=r.x+l.offset.x,r.y=r.y-l.offset.y;var v=t.type==="BoxAndWhisker",g=l.fill||(v||t.marker.isFilled?i.interior||t.interior:"#ffffff"),b,y=v?EG(t.seriesElement.childNodes,"Series_"+t.index+"_Point_"+i.index):t.symbolElement;h.color=u||t.setPointColor(i,t.interior);var C=this.elementId+"_Series_"+o+"_Point_"+i.index+"_Symbol"+(n||""),x={cancel:!1,name:uh,series:t,point:i,fill:i.isEmpty&&t.emptyPointSettings.fill||g,border:{color:t.type==="BoxAndWhisker"?!m(u)&&u!=="transparent"?u:AG(g,-.6):h.color,width:h.width},height:l.height,width:l.width,shape:l.shape};if(x.border=t.setBorderColor(i,{width:x.border.width,color:x.border.color}),(!t.isRectSeries||t.type==="BoxAndWhisker")&&(this.chart.trigger(uh,x),i.color=x.fill),i.color=x.fill,x.cancel)r=null,i.marker={visible:!1};else{var w=void 0;t.type==="RangeArea"||t.type==="RangeColumn"||t.drawType==="RangeColumn"||t.type==="SplineRangeArea"||t.type==="RangeStepArea"?w=n?i.low:i.high:v?w=i.outliers[n]:w=i.y;var M=x.point.marker.fill||x.fill,E=void 0;m(x.point.marker.border)?E={color:x.border.color,width:x.border.width}:E={color:x.point.marker.border.color||x.border.color,width:x.point.marker.border.width||x.border.width};var T=x.point.marker.width||x.width,D=x.point.marker.height||x.height,N=x.point.marker.opacity||l.opacity,A=x.point.marker.shape||x.shape,L=x.point.marker.imageUrl||l.imageUrl;f=new Er(C,M,E.width,E.color,N,null),(y!=null||this.chart.enableCanvas)&&(a&&Qe(f.id)&&(b=Qe(f.id),p=A==="Circle"?"c":"",c={x:+b.getAttribute(p+"x"),y:+b.getAttribute(p+"y")},d=b.getAttribute("d")),b=gs(r,A,new ei(T,D),L,f,i.x.toString()+":"+w.toString(),this.chart.renderer,t.clipRect),b&&(b.setAttribute("role","img"),b.setAttribute("aria-label",i.x+": "+i.y+", "+t.name)),Mt(this.chart.enableCanvas,y,b,a,!0,p+"x",p+"y",c,d,!1,!1,null,t.chart.duration)),i.marker={border:E,fill:M,height:D,visible:!0,shape:A,width:T,imageUrl:L}}},e.prototype.createElement=function(t,i){var r,n=t.marker,a=n.border.width+8+5,o=t.chart.svgRenderer,l=t.index===void 0?t.category:t.index,h,u=t.chart.chartAreaType==="Cartesian"?"translate("+t.clipRect.x+","+t.clipRect.y+")":"";if(n.visible){var c=(n.height+a)/2,d=(n.width+a)/2;if(t.chart.chartAreaType==="Cartesian"){var p=t.xAxis.zoomFactor<1||t.xAxis.zoomPosition>0;h=new aa(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,{x:p?0:-d,y:-c,width:t.clipRect.width+(p?0:d*2),height:t.clipRect.height+c*2}),r=Cu(i,h,o)}else h=new QI(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,t.clipRect.width/2+t.clipRect.x,t.clipRect.height/2+t.clipRect.y,t.chart.radius+Math.max(c,d)),r=Cu(i,h,o,"drawCircularClipPath");if(h={id:this.elementId+"SymbolGroup"+l,transform:u,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+l+")"},t.symbolElement=o.createGroup(h),t.symbolElement.appendChild(r),this.chart.enableCanvas){var f=document.getElementById(this.chart.element.id+"_tooltip_svg");f.appendChild(t.symbolElement)}}},e.prototype.getRangeLowPoint=function(t,i){var r=t.x,n=t.y;return i.chart.requireInvertedAxis?(n+=t.height/2,r+=i.yAxis.isAxisInverse?t.width:0):(n+=i.yAxis.isAxisInverse?0:t.height,r+=t.width/2),{x:r,y:n}},e.prototype.doMarkerAnimation=function(t){if(!(t.type==="Scatter"||t.type==="Bubble"||t.type==="Candle"||t.type==="Hilo"||t.type==="HiloOpenClose"||t.chart.chartAreaType==="PolarRadar"&&t.drawType==="Scatter")){for(var i=t.symbolElement.childNodes,r=t.animation.delay+(t.animation.duration===0&&vi==="Enable"?1e3:t.animation.duration),n=t.chart.animated?t.chart.duration:200,a=1,o=t.type==="RangeArea"||t.type==="RangeColumn"||t.type==="SplineRangeArea"||t.type==="RangeStepArea"?2:1,l=0;l<t.points.length;l++)if(t.points[l].symbolLocations){if(!t.points[l].symbolLocations.length||!i[a])continue;if(cv(i[a],r,n,t,l,t.points[l].symbolLocations[0],!1),o===2){var h=this.getRangeLowPoint(t.points[l].regions[0],t);cv(i[a+1],r,n,t,l,h,!1)}a+=o}}},e}(YG),$G=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gi=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},V2=function(s){$G(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return gi([S(!0)],e.prototype,"visible",void 0),gi([S(null)],e.prototype,"height",void 0),gi([S(null)],e.prototype,"width",void 0),gi([Ee({x:0,y:0},s2)],e.prototype,"location",void 0),gi([S("Auto")],e.prototype,"position",void 0),gi([S("Series")],e.prototype,"mode",void 0),gi([S(8)],e.prototype,"padding",void 0),gi([S(null)],e.prototype,"itemPadding",void 0),gi([S("Center")],e.prototype,"alignment",void 0),gi([Ee({fontFamily:null,size:"14px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"textStyle",void 0),gi([S(10)],e.prototype,"shapeHeight",void 0),gi([S(10)],e.prototype,"shapeWidth",void 0),gi([Ee({},Bn)],e.prototype,"border",void 0),gi([Ee({left:0,right:0,top:0,bottom:0},Ab)],e.prototype,"margin",void 0),gi([Ee({left:0,right:0,top:0,bottom:0},LQ)],e.prototype,"containerPadding",void 0),gi([S(8)],e.prototype,"shapePadding",void 0),gi([S("transparent")],e.prototype,"background",void 0),gi([S(1)],e.prototype,"opacity",void 0),gi([S(!0)],e.prototype,"toggleVisibility",void 0),gi([S(!1)],e.prototype,"enableHighlight",void 0),gi([S(null)],e.prototype,"description",void 0),gi([S(3)],e.prototype,"tabIndex",void 0),gi([S(null)],e.prototype,"title",void 0),gi([Ee({fontFamily:null,size:"14px",fontStyle:"Normal",fontWeight:"600",color:null},cs)],e.prototype,"titleStyle",void 0),gi([S("Top")],e.prototype,"titlePosition",void 0),gi([S("Normal")],e.prototype,"textWrap",void 0),gi([S("Ellipsis")],e.prototype,"textOverflow",void 0),gi([S(100)],e.prototype,"maximumTitleWidth",void 0),gi([S(null)],e.prototype,"maximumLabelWidth",void 0),gi([S(!0)],e.prototype,"enablePages",void 0),gi([S(!1)],e.prototype,"isInversed",void 0),gi([S(!1)],e.prototype,"reverse",void 0),e}(ke),U2=function(){function s(e){this.maxItemHeight=0,this.rowHeights=[],this.pageHeights=[],this.columnHeights=[],this.pageXCollections=[],this.chartRowCount=1,this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=e,this.legend=e.legendSettings,this.legendID=e.element.id+"_chart_legend",this.isChartControl=e.getModuleName()==="chart"||e.getModuleName()==="chart3d",this.isAccChartControl=e.getModuleName()==="accumulationchart",this.isBulletChartControl=e.getModuleName()==="bulletChart",this.isStockChartControl=e.getModuleName()==="stockChart",this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return s.prototype.calculateLegendBounds=function(e,t,i){var r=this.legend,n=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,t),this.legendBounds=new Ve(e.x,e.y,0,0),this.isVertical=this.position==="Left"||this.position==="Right",this.itemPadding=this.legend.itemPadding?this.legend.itemPadding:this.isVertical?this.legend.padding:20,this.isVertical?(this.legendBounds.height=xi(r.height,t.height-(e.y-this.chart.margin.top))||e.height,this.legendBounds.width=xi(r.width||n,t.width)):(this.legendBounds.width=xi(r.width,t.width)||e.width,this.legendBounds.height=xi(r.height||n,t.height)),this.chart.getModuleName()==="chart3d"?this.library.get3DLegendBounds(t,this.legendBounds,r):this.library.getLegendBounds(t,this.legendBounds,r),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,r.alignment,this.legendBounds,e,t,i)},s.prototype.getPosition=function(e,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position=e!=="Auto"?e:"Bottom":(e==="Auto"&&((i||r).visibleSeries&&(i||r).visibleSeries[0].type==="Funnel"||(i||r).visibleSeries[0].type==="Pyramid")&&(e="Top"),this.position=e!=="Auto"?e:t.width>t.height?"Right":"Bottom")},s.prototype.setBounds=function(e,t,i,r){var n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),e=Math.min(e,r.width),t=Math.min(t,r.height),i.mode==="Gradient"?(r.width=i.width?r.width:this.isVertical?e:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:e,r.height=i.height?r.height:t),this.isBulletChartControl||this.isTop&&i.titleStyle.textOverflow!=="None"&&(this.calculateLegendTitle(i,r),r.height+=i.titleStyle.textOverflow==="Wrap"&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},s.prototype.getLocation=function(e,t,i,r,n,a){var o=this.legend.border.width,l=this.isBulletChartControl,h=this.bulletChart,u=h.labelPosition==="Inside",c=h.tickPosition==="Inside",d=h.orientation==="Vertical",p=l&&h.categoryField!==""?a.width+this.chart.border.width+o*3:0,f=this.chart.margin.bottom,v=i.height+o+this.legend.margin.top+this.legend.margin.bottom,g=i.width+o+this.legend.margin.left+this.legend.margin.right;if(e==="Bottom")i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+(r.height-v)+o+this.legend.margin.top,i.y+=l&&!h.opposedPosition&&!u&&!c&&!d?h.majorTickLines.height+f+this.legend.border.width+o*2:d&&h.categoryField!==""?a.height+o*2:0,Ga(r,new $a(0,0,0,v));else if(e==="Top"){var b=void 0;this.isChartControl&&(b=ht("100",this.chart.verticalAxes[0].labelStyle,this.chart.themeStyle.legendLabelFont)),i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+o+this.legend.margin.top,i.y-=l&&h.opposedPosition&&!u&&!c&&!d?h.majorTickLines.height+this.chart.margin.top:0,v-=l?-o*2:this.isChartControl?-o*2-b.height/2:0,Ga(r,new $a(0,0,v,0))}else e==="Right"?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+f),i.height,t),g+=l&&h.opposedPosition&&!u&&!c&&d?this.chart.margin.left+this.chart.margin.right+h.majorTickLines.height:0,Ga(r,new $a(0,g,0,0))):e==="Left"?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+f),i.height,t),g+=l&&!h.opposedPosition&&!u&&!c&&d?i.x-this.chart.margin.left+o+h.majorTickLines.height:h.orientation!=="Vertical"&&h.categoryField!==""?p:0,Ga(r,new $a(g,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,Ga(r,new $a(0,0,0,0)))},s.prototype.alignLegend=function(e,t,i,r){switch(r){case"Far":e=t-i-e;break;case"Center":e=(t-i)/2;break}return e},s.prototype.renderLegend=function(e,t,i,r){var n=0,a=0,o=new Ve(0,0,0,0),l=new Ve(0,0,0,0),h=this.findFirstLegendPosition(this.legendCollections),u=t.padding;this.itemPadding=this.isBulletChartControl?t.padding:this.itemPadding;var c=t.enablePages,d=t.titlePosition,p=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,f=e.renderer.createGroup({id:this.legendID+"_g"}),v=this.createLegendElements(e,i,f,t,this.legendID,r);this.legendRegions=[],this.chartRowCount=1;var g=0;if(n=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,this.isChartControl||this.isAccChartControl&&!this.isVertical){for(var b=1,y=this.rowHeights[0]+u,C=1;C<this.rowHeights.length;C++)y+this.rowHeights[C]+u>this.legendBounds.height-this.pageButtonSize-this.maxItemHeight/2&&(this.pageHeights[b-1]=y+n,b++,y=0),y+=this.rowHeights[C]+(this.isVertical?this.itemPadding:u);this.pageHeights[b-1]=y+n,this.totalPages=b}for(var C=0;C<this.legendCollections.length;C++)if(this.legendCollections[C].text!==""){g=Math.max(this.legendCollections[C].textSize.height,g);break}else continue;if(!this.isChartControl&&!this.isAccChartControl&&(this.maxItemHeight=Math.max(g,t.shapeHeight)),!c&&this.isPaging&&!this.isVertical?(a=this.isTitle&&d==="Left"?this.legendTitleSize.width:0,a+=this.pageButtonSize+2*this.fivePixel):this.isTitle&&!this.isPaging&&!this.isVertical&&(a=d===(this.isRtlEnable?"Right":"Left")?this.fivePixel+this.legendTitleSize.width:0),e.legendSettings.mode==="Gradient"&&this.legendCollections.length>1)this.getLinearLegend(i,e,t,v),this.totalPages=1;else if(h!==this.legendCollections.length){var x=void 0,w=0,M=this.legendCollections[h],E=this.isBulletChartControl?0:a+u+t.shapeWidth/2+t.containerPadding.left,T=this.isBulletChartControl?i.x+a+u+t.shapeWidth/2:this.isRtlEnable?i.x+(this.chart.getModuleName()==="accumulationchart"&&this.isVertical?this.maxWidth:i.width)-E:i.x+E,D=new ut(T,this.isBulletChartControl?i.y+n+p+u+this.maxItemHeight/2:i.y+n+p+u+this.maxItemHeight/2+t.containerPadding.top),N=e.isRtlEnabled||e.enableRtl?"end":"start",A=new Sn("",D.x,D.y,N),L=t.shapePadding+this.itemPadding+t.shapeWidth;this.totalPages=this.totalPages=this.isAccChartControl||this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[h].location=D;var k=void 0;if(!t.enablePages&&this.isPaging){var O=D.x-this.fivePixel,R=D.y-this.fivePixel,j=this.isTitle&&!this.isVertical&&d==="Left"?this.legendTitleSize.width+this.fivePixel:0,P=this.isVertical?this.pageButtonSize+Math.abs(R-i.y):0,F=this.isTitle&&!this.isVertical&&d==="Right"?this.legendTitleSize.width+this.fivePixel:0;F+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,o=new Ve(O,R,i.width-F-j,i.height-P),l=o}else l=i;for(var z=void 0,C=0;C<this.legendCollections.length;C++)z=this.legendCollections[C],k=this.isReverse?this.legendCollections.length-1-w:w,this.chart.getModuleName()==="accumulationchart"&&(z.fill=(this.chart||this.chart||this.chart||this.chart).visibleSeries[0].points[z.pointIndex].color),this.chart.getModuleName()==="stockChart"&&(z.type=this.chart.visibleSeries[w].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+z.text:"Click to show or hide the "+z.text+" series",z.render&&z.text&&z.text!==""&&(x=e.renderer.createGroup({id:this.legendID+this.generateId(z,"_g_",k)}),x&&(x.setAttribute("tabindex",C===0?"0":""),x.setAttribute("aria-label",t.description||z.text+" series is "+(z.visible?"showing, press enter to hide the ":"hidden, press enter to show the ")+z.text+" series"),x.setAttribute("role","button"),x.setAttribute("aria-pressed",z.visible?"true":"false")),this.library.getRenderPoint(z,D,L,M,l,w,h),this.renderSymbol(z,x,k),this.renderText(e,z,x,A,w,k),x&&(x.style.cssText="pointer-events: bounding-box; cursor: "+(!t.toggleVisibility&&(e.selectionMode==="None"||e.highlightMode==="None"||e.selectionMode==="None")||this.isBulletChartControl?"auto":"pointer")),v&&v.appendChild(x),M=z),w++;this.totalPages=this.isPaging&&!this.isBulletChartControl&&!this.legend.enablePages&&!this.isVertical&&this.totalPages>this.chartRowCount?this.chartRowCount:this.totalPages,this.isPaging&&this.totalPages>1?this.renderPagingElements(e,i,A,f):this.totalPages=1}Mt(e.enableCanvas,e.svgObject,f,r)},s.prototype.getLinearLegend=function(e,t,i,r){var n="http://www.w3.org/2000/svg",a=this.legendCollections[0],o=this.legendCollections[1],l=this.chart.renderer.createDefs(),h=0,u=document.createElementNS(n,"linearGradient"),c=1,d=[],p=[];i.title&&(this.isVertical?(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height):i.titlePosition==="Left"?(e.x+=this.legendTitleSize.width,e.width-=this.legendTitleSize.width):i.titlePosition==="Right"?e.width-=this.legendTitleSize.width:i.titlePosition==="Top"&&(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height));for(var f=0,v=this.chart.rangeColorSettings;f<v.length;f++){var g=v[f];if(p.indexOf(g.start)<0&&p.push(g.start),g.colors.length>2){var b=g.end-g.start,y=g.colors.length-1;if(b>0){b=b/y;for(var C=1;C<y;C++){var x=g.start+b*C;p.push(x)}}else for(var C=1;C<y;C++)p.push(g.start)}p.indexOf(g.end)<0&&p.push(g.end);for(var w=0,M=g.colors;w<M.length;w++){var E=M[w];d.indexOf(E)<0&&d.push(E)}g.colors.length>0&&g.colors.length<2&&d.push(g.colors[0])}var T=this.isRtlEnable&&!this.isVertical?"100%":"0%",D=this.isVertical||this.isRtlEnable?"0%":"100%",N=this.isVertical?"100%":"0%";u.setAttribute("id",this.generateId(a,"linearGradient",h)),u.setAttribute("x1",T),u.setAttribute("y1","0%"),u.setAttribute("x2",D),u.setAttribute("y2",N);for(var A=p[p.length-1]-p[0],L=0;L<d.length;L++){var k=p[L]-p[0];k=k/A;var O=document.createElementNS(n,"stop");O.setAttribute("offset",k.toString()),O.setAttribute("stop-color",d[L]),O.setAttribute("stop-opacity",c.toString()),u.appendChild(O)}var R=a.text.toString(),j=o.text.toString(),P=ht(R,i.textStyle,this.chart.themeStyle.legendLabelFont),F=ht(j,i.textStyle,this.chart.themeStyle.legendLabelFont),z=P.width>F.width?P.width:F.width,q=P.height>F.height?P.height:F.height,X=2*z+4*i.padding,G=e.width,Z=e.height,se=e.x+z+2*i.padding,oe=e.y+i.padding,fe,be,Ne,we;if(this.isVertical){if(X=2*q+4*i.padding,G=e.width-2*i.padding,Z=e.height-X,se=e.x+i.padding,oe=e.y+q+2*i.padding,fe=e.y+i.padding+q,be=oe+Z+q,Ne=e.x+e.width*.5-z*.5,we=Ne,G>30){var H=G-30;G=30,se=se+H/2}}else if(G=e.width-X,Z=e.height-2*i.padding,Ne=e.x+(this.isRtlEnable?G+3*i.padding+z:i.padding+(z-P.width)),we=e.x+(this.isRtlEnable?i.padding+(z-F.width):G+3*i.padding+z),fe=e.y+e.height*.5+q*.25,be=fe,Z>30){var V=Z-30;Z=30,oe=oe+V/2}var re=t.enableRtl?"end":"",he=new Sn("",Ne,fe,re,R),Ie="#D3D3D3";he.id=this.legendID+this.generateId(a,"_text_",1);var Te=a.visible?i.textStyle.color||t.themeStyle.legendLabelFont.color:Ie,rt=this.isStockChartControl?!1:this.chart.enableCanvas;bn(t.renderer,he,i.textStyle,Te,r,!1,!1,!1,!1,null,this.currentPageNumber&&rt?new Ve(0,-this.translatePage(rt,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),he=new Sn("",we,be,re,j),he.id=this.legendID+this.generateId(a,"_text_",2),bn(t.renderer,he,i.textStyle,Te,r,!1,!1,!1,!1,null,this.currentPageNumber&&rt?new Ve(0,-this.translatePage(rt,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont);var Tt=t.renderer.drawRectangle({width:G,height:Z,x:se,y:oe,fill:"url(#"+this.generateId(a,"linearGradient",h)+")"});l.appendChild(u),r.appendChild(l),r.appendChild(Tt)},s.prototype.findFirstLegendPosition=function(e){for(var t=0,i=0,r=e;i<r.length;i++){var n=r[i];if(n.render&&n.text&&n.text!=="")break;t++}return t},s.prototype.calculateLegendTitle=function(e,t){if(e.title){this.isTop=e.titlePosition==="Top";var i=e.titleStyle.textOverflow==="Trim"?2*e.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=Od(e.title,e.titleStyle,t.width-i,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont):this.legendTitleCollections[0]=ta(e.maximumTitleWidth,e.title,e.titleStyle,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont);var r=this.isTop?e.title:this.legendTitleCollections[0];this.legendTitleSize=ht(r,e.titleStyle,this.chart.themeStyle.legendTitleFont),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new ei(0,0)},s.prototype.renderLegendTitle=function(e,t,i,r){var n=t.padding,a=t.titleStyle.textAlignment;this.isTop=t.titlePosition==="Top";var o=Zh(t.titleStyle.textAlignment,e.enableRtl),l=$c(i,t.titleStyle);o=this.isTop||this.isVertical?o:e.enableRtl?"end":"",l=a==="Near"?l+n:a==="Far"?l-n:l,l=this.isTop||this.isVertical?l:i.x+(t.titlePosition==="Left"?5:i.width-this.legendTitleSize.width-5);var h=i.height/2+this.legendTitleSize.height/4,u=i.y+(!this.isTop&&!this.isVertical?h:this.legendTitleSize.height/this.legendTitleCollections.length),c=new Sn(this.legendID+"_title",l,u,o,this.legendTitleCollections);bn(e.renderer,c,t.titleStyle,t.titleStyle.color||this.chart.themeStyle.legendTitleFont.color,r,null,null,null,null,null,null,null,null,null,null,this.chart.themeStyle.legendTitleFont)},s.prototype.createLegendElements=function(e,t,i,r,n,a){var o=r.padding,l=new aa(n+"_element",r.background,r.border,r.opacity,t),h=e.renderer.createGroup({id:n+"_collections"}),u=this.isStockChartControl?!1:e.enableCanvas,c=e.renderer.createClipPath({id:n+"_clipPath"});return l.width=this.isRtlEnable&&this.chart.getModuleName()==="accumulationchart"&&this.isVertical?this.maxWidth:t.width,i?i.appendChild(e.renderer.drawRectangle(l)):e.renderer.drawRectangle(l),r.title&&this.renderLegendTitle(e,r,t,i),u||i.appendChild(h),this.legendTranslateGroup=e.renderer.createGroup({id:n+"_translate_g"}),u||h.appendChild(this.legendTranslateGroup),l.y+=this.isTop?this.legendTitleSize.height:0,l.id+="_clipPath_rect",l.width=!this.isChartControl&&e.getModuleName()!=="bulletChart"&&!this.isStockChartControl&&this.isVertical?this.maxWidth-o+r.containerPadding.left+r.containerPadding.right:t.width,u?this.pagingClipRect=l:(this.clipRect=e.renderer.drawRectangle(l),c.appendChild(this.clipRect)),Mt(u,e.svgObject,c,a),u||(h.style.cssText="clip-path:url(#"+c.id+")"),this.legendTranslateGroup},s.prototype.renderSymbol=function(e,t,i){var r=this.isBulletChartControl?this.chart:null,n=e.visible?e.fill:"#D3D3D3",a=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(e.shape==="SeriesType"&&e.type.toLowerCase().indexOf("line")>-1&&e.type.toLowerCase().indexOf("area")===-1||e.shape==="HorizontalLine"||e.shape==="VerticalLine"||e.shape==="Cross"),o=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(e.type==="Scatter"||e.type==="Bubble"),l=this.isStockChartControl?!1:this.chart.enableCanvas,h,u=e.shape==="SeriesType"?e.type:e.shape,c=a?this.legend.mode==="Series"?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&e.shape==="Multiply"?4:1,d;if(u=u==="Scatter"?e.markerShape:u,o&&i<this.chart.visibleSeries.length){var p=this.chart.visibleSeries[i],f=p.border,v=u==="HorizontalLine"||u==="VerticalLine";h=v?n:f.color?f.color:n,c=v?p.width:f.width?f.width:1}var g=new Er(this.legendID+this.generateId(e,"_shape_",i),n,c,o?h:n,this.legend.opacity,e.dashArray,""),b=ht(e.text,this.legend.textStyle,this.chart.themeStyle.legendLabelFont),y=this.legend.isInversed&&!this.isRtlEnable?e.location.x+b.width+this.legend.shapePadding:e.location.x,C=e.location.y;l?(d=-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),gs({x:y,y:C},u,new ei(this.legend.shapeWidth,this.legend.shapeHeight),"",g,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Ve(0,d,0,0):null,this.isBulletChartControl,r),this.legendRegions.push({rect:new Ve(e.location.x,e.location.y,this.legend.shapeWidth,this.legend.shapeHeight+d),index:i})):t.appendChild(gs({x:y,y:C},u,new ei(this.legend.shapeWidth,this.legend.shapeHeight),e.url,g,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,r)),(u==="Line"&&e.markerVisibility&&e.markerShape!=="Image"||e.type==="Doughnut"&&u==="Doughnut")&&(g.id=this.legendID+this.generateId(e,"_shape_marker_",i),u=e.type==="Doughnut"?"Circle":e.markerShape,g.fill=e.type==="Doughnut"?"#FFFFFF":g.fill,l?gs({x:y,y:C},u,new ei(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",g,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Ve(0,-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,r):t.appendChild(gs({x:y,y:C},u,new ei(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",g,this.accessbilityText,null,null,this.isBulletChartControl,r)))},s.prototype.renderText=function(e,t,i,r,n,a){var o=e.legendSettings,l="#D3D3D3",h=t.visible?o.textStyle.color||e.themeStyle.legendLabelFont.color:l,u=this.isStockChartControl?!1:this.chart.enableCanvas;if(r.id=this.legendID+this.generateId(t,"_text_",a),r.text=t.textCollection.length>0?t.textCollection:t.text,o.isInversed&&!this.isRtlEnable)r.x=t.location.x-o.shapeWidth/2;else if(this.isRtlEnable){var c=ht(t.text,o.textStyle,this.chart.themeStyle.legendLabelFont).width;r.x=t.location.x-((t.textCollection.length>1?c/t.textCollection.length:c)+o.shapeWidth/2+o.shapePadding)}else r.x=t.location.x+o.shapeWidth/2+o.shapePadding;if(r.y=t.location.y+this.maxItemHeight/4,bn(e.renderer,r,o.textStyle,h,i,!1,!1,!1,!1,null,this.currentPageNumber&&u?new Ve(0,-this.translatePage(u,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),u){var d=ht(t.text,o.textStyle,this.chart.themeStyle.legendLabelFont);this.legendRegions[n].rect.y=r.y<this.legendRegions[n].rect.y?r.y:this.legendRegions[n].rect.y,this.legendRegions[n].rect.width+=d.width,this.legendRegions[n].rect.height=d.height,this.legendRegions[n].rect.y-=d.height*.5,this.legendRegions[n].rect.x-=this.isRtlEnable?this.legendRegions[n].rect.width:0}},s.prototype.renderPagingElements=function(e,t,i,r){var n=e.renderer.createGroup({id:this.legendID+"_navigation"}),a=this.isStockChartControl?!1:e.enableCanvas,o=this.isBulletChartControl?0:this.legendTitleSize.height,l=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":"#545454",h=e.legendSettings,u=8,c=this.legendID+(this.isRtlEnable?"_pagedown":"_pageup"),d=this.legendID+(this.isRtlEnable?"_pageup":"_pagedown"),p=new Er(c,"transparent",5,l,1,"",""),f=this.pageButtonSize,v=!h.enablePages&&this.isPaging&&!this.isVertical&&!this.isBulletChartControl?1:this.rowCount-1,g=this.isTitle&&h.titlePosition==="Left"?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=this.currentPage!==1?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,a||r.appendChild(n),!this.isChartControl&&!this.isAccChartControl&&(this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns)),n&&(n.style.cursor="pointer"),(this.isChartControl||this.isAccChartControl)&&!(!h.enablePages&&this.isPaging)?this.clipPathHeight=this.pageHeights[0]:this.clipPathHeight=v*(this.maxItemHeight+h.padding),a?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-h.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=h.border.width,this.pagingClipRect.width-=h.border.width+h.border.width/2,this.chart.renderer.clearRect(new Ve(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var b,y=t.x+f/2,C=t.y+this.clipPathHeight+(o+t.height-this.clipPathHeight)/2;this.isPaging&&!h.enablePages&&!this.isVertical&&!this.isBulletChartControl&&(y=t.x+this.pageButtonSize+g,C=h.title&&this.isTop?t.y+u+o+f/1+.5:t.y+u+f+.5);var x=ht(this.totalPages+"/"+this.totalPages,h.textStyle,this.chart.themeStyle.legendLabelFont),w=this.isRtlEnable?h.border.width+f/2:t.width-(2*(f+u)+u+x.width);a?gs({x:y,y:C},"LeftArrow",new ei(f,f),"",p,"LeftArrow",this.chart.renderer,new Ve(w,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(y=t.x+t.width/2,C=t.y+f/2+u/2+o,p.opacity=this.backwardArrowOpacity,n.appendChild(gs({x:y,y:C},"UpArrow",new ei(f,f),"",p))):(p.opacity=this.isBulletChartControl?p.opacity:h.enablePages?1:this.isRtlEnable?this.forwardArrowOpacity:this.backwardArrowOpacity,n.appendChild(gs({x:y,y:C},"LeftArrow",new ei(f,f),"",p))),this.pagingRegions.push(new Ve(this.isRtlEnable?y:y+t.width-(2*(f+u)+u+x.width)-f*.5,C-f*.5,f,f)),i.x=y+f/2+u,i.y=C+x.height/4,i.id=this.legendID+"_pagenumber",i.text=this.isRtlEnable?this.totalPages+"/1":"1/"+this.totalPages;var M=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":h.textStyle.color||this.chart.themeStyle.legendLabelFont.color;a&&this.totalNoOfPages&&(i.text=this.isRtlEnable?this.totalNoOfPages+"/"+this.currentPageNumber:this.currentPageNumber+"/"+this.totalNoOfPages),(h.enablePages||this.isBulletChartControl)&&(b=bn(e.renderer,i,h.textStyle,M,n,!1,!1,!1,!1,null,new Ve(w,0,0,0),null,null,null,null,this.chart.themeStyle.legendLabelFont)),y=i.x+u+f/2+x.width,this.isPaging&&!h.enablePages&&!this.isVertical&&(y=t.x+t.width-(this.isBulletChartControl?this.fivePixel:0)-this.pageButtonSize-(h.title&&h.titlePosition==="Right"?this.legendTitleSize.width+this.fivePixel:0)),p.id=d,p.opacity=h.enablePages?1:this.isRtlEnable?this.backwardArrowOpacity:this.forwardArrowOpacity,a?gs({x:y,y:C},"RightArrow",new ei(f,f),"",p,"RightArrow",this.chart.renderer,new Ve(w,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(y=t.x+t.width/2,C=t.y+t.height-f/2,n.appendChild(gs({x:y,y:C},"DownArrow",new ei(f,f),"",p))):n.appendChild(gs({x:y,y:C},"RightArrow",new ei(f,f),"",p)),this.pagingRegions.push(new Ve(this.isRtlEnable?y:y+(t.width-(2*(f+u)+u+x.width)-f*.5),C-f*.5,f,f)),!a&&(h.enablePages||this.isBulletChartControl)?n.setAttribute("transform","translate("+w+", 0)"):(this.currentPageNumber===1&&this.calTotalPage&&(h.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),!h.enablePages&&!this.isBulletChartControl&&this.translatePage(a,null,this.currentPage-1,this.currentPage,h)),(h.enablePages||this.isBulletChartControl)&&this.translatePage(a,b,this.currentPage-1,this.currentPage,h)},s.prototype.getPageHeight=function(e,t){for(var i=0,r=0;r<t;r++)i+=e[r];return i},s.prototype.translatePage=function(e,t,i,r,n){var a=this.isChartControl||this.isAccChartControl?i?this.getPageHeight(this.pageHeights,i):0:this.clipPathHeight*i;!e&&(this.isChartControl||this.isAccChartControl)&&(this.clipRect.setAttribute("height",this.pageHeights[i].toString()),this.isAccChartControl&&this.isPaging&&!n.enablePages&&this.isVertical&&this.clipRect.setAttribute("height",this.legendBounds.height.toString()));var o="translate(0,-"+a+")";if(!this.isChartControl&&!this.isBulletChartControl&&!this.isStockChartControl&&this.isVertical){var l=this.pageXCollections[i*this.maxColumns];a=this.isRtlEnable?this.legendBounds.x+this.maxWidth-l:l-this.legendBounds.x,a=a<0?0:a,o=(this.isRtlEnable?"translate(":"translate(-")+a+",0)"}return this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",o),!this.chart.enableCanvas&&(n.enablePages||this.isBulletChartControl)&&(t.textContent=r+"/"+this.totalPages),this.currentPage=r,a},s.prototype.changePage=function(e,t){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),a=this.isStockChartControl?!1:this.chart.enableCanvas,o=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,l=i.enablePages||this.isBulletChartControl?parseInt(o.textContent.split("/")[0],10):this.currentPage;t&&l>1?this.translatePage(a,o,l-2,l-1,i):!t&&l<this.totalPages&&this.translatePage(a,o,l,l+1,i),this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),this.currentPage===1?this.hideArrow(r):this.showArrow(r))},s.prototype.hideArrow=function(e){e.setAttribute("opacity","0")},s.prototype.showArrow=function(e){e.setAttribute("opacity","1")},s.prototype.generateId=function(e,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+e.pointIndex},s.prototype.move=function(e){var t=this,i=this.chart.mouseX,r=this.chart.mouseY;if(e.target.textContent.indexOf("...")>-1){var n=e.target.id.split(this.legendID+"_text_");if(n.length===2){var a=parseInt(n[1],10),o=this.chart.element;isNaN(a)||(this.chart.isTouch&&di(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?Ld(this.chart.series[a].name,i,r,o.offsetWidth,o.id+"_EJ2_Legend_Tooltip",Qe(this.chart.element.id+"_Secondary_Element")):Ld(this.chart.visibleSeries[0].points[a].x.toString(),i+10,r+10,o.offsetWidth,o.id+"_EJ2_Legend_Tooltip",Qe(this.chart.element.id+"_Secondary_Element")))}}else di(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){di(t.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},s}(),lc=function(){function s(e,t,i,r,n,a,o,l,h,u,c){this.location={x:0,y:0},this.textCollection=[],this.text=e,this.fill=t,this.shape=i,this.url=a,this.visible=r,this.type=n,this.markerVisibility=l,this.markerShape=o,this.pointIndex=h,this.seriesIndex=u,this.dashArray=c}return s}(),XG=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ar=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},jL=function(s){XG(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.clipRect=new Ve(0,0,0,0),t}return e.prototype.setDataSource=function(t,i){t&&(this.xData=t.xData,this.yData=t.yData,this.points=t.points);var r=ao(this.type);this.visible&&i[r+"IndicatorModule"].initDataSource(this,i),i.visibleSeriesCount+=this.targetSeries.length},Ar([S("Sma")],e.prototype,"type",void 0),Ar([S(14)],e.prototype,"period",void 0),Ar([S(14)],e.prototype,"kPeriod",void 0),Ar([S(3)],e.prototype,"dPeriod",void 0),Ar([S(80)],e.prototype,"overBought",void 0),Ar([S(20)],e.prototype,"overSold",void 0),Ar([S(2)],e.prototype,"standardDeviation",void 0),Ar([S("Close")],e.prototype,"field",void 0),Ar([S(12)],e.prototype,"slowPeriod",void 0),Ar([S(26)],e.prototype,"fastPeriod",void 0),Ar([S(!0)],e.prototype,"showZones",void 0),Ar([Ee({color:"#ff9933",width:2},Nc)],e.prototype,"macdLine",void 0),Ar([S("Both")],e.prototype,"macdType",void 0),Ar([S("#2ecd71")],e.prototype,"macdPositiveColor",void 0),Ar([S("#e74c3d")],e.prototype,"macdNegativeColor",void 0),Ar([S("rgba(211,211,211,0.25)")],e.prototype,"bandColor",void 0),Ar([Ee({color:"#ffb735",width:1},Nc)],e.prototype,"upperLine",void 0),Ar([Ee({color:"#f2ec2f",width:1},Nc)],e.prototype,"lowerLine",void 0),Ar([Ee({color:"#f2ec2f",width:1},Nc)],e.prototype,"periodLine",void 0),Ar([S("")],e.prototype,"seriesName",void 0),e}(j2),_2=function(){function s(e){this.control=e}return s.prototype.print=function(e){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(e),name:kL};this.control.trigger(kL,t),t.cancel||o_(t.htmlContent,this.printWindow)},s.prototype.getHTMLContent=function(e){var t=St("div");if(e)if(e instanceof Array)for(var i=0;i<e.length;i++){var r=e[i];t.appendChild(Qe(r).cloneNode(!0))}else e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(Qe(e).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));for(var n=0;n<t.children.length;n++){for(var a=this.control.theme.indexOf("Dark")>-1||this.control.theme==="HighContrast"?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)",o=t.children[n],l=0;l<o.children.length;l++){var h=void 0,u=!1;o.id.indexOf("_stockChart_svg")>-1?(h=o.children[0].getAttribute("fill"),u=!0):o.children[l].id.indexOf("_svg")>-1&&(h=o.children[l].children[0].getAttribute("fill"),u=!0),u&&(h=h==="transparent"?a:h,o.children[l].children[0].setAttribute("fill",h))}t[n]=o}return t},s}(),Lb=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Oe=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},KG=function(s){Lb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Oe([S()],e.prototype,"start",void 0),Oe([S()],e.prototype,"end",void 0),Oe([S([])],e.prototype,"colors",void 0),Oe([S("")],e.prototype,"label",void 0),e}(ke),ZG=function(s){Lb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Oe([S(!1)],e.prototype,"enable",void 0),Oe([S("")],e.prototype,"dashArray",void 0),Oe([Ee({color:null,width:1},Bn)],e.prototype,"line",void 0),Oe([S("Both")],e.prototype,"lineType",void 0),Oe([S("")],e.prototype,"verticalLineColor",void 0),Oe([S("")],e.prototype,"horizontalLineColor",void 0),Oe([S(1)],e.prototype,"opacity",void 0),e}(ke),JG=function(s){Lb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return Oe([S(!1)],e.prototype,"enableSelectionZooming",void 0),Oe([S(!1)],e.prototype,"enablePinchZooming",void 0),Oe([S(!1)],e.prototype,"showToolbar",void 0),Oe([S(!1)],e.prototype,"enableMouseWheelZooming",void 0),Oe([S(!0)],e.prototype,"enableDeferredZooming",void 0),Oe([S("XY")],e.prototype,"mode",void 0),Oe([S(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],e.prototype,"toolbarItems",void 0),Oe([S(!1)],e.prototype,"enablePan",void 0),Oe([S(!1)],e.prototype,"enableScrollbar",void 0),e}(ke),XI=function(s){Lb(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.maxPointCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.scaleX=1,r.scaleY=1,r.isCrosshair=!0,r.chartid=57723,r.isLegendClicked=!1,r.isZoomed=!1,r.previousTargetId="",r.currentPointIndex=0,r.currentSeriesIndex=0,r.currentLegendIndex=0,r.previousPageX=null,r.previousPageY=null,r.allowPan=!1,kt("mergePersistData",r.mergePersistChartData,r),r}return e.prototype.mergePersistChartData=function(){var t=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(m(t)||t==="")){var i=JSON.parse(t),r=Object.keys(i);this.isProtectedOnChange=!0;for(var n=0,a=r;n<a.length;n++){var o=a[n];typeof this[o]=="object"&&!m(this[o])?me(this[o],i[o]):this[o]=i[o]}this.isProtectedOnChange=!1}},e.prototype.isIdHasSpecialCharacter=function(t){var i=/^[A-Za-z ]+$/,r=/^[0-9 ]+$/,n="";if(i.test(t))return t;var a=0;r.test(t[0])&&(n+="\\3"+t[0],a=1);for(var o=a;o<t.length;o++)!i.test(t[o])&&t.indexOf("-")===-1&&t.indexOf("_")===-1&&t.indexOf("\\")===-1&&!r.test(t[o])?n+="\\"+t[o]:n+=t[o];return n},e.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id);var t="Blazor";this.isBlazor=window[t],this.allowServerDataBinding=!1,this.markerIndex=0,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(this.stockChart.tooltip.header===null&&(this.tooltip.header="<b>${point.x}</b>"),this.stockChart.tooltip.format===null&&(this.tooltip.format="High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>")),this.element.setAttribute("dir",this.enableRtl?"rtl":"")},e.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.dragY=null,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.element.setAttribute("role","region"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.description||this.title+". Syncfusion interactive chart."),this.element.classList.contains("e-chart-focused")||this.element.setAttribute("class",this.element.getAttribute("class")+" e-chart-focused"),this.element.id===""){for(var t=document.getElementsByClassName("e-chart").length,i="chart_"+this.chartid+"_"+t;document.getElementById(i);)t++,i="chart_"+this.chartid+"_"+t;this.element.id="chart_"+this.chartid+"_"+t}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},e.prototype.render=function(){var t=this;this.svgRenderer=new Nu(this.element.id);var i={chart:this.isBlazor?{}:this,theme:this.theme,name:F0,cancel:!1};this.stockChart?(this.isRtlEnabled=window.getComputedStyle(document.querySelector("body")).direction==="rtl",this.cartesianChartRendering(i)):this.trigger(F0,i,function(){i.cancel||t.cartesianChartRendering(i)}),this.applyZoomkit()},e.prototype.cartesianChartRendering=function(t){this.theme=this.isBlazor?t.theme:this.theme,this.setTheme(),this.createChartSvg(),this.markerRender=new GG(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.mouseMoveEvent(),this.allowServerDataBinding=!0},e.prototype.getLocalizedLabel=function(t){return this.localeObject.getConstant(t)},e.prototype.animate=function(t){if(this.redraw=!0,this.animated=!0,this.duration=t||1e3,this.tooltipModule)this.tooltipModule.removeHighlightedMarker(this.tooltipModule.previousPoints,!0);else if(this.markerRender.previousPoints)for(var i=0;i<this.markerRender.previousPoints.length;i++)this.markerRender.removeHighlightedMarker(this.markerRender.previousPoints[i].series,this.markerRender.previousPoints[i].point)},e.prototype.refreshBound=function(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),di("chartmeasuretext"),this.removeSelection(),this.markerRender&&this.markerRender.mergeXvalues(this.visibleSeries)},e.prototype.calculateStackValues=function(){for(var t,i=!1,r=0,n=this.visibleSeries.length;r<n;r++)t=this.visibleSeries[r],t.position=t.rectCount=void 0,(t.type.indexOf("Stacking")!==-1||t.drawType.indexOf("Stacking")!==-1&&this.chartAreaType==="PolarRadar")&&!i&&(t.calculateStackedValue(t.type.indexOf("100")>-1,this),i=!0)},e.prototype.removeSelection=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];if(r.visible)for(var n=0,a=r.points;n<a.length;n++){var o=a[n];o.isSelect=!1}}Qe(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),di(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new Ve(0,0,0,0),!0)):Qe(this.element.id+"_ej2_drag_group")&&(this.selectionMode!=="Lasso"&&(this.selectionModule.filterArray=[]),di(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new Ve(0,0,0,0),!0))},e.prototype.renderElements=function(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition();for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];this.element.id+"",r.marker.dataLabel}this.renderAnnotation()},e.prototype.renderAxes=function(){this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"});var t;return this.rows.length>0&&this.columns.length>0&&(t=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),t},e.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var t=this.legendSettings.border.width,i=this.legendModule.legendBounds,r=new Ve(i.x,i.y,i.width,i.height);this.enableCanvas&&(r=new Ve(r.x-t/2,r.y-t/2,r.width+t,r.height+t),this.renderer.canvasClip(r)),this.legendModule.renderLegend(this,this.legendSettings,i),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?Qe(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},e.prototype.setSecondaryElementPosition=function(){var t=Qe(this.element.id+"_Secondary_Element");if(t){var i=this.element.getBoundingClientRect(),r=Qe(this.svgId).getBoundingClientRect();t.style.left=Math.max(r.left-i.left,0)+"px",t.style.top=Math.max(r.top-i.top,0)+"px"}},e.prototype.initializeModuleElements=function(){this.dataLabelCollections=[];var t=this.element.id;this.series.length&&(this.seriesElements=this.svgRenderer.createGroup({id:t+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:t+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:t+"TrendLineCollection"})),this.dataLabelElements=this.renderer.createGroup({id:t+"DataLabelCollection"})},e.prototype.hasTrendlines=function(){for(var t,i=0,r=this.series;i<r.length;i++){var n=r[i];if(t=!!n.trendlines.length,t)break}return t},e.prototype.renderSeriesElements=function(t){this.initializeModuleElements();var i=this.element.id;if(this.element.tagName!=="g"){var r=ga(this.redraw,i+"_Secondary_Element")||this.createElement("div");r.id=i+"_Secondary_Element",r.style.cssText="position: relative",Mt(!1,this.element,r,this.redraw)}if(this.enableCanvas){var n=document.getElementById(i+"_Secondary_Element");n=n||this.createElement("div",{id:i+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});var a=this.svgRenderer.createSvg({id:i+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});a.style.cssText="position: absolute; pointer-events: none",n.appendChild(a)}this.tooltip.enable&&Mt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:i+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&Mt(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(t))},e.prototype.renderSeries=function(){var t;this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.category==="TrendLine"?t=this.series[n.sourceIndex].trendlines[n.index].visible:t=n.visible,t&&(this.visible++,bG(n,this.enableCanvas),this.enableCanvas&&this.renderCanvasSeries(n),n.renderSeries(this))}this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0;var a={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};if(this.seriesElements){var o;this.chartAreaType==="PolarRadar"?o=Cu(this.redraw,a,this.renderer,"drawCircularClipPath"):o=Cu(this.redraw,a,this.renderer),this.enableCanvas||this.seriesElements.appendChild(o);var l=document.getElementById(this.element.id+"_series_svg");l?Mt(!1,l,this.seriesElements,this.redraw):Mt(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}},e.prototype.renderCanvasSeries=function(t){var i;i=this.enableCanvas?i:this.svgObject,this.enableCanvas||this.enableCanvas},e.prototype.initializeIndicator=function(){for(var t=0,i=this.indicators;t<i.length;t++){var r=i[t];this[ao(r.type)+"IndicatorModule"]&&this[ao(r.type)+"IndicatorModule"].createIndicatorElements(this,r,r.index)}this.indicatorElements&&Mt(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},e.prototype.initializeTrendLine=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];r.trendlines.length&&this.trendLineModule.getTrendLineElements(r,this)}},e.prototype.appendElementsAfterSeries=function(t){this.chartAreaType==="PolarRadar"&&Mt(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),Mt(this.enableCanvas,this.svgObject,t,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&Mt(!1,Qe(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),this.tooltip.enable||Mt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents()},e.prototype.applyZoomkit=function(){this.chartAreaType!=="PolarRadar"&&!this.redraw&&this.zoomModule&&(!this.zoomSettings.enablePan||this.zoomModule.performedUI||this.zoomSettings.showToolbar)&&this.zoomModule.applyZoomToolkit(this,this.axisCollections)},e.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(Qe((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},e.prototype.performSelection=function(){var t=[];this.selectionModule&&(t=me([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),t.length>0&&(this.selectionModule.selectedDataIndexes=t,this.selectionModule.redrawSelection(this,this.selectionMode))},e.prototype.processData=function(t){t===void 0&&(t=!0),this.visibleSeriesCount=0;for(var i=!0,r=0,n=0,a=this.visibleSeries;n<a.length;n++){var o=a[n];if(!o.visible&&!this.legendSettings.visible){this.visibleSeriesCount++;continue}o.category!=="Indicator"&&o.category!=="TrendLine"&&this.initializeDataModule(o)}for(var l=0,h=this.indicators;l<h.length;l++){var u=h[l];if(u.dataSource){var c=u;this.initializeDataModule(c),i=!1}}if(t&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&i)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),!this.stockChart&&this.visibleSeries.length>0)for(var d=0,p=this.visibleSeries;d<p.length;d++){var o=p[d];m(o.points)||(this.maxPointCount=Math.max(r,o.points.length),r=o.points.length)}},e.prototype.initializeDataModule=function(t){t.xData=[],t.yData=[];var i,r="isAngular";this[r]?i=Object.keys(t.dataSource).length?t.dataSource:this.dataSource:i=t.dataSource||this.dataSource,t.dataModule=new B2(i,t.query),t.points=[],t.refreshDataManager(this)},e.prototype.calculateBounds=function(){var t=this.margin,i=0,r=0,n=this.titleStyle.position==="Top"||this.titleStyle.position==="Bottom"&&!this.legendSettings.visible?15:5,a=t.left+this.border.width,o=this.availableSize.width-a-t.right-this.border.width,l=0;this.titleCollection=[],this.subTitleCollection=[],this.title?(this.titleCollection=Od(this.title,this.titleStyle,o,this.enableRtl,this.themeStyle.chartTitleFont),i=ht(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length+n,this.subTitle&&(this.subTitleCollection=Od(this.subTitle,this.subTitleStyle,o,this.enableRtl,this.themeStyle.chartSubTitleFont),r=ht(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length+n)):this.legendSettings.position!=="Top"&&this.border.width&&(l=10);var h=t.top+l+this.border.width+this.chartArea.border.width*.5,u=this.availableSize.height-h-this.border.width-t.bottom,c=r+i+this.titleStyle.border.width+this.subTitleStyle.border.width;switch(this.titleStyle.position){case"Top":h+=c,u-=c;break;case"Bottom":u-=c;break;case"Left":a+=c,o-=c;break;case"Right":a-=this.titleStyle.border.width+this.subTitleStyle.border.width,o-=c;break}this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?h+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(a+=this.stockChart.stockLegendModule.legendBounds.width)),this.initialClipRect=new Ve(a,h,o,u),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},e.prototype.print=function(t){var i=new _2(this),r=this.width;this.getModuleName()=="chart"&&parseInt(this.width)>=80&&this.width.indexOf("%")>-1&&(this.width="80%",this.dataBind()),i.print(t),this.getModuleName()=="chart"&&parseInt(this.width)>=80&&this.width.indexOf("%")>-1&&(this.width=r,this.dataBind())},e.prototype.initTrendLines=function(){this.isProtectedOnChange=!0;for(var t=0,i=this.visibleSeries;t<i.length;t++)for(var r=i[t],n=0,a=0,o=r.trendlines;a<o.length;a++){var l=o[a],h=l;this.trendLineModule&&(h.index=n,h.sourceIndex=r.index,this.trendLineModule.initSeriesCollection(h,this),h.targetSeries&&(h.targetSeries.xAxisName=r.xAxisName,h.targetSeries.yAxisName=r.yAxisName,this.visibleSeries.push(h.targetSeries))),n++}this.isProtectedOnChange=!1},e.prototype.calculateAreaType=function(){var t=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,t&&(this.requireInvertedAxis=t.type.indexOf("Bar")!==-1&&!this.isTransposed||t.type.indexOf("Bar")===-1&&this.isTransposed&&this.chartAreaType!=="PolarRadar"),this.chartAxisLayoutPanel=this.chartAreaType==="PolarRadar"?this.polarSeriesModule||this.radarSeriesModule:new jG(this)},e.prototype.calculateVisibleAxis=function(){var t,i=[this.primaryXAxis,this.primaryYAxis];i=this.chartAreaType==="Cartesian"?i.concat(this.axes):i,this.paretoSeriesModule&&this.series[0].type==="Pareto"&&(i=i.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(i)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=i)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=i);for(var r=0,n=i.length;r<n;r++){t=i[r],t.series=[],t.labels=[],t.indexLabels={},t.orientation=r==0?this.requireInvertedAxis?"Vertical":"Horizontal":r==1?this.requireInvertedAxis?"Horizontal":"Vertical":t.orientation;for(var a=0,o=this.visibleSeries;a<o.length;a++){var l=o[a];this.initAxis(l,t,!0),l.category=="Pareto"&&l.type=="Line"&&l.yAxis&&(l.yAxis.internalVisibility=l.paretoOptions.showAxis)}for(var h=0,u=this.indicators;h<u.length;h++){var c=u[h];this.initAxis(c,t,!1)}this.scrollBarModule&&!t.zoomingScrollBar&&this.scrollBarModule.injectTo(t,this),t.orientation!=null&&this.axisCollections.push(t)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},e.prototype.initAxis=function(t,i,r){t.xAxisName===i.name||t.xAxisName==null&&i.name==="primaryXAxis"?(i.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",t.xAxis=i,r&&i.series.push(t)):(t.yAxisName===i.name||t.yAxisName==null&&i.name==="primaryYAxis")&&(i.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",t.yAxis=i,r&&i.series.push(t))},e.prototype.initTechnicalIndicators=function(){for(var t=0,i=0,r=this.indicators;i<r.length;i++){var n=r[i],a=n,o=ao(a.type);if(this[o+"IndicatorModule"]){a.index=t,this[o+"IndicatorModule"].initSeriesCollection(a,this);for(var l=0,h=a.targetSeries;l<h.length;l++){var u=h[l];(n.seriesName||n.dataSource)&&this.visibleSeries.push(u)}}t++}},e.prototype.refreshTechnicalIndicator=function(t){if(this.indicators.length){var i=null;if(t instanceof Lr&&t.category!=="Indicator")for(var r=0,n=this.indicators;r<n.length;r++){var a=n[r];a.seriesName===t.name&&!a.dataSource&&(i=a,i.setDataSource(t,this))}else t instanceof jL&&(i=t,i.setDataSource(t instanceof Lr?t:null,this))}},e.prototype.calculateVisibleSeries=function(){var t;this.visibleSeries=[];for(var i=this.palettes.length?this.palettes:P2(this.theme),r=i.length,n=this.series.sort(function(l,h){return l.zOrder-h.zOrder}),a=0,o=n.length;a<o;a++){switch(t=n[a],t.category=n[0].type==="Pareto"?"Pareto":"Series",t.index=a,t.interior=t.fill||i[a%r],!t.marker.shape&&(t.marker.visible||t.type==="Scatter"||t.drawType==="Scatter")&&(t.marker.shape=H2[this.markerIndex%10],this.markerIndex++),this.isSecondaryAxis(t.xAxis)&&(t.xAxis.internalVisibility=t.xAxis.series.some(function(l){return l.visible})),this.isSecondaryAxis(t.yAxis)&&(t.yAxis.internalVisibility=t.yAxis.series.some(function(l){return l.visible})),t.type){case"Bar":case"StackingBar":case"StackingBar100":if(n[0].type.indexOf("Bar")===-1)continue;break;case"Polar":case"Radar":if(this.chartAreaType!=="PolarRadar"||this.chartAreaType==="PolarRadar"&&(t.xAxisName!==null&&this.primaryXAxis.name!==t.xAxisName||t.yAxisName!==null&&this.primaryYAxis.name!==t.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(t),this.paretoSeriesModule.initSeries(t,this);continue;default:if(this.chartAreaType==="PolarRadar"||n[0].type.indexOf("Bar")>-1)continue;break}this.visibleSeries.push(t),n[a]=t}},e.prototype.isSecondaryAxis=function(t){return this.axes.indexOf(t)>-1},e.prototype.renderTitle=function(){var t,i=this.margin,r=5;if(this.title){var n=Zh(this.titleStyle.textAlignment,this.enableRtl),a=ht(this.title,this.titleStyle,this.themeStyle.chartTitleFont);t=new Ve(i.left,0,this.availableSize.width-i.left-i.right,0);var o=this.titleStyle.border.width,l=this.margin.top+a.height*3/4,h=$c(t,this.titleStyle||this.themeStyle.chartTitleFont)+o,u=void 0,c=this.titleStyle.textAlignment,d=ht(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont);switch(this.titleStyle.position){case"Top":l+=o*.5,h+=n==="start"?o*.5+this.border.width:n==="end"?-o*2-this.border.width:0;break;case"Bottom":h+=n==="start"?o*.5+this.border.width:n==="end"?-o*2-this.border.width:0,l=this.availableSize.height-this.margin.bottom-d.height-a.height/2-o*.5-this.subTitleStyle.border.width*.5;break;case"Left":h=this.margin.left+a.height*3/4+o*.5,l=c=="Near"?i.bottom+o*.5+this.border.width:c=="Far"?this.availableSize.height-i.bottom-o*.5-this.border.width:this.availableSize.height/2,n=c=="Near"?"end":c=="Far"?"start":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,u="rotate(-90,"+h+","+l+")";break;case"Right":h=this.availableSize.width-this.margin.right-a.height*3/4-o*.5,l=c=="Near"?i.bottom+o*.5+this.border.width:c=="Far"?this.availableSize.height-i.bottom-o*.5-this.border.width:this.availableSize.height/2,n=c=="Near"?"start":c=="Far"?"end":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,u="rotate(90,"+h+","+l+")";break;case"Custom":h=this.titleStyle.x,l=this.titleStyle.y,n="middle";break}var p={id:this.element.id+"_ChartTitleBorder",x:h-(n==="middle"?a.width/2+r:n==="end"?a.width+r:r),y:l-a.height+a.height/4,rx:this.titleStyle.border.cornerRadius,ry:this.titleStyle.border.cornerRadius,width:a.width+r*2,height:a.height*this.titleCollection.length,fill:this.titleStyle.background,"stroke-width":o,stroke:this.titleStyle.border.color,transform:u||"",d:""},f=ga(this.redraw,this.element.id+"_ChartTitleBorder",p,this.renderer)||this.renderer.drawRectangle(p);Mt(this.enableCanvas,this.svgObject,f,this.redraw);var v=new Sn(this.element.id+"_ChartTitle",h,l,n,this.titleCollection,u,"auto"),g=ga(this.redraw,this.element.id+"_ChartTitle",v,this.renderer)||bn(this.renderer,v,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartTitleFont);g&&(g.setAttribute("tabindex","0"),g.setAttribute("class","e-chart-focused")),this.subTitle&&this.renderSubTitle(v)}},e.prototype.renderSubTitle=function(t){for(var i=0,r=0,n=10,a=this.titleStyle.textAlignment,o=0,l=this.titleCollection;o<l.length;o++){var h=l[o];r=ht(h,this.titleStyle,this.themeStyle.chartSubTitleFont).width,i=r>i?r:i}var u=ht(this.subTitleCollection.reduce(function(y,C){return y.length>C.length?y:C}),this.subTitleStyle,this.themeStyle.chartSubTitleFont),c=Zh(this.subTitleStyle.textAlignment,this.enableRtl),d=new Ve(a==="Center"?t.x-i*.5:a==="Far"?t.x-i:t.x,0,i,0);this.titleStyle.position==="Left"&&(d.x=a==="Center"?t.x-i*.5:a=="Far"?this.margin.left+u.height*3/4:t.x-i);var p=ht(this.title,this.titleStyle,this.themeStyle.chartTitleFont),f=t.y*t.text.length+u.height+n/2+this.titleStyle.border.width+this.subTitleStyle.border.width*.5;this.titleStyle.position==="Bottom"&&(f=t.y*t.text.length+n/2+p.height/2+u.height/2);var v={id:this.element.id+"_ChartSubTitleBorder",x:$c(d,this.subTitleStyle)-(c==="middle"?u.width/2+n/2:c==="end"?u.width+n/2:n/2),y:f-u.height+u.height/4,rx:this.subTitleStyle.border.cornerRadius,ry:this.subTitleStyle.border.cornerRadius,width:u.width+n,height:u.height*this.subTitleCollection.length,fill:this.subTitleStyle.background,"stroke-width":this.subTitleStyle.border.width,stroke:this.subTitleStyle.border.color,transform:t.transform,d:""},g=ga(this.redraw,this.element.id+"_ChartSubTitleBorder",v,this.renderer)||this.renderer.drawRectangle(v);Mt(this.enableCanvas,this.svgObject,g,this.redraw);var b=new Sn(this.element.id+"_ChartSubTitle",$c(d,this.subTitleStyle),f,Zh(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,t.transform,"auto");ga(this.redraw,this.element.id+"_ChartSubTitle",b,this.renderer)||bn(this.renderer,b,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartSubTitleFont)},e.prototype.renderBorder=function(){var t=0,i=0,r=this.border.width,n=this.backgroundImage,a=n?"transparent":this.background||this.themeStyle.background;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?i+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(t+=this.stockChart.stockLegendModule.legendBounds.width));var o=new aa(this.element.id+"_ChartBorder",a,this.border,1,new Ve(r*.5+t,r*.5+i,this.availableSize.width-r,this.availableSize.height-r));if(this.htmlObject=ga(this.redraw,this.element.id+"_ChartBorder",o,this.renderer)||this.renderer.drawRectangle(o),this.htmlObject.setAttribute("aria-hidden","true"),Mt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),n){var l=new YM(this.availableSize.height-r,this.availableSize.width-r,n,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=ga(this.redraw,this.element.id+"_ChartBackground",l,this.renderer)||this.renderer.drawImage(l),Mt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}},e.prototype.renderAreaBorder=function(){if(this.chartAreaType==="PolarRadar")return null;var t=Qe(this.element.id+"_ChartAreaBorder"),i=t?new Ve(+t.getAttribute("x"),+t.getAttribute("y"),+t.getAttribute("width"),+t.getAttribute("height")):null,r=new aa(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect);this.htmlObject=this.renderer.drawRectangle(r),this.htmlObject.setAttribute("aria-hidden","true"),Mt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,i),this.htmlObject=null;var n=this.chartArea.backgroundImage;if(n){var a=this.chartArea.border.width,o=new YM(this.initialClipRect.height-a,this.initialClipRect.width-a,n,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(o),Mt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}},e.prototype.addSeries=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n=new Lr(this,"series",n),this.series.push(n)}this.refresh()},e.prototype.removeSeries=function(t){this.redraw=!1,this.visibleSeries[t]&&(this.visibleSeries[t].xAxis.orientation=null,this.visibleSeries[t].yAxis.orientation=null);for(var i=0;i<this.axes.length;i++)this.axes[i].orientation===null&&this.axes.splice(i,1);this.series.splice(t,1),this.refresh()},e.prototype.clearSeries=function(){this.series=[],this.refresh()},e.prototype.addAxes=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n=new ag(this,"axes",n),this.isBlazor&&(n.interval=isNaN(n.interval)?null:n.interval,n.desiredIntervals=isNaN(n.desiredIntervals)?null:n.desiredIntervals),this.axes.push(n)}this.refresh()},e.prototype.removeAxis=function(t){this.redraw=!1,this.axes.splice(t,1),this.refresh()},e.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.dataLabelElements=null,this.yAxisElements=null;var t=document.getElementById(this.element.id+"Keyboard_chart_focus");t&&t.remove();var i=document.getElementById(this.element.id+"_ej2_chart_highlight");i&&i.remove(),di("chartmeasuretext"),this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),s.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},e.prototype.getModuleName=function(){return"chart"},e.prototype.getPersistData=function(){var t=["loaded","animationComplete","primaryXAxis","primaryYAxis"];return this.addOnPersist(t)},e.prototype.createChartSvg=function(){this.removeSvg(),F2(this)},e.prototype.unWireEvents=function(){var t=B.touchStartEvent,i=B.touchMoveEvent,r=B.touchEndEvent,n=B.isPointer?"pointerleave":"mouseleave";/*! UnBind the Event handler */I.remove(this.element,t,this.chartOnMouseDown),I.remove(this.element,i,this.mouseMove),I.remove(this.element,r,this.mouseEnd),I.remove(this.element,"click",this.chartOnMouseClick),I.remove(this.element,"dblclick",this.chartOnDoubleClick),I.remove(this.element,"contextmenu",this.chartRightClick),I.remove(this.element,n,this.mouseLeave),I.remove(this.element,"keydown",this.chartKeyDown),I.remove(document.body,"keydown",this.documentKeyHandler),I.remove(this.element,"keyup",this.chartKeyUp),window.removeEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},e.prototype.wireEvents=function(){if(!this.element)return;/*! Find the Events type */var t=B.isPointer?"pointerleave":"mouseleave";/*! Bind the Event handler */I.add(this.element,B.touchStartEvent,this.chartOnMouseDown,this),I.add(this.element,B.touchMoveEvent,this.mouseMove,this),I.add(this.element,B.touchEndEvent,this.mouseEnd,this),I.add(this.element,"click",this.chartOnMouseClick,this),I.add(this.element,"dblclick",this.chartOnDoubleClick,this),I.add(this.element,"contextmenu",this.chartRightClick,this),I.add(this.element,t,this.mouseLeave,this),I.add(this.element,"keydown",this.chartKeyDown,this),I.add(document.body,"keydown",this.documentKeyHandler,this),I.add(this.element,"keyup",this.chartKeyUp,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new Pn(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500});/*! Apply the style for chart */this.setStyle(this.element)},e.prototype.chartRightClick=function(t){return this.crosshair.enable&&this.crosshairModule&&(t.buttons===2||t.which===0||t.pointerType==="touch")?(t.preventDefault(),t.stopPropagation(),!1):!0},e.prototype.setStyle=function(t){var i=this.zoomSettings,r=i.enableSelectionZooming||i.enablePinchZooming||this.selectionMode!=="None"||this.crosshair.enable||this.highlightMode!=="None";t.style.touchAction=r?"none":"element",t.style.msTouchAction=r?"none":"element",t.style.msContentZooming="none",t.style.msUserSelect="none",t.style.webkitUserSelect="none",t.style.position="relative",t.style.display="block",t.style.overflow="hidden",t.style.height=t.style.height||this.height&&this.height.indexOf("%")===-1?t.style.height:"inherit"},e.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},e.prototype.longPress=function(t){return this.mouseX=t&&t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].clientX:0,this.mouseY=t&&t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.allowPan=this.stockChart?!1:this.allowPan,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",t),!1},e.prototype.setMouseXY=function(t,i){if(Qe(this.svgId)){var r=Qe(this.svgId).getBoundingClientRect(),n=this.element.getBoundingClientRect();this.mouseY=i-n.top-Math.max(r.top-n.top,0)/this.scaleX,this.mouseX=t-n.left-Math.max(r.left-n.left,0)/this.scaleY,this.stockChart&&(this.mouseX+=this.stockChart.legendSettings.position==="Left"?this.stockChart.stockLegendModule.legendBounds.width:0,this.mouseY+=this.stockChart.legendSettings.position==="Top"?this.stockChart.stockLegendModule.legendBounds.height:0)}},e.prototype.export=function(t,i){this.exportModule&&(this.exportModule.export(t,i),this.afterExport&&this.exportModule.getDataUrl(this))},e.prototype.chartResize=function(){var t=this;this.animateSeries=!1;var i={chart:this,name:B0,currentSize:new ei(0,0),previousSize:new ei(this.availableSize.width,this.availableSize.height)},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(S2,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(t.isDestroyed||t.stockChart){clearTimeout(t.resizeTo);return}t.createChartSvg(),i.currentSize=t.availableSize,t.trigger(B0,i),t.refreshAxis(),t.refreshBound(),t.trigger("loaded",{chart:t.isBlazor?{}:t})},500)),!1},e.prototype.mouseMove=function(t){var i,r,n;return this.allowPan||(t.type==="touchmove"?(this.isTouch=!0,n=t,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=t.pointerType==="touch"||t.pointerType==="2"||this.isTouch,i=t.clientX,r=t.clientY),this.previousPageX=i,this.previousPageY=r,Qe(this.svgId)&&(this.setMouseXY(i,r),this.chartOnMouseMove(t))),!1},e.prototype.mouseLeave=function(t){var i,r,n;return this.stockChart&&this.stockChart.onPanning||(t.type==="touchleave"?(this.isTouch=!0,n=t,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=t.pointerType==="touch"||t.pointerType==="2",i=t.clientX,r=t.clientY),this.previousPageX=null,this.previousPageY=null,this.setMouseXY(i,r),this.chartOnMouseLeave(t)),!1},e.prototype.chartOnMouseLeave=function(t){var i=t.target,r=B.isPointer?"pointerleave":"mouseleave";return this.trigger(y2,{target:i.id,x:this.mouseX,y:this.mouseY}),di(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(r,t),!1},e.prototype.chartOnDoubleClick=function(t){var i=t.target;return this.trigger(v2,{target:i.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.chartKeyDown=function(t){var i="";return(this.isZoomed&&t.code==="Tab"||t.code==="Space")&&t.preventDefault(),this.tooltip.enable&&(t.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||t.code==="Escape")&&(i="ESC"),this.highlightMode!=="None"&&t.code==="Tab"&&this.previousTargetId.indexOf("_chart_legend_")>-1&&this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),t.ctrlKey&&(t.key==="+"||t.code==="Equal"||t.key==="-"||t.code==="Minus")?(t.preventDefault(),this.isZoomed=this.zoomModule&&(this.zoomSettings.enableDeferredZooming||this.zoomSettings.enableSelectionZooming||this.zoomSettings.enablePinchZooming||this.zoomSettings.enableMouseWheelZooming),i=this.isZoomed?t.code:""):t.keyCode===82&&this.isZoomed?(t.preventDefault(),this.isZoomed=!1,i="R"):t.code.indexOf("Arrow")>-1&&(t.preventDefault(),i=this.isZoomed?t.code:""),t.ctrlKey&&t.key==="p"&&(t.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(t,t.target.id,i),!1},e.prototype.chartKeyUp=function(t){var i="",r=t.target.id,n,a,o=t.target,l=Qe(this.element.id+"_ChartTitle"),h=Qe(this.element.id+"SeriesCollection"),u=Qe(this.element.id+"_chart_legend_translate_g"),c=Qe(this.element.id+"_chart_legend_pageup");if(l&&l.setAttribute("class","e-chart-focused"),h&&h.firstElementChild&&h.firstElementChild.children[1]){var d=h.firstElementChild.children[1],p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(u){var d=u.firstElementChild,p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(c&&c.setAttribute("class","e-chart-focused"),t.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Series_")>-1&&r.indexOf("_Series_")===-1){n=Qe(this.element.id+"SeriesCollection");var f=this.previousTargetId.indexOf("_Symbol")>-1?Qe(this.element.id+"SymbolGroup"+this.currentSeriesIndex).children[this.currentPointIndex+1]:this.previousTargetId.indexOf("_Point_")>-1?n.children[this.currentSeriesIndex].children[this.currentPointIndex+1]:n.children[this.currentSeriesIndex];this.setTabIndex(f,n.firstElementChild),this.currentPointIndex=0,this.currentSeriesIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(t.target,Qe(this.element.id+"_chart_legend_pageup")):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("_chart_legend_g_")===-1&&(n=Qe(this.element.id+"_chart_legend_translate_g"),this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild));this.previousTargetId=r,r.indexOf("SeriesGroup")>-1&&(this.currentSeriesIndex=+r.split("SeriesGroup")[1],o.removeAttribute("tabindex"),o.blur(),o.children[1].id.indexOf("_Point_")===-1&&(a=Qe(this.element.id+"SymbolGroup"+r.split("SeriesGroup")[1])),r=this.focusChild(a!=null?a.children[1]:o.children[1])),i=this.highlightMode!=="None"||this.tooltip.enable?"Tab":""}else if(t.code.indexOf("Arrow")>-1){if(t.preventDefault(),this.previousTargetId=r,r.indexOf("_chart_legend_page")>-1)t.code==="ArrowLeft"?(Qe(this.element.id+"_chart_legend_pagedown").removeAttribute("tabindex"),this.focusChild(Qe(this.element.id+"_chart_legend_pageup"))):t.code==="ArrowRight"&&(Qe(this.element.id+"_chart_legend_pageup").removeAttribute("tabindex"),this.focusChild(Qe(this.element.id+"_chart_legend_pagedown")));else if(r.indexOf("_chart_legend_")>-1){var v=o.parentElement.children;v[this.currentLegendIndex].removeAttribute("tabindex"),this.currentLegendIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,v.length);var g=v[this.currentLegendIndex];this.focusChild(g),r=g.children[1].id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Series_")>-1){n=o.parentElement.parentElement;var b=t.target;if(o.removeAttribute("tabindex"),o.blur(),t.code==="ArrowRight"||t.code==="ArrowLeft"){for(var y=[],C=0;C<n.children.length;C++)n.children[C].id.indexOf("SeriesGroup")>-1&&y.push(+n.children[C].id.split("SeriesGroup")[1]);this.currentSeriesIndex=y.indexOf(this.currentSeriesIndex)+(t.code==="ArrowRight"?1:-1),this.currentSeriesIndex=y[this.getActualIndex(this.currentSeriesIndex,y.length)]}else this.currentPointIndex+=t.code==="ArrowUp"?1:-1;r.indexOf("_Symbol")>-1?(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,Qe(this.element.id+"SymbolGroup"+this.currentSeriesIndex).childElementCount-1),b=Qe(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex+"_Symbol")):r.indexOf("_Point_")>-1&&(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,Qe(this.element.id+"SeriesGroup"+this.currentSeriesIndex).childElementCount-1),b=Qe(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex)),r=this.focusChild(b),i=this.tooltip.enable||this.highlightMode!=="None"?"ArrowMove":""}}else(t.code==="Enter"||t.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_page")>-1?r:r.indexOf("_chart_legend_")>-1?o.children[1].id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(t,r,i),!1},e.prototype.setTabIndex=function(t,i){t&&t.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},e.prototype.getActualIndex=function(t,i){return t>i-1?0:t<0?i-1:t},e.prototype.focusChild=function(t){t.setAttribute("tabindex","0");var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-chart-focused")===-1?i="e-chart-focused "+i:i||(i="e-chart-focused"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.documentKeyHandler=function(t){t.altKey&&t.keyCode===74&&!m(this.element)&&this.element.focus()},e.prototype.chartKeyboardNavigations=function(t,i,r){switch(this.isLegendClicked=!1,r){case"Tab":case"ArrowMove":if(this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],a=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],o=this.visibleSeries[n].points[a].symbolLocations[0];this.mouseX=o.x+this.initialClipRect.x,this.mouseY=o.y+this.initialClipRect.y,this.highlightModule&&(this.highlightModule.highlightChart(document.getElementById(i),"mousemove"),this.highlightModule.completeSelection(document.getElementById(i),"mousemove")),this.tooltipModule&&this.tooltipModule.tooltip()}if(this.highlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var l=this.element.id+"_chart_legend",h=[l+"_text_",l+"_shape_marker_",l+"_shape_"],u=0;u<h.length;u++){var c=h[u];if(i.indexOf(c)>-1){document.getElementById(i).setAttribute("class",""),this.highlightModule.legendSelection(this,parseInt(i.split(c)[1],10),document.getElementById(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1?(this.isLegendClicked=!0,this.legendModule.click(t),this.focusChild(document.getElementById(i).parentElement)):this.selectionModule.calculateSelectedElements(document.getElementById(i),"click");break;case"CtrlP":this.print();break;case"ESC":this.tooltipModule.removeTooltip(1);break;case"Equal":case"Minus":this.zoomModule.isZoomed=this.zoomModule.performedUI=!0,this.zoomModule.isPanning=this.isChartDrag=!1,r==="Equal"?this.zoomModule.toolkit.zoomInOutCalculation(1,this,this.axisCollections,this.zoomSettings.mode):this.zoomModule.toolkit.zoomInOutCalculation(-1,this,this.axisCollections,this.zoomSettings.mode),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":var d=r==="ArrowUp"?10:r==="ArrowDown"?-10:0,p=r==="ArrowLeft"?-10:r==="ArrowRight"?10:0;this.zoomModule.isPanning=this.isChartDrag=!0,this.zoomModule.doPan(this,this.axisCollections,p,d),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"R":this.zoomModule.toolkit.reset(t);break}},e.prototype.chartOnMouseClick=function(t){var i=this,r=t.target,n=this;this.clickCount++;var a=400;this.clickCount===1?this.singleClickTimer=+setTimeout(function(){n.clickCount=0,n.trigger(f2,{target:r.id,x:n.mouseX,y:n.mouseY})},a):this.clickCount===2&&!this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0);var o="isAngular";if(this[o]){var l="observers";a=this.pointDoubleClick[l].length>0?400:0}else a=this.pointDoubleClick?400:0;return this.clickCount===1&&this.pointClick?this.singleClickTimer=+setTimeout(function(){i.clickCount=0,i.triggerPointEvent(m2,t)},a):this.clickCount===2&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent(XQ,t)),this.axisLabelClick&&this.triggerAxisLabelClickEvent($Q,t),this.notify("click",t),!1},e.prototype.triggerPointEvent=function(t,i){var r=i,n=new GI(this),a=n.getData();a.series&&a.point&&this.trigger(t,{series:this.isBlazor?{}:a.series,point:a.point,seriesIndex:a.series.index,pointIndex:a.point.index,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},e.prototype.triggerAxisLabelClickEvent=function(t,i){var r=i.target,n=i;if(r.id.indexOf("_AxisLabel_")!==-1){var a=r.id.split("_AxisLabel_"),o=+a[0].slice(-1),l=+a[1],h=this.axisCollections[o];h.visible&&(o===0||o===1)&&this.trigger(t,{chart:this,axis:h,text:h.visibleLabels[l].text,labelID:r.id,index:l,location:new ut(n.pageX,n.pageY),value:h.visibleLabels[l].value})}},e.prototype.chartOnMouseMove=function(t){var i=t.target;return this.trigger(p2,{target:i.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(g2,t),this.isTouch||(this.titleTooltip(t,this.mouseX,this.mouseY),this.axisTooltip(t,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(t),this.notify(B.touchMoveEvent,t),this.isTouch=!1,!1},e.prototype.titleTooltip=function(t,i,r,n){var a=t.target.id,o=a===this.element.id+"_ChartTitle"||a===this.element.id+"_ChartSubTitle"||a.indexOf("_AxisTitle")>-1||a.indexOf("_legend_title")>-1,l=0;if(a.indexOf("_AxisTitle")>-1&&(l=parseInt(a.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),o&&t.target.textContent.indexOf("...")>-1){var h=a===this.element.id+"_ChartTitle"?this.title:a.indexOf("_AxisTitle")>-1?this.axisCollections[l].title:a.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title;Ld(h,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",Qe(this.element.id+"_Secondary_Element"),n)}else di(this.element.id+"_EJ2_Title_Tooltip")},e.prototype.axisTooltip=function(t,i,r,n){var a=t.target.id;if((a.indexOf("AxisLabel")>-1||a.indexOf("Axis_MultiLevelLabel")>-1)&&t.target.textContent.indexOf("...")>-1){var o=this.legendSettings.visible||this.primaryXAxis.title==="";Ld(this.findAxisLabel(a),i,r,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",Qe(this.element.id+"_Secondary_Element"),n,o)}else di(this.element.id+"_EJ2_AxisLabel_Tooltip")},e.prototype.findAxisLabel=function(t){var i;return t.indexOf("AxisLabel")>-1?(i=t.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(i[0],10)].visibleLabels[parseInt(i[1],10)].originalText):(i=t.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(i[0],10)].multiLevelLabels[parseInt(i[1],10)].categories[parseInt(i[2],10)].text)},e.prototype.chartOnMouseDown=function(t){var i,r,n,a,o=B.isDevice?20:30,l=this.element.getBoundingClientRect(),h=t.target;this.stockChart&&this.stockChart.zoomSettings.enablePan&&(this.allowPan=!0),this.trigger(b2,{target:h.id,x:this.mouseX,y:this.mouseY}),t.type==="touchstart"?(this.isTouch=!0,a=t,i=a.changedTouches[0].clientX,r=a.changedTouches[0].clientY,n=a.target):(this.isTouch=t.pointerType==="touch",i=t.clientX,r=t.clientY,n=t.target);var u=Qe(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=i-l.left-Math.max(u.left-l.left,0),this.mouseDownY=this.previousMouseMoveY=r-l.top-Math.max(u.top-l.top,0),this.isTouch&&(this.isDoubleTap=new Date().getTime()<this.threshold&&n.id.indexOf(this.element.id+"_Zooming_")===-1&&(this.mouseDownX-o>=this.mouseX||this.mouseDownX+o>=this.mouseX)&&(this.mouseDownY-o>=this.mouseY||this.mouseDownY+o>=this.mouseY)&&(this.mouseX-o>=this.mouseDownX||this.mouseX+o>=this.mouseDownX)&&(this.mouseY-o>=this.mouseDownY||this.mouseY+o>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(B.touchStartEvent,t),!1},e.prototype.mouseEnd=function(t){var i,r,n;return t.type==="touchend"?(n=t,r=n.changedTouches[0].clientX,this.isTouch=!0,i=n.changedTouches[0].clientY):(i=t.clientY,r=t.clientX,this.isTouch=t.pointerType==="touch"||t.pointerType==="2"),this.setMouseXY(r,i),this.chartOnMouseUp(t),!1},e.prototype.chartOnMouseUp=function(t){var i=t.target;return this.trigger(C2,{target:i.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.allowPan=!1,this.isTouch&&(this.titleTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.threshold=new Date().getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(B.touchEndEvent,t),!1},e.prototype.setCulture=function(){this.intl=new _t,this.setLocaleConstants(),this.localeObject=new In(this.getModuleName(),this.defaultLocalConstants,this.locale)},e.prototype.setAnnotationValue=function(t,i){var r=Qe(this.element.id+"_Annotation_Collections"),n=this.annotations[t],a;i!==null&&(n.content=i,r?(di(this.element.id+"_Annotation_"+t),a=this.createElement("div"),this.annotationModule.processAnnotation(n,t,a),r.appendChild(a.children[0])):this.annotationModule.renderAnnotations(Qe(this.element.id+"_Secondary_Element")))},e.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},e.prototype.setTheme=function(){/*! Set theme */if(this.themeStyle=z2(this.theme,this.enableCanvas),!document.getElementById(this.element.id+"Keyboard_chart_focus")){var t=document.createElement("style");t.setAttribute("id",this.element.id+"Keyboard_chart_focus"),t.innerText=".e-chart-focused:focus, path[class*=_ej2_chart_selection_series]:focus,path[id*=_Point_]:focus, text[id*=_ChartTitle]:focus {outline: none } .e-chart-focused:focus-visible, path[class*=_ej2_chart_selection_series]:focus-visible,path[id*=_Point_]:focus-visible, text[id*=_ChartTitle]:focus-visible {outline: 1.5px "+this.themeStyle.tabColor+" solid}",document.body.appendChild(t)}},e.prototype.requiredModules=function(){var t=this,i=[],r=this.series,n=!1,a,o=!1,l=!1,h=!1,u=this.zoomSettings;return this.chartAreaType=r.length>0&&(r[0].type==="Polar"||r[0].type==="Radar")?"PolarRadar":"Cartesian",this.tooltip.enable&&i.push({member:"Tooltip",args:[this]}),r.map(function(c){t.isLegend=t.legendSettings.visible&&(c.name!==""||!!t.isLegend),a=c.type.indexOf("100")!==-1?c.type.replace("100","")+"Series":c.type+"Series",o=c.errorBar.visible||o,h=c.marker.dataLabel.visible||h||c.type=="Pareto"&&c.paretoOptions.marker.dataLabel.visible,l=c.dragSettings.enable||l,i.some(function(d){return d.member===a})||i.push({member:a,args:[t,r]}),t.chartAreaType==="PolarRadar"&&i.push({member:c.drawType+"Series",args:[t,r]}),c.type==="Pareto"&&(i.push({member:"ColumnSeries",args:[t,r]}),i.push({member:"LineSeries",args:[t,r]}))}),this.findIndicatorModules(i),this.findTrendLineModules(i),i=this.findAxisModule(i),n=this.annotations.some(function(c){return c.content!==null}),o&&i.push({member:"ErrorBar",args:[this,r]}),this.isLegend&&i.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&i.push({member:"Export",args:[this]}),this.chartAreaType!=="PolarRadar"&&this.crosshair.enable&&i.push({member:"Crosshair",args:[this]}),this.chartAreaType!=="PolarRadar"&&!this.scrollSettingEnabled&&(u.enableSelectionZooming||u.enableMouseWheelZooming||u.enablePinchZooming||u.enablePan||u.enableScrollbar||u.showToolbar)&&(i.push({member:"Zoom",args:[this,this.zoomSettings]}),u.enableScrollbar&&i.push({member:"ScrollBar",args:[this]})),this.selectionMode!=="None"&&!(this.chartAreaType==="PolarRadar"&&this.selectionMode.indexOf("Drag")>-1)&&i.push({member:"Selection",args:[this]}),(this.highlightMode!=="None"||this.legendSettings.enableHighlight)&&i.push({member:"Highlight",args:[this]}),h&&i.push({member:"DataLabel",args:[this,r]}),l&&i.push({member:"DataEditing",args:[this]}),n&&i.push({member:"Annotation",args:[this]}),i},e.prototype.findAxisModule=function(t){var i=[];i.push(this.primaryXAxis),i.push(this.primaryYAxis),i=i.concat(this.axes);for(var r=!1,n=!1,a=!1,o=!1,l=!1,h=!1,u=0,c=i;u<c.length;u++){var d=c[u];r=d.valueType==="DateTime"||r,n=d.valueType==="Category"||n,a=d.valueType==="Logarithmic"||a,l=d.valueType==="DateTimeCategory"||l,o=this.findStriplineVisibility(d.stripLines)||o,h=d.multiLevelLabels.length>0||h,this.scrollSettingEnabled=d.scrollbarSettings.enable?!0:this.scrollSettingEnabled}return r&&t.push({member:"DateTime",args:[this]}),n&&t.push({member:"Category",args:[this]}),a&&t.push({member:"Logarithmic",args:[this]}),o&&t.push({member:"StripLine",args:[this]}),h&&t.push({member:"MultiLevelLabel",args:[this]}),l&&t.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&t.push({member:"ScrollBar",args:[this]}),t},e.prototype.findIndicatorModules=function(t){var i,r,n=this.indicators;if(this.indicators.length){t.push({member:"LineSeries",args:[this]}),n.map(function(h){i=i||h.type==="Macd",r=r||h.type==="BollingerBands"}),i&&t.push({member:"ColumnSeries",args:[this]}),r&&t.push({member:"RangeAreaSeries",args:[this]}),r&&t.push({member:"SplineRangeAreaSeries",args:[this]});for(var a=0,o=this.indicators;a<o.length;a++){var l=o[a];t.push({member:l.type+"Indicator",args:[this]})}}},e.prototype.findTrendLineModules=function(t){for(var i,r,n=function(u){var c;u.trendlines.map(function(d){c=c||d.marker.visible,i=!!(i||d.type==="Linear"||d.type==="MovingAverage"),r=!!(r||!i||d.type==="Exponential"||d.type==="Logarithmic"||d.type==="Power"||d.type==="Polynomial")}),c&&t.push({member:"Marker",args:[a,u]})},a=this,o=0,l=this.series;o<l.length;o++){var h=l[o];n(h)}(i||r)&&t.push({member:"TrendLine",args:[this]}),i&&t.push({member:"LineSeries",args:[this]}),r&&t.push({member:"SplineSeries",args:[this]})},e.prototype.findStriplineVisibility=function(t){for(var i=!1,r=0,n=t;r<n.length;r++){var a=n[r];if(a.visible){i=!0;break}}return i},e.prototype.removeSvg=function(){if(this.redraw)return null;if(kb(this),this.enableCanvas&&this.svgObject&&this.svgObject.tagName==="CANVAS")return this.renderer.clearRect(new Ve(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&pt(this.svgObject),null;di(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();var t=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),t=1),!m(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount)for(var i=document.querySelectorAll(".e-chart"),r=0;r<i.length;r++)for(var n=i[r];n.firstChild;)pt(n.firstChild);this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>t;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&!this.stockChart&&pt(this.svgObject)}},e.prototype.refreshDefinition=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n.axes=[]}},e.prototype.refreshAxis=function(){var t=this.primaryXAxis;t.rect=new Ve(void 0,void 0,0,0),t=this.primaryYAxis,t.isStack100=!1,t.rect=new Ve(void 0,void 0,0,0);for(var i=0,r=this.axes;i<r.length;i++){var n=r[i];t=n,t.rect=new Ve(void 0,void 0,0,0),t.isStack100=!1}if(this.paretoSeriesModule&&this.series[0].type==="Pareto")for(var a=0,o=this.paretoSeriesModule.paretoAxes;a<o.length;a++){var n=o[a];t=n,t.rect=new Ve(void 0,void 0,0,0),t.isStack100=!1}},e.prototype.axisChange=function(t){return!t.name&&!t.valueType?!1:(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},e.prototype.getVisibleSeries=function(t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(i===a.index)return a}return null},e.prototype.refreshLiveData=function(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},e.prototype.removeStyles=function(){di(this.element.id+"_ej2_chart_selection"),di(this.element.id+"_ej2_chart_highlight")},e.prototype.mouseMoveEvent=function(){if(this.tooltip.enable&&this.previousPageX!==null&&this.previousPageY!==null){var t=document.createEvent("MouseEvent");t.initMouseEvent("mousemove",!0,!1,window,1,100,100,this.previousPageX,this.previousPageY,!1,!1,!1,!1,0,null),this.element.dispatchEvent(t)}},e.prototype.showTooltip=function(t,i,r){if(r===void 0&&(r=!1),r)for(var n=0,a=this.visibleSeries;n<a.length;n++)for(var o=a[n],l=0,h=o.points;l<h.length;l++){var u=h[l],c=o.xAxis.valueType=="DateTime"?u.xValue:u.x,d=t;if(o.xAxis.valueType=="DateTime"&&(d=new Date(d).getTime()),t==c&&i===u.yValue){this.mouseX=u.regions[0].x+this.chartAxisLayoutPanel.seriesClipRect.x,this.mouseY=u.regions[0].y+this.chartAxisLayoutPanel.seriesClipRect.y,this.tooltipModule.tooltip(),this.markerRender.mouseMoveHandler();break}}else this.isTouch&&(this.startMove=!0),this.mouseX=t,this.mouseY=i,this.tooltipModule.mouseMoveHandler(),this.markerRender.mouseMoveHandler()},e.prototype.hideTooltip=function(){this.tooltipModule.removeTooltip(B.isDevice?2e3:1e3)},e.prototype.showCrosshair=function(t,i){this.mouseX=t,this.mouseY=i,this.isCrosshair=!1,Mn(this.mouseX,this.mouseY,this.chartAxisLayoutPanel.seriesClipRect)?this.crosshairModule.crosshair():this.hideCrosshair(),this.isCrosshair=!0},e.prototype.hideCrosshair=function(){this.crosshairModule.removeCrosshair(B.isDevice?2e3:1e3)},e.prototype.onPropertyChanged=function(t,i){var r=!1,n=!1;this.animateSeries=!1;var a;if(!this.delayRedraw){for(var o=0,l=Object.keys(t);o<l.length;o++){var h=l[o];switch(h){case"primaryXAxis":a=t.primaryXAxis,n=this.axisChange(a),t.primaryXAxis.edgeLabelPlacement&&(r=!0),t.primaryXAxis.crosshairTooltip||(n=!0),(!m(a.isInversed)||!m(a.opposedPosition))&&this.primaryXAxis.setIsInversedAndOpposedPosition();break;case"primaryYAxis":a=t.primaryYAxis,n=this.axisChange(a),t.primaryYAxis.edgeLabelPlacement&&(r=!0),t.primaryYAxis.crosshairTooltip||(n=!0),(!m(a.isInversed)||!m(a.opposedPosition))&&this.primaryYAxis.setIsInversedAndOpposedPosition();break;case"axes":for(var u=0,c=Object.keys(t.axes);u<c.length;u++){var d=c[u];a=t.axes[d],n=n||this.axisChange(a),a.crosshairTooltip||(n=!0),(!m(a.isInversed)||!m(a.opposedPosition))&&this.axes[d].setIsInversedAndOpposedPosition()}break;case"height":case"width":this.createChartSvg(),n=!0;break;case"subTitle":case"title":n=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow)?n=!0:r=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?n=!0:r=!0;break;case"border":r=!0;break;case"dataSource":this.processData(!1),n=!0;break;case"enableCanvas":this.refresh();break;case"series":for(var p=this.series.length,f=!1,v=void 0,g=void 0,b=0;b<p;b++)v=t.series[b],this.isBlazor&&v&&(v.visible!==i.series[b].visible||v.isClosed||v.marker||v.emptyPointSettings||v.type||v.boxPlotMode||v.showMean)&&(g=!0),v&&(v.dataSource||v.query||v.errorBar||v.xName||v.yName||v.size||v.high||v.low||v.open||v.close||v.trendlines||v.fill||v.name||v.marker||v.width||v.binInterval||v.type||g)&&(me(this.getVisibleSeries(this.visibleSeries,b),v,null,!0),f=!0);f&&(this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),n=!0);break;case"indicators":n=!0;break;case"zoomSettings":(t.zoomSettings.enableScrollbar||i.zoomSettings.enableScrollbar)&&(n=!0),r=!0;break;case"background":r=!0;break;case"chartArea":t.chartArea.border&&t.chartArea.border.width&&(n=!0),r=!0;break;case"legendSettings":(!t.legendSettings.background||!t.legendSettings.opacity)&&(n=!0),r=!0;break;case"palettes":this.calculateVisibleSeries(),r=!0;break;case"selectedDataIndexes":this.selectionModule?(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0)):this.highlightModule&&(this.highlightModule.currentMode=this.highlightMode,this.highlightModule.highlightDataIndexes=this.selectedDataIndexes,this.highlightModule.styleId=this.element.id+"_ej2_chart_highlight",this.highlightModule.redrawSelection(this,i.selectionMode,!0));break;case"selectionMode":this.selectionModule&&t.selectionMode&&t.selectionMode.indexOf("Drag")===-1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!t.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),r=!0;break;case"theme":this.animateSeries=!0;break;case"enableRtl":case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),r=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[],this.tooltip.template&&(this.tooltipModule.template=this.tooltip.template));break}}!n&&r&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),n&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.dragY=null,this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}},Oe([S(null)],e.prototype,"width",void 0),Oe([S(null)],e.prototype,"height",void 0),Oe([S("")],e.prototype,"title",void 0),Oe([S("")],e.prototype,"dataSource",void 0),Oe([Ee({fontFamily:null,size:"16px",fontStyle:"Normal",fontWeight:"600",color:null},EL)],e.prototype,"titleStyle",void 0),Oe([S("")],e.prototype,"subTitle",void 0),Oe([Ee({fontFamily:null,size:"14px",fontStyle:"Normal",fontWeight:"400",color:null},EL)],e.prototype,"subTitleStyle",void 0),Oe([Ee({},Ab)],e.prototype,"margin",void 0),Oe([Ee({color:"#DDDDDD",width:0},Bn)],e.prototype,"border",void 0),Oe([S(null)],e.prototype,"background",void 0),Oe([Ee({border:{color:null,width:.5},background:"transparent"},kQ)],e.prototype,"chartArea",void 0),Oe([Ee({name:"primaryXAxis"},ag)],e.prototype,"primaryXAxis",void 0),Oe([Ee({name:"primaryYAxis"},ag)],e.prototype,"primaryYAxis",void 0),Oe([ii([{}],rG)],e.prototype,"rows",void 0),Oe([ii([{}],nG)],e.prototype,"columns",void 0),Oe([ii([{}],ag)],e.prototype,"axes",void 0),Oe([ii([{}],Lr)],e.prototype,"series",void 0),Oe([ii([{}],KQ)],e.prototype,"annotations",void 0),Oe([S([])],e.prototype,"palettes",void 0),Oe([S("Material")],e.prototype,"theme",void 0),Oe([Ee({},l2)],e.prototype,"tooltip",void 0),Oe([Ee({},ZG)],e.prototype,"crosshair",void 0),Oe([Ee({},V2)],e.prototype,"legendSettings",void 0),Oe([ii([{}],KG)],e.prototype,"rangeColorSettings",void 0),Oe([Ee({},JG)],e.prototype,"zoomSettings",void 0),Oe([S("")],e.prototype,"highlightColor",void 0),Oe([S("None")],e.prototype,"selectionMode",void 0),Oe([S("None")],e.prototype,"highlightMode",void 0),Oe([S("None")],e.prototype,"selectionPattern",void 0),Oe([S("None")],e.prototype,"highlightPattern",void 0),Oe([S(!1)],e.prototype,"isMultiSelect",void 0),Oe([S(!1)],e.prototype,"allowMultiSelection",void 0),Oe([S(!0)],e.prototype,"enableExport",void 0),Oe([S(!1)],e.prototype,"allowExport",void 0),Oe([ii([],a2)],e.prototype,"selectedDataIndexes",void 0),Oe([S(!1)],e.prototype,"useGroupingSeparator",void 0),Oe([S(!1)],e.prototype,"enableAutoIntervalOnBothAxis",void 0),Oe([S(!1)],e.prototype,"isTransposed",void 0),Oe([S(!1)],e.prototype,"enableCanvas",void 0),Oe([S(null)],e.prototype,"backgroundImage",void 0),Oe([ii([],jL)],e.prototype,"indicators",void 0),Oe([S(!0)],e.prototype,"enableAnimation",void 0),Oe([S(null)],e.prototype,"description",void 0),Oe([S(1)],e.prototype,"tabIndex",void 0),Oe([S(!0)],e.prototype,"enableSideBySidePlacement",void 0),Oe([_()],e.prototype,"resized",void 0),Oe([_()],e.prototype,"beforeResize",void 0),Oe([_()],e.prototype,"annotationRender",void 0),Oe([_()],e.prototype,"beforePrint",void 0),Oe([_()],e.prototype,"loaded",void 0),Oe([_()],e.prototype,"beforeExport",void 0),Oe([_()],e.prototype,"afterExport",void 0),Oe([_()],e.prototype,"load",void 0),Oe([_()],e.prototype,"animationComplete",void 0),Oe([_()],e.prototype,"legendRender",void 0),Oe([_()],e.prototype,"textRender",void 0),Oe([_()],e.prototype,"pointRender",void 0),Oe([_()],e.prototype,"seriesRender",void 0),Oe([_()],e.prototype,"axisLabelRender",void 0),Oe([_()],e.prototype,"axisLabelClick",void 0),Oe([_()],e.prototype,"axisRangeCalculated",void 0),Oe([_()],e.prototype,"axisMultiLabelRender",void 0),Oe([_()],e.prototype,"legendClick",void 0),Oe([_()],e.prototype,"multiLevelLabelClick",void 0),Oe([_()],e.prototype,"tooltipRender",void 0),Oe([_()],e.prototype,"sharedTooltipRender",void 0),Oe([_()],e.prototype,"chartMouseMove",void 0),Oe([_()],e.prototype,"chartMouseClick",void 0),Oe([_()],e.prototype,"chartDoubleClick",void 0),Oe([_()],e.prototype,"pointClick",void 0),Oe([_()],e.prototype,"pointDoubleClick",void 0),Oe([_()],e.prototype,"pointMove",void 0),Oe([_()],e.prototype,"chartMouseLeave",void 0),Oe([_()],e.prototype,"chartMouseDown",void 0),Oe([_()],e.prototype,"chartMouseUp",void 0),Oe([_()],e.prototype,"dragComplete",void 0),Oe([_()],e.prototype,"selectionComplete",void 0),Oe([_()],e.prototype,"zoomComplete",void 0),Oe([_()],e.prototype,"onZooming",void 0),Oe([_()],e.prototype,"scrollStart",void 0),Oe([_()],e.prototype,"scrollEnd",void 0),Oe([_()],e.prototype,"scrollChanged",void 0),Oe([_()],e.prototype,"dragStart",void 0),Oe([_()],e.prototype,"drag",void 0),Oe([_()],e.prototype,"dragEnd",void 0),Oe([S("USD")],e.prototype,"currencyCode",void 0),e=Oe([Ot],e),e}(Pi),e$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),t$=function(s){e$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.calculateDateTimeNiceInterval=function(t,i,r,n,a){a===void 0&&(a=!0);var o=24*60*60*1e3,l=new Date(r),h=new Date(n),u=Math.abs((l.getTime()-h.getTime())/o),c;t.actualIntervalType=t.intervalType;var d=t.intervalType;switch(d){case"Years":c=this.calculateNumericNiceInterval(t,u/365,i);break;case"Quarter":c=this.calculateNumericNiceInterval(t,u/365*4,i);break;case"Months":c=this.calculateNumericNiceInterval(t,u/30,i);break;case"Weeks":c=this.calculateNumericNiceInterval(t,u/7,i);break;case"Days":c=this.calculateNumericNiceInterval(t,u,i);break;case"Hours":c=this.calculateNumericNiceInterval(t,u*24,i);break;case"Minutes":c=this.calculateNumericNiceInterval(t,u*24*60,i);break;case"Seconds":c=this.calculateNumericNiceInterval(t,u*24*60*60,i);break;case"Auto":return c=this.calculateNumericNiceInterval(t,u/365,i),c>=1?(t.actualIntervalType="Years",c):(c=this.calculateNumericNiceInterval(t,u/30,i),c>=1?(t.actualIntervalType="Months",c):(c=this.calculateNumericNiceInterval(t,u/7,i),c>=1&&!a?(t.actualIntervalType="Weeks",c):(c=this.calculateNumericNiceInterval(t,u,i),c>=1?(t.actualIntervalType="Days",c):(c=this.calculateNumericNiceInterval(t,u*24,i),c>=1?(t.actualIntervalType="Hours",c):(c=this.calculateNumericNiceInterval(t,u*24*60,i),c>=1?(t.actualIntervalType="Minutes",c):(c=this.calculateNumericNiceInterval(t,u*24*60*60,i),t.actualIntervalType="Seconds",c))))))}return c},e.prototype.getSkeleton=function(t,i,r,n){var a,o=t.actualIntervalType;return t.skeleton?t.skeleton:(o==="Years"?n?a=(t.isChart&&t.valueType==="DateTime","y"):a=t.isChart?t.valueType==="DateTime"&&t.isIntervalInDecimal?"y":"yMMM":"y":o==="Quarter"?a=n?"y":"yMMM":o==="Months"?n?a=(t.isChart,"m"):a=t.isChart?"MMMd":"MMM":o==="Weeks"?a=n?"m":"MEd":o==="Days"?n?a="d":a=t.isChart?t.valueType==="DateTime"?"MMMd":"yMd":"MMMd":o==="Hours"?n?a="t":a=t.isChart?t.valueType==="DateTime"?"Hm":"EHm":"h":o==="Minutes"?n?a="T":a=t.isChart?"Hms":"hm":n?a="T":a=t.isChart?"Hms":"hms",a)},e.prototype.findCustomFormats=function(t,i,r){var n=t.labelFormat?t.labelFormat:"";return t.isChart&&!t.skeleton&&t.actualIntervalType==="Months"&&!n&&(n=t.valueType==="DateTime"?"MMM yyyy":"yMMM"),n},e}(d2),i$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),r$=function(s){i$(e,s);function e(t){return s.call(this,t)||this}return e.prototype.calculateRangeAndInterval=function(t,i){this.calculateRange(i),this.getActualRange(i,t),this.applyRangePadding(i,t),this.calculateVisibleLabels(i)},e.prototype.getActualRange=function(t,i){this.initializeDoubleRange(t),t.actualRange={},t.interval?t.actualRange.interval=Math.ceil(t.interval):t.actualRange.interval=Math.max(1,Math.floor(t.doubleRange.delta/D2(i,t))),t.actualRange.min=t.doubleRange.start,t.actualRange.max=t.doubleRange.end,t.actualRange.delta=t.doubleRange.delta},e.prototype.applyRangePadding=function(t,i){var r;t.series.forEach(function(a){r||(r=a.type.indexOf("Column")>-1&&!(t.zoomFactor<1||t.zoomPosition>0)&&m(t.minimum)&&m(t.maximum))});var n=(t.labelPlacement==="BetweenTicks"||r)&&!this.chart.stockChart&&this.chart.chartAreaType!=="PolarRadar"?.5:0;n>0?(t.actualRange.min-=n,t.actualRange.max+=n):t.actualRange.max+=t.actualRange.max?0:.5,t.doubleRange=new qa(t.actualRange.min,t.actualRange.max),t.actualRange.delta=t.doubleRange.delta,this.calculateVisibleRange(i,t)},e.prototype.calculateVisibleLabels=function(t){/*! Generate axis labels */t.visibleLabels=[],t.visibleRange.interval=t.visibleRange.interval<1?1:t.visibleRange.interval;var i=Math.ceil(t.visibleRange.min),r;(t.zoomFactor<1||t.zoomPosition>0)&&(i=t.visibleRange.min-t.visibleRange.min%t.visibleRange.interval);var n;for(t.startLabel=t.labels[Math.round(t.visibleRange.min)],t.endLabel=t.labels[Math.floor(t.visibleRange.max)];i<=t.visibleRange.max;i+=t.visibleRange.interval)r=me({},ie("properties",t.labelStyle),null,!0),Kh(i,t.visibleRange)&&t.labels.length>0&&(n=Math.round(i),WM(this.chart,n,t.labels[n]?t.labels[n].toString():"",r,t));t.getMaxLabelWidth&&t.getMaxLabelWidth(this.chart)},e.prototype.getModuleName=function(){return"Category"},e.prototype.destroy=function(){},e}(t$),Ob=function(){function s(e){this.chart=e}return s.prototype.enableComplexProperty=function(e){for(var t=[],i=[],r=e.xAxis.visibleRange,n=e.yAxis.visibleRange,a=e.points,o=e.clipRect,l=Math.abs(r.delta/o.width),h=Math.abs(n.delta/o.height),u=a[0]&&a[0].xValue>l?0:l,c=a[0]&&a[0].y>h?0:h,d=0,p=0,f=0,v=a;f<v.length;f++){var g=v[f];g.symbolLocations=[],d=g.xValue?g.xValue:r.min,p=g.yValue?g.yValue:n.min,(Math.abs(u-d)>=l||Math.abs(c-p)>=h)&&(t.push(g),u=d,c=p)}for(var b,y=0;y<t.length;y++)b=t[y],!(m(b.x)||e.category==="Indicator"&&(isNaN(b.xValue)||isNaN(b.yValue)))&&i.push(b);return i},s.prototype.getLineDirection=function(e,t,i,r,n,a){var o="";if(e!=null){var l=n(e.xValue,e.yValue,i.xAxis,i.yAxis,r,i),h=n(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i);o=a+" "+l.x+" "+l.y+" L "+h.x+" "+h.y+" "}return o},s.prototype.appendLinePath=function(e,t,i){var r=Qe(e.id),n=t.chart,a=r?r.getAttribute("d"):null,o=t.chart.renderer.drawPath(e,new Int32Array([t.clipRect.x,t.clipRect.y]));o&&o.setAttribute("clip-path",i),t.pathElement=o,t.chart.enableCanvas||t.seriesElement.appendChild(o),t.isRectSeries=!1,Nb(r,e.d,t.chart.redraw,a,n.duration)},s.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},s.prototype.doProgressiveAnimation=function(e,t){var i=new ri({}),r=e.pathElement,n=r.getAttribute("stroke-dasharray"),a=e.pathElement.getTotalLength(),o;r.style.visibility="hidden",i.animate(r,{duration:t.duration===0&&vi==="Enable"?1e3:t.duration,delay:t.delay,progress:function(l){l.timeStamp>=l.delay&&(r.style.visibility="visible",o=Math.abs(Math.round((l.timeStamp-l.delay)*a/l.duration)),r.setAttribute("stroke-dasharray",o+","+a))},end:function(){r.setAttribute("stroke-dasharray",n),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},s.prototype.storePointLocation=function(e,t,i,r){var n=t.marker&&t.marker.width?t.marker.width:0,a=t.marker&&t.marker.height?t.marker.height:0;e.symbolLocations.push(r(e.xValue,e.yValue,t.xAxis,t.yAxis,i,t)),e.regions.push(new Ve(e.symbolLocations[0].x-n,e.symbolLocations[0].y-a,2*n,2*a))},s.prototype.withinYRange=function(e,t){return e.yValue>=t.visibleRange.min&&e.yValue<=t.visibleRange.max},s.prototype.GetStepLineDirection=function(e,t,i,r){if(r===void 0&&(r="L"),i==="Right")return r+" "+t.x+" "+e.y+" L "+e.x+" "+e.y+" ";if(i==="Center"){var n=t.x+(e.x-t.x)/2;return r+" "+n+" "+t.y+" L "+n+" "+e.y+" L "+e.x+" "+e.y+" "}else return r+" "+e.x+" "+t.y+" L "+e.x+" "+e.y+" "},s.prototype.getFirstLastVisiblePoint=function(e){for(var t=null,i=null,r=0,n=e;r<n.length;r++){var a=n[r];t===null&&a.visible&&(t=i=a),i=a.visible?a:i}return{first:t||e[0],last:i||e[e.length-1]}},s.prototype.getBorderDirection=function(e){var t=e.split(" ");return t.length>3&&!this.chart.stackingAreaSeriesModule&&!this.chart.stackingStepAreaSeriesModule?t.splice(t.length-4,3):(this.chart.stackingAreaSeriesModule||this.chart.stackingStepAreaSeriesModule)&&(t.splice(t.length/2+1,t.length/2+1),t[t.length-1]==="L"&&t.splice(t.length-1,1)),t.join(" ")},s.prototype.removeEmptyPointsBorder=function(e){var t=0,i=e.split(" "),r;do r=i.indexOf("M",t),r>-1&&(i.splice(r+1,3),t=r+1,r-6>0&&(i.splice(r-6,6),t-=6));while(r!==-1);return i.join(" ")},s.prototype.doLinearAnimation=function(e,t){var i=e.clipRectElement.childNodes[0].childNodes[0],r=e.chart.animated?e.chart.duration:t.duration,n=qI("Linear"),a=+i.getAttribute("height"),o=+i.getAttribute("width"),l=+i.getAttribute("x"),h=e.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y"),u;i.style.visibility="hidden",new ri({}).animate(i,{duration:r===0&&vi==="Enable"?1e3:r,delay:t.delay,progress:function(c){c.timeStamp>=c.delay&&(i.style.visibility="visible",e.chart.requireInvertedAxis?(u=n(c.timeStamp-c.delay,0,a,c.duration),i.setAttribute("transform","translate("+l+" "+h+") scale(1,"+u/a+") translate("+-l+" "+-h+")")):(u=n(c.timeStamp-c.delay,0,o,c.duration),i.setAttribute("transform","translate("+l+" "+h+") scale("+u/o+", 1) translate("+-l+" "+-h+")")))},end:function(){i.setAttribute("transform","translate(0,0)"),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},s}(),n$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),s$=function(s){n$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n){for(var a,o,l="",h=null,u="M",c=t.chart&&t.chart.chartAreaType==="PolarRadar",d=t.emptyPointSettings&&t.emptyPointSettings.mode==="Drop",p=c?kv:Yn,f=t.category==="TrendLine"?t.points:this.enableComplexProperty(t),v=0,g=f;v<g.length;v++){var b=g[v];b.regions=[],b.symbolLocations=[],b.visible&&Jo(f[b.index-1],b,f[b.index+1],t)?(l+=this.getLineDirection(h,b,t,n,p,u),u=h?"L":u,h=b,this.storePointLocation(b,t,n,p)):(h=d?h:null,u=d?u:"M")}if(c&&t.isClosed){var y=this.getFirstLastVisiblePoint(f);o=p(y.last.xValue,y.last.yValue,i,r,n,t),a=p(y.first.xValue,y.first.yValue,i,r,n,t),l=l.concat(u+" "+o.x+" "+o.y+" L "+a.x+" "+a.y)}var C=t.category==="Indicator"?t.chart.element.id+"_Indicator_"+t.index+"_"+t.name:t.category==="TrendLine"?t.chart.element.id+"_Series_"+t.sourceIndex+"_TrendLine_"+t.index:t.chart.element.id+"_Series_"+(t.index===void 0?t.category:t.index),x=new Er(C,"none",t.width,t.interior,t.opacity,t.dashArray,l);this.appendLinePath(x,t,""),this.renderMarker(t)},e.prototype.doAnimation=function(t){var i=t.animation;this.doProgressiveAnimation(t,i)},e.prototype.getModuleName=function(){return"LineSeries"},e.prototype.destroy=function(){},e}(Ob),Rb=function(){function s(){}return s.prototype.getSideBySideInfo=function(e){if(e.chart.enableSideBySidePlacement&&!e.position&&this.getSideBySidePositions(e),e.columnWidthInPixel)return new qa(0,0);var t=e.type==="Histogram"||!e.chart.enableSideBySidePlacement?0:e.position,i=e.type==="Histogram"||!e.chart.enableSideBySidePlacement?1:e.rectCount;e.isRectSeries=!0;var r=e.chart.visibleSeries,n=e.chart.enableSideBySidePlacement?e.columnSpacing:0,a=e.columnWidth===null||isNaN(+e.columnWidth)?e.type==="Histogram"?1:.7:Math.min(e.columnWidth,1),o=T2(e.xAxis,r),l=o*a,h,u=t/i-.5,c=new qa(u,u+1/i);if(!(isNaN(c.start)||isNaN(c.end))){if(e.groupName&&e.type.indexOf("Stacking")===-1){var d=.7;e.chart.series.filter(function(g){g.columnWidth>d&&(d=g.columnWidth)});var p=o*d,f=new qa(c.start*p,c.end*p),v=(f.delta-(c.end*l-c.start*l))/2;c=new qa(f.start+v,f.end-v)}else c=new qa(c.start*l,c.end*l);h=n*c.delta,c=new qa(c.start+h/2,c.end-h/2)}return c},s.prototype.getRectangle=function(e,t,i,r,n){var a=Yn(e,t,n.xAxis,n.yAxis,n.chart.requireInvertedAxis),o=Yn(i,r,n.xAxis,n.yAxis,n.chart.requireInvertedAxis);return new Ve(Math.min(a.x,o.x),Math.min(a.y,o.y),Math.abs(o.x-a.x),Math.abs(o.y-a.y))},s.prototype.drawCylinder=function(e,t,i,r,n){var a=r.width,o=r.height;if(n.chart.enableCanvas){var l=n.chart.canvasRender.ctx,h=l;l.save();var u=qn(e.fill),c=r.x+n.clipRect.x,d=r.y+n.clipRect.y,p=2*Math.PI+.1,f=void 0,v=void 0,g=void 0,b=void 0,y=void 0,C=void 0,x=void 0,w=void 0,M=void 0,E=void 0,T=void 0,D=void 0,N=void 0,A=void 0,L=void 0,k=void 0,O=void 0,R=void 0,j=void 0,P=0,F=0,z=0,q=0,X=0;l.fillStyle=Mh(u,.9),l.lineWidth=0,l.strokeStyle=Mh(u,.9),l.globalAlpha=e.opacity,i.isColumn?(P=c,F=a+c,f=a/2,v=f/4,b=g=c+f,E=y=d-v,w=c,x=c+a,C=M=d+o-v,O=Math.PI,R=-f,j=v,i.stacking&&(i.isLastSeries||(E=y=d+v))):(q=o+d,z=d,v=o/2,f=v/4,w=g=c+f,x=b=c+a+f,M=d+o,E=d,C=y=d+v,X=Math.PI/2,O=Math.PI*1.5,i.stacking&&(i.isLastSeries||(x=b=c+a-f)),v=-v,f=-f,R=f,j=-v);var G=Mh(u,.7),Z=l.createLinearGradient(P,z,F,q);Z.addColorStop(0,u),Z.addColorStop(.3,G),Z.addColorStop(.7,G),Z.addColorStop(1,u);for(var se=1;se<=4;se++){var oe=0;for(se<4&&l.beginPath(),se%2===0?(T=b,D=C,N=w,A=E):(T=g,D=y,N=x,A=M),se===4&&(f=R,v=j,l.fillStyle=Z),se>2&&(oe=X,p=O);oe<=p;oe+=.1)L=T-f*Math.cos(oe),k=D+v*Math.sin(oe),oe===0?l.moveTo(L,k):l.lineTo(L,k);se>2&&l.lineTo(N,A),se!==3&&(l.stroke(),l.fill())}e.id.indexOf("Series")>=0&&(l.clip(),l.restore(),l=h)}else{var fe=n.chart,c=r.x,d=r.y,be=e.id,u=e.fill,Ne=u,we=DG(u);we||(u=qn(u));var H=0,V=0,re=0,he=0,Ie=0,Te=0,rt=void 0,Tt=void 0,si=void 0,K=void 0,ue=void 0,Me=void 0,f=void 0,v=void 0,oe=2;for(i.isColumn?(f=a/2,v=f/4,rt=si=c,Tt=v<d?d-v:i.stacking?d+v:d-v,K=Tt,H=2*f,he=v<d||o<2*v?o:i.stacking?o-2*v:o,ue=rt,Me=v<d?Tt+o:o<Tt?o+Tt:i.stacking?o+(d-v):o+Tt,Ie=100,i.stacking&&(i.isLastSeries||(Tt=K=d+v,he=o<f/2?o:o-f/2))):(v=o/2,f=v/4,Tt=K=d,rt=si=Math.abs(c-f),V=2*v,re=a,ue=rt+a,Me=Tt,Te=100,i.stacking&&(i.isLastSeries||(ue=rt+a-f*2,re=a-f*2))),pt(this.element);oe--;)e.d="M"+rt.toString()+","+Tt.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+H.toString()+","+V.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+(-1*H).toString()+","+(-1*V).toString(),e.id=be+"_Region_"+oe,e.fill=Mh(u,.9),oe%2===0&&n.type!=="StackingBar100"&&n.type!=="StackingBar"&&n.type!=="Bar"&&(e.fill=e.fill+"10"),this.element=fe.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),Mt(n.chart.enableCanvas,n.seriesElement,this.element,fe.redraw),rt=ue,Tt=Me;e.d="M"+si.toString()+","+K.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+H.toString()+","+V.toString()+"l"+re.toString()+" "+he.toString()+"a"+f.toString()+","+v.toString()+" 0 1,1 "+(-1*H).toString()+","+(-1*V).toString()+" z",e.id=be+"_Region_2",e.fill=Mh(u,.7);var Ae=void 0;if(Ne.indexOf("url")===-1){if(!document.getElementById(be)){Ae={id:be,x1:"0%",y1:"0%",x2:Ie.toString()+"%",y2:Te.toString()+"%"};var Be=[{colorStop:"0%",color:u},{colorStop:"30%",color:Mh(u,.7)},{colorStop:"70%",color:Mh(u,.7)},{colorStop:"100%",color:u}];this.drawGradient(Ae,Be,n)}e.fill="url(#"+Ae.id+")"}this.element=fe.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),Mt(n.chart.enableCanvas,n.seriesElement,this.element,fe.redraw)}},s.prototype.drawGradient=function(e,t,i){var r=i.chart,n=r.renderer.createDefs(),a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"linearGradient");o.setAttribute("id",e.id),o.setAttribute("x1",e.x1),o.setAttribute("y1",e.y1),o.setAttribute("x2",e.x2),o.setAttribute("y2",e.y2);for(var l=0;l<t.length;l++){var h=document.createElementNS(a,"stop");h.setAttribute("offset",t[l].colorStop),h.setAttribute("stop-color",t[l].color),h.setAttribute("stop-opacity","1"),o.appendChild(h)}i.seriesElement.appendChild(n),n.appendChild(o)},s.prototype.getSideBySidePositions=function(e){for(var t=e.chart,i=0,r=t.columns;i<r.length;i++)for(var n=r[i],a=0,o=t.rows;a<o.length;a++){var l=o[a];this.findRectPosition(e.findSeriesCollection(n,l,!1))}},s.prototype.findRectPosition=function(e){for(var t=[],i={rectCount:0,position:null},r=0;r<e.length;r++){var n=e[r];if(n.type.indexOf("Stacking")!==-1||n.groupName!==""){var a=n.type.indexOf("Stacking")!==-1?n.stackingGroup:n.type+n.groupName;a?t[a]===void 0?(n.position=i.rectCount,t[a]=i.rectCount++):n.position=t[a]:i.position===null?(n.position=i.rectCount,i.position=i.rectCount++):n.position=i.position}else n.position=i.rectCount++}for(var r=0;r<e.length;r++){var n=e[r];n.rectCount=i.rectCount}},s.prototype.updateSymbolLocation=function(e,t,i){i.chart.requireInvertedAxis?this.updateYRegion(e,t,i):this.updateXRegion(e,t,i),i.type==="Histogram"&&(e.minimum=+e.x-i.histogramValues.binWidth/2,e.maximum=+e.x+i.histogramValues.binWidth/2)},s.prototype.updateXRegion=function(e,t,i){e.symbolLocations.push({x:t.x+t.width/2,y:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||e.yValue>=0==!i.yAxis.isAxisInverse?t.y:t.y+t.height}),this.getRegion(e,t,i),i.type==="RangeColumn"&&e.symbolLocations.push({x:t.x+t.width/2,y:t.y+t.height})},s.prototype.updateYRegion=function(e,t,i){e.symbolLocations.push({x:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||e.yValue>=0==!i.yAxis.isAxisInverse?t.x+t.width:t.x,y:t.y+t.height/2}),this.getRegion(e,t,i),i.type==="RangeColumn"&&e.symbolLocations.push({x:t.x,y:t.y+t.height/2})},s.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},s.prototype.getRegion=function(e,t,i){if(e.y===0){var r=i.marker&&i.marker.width?i.marker.width:0,n=i.marker&&i.marker.height?i.marker.height:0;e.regions.push(new Ve(e.symbolLocations[0].x-r,e.symbolLocations[0].y-n,2*r,2*n))}else e.regions.push(t)},s.prototype.triggerEvent=function(e,t,i,r){var n={cancel:!1,name:uh,series:e,point:t,fill:e.setPointColor(t,i),border:e.setBorderColor(t,r)};return e.chart.trigger(uh,n),t.color=n.fill,n},s.prototype.drawRectangle=function(e,t,i,r){var n=e.chart,a=n.requireInvertedAxis?i.height:i.width;if(a<=0)return null;var o;t.y===0?o=this.calculateRoundedRectPath(i,0,0,0,0):o=this.calculateRoundedRectPath(i,e.cornerRadius.topLeft,e.cornerRadius.topRight,e.cornerRadius.bottomLeft,e.cornerRadius.bottomRight);var l=e.category==="Indicator"?n.element.id+"_Indicator_"+e.index+"_"+e.name+"_Point_"+t.index:n.element.id+"_Series_"+e.index+"_Point_"+t.index,h=ga(n.redraw,l),u=h?h.getAttribute("d"):"";switch(this.options=new Er(l,r.fill,r.border.width,r.border.color,e.opacity,e.dashArray,e.columnFacet==="Cylinder"?"":o),this.element=n.renderer.drawPath(this.options,new Int32Array([e.clipRect.x,e.clipRect.y])),e.seriesType){case"XY":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",t.x+":"+t.yValue+", "+e.name);break;case"HighLow":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",t.x+":"+t.high+", "+t.low+", "+e.name);break}Mt(e.chart.enableCanvas,e.seriesElement,this.element,n.redraw),e.chart.enableCanvas||Nb(this.element,e.columnFacet==="Cylinder"?"":o,n.redraw,u,n.duration)},s.prototype.animate=function(e){for(var t=e.seriesElement.childNodes,i=e.category==="Indicator"?0:1,r=jh(e),n=0,a=r;n<a.length;n++){var o=a[n];if(!(!o.symbolLocations.length&&!(e.type==="BoxAndWhisker"&&o.regions.length)))if((e.type==="Column"||e.type==="Bar"||e.type==="StackingColumn"||e.type==="StackingColumn100"||e.type==="StackingBar"||e.type==="StackingBar100")&&e.columnFacet==="Cylinder")for(var l=0;l<t.length;l++)this.animateRect(t[l],e,o);else this.animateRect(t[i],e,o),i++}},s.prototype.animateRect=function(e,t,i){var r=t.animation,n=t.chart.animated?t.chart.duration:r.duration,a=qI("Linear"),o=i.yValue<0,l,h,u=+i.regions[0].height,c=+i.regions[0].width,d,p;t.chart.requireInvertedAxis?(h=+i.regions[0].y,t.type.indexOf("Stacking")>-1?(l=mn(0,t.yAxis)*t.yAxis.rect.width,d=l,p=h):(l=+i.regions[0].x,p=o?h:h+u,d=t.seriesType.indexOf("HighLow")!==-1||t.type.indexOf("Waterfall")!==-1?l+c/2:o!==t.yAxis.isAxisInverse?l+c:l)):(l=+i.regions[0].x,t.type.indexOf("Stacking")>-1?(h=(1-mn(0,t.yAxis))*t.yAxis.rect.height,d=l,p=h):(h=+i.regions[0].y,p=t.seriesType.indexOf("HighLow")!==-1||t.type.indexOf("Waterfall")!==-1?h+u/2:o!==t.yAxis.isAxisInverse?h:h+u,d=o?l:l+c));var f;m(e)||(e.style.visibility="hidden",new ri({}).animate(e,{duration:n===0&&vi==="Enable"?1e3:n,delay:r.delay,progress:function(v){v.timeStamp>=v.delay&&(e.style.visibility="visible",t.chart.requireInvertedAxis?(c=c||1,f=a(v.timeStamp-v.delay,0,c,v.duration),e.setAttribute("transform","translate("+d+" "+p+") scale("+f/c+", 1) translate("+-d+" "+-p+")")):(u=u||1,f=a(v.timeStamp-v.delay,0,u,v.duration),e.setAttribute("transform","translate("+d+" "+p+") scale(1,"+f/u+") translate("+-d+" "+-p+")")))},end:function(){e.setAttribute("transform","translate(0,0)");var v=t.seriesElement;if((e===v.lastElementChild||i.index===t.points.length-1||t.type==="Waterfall"&&e===v.children[v.childElementCount-2])&&(t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t}),t.type==="Waterfall"))for(var g=v.childNodes,b=0;b<g.length;b++)g[b].id.indexOf("Connector")!==-1&&(g[b].style.visibility="visible",g[b].setAttribute("transform","translate(0,0)"))}}))},s.prototype.calculateRoundedRectPath=function(e,t,i,r,n){return"M "+e.x+" "+(t+e.y)+" Q "+e.x+" "+e.y+" "+(e.x+t)+" "+e.y+" L "+(e.x+e.width-i)+" "+e.y+" Q "+(e.x+e.width)+" "+e.y+" "+(e.x+e.width)+" "+(e.y+i)+" L "+(e.x+e.width)+" "+(e.y+e.height-n)+" Q "+(e.x+e.width)+" "+(e.y+e.height)+" "+(e.x+e.width-n)+" "+(e.y+e.height)+" L "+(e.x+r)+" "+(e.y+e.height)+" Q "+e.x+" "+(e.y+e.height)+" "+e.x+" "+(e.y+e.height-r)+" L "+e.x+" "+(t+e.y)+" Z"},s}(),a$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),o$=function(s){a$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t){for(var i=this.getSideBySideInfo(t),r=Math.max(t.yAxis.visibleRange.min,0),n,a=0,o=t.points;a<o.length;a++){var l=o[a];if(l.symbolLocations=[],l.regions=[],l.visible&&Jo(t.points[l.index-1],l,t.points[l.index+1],t)){this.rect=this.getRectangle(l.xValue+i.start,l.yValue,l.xValue+i.end,r,t),this.rect.width=t.columnWidthInPixel?t.columnWidthInPixel-(t.chart.enableSideBySidePlacement?t.columnWidthInPixel*t.columnSpacing:0):this.rect.width,this.rect.x=t.columnWidthInPixel?this.rect.x-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.index):this.rect.x;var h=t.category==="Indicator"?l.color:t.interior;if(n=this.triggerEvent(t,l,h,{width:t.border.width,color:t.border.color}),!n.cancel&&(this.updateSymbolLocation(l,this.rect,t),this.drawRectangle(t,l,this.rect,n),t.columnFacet==="Cylinder")){var u={isColumn:!0,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,u,this.rect,t)}}}this.renderMarker(t)},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.getModuleName=function(){return"ColumnSeries"},e.prototype.destroy=function(){},e}(Rb),l$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),h$=function(s){l$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.getAreaPathDirection=function(t,i,r,n,a,o,l){var h="",u;return o===null&&(u=a(t,i,r.xAxis,r.yAxis,n,r),h+=l+" "+u.x+" "+u.y+" "),h},e.prototype.getAreaEmptyDirection=function(t,i,r,n,a){var o="";return o+=this.getAreaPathDirection(t.x,t.y,r,n,a,null,"L"),o+=this.getAreaPathDirection(i.x,i.y,r,n,a,null,"L"),o},e.prototype.setPointColor=function(t,i,r,n,a){if(r.pointColorMapping===""){for(var o=void 0,l=void 0,h=0;h<a.length;h++)if(o=a[h],l=n?t.xValue:t.yValue,l<=this.getAxisValue(o.value,n?r.xAxis:r.yAxis,r.chart)||!o.value&&o.value!==0){t.interior=o.color;break}return t.interior==null&&(t.interior=r.interior),!1}else return i?r.setPointColor(t,r.interior)!==r.setPointColor(i,r.interior):!1},e.prototype.sortSegments=function(t,i){var r=this,n=t.segmentAxis==="X"?t.xAxis:t.yAxis,a=[].concat(i);return a.sort(function(o,l){return r.getAxisValue(o.value,n,t.chart)-r.getAxisValue(l.value,n,t.chart)})},e.prototype.applySegmentAxis=function(t,i,r){var n=this;if(t.pointColorMapping!=="")return i.map(function(y){n.appendLinePath(y,t,"")}),null;var a=t.segmentAxis==="X",o=a?t.xAxis:t.yAxis,l=t.chart,h;this.includeSegment(r,o,t,r.length);for(var u=r.length,c,d,p,f=0,v=function(y){h=r[y],c=g.getAxisValue(h.value,o,t.chart),d=g.createClipRect(y?g.getAxisValue(r[y-1].value,o,t.chart):o.visibleRange.min,c,t,y,a),d&&i.map(function(C){f+=1,p={"clip-path":d,"stroke-dasharray":h.dashArray,opacity:C.opacity,stroke:t.type.indexOf("Line")>-1?h.color||t.interior:C.stroke,"stroke-width":C["stroke-width"],fill:t.type.indexOf("Line")>-1?"none":h.color||t.interior,id:C.id+"_Segment_"+y,d:C.d},f%2===0&&n.chart.multiColoredAreaSeriesModule&&t.border.color!=="transparent"&&p["stroke-width"]!==0&&(p.fill="transparent"),Nb(Qe(p.id),p.d,l.redraw),t.pathElement=l.renderer.drawPath(p),t.chart.enableCanvas||t.seriesElement.appendChild(l.renderer.drawPath(p))})},g=this,b=0;b<u;b++)v(b)},e.prototype.includeSegment=function(t,i,r,n){if(n<=0)return t.push({value:i.visibleRange.max,color:r.interior}),null;this.getAxisValue(t[n-1].value,i,r.chart)<i.visibleRange.max&&t.push({value:i.visibleRange.max,color:r.interior})},e.prototype.createClipRect=function(t,i,r,n,a){var o=r.chart.requireInvertedAxis,l=Yn(a?t:r.xAxis.visibleRange.min,a?r.yAxis.visibleRange.max:i,r.xAxis,r.yAxis,o),h=Yn(a?i:r.xAxis.visibleRange.max,a?r.yAxis.visibleRange.min:t,r.xAxis,r.yAxis,o);h=o?[l,l=h][0]:h;var u;return(r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x>0:h.x-l.x>0)&&(r.yAxis.isInversed?l.y-h.y>0:h.y-l.y>0)?(u=new aa(r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n,"transparent",{width:1,color:"Gray"},1,{x:r.xAxis.isInversed||r.xAxis.isAxisInverse?h.x:l.x,y:r.yAxis.isInversed?h.y:l.y,width:r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x:h.x-l.x,height:r.yAxis.isInversed?l.y-h.y:h.y-l.y}),r.chart.enableCanvas||r.seriesElement.appendChild(Cu(r.chart.redraw,u,r.chart.renderer)),"url(#"+r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n+")"):null},e.prototype.getAxisValue=function(t,i,r){if(t===null&&(t=i.visibleRange.max),i.valueType==="DateTime"){var n={skeleton:"full",type:"dateTime"};return Date.parse(r.intl.getDateParser(n)(r.intl.getDateFormat(n)(new Date(ce.parse.parseJson({val:t}).val))))}else if(i.valueType.indexOf("Category")>-1){var a=i.valueType==="DateTimeCategory"?t.getTime().toString():t;return i.labels.indexOf(a)<0?+t:i.labels.indexOf(a)}else return+t},e}(Ob),u$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),c$=function(s){u$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n){var a=null,o="",l=t.chart&&t.chart.chartAreaType==="PolarRadar",h=Math.max(t.yAxis.visibleRange.min,0);if(l){var u=this.getFirstLastVisiblePoint(t.points);h=u.first.yValue}for(var c,d=t.emptyPointSettings&&t.emptyPointSettings.mode==="Drop",p=t.border.width?t.border.width:0,f=t.border.color?t.border.color:t.interior,v=t.chart.chartAreaType==="PolarRadar"?kv:Yn,g=this.enableComplexProperty(t),b,y="",C=0;C<g.length;C++)b=g[C],c=b.xValue,b.symbolLocations=[],b.regions=[],b.visible&&Jo(g[C-1],b,g[C+1],t)&&(o+=this.getAreaPathDirection(c,h,t,n,v,a,"M"),a=a||new ut(c,h),o+=this.getAreaPathDirection(c,b.yValue,t,n,v,null,"L"),g[C+1]&&!g[C+1].visible&&(!l||l&&this.withinYRange(g[C+1],r))&&!d&&(o+=this.getAreaEmptyDirection({x:c,y:h},a,t,n,v),a=null),this.storePointLocation(b,t,n,v));if(l&&o!==""){var x="",w=this.chart;x+=this.getAreaPathDirection(0,h,t,n,v,null,"L"),(i.isAxisInverse||r.isAxisInverse)&&(o+=t.type==="Polar"?w.polarSeriesModule.getPolarIsInversedPath(i,x):w.radarSeriesModule.getRadarIsInversedPath(i,x)),o=o.concat(o+" Z")}this.appendLinePath(new Er(t.chart.element.id+"_Series_"+t.index,t.interior,0,"transparent",t.opacity,t.dashArray,t.points.length>1&&o!==""?o+this.getAreaPathDirection(t.points[t.points.length-1].xValue,t.chart.chartAreaType==="PolarRadar"?t.points[t.points.length-1].yValue:h,t,n,v,null,"L"):""),t,""),t.border.width!==0&&(y=this.removeEmptyPointsBorder(o),this.appendLinePath(new Er(t.chart.element.id+"_Series_border_"+t.index,"transparent",p,f,1,t.dashArray,y),t,"")),this.renderMarker(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"AreaSeries"},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e}(h$),d$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),p$=function(s){d$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t){for(var i=Math.max(t.yAxis.visibleRange.min,0),r=this.getSideBySideInfo(t),n,a=0,o=t.points;a<o.length;a++){var l=o[a];if(l.symbolLocations=[],l.regions=[],l.visible&&Jo(t.points[l.index-1],l,t.points[l.index+1],t)&&(this.rect=this.getRectangle(l.xValue+r.start,l.yValue,l.xValue+r.end,i,t),this.rect.height=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.height,this.rect.y=t.columnWidthInPixel?this.rect.y-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.index):this.rect.y,n=this.triggerEvent(t,l,t.interior,{width:t.border.width,color:t.border.color}),!n.cancel&&(this.updateSymbolLocation(l,this.rect,t),this.drawRectangle(t,l,this.rect,n),t.columnFacet==="Cylinder"))){var h={isColumn:!1,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,h,this.rect,t)}}this.renderMarker(t)},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"BarSeries"},e}(Rb),f$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),v$=function(s){f$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t){for(var i=this.getSideBySideInfo(t),r=t.stackedValues,n,a=0,o=t.points;a<o.length;a++){var l=o[a];if(l.symbolLocations=[],l.regions=[],l.visible&&Jo(t.points[l.index-1],l,t.points[l.index+1],t)&&(this.rect=this.getRectangle(l.xValue+i.start,r.endValues[l.index],l.xValue+i.end,r.startValues[l.index],t),this.rect.height=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.height,this.rect.y=t.columnWidthInPixel?this.rect.y-t.columnWidthInPixel/2:this.rect.y,n=this.triggerEvent(t,l,t.interior,{width:t.border.width,color:t.border.color}),!n.cancel&&(this.drawRectangle(t,l,this.rect,n),this.updateSymbolLocation(l,this.rect,t),t.columnFacet==="Cylinder"))){var h={isColumn:!1,stacking:t.type==="StackingBar100",isLastSeries:!0};this.drawCylinder(this.options,this.element,h,this.rect,t)}}this.renderMarker(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingBarSeries"},e.prototype.doAnimation=function(t){this.animate(t)},e}(Rb),m$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),g$=function(s){m$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t){t.isRectSeries=!0;for(var i=this.getSideBySideInfo(t),r,n=t.stackedValues,a=jh(t),o=0,l=a;o<l.length;o++){var h=l[o];if(h.symbolLocations=[],h.regions=[],h.visible&&Jo(a[h.index-1],h,a[h.index+1],t)&&(this.rect=this.getRectangle(h.xValue+i.start,n.endValues[h.index],h.xValue+i.end,n.startValues[h.index],t),this.rect.width=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.width,this.rect.x=t.columnWidthInPixel?this.rect.x-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.position):this.rect.x,r=this.triggerEvent(t,h,t.interior,{width:t.border.width,color:t.border.color}),!r.cancel&&(this.drawRectangle(t,h,this.rect,r),this.updateSymbolLocation(h,this.rect,t),t.columnFacet==="Cylinder"))){var u={isColumn:!0,stacking:t.type==="StackingColumn100",isLastSeries:!0};this.drawCylinder(this.options,this.element,u,this.rect,t)}}this.renderMarker(t)},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingColumnSeries"},e}(Rb),y$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),b$=function(s){y$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n){var a=t.chart.chartAreaType==="PolarRadar",o=a?kv:Yn,l="",h=this.enableComplexProperty(t),u=h.length,c=t.stackedValues,d,p,f=a?Math.max(t.yAxis.visibleRange.min,c.endValues[0]):Math.max(t.yAxis.visibleRange.min,c.startValues[0]),v=0,g,b,y="";u>0&&(g=o(h[0].xValue,f,i,r,n,t),l=l.concat("M "+g.x+" "+g.y+" "));for(var C=t.chart&&t.chart.chartAreaType==="PolarRadar",x=0;x<u;x++)if(d=h[x].index,h[x].symbolLocations=[],h[x].regions=[],h[x].visible&&Jo(h[x-1],h[x],h[x+1],t))g=o(h[x].xValue,c.endValues[d],i,r,n,t),l=l.concat("L "+g.x+" "+g.y+" "),h[x].symbolLocations.push(o(h[x].xValue,c.endValues[d],i,r,n,t)),h[x].regions.push(new Ve(h[x].symbolLocations[0].x-t.marker.width,h[x].symbolLocations[0].y-t.marker.height,2*t.marker.width,2*t.marker.height));else if(!C&&t.emptyPointSettings.mode!=="Drop"){for(var w=x-1;w>=v;w--)d=h[w].index,b=o(h[w].xValue,c.startValues[d],i,r,n,t),l=l.concat("L "+b.x+" "+b.y+" ");h[x+1]&&h[x+1].visible&&(!C||C&&this.withinYRange(h[x+1],r))&&(p=h[x+1].index,g=o(h[x+1].xValue,c.startValues[p],i,r,n,t),l=l.concat("M "+g.x+" "+g.y+" ")),v=x+1}if(t.chart.chartAreaType==="PolarRadar"&&h.length>1){var M=this.getFirstLastVisiblePoint(t.points),E=this.chart;g={x:M.first.xValue,y:c.endValues[M.first.index]},b=o(g.x,g.y,i,r,n,t),l+="L "+b.x+" "+b.y+" ",this.chart.visible===1&&(i.isAxisInverse||r.isAxisInverse)&&(this.chart.enableAnimation=!1,l=t.type==="Polar"?E.polarSeriesModule.getPolarIsInversedPath(i,l):E.radarSeriesModule.getRadarIsInversedPath(i,l))}if(!C||C&&t.index!==this.getFirstSeriesIndex(t.chart.visibleSeries)){for(var w=u-1;w>=v;w--)if(d=h[w].index,!(C&&!h[w].visible)){var T=this.getPreviousSeries(t);(T.emptyPointSettings.mode!=="Drop"||!T.points[w].isEmpty)&&(b=o(h[w].xValue,c.startValues[d],i,r,n,t),c.startValues[d]===c.endValues[d]&&(b.y=Math.floor(b.y)),l=l.concat((w===u-1&&a?"M":"L")+" "+b.x+" "+b.y+" "))}}var D=new Er(t.chart.element.id+"_Series_"+t.index,t.interior,0,"transparent",t.opacity,t.dashArray,l);if(this.appendLinePath(D,t,""),t.border.width!==0){y=this.removeEmptyPointsBorder(this.getBorderDirection(l));var N=new Er(t.chart.element.id+"_Series_border_"+t.index,"transparent",t.border.width,t.border.color?t.border.color:t.interior,1,t.dashArray,y);this.appendLinePath(N,t,"")}this.renderMarker(t)},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingAreaSeries"},e.prototype.getPreviousSeries=function(t){for(var i=t.chart.visibleSeries,r=0,n=i.length;r<n;r++)if(t.index===i[r].index&&r!==0)return i[r-1];return i[0]},e.prototype.getFirstSeriesIndex=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.visible)return n.index}return 0},e}(Ob),C$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),S$=function(s){C$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n){for(var a=t.chart.chartAreaType==="PolarRadar",o=a?kv:Yn,l="",h=this.enableComplexProperty(t),u=h.length,c=t.stackedValues,d,p,f,v,g=0;g<u;g++)h[g].regions=[],h[g].symbolLocations=[],d=h[g].index,h[g].visible&&Jo(h[g-1],h[g],h[g+1],t)?(f=o(h[g].xValue,c.endValues[d],i,r,n,t),l=l.concat((g?"L":"M")+" "+f.x+" "+f.y+" "),h[g].symbolLocations.push(o(h[g].xValue,c.endValues[d],i,r,n,t)),h[g].regions.push(new Ve(h[g].symbolLocations[0].x-t.marker.width,h[g].symbolLocations[0].y-t.marker.height,2*t.marker.width,2*t.marker.height))):t.emptyPointSettings.mode!=="Drop"&&h[g+1]&&h[g+1].visible&&(p=h[g+1].index,f=o(h[g+1].xValue,c.endValues[p],i,r,n,t),l=l.concat("M "+f.x+" "+f.y+" "));t.chart.chartAreaType==="PolarRadar"&&h.length>1&&(f={y:c.endValues[0],x:t.points[0].xValue},v=o(f.x,f.y,i,r,n,t),l+="L "+v.x+" "+v.y+" ");var b=new Er(t.chart.element.id+"_Series_"+t.index,"none",t.width,t.interior,t.opacity,t.dashArray,l);this.appendLinePath(b,t,""),this.renderMarker(t)},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingLineSeries"},e}(Ob),x$=function(){function s(){}return s.prototype.render=function(e,t,i,r){e.isRectSeries=!1;for(var n=e.marker,a=this.enableComplexProperty(e),o,l=e.chart.chartAreaType==="PolarRadar"?kv:Yn,h,u=e.chart.redraw,c={width:this.isLineShapeMarker(n.shape)?e.width:e.border.width,color:this.isLineShapeMarker(n.shape)?e.interior:e.border.color},d=0,p=a;d<p.length;d++){var f=p[d];h=u&&f.symbolLocations?f.symbolLocations[0]:null,f.symbolLocations=[],f.regions=[],f.visible&&Jo(a[f.index-1],f,a[f.index+1],e)&&(o={cancel:!1,name:uh,series:e,point:f,fill:e.setPointColor(f,e.interior),border:e.setBorderColor(f,c),height:n.height,width:n.width,shape:n.shape},e.chart.trigger(uh,o),o.cancel?f.marker={visible:!0}:(f.symbolLocations.push(l(f.xValue,f.yValue,t,i,r,e)),f.color=o.fill,this.refresh(e,f,o,h)))}},s.prototype.isLineShapeMarker=function(e){return e==="HorizontalLine"||e==="VerticalLine"||e==="Cross"},s.prototype.enableComplexProperty=function(e){for(var t=[],i=[],r=e.yAxis.visibleRange,n=e.xAxis.visibleRange,a=e.clipRect,o=e.points,l=Math.abs(r.delta/a.height),h=Math.abs(n.delta/a.width),u=o[0]&&o[0].y>l?0:l,c=o[0]&&o[0].x>h?0:h,d=0,p=0,f=0,v=o;f<v.length;f++){var g=v[f];g.symbolLocations=[],d=g.yValue?g.yValue:r.min,p=g.xValue?g.xValue:n.min,(Math.abs(u-d)>=l||Math.abs(c-p)>=h)&&(i.push(g),u=d,c=p)}for(var b,y=0;y<i.length;y++)b=i[y],!(m(b.x)||b.x==="")&&t.push(b);return t},s.prototype.refresh=function(e,t,i,r){var n=e.chart,a,o,l=e.marker,h=i.point.marker.imageUrl||l.imageUrl,u=new Er(n.element.id+"_Series_"+e.index+"_Point_"+t.index,i.fill,i.border.width,e.chart.enableCanvas&&!i.border.color?i.fill:i.border.color,e.opacity,null);n.redraw&&Qe(u.id)&&(a=i.shape==="Circle"?"c":"",o=Qe(u.id).getAttribute("d"));var c=gs(t.symbolLocations[0],i.shape,new ei(i.width,i.height),h,u,t.x.toString()+":"+t.yValue.toString(),e.chart.renderer,e.clipRect);Mt(e.chart.enableCanvas,e.seriesElement,c,n.redraw,!0,a+"x",a+"y",r,o,!1,!1,null,null,!0),t.regions.push(new Ve(t.symbolLocations[0].x-l.width,t.symbolLocations[0].y-l.height,2*l.width,2*l.height)),t.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:h}},s.prototype.doAnimation=function(e){for(var t=e.animation.duration,i=e.animation.delay,r=e.seriesElement.childNodes,n=1,a=0,o=e.points;a<o.length;a++){var l=o[a];!l.symbolLocations.length||!r[n]||(cv(r[n],i,t,e,l.index,l.symbolLocations[0],!1),n++)}},s.prototype.getModuleName=function(){return"ScatterSeries"},s.prototype.destroy=function(){},s}(),w$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),W2=function(s){w$(e,s);function e(t){var i=s.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i.template=t.tooltip.template,i}return e.prototype.getElement=function(t){return document.getElementById(t)},e.prototype.getTooltipElement=function(t){this.inverted=this.chart.requireInvertedAxis,this.header=this.control.tooltip.header===null?this.control.tooltip.shared?"${point.x}":"${series.name}":this.control.tooltip.header,this.formattedText=[];var i=document.getElementById(this.chart.element.id+"_tooltip"),r=this.chart.element.id.indexOf("stockChart")>-1;return!t&&!i||r?this.createElement():null},e.prototype.createElement=function(){var t=document.createElement("div");return t.id=this.element.id+"_tooltip",t.className="ejSVGTooltip",t.style.pointerEvents="none",t.style.position="absolute",t.style.zIndex="1",t},e.prototype.pushData=function(t,i,r,n,a){return t.series.enableTooltip?(a?this.currentPoints.push(t):n?this.currentPoints.push(t):this.currentPoints.push(t),this.stopAnimation(),r&&!document.getElementById(r.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(r):document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),!0):!1},e.prototype.removeHighlight=function(){for(var t,i=0,r=this.previousPoints.length;i<r;i++){if(t=this.previousPoints[i],t.series.isRectSeries){t.series.visible&&this.highlightPoint(t.series,t.point.index,!1);continue}t.series}},e.prototype.highlightPoint=function(t,i,r){var n=this.getElement(this.element.id+"_Series_"+t.index+"_Point_"+i),a=this.control.accumulationSelectionModule,o=!!(a&&a.selectedDataIndexes.length>0);n&&(!o||o&&n.getAttribute("class")&&n.getAttribute("class").indexOf("_ej2_chart_selection_series_")===-1?this.chart.highlightColor!==""&&!m(this.chart.highlightColor)?n.setAttribute("fill",r&&this.chart.highlightColor!=="transparent"?this.chart.highlightColor:t.pointColorMapping!==""?t.points[0].color:t.points[i].color||t.interior):n.setAttribute("opacity",(r&&this.chart.highlightColor!=="transparent"?t.opacity/2:t.opacity).toString()):n.setAttribute("opacity",t.opacity.toString()))},e.prototype.highlightPoints=function(){for(var t=0,i=this.currentPoints;t<i.length;t++){var r=i[t];r.series.isRectSeries&&r.series.category==="Series"&&this.highlightPoint(r.series,r.point.index,!0)}},e.prototype.createTooltip=function(t,i,r,n,a,o,l,h,u,c,d,p){u===void 0&&(u=!1),c===void 0&&(c=null),d===void 0&&(d=null);var f=this.currentPoints[0].series,v=t.tooltipModule||t.tooltip3DModule||t.accumulationTooltipModule;if(!v||r===null){di(this.chart.element.id+"_tooltip");return}i?(this.svgTooltip=new QQ({opacity:t.tooltip.opacity?t.tooltip.opacity:this.chart.theme==="Material3"||this.chart.theme==="Material3Dark"?1:.75,header:this.headerText,content:this.text,fill:t.tooltip.fill,border:t.tooltip.border,enableAnimation:t.tooltip.enableAnimation,location:r,shared:this.control.tooltip.shared,crosshair:u,shapes:o,clipBounds:this.chart.chartAreaType==="PolarRadar"?new ut(0,0):n,areaBounds:h,palette:this.findPalette(),template:p||this.template,data:d,theme:t.theme,offset:l,textStyle:t.tooltip.textStyle,isNegative:f.isRectSeries&&f.type!=="Waterfall"&&a&&a.y<0,inverted:this.chart.requireInvertedAxis&&f.isRectSeries,arrowPadding:this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,availableSize:t.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isFixed:this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null,isTextWrap:t.tooltip.enableTextWrap&&t.getModuleName()==="chart",blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,enableRTL:t.enableRtl,controlName:"Chart",allowHighlight:t.getModuleName()==="chart"&&!f.marker.allowHighlight,tooltipRender:function(){v.removeHighlight(),v.highlightPoints(),v.updatePreviousPoint(c)},animationComplete:function(g){g.tooltip.fadeOuted&&v.fadeOut(v.previousPoints)}}),this.svgTooltip.appendTo(this.getElement(this.element.id+"_tooltip"))):this.svgTooltip&&(this.svgTooltip.location=r,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=l,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=o,this.svgTooltip.data=d,this.svgTooltip.template=this.template,this.svgTooltip.controlName="Chart",this.svgTooltip.crosshair=u,this.svgTooltip.textStyle=t.tooltip.textStyle,this.svgTooltip.isNegative=f.isRectSeries&&f.type!=="Waterfall"&&a&&a.y<0,this.svgTooltip.clipBounds=this.chart.chartAreaType==="PolarRadar"?new ut(0,0):n,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,this.svgTooltip.allowHighlight=t.getModuleName()==="chart"&&!f.marker.allowHighlight,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates()},e.prototype.findPalette=function(){for(var t=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];t.push(this.findColor(n,n.series))}return t},e.prototype.findColor=function(t,i){return i.isRectSeries&&(i.type==="Candle"||i.type==="Hilo"||i.type==="HiloOpenClose")?t.point.color:(t.point.color&&t.point.color!=="#ffffff"?t.point.color:t.point.interior)||i.marker.fill||i.interior},e.prototype.updatePreviousPoint=function(t){t&&(this.currentPoints=this.currentPoints.concat(t)),this.previousPoints=me([],this.currentPoints,null,!0)},e.prototype.fadeOut=function(t){var i=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg"),r=i&&parseInt(i.getAttribute("opacity"),10)>0;r||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(t,!0),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},e.prototype.removeHighlightedMarker=function(t,i){if(this.chart.markerRender)for(var r=0,n=t;r<n.length;r++){var a=n[r];di(this.element.id+"_Series_"+a.series.index+"_Point_"+a.point.index+"_Trackball"),this.chart.markerRender.removeHighlightedMarker(a.series,a.point,i)}this.previousPoints=[]},e.prototype.removeText=function(){this.textElements=[];var t=this.getElement(this.element.id+"_tooltip_group");if(t&&t.childNodes.length>0)for(;t.lastChild&&t.childNodes.length!==1;)t.removeChild(t.lastChild)},e.prototype.stopAnimation=function(){L2(this.toolTipInterval)},e.prototype.removeTooltip=function(t){var i=this,r=this.getElement(this.element.id+"_tooltip"),n=r?this.getElement(r.id+"parent_template"):null;n&&n.innerText,this.stopAnimation(),r&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){i.svgTooltip&&i.svgTooltip.fadeOut()},t))},e}(GI),M$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),E$=function(s){M$(e,s);function e(t){var i=s.call(this,t)||this;return i.commonXvalues=[],i.addEventListener(),i}return e.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var t=B.isPointer?"pointerleave":"mouseleave";this.chart.on(t,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this),this.chart.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(B.touchEndEvent,this.mouseUpHandler,this)}},e.prototype.mouseUpHandler=function(){var t=this.control,i=this.getData();i.lierIndex=this.lierIndex,t.isTouch&&!this.isSelected(t)&&(Mn(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&t.tooltip.shared||!t.tooltip.shared)?t.crosshair.enable?t.startMove&&t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(2e3):(this.tooltip(),t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(t.tooltip.fadeOutDuration)):!this.findData(i,this.previousPoints[0])&&t.tooltip.fadeOutMode==="Click"&&this.removeTooltip(0)},e.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)},e.prototype.mouseMoveHandler=function(){var t=this.chart;t.mouseX=t.mouseX/t.scaleX,t.mouseY=t.mouseY/t.scaleY,t.stockChart&&t.stockChart.onPanning&&(t.mouseY<t.chartAxisLayoutPanel.seriesClipRect.y?t.mouseY=t.chartAxisLayoutPanel.seriesClipRect.y:t.mouseY>t.chartAxisLayoutPanel.seriesClipRect.y+t.chartAxisLayoutPanel.seriesClipRect.height&&(t.mouseY=t.chartAxisLayoutPanel.seriesClipRect.y+t.chartAxisLayoutPanel.seriesClipRect.height)),!t.disableTrackTooltip&&!this.isSelected(t)&&(!t.tooltip.shared&&(!t.isTouch||t.startMove)&&this.tooltip(),Mn(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?t.tooltip.shared&&(!t.isTouch||t.startMove)&&this.tooltip():t.tooltip.shared&&t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))},e.prototype.longPress=function(){var t=this.chart;return t.crosshair.enable&&Mn(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&(this.tooltip(),t.markerRender.markerMove(!1)),!1},e.prototype.tooltip=function(){var t=this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg",i=this.getElement(t),r=this.chart.stockChart&&i&&i.firstChild.childNodes.length>1,n=i&&parseInt(i.getAttribute("opacity"),10)>0&&!r,a=this.getTooltipElement(n);this.chart.enableCanvas&&a&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(a),a.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg"))),this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!n,a):this.renderSeriesTooltip(this.chart,!n,a)},e.prototype.findHeader=function(t){return this.header===""?"":(this.header=this.parseTemplate(t.point,t.series,this.header,t.series.xAxis,t.series.yAxis),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},e.prototype.findShapes=function(){if(!this.chart.tooltip.enableMarker)return[];for(var t=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];t.push(n.point.marker.shape||n.series.marker.shape||"Circle")}return t},e.prototype.renderSeriesTooltip=function(t,i,r){var n=this.getData();if(n.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(n,this.previousPoints[0])){if(!(t.dataEditingModule&&t.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&n.point.index===this.previousPoints[0].point.index&&n.series.index===this.previousPoints[0].series.index)return null;this.pushData(n,i,r,!0)&&this.triggerTooltipRender(n,i,this.getTooltipText(n),this.findHeader(n))}else if(!n.point&&this.isRemove&&t.tooltip.fadeOutMode==="Move")this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else for(var a=this.mergeXvalues(this.chart.visibleSeries),o=0,l=t.visibleSeries;o<l.length;o++){var h=l[o];h.visible&&h.category!=="TrendLine"&&(n=this.getClosestX(t,h,a)||n)}n&&n.point&&this.findMouseValue(n,t)},e.prototype.triggerTooltipRender=function(t,i,r,n){var a=this,o,l={cancel:!1,name:j0,text:r,headerText:n,template:o,series:this.chart.isBlazor?{}:t.series,textStyle:this.textStyle,point:t.point,data:{pointX:t.point.x,pointY:t.point.y,seriesIndex:t.series.index,seriesName:t.series.name,pointIndex:t.point.index,pointText:t.point.text}},h=this.chart.border.width,u=3,c=this.chart.tooltip,d=function(p){if(p.cancel)a.removeHighlight(),pt(a.getElement(a.element.id+"_tooltip"));else{t.series.type==="BoxAndWhisker"&&(a.removeText(),i=!0),a.headerText=p.headerText,a.formattedText=a.formattedText.concat(p.text),a.text=a.formattedText;var f=a.getSymbolLocation(t);f=f||new ut(null,null),f.x=c.location.x!==null?c.location.x:f.x,f.y=c.location.y!==null?c.location.y:f.y,f=f.x===null&&f.y===null?null:f,a.createTooltip(a.chart,i,f,t.series.clipRect,t.point,a.findShapes(),a.findMarkerHeight(a.currentPoints[0]),new Ve(h,h,a.chart.availableSize.width-u-h*2,a.chart.availableSize.height-u-h*2),a.chart.crosshair.enable,null,a.getTemplateText(t),a.template?p.template:"")}a.isRemove=!0};d.bind(this,t),this.chart.trigger(j0,l,d)},e.prototype.findMarkerHeight=function(t){var i=0,r=t.series;return i=(r.marker.visible||this.chart.tooltip.shared&&(!r.isRectSeries||r.marker.visible)||r.type==="Scatter"||r.drawType==="Scatter")&&!(r.type==="Candle"||r.type==="Hilo"||r.type==="HiloOpenClose")?(r.marker.height+2)/2+2*r.marker.border.width:0,i},e.prototype.findData=function(t,i){return t.point&&(!i||i.point!==t.point||i&&i.lierIndex>3&&i.lierIndex!==this.lierIndex||i.point===t.point)},e.prototype.getSymbolLocation=function(t){var i;if(t.series.type!=="BoxAndWhisker"){if(!t.point.symbolLocations[0])return null;i=new ut(t.point.symbolLocations[0].x,t.point.symbolLocations[0].y)}switch(t.series.type){case"BoxAndWhisker":return this.getBoxLocation(t);case"Waterfall":return this.getWaterfallRegion(t,i);case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"RangeColumn":return this.getRangeArea(t,i);default:return i}},e.prototype.getRangeArea=function(t,i){return t.point.regions[0]&&(this.inverted?i.x=t.point.regions[0].x+t.point.regions[0].width/2:i.y=t.point.regions[0].y+t.point.regions[0].height/2,t.series.type==="RangeStepArea"&&(i.y=t.point.regions[0].y+t.point.regions[0].height/2+t.point.regions[0].width)),i},e.prototype.getWaterfallRegion=function(t,i){return this.inverted?i.x=t.point.y<0?i.x+t.point.regions[0].width:i.x:i.y=t.point.y<0?i.y-t.point.regions[0].height:i.y,i},e.prototype.getTooltipText=function(t){var i=t.series;return this.parseTemplate(t.point,i,this.getFormat(this.chart,i),i.xAxis,i.yAxis)},e.prototype.getTemplateText=function(t){if(this.template&&this.chart.tooltip.shared){for(var i=[],r=0;r<t.length;r++)i[r]=me({},t[r].point),i[r].x=this.formatPointValue(t[r].point,t[r].series.xAxis,"x",!0,!1),t[r].series.seriesType==="XY"?i[r].y=this.formatPointValue(t[r].point,t[r].series.yAxis,"y",!1,!0):(i[r].low=this.formatPointValue(t[r].point,t[r].series.yAxis,"low",!1,!0),i[r].high=this.formatPointValue(t[r].point,t[r].series.yAxis,"high",!1,!0));return i}else if(this.template){var i=me({},t.point);return i.x=this.formatPointValue(t.point,t.series.xAxis,"x",!0,!1),t.series.seriesType==="XY"?i.y=this.formatPointValue(t.point,t.series.yAxis,"y",!1,!0):(i.low=this.formatPointValue(t.point,t.series.yAxis,"low",!1,!0),i.high=this.formatPointValue(t.point,t.series.yAxis,"high",!1,!0)),i}else return t.point},e.prototype.findMouseValue=function(t,i){i.requireInvertedAxis?(this.valueY=(1-mn(t.point.xValue,t.series.xAxis))*t.series.xAxis.rect.height+t.series.xAxis.rect.y,this.valueX=i.mouseX):(i.chartAreaType==="PolarRadar"?this.valueX=I2(t.point.xValue,t.series.xAxis)*t.series.xAxis.rect.width+t.series.xAxis.rect.x:this.valueX=t.series.category==="TrendLine"&&i.tooltip.shared?this.valueX:mn(t.point.xValue,t.series.xAxis)*t.series.xAxis.rect.width+t.series.xAxis.rect.x,this.valueY=i.mouseY)},e.prototype.renderGroupedTooltip=function(t,i,r){var n,a=[],o,l=t.chartAreaType==="PolarRadar"?this.getData():null;this.stopAnimation(),this.removeHighlight(),this.currentPoints=[];var h=[],u=Number.MAX_VALUE,c=Number.MAX_VALUE,d,p,f;i&&(t.stockChart?r&&!Un(r.id)&&document.getElementById(t.stockChart.element.id+"_Secondary_Element").appendChild(r):r&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),this.removeText();for(var v={text:[],cancel:!1,name:Dx,data:[],point:[],series:[],headerText:"",textStyle:this.textStyle,template:""},g=0,b=0,y=t.visibleSeries;b<y.length;b++){var C=y[b];!C.enableTooltip||!C.visible||(t.chartAreaType==="Cartesian"&&C.visible?n=this.getClosestX(t,C,this.commonXValue(this.chart.visibleSeries)):t.chartAreaType==="PolarRadar"&&C.visible&&l.point!==null&&(n=new rf(C.points[l.point.index],C)),t.tooltip.showNearestPoint&&!n&&(n=this.getClosestX(t,C,this.commonXValue([C]))),n&&(v.data.push({pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,seriesName:n.series.name,pointIndex:n.point.index,pointText:n.point.text}),v.series[g]=n.series,v.point[g]=n.point,v.headerText=this.findHeader(n),this.currentPoints.push(n),v.text.push(this.getTooltipText(n)),d=t.requireInvertedAxis?t.mouseY-n.series.clipRect.y:t.mouseX-n.series.clipRect.x,p=t.mouseY-n.series.clipRect.y,n.point.symbolLocations&&n.point.symbolLocations.length&&Math.abs(d-n.point.symbolLocations[0].x)<=u&&Math.abs(n.point.symbolLocations[0].y-p)<Math.abs(c-p)&&(u=Math.abs(d-n.point.symbolLocations[0].x),c=n.point.symbolLocations[0].y,f=n),o=n.series.category==="TrendLine"&&t.tooltip.shared?o:f||n,a.push(n)),g++)}if(!t.tooltip.showNearestPoint){var x=[];this.currentPoints=[],v.point=[],v.series=[],v.data=[],v.text=[];for(var w=0,M=a;w<M.length;w++){var E=M[w];(E.point.symbolLocations[0].x===o.point.symbolLocations[0].x||(E.series.type.indexOf("Column")!==-1||o.series.type.indexOf("Column")!==-1)&&E.point.xValue===o.point.xValue)&&(v.point.push(E.point),v.series.push(E.series),v.text.push(this.getTooltipText(E)),v.headerText=this.findHeader(E),x.push(E),v.data.push({pointX:E.point.x,pointY:E.point.y,seriesIndex:E.series.index,seriesName:E.series.name,pointIndex:E.point.index,pointText:E.point.text}))}a=x,this.currentPoints=x}a.length>0&&this.currentPoints.length>0?this.triggerSharedTooltip(v,o,h,t,i,a):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")},e.prototype.triggerSharedTooltip=function(t,i,r,n,a,o){var l=this,h,u={cancel:!1,name:Dx,text:t.text,headerText:t.headerText,textStyle:t.textStyle,template:h,point:t.point,series:t.series,data:t.data},c=this.chart.border.width,d=3,p,f,v=[];n.stockChart&&(p=n.stockChart.enablePeriodSelector?n.stockChart.toolbarHeight:0,f=ht(this.chart.stockChart.title,this.chart.stockChart.titleStyle,this.chart.themeStyle.tooltipLabelFont).height+10);var g=function(b){if(b.cancel)r.push(i);else{i.series.type==="BoxAndWhisker"&&(l.removeText(),a=!0);for(var y=0;y<b.text.length;y++)b.text[y]&&v.push(l.currentPoints[y]);l.currentPoints=v,l.formattedText=l.formattedText.concat(b.text),l.text=b.text,l.headerText=b.headerText;var C=l.chart.tooltip;l.findMouseValue(i,l.chart);var x=l.findSharedLocation();x=x||new ut(null,null),x.x=C.location.x!==null?C.location.x:x.x,x.y=C.location.y!==null?C.location.y:x.y,x=x.x===null&&x.y===null?null:x,l.createTooltip(n,a,x,l.currentPoints.length===1?l.currentPoints[0].series.clipRect:null,o.length===1?o[0].point:null,l.findShapes(),l.findMarkerHeight(l.currentPoints[0]),new Ve(c,n.stockChart?p+f+c:c,l.chart.availableSize.width-d-c*2,l.chart.availableSize.height-d-c*2),l.chart.crosshair.enable,r,l.template?l.getTemplateText(o):null,l.template?b.template:""),i=null}};g.bind(this,i,r),this.chart.trigger(Dx,u,g)},e.prototype.findSharedLocation=function(){var t=this.chart.stockChart;if(t){this.text.length===1&&this.text.push("");var i=t.enablePeriodSelector?t.toolbarHeight:0,r=document.getElementById(t.element.id+"_ChartTitle"),n=t.title!==""?r.getBoundingClientRect().height+10:0;return t.tooltip.position==="Nearest"?new ut(this.valueX,this.valueY+i+n):new ut(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+i+5+n)}else return this.currentPoints.length>1?new ut(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])},e.prototype.getBoxLocation=function(t){var i=this.lierIndex>3?t.point.outliers.length>0?t.point.symbolLocations[this.lierIndex-4]:null:{x:t.point.regions[0].x+t.point.regions[0].width/2,y:t.point.regions[0].y+t.point.regions[0].height/2};return i},e.prototype.parseTemplate=function(t,i,r,n,a){for(var o,l,h=0,u=Object.keys(t);h<u.length;h++){var c=u[h];o=new RegExp("${point."+c+"}","gm"),r=r.replace(o.source,this.formatPointValue(t,o.source==="${point.x}"?n:a,c,o.source==="${point.x}",o.source==="${point.high}"||o.source==="${point.open}"||o.source==="${point.close}"||o.source==="${point.low}"||o.source==="${point.y}"||o.source==="${point.minimum}"||o.source==="${point.maximum}"||o.source==="${point.outliers}"||o.source==="${point.upperQuartile}"||o.source==="${point.lowerQuartile}"||o.source==="${point.median}"))}for(var d=0,p=Object.keys(Object.getPrototypeOf(i));d<p.length;d++){var c=p[d];o=new RegExp("${series."+c+"}","gm"),l=i[c],r=r.replace(o.source,l)}return r},e.prototype.formatPointValue=function(t,i,r,n,a){var o,l,h;if(i.valueType!=="Category"&&n)l=i.labelFormat&&i.labelFormat.match("{value}")!==null,o=l?i.labelFormat.replace("{value}",i.format(t[r])):i.format(t[r]);else if(a&&!m(t[r]))l=i.labelFormat&&i.labelFormat.match("{value}")!==null,h=r==="outliers"?i.format(t[r][this.lierIndex-4]):i.format(t[r]),o=l?i.labelFormat.replace("{value}",h):h;else if(r==="size"){var u=this.chart.intl.getNumberFormat({format:"",useGrouping:this.chart.useGroupingSeparator});o=typeof t[r]=="number"?u(t[r]):t[r]}else o=t[r];return o},e.prototype.getFormat=function(t,i){if(i.tooltipFormat)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,t,t.tooltip.format):i.tooltipFormat;if(!i.tooltipFormat&&t.tooltip.format)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,t,t.tooltip.format):t.tooltip.format;var r=i.type==="Histogram"?"${point.minimum}-${point.maximum}":"${point.x}",n=t.tooltip.shared?"${series.name}":r;switch(i.seriesType){case"XY":return i.category==="Indicator"&&this.getIndicatorTooltipFormat(i,t,t.tooltip.format),n+" : "+(i.type==="Bubble"?"<b>${point.y}</b>  Size : <b>${point.size}</b>":"<b>${point.y}</b>");case"HighLow":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b>";case"HighLowOpenClose":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>";case"BoxPlot":return n+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}</b>":"Maximum : <b>${point.maximum}</b><br/>Q3 : <b>${point.upperQuartile}</b><br/>Median : <b>${point.median}</b><br/>Q1 : <b>${point.lowerQuartile}</b><br/>Minimum : <b>${point.minimum}</b>");default:return""}},e.prototype.getIndicatorTooltipFormat=function(t,i,r){var n;return t.seriesType==="XY"?n=t.name+" : <b>${point.y}</b>":n=r,n},e.prototype.removeHighlightedMarker=function(t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];di(this.element.id+"_Series_"+a.series.index+"_Point_"+a.point.index+"_Trackball"),this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker(a.series,a.point,i)}this.previousPoints=[]},e.prototype.getModuleName=function(){return"Tooltip"},e.prototype.destroy=function(){},e}(W2),I$=function(){function s(e){this.errorHeight=0,this.chart=e}return s.prototype.initPrivateVariables=function(e,t){var i="",r="",n=e.chart.renderer,a=e.index===void 0?e.category:e.index;e.chart.chartAreaType==="Cartesian"&&(i="translate("+e.clipRect.x+","+e.clipRect.y+")",r="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+a+")"),t.dataLabel.visible&&!this.chart.enableCanvas&&(e.shapeElement=n.createGroup({id:this.chart.element.id+"ShapeGroup"+a,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+a+")"}),e.textElement=n.createGroup({id:this.chart.element.id+"TextGroup"+a,transform:i,"clip-path":r}),e.textElement.setAttribute("aria-hidden","true")),this.markerHeight=e.type==="Scatter"||t.visible?t.height/2:0,this.commonId=this.chart.element.id+"_Series_"+a+"_Point_",this.calculateErrorHeight(e,e.marker.dataLabel.position),this.chartBackground=this.chart.chartArea.background==="transparent"?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},s.prototype.calculateErrorHeight=function(e,t){if(e.errorBar.visible)if(e.errorBar.visible&&this.chart.chartAreaType!=="PolarRadar"){var i=e.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,n=this.chart.errorBarModule.negativeHeight;this.isRectSeries(e)?((t==="Top"||t==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0),(t==="Outer"||t==="Auto")&&(i==="Both"||i==="Plus"?this.errorHeight=r:this.errorHeight=0)):((t==="Top"||t==="Outer"||t==="Auto")&&((i==="Both"||i==="Plus")&&!e.chart.isTransposed?this.errorHeight=r:this.errorHeight=0),(t==="Bottom"||t==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0))}else this.errorHeight=0;else return null},s.prototype.isRectSeries=function(e){return e.isRectSeries||e.type==="RangeArea"||e.type==="SplineRangeArea"||e.type==="RangeStepArea"},s.prototype.render=function(e,t,i){this.initPrivateVariables(e,e.marker);var r,n={x:0,y:0},a,o,l,h,u,c,d;this.inverted=t.requireInvertedAxis,this.yAxisInversed=e.yAxis.isAxisInverse;for(var p=t.redraw,f=!1,v=[],g=t.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabelCollections",b=St("div",{id:g}),y=jh(e),C,x,w,M=0;M<y.length;M++){if(C=y[M],!i.showZero&&(C.y!==0||C.y===0&&e.emptyPointSettings.mode==="Zero"))return null;this.margin=i.margin;var E=[],T=void 0,D=void 0,N=void 0,A=void 0,L=void 0,k=!0,O=e.clipRect,R=void 0;f=!1,i.angle=i.labelIntersectAction==="Rotate90"?90:i.angle,i.enableRotation=i.labelIntersectAction==="Rotate90"?!0:i.enableRotation,c=d=i.angle,h={width:i.border.width,color:i.border.color};var j=me({},ie("properties",i.font),null,!0);if(C.symbolLocations.length&&C.symbolLocations[0]||e.type==="BoxAndWhisker"&&C.regions.length){E=IG(C,e,t),T=E.length;for(var P=0;P<T;P++)if(l={cancel:!1,name:P0,series:e,point:C,text:E[P],border:h,color:i.fill,template:i.template,font:j,location:n,textSize:ht(E[P],i.font,this.chart.themeStyle.datalabelFont)},t.trigger(P0,l),!l.cancel)if(this.fontBackground=l.color,this.isDataLabelShape(l),this.markerHeight=e.type==="Bubble"?C.regions[0].height/2:this.markerHeight,l.template!==null)this.createDataLabelTemplate(b,e,i,C,l,P,p);else{if(u=ht(l.text,i.font,this.chart.themeStyle.datalabelFont),r=this.calculateTextPosition(C,e,u,i,P),t.chartAreaType==="PolarRadar")for(var F=0,z=t.chartAxisLayoutPanel.visibleAxisLabelRect;F<z.length;F++){var q=z[F];if(pn(new Ve(r.x,r.y,r.width,r.height),q)){k=!1;break}}var X=new Ve(r.x+O.x,r.y+O.y,r.width,r.height);if(i.enableRotation){var G=this.getRectanglePoints(r);if(x=r.x+r.width/2,w=r.y+r.height/2,v=_M(G,x,w,c),f=i.labelIntersectAction==="Rotate90"||c==-90?!1:this.isDataLabelOverlapWithChartBound(v,t,O),!f){this.chart.rotatedDataLabelCollections.push(v);for(var Z=this.chart.rotatedDataLabelCollections.length-1,se=Z;se>=0;se--)if(this.chart.rotatedDataLabelCollections[Z]&&this.chart.rotatedDataLabelCollections[se-1]&&E2(this.chart.rotatedDataLabelCollections[Z],this.chart.rotatedDataLabelCollections[se-1])){f=!0,this.chart.rotatedDataLabelCollections[Z]=null;break}}}else f=Ep(r,t.dataLabelCollections,O);if((!f||i.labelIntersectAction==="None")&&k){t.dataLabelCollections.push(X),this.isShape&&(R=t.renderer.drawRectangle(new aa(this.commonId+C.index+"_TextShape_"+P,l.color,l.border,i.opacity,r,i.rx,i.ry),new Int32Array([O.x,O.y])),e.shapeElement&&e.shapeElement.appendChild(R));var oe=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1||this.chart.theme==="HighContrast"?"black":"white":this.fontBackground;a=dv(qn(oe)),o=Math.round((a.r*299+a.g*587+a.b*114)/1e3),D=r.x+this.margin.left+u.width/2+n.x,N=r.y+this.margin.top+u.height*3/4+n.y,n={x:0,y:0},c!==0&&i.enableRotation?(A=x,L=w,d=c>360?c-360:c<-360?c+360:c):(d=0,A=r.x,L=r.y,D-=t.chartAreaType=="Cartesian"&&D+u.width/2>O.width?D+u.width/2-O.width:0,N-=N+u.height>O.y+O.height&&!(e.type.indexOf("Bar")>-1)?N+u.height-(O.y+O.height):0);var fe=i.labelIntersectAction==="Rotate90"?i.position=="Top"?"start":i.position=="Middle"?"middle":"end":c==-90&&i.enableRotation?i.position=="Top"?"end":i.position=="Middle"?"middle":"start":"middle";bn(t.renderer,new Sn(this.commonId+C.index+"_Text_"+P,D,N,fe,l.text,"rotate("+d+","+A+","+L+")","auto",d),l.font,l.font.color||(o>=128||e.type==="Hilo"||e.type==="HiloOpenClose"?"black":"white"),e.textElement,!1,p,!0,!1,e.chart.duration,e.clipRect,null,null,t.enableCanvas,null,this.chart.themeStyle.datalabelFont)}}}}b.childElementCount&&(t.enableCanvas?Qe(t.element.id+"_Secondary_Element").appendChild(b):Mt(t.enableCanvas,Qe(t.element.id+"_Secondary_Element"),b,t.redraw,!1,"x","y",null,"",!1,!1,null,t.duration))},s.prototype.getRectanglePoints=function(e){var t=new ut(e.x,e.y),i=new ut(e.x+e.width,e.y),r=new ut(e.x+e.width,e.y+e.height),n=new ut(e.x,e.y+e.height);return[t,i,r,n]},s.prototype.isDataLabelOverlapWithChartBound=function(e,t,i){for(var r=0;r<e.length;r++)if(!Mn(e[r].x+i.x,e[r].y+i.y,t.initialClipRect))return!0;return!1},s.prototype.createDataLabelTemplate=function(e,t,i,r,n,a,o){this.margin={left:0,right:0,bottom:0,top:0};var l=t.clipRect,h=A2(St("div",{id:this.chart.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabel_"+r.index+(a?"_"+a:""),styles:"position: absolute;background-color:"+n.color+";"+N2(i.font)+";border:"+n.border.width+"px solid "+n.border.color+";"}),r.index,n.template,this.chart,r,t,this.chart.element.id+"_DataLabel",a);this.calculateTemplateLabelSize(e,h,r,t,i,a,l,o)},s.prototype.calculateTemplateLabelSize=function(e,t,i,r,n,a,o,l,h){var u=k2(t,l,h),c=this.calculateTextPosition(i,r,{width:u.width,height:u.height},n,a),d=0,p=0,f=!1;h&&(f=u.width===0||u.height===0),t.style.left=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.x)+c.x-d+"px",t.style.top=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.y)+c.y+p+"px";var v=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1?"black":"white":this.fontBackground,g=dv(qn(v)),b=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,y=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;t.style.color=n.font.color||(Math.round((g.r*299+g.g*587+g.b*114)/1e3)>=128?"black":"white"),t.childElementCount&&!f&&(!Ep(c,this.chart.dataLabelCollections,o)||n.labelIntersectAction==="None")&&(r.seriesType!=="XY"||i.yValue===void 0||Kh(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&Kh(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&Kh(i.xValue,r.xAxis.visibleRange)&&parseFloat(t.style.top)>=b.rect.y&&parseFloat(t.style.left)>=y.rect.x&&parseFloat(t.style.top)<=b.rect.y+b.rect.height&&parseFloat(t.style.left)<=y.rect.x+y.rect.width&&(this.chart.dataLabelCollections.push(new Ve(c.x+o.x,c.y+o.y,c.width,c.height)),Mt(this.chart.enableCanvas,e,t,l,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,t):this.chart.enableCanvas&&e.appendChild(t))},s.prototype.calculateTextPosition=function(e,t,i,r,n){var a=n>1&&t.type==="Candle"?e.regions[1]:e.regions[0];n>1&&t.type==="HiloOpenClose"&&(a=n===2?e.regions[1]:e.regions[2]);var o;o=this.getLabelLocation(e,t,i,n);var l=5,h=t.clipRect;if(!this.chart.requireInvertedAxis||!this.isRectSeries(t)||t.type==="BoxAndWhisker"){this.locationX=o.x;var u=i.height+this.borderWidth*2+this.markerHeight+this.margin.bottom+this.margin.top+l;o.x=r.position==="Auto"?o.x:this.calculateAlignment(u,o.x,r.alignment,this.isRectSeries(t)?e.yValue<0:!1),o.y=!this.isRectSeries(t)||t.type==="BoxAndWhisker"?this.calculatePathPosition(o.y,r.position,t,e,i,n):this.calculateRectPosition(o.y,a,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e),this.isRectSeries(t)&&this.chart.chartAreaType==="PolarRadar"&&(o=this.calculatePolarRectPosition(o,r.position,t,e,i,n,r.alignment,u))}else{this.locationY=o.y;var u=i.width+this.borderWidth+this.margin.left+this.margin.right-l;o.x=r.position==="Auto"?o.x:this.calculateAlignment(u,o.x,r.alignment,e.yValue<0),o.x=this.calculateRectPosition(o.x,a,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e)}var c=lg(o,i,this.margin);!(r.enableRotation===!0&&r.angle!==0)&&!(c.y>h.y+h.height||c.x>h.x+h.width||c.x+c.width<0||c.y+c.height<0)&&(c.x=c.x<0?l:c.x,c.y=c.y<0&&r.labelIntersectAction!=="None"?l:c.y,c.x-=c.x+c.width>h.x+h.width?c.x+c.width-(h.x+h.width)+l:0,c.y-=c.y+c.height>h.y+h.height?c.y+c.height-(h.y+h.height)+l:0,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground);var d;return this.inverted&&t.isRectSeries&&c.x+c.width>a.x+a.width&&(d=!0),this.fontBackground=d?this.chartBackground:this.fontBackground,c},s.prototype.calculatePolarRectPosition=function(e,t,i,r,n,a,o,l){var h=5,u,c=this.chart.availableSize.width,d=o==="Center"?0:o==="Far"?1:-1,p=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return a===0?u=r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:u=r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?t=t==="Outer"?"Top":t:i.drawType.indexOf("Range")>-1&&(t=t==="Outer"||t==="Top"?t:"Auto"),t==="Outer"?u=a===0?u+2*h+this.markerHeight:u-2*h-this.markerHeight:t==="Middle"?(u=u/2+h,i.drawType==="StackingColumn"&&(u=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+h-n.height/2)):t==="Top"?u=a===0?u-2*h-this.markerHeight:u+2*h+this.markerHeight:t==="Bottom"?(u=2*h,u+=i.drawType==="StackingColumn"?r.regionData.innerRadius+this.markerHeight:0):a===0?u=u>=i.chart.radius?u-h:i.drawType==="StackingColumn"?u-2*h:u+2*h:u=u>=i.chart.radius?u+h:u-2*h,u+=l*d,e.x=i.clipRect.width/2+i.clipRect.x+u*Math.cos(p),i.drawType==="StackingColumn"?e.x=e.x<c/2?e.x+n.width/2:e.x>c/2?e.x-n.width/2:e.x:i.drawType==="Column"&&(e.x=e.x<c/2?e.x-n.width/2:e.x>c/2?e.x+n.width/2:e.x),e.y=i.clipRect.height/2+i.clipRect.y+u*Math.sin(p),e},s.prototype.getLabelLocation=function(e,t,i,r){var n=new ut(0,0),a=t.type==="Candle"&&r>1?e.regions[1]:e.regions[0];t.type==="HiloOpenClose"&&(a=r===2?e.regions[1]:e.regions[2]);var o=t.xAxis,l=t.yAxis,h=t.chart.requireInvertedAxis;if(t.type==="BoxAndWhisker"){switch(this.markerHeight=0,r){case 0:n=Yn(e.xValue,e.median,o,l,h);break;case 1:n=Yn(e.xValue,e.maximum,o,l,h);break;case 2:n=Yn(e.xValue,e.minimum,o,l,h);break;case 3:n=Yn(e.xValue,e.upperQuartile,o,l,h);break;case 4:n=Yn(e.xValue,e.lowerQuartile,o,l,h);break;default:{n=Yn(e.xValue,e.outliers[r-5],o,l,h),this.markerHeight=t.marker.height/2;break}}h?n.y=e.regions[0].y+e.regions[0].height/2:n.x=e.regions[0].x+e.regions[0].width/2}else r===0||r===1?n=new ut(e.symbolLocations[0].x,e.symbolLocations[0].y):(r===2||r===3)&&t.type==="Candle"?n=new ut(e.symbolLocations[1].x,e.symbolLocations[1].y):h?n={x:a.x+a.width/2,y:a.y}:n={x:a.x+a.width,y:a.y+a.height/2};if(r>1&&t.type==="HiloOpenClose")if(t.chart.requireInvertedAxis){var u=a.height;n.y=a.y+u/2+2*(r===2?1:-1)}else{var c=a.width;n.x=a.x+c/2+2*(r===2?1:-1)}return n},s.prototype.calculateRectPosition=function(e,t,i,r,n,a,o,l){if(n.chart.chartAreaType==="PolarRadar")return null;var h=5,u=this.margin,c=this.inverted?a.width:a.height,d=this.borderWidth+c/2+(r!=="Outer"&&n.type.indexOf("Column")>-1&&Math.abs(t.height-a.height)<h?0:h);switch(n.type==="StackingColumn100"||n.type==="StackingBar100"?r=r==="Outer"?"Top":r:n.type.indexOf("Range")>-1?r=r==="Outer"||r==="Top"?r:"Auto":n.type==="Waterfall"&&(r=r==="Auto"?"Middle":r),r){case"Bottom":e=this.inverted?i?e+(n.type==="Waterfall"?+d+u.left+this.markerHeight:+t.width-d-u.left):e-t.width+d+u.right:i?e+(n.type==="Waterfall"?-d-u.top-this.markerHeight:-t.height+d+u.top):e+t.height-d-u.bottom;break;case"Middle":e=e=this.inverted?i?e+t.width/2:e-t.width/2:i?e-t.height/2:e+t.height/2;break;case"Auto":e=this.calculateRectActualPosition(e,t,i,n,a,o,l);break;default:d+=this.errorHeight,e=this.calculateTopAndOuterPosition(e,t,r,n,o,d,i);break}var p=this.inverted?e<t.x||e>t.x+t.width:e<t.y||e>t.y+t.height;this.fontBackground=p?this.fontBackground==="transparent"?this.chartBackground:this.fontBackground:this.fontBackground==="transparent"?l.color||n.interior:this.fontBackground;var f=n.chart.series.length;if(r==="Outer"&&n.type.indexOf("Stacking")>-1&&f-1>n.index){for(var v=void 0,g=void 0,b=n.index+1;b<f;b++)if(v=n.chart.series[b],g=v.points[l.index],v.type.indexOf("Stacking")>-1&&v.type.indexOf("100")===-1){this.fontBackground=g&&(g.yValue<0&&l.yValue<0||g.yValue>0&&l.yValue>0)?g?g.color:v.interior:this.fontBackground;break}}return e},s.prototype.calculatePathPosition=function(e,t,i,r,n,a){var o=5;switch(i.type.indexOf("Area")>-1&&i.type!=="RangeArea"&&i.type!=="SplineRangeArea"&&i.type!=="RangeStepArea"&&this.yAxisInversed&&i.marker.dataLabel.position!=="Auto"&&(t=t==="Top"?"Bottom":t==="Bottom"?"Top":t),this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,t){case"Top":case"Outer":e=e-this.markerHeight-this.borderWidth-n.height/2-this.margin.bottom-o-this.errorHeight;break;case"Bottom":e=e+this.markerHeight+this.borderWidth+n.height/2+this.margin.top+o+this.errorHeight;break;case"Auto":e=this.calculatePathActualPosition(e,this.markerHeight,i,r,n,a);break}return e},s.prototype.isDataLabelShape=function(e){this.isShape=e.color!=="transparent"||e.border.width>0,this.borderWidth=e.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},s.prototype.calculateRectActualPosition=function(e,t,i,r,n,a,o){for(var l,h,u=!0,c=0,d=this.chart.dataLabelCollections,p=r.type.indexOf("Range")!==-1||r.type==="Hilo"?2:4;u&&c<p;){var f=this.getPosition(c);r.type.indexOf("Stacking")>-1&&f==="Outer"&&(f="Top",c++),l=this.calculateRectPosition(e,t,i,f,r,n,a,o),this.inverted?(h=lg(new ut(l,this.locationY),n,this.margin),u=h.x<0||Ep(h,d,r.clipRect)||h.x+h.width>r.clipRect.width):(h=lg(new ut(this.locationX,l),n,this.margin),u=h.y<0||Ep(h,d,r.clipRect)||h.y>r.clipRect.height),c++}return l},s.prototype.calculateAlignment=function(e,t,i,r){switch(i){case"Far":t=this.inverted?r?t-e:t+e:r?t+e:t-e;break;case"Near":t=this.inverted?r?t+e:t-e:r?t-e:t+e;break;case"Center":t=t;break}return t},s.prototype.calculateTopAndOuterPosition=function(e,t,i,r,n,a,o){var l=this.margin,h;switch(r.type){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":h=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,e=this.updateLabelLocation(i,e,a,l,t,h);break;case"Candle":h=(n===0||n===2)&&!this.yAxisInversed||(n===1||n===3)&&this.yAxisInversed,e=this.updateLabelLocation(i,e,a,l,t,h,n>1);break;case"HiloOpenClose":n<=1?(h=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,e=this.updateLabelLocation(i,e,a,l,t,h)):this.yAxisInversed?e=this.inverted?e-a-l.right:e+a+l.top:e=this.inverted?e+a+l.left:e-a-l.bottom;break;default:o&&i==="Top"||!o&&i==="Outer"?e=this.inverted?e+(o&&r.type==="Waterfall"?+t.width-a-l.left:+a+l.left+this.markerHeight):e+(o&&r.type==="Waterfall"?-t.height+a+l.bottom:-a-l.bottom-this.markerHeight):e=this.inverted?e+(o&&r.type==="Waterfall"?+t.width+a+l.top:-a-l.right-this.markerHeight):e+(o&&r.type==="Waterfall"?-t.height-a-l.top:+a+l.top+this.markerHeight);break}return e},s.prototype.updateLabelLocation=function(e,t,i,r,n,a,o){return o===void 0&&(o=!1),this.inverted?a?t=e==="Outer"&&!o?t+i+r.left+this.markerHeight:t-i-r.right-this.markerHeight:t=e==="Outer"&&!o?t-n.width-i-r.right-this.markerHeight:t-n.width+i+r.left+this.markerHeight:a?t=e==="Outer"&&!o?t-i-r.bottom-this.markerHeight:t+i+r.top+this.markerHeight:t=e==="Outer"&&!o?t+n.height+i+r.top+this.markerHeight:t+n.height-i-r.bottom-this.markerHeight,t},s.prototype.calculatePathActualPosition=function(e,t,i,r,n,a){var o=i.points,l=r.index,h=o[l].yValue,u,c=o.length-1>l?o[l+1]:null,d=l>0?o[l-1]:null,p,f=!0,v,g,b,y=this.chart.dataLabelCollections;if(i.type==="Bubble")u="Top";else if(i.type.indexOf("Step")>-1)u="Top",l&&(u=!d||!d.visible||h>d.yValue!==this.yAxisInversed||h===d.yValue?"Top":"Bottom");else if(i.type==="BoxAndWhisker")a===1||a===3||a>4?u=i.yAxis.isAxisInverse?"Bottom":"Top":a===2||a===4?u=i.yAxis.isAxisInverse?"Top":"Bottom":(f=!1,u="Middle",p=this.calculatePathPosition(e,u,i,r,n,a));else if(l===0)u=!c||!c.visible||h>c.yValue||h<c.yValue&&this.yAxisInversed?"Top":"Bottom";else if(l===o.length-1)u=!d||!d.visible||h>d.yValue||h<d.yValue&&this.yAxisInversed?"Top":"Bottom";else if(!c.visible&&!(d&&d.visible))u="Top";else if(!c.visible||!d)u=c.yValue>h||d&&d.yValue>h?"Bottom":"Top";else{var C=(c.yValue-d.yValue)/2,x=C*l+(c.yValue-C*(l+1));u=this.yAxisInversed?x<h?"Bottom":"Top":x<h?"Top":"Bottom"}for(g=u==="Bottom",b=["Outer","Top","Bottom","Middle","Auto"].indexOf(u);f&&b<4;)p=this.calculatePathPosition(e,this.getPosition(b),i,r,n,a),v=lg(new ut(this.locationX,p),n,this.margin),f=v.y<0||Ep(v,y,i.clipRect)||v.y+v.height>i.clipRect.height,b=g?b-1:b+1,g=!1;return p},s.prototype.doDataLabelAnimation=function(e,t){for(var i=e.shapeElement.childNodes,r=e.textElement.childNodes,n=e.animation.delay+e.animation.duration,a=e.chart.animated?e.chart.duration:200,o,l=t?1:r.length,h,u=0;u<l;u++)h=r[u],t?(t.style.visibility="hidden",YI(t,n,a,"ZoomIn")):(o=new ut(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),cv(h,n,a,e,null,o,!0),i[u]&&(h=i[u],o=new ut(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),cv(h,n,a,e,null,o,!0)))},s.prototype.getPosition=function(e){return["Outer","Top","Bottom","Middle","Auto"][e]},s.prototype.getModuleName=function(){return"DataLabel"},s.prototype.destroy=function(){},s}(),T$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),D$=function(s){T$(e,s);function e(t){var i=s.call(this,t)||this;return i.library=i,i.addEventListener(),i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(B.touchEndEvent,this.mouseEnd,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(B.touchEndEvent,this.mouseEnd))},e.prototype.mouseMove=function(t){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(t),this.chart.highlightModule&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)))for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],r=t.target.id,n=void 0,a=0,o=i;a<o.length;a++){var l=o[a];if(r.indexOf(l)>-1){n=parseInt(r.split(l)[1],10),this.chart.highlightModule.legendSelection(this.chart,n,t.target,t.type);break}}},e.prototype.mouseEnd=function(t){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(t)},e.prototype.getLegendOptions=function(t,i){this.legendCollections=[];var r,n,a,o=[];this.isRtlEnable=i.enableRtl,this.isReverse=!this.isRtlEnable&&i.legendSettings.reverse,t.length>1&&(this.legend.mode="Series");for(var l=0,h=t;l<h.length;l++){var u=h[l];if(this.legend.mode==="Series")u.category!=="Indicator"&&(r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,a=!u.marker.visible&&r.indexOf("Line")>-1&&r.indexOf("Area")===-1?u.dashArray:"",n=u.pointColorMapping&&u.points.length>0&&u.points[0].interior?u.points[0].interior:u.interior,this.legendCollections.push(new lc(u.name,n,u.legendShape,u.category==="TrendLine"?this.chart.series[u.sourceIndex].trendlines[u.index].visible:u.visible,r,u.legendImageUrl?u.legendImageUrl:u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible,null,null,a)));else if(this.legend.mode==="Point")for(var c=function(T){r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,n=T.interior?T.interior:u.interior,d.legendCollections.filter(function(D){return D.text===T.x.toString()}).length===0&&d.legendCollections.push(new lc(T.x.toString(),n,u.legendShape,u.category==="TrendLine"?d.chart.series[u.sourceIndex].trendlines[u.index].visible:T.visible,r,u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible))},d=this,p=0,f=u.points;p<f.length;p++){var v=f[p];c(v)}else if(this.legend.mode==="Range")for(var g=0,b=u.points;g<b.length;g++){var v=b[g];r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,n=v.interior?v.interior:u.interior;var y="Others";if(o.indexOf(n)<0&&(o.push(n),i.rangeColorSettings.length>=1&&i.rangeColorSettings[0].colors.length===1)){for(var C=0,x=i.rangeColorSettings;C<x.length;C++){var w=x[C];w.colors[0]===n&&(y=w.label)}this.legendCollections.push(new lc(y,n,u.legendShape,u.category==="TrendLine"?this.chart.series[u.sourceIndex].trendlines[u.index].visible:v.visible,r,u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible))}}else if(this.legendCollections.length===0&&i.rangeColorSettings.length>0){var M=i.rangeColorSettings[0].start.toString(),E=i.rangeColorSettings[i.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new lc(M,u.interior,"Rectangle",!0,r,"",u.marker.shape,u.marker.visible)),this.legendCollections.push(new lc(E,u.interior,"Rectangle",!0,r,"",u.marker.shape,u.marker.visible))}}this.isReverse&&i.legendSettings.mode!=="Gradient"&&this.legendCollections.reverse()},e.prototype.getLegendBounds=function(t,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title,this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var n=r.padding,a=r.titlePosition,o=0,l,h=0,u=this.arrowWidth,c=this.arrowHeight,d=this.isVertical&&!r.enablePages?c:0,p=this.isTitle&&a==="Top"?this.legendTitleSize.height+this.fivePixel:0;p=this.isTitle&&this.isVertical&&a!=="Top"?this.legendTitleSize.height+this.fivePixel:p,this.isVertical?h=r.width?0:t.width/100*5:o=r.height?0:t.height/100*5,i.height+=o,i.width+=h;var f=r.shapeWidth,v=r.shapePadding,g=0,b=0,y=0,C=0,x=0,w=0,M=0,E,T=!1;this.maxItemHeight=Math.max(ht("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);for(var D=0;D<this.legendCollections.length;D++)if(l=this.legendCollections[D],H0.test(l.text)&&(l.text=RL(l.text,H0)),LL.test(l.text)&&(l.text=RL(l.text,LL)),E={fill:l.fill,text:l.text,shape:l.shape,markerShape:l.markerShape,name:DL,cancel:!1},this.chart.trigger(DL,E),l.render=!E.cancel,l.text=E.text,l.fill=E.fill,l.shape=E.shape,l.markerShape=E.markerShape,l.textSize=ht(l.text,r.textStyle,this.chart.themeStyle.legendLabelFont),f=l.text?r.shapeWidth:0,v=l.text?r.shapePadding:0,l.render&&l.text){T=!0,y=f+v+(r.maximumLabelWidth?r.maximumLabelWidth:l.textSize.width)+(this.isVertical||D===0?n:this.itemPadding),b=b+y,!r.enablePages&&!this.isVertical&&(M=this.isTitle&&a!=="Top"?this.legendTitleSize.width+this.fivePixel:0,M+=u),this.getLegendHeight(l,r,i,b,this.maxItemHeight,n),(i.width<n+b+M||this.isVertical)&&(g=Math.max(g,b+n+M-(this.isVertical?0:y)),w===0&&y!==b&&(w=1),b=this.isVertical?0:y,w++,x=0,C=d);var N=w>0?w-1:0;this.rowHeights[N]=Math.max(this.rowHeights[N]?this.rowHeights[N]:0,l.textSize.height),this.columnHeights[x]=(this.columnHeights[x]?this.columnHeights[x]:0)+l.textSize.height+(this.isVertical?D===0?n:this.itemPadding:n),x++}C=Math.max.apply(null,this.columnHeights)+n+p,C=Math.max(C,this.maxItemHeight+n+n+p),this.isPaging=i.height<C,this.isPaging&&!r.enablePages&&(this.isVertical?C=C:C=this.maxItemHeight+n+n+(a==="Top"?p:0)),this.totalPages=w,!this.isPaging&&!this.isVertical&&(b+=this.isTitle&&a!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),T?this.setBounds(Math.max(b+n,g),C,r,i):this.setBounds(0,0,r,i)},e.prototype.getLegendHeight=function(t,i,r,n,a,o){var l=t.textSize.width,h=i.shapePadding+o*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?t.textCollection=dh(t.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,null,null,this.chart.themeStyle.legendLabelFont):t.textCollection.push(t.text),t.textSize.height=a*t.textCollection.length;break}},e.prototype.getRenderPoint=function(t,i,r,n,a,o,l,h){var u=this.legend.padding,c=r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),d=n.location.x+(this.isRtlEnable?-c:c);this.isWithinBounds(d,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:t.textSize.width)+r-this.itemPadding,a)||this.isVertical?(t.location.x=i.x,o!==l&&this.chartRowCount++,t.location.y=o===l?n.location.y:n.location.y+(this.isVertical?n.textSize.height:this.rowHeights[this.chartRowCount-2])+(this.isVertical?this.itemPadding:u)):(t.location.x=o===l?n.location.x:d,t.location.y=n.location.y);var p=this.isRtlEnable?t.location.x-r+this.itemPadding+this.legend.shapeWidth/2-this.legendBounds.x:this.legendBounds.x+this.legendBounds.width-(t.location.x+r-this.itemPadding-this.legend.shapeWidth/2);!this.isVertical&&this.isPaging&&!this.legend.enablePages&&(p=this.legendBounds.width-t.location.x-this.fivePixel),p=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,p):p,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(t.text=ta(+p.toFixed(4),t.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendLabelFont))},e.prototype.isWithinBounds=function(t,i,r){return this.isRtlEnable?t-i<r.x-this.legend.shapeWidth/2:t+i>r.x+r.width+this.legend.shapeWidth/2},e.prototype.LegendClick=function(t,i){var r=this.chart,n=r.legendSettings.mode==="Series"?t:0,a=this.isReverse?this.legendCollections.length-1-t:t,o=r.visibleSeries[n],l=this.legendCollections[a],h="isProtectedOnChange";if(r.legendSettings.mode==="Series"){var u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:o,points:o.points,name:bl,cancel:!1};this.chart.trigger(bl,u),o.legendShape=u.legendShape,u.cancel||(o.fill!==null&&(r.visibleSeries[t].interior=o.fill),r.legendSettings.toggleVisibility?(o.chart[h]=!0,o.category==="TrendLine"?!r.series[o.sourceIndex].trendlines[o.index].visible&&r.series[o.sourceIndex].visible?r.series[o.sourceIndex].trendlines[o.index].visible=!0:r.series[o.sourceIndex].trendlines[o.index].visible=!1:this.changeSeriesVisiblity(o,o.visible),l.visible=o.category==="TrendLine"?r.series[o.sourceIndex].trendlines[o.index].visible:o.visible,this.refreshLegendToggle(r,o)):r.highlightModule?r.highlightModule.legendSelection(r,t,i.target,i.type):r.selectionModule&&r.selectionModule.legendSelection(r,t,i.target,i.type),o.chart[h]=!1)}else if(r.legendSettings.mode==="Point"){var c=o.points[t],u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:o,points:[c],name:bl,cancel:!1};if(this.chart.trigger(bl,u),r.legendSettings.toggleVisibility&&!u.cancel){c.visible=!c.visible;var d=this.legendCollections[t];d.visible=c.visible,this.refreshLegendToggle(r,o)}}else if(r.legendSettings.mode==="Range"){for(var p=[],d=this.legendCollections[t],f=0,v=o.points;f<v.length;f++){var c=v[f];d.fill===(c.interior||o.interior)&&p.push(c)}var u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:o,points:p,name:bl,cancel:!1};if(this.chart.trigger(bl,u),r.legendSettings.toggleVisibility&&!u.cancel){d.visible=!d.visible;for(var g=0,b=p;g<b.length;g++){var c=b[g];c.visible=!c.visible}this.refreshLegendToggle(r,o)}}},e.prototype.refreshLegendToggle=function(t,i){var r=[];if(t.selectionModule&&(r=me([],t.selectionModule.selectedDataIndexes,null,!0)),t.svgObject.childNodes.length>0&&!t.enableAnimation&&!t.enableCanvas){for(;t.svgObject.lastChild;)t.svgObject.removeChild(t.svgObject.lastChild);pt(t.svgObject)}t.animateSeries=!1,t.redraw=t.enableAnimation,t.rotatedDataLabelCollections=[],di(Un(t.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),kb(t),this.redrawSeriesElements(i,t),t.removeSvg(),t.refreshAxis(),i.refreshAxisLabel(),this.refreshSeries(t.visibleSeries);for(var n=0,a=t.visibleSeries;n<a.length;n++){var o=a[n];m(o)||t.markerRender.removeHighlightedMarker(o,null,!0)}t.refreshBound(),t.trigger("loaded",{chart:t}),r.length>0&&(t.selectionModule.selectedDataIndexes=r,t.selectionModule.redrawSelection(t,t.selectionMode)),(t.highlightModule&&t.highlightMode!=="None"||t.legendSettings.enableHighlight)&&t.highlightModule.redrawSelection(t,t.highlightMode),t.redraw=!1},e.prototype.changeSeriesVisiblity=function(t,i){t.visible=!i,this.isSecondaryAxis(t.xAxis)&&(t.xAxis.internalVisibility=t.xAxis.series.some(function(r){return r.visible})),(this.isSecondaryAxis(t.yAxis)||t.category=="Pareto"&&t.type=="Line")&&(t.yAxis.internalVisibility=t.yAxis.series.some(function(r){return r.visible})),t.trendlines.length&&t.visible&&t.trendlines.forEach(function(r){r.visible=!0})},e.prototype.isSecondaryAxis=function(t){return this.chart.axes.indexOf(t)>-1},e.prototype.redrawSeriesElements=function(t,i){if(!i.redraw)return null;di(i.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabelCollections")},e.prototype.refreshSeries=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.type.indexOf("Spline")>-1){var a=n.type.indexOf("Area")>-1||n.drawType.indexOf("Area")>-1,o=n.type.indexOf("Range")>-1;this.chart["spline"+(a?o?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(n)}n.position=void 0}},e.prototype.click=function(t){var i=this;if(this.chart.legendSettings.visible){for(var r=this.chart.mouseX,n=this.chart.mouseY,a=[],o=t.target.id.indexOf("_chart_legend_g_")>-1?t.target.firstChild.id:t.target.id,l=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"],h,u=0,c=l;u<c.length;u++){var d=c[u];if(o.indexOf(d)>-1){h=parseInt(o.split(d)[1],10),this.LegendClick(h,t);break}}o.indexOf(this.legendID+"_pageup")>-1?this.changePage(t,!0):o.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(t,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(r,n),a=this.legendRegions.filter(function(p){return Mn(r,n+(i.isPaging?(i.currentPageNumber-1)*i.translatePage(i.chart.enableCanvas,null,1,2):0),p.rect)}),a.length&&this.chart.enableCanvas&&this.LegendClick(a[0].index,t)}},e.prototype.checkWithinBounds=function(t,i){var r=this.chart.renderer,n=this.legendBounds,a=this.chart.legendSettings.border.width,o=new Ve(n.x,n.y,n.width,n.height);if(o.x=o.x-a/2,o.y=o.y-a/2,o.width=o.width+a,o.height=o.height+a,Mn(t,i,this.pagingRegions[0]))return this.isRtlEnable?this.canvasPageUp(r,o,n):this.canvasPageDown(r,o,n),null;if(Mn(t,i,this.pagingRegions[1]))return this.isRtlEnable?this.canvasPageDown(r,o,n):this.canvasPageUp(r,o,n),null},e.prototype.canvasPageDown=function(t,i,r){--this.currentPageNumber>0?(this.legendRegions=[],t.clearRect(i),t.canvasClip(new aa("legendClipPath","transparent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),t.canvasRestore()):++this.currentPageNumber},e.prototype.canvasPageUp=function(t,i,r){++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],t.clearRect(i),t.canvasClip(new aa("legendClipPath","transpaent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),t.canvasRestore()):--this.currentPageNumber},e.prototype.getModuleName=function(){return"Legend"},e.prototype.destroy=function(){this.removeEventListener()},e}(U2),Fb=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),st=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},A$=function(s){Fb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return st([S(null)],e.prototype,"content",void 0),st([S("0")],e.prototype,"x",void 0),st([S("0")],e.prototype,"y",void 0),st([S("Pixel")],e.prototype,"coordinateUnits",void 0),st([S("Chart")],e.prototype,"region",void 0),st([S("Middle")],e.prototype,"verticalAlignment",void 0),st([S("Center")],e.prototype,"horizontalAlignment",void 0),st([S(null)],e.prototype,"description",void 0),e}(ke),N$=function(s){Fb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return st([S(!1)],e.prototype,"visible",void 0),st([S(!0)],e.prototype,"showZero",void 0),st([S(null)],e.prototype,"name",void 0),st([S("transparent")],e.prototype,"fill",void 0),st([S("Inside")],e.prototype,"position",void 0),st([S(5)],e.prototype,"rx",void 0),st([S(5)],e.prototype,"ry",void 0),st([S(0)],e.prototype,"angle",void 0),st([S(!1)],e.prototype,"enableRotation",void 0),st([Ee({width:null,color:null},Bn)],e.prototype,"border",void 0),st([Ee({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"font",void 0),st([Ee({},Nc)],e.prototype,"connectorStyle",void 0),st([S(null)],e.prototype,"template",void 0),st([S("")],e.prototype,"format",void 0),st([S(null)],e.prototype,"maxWidth",void 0),st([S("Ellipsis")],e.prototype,"textOverflow",void 0),st([S("Normal")],e.prototype,"textWrap",void 0),e}(ke),k$=function(s){Fb(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return st([S("50%")],e.prototype,"x",void 0),st([S("50%")],e.prototype,"y",void 0),e}(ke),BL=function(){function s(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null}return s}(),L$=function(s){Fb(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.points=[],t.clubbedPoints=[],t.sumOfPoints=0,t.isRectSeries=!0,t.clipRect=new Ve(0,0,0,0),t.category="Series",t.rightSidePoints=[],t.leftSidePoints=[],t}return e.prototype.refreshDataManager=function(t,i){var r=this;this.radius=this.radius?this.radius:B.isDevice&&this.dataLabel.position==="Outside"?"40%":"80%";var n=this.dataSource||t.dataSource;if(!(n instanceof ge)&&m(this.query)){this.dataManagerSuccess({result:n,count:n.length},t,i);return}var a=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());a.then(function(o){return r.dataManagerSuccess(o,t)})},e.prototype.dataManagerSuccess=function(t,i,r){r===void 0&&(r=!0);var n={name:z0,series:this,data:t.result};i.allowServerDataBinding=!1,i.trigger(z0,n),this.resultData=t.result!==""?t.result:[],!i.isBlazor&&!r&&this.getPoints(this.resultData,i),(++i.seriesCounts===i.visibleSeries.length&&r||window.Blazor&&!r&&i.seriesCounts===1)&&(this.getPoints(this.resultData,i),i.refreshChart())},e.prototype.getPoints=function(t,i){var r=Object.keys(t).length;if(this.sumOfPoints=0,r===0)return this.points=[],null;this.findSumOfPoints(t),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;for(var n,a=this.palettes.length?this.palettes:P2(i.theme),o=xi(this.groupTo,this.sumOfPoints),l=0;l<r;l++)n=this.setPoints(t,l,a,i),n.y,this.isClub(n,o,l)?(n.index=this.clubbedPoints.length,n.isExplode=!0,this.clubbedPoints.push(n),n.isSliced=!0):(m(n.y)&&(n.visible=!1),this.pushPoints(n,a));if(this.lastGroupTo=this.groupTo,this.sumOfClub>0){var h=this.generateClubPoint();this.pushPoints(h,a);var u=this.points.length-1;this.clubbedPoints.map(function(c){c.index+=u,c.color=h.color})}this.clubbedPoints.length&&this.explode&&this.type==="Pie"&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},e.prototype.generateClubPoint=function(){var t=new BL;return t.isClubbed=!0,t.x="Others",t.y=this.sumOfClub,t.text=t.originalText=t.x+": "+this.sumOfClub,t.sliceRadius="80%",t},e.prototype.pushPoints=function(t,i){t.index=this.points.length,t.isExplode=this.explodeAll||t.index===this.explodeIndex,t.color=t.color||i[t.index%i.length],this.points.push(t)},e.prototype.isClub=function(t,i,r){if(!m(i)){if(this.groupMode==="Value"&&Math.abs(t.y)<=i)return this.sumOfClub+=Math.abs(t.y),!0;if(this.groupMode==="Point"&&r>=i)return this.sumOfClub+=Math.abs(t.y),!0}return!1},e.prototype.findSumOfPoints=function(t){for(var i=Object.keys(t).length,r=0;r<i;r++)!m(t[r])&&!m(t[r][this.yName])&&!isNaN(t[r][this.yName])&&(this.sumOfPoints+=Math.abs(t[r][this.yName]))},e.prototype.setPoints=function(t,i,r,n){var a=new BL;return a.x=ie(this.xName,t[i]),a.y=ie(this.yName,t[i]),a.percentage=+(a.y/this.sumOfPoints*100).toFixed(2),a.legendImageUrl=ie(this.legendImageUrl,t[i]),a.color=ie(this.pointColorMapping,t[i]),a.text=a.originalText=ie(this.dataLabel.name||"",t[i]),a.tooltip=ie(this.tooltipMappingName||"",t[i]),a.sliceRadius=ie(this.radius,t[i]),a.sliceRadius=m(a.sliceRadius)?"80%":a.sliceRadius,a.separatorY=n.intl.formatNumber(a.y,{useGrouping:n.useGroupingSeparator}),this.setAccEmptyPoint(a,i,t,r),a},e.prototype.renderSeries=function(t,i){var r=i?Qe(t.element.id+"_Series_"+this.index):t.renderer.createGroup({id:t.element.id+"_Series_"+this.index});this.renderPoints(t,r,i);var n;t.accumulationDataLabelModule&&this.dataLabel.visible&&(n=t.renderer.createGroup({id:t.element.id+"_datalabel_Series_"+this.index}),n.style.visibility=(this.animation.enable&&vi!="Disable"||vi==="Enable")&&t.animateSeries&&this.type==="Pie"?"hidden":"visible",this.renderDataLabel(t,n,i)),this.type==="Pie"&&(this.findMaxBounds(this.labelBound,this.accumulationBound),t.pieSeriesModule.animateSeries(t,this.animation,this,r)),t.accumulationLegendModule&&(this.labelBound.x-=t.explodeDistance,this.labelBound.y-=t.explodeDistance,this.labelBound.height+=t.explodeDistance-this.labelBound.y,this.labelBound.width+=t.explodeDistance-this.labelBound.x)},e.prototype.renderPoints=function(t,i,r){for(var n=t.element.id+"_Series_"+this.index+"_Point_",a,o=0,l=this.points;o<l.length;o++){var h=l[o],u={cancel:!1,name:uh,series:this,point:h,fill:h.color,border:this.isEmpty(h)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color}};t.trigger(uh,u),h.color=u.fill,a=new Er(n+h.index,h.color,u.border.width||1,u.border.color||h.color,this.opacity,u.series.dashArray,""),t[ao(this.type)+"SeriesModule"].renderPoint(h,this,t,a,i,r)}Mt(!1,t.getSeriesElement(),i,r)},e.prototype.renderDataLabel=function(t,i,r){t.accumulationDataLabelModule.findAreaRect();var n=St("div",{id:t.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];for(var a=[],o=[],l=0,h=this.points;l<h.length;l++){var u=h[l];u.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(u.y!==0||u.y===0&&this.emptyPointSettings.mode==="Zero"))&&t.accumulationDataLabelModule.renderDataLabel(u,this.dataLabel,i,this.points,this.index,n,r),u.midAngle>=90&&u.midAngle<=270?this.leftSidePoints.push(u):u.midAngle>=0&&u.midAngle<=90?o.push(u):a.push(u)}if(a.sort(function(d,p){return d.midAngle-p.midAngle}),o.sort(function(d,p){return d.midAngle-p.midAngle}),this.leftSidePoints.sort(function(d,p){return d.midAngle-p.midAngle}),this.rightSidePoints=a.concat(o),t.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,i,n,r),this.dataLabel.template!==null&&n.childElementCount){var c=t.accumulationDataLabelModule.drawDataLabels.bind(t.accumulationDataLabelModule,this,this.dataLabel,i,n,r);t.isReact&&t.renderReactTemplates(c),Mt(!1,Qe(t.element.id+"_Secondary_Element"),n,r)}Mt(!1,t.getSeriesElement(),i,r)},e.prototype.findMaxBounds=function(t,i){t.x=i.x<t.x?i.x:t.x,t.y=i.y<t.y?i.y:t.y,t.height=i.y+i.height>t.height?i.y+i.height:t.height,t.width=i.x+i.width>t.width?i.x+i.width:t.width},e.prototype.setAccEmptyPoint=function(t,i,r,n){if(!(m(t.y)||isNaN(t.y)))return null;switch(t.color=this.emptyPointSettings.fill||t.color,this.emptyPointSettings.mode){case"Zero":t.y=0,t.visible=!0;break;case"Average":var a=r[i-1]&&r[i-1][this.yName]||0,o=r[i+1]&&r[i+1][this.yName]||0;t.y=(Math.abs(a)+Math.abs(o))/2,this.sumOfPoints+=t.y,t.visible=!0;break;default:t.visible=!1;break}},e.prototype.isEmpty=function(t){return t.color===this.emptyPointSettings.fill},st([S("")],e.prototype,"dataSource",void 0),st([S()],e.prototype,"query",void 0),st([S("")],e.prototype,"xName",void 0),st([S("")],e.prototype,"name",void 0),st([S("")],e.prototype,"tooltipMappingName",void 0),st([S("")],e.prototype,"yName",void 0),st([S(!0)],e.prototype,"visible",void 0),st([Ee({color:null,width:0},Bn)],e.prototype,"border",void 0),st([Ee(null,WI)],e.prototype,"animation",void 0),st([S("SeriesType")],e.prototype,"legendShape",void 0),st([S("")],e.prototype,"legendImageUrl",void 0),st([S("")],e.prototype,"pointColorMapping",void 0),st([S(null)],e.prototype,"selectionStyle",void 0),st([S(null)],e.prototype,"groupTo",void 0),st([S("Value")],e.prototype,"groupMode",void 0),st([Ee({},N$)],e.prototype,"dataLabel",void 0),st([S([])],e.prototype,"palettes",void 0),st([S(0)],e.prototype,"startAngle",void 0),st([S(null)],e.prototype,"endAngle",void 0),st([S(null)],e.prototype,"radius",void 0),st([S("0")],e.prototype,"innerRadius",void 0),st([S("Pie")],e.prototype,"type",void 0),st([S(!0)],e.prototype,"enableTooltip",void 0),st([S(!1)],e.prototype,"explode",void 0),st([S("30%")],e.prototype,"explodeOffset",void 0),st([S(!1)],e.prototype,"explodeAll",void 0),st([S(null)],e.prototype,"explodeIndex",void 0),st([Ee({mode:"Drop"},o2)],e.prototype,"emptyPointSettings",void 0),st([S(0)],e.prototype,"gapRatio",void 0),st([S("80%")],e.prototype,"width",void 0),st([S("80%")],e.prototype,"height",void 0),st([S("20%")],e.prototype,"neckWidth",void 0),st([S("20%")],e.prototype,"neckHeight",void 0),st([S("Linear")],e.prototype,"pyramidMode",void 0),st([S(1)],e.prototype,"opacity",void 0),st([S("0")],e.prototype,"dashArray",void 0),e}(ke);function O$(s,e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(s===r.index)return r}return e[0]}function q2(s,e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.index===s)return r}return null}var KI=function(){function s(e){this.accumulation=e}return Object.defineProperty(s.prototype,"center",{get:function(){return this.pieCenter||(this.accumulation.visibleSeries[0].type==="Pie"?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(e){this.pieCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"radius",{get:function(){return this.pieRadius!==void 0?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(e){this.pieRadius=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"labelRadius",{get:function(){return this.pieLabelRadius!==void 0?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(e){this.pieLabelRadius=e},enumerable:!0,configurable:!0}),s.prototype.isCircular=function(){return this.accumulation.type==="Pie"},s.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},s.prototype.processExplode=function(e){if(e.target.id.indexOf("_Series_")>-1||e.target.id.indexOf("_datalabel_")>-1){var t=uv(e.target.id).point;if(isNaN(t)||e.target.id.indexOf("_datalabel_")>-1&&this.accumulation.visibleSeries[0].points[t].labelPosition==="Outside")return null;this.explodePoints(t,this.accumulation),this.deExplodeAll(t,this.accumulation.enableAnimation?300:0)}},s.prototype.invokeExplode=function(){for(var e=this.accumulation.visibleSeries[0],t=this.accumulation.enableAnimation?300:0,i=0,r=e.points;i<r.length;i++){var n=r[i];n.isExplode&&n.y!==0&&this.pointExplode(n.index,n,t)}if(this.accumulation.accumulationSelectionModule&&this.accumulation.selectionMode!=="None"&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(var a=0,o=this.accumulation.accumulationSelectionModule.selectedDataIndexes;a<o.length;a++){var l=o[a];this.explodePoints(l.point,this.accumulation,!0),this.deExplodeAll(l.point,t)}},s.prototype.deExplodeAll=function(e,t){for(var i=this.accumulation.element.id+"_Series_0_Point_",r=this.accumulation.visibleSeries[0].points,n=0,a=r;n<a.length;n++){var o=a[n];(e!==o.index&&!o.isSliced||o.isClubbed)&&(o.isExplode=!1,this.deExplodeSlice(o.index,i,t))}},s.prototype.explodePoints=function(e,t,i){i===void 0&&(i=!1);var r=t.visibleSeries[0],n=r.points,a=q2(e,n),o=!0,l=this.accumulation.enableAnimation?300:0;if(m(a))return null;var h=!i&&(a.isSliced||r.clubbedPoints.length&&n[n.length-1].index===r.clubbedPoints[r.clubbedPoints.length-1].index);r.type==="Pie"&&(h||a.isClubbed)&&(o=this.clubPointExplode(e,a,r,n,t,l,h)),o&&a.y!==0&&this.pointExplode(e,a,l,i)},s.prototype.getSum=function(e){var t=0;return e.map(function(i){t+=i.visible?i.y:0}),t},s.prototype.clubPointExplode=function(e,t,i,r,n,a,o){if(o===void 0&&(o=!1),t.isClubbed)return n.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map(function(h){h.visible=!0,h.isExplode=!0}),n.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(e,a),i.sumOfPoints=this.getSum(n.visibleSeries[0].points),n.refreshChart(),!1;if(o||t.isSliced){n.animateSeries=!1,r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var l=i.generateClubPoint();if(l.index=r.length,l.color=i.clubbedPoints[0].color,r.push(l),i.sumOfPoints=this.getSum(r),this.deExplodeAll(e,a),l.isExplode=!1,n.visibleSeries[0].points=r,n.refreshChart(),this.pointExplode(l.index,r[l.index],0,!0),l.isExplode=!1,this.deExplodeSlice(l.index,n.element.id+"_Series_0_Point_",a),t.isSliced)return!1}return!0},s.prototype.pointExplode=function(e,t,i,r){var n,a=this.accumulation.element.id+"_Series_0_Point_",o=this.accumulation;this.isCircular()?n=Jr(t.midAngle,o.explodeDistance,this.center):n={x:t.labelRegion&&t.labelRegion.x<t.region.x?-o.explodeDistance:o.explodeDistance,y:0},this.isExplode(a+e)||r?(t.isExplode=!0,this.explodeSlice(e,n,a,this.center||{x:0,y:0},i)):(t.isExplode=!1,this.deExplodeSlice(e,a,i))},s.prototype.isExplode=function(e){var t=Qe(e),i=t?t.getAttribute("transform"):null;return t&&(i==="translate(0, 0)"||i===null||i==="translate(0)")},s.prototype.deExplodeSlice=function(e,t,i){var r=Qe(t+e),n=r?r.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&r&&n&&n!=="translate(0, 0)"&&n!=="translate(0)"){var a=/translate\((-?\d+\.?\d*),?\s*(-?\d+[.]?\d*)?\)/.exec(n);this.performAnimation(e,t,0,0,+a[1],+a[2]||0,i,!0)}else this.performAnimation(e,t,0,0,0,0,i,!0)},s.prototype.setTranslate=function(e,t,i,r){this.setElementTransform(t+e,i),this.accumulation.visibleSeries[0].dataLabel.visible&&(t=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(t+"shape_"+e,i),this.setElementTransform(t+"text_"+e,i+r),this.setElementTransform(t+"connector_"+e,i))},s.prototype.setElementTransform=function(e,t){var i=Qe(e);i&&i.setAttribute("transform",t)},s.prototype.explodeSlice=function(e,t,i,r,n){this.performAnimation(e,i,0,0,t.x-r.x,t.y-r.y,n)},s.prototype.performAnimation=function(e,t,i,r,n,a,o,l){var h=this,u=this.accumulation,c=t.split("_"),d=parseInt(t.split("_")[c.length-3],10),p=u.visibleSeries[d].points[e];if(o<=0)return this.setTranslate(e,t,"translate("+n+", "+a+")",p.transform),null;var f,v;new ri({}).animate(St("div"),{duration:o,progress:function(g){f=gn(g.timeStamp,i,n,g.duration),v=gn(g.timeStamp,r,a,g.duration),h.setTranslate(e,t,"translate("+(l?n-f:f)+", "+(l?a-v:v)+")",p.transform)},end:function(){h.setTranslate(e,t,"translate("+(l?i:n)+", "+(l?i:a)+")",p.transform)}})},s}(),R$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),F$=function(s){R$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.initProperties=function(t,i){this.accumulation=t,this.size=Math.min(t.initialClipRect.width,t.initialClipRect.height),this.initAngles(i);var r=parseInt(i.radius,10);if((i.radius.indexOf("%")!==-1||typeof r=="number")&&!isNaN(r))this.isRadiusMapped=!1,this.pieBaseRadius=xi(i.radius,this.size/2),this.innerRadius=xi(i.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius=i.dataLabel.position==="Inside"?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+xi(i.dataLabel.connectorStyle.length||"4%",this.size/2);else{var n=[];this.isRadiusMapped=!0;for(var a=0;a<Object.keys(i.points).length;a++)i.points[a].sliceRadius.indexOf("%")!==-1?n[a]=xi(i.points[a].sliceRadius,this.size/2):n[a]=parseInt(i.points[a].sliceRadius,10);var o=Math.min.apply(null,n),l=Math.max.apply(null,n);this.pieBaseRadius=this.seriesRadius=l,this.innerRadius=xi(i.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>o?this.innerRadius/2:this.innerRadius}this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,t.explodeDistance=i.explode?xi(i.explodeOffset,this.pieBaseRadius):0,this.findCenter(t,i),this.center=this.pieBaseCenter,this.defaultLabelBound(i,i.dataLabel.visible,i.dataLabel.position),this.totalAngle-=.001},e.prototype.getLabelRadius=function(t,i){return t.dataLabel.position==="Inside"?(xi(i.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:xi(i.sliceRadius,this.seriesRadius)+xi(t.dataLabel.connectorStyle.length||"4%",this.size/2)},e.prototype.findCenter=function(t,i){this.accumulation=t,this.pieBaseCenter={x:xi(t.center.x,t.initialClipRect.width)+t.initialClipRect.x,y:xi(t.center.y,t.initialClipRect.height)+t.initialClipRect.y};var r=this.getSeriesBound(i),n=new ut(r.x+r.width/2,r.y+r.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-n.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-n.y,this.accumulation.origin=this.pieBaseCenter},e.prototype.initAngles=function(t){var i=m(t.endAngle)?t.startAngle:t.endAngle;this.totalAngle=(i-t.startAngle)%360,this.startAngle=t.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},e.prototype.defaultLabelBound=function(t,i,r){var n=this.getSeriesBound(t);t.accumulationBound=n,t.labelBound=new Ve(n.x,n.y,n.width+n.x,n.height+n.y),i&&r==="Outside"&&(t.labelBound=new Ve(1/0,1/0,-1/0,-1/0))},e.prototype.getSeriesBound=function(t){var i=new Ve(1/0,1/0,-1/0,-1/0);this.initAngles(t);var r=this.startAngle,n=this.totalAngle,a=(this.startAngle+n)%360;a=a===0?360:a,t.findMaxBounds(i,this.getRectFromAngle(r)),t.findMaxBounds(i,this.getRectFromAngle(a)),t.findMaxBounds(i,new Ve(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));var o=(Math.floor(r/90)*90+90)%360,l=Math.floor(a/90)*90%360;l=l===0?360:l,(n>=90||l===o)&&(t.findMaxBounds(i,this.getRectFromAngle(o)),t.findMaxBounds(i,this.getRectFromAngle(l))),(r===0||r+n>=360)&&t.findMaxBounds(i,this.getRectFromAngle(0));for(var h=o===l?0:Math.floor(n/90),u=1;u<h;u++)o=o+90,(o<l||a<r||n===360)&&t.findMaxBounds(i,this.getRectFromAngle(o));return i.width-=i.x,i.height-=i.y,i},e.prototype.getRectFromAngle=function(t){var i=Jr(t,this.pieBaseRadius,this.pieBaseCenter);return new Ve(i.x,i.y,0,0)},e.prototype.getPathArc=function(t,i,r,n,a){var o=r-i;o=o<0?o+360:o;var l=o<180?0:1;return!a&&a===0?this.getPiePath(t,Jr(i,n,t),Jr(r,n,t),n,l):this.getDoughnutPath(t,Jr(i,n,t),Jr(r,n,t),n,Jr(i,a,t),Jr(r,a,t),a,l)},e.prototype.getPiePath=function(t,i,r,n,a){return"M "+t.x+" "+t.y+" L "+i.x+" "+i.y+" A "+n+" "+n+" 0 "+a+" 1 "+r.x+" "+r.y+" Z"},e.prototype.getDoughnutPath=function(t,i,r,n,a,o,l,h){return"M "+i.x+" "+i.y+" A "+n+" "+n+" 0 "+h+" 1 "+r.x+" "+r.y+" L "+o.x+" "+o.y+" A "+l+" "+l+" 0 "+h+",0 "+a.x+" "+a.y+" Z"},e.prototype.doAnimation=function(t,i){var r=this,n=i.startAngle-90,a=this.accumulation.duration?this.accumulation.duration:i.animation.duration,o;this.pieBaseCenter.x+=1;var l=Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width)*.75;l+=l*.414;var h=qI("Linear");new ri({}).animate(t,{duration:a===0&&vi==="Enable"?1e3:a,delay:i.animation.delay,progress:function(u){o=h(u.timeStamp,n,r.totalAngle,u.duration),t.setAttribute("d",r.getPathArc(r.pieBaseCenter,n,o,l,0))},end:function(){r.pieBaseCenter.x-=1,t.setAttribute("d",r.getPathArc(r.pieBaseCenter,0,359.99999,l,0)),r.accumulation.trigger(GQ,r.accumulation.isBlazor?{}:{series:i,accumulation:r.accumulation,chart:r.accumulation});var u=Qe(r.accumulation.element.id+"_datalabel_Series_"+i.index);u&&(u.style.visibility=r.accumulation.isDestroyed?"hidden":"visible")}})},e}(KI),P$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),QM=function(s){P$(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.renderPoint=function(t,i,r,n,a,o){var l=i.sumOfPoints;t.startAngle=this.startAngle;var h=t.visible?t.y:0,u=l?Math.abs(h)/l*this.totalAngle:null,c=Math.PI/180*(90-(360-this.startAngle)-90);if(this.radius=this.isRadiusMapped?xi(t.sliceRadius,this.seriesRadius):this.radius,n.d=this.getPathOption(t,u,this.startAngle%360),t.midAngle=(this.startAngle-u/2)%360,t.endAngle=this.startAngle%360,t.symbolLocation=Jr(t.midAngle,(this.radius+this.innerRadius)/2,this.center),o){var d=r.renderer.drawPath(n);d.setAttribute("role","img"),d.setAttribute("tabindex",t.index===0?"0":"-1"),d.setAttribute("aria-label",t.x+": "+t.y+"%. "+i.name),a.appendChild(d),this.refresh(t,u,c,r,n)}else{var d=r.renderer.drawPath(n);d.setAttribute("role","img"),d.setAttribute("tabindex",t.index===0?"0":"-1"),d.setAttribute("aria-label",t.x+": "+t.y+"%. "+i.name),a.appendChild(d),t.degree=u,t.start=c}},e.prototype.findSeries=function(t){var i=3,r=2,n=this.innerRadius===0?this.radius+i:this.innerRadius-i,a=this.innerRadius===0?n+r:n-r;this.toggleInnerPoint(t,n,a)},e.prototype.toggleInnerPoint=function(t,i,r){var n=t.target,a=uv(n.id,!0),o=t.target.id.substring(0,t.target.id.indexOf("Series")-1),l=document.getElementById(this.accumulation.element.id+"PointHover_Border"),h,u=a.series,c=a.point,d=Qe(o+"_Series_"+u+"_Point_"+c);if(!isNaN(a.series)&&d){if(!m(u)&&!isNaN(u)&&!m(c)&&!isNaN(c)){var p=this.accumulation.visibleSeries[0].points[c],f=d.getAttribute("class")===o+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,v=this.getPathArc(this.accumulation.pieSeriesModule.center,p.startAngle%360,(p.startAngle+p.degree)%360,i,r);l&&o===this.accumulation.element.id&&(l.getAttribute("d")!==v||p.isExplode)&&(l.parentNode.removeChild(l),l=null);var g=Qe(o+"_Series_"+u);if(!l&&(!p.isExplode||p.isExplode&&t.type!=="click")){var b=new Er(o+"PointHover_Border",p.color,1,p.color,f,"",v);if(h=this.accumulation.renderer.drawPath(b),h.removeAttribute("transform"),this.accumulation.selectionMode!=="None"&&t.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(h,t.target.getAttribute("class")),g.appendChild(h),p.isExplode&&h){var y=d.getAttribute("transform");y&&h.setAttribute("transform",y)}}}}else l&&(this.removeBorder(l,1e3),l=null)},e.prototype.removeBorder=function(t,i){t&&setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},i)},e.prototype.refresh=function(t,i,r,n,a){var o=this,l=Qe(a.id),h=n.duration?n.duration:300;new ri({}).animate(St("div"),{duration:h,delay:0,progress:function(u){var c=gn(u.timeStamp,t.degree,i-t.degree,u.duration),d=gn(u.timeStamp,t.start,r-t.start,u.duration);d=(d/(Math.PI/180)+360)%360,l.setAttribute("d",o.getPathOption(t,c,d)),t.isExplode&&n.accBaseModule.explodePoints(t.index,n,!0),l.style.visibility="visible"},end:function(){l.style.visibility=t.visible?"visible":"hidden",l.setAttribute("d",a.d),t.degree=i,t.start=r}})},e.prototype.getPathOption=function(t,i,r){if(!i)return"";var n=this.getPathArc(this.center,r%360,(r+i)%360,this.isRadiusMapped?xi(t.sliceRadius,this.seriesRadius):this.radius,this.innerRadius);return this.startAngle+=i,n},e.prototype.animateSeries=function(t,i,r,n){var a=t.element.id+"SeriesGroup"+r.index;if((r.animation.enable&&vi!="Disable"||vi==="Enable")&&t.animateSeries){var o=t.renderer.createClipPath({id:a+"_clipPath"}),l=new Er(a+"_slice","transparent",1,"transparent",1,"",""),h=t.renderer.drawPath(l);o.appendChild(h),t.svgObject.appendChild(o),n.style.cssText="clip-path:url(#"+o.id+"); -webkit-clip-path:url(#"+o.id+");",this.doAnimation(h,r)}},e.prototype.getModuleName=function(){return"PieSeries"},e.prototype.destroy=function(){},e}(F$),z$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ft=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Y2=function(s){z$(e,s);function e(t,i){var r=s.call(this,t,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.currentLegendIndex=0,r.currentPointIndex=0,r.previousTargetId="",r.isLegendClicked=!1,r.chartid=57724,r}return e.prototype.animate=function(t){this.duration=t===0&&vi==="Enable"?700:t,this.animateselected=!0,this.animateSeries=!1;var i=0,r=[],n=[],a=[],o=this.visibleSeries[0],l=[];if(l=o.dataSource,o.sumOfPoints=0,o.points.length<Object.keys(o.dataSource).length)this.refresh();else if(o.points.length>Object.keys(o.dataSource).length){var h=this.visibleSeries[0];h.points=h.points.filter(function(p){return p.visible=!1,n.push(p.index),r.push(p.color),l.some(function(f){var v=f;return p.x===v.x&&(p.visible=!0,a.push(p.index),p.index=i,i++),p.x===v.x})});for(var u=n.filter(function(p){return a.indexOf(p)<0}),c=n.length-u.length,d=n.length-1;d>=c;d--)di("container_Series_0_Point_"+n[d]);for(var d=0;d<h.points.length;d++)h.points[d].y=h.dataSource[d].y,h.points[d].color=r[d],h.sumOfPoints+=h.dataSource[d].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(var d=0;d<o.points.length;d++)o.points[d].y=o.dataSource[d][o.yName],o.points[d].color=o.dataSource[d][o.pointColorMapping]!=null?o.dataSource[d][o.pointColorMapping]:o.points[d].color,o.sumOfPoints+=o.dataSource[d][o.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(o.points),this.renderElements()}},Object.defineProperty(e.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),e.prototype.preRender=function(){var t="Blazor";if(this.isBlazor=window[t],this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,this.element.id===""){var i=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+i}this.wireEvents(),this.element.setAttribute("dir",this.enableRtl?"rtl":"")},e.prototype.setTheme=function(){/*! Set theme for accumulation chart */this.themeStyle=z2(this.theme,!1)},e.prototype.render=function(){var t=this;this.element.className.indexOf("e-accumulationchart")===-1&&this.element.classList.add("e-accumulationchart"),this.element.setAttribute("role","region"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.title+". Syncfusion interactive chart."),this.element.setAttribute("class",this.element.getAttribute("class")+" e-accumulationchart-focused");var i={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:F0,cancel:!1};this.trigger(F0,i,function(){t.theme=t.isBlazor?i.theme:t.theme,t.setTheme(),t.accBaseModule=new KI(t),t.pieSeriesModule=new QM(t),t.calculateVisibleSeries(),t.processData(),t.renderComplete(),t.allowServerDataBinding=!0})},e.prototype.unWireEvents=function(){/*! Find the Events type */var t=B.isPointer,i=B.touchStartEvent,r=B.touchMoveEvent,n=B.touchEndEvent,a=t?"pointerleave":"mouseleave";/*! UnBind the Event handler */I.remove(this.element,r,this.accumulationMouseMove),I.remove(this.element,n,this.accumulationMouseEnd),I.remove(this.element,i,this.accumulationMouseStart),I.remove(this.element,"click",this.accumulationOnMouseClick),I.remove(this.element,"dblclick",this.accumulationOnDoubleClick),I.remove(this.element,"contextmenu",this.accumulationRightClick),I.remove(this.element,a,this.accumulationMouseLeave),I.remove(this.element,"keydown",this.accumulationChartKeyDown),I.remove(document.body,"keydown",this.documentKeyHandler),I.remove(this.element,"keyup",this.accumulationChartKeyUp),window.removeEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},e.prototype.wireEvents=function(){if(!this.element)return;/*! Find the Events type */var t=B.isPointer,i=B.touchStartEvent,r=B.touchEndEvent,n=B.touchMoveEvent,a=t?"pointerleave":"mouseleave";/*! Bind the Event handler */I.add(this.element,n,this.accumulationMouseMove,this),I.add(this.element,r,this.accumulationMouseEnd,this),I.add(this.element,i,this.accumulationMouseStart,this),I.add(this.element,"click",this.accumulationOnMouseClick,this),I.add(this.element,"dblclick",this.accumulationOnDoubleClick,this),I.add(this.element,"contextmenu",this.accumulationRightClick,this),I.add(this.element,a,this.accumulationMouseLeave,this),I.add(this.element,"keydown",this.accumulationChartKeyDown,this),I.add(document.body,"keydown",this.documentKeyHandler,this),I.add(this.element,"keyup",this.accumulationChartKeyUp,this),this.accumulationResizeBound=this.accumulationResize.bind(this),window.addEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound),new Pn(this.element);/*! Apply the style for chart */this.setStyle(this.element)},e.prototype.setMouseXY=function(t){var i,r,n=Qe(this.element.id+"_svg");if(n&&this.element){var a=n.getBoundingClientRect(),o=this.element.getBoundingClientRect();if(t.type.indexOf("touch")>-1){this.isTouch=!0;var l=t;r=l.changedTouches[0].clientY,i=l.changedTouches[0].clientX}else this.isTouch=t.pointerType==="touch"||t.pointerType==="2",i=t.clientX,r=t.clientY;this.mouseY=r-o.top-Math.max(a.top-o.top,0),this.mouseX=i-o.left-Math.max(a.left-o.left,0)}},e.prototype.accumulationMouseEnd=function(t){return this.setMouseXY(t),this.trigger(C2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(t,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(t)),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(t),this.notify(B.touchEndEvent,t),!1},e.prototype.accumulationMouseStart=function(t){return this.setMouseXY(t),this.trigger(b2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.accumulationResize=function(){var t=this;this.animateSeries=!1;var i={accumulation:this.isBlazor?{}:this,previousSize:new ei(this.availableSize.width,this.availableSize.height),name:B0,currentSize:new ei(0,0),chart:this.isBlazor?{}:this},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(S2,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(t.isDestroyed){clearTimeout(t.resizeTo);return}R2(t),i.currentSize=t.availableSize,t.trigger(B0,i),t.refreshSeries(),t.refreshChart()},500)),!1},e.prototype.print=function(t){var i=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="";var r=new _2(this);r.print(t),document.getElementById(this.element.id+"_Series_0").style.clipPath=i},e.prototype.export=function(t,i){this.exportModule&&(this.exportModule.export(t,i),this.afterExport&&this.exportModule.getDataUrl(this))},e.prototype.setStyle=function(t){t.style.touchAction="element",t.style.msTouchAction="element",t.style.msContentZooming="none",t.style.msUserSelect="none",t.style.webkitUserSelect="none",t.style.position="relative",t.style.display="block",t.style.height=t.style.height||this.height&&this.height.indexOf("%")===-1?t.style.height:"inherit";var i="";switch(this.theme){case"HighContrastLight":case"HighContrast":i="#969696";break;case"MaterialDark":case"FabricDark":case"Bootstrap":case"Bootstrap4":i="#66afe9";break;case"Tailwind":case"TailwindDark":i="#4f46e5";break;case"Bootstrap5":case"Bootstrap5Dark":i="#0d6efd";break;case"Fluent":case"FluentDark":i="#9e9e9e";break;default:i="#9e9e9e";break}var r=document.createElement("style");r.setAttribute("id",t.id+"Keyboard_accumulationchart_focus"),r.innerText=".e-accumulationchart-focused:focus,path[id*=_Series_0_Point_]:focus, text[id*=_title]:focus{outline: none} .e-accumulationchart-focused:focus-visible,path[id*=_Series_0_Point_]:focus-visible, text[id*=_title]:focus-visible{outline: 1.5px "+i+" solid}",document.body.appendChild(r)},e.prototype.setAnnotationValue=function(t,i){var r=this.annotations[t],n,a=Qe(this.element.id+"_Annotation_Collections");i&&(r.content=i,a?(n=this.createElement("div"),di(this.element.id+"_Annotation_"+t),this.annotationModule.processAnnotation(r,t,n),a.appendChild(n.children[0])):this.annotationModule.renderAnnotations(Qe(this.element.id+"_Secondary_Element")))},e.prototype.accumulationMouseMove=function(t){return Qe(this.element.id+"_svg")&&(this.setMouseXY(t),this.trigger(p2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(g2,t.target,t),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(t),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(t,this.mouseX,this.mouseY),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(t),this.isTouch||this.titleTooltip(t,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&this.type==="Pie"&&this.pieSeriesModule&&Mn(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(t),this.notify(B.touchMoveEvent,t)),!1},e.prototype.titleTooltip=function(t,i,r,n){var a=t.target.id,o=a===this.element.id+"_title"||a===this.element.id+"_subTitle"||a===this.element.id+"_chart_legend_title";if(t.target.textContent.indexOf("...")>-1&&o){var l=a===this.element.id+"_title"?this.title:a===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title;Ld(l,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",Qe(this.element.id+"_Secondary_Element"),n)}else di(this.element.id+"_EJ2_Title_Tooltip")},e.prototype.accumulationChartKeyDown=function(t){var i="";return this.tooltip.enable&&(t.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||t.code==="Escape")&&(i="ESC"),t.code.indexOf("Arrow")>-1&&t.preventDefault(),t.ctrlKey&&t.key==="p"&&(t.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(t,t.target.id,i),!1},e.prototype.accumulationChartKeyUp=function(t){var i="",r=t.target.id,n=Qe(this.element.id+"_chart_legend_translate_g"),a=Qe(this.element.id+"_chart_legend_pageup");if(n){var o=n.firstElementChild,l=o.getAttribute("class");l&&l.indexOf("e-accumulationchart-focused")===-1?l=l+" e-accumulationchart-focused":l||(l="e-accumulationchart-focused"),o.setAttribute("class",l)}if(a&&a.setAttribute("class","e-accumulationchart-focused"),t.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Point_")>-1&&r.indexOf("_Point_")===-1){var h=document.getElementById(this.previousTargetId).parentElement;this.setTabIndex(h.children[this.currentPointIndex],h.firstElementChild),this.currentPointIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(t.target,a):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("chart_legend_g_")===-1&&this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild);this.previousTargetId=r,r.indexOf("_chart_legend_g_")>-1&&this.highlightMode!=="None"?(r=t.target.lastElementChild.id,i="Tab"):r.indexOf("_Point_")>-1&&(this.highlightMode!=="None"||this.tooltip.enable)&&(i="Tab")}else if(t.code.indexOf("Arrow")>-1){if(t.preventDefault(),r.indexOf("_chart_legend_page")>-1)t.target.removeAttribute("tabindex"),this.previousTargetId=r=this.element.id+"_chart_legend_page"+(t.code==="ArrowRight"?"up":"down"),this.focusTarget(Qe(r));else if(r.indexOf("_chart_legend_")>-1){t.target.removeAttribute("tabindex"),this.currentLegendIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,n.children.length);var u=n.children[this.currentLegendIndex];this.focusTarget(u),this.previousTargetId=r=u.lastElementChild.id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Point_")>-1){t.target.setAttribute("tabindex","-1"),this.currentPointIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1;for(var c=0,d=0;d<t.target.parentElement.children.length;d++)c=t.target.parentElement.children[d].id.indexOf("_Point_")>-1?c+1:c;this.currentPointIndex=this.getActualIndex(this.currentPointIndex,c),r=this.element.id+"_Series_0_Point_"+this.currentPointIndex,this.focusTarget(Qe(r)),i=this.tooltip.enable?"ArrowMove":""}}else(t.code==="Enter"||t.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_g")>-1?t.target.lastElementChild.id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(t,r,i),!1},e.prototype.setTabIndex=function(t,i){t&&t.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},e.prototype.getActualIndex=function(t,i){return t>i-1?0:t<0?i-1:t},e.prototype.focusTarget=function(t){var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i=i+" e-accumulationchart-focused":i||(i="e-accumulationchart-focused"),t.setAttribute("tabindex","0"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.documentKeyHandler=function(t){t.altKey&&t.keyCode===74&&!m(this.element)&&this.element.focus()},e.prototype.chartKeyboardNavigations=function(t,i,r){switch(this.isLegendClicked=!1,r){case"Tab":case"ArrowMove":if(this.accumulationHighlightModule,i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],a=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],o=this.visibleSeries[n].points[a].symbolLocation;if(this.mouseX=o.x+this.initialClipRect.x,this.mouseY=o.y+this.initialClipRect.y,this.accumulationHighlightModule){var l=Qe(i);if(!m(l)){if(l.id.indexOf("text")>1&&(l=Qe(l.id.replace("text","shape"))),l.hasAttribute("class")&&l.getAttribute("class").indexOf("highlight")>-1)return;this.accumulationHighlightModule.calculateSelectedElements(this,l,"mousemove");return}}if(this.accumulationTooltipModule){var h=this.visibleSeries[n],u=void 0;h.enableTooltip&&(u=new nf(h.points[a],h)),this.accumulationTooltipModule.renderSeriesTooltip(this,u)}}if(this.accumulationHighlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var c=this.element.id+"_chart_legend",d=[c+"_text_",c+"_shape_marker_",c+"_shape_"],p=0;p<d.length;p++){var f=d[p];if(i.indexOf(f)>-1){document.getElementById(i).setAttribute("class",""),this.accumulationHighlightModule.legendSelection(this,0,parseInt(i.split(f)[1],10),Qe(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1&&this.accumulationLegendModule?(this.isLegendClicked=!0,this.accumulationLegendModule.click(t),this.focusChild(document.getElementById(i).parentElement)):this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,document.getElementById(i),"click");break;case"CtrlP":this.print();break;case"ESC":this.accumulationTooltipModule&&this.accumulationTooltipModule.removeTooltip(1);break}},e.prototype.focusChild=function(t){t.setAttribute("tabindex","0");var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i="e-accumulationchart-focused "+i:i||(i="e-accumulationchart-focused"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.accumulationOnDoubleClick=function(t){return this.trigger(v2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.accumulationOnMouseClick=function(t){return this.setMouseXY(t),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(t),this.selectionMode!=="None"&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,t.target,t.type),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(t),this.enableBorderOnMouseMove&&this.pieSeriesModule&&this.type==="Pie"&&this.pieSeriesModule.findSeries(t),this.trigger(f2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent(m2,t.target,t),!1},e.prototype.triggerPointEvent=function(t,i,r){var n=r,a=uv(i.id,!0);a.series>=0&&a.point>=0&&this.trigger(t,{series:this.isBlazor?{}:this.series[a.series],point:this.series[a.series].points[a.point],seriesIndex:a.series,pointIndex:a.point,x:this.mouseX,y:this.mouseY,pageX:n.pageX,pageY:n.pageY})},e.prototype.accumulationRightClick=function(t){return t.buttons===2||t.pointerType==="touch"?(t.preventDefault(),t.stopPropagation(),!1):!0},e.prototype.accumulationMouseLeave=function(t){this.setMouseXY(t),this.trigger(y2,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.notify(B.isPointer?"pointerleave":"mouseleave",t);var i=document.getElementById(this.element.id+"PointHover_Border");return i&&(this.pieSeriesModule.removeBorder(i,1e3),i=null),!1},e.prototype.setCulture=function(){this.intl=new _t},e.prototype.createPieSvg=function(){this.removeSvg(),F2(this)},e.prototype.removeSvg=function(){if(this.redraw)return null;if(kb(this),di(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&pt(this.svgObject)}di("EJ2_legend_tooltip"),di("EJ2_datalabel_tooltip"),di(this.element.id+"PointHover_Border")},e.prototype.createSecondaryElement=function(){var t=ga(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});Mt(!1,this.element,t,this.redraw)},e.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var t=0,i=this.series.length;t<i;t++)if(this.series[t].index=t,this.series[t].type===this.type&&this.visibleSeries.length===0){this.visibleSeries.push(this.series[t]);break}},e.prototype.processData=function(t){t===void 0&&(t=!0),this.seriesCounts=0;for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.dataModule=new B2(n.dataSource||this.dataSource,n.query),n.refreshDataManager(this,t)}},e.prototype.refreshChart=function(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),di("chartmeasuretext")},e.prototype.doGrouppingProcess=function(){var t=this.visibleSeries[0];!m(t.resultData)&&!m(t.lastGroupTo)&&t.lastGroupTo!==t.groupTo&&t.getPoints(t.resultData,this)},e.prototype.calculateBounds=function(){this.initialClipRect=new Ve(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];var t=0,i=0,r=0,n=0;if(this.title&&(this.titleCollection=Od(this.title,this.titleStyle,this.initialClipRect.width,this.enableRtl,this.themeStyle.chartTitleFont)),t=this.title?ht(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length:t,this.subTitle){for(var a=0,o=this.titleCollection;a<o.length;a++){var l=o[a];n=ht(l,this.titleStyle,this.themeStyle.chartSubTitleFont).width,r=n>r?n:r}this.subTitleCollection=Od(this.subTitle,this.subTitleStyle,r,this.enableRtl,this.themeStyle.chartTitleFont),i=ht(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length}dG(this.initialClipRect,new Ve(0,i+t,this.margin.right+this.margin.left,this.margin.bottom+this.margin.top)),this.calculateLegendBounds()},e.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},e.prototype.renderElements=function(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderCenterLabel(!0),this.renderLegend(),Mt(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition(),this.element.id+"",this.series[0].dataLabel,this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this}),this.animateSeries=!1},e.prototype.setSecondaryElementPosition=function(){var t=Qe(this.element.id+"_Secondary_Element");if(t){var i=this.element.getBoundingClientRect(),r=Qe(this.element.id+"_svg").getBoundingClientRect();t.style.left=Math.max(r.left-i.left,0)+"px",t.style.top=Math.max(r.top-i.top,0)+"px"}},e.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(Qe(this.element.id+"_Secondary_Element"))},e.prototype.processExplode=function(){if(this.redraw||!this.visibleSeries[0].explode)return null;this.accBaseModule.invokeExplode()},e.prototype.renderSeries=function(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];r.visible&&this[ao(r.type)+"SeriesModule"]&&(this[ao(r.type)+"SeriesModule"].initProperties(this,r),r.renderSeries(this,this.redraw))}},e.prototype.renderBorder=function(){var t=this.border.width,i=new aa(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new Ve(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t)),r=this.renderer.drawRectangle(i);r.setAttribute("aria-hidden","true"),Mt(!1,this.svgObject,r,this.redraw);var n=this.backgroundImage;if(n){var a=new YM(this.availableSize.height-t,this.availableSize.width-t,n,0,0,this.element.id+"_background","visible","none");Mt(!1,this.svgObject,this.renderer.drawImage(a),this.redraw)}},e.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&(this.visibleSeries[0].type==="Pie"&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},e.prototype.processSelection=function(){var t=[];this.accumulationSelectionModule&&this.selectionMode!=="None"&&(t=me([],this.accumulationSelectionModule.selectedDataIndexes,null,!0),this.accumulationSelectionModule.invokeSelection(this)),this.accumulationHighlightModule&&this.highlightMode!=="None"&&this.accumulationHighlightModule.invokeHighlight(this),t.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=t,this.accumulationSelectionModule.redrawSelection(this))},e.prototype.renderTitle=function(){var t=this.margin;if(!this.title)return null;var i=Zh(this.titleStyle.textAlignment,this.enableRtl),r=ht(this.title,this.titleStyle,this.themeStyle.chartTitleFont),n=20,a=this.margin.top+r.height*3/4,o=this.accumulationLegendModule===void 0?0:this.legendSettings.position==="Top"?this.accumulationLegendModule.legendBounds.height:0,l=this.explodeDistance===0?0:this.explodeDistance,h=o!==0?0:l/2,u=new Ve(t.left,0,this.availableSize.width-t.left-t.right,0),c=new Sn(this.element.id+"_title",$c(u,this.titleStyle),a,i,this.titleCollection,"","auto"),d=this.series[0].type==="Pie"&&this.visibleSeries[0].dataLabel.position==="Outside"&&this.visibleSeries[0].dataLabel.connectorStyle.length?xi(this.visibleSeries[0].dataLabel.connectorStyle.length,this.accBaseModule.radius):0;!this.subTitle&&this.series[0].type!=="Funnel"&&this.series[0].type!=="Pyramid"&&(c.y=parseInt(this.series[0].radius)>=80?c.y:this.accBaseModule.center.y-this.accBaseModule.radius-n-a-o-h-d,this.series[0].type==="Pie"&&(parseInt(this.series[0].radius)<80||isNaN(parseInt(this.series[0].radius)))&&(c.y=c.y<this.initialClipRect.y-o?this.initialClipRect.y-o:c.y));var p=bn(this.renderer,c,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont);p&&(p.setAttribute("tabindex","0"),p.parentNode.insertBefore(p,this.svgObject.children&&this.svgObject.children[1])),this.subTitle&&this.renderSubTitle(c)},e.prototype.updateCenterLabel=function(t){var i=this.getPieData(t);this.format=i.point==null?"":this.parseFormat(i.point,this.visibleSeries[0],this.centerLabel.hoverTextFormat),this.renderCenterLabel()},e.prototype.getPieData=function(t){var i=uv(t.target.id,!0);return isNaN(i.series)?new nf(null,null):new nf(this.visibleSeries[0].points[i.point],this.visibleSeries[0])},e.prototype.parseFormat=function(t,i,r){for(var n,a,o=0,l=Object.keys(t);o<l.length;o++){var h=l[o];n=new RegExp("${point."+h+"}","gm"),r=r.replace(n.source,t[h])}for(var u=0,c=Object.keys(Object.getPrototypeOf(i));u<c.length;u++){var h=c[u];n=new RegExp("${series."+h+"}","gm"),a=i[h],r=r.replace(n.source,a)}return r},e.prototype.renderCenterLabel=function(t){if(!this.centerLabel.text)return null;for(var i=this.series[0],r,n=Zh(this.centerLabel.textStyle.textAlignment,this.enableRtl),a=10,o=this.pieSeriesModule.innerRadius?2*this.pieSeriesModule.innerRadius*.7071067:2*this.pieSeriesModule.radius*.7071067,l=(this.format||this.centerLabel.text).split("<br>"),h=ht(l[0],this.centerLabel.textStyle,this.themeStyle.chartTitleFont),u=l.length,c=0;c<u;c++){var d=ht(l[c],this.centerLabel.textStyle,this.themeStyle.chartTitleFont);d.width>o&&l.splice.apply(l,[c,1].concat(dh(l[c],o,this.centerLabel.textStyle,this.enableRtl,null,null,this.themeStyle.chartTitleFont)))}h.height*l.length>o?r=this.accBaseModule.center.y+(h.height+a)/2-o/2:i.startAngle&&i.endAngle?(r=this.accBaseModule.center.y-h.height*l.length/2+(h.height+a)/2-this.pieSeriesModule.innerRadius/2+(this.pieSeriesModule.innerRadius?a:0),h.height*l.length+this.pieSeriesModule.innerRadius/2+a>o&&(r=this.accBaseModule.center.y+(h.height+a)/2-o/2)):r=this.accBaseModule.center.y-h.height*l.length/2+(h.height+a)/2;for(var p=new Sn(this.element.id+"_centerLabel",(this.series[0].animation.enable&&vi!="Disable"||vi==="Enable")&&t?this.pieSeriesModule.center.x-1:this.pieSeriesModule.center.x,r,n,"","","auto"),f=bn(this.renderer,p,this.centerLabel.textStyle,this.centerLabel.textStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont),c=0;c<l.length;c++){var v={x:p.x,y:p.y+c*h.height,fill:""},g=this.renderer.createTSpan(v,"");g.style.fontFamily="inherit",g.style.fontStyle="inherit",g.style.fontSize="inherit",g.style.fontWeight=l[c].indexOf("<b>")>-1||l[c].indexOf("</b>")>-1?"bold":"inherit",g.textContent=l[c].replace(/<\/?b>/g,""),f.appendChild(g)}t&&(this.series[0].animation.enable&&vi!="Disable"||vi==="Enable")&&this.animateSeries&&this.centerLabelDelay(f)},e.prototype.centerLabelDelay=function(t){t.style.visibility="hidden";var i=new ri({});i.animate(t,{delay:this.duration?this.duration:this.series[0].animation.duration,progress:function(r){r.element.style.visibility="visible"}})},e.prototype.renderSubTitle=function(t){for(var i=0,r=0,n=10,a=this.titleStyle.textAlignment,o=ht(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont),l=0,h=this.titleCollection;l<h.length;l++){var u=h[l];r=ht(u,this.titleStyle,this.themeStyle.chartSubTitleFont).width,i=r>i?r:i}var c=new Ve(a==="Center"?t.x-i/2:a==="Far"?t.x-i:t.x,0,i,0),d=new Sn(this.element.id+"_subTitle",$c(c,this.subTitleStyle),t.y*t.text.length+o.height*3/4+n,Zh(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,"","auto");bn(this.renderer,d,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartSubTitleFont)},e.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},e.prototype.refreshSeries=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];this.refreshPoints(r.points)}},e.prototype.refreshPoints=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n.labelPosition=null,n.labelRegion=null,n.labelVisible=!0}},e.prototype.getModuleName=function(){return"accumulationchart"},e.prototype.destroy=function(){if(this.element){this.unWireEvents(),s.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.element.classList.remove("e-accumulationchart-focused");var t=document.getElementById(this.element.id+"Keyboard_accumulationchart_focus");t&&t.remove(),di("chartmeasuretext"),this.removeSvg(),this.svgObject=null}},e.prototype.requiredModules=function(){var t=[],i=!1;return t.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&t.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&t.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&t.push({member:"AccumulationTooltip",args:[this]}),this.selectionMode!=="None"&&t.push({member:"AccumulationSelection",args:[this]}),this.highlightMode!=="None"&&t.push({member:"AccumulationHighlight",args:[this]}),(this.enableExport||this.allowExport)&&t.push({member:"Export",args:[this]}),i=this.annotations.some(function(r){return r.content!==null}),i&&t.push({member:"Annotation",args:[this]}),t},e.prototype.findDatalabelVisibility=function(){for(var t=0,i=this.series;t<i.length;t++){var r=i[t];if(r.dataLabel.visible)return!0}return!1},e.prototype.changeVisibleSeries=function(t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(i===a.index)return a}return null},e.prototype.getPersistData=function(){return""},e.prototype.onPropertyChanged=function(t,i){for(var r={refreshElements:!1,refreshBounds:!1},n=0,a=Object.keys(t);n<a.length;n++){var o=a[n];switch(o){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":r.refreshBounds=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"legendSettings":r.refreshBounds=!0,r.refreshElements=!0;break;case"dataSource":this.processData(!1),r.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var l=this.series.length,h=!1,u=void 0,c=void 0,d=0;d<l;d++)u=t.series[d],this.isBlazor&&(u.startAngle||u.endAngle||u.explodeOffset||u.neckHeight||u.neckWidth||u.radius||u.innerRadius||u.groupMode||u.emptyPointSettings)&&(c=!0),t.series[d]&&(t.series[d].dataSource||t.series[d].yName||t.series[d].xName||u.type||t.series[d].dataLabel||c)&&(me(this.changeVisibleSeries(this.visibleSeries,d),u,null,!0),h=!0),t.series[d]&&!m(t.series[d].explodeIndex)&&t.series[d].explodeIndex>=0&&t.series[d].explodeIndex!==i.series[d].explodeIndex?(this.accBaseModule.explodePoints(t.series[d].explodeIndex,this),this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0)):t.series[d].explodeIndex<0&&this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0),this.pieSeriesModule||(this.pieSeriesModule=new QM(this));h&&(this.processData(!1),r.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"enableRtl":case"locale":case"currencyCode":s.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":r.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&(m(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):(this.accumulationSelectionModule.selectedDataIndexes=this.selectedDataIndexes,this.accumulationSelectionModule.redrawSelection(this)));break;case"tooltip":this.accumulationTooltipModule&&(this.accumulationTooltipModule.previousPoints=[],this.tooltip.template&&(this.accumulationTooltipModule.template=this.tooltip.template));break}}!r.refreshBounds&&r.refreshElements?(this.createPieSvg(),this.renderElements()):r.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},ft([S(null)],e.prototype,"width",void 0),ft([S(null)],e.prototype,"height",void 0),ft([S(null)],e.prototype,"title",void 0),ft([S(null)],e.prototype,"backgroundImage",void 0),ft([Ee({},k$)],e.prototype,"center",void 0),ft([S("")],e.prototype,"dataSource",void 0),ft([Ee({fontFamily:null,size:"16px",fontStyle:"Normal",fontWeight:"600",color:null},cs)],e.prototype,"titleStyle",void 0),ft([S(null)],e.prototype,"subTitle",void 0),ft([Ee({fontFamily:null,size:"14px",fontStyle:"Normal",fontWeight:"400",color:null},cs)],e.prototype,"subTitleStyle",void 0),ft([Ee({},V2)],e.prototype,"legendSettings",void 0),ft([Ee({},l2)],e.prototype,"tooltip",void 0),ft([Ee({},PQ)],e.prototype,"centerLabel",void 0),ft([S("None")],e.prototype,"selectionMode",void 0),ft([S("")],e.prototype,"highlightColor",void 0),ft([S("None")],e.prototype,"highlightMode",void 0),ft([S("None")],e.prototype,"selectionPattern",void 0),ft([S("None")],e.prototype,"highlightPattern",void 0),ft([S(!0)],e.prototype,"enableBorderOnMouseMove",void 0),ft([S(!1)],e.prototype,"isMultiSelect",void 0),ft([S(!0)],e.prototype,"enableAnimation",void 0),ft([ii([],a2)],e.prototype,"selectedDataIndexes",void 0),ft([Ee({},Ab)],e.prototype,"margin",void 0),ft([S(!0)],e.prototype,"enableSmartLabels",void 0),ft([Ee({color:"#DDDDDD",width:0},Bn)],e.prototype,"border",void 0),ft([S(null)],e.prototype,"background",void 0),ft([ii([{}],L$)],e.prototype,"series",void 0),ft([ii([{}],A$)],e.prototype,"annotations",void 0),ft([S("Material")],e.prototype,"theme",void 0),ft([S(!1)],e.prototype,"useGroupingSeparator",void 0),ft([S(!0)],e.prototype,"enableExport",void 0),ft([S(!1)],e.prototype,"allowExport",void 0),ft([_()],e.prototype,"loaded",void 0),ft([_()],e.prototype,"legendClick",void 0),ft([_()],e.prototype,"load",void 0),ft([_()],e.prototype,"seriesRender",void 0),ft([_()],e.prototype,"legendRender",void 0),ft([_()],e.prototype,"textRender",void 0),ft([_()],e.prototype,"tooltipRender",void 0),ft([_()],e.prototype,"pointRender",void 0),ft([_()],e.prototype,"annotationRender",void 0),ft([_()],e.prototype,"beforePrint",void 0),ft([_()],e.prototype,"chartMouseMove",void 0),ft([_()],e.prototype,"chartMouseClick",void 0),ft([_()],e.prototype,"chartDoubleClick",void 0),ft([_()],e.prototype,"pointClick",void 0),ft([_()],e.prototype,"pointMove",void 0),ft([_()],e.prototype,"animationComplete",void 0),ft([_()],e.prototype,"chartMouseDown",void 0),ft([_()],e.prototype,"chartMouseLeave",void 0),ft([_()],e.prototype,"chartMouseUp",void 0),ft([_()],e.prototype,"beforeResize",void 0),ft([_()],e.prototype,"resized",void 0),ft([_()],e.prototype,"afterExport",void 0),ft([_()],e.prototype,"selectionComplete",void 0),ft([S("USD")],e.prototype,"currencyCode",void 0),e=ft([Ot],e),e}(Pi),j$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),B$=function(s){j$(e,s);function e(t){var i=s.call(this,t)||this;return i.library=i,i.titleRect=new Ve(0,t.margin.top,0,0),i.addEventListener(),i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMove,this),this.chart.on(B.touchEndEvent,this.mouseEnd,this),this.chart.on("click",this.click,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(B.touchEndEvent,this.mouseEnd))},e.prototype.mouseMove=function(t){this.chart.legendSettings.visible&&!this.chart.isTouch&&this.chart.accumulationHighlightModule&&this.chart.highlightMode!=="None"&&this.click(t)},e.prototype.mouseEnd=function(t){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(t)},e.prototype.getLegendOptions=function(t,i){this.legendCollections=[],this.isRtlEnable=t.enableRtl,this.isReverse=!this.isRtlEnable&&t.legendSettings.reverse;for(var r=0;r<1;r++){var n=i[r].type;(n==="Pie"||n==="Doughnut")&&(n=i[r].innerRadius!=="0"&&i[r].innerRadius!=="0%"?"Doughnut":"Pie");for(var a=0,o=i[r].points;a<o.length;a++){var l=o[a];!m(l.x)&&!m(l.y)&&this.legendCollections.push(new lc(l.x.toString(),l.color,i[r].legendShape,l.visible,n,l.legendImageUrl,null,null,l.index,i[r].index))}this.isReverse&&this.legendCollections.reverse()}},e.prototype.getLegendBounds=function(t,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title;var n=0,a=0,o;this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var l=r.padding,h=r.titlePosition,u=0,c=this.arrowWidth,d=r.enablePages?0:this.arrowHeight;this.isVertical?n=r.width?0:t.width/100*5:a=r.height?0:t.height/100*5,i.width+=n,i.height+=a;var p=r.shapePadding,f=r.maximumLabelWidth?r.maximumLabelWidth:0,v=r.shapeWidth,g=0,b=0,y=0,C=[],x=[],w=0,M=0,E=0,T=0,D=0;this.maxItemHeight=Math.max(ht("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);for(var N,A=!1,L=0;L<this.legendCollections.length;L++)if(o=this.legendCollections[L],N={fill:o.fill,text:o.text,shape:o.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",N),o.render=!N.cancel,o.text=N.text.indexOf("&")>-1?this.convertHtmlEntities(N.text):N.text,o.fill=N.fill,o.shape=N.shape,o.textSize=ht(o.text,r.textStyle,this.chart.themeStyle.legendLabelFont),o.render&&o.text!=="")if(A=!0,T=v+p+(r.maximumLabelWidth?r.maximumLabelWidth:o.textSize.width)+(this.isVertical||L===0?l:this.itemPadding),this.getLegendHeight(o,r,i,g,this.maxItemHeight,l),this.isVertical)E+=o.textSize.height+(L===0?l:this.itemPadding),E+this.itemPadding+d/this.pageButtonSize>i.height&&(g=g+f,w=this.getPageWidth(x),this.totalPages=Math.max(y,this.totalPages||1),g-w+T>i.width?(x.push(g-w),y=this.rowHeights.length,M=y):y=M,C.push(f),f=0,E=o.textSize.height+l,o.textSize.height+l,b++),this.columnHeights[b]=(this.columnHeights[b]?this.columnHeights[b]:0)+o.textSize.height+(L===0?l:this.itemPadding),f=Math.max(T,f),this.rowHeights[y]=Math.max(this.rowHeights[y]?this.rowHeights[y]:0,o.textSize.height),y++;else{r.enablePages||(u=this.isTitle&&h!=="Top"?this.legendTitleSize.width+this.fivePixel:0,u+=c),g=g+T,i.width<l+g+u&&(f=Math.max(f,g+l+u-T),y===0&&T!==g&&(y=1),g=T,y++,b=0);var k=y&&y-1;this.rowHeights[k]=Math.max(this.rowHeights[k]?this.rowHeights[k]:0,o.textSize.height),this.columnHeights[b]=(this.columnHeights[b]?this.columnHeights[b]:0)+o.textSize.height+l,b++}D=h==="Top"?this.legendTitleSize.height:0,this.isVertical?(g=g+f,this.isPaging=i.width<g+l,E=Math.max.apply(null,this.columnHeights)+l+d+D,E=Math.max(E,(this.totalPages||1)*(this.maxItemHeight+l)+l+d),this.isPaging=this.isPaging&&this.totalPages>1,C.push(f)):(this.totalPages=this.totalRowCount=y,E=Math.max.apply(null,this.columnHeights)+l+d+D,this.isPaging=i.height<E,E=!r.enablePages&&this.isPaging?this.maxItemHeight+l+l+D:E,E=Math.max(E,this.maxItemHeight+l+l+D),this.isPaging||(g+=this.isTitle&&h!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;var O=this.isVertical?this.getMaxColumn(C,i.width,l,g+l):Math.max(g+l,f);A?this.setBounds(O,E,r,i):this.setBounds(0,0,r,i)},e.prototype.getPageWidth=function(t){for(var i=0,r=0;r<t.length;r++)i+=t[r];return i},e.prototype.getLegendHeight=function(t,i,r,n,a,o){var l=t.textSize.width,h=i.shapePadding+o*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?t.textCollection=dh(t.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,null,null,this.chart.themeStyle.legendLabelFont):t.textCollection.push(t.text),t.textSize.height=a*t.textCollection.length;break}},e.prototype.convertHtmlEntities=function(t){var i=t.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","¢").replace("&pound;","£").replace("&yen;","¥").replace("&euro;","€").replace("&copy;","©").replace("&reg;","®");return i=i.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","¢").replace("&#163;","£").replace("&#165;","¥").replace("&#8364;","€").replace("&#169;","©").replace("&#174;","®"),i},e.prototype.getMaxColumn=function(t,i,r,n){var a=r;this.maxColumnWidth=Math.max.apply(null,t);for(var o=0,l=t;o<l.length;o++)if(l[o],a+=this.maxColumnWidth,this.maxColumns++,a+r>i){a-=this.maxColumnWidth,this.maxColumns--;break}this.isPaging=a<n&&this.totalPages>1,a===r&&(a=i),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=a;var h=this.maxColumnWidth+r,u=0,c=this.columnHeights.length;if(this.isPaging&&this.isVertical){for(var d=1;d<c;d++)h+=this.maxColumnWidth+r,h>i&&(this.pageHeights.push(u!==d-1?Math.max.apply(null,this.columnHeights.slice(u,d-1)):this.columnHeights[u]),h=this.maxColumnWidth+r,u=d);this.pageHeights.push(u!==c-1?Math.max.apply(null,this.columnHeights.slice(u,c-1)):this.columnHeights[u]),this.totalPages=this.pageHeights.length}return a},e.prototype.getAvailWidth=function(t,i){if(this.isVertical)i=this.maxWidth;else if(!this.isVertical&&this.isPaging&&!this.legend.enablePages)return i-t-this.fivePixel;return i-(this.legend.padding*2+this.legend.shapeWidth+this.legend.shapePadding)},e.prototype.getRenderPoint=function(t,i,r,n,a,o,l){var h=this.legend.padding,u=n.location.y+this.maxItemHeight/4+(n.textCollection.length>0?(n.textCollection.length-1)*this.maxItemHeight:0);if(this.isVertical)if(o===l||u+t.textSize.height+h>a.y+a.height){t.location.x=n.location.x+(o===l?0:this.isRtlEnable?-this.maxColumnWidth:this.maxColumnWidth),t.location.y=i.y;var c=this.legend.shapeWidth/2+h;this.pageXCollections.push(t.location.x+(this.isRtlEnable?c:-c))}else t.location.x=n.location.x,t.location.y=n.location.y+n.textSize.height+this.itemPadding;else{var d=r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),p=n.location.x+(this.isRtlEnable?-d:d);this.isWithinBounds(p,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:t.textSize.width)+r-this.itemPadding,a,this.legend.shapeWidth/2)?(o!==l&&this.chartRowCount++,t.location.y=o===l?n.location.y:n.location.y+this.rowHeights[this.chartRowCount-2]+h,t.location.x=i.x):(t.location.y=n.location.y,t.location.x=o===l?n.location.x:p)}var f=this.getAvailWidth(t.location.x,this.legendBounds.width);f=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,f):f,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(t.text=ta(+f.toFixed(4),t.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont))},e.prototype.isWithinBounds=function(t,i,r,n){return this.isRtlEnable?t-i<r.x-n:t+i>r.x+r.width+n},e.prototype.getSmartLegendLocation=function(t,i,r){var n;switch(this.position){case"Left":n=(t.x-i.width-r.left)/2,i.x=t.x-i.width<r.left?i.x:t.x-i.width-n;break;case"Right":n=(this.chart.availableSize.width-r.right-(t.x+t.width+i.width))/2,i.x=t.x+t.width+i.width>this.chart.availableSize.width-r.right?i.x:t.x+t.width+n;break;case"Top":this.getTitleRect(this.chart),n=(t.y-i.height-(this.titleRect.y+this.titleRect.height))/2,i.y=t.y-i.height<r.top?i.y:t.y-i.height-n;break;case"Bottom":n=(this.chart.availableSize.height-r.bottom-(t.y+t.height+i.height))/2,i.y=t.y+t.height+i.height>this.chart.availableSize.height-r.bottom?i.y:t.y+t.height+n;break}},e.prototype.getTitleRect=function(t){if(!t.title)return null;var i=ht(t.title,t.titleStyle,this.chart.themeStyle.legendTitleFont);this.titleRect=new Ve(t.availableSize.width/2-i.width/2,t.margin.top,i.width,i.height)},e.prototype.legendByIndex=function(t,i){for(var r=0,n=i;r<n.length;r++){var a=n[r];if(a.pointIndex===t)return a}return null},e.prototype.click=function(t){var i=t.target.id.indexOf("_chart_legend_g_")>-1?t.target.firstChild.id:t.target.id,r=this.chart,n=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];this.chart.accumulationSelectionModule&&me([],this.chart.accumulationSelectionModule.selectedDataIndexes,null,!0),this.chart.animateSeries=!1;for(var a=0,o=n;a<o.length;a++){var l=o[a];if(i.indexOf(l)>-1){var h=parseInt(i.split(l)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(h)){var u=this.chart.visibleSeries[0],c=q2(h,u.points),d=this.legendByIndex(h,this.legendCollections),p={legendText:d.text,legendShape:d.shape,chart:r.isBlazor?{}:r,series:u,point:c,name:bl,cancel:!1};this.chart.trigger(bl,p),p.cancel||(c.visible=!c.visible,d.visible=c.visible,u.sumOfPoints+=c.visible?c.y:-c.y,r.redraw=r.enableAnimation,this.sliceVisibility(h,c.visible),r.removeSvg(),kb(r),this.chart.refreshPoints(u.points),this.chart.calculateBounds(),this.chart.renderElements())}else this.chart.accumulationSelectionModule&&!isNaN(h)?this.chart.accumulationSelectionModule.legendSelection(this.chart,0,h,t.target,t.type):this.chart.accumulationHighlightModule&&!isNaN(h)&&this.chart.accumulationHighlightModule.legendSelection(this.chart,0,h,t.target,t.type)}}i.indexOf(this.legendID+"_pageup")>-1?this.changePage(t,!0):i.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(t,!1),r.redraw=!1},e.prototype.sliceVisibility=function(t,i){var r=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(r=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(Qe(r+"g_"+t),i))},e.prototype.sliceAnimate=function(t,i){if(!t)return null;new ri({}).animate(t,{duration:300,delay:0,name:i?"FadeIn":"FadeOut",end:function(r){r.element.style.visibility=i?"visible":"hidden"}})},e.prototype.getModuleName=function(){return"AccumulationLegend"},e.prototype.destroy=function(){this.removeEventListener()},e}(U2),H$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),V$=function(s){H$(e,s);function e(t){var i=s.call(this,t)||this;return i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=t.element.id+"_datalabel_Series_",i}return e.prototype.getDataLabelPosition=function(t,i,r,n){var a=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(t,i);if(this.accumulation.title){var o=ht(this.accumulation.title,this.accumulation.titleStyle,this.accumulation.themeStyle.datalabelFont);this.titleRect=new Ve(this.accumulation.availableSize.width/2-o.width/2,this.accumulation.margin.top,o.width,o.height)}this.getLabelRegion(t,i.position,r,a,this.marginValue),t.labelAngle=t.midAngle,t.labelPosition=i.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(t,i,r,n)},e.prototype.getLabelRegion=function(t,i,r,n,a,o){o===void 0&&(o=0);var l=o||t.midAngle,h=20,u=Jr(l,n,this.isCircular()?this.center:this.getLabelLocation(t,i));u.y=i==="Inside"?u.y-r.height/2:u.y,u.x=i==="Inside"?u.x-r.width/2:u.x,t.labelRegion=new Ve(u.x,u.y,r.width+a*2,r.height+a*2),i==="Outside"&&(t.labelRegion.y-=t.labelRegion.height/2,l>=90&&l<=270?t.labelRegion.x-=t.labelRegion.width+h:t.labelRegion.x+=h)},e.prototype.calculateLabelCollection=function(t,i){if(t.argsData.template!==null)return null;var r=t.labelPosition||i.position,n=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(t,i),a=this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.radius-this.accumulation.pieSeriesModule.innerRadius,o=Jr(t.midAngle,n,this.isCircular()?this.center:this.getLabelLocation(t,r)),l=20,h=i.maxWidth;h||(r==="Outside"?h=this.isCircular()?o.x>=this.center.x?this.areaRect.x+this.areaRect.width-o.x:o.x-this.areaRect.x:o.x>=t.region.x?this.areaRect.x+this.areaRect.width-o.x:o.x-this.areaRect.x:h=this.isCircular()?a-l:t.region.width),t.label.indexOf("<br>")!==-1?t.labelCollection=t.label.split("<br>"):i.textWrap==="Normal"&&i.textOverflow==="Ellipsis"?t.labelCollection[0]=ta(h,t.label,t.argsData.font,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):i.textWrap==="Wrap"||i.textWrap==="AnyWhere"?t.labelCollection=dh(t.label,h,t.argsData.font,this.accumulation.enableRtl,i.textWrap==="AnyWhere",i.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont):t.labelCollection[0]=t.label},e.prototype.getTextSize=function(t,i){for(var r=0,n=i.font,a=i.maxWidth?i.maxWidth:0,o,l=0;l<t.length;l++)o=ht(t[l],n,this.accumulation.themeStyle.datalabelFont),a=Math.max(o.width,a),r+=o.height;return i.textOverflow==="Clip"&&i.textWrap!=="Normal"&&i.maxWidth&&(a=i.maxWidth),new ei(a,r)},e.prototype.getSmartLabel=function(t,i,r,n){var a=this.isCircular(),o=a?this.radius:this.getLabelDistance(t,i),l=a?i.connectorStyle.length||"4%":"0px";o+=xi(l,o);var h=this.findPreviousPoint(n,t.index,t.labelPosition);if(i.position==="Inside"?(t.labelRegion.height-=4,t.labelRegion.width-=4,(h&&h.labelRegion&&!i.enableRotation&&(pn(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n))||!a&&!TG(t.region,t.labelRegion))&&(t.labelPosition="Outside",a||(o=this.getLabelDistance(t,i)),this.calculateLabelCollection(t,i),r=this.getTextSize(t.labelCollection,i),r.height+=4,r.width+=4,this.getLabelRegion(t,t.labelPosition,r,o,this.marginValue),h=this.findPreviousPoint(n,t.index,t.labelPosition),h&&(pn(t.labelRegion,h.labelRegion)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,o,r,this.marginValue))):h&&h.labelRegion&&(pn(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,o,r,this.marginValue),this.isOverlapping(t,n)&&(this.accumulation.type==="Pyramid"||this.accumulation.type==="Funnel")){var u="OutsideLeft",c=20,d=t.midAngle||0,p=a?this.radius:this.getLabelDistance(t,i),f=Jr(d,-p,this.isCircular()?this.center:this.getLabelLocation(t,u));t.labelRegion=new Ve(f.x,f.y,r.width+this.marginValue*2,r.height+this.marginValue*2),t.labelRegion.y-=t.labelRegion.height/2,t.labelRegion.x=t.labelRegion.x-c-t.labelRegion.width,h&&h.labelRegion&&(pn(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,p,r,this.marginValue)}},e.prototype.move=function(t,i,r,n){var a=this;if(t.target.textContent.indexOf("...")>-1){var o=t.target.id.split(this.id);if(o.length===2){var l=parseInt(o[1].split("_text_")[0],10),h=parseInt(o[1].split("_text_")[1],10);if(!isNaN(l)&&!isNaN(h)){n&&di(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");var u=O$(l,this.accumulation.visibleSeries).points[h];Ld(u.text||u.y.toString(),i,r,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",Qe(this.accumulation.element.id+"_Secondary_Element"))}}}else di(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");n&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){di(a.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))},e.prototype.findPreviousPoint=function(t,i,r){for(var n=t[0],a=i-1;a>=0;a--)if(n=t[a],n.visible&&n.labelVisible&&n.labelRegion&&n.labelPosition===r)return n;return null},e.prototype.isOverlapping=function(t,i){for(var r=t.index-1;r>=0;r--)if(i[r].visible&&i[r].labelVisible&&i[r].labelRegion&&t.labelRegion&&t.labelVisible&&pn(t.labelRegion,i[r].labelRegion))return!0;return!1},e.prototype.textTrimming=function(t,i,r,n,a){if(pn(t.labelRegion,i)){var o=t.labelRegion.width;if(n==="Right"?o=i.x-t.labelRegion.x:n==="Left"?(o=t.labelRegion.x-(i.x+i.width),o<0&&(o+=t.labelRegion.width,t.labelRegion.x=i.x+i.width)):n==="InsideRight"?o=i.x+i.width-t.labelRegion.x:n==="InsideLeft"?(o=t.labelRegion.x+t.labelRegion.width-i.x,o<t.labelRegion.width&&(t.labelRegion.x=i.x)):this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(t),t.labelVisible&&t.labelRegion){t.label.indexOf("<br>")!==-1?t.labelCollection=t.label.split("<br>"):o<t.labelRegion.width&&(a.textWrap==="Normal"&&a.textOverflow==="Ellipsis"?t.labelCollection[0]=ta(o-this.marginValue*2,t.label,r,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):(a.textWrap==="Wrap"||a.textWrap==="AnyWhere")&&(t.labelCollection=dh(t.label,o-this.marginValue*2,r,this.accumulation.enableRtl,a.textWrap==="AnyWhere",a.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont)),t.labelRegion.width=o);for(var l=0;l<t.labelCollection.length;l++)if(t.labelCollection[l].length===3&&t.labelCollection[l].indexOf("...")>-1){this.setPointVisibileFalse(t);break}}}},e.prototype.setPointVisibileFalse=function(t){t.labelVisible=!1,t.labelRegion=null},e.prototype.setPointVisibleTrue=function(t){t.labelVisible=!0},e.prototype.setOuterSmartLabel=function(t,i,r,n,a,o){if(!this.isCircular())this.setSmartLabelForSegments(i,t);else{var l=this.getOverlappedAngle(t.labelRegion,i.labelRegion,i.midAngle,r*2);for(this.getLabelRegion(i,"Outside",a,n,o,l),l>i.endAngle&&(l=i.midAngle),i.labelAngle=l;i.labelVisible&&(pn(t.labelRegion,i.labelRegion)||l<=t.labelAngle||l<=i.midAngle*.9||this.isConnectorLineOverlapping(i,t))&&!(l>i.endAngle);)i.labelAngle=l,this.getLabelRegion(i,"Outside",a,n,o,l),l+=.1}},e.prototype.setSmartLabelForSegments=function(t,i){var r=t.labelRegion,n=this.accumulation.type==="Funnel"?i.labelRegion.y-(r.y+r.height):t.labelRegion.y-(i.labelRegion.y+i.labelRegion.height);n<0&&(t.labelRegion.y+=this.accumulation.type==="Funnel"?n:-n)},e.prototype.isConnectorLineOverlapping=function(t,i){var r;!this.isCircular()&&t.labelRegion.x<t.region.x&&(r="outsideLeft");var n=this.getLabelLocation(t,r),a=new ut(0,0);this.getEdgeOfLabel(t.labelRegion,t.labelAngle,a,0,t);var o=this.getLabelLocation(i),l=new ut(0,0);return this.getEdgeOfLabel(i.labelRegion,i.labelAngle,l,0,t),this.isLineRectangleIntersect(n,a,t.labelRegion)||this.isLineRectangleIntersect(n,a,i.labelRegion)||this.isLineRectangleIntersect(o,l,t.labelRegion)},e.prototype.isLineRectangleIntersect=function(t,i,r){var n=[new ut(Math.round(r.x),Math.round(r.y)),new ut(Math.round(r.x+r.width),Math.round(r.y)),new ut(Math.round(r.x+r.width),Math.round(r.y+r.height)),new ut(Math.round(r.x),Math.round(r.y+r.height))];t.x=Math.round(t.x),t.y=Math.round(t.y),i.x=Math.round(i.x),i.y=Math.round(i.y);for(var a=0;a<n.length;a++)if(this.isLinesIntersect(t,i,n[a],n[(a+1)%n.length]))return!0;return!1},e.prototype.isLinesIntersect=function(t,i,r,n){var a=i.y-t.y,o=t.x-i.x,l=a*t.x+o*t.y,h=n.y-r.y,u=r.x-n.x,c=h*r.x+u*r.y,d=a*u-h*o;if(d!==0){var p=(u*l-o*c)/d,f=(a*c-h*l)/d,v=Math.min(t.x,i.x)<=p&&p<=Math.max(t.x,i.x);return v=v&&Math.min(t.y,i.y)<=f&&f<=Math.max(t.y,i.y),v=v&&Math.min(r.x,n.x)<=p&&p<=Math.max(r.x,n.x),v=v&&Math.min(r.y,n.y)<=f&&f<=Math.max(r.y,n.y),v}return!1},e.prototype.getOverlappedAngle=function(t,i,r,n){var a=t.x;return r>=90&&r<=270?(i.y=t.y-(n+i.height/2),a=t.x+t.width):i.y=t.y+t.height+n,fG(this.center,new ut(a,i.y))},e.prototype.getConnectorPath=function(t,i,r,n){n===void 0&&(n=0);var a=r.connectorStyle,o=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],i):this.labelRadius:this.getLabelDistance(i,r),l=this.getConnectorStartPoint(i,a),h=this.accumulation.enableSmartLabels?i.midAngle:n||i.midAngle,u=new ut(0,0),c=this.getEdgeOfLabel(t,h,u,a.width,i);if(a.type==="Curve")if(this.isCircular()){var d=o-(this.isVariousRadius()?xi(i.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius);return i.isLabelUpdated?u=this.getPerpendicularDistance(l,i):(u=Jr(h,o-d/2,this.center),i.labelPosition==="Outside"&&r.position==="Inside"&&(u=Jr(h,o-d*1.25,this.center))),"M "+l.x+" "+l.y+" Q "+u.x+" "+u.y+" "+c.x+" "+c.y}else return this.getPolyLinePath(l,c);else return"M "+l.x+" "+l.y+" L "+u.x+" "+u.y+" L "+c.x+" "+c.y},e.prototype.getPolyLinePath=function(t,i){var r=[t,i];if(t.y===i.y)return"M "+t.x+" "+t.y+" L "+i.x+" "+i.y;for(var n="M",a=0;a<=16;a++){var o=a/16,l=this.getBezierPoint(o,r,0,2);n+=l.x+","+l.y,a!==16&&(n+=" L")}return n},e.prototype.getBezierPoint=function(t,i,r,n){if(n===1)return i[r];var a=this.getBezierPoint(t,i,r,n-1),o=this.getBezierPoint(t,i,r+1,n-1),l=(a.x,a.x),h=(a.y,a.y),u=(o.x,o.x),c=(o.y,o.y),d=(1-t)*l+t*u,p=(1-t)*h+t*c;return a.x?{x:d,y:p}:{x:d,y:p}},e.prototype.getEdgeOfLabel=function(t,i,r,n,a){n===void 0&&(n=1);var o=new ut(t.x,t.y),l=10;return i>=90&&i<=270?(o.x+=t.width+n/2+l,o.y+=t.height/2,r.x=o.x+10,r.y=o.y):a&&a.region&&a.region.x>a.labelRegion.x?(o.x+=n*2+t.width+l,o.y+=t.height/2,r.x=o.x+10,r.y=o.y):(o.x-=l-n/2,o.y+=t.height/2,r.x=o.x-10,r.y=o.y),o},e.prototype.getLabelDistance=function(t,i){if(t.labelPosition&&i.position!==t.labelPosition||i.connectorStyle.length&&i.position==="Outside"){var r=xi(i.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(r<this.accumulation.initialClipRect.width)return r}var n=t.labelPosition||i.position,a=this.accumulation.visibleSeries[0],o=(this.accumulation.initialClipRect.width-a.triangleSize.width)/2,l;switch(n){case"Inside":return 0;case"Outside":return l=t.symbolLocation.x+t.labelOffset.x,this.accumulation.initialClipRect.width-l-o}},e.prototype.getLabelLocation=function(t,i){if(i===void 0&&(i="Outside"),this.accumulation.type!=="Pie"){i=i==="OutsideLeft"?"OutsideLeft":t.labelPosition||i;var r={x:t.symbolLocation.x,y:t.symbolLocation.y-t.labelOffset.y};switch(i){case"Inside":r.y=t.region.y+t.region.height/2;break;case"Outside":r.x+=t.labelOffset.x;break;case"OutsideLeft":r.x-=t.labelOffset.x}return r}else return Jr(t.midAngle,this.isVariousRadius()?xi(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},e.prototype.getConnectorStartPoint=function(t,i){var r;return!this.isCircular()&&t.region.x>t.labelRegion.x&&(r="OutsideLeft"),this.isCircular()?Jr(t.midAngle,(this.isVariousRadius()?xi(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-i.width,this.center):this.getLabelLocation(t,r)},e.prototype.findAreaRect=function(){this.areaRect=new Ve(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var t=this.accumulation.margin;Ga(this.areaRect,new $a(t.left,t.right,t.top,t.bottom))},e.prototype.renderDataLabel=function(t,i,r,n,a,o,l){var h=this.accumulation.element.id+"_datalabel_Series_"+a+"_",u=this.accumulation.renderer.createGroup({id:h+"g_"+t.index}),c={width:i.border.width,color:i.border.color},d=me({},ie("properties",i.font),null,!0);t.label=this.getDatalabelText(i.format,this.accumulation,t.originalText||t.y.toString());var p={cancel:!1,name:P0,series:this.accumulation.visibleSeries[0],point:t,text:t.label,border:c,color:i.fill,template:i.template,font:d};this.accumulation.trigger(P0,p),t.argsData=p;var f=p.template!==null;t.labelVisible=!p.cancel,t.text=t.label=p.text,t.labelCollection=[],this.marginValue=p.border.width?5+p.border.width:1;var v=St("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+t.index,styles:"position: absolute;background-color:"+p.color+";"+N2(i.font)+";border:"+p.border.width+"px solid "+p.border.color+";"});this.calculateLabelSize(f,v,t,n,p,u,h,i,l)},e.prototype.getDatalabelText=function(t,i,r){if(Number(r)){var n=t.match("{value}")!==null,a=i.intl.getNumberFormat({format:n?"":t,useGrouping:i.useGroupingSeparator});r=n?t.replace("{value}",a(parseFloat(r))):a(parseFloat(r))}return r},e.prototype.calculateLabelSize=function(t,i,r,n,a,o,l,h,u,c,d){this.calculateLabelCollection(r,h);var p=t?d?{width:c.width,height:c.height}:this.getTemplateSize(i,r,a,u,t,n,o,l,h):this.getTextSize(r.labelCollection,h);p.height+=4,p.width+=4,r.textSize=p,r.templateElement=i,this.getDataLabelPosition(r,h,p,n),r.labelRegion&&this.correctLabelRegion(r.labelRegion,r.textSize)},e.prototype.drawDataLabels=function(t,i,r,n,a){var o,l,h=t.leftSidePoints.concat(t.rightSidePoints);h.sort(function(T,D){return T.index-D.index}),t.type==="Pie"&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(var u=0,c=h;u<c.length;u++){var d=c[u];if(!m(d.argsData)&&!m(d.y)){this.finalizeDatalabels(d,h,i);var p=this.accumulation.element.id+"_datalabel_Series_0_",f=this.accumulation.renderer.createGroup({id:p+"g_"+d.index});f.setAttribute("aria-hidden","true");var v=void 0,g=void 0,b=void 0;if(d.visible&&d.labelVisible){if(o=l=i.angle,d.argsData.template)this.setTemplateStyle(d.templateElement,d,n,i.font.color,d.color,a);else{g=new ut(d.labelRegion.x+this.marginValue,d.labelRegion.y+d.textSize.height*3/(d.labelCollection.length*4)+this.marginValue),b=Qe(p+"shape_"+d.index);var y=b?new ut(+b.getAttribute("x"),+b.getAttribute("y")):null,C=d.textSize.width;i.enableRotation?o===0?d.labelPosition==="Outside"?l=0:d.midAngle>=90&&d.midAngle<=260?l=d.midAngle+180:l=d.midAngle:l=o>360?o-360:o<-360?o+360:o:l=0;var x="rotate("+l+","+(g.x+C/2)+","+g.y+")";d.transform=x,v=this.accumulation.renderer.drawRectangle(new aa(p+"shape_"+d.index,d.argsData.color,d.argsData.border,1,d.labelRegion,i.rx,i.ry,x)),Mt(!1,f,v,a,!0,"x","y",y,null,!1,!1,null,this.accumulation.duration),bn(this.accumulation.renderer,new Sn(p+"text_"+d.index,g.x,g.y,this.accumulation.enableRtl?"end":"start",d.labelCollection,x,"auto",l),d.argsData.font,d.argsData.font.color||this.getSaturatedColor(d,d.argsData.color),f,!1,a,!0,!1,this.accumulation.duration,null,null,null,null,!0,this.accumulation.themeStyle.datalabelFont),b=null}if(this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&(i.position==="Outside"||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,d.labelRegion),d.labelPosition==="Outside"){var w=Qe(p+"connector_"+d.index),M=w?w.getAttribute("d"):"",E=this.accumulation.renderer.drawPath(new Er(p+"connector_"+d.index,"transparent",i.connectorStyle.width,i.connectorStyle.color||d.color,1,i.connectorStyle.dashArray,this.getConnectorPath(me({},d.labelRegion,null,!0),d,i,d.labelAngle)));Mt(!1,f,E,a,!0,null,null,null,M,!1,!1,null,this.accumulation.duration)}Mt(!1,r,f,a)}}}this.accumulation.type==="Pie"&&i.textWrap==="Normal"&&i.textOverflow==="Clip"&&this.dataLabelClipPath(i,r)},e.prototype.dataLabelClipPath=function(t,i){var r=this.accumulation.element.id+"_datalabel_Series_0_",n=this.accumulation.renderer.createClipPath({id:r+"clipPath"}),a,o=this.accumulation.pieSeriesModule.pieBaseRadius;if(t.position==="Inside")a=this.accumulation.renderer.drawCircle(new QI(r+"clipPath_rect","transparent",{width:0},0,this.center.x,this.center.y,o));else if(t.maxWidth){var l=this.center.x-o-xi(t.connectorStyle.length||"4%",o)-t.maxWidth,h=this.center.y-o-xi(t.connectorStyle.length||"4%",o)-t.maxWidth,u=(o+xi(t.connectorStyle.length||"4%",o)+t.maxWidth)*2,c=u;if(this.accumulation.legendSettings.visible){var d=this.accumulation.accumulationLegendModule;d.position==="Left"?(c=d.legendBounds.x+d.legendBounds.width-l>0?c-(d.legendBounds.width-l):c,l=d.legendBounds.x+d.legendBounds.width<l?l:d.legendBounds.x+d.legendBounds.width):d.position==="Right"&&(c=l+c-d.legendBounds.x>0?c-(l+c-d.legendBounds.x):c)}a=this.accumulation.renderer.drawRectangle(new aa(r+"clipPath_rect","transparent",{width:0},0,new Ve(l,h,u,c),0,0))}(t.position==="Inside"||t.maxWidth)&&(n.appendChild(a),Mt(!1,this.accumulation.svgObject,n),i.style.cssText="clip-path:url(#"+n.id+")")},e.prototype.finalizeDatalabels=function(t,i,r){if((this.isOverlapping(t,i)||this.titleRect&&t.labelRegion&&pn(t.labelRegion,this.titleRect))&&this.isCircular()&&t.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(t),this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&t.labelVisible&&t.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var n=this.accumulation.accumulationLegendModule.legendBounds;this.accumulation.visibleSeries[0].type!=="Pie"&&this.accumulation.legendSettings.position==="Left"&&r.position==="Outside"&&(t.labelRegion.x=t.labelRegion.x+n.width);var a=this.accumulation.legendSettings.border.width/2;this.textTrimming(t,new Ve(n.x-a,n.y-a,n.width+2*a,n.height+2*a),r.font,this.accumulation.accumulationLegendModule.position,r)}if(t.labelVisible&&t.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var o=this.isCircular()?t.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":t.labelRegion.x>=t.region.x?"InsideRight":"InsideLeft";this.textTrimming(t,this.areaRect,r.font,o,r)}t.labelVisible&&t.labelRegion&&!r.maxWidth&&r.textOverflow!=="Clip"&&this.accumulation.enableSmartLabels&&(t.labelRegion.y+t.labelRegion.height/2>this.areaRect.y+this.areaRect.height||t.labelRegion.y<this.areaRect.y||t.labelRegion.x<this.areaRect.x||t.labelRegion.x+t.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(t)},e.prototype.getTemplateSize=function(t,i,r,n,a,o,l,h,u){t=A2(t,i.index,r.template,this.accumulation,i,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,r,a,o,l,h,u,n);var c=k2(t,n);return{width:c.width,height:c.height}},e.prototype.setTemplateStyle=function(t,i,r,n,a,o){if(t.style.left=i.labelRegion.x+"px",t.style.top=i.labelRegion.y+"px",t.style.color=n||this.getSaturatedColor(i,i.labelPosition==="Inside"?a:this.getLabelBackground(i)),this.accumulation.isBlazor){var l=this.isCircular()?i.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":i.labelRegion.x>=i.region.x?"InsideRight":"InsideLeft";l==="InsideRight"?t.style.transform="translate(0%, -50%)":t.style.transform="translate(-100%, -50%)"}t.childElementCount&&(Mt(!1,r,t,o,!0,"left","top"),this.doTemplateAnimation(this.accumulation,t))},e.prototype.getSaturatedColor=function(t,i){var r;this.marginValue>=1?r=i==="transparent"?this.getLabelBackground(t):i:r=this.getLabelBackground(t),r=r==="transparent"?this.accumulation.theme.indexOf("Dark")>-1||this.accumulation.theme==="HighContrast"?"black":"white":r;var n=dv(qn(r)),a=Math.round((n.r*299+n.g*587+n.b*114)/1e3);return a>=128?"black":"white"},e.prototype.doTemplateAnimation=function(t,i){var r=t.visibleSeries[0],n=r.animation.delay+r.animation.duration;(r.animation.enable&&vi!="Disable"||vi==="Enable")&&t.animateSeries&&(i.style.visibility="hidden",YI(i,n,200,"ZoomIn"))},e.prototype.getLabelBackground=function(t){return t.labelPosition==="Outside"?this.accumulation.background||this.accumulation.themeStyle.background:t.y?t.color:this.accumulation.theme.indexOf("dark")?"white":"black"},e.prototype.correctLabelRegion=function(t,i,r){r===void 0&&(r=4),t.height-=r,t.width-=r,t.x+=r/2,t.y+=r/2,i.height-=r,i.width-=r},e.prototype.getModuleName=function(){return"AccumulationDataLabel"},e.prototype.destroy=function(){},e.prototype.extendedLabelsCalculation=function(){var t=this,i=this.accumulation.series[0];i.rightSidePoints.forEach(function(r,n,a){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,t.skipPoints(r,a,n)}),i.leftSidePoints.forEach(function(r,n,a){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,t.skipPoints(r,a,n)}),this.arrangeLeftSidePoints(i),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(i)},e.prototype.arrangeRightSidePoints=function(t){var i,r,n=t.rightSidePoints.filter(function(d){return d.labelVisible&&d.labelPosition==="Outside"});this.rightSideRenderingPoints=n;var a,o,l=n[n.length-1],h;l&&l.labelAngle>90&&l.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(l,89));for(var u=n.length-1;u>=0;u--)if(o=n[u],h=n[u+1],this.isOverlapWithNext(o,n,u)&&o.labelVisible||!(o.labelAngle<=90||o.labelAngle>=270))if(a=l.labelAngle+10,r=!0,i?this.isIncreaseAngle=!1:a>90&&a<270&&h.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(var c=u+1;c>0;c--)this.decreaseAngle(n[c],n[c-1],t,!0);else for(var c=u+1;c<n.length;c++)this.increaseAngle(n[c-1],n[c],t,!0);else r&&h&&!h.isLabelUpdated&&(i=!0)},e.prototype.arrangeLeftSidePoints=function(t){var i=this,r=t.leftSidePoints.filter(function(c){return c.labelVisible&&c.labelPosition==="Outside"});this.leftSideRenderingPoints=r;for(var n,a,o,l,h=0;h<r.length;h++)if(a=r[h],n=r[h-1],this.isOverlapWithPrevious(a,r,h)&&a.labelVisible||!(a.labelAngle<270))if(o=!0,l&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(var u=h;u<r.length;u++)this.increaseAngle(r[u-1],r[u],t,!1);else for(var u=h;u>0;u--)this.decreaseAngle(r[u],r[u-1],t,!1),r.filter(function(c,d){c.isLabelUpdated&&r[d].labelAngle-10<100&&(i.isIncreaseAngle=!0)});else o&&n&&n.isLabelUpdated&&(l=!0)},e.prototype.decreaseAngle=function(t,i,r,n){if(m(t)||m(i))return null;var a=1;if(n)for(;pn(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(i.labelRegion.height+i.labelRegion.y<t.labelRegion.y);){var o=i.midAngle-a;if(o<0&&(o=360+o),o<=270&&o>=90){o=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(i,o),a++}else for(t.labelAngle>270&&(this.changeLabelAngle(t,270),i.labelAngle=270);pn(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&t.labelRegion.y+t.labelRegion.height>i.labelRegion.y;){var o=i.midAngle-a;if(!(o<=270&&o>=90)){o=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,o),pn(t.labelRegion,i.labelRegion)&&!r.leftSidePoints.indexOf(i)&&o-1<90&&o-1>270){this.changeLabelAngle(t,t.labelAngle+1),this.arrangeLeftSidePoints(r);break}a++}},e.prototype.increaseAngle=function(t,i,r,n){if(m(t)||m(i))return null;var a=1;if(n)for(;pn(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(t.labelRegion.y+t.labelRegion.height<i.labelRegion.y);){var o=i.midAngle+a;if(o<270&&o>90){o=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,o),pn(t.labelRegion,i.labelRegion)&&o+1>90&&o+1<270&&this.rightSideRenderingPoints.indexOf(i)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(t,t.labelAngle-1),i.labelRegion=i.initialLabelRegion,this.arrangeRightSidePoints(r);break}if(a>360)break;a++}else for(;pn(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&t.labelRegion.y<i.labelRegion.y+i.labelRegion.height;){var o=i.midAngle+a;if(!(o<270&&o>90)){o=270,this.isIncreaseAngle=!1;break}if(this.changeLabelAngle(i,o),a>360)break;a++}},e.prototype.changeLabelAngle=function(t,i){var r=this.accumulation.series[0].dataLabel,n;this.isVariousRadius()&&(n=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t));var a=t.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&r.position==="Inside"?this.radius+xi(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?n:this.accumulation.pieSeriesModule.labelRadius+10,o=this.isVariousRadius()?n:a;this.getLabelRegion(t,"Outside",t.textSize,o,this.marginValue,i),t.isLabelUpdated=1,t.labelAngle=i},e.prototype.isOverlapWithPrevious=function(t,i,r){for(var n=0;n<r;n++)if(n!==i.indexOf(t)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&t.labelRegion&&t.labelVisible&&pn(t.labelRegion,i[n].labelRegion))return!0;return!1},e.prototype.isOverlapWithNext=function(t,i,r){for(var n=r;n<i.length;n++)if(n!==i.indexOf(t)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&t.labelRegion&&t.labelVisible&&pn(t.labelRegion,i[n].labelRegion))return!0;return!1},e.prototype.skipPoints=function(t,i,r){if(r>0&&(t.midAngle<285&&t.midAngle>255||t.midAngle<105&&t.midAngle>75)){var n=i[r-1],a=t.endAngle%360-t.startAngle%360,o=n.endAngle%360-n.startAngle%360;o<=a&&a<5&&n.labelVisible&&this.setPointVisibleTrue(t)}else if(r>1&&(t.midAngle<300&&t.midAngle>240||t.midAngle<120&&t.midAngle>60)){var l=i[r-1],h=i[r-2],a=t.endAngle%360-t.startAngle%360,o=l.endAngle%360-l.startAngle%360,u=h.endAngle%360-h.startAngle%360;a<3&&o<3&&u<3&&l.labelVisible&&t.labelVisible&&this.setPointVisibleTrue(t)}},e.prototype.getPerpendicularDistance=function(t,i){var r,n=10,a=n+10*Math.sin(i.midAngle*Math.PI/360);return i.midAngle>270&&i.midAngle<360?r=new ut(t.x+a*Math.cos((360-i.midAngle)*Math.PI/180),t.y-a*Math.sin((360-i.midAngle)*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new ut(t.x+a*Math.cos(i.midAngle*Math.PI/180),t.y+a*Math.sin(i.midAngle*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new ut(t.x-a*Math.cos((i.midAngle-90)*Math.PI/180),t.y+a*Math.sin((i.midAngle-90)*Math.PI/180)):r=new ut(t.x-a*Math.cos((i.midAngle-180)*Math.PI/180),t.y-a*Math.sin((i.midAngle-180)*Math.PI/180)),r},e}(KI),U$=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_$=function(s){U$(e,s);function e(t){var i=s.call(this,t)||this;return i.accumulation=t,i.addEventListener(),i.template=i.accumulation.tooltip.template,i}return e.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(B.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(B.touchEndEvent,this.mouseUpHandler,this))},e.prototype.mouseLeaveHandler=function(t){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},e.prototype.mouseUpHandler=function(t){var i=this.accumulation;i.tooltip.enable&&i.isTouch&&Mn(i.mouseX,i.mouseY,i.initialClipRect)&&(this.tooltip(t),this.removeTooltip(2e3))},e.prototype.mouseMoveHandler=function(t){var i=this.accumulation;i.tooltip.enable&&Mn(i.mouseX,i.mouseY,i.initialClipRect)&&this.tooltip(t)},e.prototype.tooltip=function(t){this.renderSeriesTooltip(this.accumulation,this.getPieData(t,this.accumulation,this.accumulation.mouseX,this.accumulation.mouseY))},e.prototype.renderSeriesTooltip=function(t,i){var r=this.getElement(this.element.id+"_tooltip_svg"),n=r&&parseInt(r.getAttribute("opacity"),10)>0,a=this.getTooltipElement(n),o=!n;if(this.currentPoints=[],i.point&&(!this.previousPoints[0]||this.previousPoints[0].point!==i.point)){if(this.previousPoints[0]&&i.point.index===this.previousPoints[0].point.index&&i.series.index===this.previousPoints[0].series.index)return null;this.pushData(i,o,a,!1)&&this.triggerTooltipRender(i,o,this.getTooltipText(i,t.tooltip),this.findHeader(i))}else!i.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1)},e.prototype.triggerTooltipRender=function(t,i,r,n,a){var o=this,l=this.chart.tooltip,h={cancel:!1,name:j0,text:r,point:t.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:t.series,headerText:n,data:{pointX:t.point.x,pointY:t.point.y,seriesIndex:t.series.index,pointIndex:t.point.index,pointText:t.point.text,seriesName:t.series.name}},u=function(c){c.cancel?(o.removeHighlight(),pt(o.getElement(o.element.id+"_tooltip"))):(o.formattedText=o.formattedText.concat(c.text),o.text=o.formattedText,o.headerText=c.headerText,o.createTooltip(o.chart,i,{x:l.location.x!==null?l.location.x:t.point.symbolLocation.x,y:l.location.y!==null?l.location.y:t.point.symbolLocation.y},t.series.clipRect,t.point,l.enableMarker?["Circle"]:[],0,o.chart.initialClipRect,!1,null,t.point,o.template?c.template:"")),o.isRemove=!0};u.bind(this,t),this.chart.trigger(j0,h,u)},e.prototype.getPieData=function(t,i,r,n){var a=t.target,o=uv(a.id,!0);if(!isNaN(o.series)){var l=o.series,h=o.point;if(!m(l)&&!isNaN(l)&&!m(h)&&!isNaN(h)){var u=this.getSeriesFromIndex(l,i.visibleSeries);if(u.enableTooltip)return new nf(u.points[h],u)}}return new nf(null,null)},e.prototype.getSeriesFromIndex=function(t,i){return i[0]},e.prototype.getTooltipText=function(t,i){var r=t.series,n=i.format?i.format:"${point.x} : <b>${point.y}</b>";return n=this.accumulation.useGroupingSeparator?n.replace("${point.y}","${point.separatorY}"):n,this.parseTemplate(t.point,r,n)},e.prototype.findHeader=function(t){return this.header===""?"":(this.header=this.parseTemplate(t.point,t.series,this.header),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},e.prototype.parseTemplate=function(t,i,r){for(var n,a,o=0,l=Object.keys(t);o<l.length;o++){var h=l[o];n=new RegExp("${point."+h+"}","gm"),r=r.replace(n.source,t[h])}for(var u=0,c=Object.keys(Object.getPrototypeOf(i));u<c.length;u++){var h=c[u];n=new RegExp("${series."+h+"}","gm"),a=i[h],r=r.replace(n.source,a)}return r},e.prototype.getModuleName=function(){return"AccumulationTooltip"},e.prototype.destroy=function(t){},e}(W2);XI.Inject(o$,s$,p$,c$,g$,S$,v$,x$);XI.Inject(b$,r$,D$,E$,I$);Y2.Inject(QM,_$,V$,B$);var W$=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.addEventListener=function(){this.parent.on(wc,this.initiateChartHandler,this),this.parent.on(Ed,this.refreshChartCellObj,this),this.parent.on(d1,this.updateChartHandler,this),this.parent.on(gu,this.deleteChart,this),this.parent.on(pM,this.clearBorder,this),this.parent.on(fM,this.insertChartHandler,this),this.parent.on(Tc,this.chartRangeHandler,this),this.parent.on(Yh,this.chartDesignTabHandler,this),this.parent.on(_A,this.updateChartElement,this),this.parent.on(vM,this.undoRedoForChartDesign,this)},s.prototype.insertChartHandler=function(e){var t=this,i="Column",r=!1;switch(e.id){case"clusteredColumn":i="Column";break;case"stackedColumn":i="StackingColumn";break;case"stackedColumn100":i="StackingColumn100";break;case"clusteredBar":i="Bar";break;case"stackedBar":i="StackingBar";break;case"stackedBar100":i="StackingBar100";break;case"area":i="Area";break;case"stackedArea":i="StackingArea";break;case"stackedArea100":i="StackingArea100";break;case"line":i="Line";break;case"lineMarker":i="Line",r=!0;break;case"stackedLine":i="StackingLine";break;case"stackedLineMarker":i="StackingLine",r=!0;break;case"stackedLine100":i="StackingLine100";break;case"stackedLine100Marker":i="StackingLine100",r=!0;break;case"pie":i="Pie";break;case"doughnut":i="Doughnut";break;case"scatter":i="Scatter";break}var n=[{type:i,markerSettings:{visible:r,isFilled:!0}}];e.isChart?(this.parent.notify(th,{chart:n}),Vi(function(){return Fe(t.parent.element)})):this.parent.notify(Yh,{chartType:i,triggerEvent:!0,markerVisible:r})},s.prototype.chartRangeHandler=function(){var e=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(e)for(var t=e.getElementsByClassName("e-control")[0].id,i=this.parent.chartColl,r=i.length,n=0;n<r;n++){var a=document.getElementById(i[n].id);e&&a&&i[n].id===t&&this.parent.notify(wc,{option:i[n],isRefresh:!0})}},s.prototype.updateChartHandler=function(e){var t=this.initiateChartHandler({option:e.chart,isRefresh:!0}),i=this.parent.element.querySelector("."+e.chart.id);if(i){var r=Ct(i,"chart");m(r)&&(r=Ct(i,"accumulationchart")),r.series=t,r.refresh()}},s.prototype.refreshChartCellObj=function(e){var t=Re(e.sheetIdx)?this.parent.activeSheetIndex:e.sheetIdx,i=Pe(this.parent,t),r=Y(e.prevRowIdx,e.prevColIdx,i),n=Y(e.currentRowIdx,e.currentColIdx,i),a=r?r.chart:[],o,l,h=a&&a.length?a.length:0;if(h){for(var u=0;u<h;u++)if(a[u].id===e.id.split("_overlay")[0]){o=a[u],o.height=e.currentHeight,o.width=e.currentWidth,o.top=e.currentTop,o.left=e.currentLeft,a.splice(u,1);for(var c=0,d=this.parent.chartColl.length;c<d;c++)o.id===this.parent.chartColl[c].id&&(o.height=e.currentHeight,this.parent.chartColl[c].width=e.currentWidth,this.parent.chartColl[c].top=e.currentTop,this.parent.chartColl[c].left=e.currentLeft)}if(n&&n.chart&&(l=n.chart,o&&l.push(o)),l?Ht(e.currentRowIdx,e.currentColIdx,i,{chart:l},!0):Ht(e.currentRowIdx,e.currentColIdx,i,{chart:[o]},!0),e.requestType==="chartRefresh"&&!e.isUndoRedo){var p={requestType:"chartRefresh",currentRowIdx:e.currentRowIdx,currentColIdx:e.currentColIdx,currentWidth:e.currentWidth,prevHeight:e.prevHeight,prevWidth:e.prevWidth,prevRowIdx:e.prevRowIdx,prevColIdx:e.prevColIdx,prevTop:e.prevTop,prevLeft:e.prevLeft,currentTop:e.currentTop,currentLeft:e.currentLeft,currentHeight:e.currentHeight,id:e.id,sheetIdx:t};this.parent.notify("actionComplete",{eventArgs:p,action:"chartRefresh"})}}},s.prototype.processChartRange=function(e,t,i){var r=this,n,a,o,l=e[0],h=e[1],u=!1,c=e[2],d=e[3],p=l===c,f=h===d,v,g=function(x,w,M,E){var T=Y(x,w,Pe(r.parent,M));if(T){var D=void 0;if(T.format){var N={value:T.value,format:T.format,formattedText:T.value,cell:T,rowIndex:x,colIndex:w};r.parent.notify(jn,N);var A=He(T.value);if(A&&!yd(T.format,!0,null,!0)){var L=new RegExp(`[!@#$%^&()+=';,{}|":<>~_-]`,"g");N.formattedText=N.formattedText.toString().replace(L,""),D=parseInt(N.formattedText.toString(),10)}else E&&A&&(v=!0),D=N.formattedText&&N.formattedText.toString()}else D=T.value;return m(D)?"":D}else return""},b=g(l,d,t,!0),y=g(c,h,t),C=g(l,h,t);return(!He(y)||!C)&&(u=!0),(m(C)||i.type==="Scatter"&&!i.isSeriesInRows)&&!p&&!f?(n=[l+1,h,c,h],a=[l+1,h+1,c,d],o=[l,h+1,l,d]):!m(y)&&u&&!p&&!f&&!v?!m(b)&&(!He(b)||!C)?(n=[l+1,h,c,h],a=[l+1,h+1,c,d],o=[l,h+1,l,d]):(n=[l,h,c,h],a=[l,h+1,c,d]):(a=[l,h,c,d],!m(b)&&!He(b)&&!v?(o=[l,h,l,d],a[0]=a[0]+1):m(C)&&(p||f)&&(o=[l,h,l,d],p?(a[1]=a[1]+1,o[3]=o[1]):a[0]=a[0]+1)),{xRange:n,yRange:a,lRange:o,isStringSeries:u}},s.prototype.toIntrnlRange=function(e,t){return e?typeof e=="string"&&(e=ee[""+e]):e=ee[this.parent.sheets[t].selectedRange],e},s.prototype.getRangeData=function(e){e.range=this.toIntrnlRange(e.range,e.sheetIdx);var t=[],i=[];return this.pushRowData(e,e.range[0],e.range[1],e.range[2],e.range[3],i,t,!0,e.isYvalue),i},s.prototype.pushRowData=function(e,t,i,r,n,a,o,l,h){for(var u=i,c=this.parent.sheets[e.sheetIdx],d;t<=r;){if(ct(c,t)){t++;continue}for(i=u;i<=n;){if(Yt(c,i)){i++;continue}var p=Y(t,i,c,!1,!0);if(p.format&&!h){var f={value:p.value,format:p.format,formattedText:p.value,rowIndex:t,colIndex:i,cell:p};this.parent.notify(jn,f),d=f.formattedText?f.formattedText.toString():null}else d=p.value||(p.value===0?0:null);a.push({value:d}),i++}t++}o.push(t)},s.prototype.toArrayData=function(e){for(var t="value",i,r=0,n=[],a=e.length;r<a;)i=e[r],Object.keys(i).length?t in i&&n.push(i[""+t]):n.push(""),r++;return n},s.prototype.getVirtualXValues=function(e){for(var t=1,i=[];t<e;)i.push(t.toString()),t++;return i},s.prototype.processChartSeries=function(e,t,i,r,n){e=e||{};var a="",o={},l,h,u,c,d,p={},f,v=0,g=0,b=[];t=m(t)?this.parent.getActiveSheet().index:t;var y=this.parent.sheets[t],C=this.getRangeData({range:r,sheetIdx:t,skipFormula:!0,isYvalue:!0}),x=r[2]-r[0]+1-this.parent.hiddenCount(r[0],r[2],"rows",y),w=r[3]-r[1]+1-this.parent.hiddenCount(r[1],r[3],"columns",y);e.isSeriesInRows?(h=n?this.toArrayData(this.getRangeData({range:n,sheetIdx:t,skipFormula:!1,isYvalue:!1})):this.getVirtualXValues(w+1),i&&(u=this.toArrayData(this.getRangeData({range:i,sheetIdx:t,skipFormula:!1,isYvalue:!1}))),c=x):(h=i?this.toArrayData(this.getRangeData({range:i,sheetIdx:t,skipFormula:!1,isYvalue:!1})):this.getVirtualXValues(x+1),n&&(u=this.toArrayData(this.getRangeData({range:n,sheetIdx:t,skipFormula:!1,isYvalue:!1}))),c=w);var M=h.length,E=e.isSeriesInRows?1:c;for(m(e.dataLabelSettings)||(o.visible=e.dataLabelSettings.visible,o.position=e.dataLabelSettings.position);v<c;){for(f=0,d=[],g=e.isSeriesInRows?g:v;f<M;){if(C[g]){if(l=C[g].value,He(l))l=Number(l);else{var T={value:m(l)?"":l.toString(),sheetIndex:t,updatedVal:""};this.parent.notify(yn,T),T.isDate||T.isTime?l=T.updatedVal:l=0}m(h[f])&&!m(l)&&(h[f]=mi("spread-chart-empty-label-")),d.push({x:h[f],y:l})}g+=E,f++}if(u&&u.length>0?a=u[v]:a=e.type==="Scatter"?"series"+(v+1):"series"+v,m(a)&&(a=""),e.type){var D=e.type;if(D==="Line"||D==="StackingLine"||D==="StackingLine100")p={dataSource:d,type:e.type,xName:"x",yName:"y",name:a.toString(),marker:e.markerSettings?{visible:e.markerSettings.visible,width:e.markerSettings.size,height:e.markerSettings.size,shape:e.markerSettings.shape,dataLabel:o,isFilled:e.markerSettings.isFilled,border:e.markerSettings.border,fill:e.markerSettings.isFilled?e.markerSettings.fill:null}:{dataLabel:o}};else if(D==="Scatter")p={dataSource:d,type:e.type,xName:"x",yName:"y",name:a.toString(),marker:{visible:!1,width:12,height:12,shape:"Circle",dataLabel:o}};else if(D==="Pie"||D==="Doughnut"){var N=e.type==="Pie"?"0%":"40%",A=o.visible,L=m(o.position)?"Inside":o.position==="Outer"?"Outside":"Inside";p={dataSource:d,dataLabel:{visible:m(A)?!1:A,position:L,name:"text",font:{fontWeight:"600"}},radius:"100%",xName:"x",yName:"y",innerRadius:N}}else p={dataSource:d,type:e.type,xName:"x",yName:"y",name:a.toString(),marker:{dataLabel:o}}}b.push(p),v++}var k;return e.type&&(k={series:b,xRange:e.isSeriesInRows?n:i,yRange:r,lRange:e.isSeriesInRows?i:n}),k},s.prototype.primaryYAxisFormat=function(e){var t="";if(!m(e)){var i=Y(e[0],e[1],this.parent.getActiveSheet());i&&i.format&&(t=i.format)}return t},s.prototype.focusChartRange=function(e,t,i){var r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"];this.clearBorder();var n,a=this.parent.getActiveSheet(),o=!!(a.frozenRows||a.frozenColumns);i&&(o?n=i:this.parent.notify(Ic,{startcell:{rowIndex:i[0],colIndex:i[1]},endcell:{rowIndex:i[2],colIndex:i[3]},classes:[r[0],r[1]]})),e&&(o?n?(n[0]=Math.min(i[0],e[0]),n[1]=Math.min(i[1],e[1]),n[2]=Math.max(i[2],e[2]),n[3]=Math.max(i[3],e[3])):n=e:this.parent.notify(Ic,{startcell:{rowIndex:e[0],colIndex:e[1]},endcell:{rowIndex:e[2],colIndex:e[3]},classes:[r[2],r[3]]})),o&&n?this.parent.notify(Ic,{startcell:{rowIndex:Math.min(n[0],t[0]),colIndex:Math.min(n[1],t[1])},endcell:{rowIndex:Math.max(n[2],t[2]),colIndex:Math.max(n[3],t[3])},classes:[r[4],r[5]]}):this.parent.notify(Ic,{startcell:{rowIndex:t[0],colIndex:t[1]},endcell:{rowIndex:t[2],colIndex:t[3]},classes:[r[4],r[5]]})},s.prototype.clearBorder=function(){var e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var t=[].slice.call(this.parent.element.getElementsByClassName("e-chart-range"));t.forEach(function(c){ne(c)});return}for(var i=this.parent.getMainContent(),r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"],n=0,a=r.length;n<a;n++)for(var o=i.querySelectorAll("."+r[n]),l=0,h=o.length;l<h;l++){var u=o[l];u.classList.remove(r[n])}},s.prototype.initiateChartHandler=function(e){var t=this,i=e.option,r=!0;r=m(e.isInitCell)?!0:!e.isInitCell,e.triggerEvent=m(e.triggerEvent)?!0:e.triggerEvent;var n;e.isRefresh=m(e.isRefresh)?!1:e.isRefresh;var a=i.range&&i.range.indexOf("!")>0?gt(this.parent,i.range.split("!")[0]):this.parent.activeSheetIndex,o=Pe(this.parent,a),l=i.range?i.range:this.parent.getActiveSheet().selectedRange,h=ee(l),u={},c,d;if(!this.parent.allowChart&&o.isProtected)return n;var p={sheetIndex:a,reqType:"shape",type:"actionBegin",shapeType:"chart",action:"create",options:i,range:l,operation:"create"};if(u=p.options,l=p.range,u=u||{},h.length>0){var f=h[2]-h[0],v=h[3]-h[1];f<v&&(c=!0)}u.isSeriesInRows=c?!0:u.isSeriesInRows?u.isSeriesInRows:!1,e.dataSheetIdx=m(e.dataSheetIdx)?a:e.dataSheetIdx;var g=this.processChartRange(h,e.dataSheetIdx,u),b=g.xRange,y=g.yRange,C=g.lRange;if(a===this.parent.activeSheetIndex&&r&&this.focusChartRange(b,y,C),e.triggerEvent&&!e.isRefresh){if(d={type:i.type,theme:i.theme,isSeriesInRows:i.isSeriesInRows,range:i.range,markerSettings:u.markerSettings,id:i.id,height:i.height,width:i.width,posRange:e.range,isInitCell:e.isInitCell,cancel:!1},this.parent.notify(li,{eventArgs:d,action:"beforeInsertChart"}),d.cancel)return[];i.type=d.type,i.theme=d.theme,i.isSeriesInRows=d.isSeriesInRows,i.markerSettings=d.markerSettings,i.range=d.range,i.id=d.id,i.height=d.height,i.width=d.width}var x=this.processChartSeries(u,e.dataSheetIdx,b,y,C),w={majorGridLines:i.primaryXAxis&&i.primaryXAxis.majorGridLines&&!m(i.primaryXAxis.majorGridLines.width)?{width:i.primaryXAxis.majorGridLines.width}:{width:0},minorGridLines:i.primaryXAxis&&i.primaryXAxis.minorGridLines&&!m(i.primaryXAxis.minorGridLines.width)?{width:i.primaryXAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:i.primaryXAxis&&i.primaryXAxis.minorGridLines&&i.primaryXAxis.minorGridLines.width>0?5:0,lineStyle:{width:0},valueType:i.type==="Scatter"&&!g.isStringSeries&&!i.isSeriesInRows?"Double":"Category",rangePadding:i.type==="Scatter"&&!g.isStringSeries&&!i.isSeriesInRows?"Round":"Auto",visible:i.primaryXAxis?i.primaryXAxis.visible:!0,title:i.primaryXAxis?i.primaryXAxis.title:"",edgeLabelPlacement:"Shift"},M={lineStyle:{width:0},majorGridLines:i.primaryYAxis&&i.primaryYAxis.majorGridLines&&!m(i.primaryYAxis.majorGridLines.width)?{width:i.primaryYAxis.majorGridLines.width}:{width:1},minorGridLines:i.primaryYAxis&&i.primaryYAxis.minorGridLines&&!m(i.primaryYAxis.minorGridLines.width)?{width:i.primaryYAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:i.primaryYAxis&&i.primaryYAxis.minorGridLines&&i.primaryYAxis.minorGridLines.width>0?5:0,visible:i.primaryYAxis?i.primaryYAxis.visible:!0,title:i.primaryYAxis?i.primaryYAxis.title:"",edgeLabelPlacement:"Shift"};if(e.isRefresh){if(e.isSwitchRowColumn&&i.type==="Scatter"){var E=this.parent.element.querySelector("."+i.id);if(E){var T=Ct(E,"chart");T.primaryXAxis.valueType=!g.isStringSeries&&!i.isSeriesInRows?"Double":"Category"}}return x.series}var D=i.id+"_overlay",N=this.parent.serviceLocator.getService(II),A=!m(e.isInitCell)&&e.isInitCell?e.range:l,L=N.insertOverlayElement(D,A,La(this.parent,A));L.element.classList.add("e-datavisualization-chart"),L.element.style.width=i.width+"px",L.element.style.height=i.height+"px",o.frozenRows||o.frozenColumns?N.adjustFreezePaneSize(i,L.element,A):(m(i.top)?i.top=L.top:L.element.style.top=Number(oh(i.top).toFixed(2))+"px",m(i.left)?i.left=L.left:L.element.style.left=Number(oh(i.left).toFixed(2))+"px"),this.parent.notify(bM,{height:i.height,width:i.width});var k=i.type==="Pie"||i.type==="Doughnut"?{position:"Bottom",visible:!0}:{};m(i.legendSettings)||(k.visible=i.legendSettings.visible,k.position=i.legendSettings.position);var O=this.parent.createElement("div",{id:i.id,className:i.id}),R=i.theme||"Material",j=this.primaryYAxisFormat(y),P=Math.round(parseFloat(getComputedStyle(L.element).borderWidth))*2,F=parseFloat(L.element.style.height)-(isNaN(P)?0:P)+"px";return i.type!=="Pie"&&i.type!=="Doughnut"?(this.chart=new XI({primaryXAxis:w,primaryYAxis:M,background:this.getThemeBgColor(R),chartArea:{border:{width:0}},title:i.title,legendSettings:k,theme:R,series:x.series,tooltip:{enable:!0},width:L.element.style.width,height:F,enableRtl:this.parent.enableRtl,load:function(z){z.chart.theme=i.theme||"Material"},beforeResize:function(z){z.cancelResizedEvent=!0},axisLabelRender:function(z){z.axis.name==="primaryYAxis"&&j&&!m(z.value)&&t.parent?z.text=t.parent.getDisplayText({format:j,value:z.value.toString()}):z.axis.name==="primaryXAxis"&&z.text.startsWith("spread-chart-empty-label-")&&(z.text=""),z.axis.name==="primaryXAxis"&&i.type==="Scatter"&&z.axis.labels.length>0&&(z.text=He(z.text)?z.text:(z.axis.labels.indexOf(z.text)+1).toString())}}),this.chart.appendTo(O)):(this.chart=new Y2({title:i.title,legendSettings:k,theme:R,background:this.getThemeBgColor(R),series:x.series,width:L.element.style.width,height:F,center:{x:"50%",y:"50%"},enableSmartLabels:!0,enableAnimation:!0,enableRtl:this.parent.enableRtl,load:function(z){z.chart.theme=i.theme||"Material"},beforeResize:function(z){z.cancelResizedEvent=!0}}),this.chart.appendTo(O)),L.element.appendChild(O),L.element.classList.contains("e-ss-overlay-active")&&this.parent.notify(c0,{id:L.element.id}),e.triggerEvent&&this.parent.notify(yt,{eventArgs:d,action:"insertChart"}),n},s.prototype.deleteChart=function(e){this.clearBorder();var t=null,i=this.parent.getActiveSheet();if(m(e.id)?(t=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active"),e.id=t?t.getElementsByClassName("e-control")[0].id:null):(e.id=e.id.includes("overlay")?e.id:e.id+"_overlay",t=document.getElementById(e.id)),!m(e.id)){e.id=e.id.includes("overlay")?e.id:e.id+"_overlay";for(var r,n,a,o=!1,l,h=0,u=this.parent.chartColl.length;h<u;h++)if(this.parent.chartColl[h].id===e.id.split("_overlay")[0]){l=this.parent.chartColl[h];break}var c={id:l.id,range:l.range,type:l.type,markerSettings:l.markerSettings,theme:l.theme,height:l.height,width:l.width,isSeriesInRows:l.isSeriesInRows,isInitCell:!0,posRange:null,top:l.top,left:l.left,cancel:!1};if(t){var d=void 0,p=void 0;if(i.frozenRows||i.frozenColumns){var f=t.getBoundingClientRect();d={clientY:f.top},p={clientX:f.left},f.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(d.target=this.parent.getColumnHeaderContent()),f.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(p.target=this.parent.getRowHeaderTable())}else d={clientY:parseFloat(t.style.top),isImage:!0},p={clientX:parseFloat(t.style.left),isImage:!0};this.parent.notify(zy,{id:e.id}),this.parent.notify(lo,d),this.parent.notify(ho,p),o=!0,r=d.clientY,n=p.clientX,i=this.parent.sheets[this.parent.activeSheetIndex]}else{this.parent.notify(zy,{id:e.id});var v=e.range&&e.range.indexOf("!")>0?gt(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,g=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,b=ee(g);r=b[0],n=b[1],i=this.parent.sheets[v]}var y=Y(r,n,i);y&&(a=y.chart);for(var C=a?a.length:null,h=0;h<C;h++)e.id===a[h].id+"_overlay"&&a.splice(h,1);o&&(document.getElementById(e.id).remove(),this.parent.notify(qh,{})),Ht(r,n,i,{chart:a},!0),c.posRange=Je(r,n),e.isUndoRedo||this.parent.notify(yt,{eventArgs:c,action:"deleteChart"})}},s.prototype.updateChartModel=function(e,t,i,r,n){var a=t;t=t;var o=this.parent.chartColl[r].id;if(!(n&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(e)>-1)){for(var l=0,h=i.chart.length;l<h;l++)if(i.chart[l].id===o)switch(e){case"PHAxes":case"PHAxisTitle":m(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),e==="PHAxes"?(i.chart[l].primaryXAxis.visible=t.primaryXAxis.visible,this.parent.chartColl[r].primaryXAxis.visible=t.primaryXAxis.visible):e==="PHAxisTitle"&&(i.chart[l].primaryXAxis.title=t.primaryXAxis.title,this.parent.chartColl[r].primaryXAxis.title=t.primaryXAxis.title);break;case"PVAxes":case"PVAxisTitle":m(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),e==="PVAxes"?(i.chart[l].primaryYAxis.visible=t.primaryYAxis.visible,this.parent.chartColl[r].primaryYAxis.visible=t.primaryYAxis.visible):e==="PVAxisTitle"&&(i.chart[l].primaryYAxis.title=t.primaryYAxis.title,this.parent.chartColl[r].primaryYAxis.title=t.primaryYAxis.title);break;case"ChartTitleNone":case"ChartTitleAbove":i.chart[l].title=t.title,this.parent.chartColl[r].title=t.title;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(m(i.chart[l].dataLabelSettings)&&(i.chart[l].dataLabelSettings={},this.parent.chartColl[r].dataLabelSettings={}),e==="DLNone")i.chart[l].dataLabelSettings.visible=!1,this.parent.chartColl[r].dataLabelSettings.visible=!1;else{i.chart[l].dataLabelSettings.visible=!0,this.parent.chartColl[r].dataLabelSettings.visible=!0;var u=void 0;n?u=a.series[0].dataLabel.position==="Outside"?"Outer":"Middle":u=t.series[0].marker.dataLabel.position,i.chart[l].dataLabelSettings.position=u,this.parent.chartColl[r].dataLabelSettings.position=u}break;case"GLMajorHorizontal":m(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),m(i.chart[l].primaryYAxis.majorGridLines)&&(i.chart[l].primaryYAxis.majorGridLines={},this.parent.chartColl[r].primaryYAxis.majorGridLines={}),i.chart[l].primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width,this.parent.chartColl[r].primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width;break;case"GLMajorVertical":m(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),m(i.chart[l].primaryXAxis.majorGridLines)&&(i.chart[l].primaryXAxis.majorGridLines={},this.parent.chartColl[r].primaryXAxis.majorGridLines={}),i.chart[l].primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width,this.parent.chartColl[r].primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width;break;case"GLMinorHorizontal":m(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),m(i.chart[l].primaryYAxis.minorGridLines)&&(i.chart[l].primaryYAxis.minorGridLines={},this.parent.chartColl[r].primaryYAxis.minorGridLines={}),i.chart[l].primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width,this.parent.chartColl[r].primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width;break;case"GLMinorVertical":m(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),m(i.chart[l].primaryXAxis.minorGridLines)&&(i.chart[l].primaryXAxis.minorGridLines={},this.parent.chartColl[r].primaryXAxis.minorGridLines={}),i.chart[l].primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width,this.parent.chartColl[r].primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width;break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":if(m(i.chart[l].legendSettings)&&(i.chart[l].legendSettings={},this.parent.chartColl[r].legendSettings={}),i.chart[l].legendSettings.visible=t.legendSettings.visible,this.parent.chartColl[r].legendSettings.visible=t.legendSettings.visible,e!=="LegendNone"){i.chart[l].legendSettings.position=t.legendSettings.position,this.parent.chartColl[r].legendSettings.position=t.legendSettings.position;break}}}},s.prototype.updateChartElement=function(e,t,i,r,n,a,o,l){if(!(a&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(e)>-1)){var h;switch(e){case"PHAxes":t=t,t.primaryXAxis.visible=!t.primaryXAxis.visible;break;case"PVAxes":t=t,t.primaryYAxis.visible=!t.primaryYAxis.visible;break;case"PHAxisTitle":t=t,t.primaryXAxis.title=n;break;case"PVAxisTitle":t=t,t.primaryYAxis.title=n;break;case"ChartTitleNone":t.title="";break;case"ChartTitleAbove":t.title=n;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(t=t,h=t.series,e==="DLNone")for(var u=0,c=h.length;u<c;u++)a?h[u].dataLabel.visible=!1:h[u].marker.dataLabel.visible=!1;else for(var u=0,c=h.length;u<c;u++)if(a){var d=e==="DLOutsideend"?"Outside":"Inside";h[u].dataLabel.visible=!0,h[u].dataLabel.position=d}else{var d=e==="DLCenter"?"Middle":e==="DLInsideend"?"Top":e==="DLInsidebase"?"Bottom":e==="DLOutsideend"?"Outer":h[0].marker.dataLabel.position;h[u].marker.dataLabel.visible=!0,h[u].marker.dataLabel.position=d}t.series=h,a&&t.refresh();break;case"GLMajorHorizontal":t=t,t.primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width===0?1:0;break;case"GLMajorVertical":t=t,t.primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width===0?1:0;break;case"GLMinorHorizontal":t=t,t.primaryYAxis.minorTicksPerInterval=t.primaryYAxis.minorGridLines.width===0?5:0,t.primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width===0?1:0;break;case"GLMinorVertical":t=t,t.primaryXAxis.minorTicksPerInterval=t.primaryXAxis.minorGridLines.width===0?5:0,t.primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width===0?1:0;break;case"LegendNone":t.legendSettings.visible=!1;break;case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":t.legendSettings.visible=!0,t.legendSettings.position=e==="LegendsRight"?"Right":e==="LegendsLeft"?"Left":e==="LegendsBottom"?"Bottom":e==="LegendsTop"?"Top":t.legendSettings.position;break}if(this.updateChartModel(e,t,i,r,a),l){var p={addChartEle:e,id:t.element.id+"_overlay",title:n,address:o};this.parent.notify(yt,{action:"chartDesign",eventArgs:p})}}},s.prototype.undoRedoForChartDesign=function(e){var t=document.getElementById(e.id);if(t){var i=this.getChartElement(t),r=Ct(i,"chart");m(r)&&(r=Ct(i,"accumulationchart"));for(var n=this.parent.getAddressInfo(e.address),a=Y(n.indices[0],n.indices[1],Pe(this.parent,n.sheetIndex)),o=this.getChartCollectionId(i.id),l,h=e.addChartEle,u=e.title,c=0;c<e.beforeActionData.cellDetails[0].chart.length;c++)if(i.id===e.beforeActionData.cellDetails[0].chart[c].id){l=e.beforeActionData.cellDetails[0].chart[c];break}var d=m(l.markerSettings)?!1:l.markerSettings.visible;if(e.switchRowColumn)this.switchRowColumn(o,i.id,r,a);else if(e.chartTheme)this.switchChartTheme(o,i.id,e.isUndo?l.theme:e.chartTheme,r,a);else if(e.chartType)this.switchChartType(o,i.id,e.isUndo?l.type:e.chartType,r,a,!1,e.isUndo?d:e.chartMarker,"undoRedo");else if(e.addChartEle){if(e.isUndo){var p=void 0;switch(h){case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":p=l.dataLabelSettings&&l.dataLabelSettings.position,h=p==="Middle"?"DLCenter":p==="Top"?"DLInsideend":p==="Bottom"?"DLInsidebase":p==="Outer"?"DLOutsideend":"DLNone";break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":l.legendSettings&&!l.legendSettings.visible?p="LegendNone":(p=l.legendSettings&&l.legendSettings.position,h=p==="Right"?"LegendsRight":p==="Left"?"LegendsLeft":p==="Bottom"?"LegendsBottom":p==="Top"?"LegendsTop":"LegendsBottom");break;case"PVAxisTitle":u=l.primaryYAxis&&l.primaryYAxis.title;break;case"PHAxisTitle":u=l.primaryXAxis&&l.primaryXAxis.title;break;case"ChartTitleNone":case"ChartTitleAbove":u=l.title;break}}this.updateChartElement(h,r,a,o,u,null,e.address)}}},s.prototype.chartDesignTabHandler=function(e){var t=!1,i=this.parent.sheets[this.parent.activeSheetIndex],r=e.switchRowColumn,n=e.chartType,a=e.chartTheme,o=e.addChartEle,l=null,h=e.id?document.getElementById(e.id):document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(h){var u=o==="ChartTitleAbove"||o==="PHAxisTitle"||o==="PVAxisTitle",c,d;if(i.frozenRows||i.frozenColumns){var p=h.getBoundingClientRect();c={clientY:p.top},d={clientX:p.left},p.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(c.target=this.parent.getColumnHeaderContent()),p.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(d.target=this.parent.getRowHeaderTable())}else c={clientY:h.offsetTop,isImage:!0},d={clientX:h.offsetLeft,isImage:!0};this.parent.notify(lo,c),this.parent.notify(ho,d);var f=Y(c.clientY,d.clientX,i),v=i.name+"!"+Je(c.clientY,d.clientX);if(e.triggerEvent){var g={switchRowColumn:e.switchRowColumn,chartType:e.chartType,chartTheme:e.chartTheme,addChartEle:e.addChartEle,id:h.id,address:v,cancel:!1};if(this.parent.notify(li,{action:"chartDesign",eventArgs:g}),g.cancel)return}var b=this.getChartElement(h),y=b.getAttribute("id"),C=this.getChartCollectionId(y);if(b&&(l=Ct(b,"chart"),m(l)&&(l=Ct(b,"accumulationchart"),t=!0)),r&&!t&&this.switchRowColumn(C,y,l,f),n&&this.switchChartType(C,y,n,l,f,e.markerVisible),a&&this.switchChartTheme(C,y,a,l,f),o)if(u&&!e.title){if(this.parent.element.getElementsByClassName("e-title-dlg").length>0)return;this.titleDlgHandler(o,l,f,C,t,v,e.triggerEvent)}else this.updateChartElement(o,l,f,C,e.title,t);if(e.triggerEvent&&!u){var g={switchRowColumn:e.switchRowColumn,chartType:e.chartType,chartMarker:e.markerVisible,chartTheme:e.chartTheme,addChartEle:e.addChartEle,id:h.id,address:v};this.parent.notify(yt,{action:"chartDesign",eventArgs:g})}}},s.prototype.switchRowColumn=function(e,t,i,r){this.parent.chartColl[e].isSeriesInRows=m(this.parent.chartColl[e].isSeriesInRows)?!0:!this.parent.chartColl[e].isSeriesInRows;for(var n=0,a=r.chart.length;n<a;n++)r.chart[n].id===t&&(r.chart[n].isSeriesInRows=this.parent.chartColl[e].isSeriesInRows);var o=this.initiateChartHandler({option:this.parent.chartColl[e],isRefresh:!0,isSwitchRowColumn:!0});i.series=o},s.prototype.switchChartTheme=function(e,t,i,r,n){this.parent.chartColl[e].theme=i;for(var a=0,o=n.chart.length;a<o;a++)n.chart[a].id===t&&(n.chart[a].theme=i);r.setProperties({theme:i,background:this.getThemeBgColor(i)},!0),r.refresh()},s.prototype.getThemeBgColor=function(e){var t;if(e.includes("Dark"))switch(e){case"MaterialDark":t="#383838";break;case"FabricDark":t="#242424";break;case"BootstrapDark":t="#1b1b1b";break;case"Bootstrap5Dark":t="#212529";break;case"TailwindDark":t="#1f2937";break;case"FluentDark":t="#1b1a19";break;case"Material3Dark":t="#1C1B1F";break}else e.includes("HighContrast")?t="#000000":t="#FFFFFF";return t},s.prototype.switchChartType=function(e,t,i,r,n,a,o,l){var h=this.parent.chartColl[e].type;this.parent.chartColl[e].type=i;for(var u=0,c=n.chart.length;u<c;u++)n.chart[u].id===t&&(n.chart[u].type=i,m(n.chart[u].markerSettings)||(n.chart[u].markerSettings.visible=a));if(i!=="Pie"&&i!=="Doughnut")if(h==="Pie"||h==="Doughnut")this.changeCharType(e);else{if(h!==i)if(i==="Scatter"){var d=r.primaryXAxis.labels;d&&d.length>0&&He(d[d.length-1])&&(r.primaryXAxis.valueType="Double")}else r.primaryXAxis.valueType==="Double"&&(r.primaryXAxis.valueType="Category");for(var p=r.series,f=i==="Line"||i==="StackingLine"||i==="StackingLine100",u=0,v=p.length;u<v;u++)p[u].type=i,f?(p[u].marker.visible=a,p[u].marker.shape=m(p[u].marker.shape)?"Circle":p[u].marker.shape,l==="undoRedo"&&(p[u].marker.visible=o)):p[u].marker.visible=!1;r.series=p,r.refresh()}else if(h==="Pie"||h==="Doughnut"){for(var p=r.series,u=0,v=p.length;u<v;u++)p[u].innerRadius=i==="Pie"?"0%":"40%";r.series=p,r.refresh()}else this.changeCharType(e)},s.prototype.getChartElement=function(e){var t=e.querySelector(".e-chart");return m(t)&&(t=e.querySelector(".e-accumulationchart")),t},s.prototype.getChartCollectionId=function(e){for(var t,i=0,r=this.parent.chartColl.length;i<r;i++)e===this.parent.chartColl[i].id&&(t=i);return t},s.prototype.changeCharType=function(e){var t=document.getElementById(this.parent.chartColl[e].id),i=U(t,".e-datavisualization-chart");i.remove(),this.parent.notify(wc,{option:this.parent.chartColl[e],isInitCell:!1,triggerEvent:!1,isPaste:!1}),t=document.getElementById(this.parent.chartColl[e].id),i=U(t,".e-datavisualization-chart"),i.classList.contains("e-ss-overlay-active")||i.classList.add("e-ss-overlay-active")},s.prototype.titleDlgHandler=function(e,t,i,r,n,a,o){var l=this,h="";if(!(n&&(e==="PHAxisTitle"||e==="PVAxisTitle"))){var u=this.parent.serviceLocator.getService(de),c=this.parent.serviceLocator.getService(At);c.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-title-dlg",header:e==="chart_abovechart"?u.getConstant("ChartTitle"):e==="PHAxisTitle"?u.getConstant("HorizontalAxisTitle"):u.getConstant("VerticalAxisTitle"),beforeOpen:function(){c.dialogInstance.content=l.titleDlgContent(e,t),c.dialogInstance.dataBind(),l.parent.element.focus()},buttons:[{buttonModel:{content:u.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn e-clearall-btn e-flat"},click:function(){var d=l.parent.element.querySelector(".e-title-dlg").getElementsByClassName("e-title-dlg-content")[0];h=d.getElementsByTagName("input")[0].value,c.hide(),l.updateChartElement(e,t,i,r,h,null,a,o)}}]}),c.dialogInstance.refresh()}},s.prototype.titleDlgContent=function(e,t){var i=this.parent.serviceLocator.getService(de),r=this.parent.createElement("div",{className:"e-title-dlg-content"}),n=this.parent.createElement("span",{className:"e-header e-top-header"});n.innerText=i.getConstant("EnterTitle");var a=this.parent.createElement("input",{className:"e-input",id:"titleInput",attrs:{type:"text"}});return r.appendChild(n),r.appendChild(a),t&&(e==="PHAxisTitle"?a.value=t.primaryXAxis.title?t.primaryXAxis.title:a.value:e==="PVAxisTitle"?a.value=t.primaryYAxis.title?t.primaryYAxis.title:a.value:a.value=t.title?t.title:a.value),r},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(wc,this.initiateChartHandler),this.parent.off(Ed,this.refreshChartCellObj),this.parent.off(d1,this.updateChartHandler),this.parent.off(gu,this.deleteChart),this.parent.off(pM,this.clearBorder),this.parent.off(fM,this.insertChartHandler),this.parent.off(Tc,this.chartRangeHandler),this.parent.off(Yh,this.chartDesignTabHandler),this.parent.off(_A,this.updateChartElement),this.parent.off(vM,this.undoRedoForChartDesign))},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null;var e=null;this.chart&&(e=this.chart.element,this.chart.destroy()),e&&ne(e),this.chart=null},s.prototype.getModuleName=function(){return"spreadsheetChart"},s}(),Q2=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),GM=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},q$=function(s){Q2(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return GM([S(!1)],e.prototype,"isFinite",void 0),GM([S(!0)],e.prototype,"enableVirtualization",void 0),e}(ke),Y$=function(s){Q2(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return GM([S("Multiple")],e.prototype,"mode",void 0),e}(ke),Q$=function(){function s(e){this.colGroupWidth=30,this.parent=e,this.col=e.createElement("col"),this.rowRenderer=e.serviceLocator.getService("row"),this.cellRenderer=e.serviceLocator.getService("cell"),this.addEventListener()}return s.prototype.refreshSelectALLContent=function(){var e,t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var i=this.getSelectAllTable().querySelector("thead"),r=this.rowRenderer.render();i.appendChild(r),e=this.parent.createElement("th",{className:"e-select-all-cell"}),r.appendChild(e)}else e=this.headerPanel.firstElementChild,e.classList.add("e-select-all-cell");e.appendChild(this.parent.createElement("button",{className:"e-selectall",id:this.parent.element.id+"_select_all",attrs:{"aria-label":this.parent.serviceLocator.getService(de).getConstant("SelectAll"),type:"button"}}))},s.prototype.updateLeftColGroup=function(e,t){e&&(this.colGroupWidth=e),t||(t=this.getRowHeaderPanel());var i=t.querySelector("table"),r=this.parent.getActiveSheet(),n;if(e)i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px";else{n=this.parent.createElement("colgroup");var a=this.col.cloneNode();a.style.width=this.colGroupWidth+"px",n.appendChild(a),i.insertBefore(n,i.querySelector("tbody"))}(r.frozenRows||r.frozenColumns)&&(i=this.getSelectAllTable(),e?i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px":i.insertBefore(n.cloneNode(!0),i.querySelector("thead"))),this.setPanelWidth(r,t),this.setPanelHeight(r)},s.prototype.setPanelWidth=function(e,t,i){var r=this.getScrollSize(!0),n=this.getRowHeaderWidth(e),a=this.parent.enableRtl?"right":"left",o;if(i&&(o=this.parent.enableRtl?"left":"right",this.getContentPanel().style[""+o]=this.getColHeaderPanel().style[""+o]=""),e.frozenColumns){var l=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-column")[0];l.style.height="calc(100% - "+r+"px)",i&&(l.style[""+o]=""),l.style[""+a]=n-Mr(1)+"Px",l.style.display=""}this.setHeaderPanelWidth(this.getSelectAllContent(),n),this.getColHeaderPanel().style.width="calc(100% - "+n+"px)",this.getColHeaderPanel().style[""+a]=n+"px",this.setHeaderPanelWidth(t,n),this.getContentPanel().style.width="calc(100% - "+n+"px)",this.getContentPanel().style[""+a]=n+"px";var h=this.contentPanel.nextElementSibling?this.contentPanel.nextElementSibling:null;h&&(r?h.style.height=r+1+"px":(h.style.height="1px",h.style.borderTopWidth="0px"),h=h.firstElementChild,i&&(h.style[""+o]=""),h.style[""+a]=n+"px",h.style.width="calc(100% - "+n+"px)",B.userAgent.indexOf("Mac OS")>-1&&B.info.name==="safari"&&(h.style.height="7px",h.style.top="-7px"))},s.prototype.getScrollSize=function(e){var t=parseInt(this.headerPanel.style[this.parent.enableRtl?"margin-left":"margin-right"],10);return t?t+(e?1:0):0},s.prototype.setHeaderPanelWidth=function(e,t){var i=[].slice.call(e.querySelectorAll("col.e-empty"));i.forEach(function(r){t+=parseInt(r.style.width,10)}),e.style.width=t+"px"},s.prototype.setPanelHeight=function(e){var t=this.getScrollSize(!0);if(e.frozenRows){var i=this.getColHeaderHeight(e);!e.showHeaders&&!e.frozenColumns?this.headerPanel.style.height=i+"px":this.headerPanel.style.height="",this.contentPanel.style.height="calc(100% - "+(i+t)+"px)";var r=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-row")[0];r.style.width=B.isDevice?"100%":"calc(100% - "+t+"px)",r.style.top=i-1-(e.showHeaders?1:0)+"px",r.style.display=""}else this.contentPanel.style.height="calc(100% - "+((e.showHeaders?Mr(31):0)+t)+"px)"},s.prototype.renderPanel=function(){this.contentPanel=this.parent.createElement("div",{className:"e-main-panel",attrs:{tabindex:"0"}});var e=this.parent.getActiveSheet(),t=this.parent.element.id;this.contentPanel.appendChild(this.parent.createElement("div",{className:"e-row-header",id:t+"_row_header"})),this.initHeaderPanel(),this.parent.allowScrolling&&this.parent.scrollModule.setPadding();var i=document.getElementById(this.parent.element.id+"_sheet");e.frozenColumns&&i.classList.add("e-frozen-columns"),e.frozenRows&&i.classList.add("e-frozen-rows"),this.updateHideHeaders(e,i),e.showGridLines||i.classList.add("e-hide-gridlines");var r=this.contentPanel.appendChild(this.parent.createElement("div",{className:"e-sheet-content",id:t+"_main_content"}));this.parent.allowScrolling||(r.style.overflow="hidden"),e.frozenRows&&i.appendChild(this.parent.createElement("div",{className:"e-frozen-row",styles:"display: none"})),e.frozenColumns&&i.appendChild(this.parent.createElement("div",{className:"e-frozen-column",styles:"display: none"})),B.userAgent.indexOf("Mac OS")>-1&&B.info.name==="safari"&&i.classList.add("e-mac-safari")},s.prototype.initHeaderPanel=function(){var e=this.parent.element.id;this.headerPanel=this.parent.createElement("div",{className:"e-header-panel"}),this.headerPanel.appendChild(this.parent.createElement("div",{className:"e-selectall-container",id:e+"_selectall"})),this.headerPanel.appendChild(this.parent.createElement("div",{className:"e-column-header",id:e+"_col_header"}))},s.prototype.createHeaderTable=function(){var e=this.contentPanel.querySelector(".e-row-header"),t=this.parent.getActiveSheet();(t.frozenRows||t.frozenColumns)&&this.updateTable(t.frozenRows?["thead","tbody"]:["thead"],"selectall",this.headerPanel.querySelector(".e-selectall-container")),this.updateTable(t.frozenRows?["thead","tbody"]:["thead"],"colhdr",this.headerPanel.querySelector(".e-column-header")),this.updateTable(["tbody"],"rowhdr",e),this.updateLeftColGroup(null,e)},s.prototype.updateTable=function(e,t,i){var r=this,n=this.parent.createElement("table",{className:"e-table",attrs:{role:"grid"}});n.classList.add("e-"+t+"-table"),i.appendChild(n),e.forEach(function(a){n.appendChild(r.parent.createElement(a))})},s.prototype.renderTable=function(e){var t=this,i,r,n,a=this.parent.getActiveSheet(),o=document.createDocumentFragment();if(o.appendChild(this.headerPanel),o.appendChild(this.contentPanel),this.parent.allowScrolling){var l=this.parent.createElement("div",{className:"e-scrollbar"});l.appendChild(this.parent.createElement("div",{className:"e-scroller"})),o.appendChild(l)}this.createHeaderTable(),this.updateTable(["tbody"],"content",this.contentPanel.lastElementChild);var h=this.parent.createElement("colgroup"),u,c=this.contentPanel.querySelector(".e-sheet-content tbody");this.refreshSelectALLContent();var d=this.getSelectAllContent().querySelector("colgroup"),p=this.getRowHeaderPanel().querySelector("colgroup"),f=this.getSelectAllContent().querySelector("thead .e-header-row"),v=this.contentPanel.querySelector(".e-row-header tbody"),g=this.getSelectAllContent().querySelector("tbody"),b=this.headerPanel.querySelector(".e-column-header thead"),y=this.headerPanel.querySelector(".e-column-header tbody"),C=this.rowRenderer.render();b.appendChild(C),this.getColHeaderTable().insertBefore(h,b);var x=this.parent.frozenRowCount(a),w=this.parent.frozenColCount(a),M=ae(a,w-1,!1,"columns");this.parent.notify(I1,{top:e.top,left:e.left});var E=a.colCount.toString(),T=a.colCount.toString(),D=e.top&&e.left?"RowColumn":e.top?"Row":e.left?"Column":"";this.parent.getColHeaderTable().setAttribute("aria-colcount",E),this.parent.getRowHeaderTable().setAttribute("aria-rowcount",T);var N;De(this.parent.getContentTable(),{"aria-rowcount":T,"aria-colcount":E}),e.cells.forEach(function(A,L){if(i=ee(L),(i[1]===e.indexes[1]||!r)&&(i[1]===e.indexes[1]&&(n=t.rowRenderer.render(i[0],!0)),w&&x&&i[1]<w&&i[0]<x?(N=g.querySelector(".e-empty"),N?g.insertBefore(n,N):g.appendChild(n),r=n):w&&i[1]<w?(v.appendChild(n),r=n):(r=t.rowRenderer.render(i[0]),x&&i[0]<x?(N=y.querySelector(".e-empty"),N?y.insertBefore(r,N):y.appendChild(r)):c.appendChild(r),i[1]===e.indexes[1]&&(x&&i[0]<x?g.appendChild(n):v.appendChild(n))),i[1]===e.indexes[1]&&t.cellRenderer.renderRowHeader(i[0],n)),t.cellRenderer.render({colIdx:i[1],rowIdx:i[0],cell:A,address:L,lastCell:i[1]===e.indexes[3],isHeightCheckNeeded:!0,row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isRefreshing:e.isRefreshing,first:D?D.includes("Row")?i[0]===e.indexes[0]?"Row":D.includes("Column")&&i[1]===e.indexes[1]?"Column":"":i[1]===e.indexes[1]?"Column":"":""}),w&&i[1]===M&&(r=null),i[0]===e.indexes[0])if(w&&i[1]<w){u=t.updateCol(a,i[1],d);var k=p.querySelector(".e-empty");k?p.insertBefore(u.cloneNode(!0),k):p.appendChild(u.cloneNode(!0)),t.cellRenderer.renderColHeader(i[1],f)}else t.updateCol(a,i[1],h),t.cellRenderer.renderColHeader(i[1],C)}),this.parent.isReact&&this.parent.renderReactTemplates(),c.parentElement.insertBefore(h.cloneNode(!0),c),Vi(function(){if(t.parent){var A=t.parent.getMainContent(),L=document.getElementById(t.parent.element.id+"_sheet");if(L.childElementCount&&L.querySelector(".e-header-panel")!==t.headerPanel)for(var k=L.children,O=0;O<k.length;O++)!k[O].classList.contains("e-frozen-row")&&!k[O].classList.contains("e-frozen-column")&&!k[O].classList.contains("e-ss-overlay")&&L.removeChild(k[O]);if(L.appendChild(o),L.style.backgroundColor="",a.conditionalFormats&&a.conditionalFormats.length&&t.parent.notify(er,{indexes:e.indexes}),t.checkRowHeightChanged(e,a),e.top&&(A.parentElement.scrollTop=e.top),e.left&&(A.scrollLeft=e.left,t.parent.getColumnHeaderContent().scrollLeft=e.left),t.parent.notify(tn,e),t.checkTableWidth(a),t.parent.notify(Jt,{action:"renderEditor",initLoad:e.initLoad&&!t.parent.isOpen}),!e.initLoad&&!t.parent.isOpen&&t.parent.hideSpinner(),ic(A,{busy:!1}),t.parent.trigger(_6,{}),t.parent.isEdit&&t.parent.notify(hM,null),e.openOptions&&e.openOptions.eventArgs&&e.openOptions.eventArgs.triggerEvent&&t.parent.trigger("openComplete",{response:e.openOptions}),e.initLoad){var R=!0;if(t.parent.scrollSettings.enableVirtualization){for(var O=0;O<a.ranges.length;O++)if(a.ranges[O].info.count-1>t.parent.viewport.bottomIndex){R=!1;break}}R?t.parent.isReact?setTimeout(function(){t.parent&&t.triggerCreatedEvent()}):t.triggerCreatedEvent():t.parent.isOpen||t.parent.hideSpinner()}}})},s.prototype.triggerCreatedEvent=function(){this.parent.isOpen||this.parent.hideSpinner(),this.parent.createdHandler&&(this.parent.createdHandler.observers?(this.parent.created.observers=this.parent.createdHandler.observers,this.parent.isAngular&&this.parent.createdHandler.currentObservers&&(this.parent.created.currentObservers=this.parent.createdHandler.currentObservers)):this.parent.setProperties({created:this.parent.createdHandler},!0),this.parent.createdHandler=void 0,this.parent.trigger(VC,null),this.parent.notify(mu,null))},s.prototype.checkRowHeightChanged=function(e,t){var i={top:e.top,left:e.left,sheet:t};this.parent.notify(xM,i),e.top!==i.top&&(this.parent.scrollModule&&this.parent.scrollModule.offset.top.idx&&i.top-e.top<Wt(t,this.parent.scrollModule.offset.top.idx)&&(this.parent.scrollModule.offset.top.size=i.top),e.top=i.top),e.left!==i.left&&(this.parent.scrollModule&&this.parent.scrollModule.offset.left.idx&&i.left-e.left<tr(t,this.parent.scrollModule.offset.left.idx)&&(this.parent.scrollModule.offset.left.size=i.left),e.left=i.left)},s.prototype.checkTableWidth=function(e){if(this.parent.scrollSettings.isFinite&&!this.parent.scrollSettings.enableVirtualization&&e.colCount-1===this.parent.viewport.rightIndex){var t=ci(e,this.parent.viewport.leftIndex+this.parent.frozenColCount(e),this.parent.viewport.rightIndex),i=this.getRowHeaderWidth(e),r=this.getScrollSize();t<this.contentPanel.getBoundingClientRect().width-i-r?(this.getContentPanel().style.width=t+"px",this.getColHeaderPanel().style.width=t+"px"):this.getContentPanel().style.width.includes("calc")||(this.getContentPanel().style.width="calc(100% - "+i+"px)",this.getColHeaderPanel().style.width="calc(100% - "+i+"px)")}},s.prototype.clearCFResult=function(e){if(e.conditionalFormats&&e.conditionalFormats.length)for(var t=e.conditionalFormats,i=0;i<t.length;i++)delete t[i].result},s.prototype.refreshColumnContent=function(e){var t=this,i,r,n,a=0,o,l,h=this.parent.getActiveSheet(),u=document.createDocumentFragment(),c=document.createDocumentFragment(),d=this.parent.element.querySelector(".e-sheet-content tbody"),p=this.parent.element.querySelector(".e-column-header tbody"),f=this.parent.element.querySelector(".e-sheet-content colgroup");f=f.cloneNode(),u.appendChild(f),d=u.appendChild(d.cloneNode(!0));var v=f.cloneNode();c.appendChild(v);var g;g=this.parent.element.querySelector(".e-column-header thead"),g=c.appendChild(g.cloneNode(!0));var b=g.querySelector("tr");b.innerText="";var y=this.parent.frozenRowCount(h),C=this.parent.frozenColCount(h);y&&(p=c.appendChild(p.cloneNode(!0)));var x=ae(h,y-1,!1),w=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.topIndex!==ae(h,0,!0);this.clearCFResult(h),e.cells.forEach(function(E,T){if(i=ee(T),i[0]===e.indexes[0]&&(l=t.updateCol(h,i[1],v),f.appendChild(l.cloneNode()),t.cellRenderer.renderColHeader(i[1],b)),i[1]-C===e.indexes[1])if(i[0]<y?r=p.children[a]:r=d.children[a],r)r.innerText="",a++;else return;r&&(o=t.cellRenderer.render({colIdx:i[1],rowIdx:i[0],cell:E,address:T,row:r,pRow:r.previousSibling,first:!e.skipUpdateOnFirst&&i[1]===e.indexes[1]?"Column":w&&i[0]===e.indexes[0]?"Row":"",isRefreshing:!0}),t.checkColMerge(i,e.indexes,o,E),y&&i[0]===x&&(a=0))});var M=function(){n=t.getColHeaderTable(),b0(n),n.appendChild(c),n=t.getContentTable(),b0(n),n.appendChild(u),t.parent.notify(wa,{refresh:"Column",prevRowColCnt:e.prevRowColCnt}),h.conditionalFormats&&h.conditionalFormats.length&&t.parent.notify(er,{indexes:e.indexes,isRender:!0}),t.parent.isEdit&&t.parent.notify(Ec,{}),t.parent.allowChart&&t.parent.notify(Tc,null),t.parent.isOpen||t.parent.hideSpinner(),ic(t.parent.getMainContent(),{busy:!1})};e.insertDelete?M():Vi(function(){return M()})},s.prototype.refreshRowContent=function(e){var t=this,i,r,n,a=this.colGroupWidth,o=this.parent.getActiveSheet(),l,h=document.createDocumentFragment(),u=this.parent.createElement("tbody"),c=document.createDocumentFragment(),d=u.cloneNode();c.appendChild(d),h.appendChild(u);var p=this.parent.frozenColCount(o),f=ae(o,p-1,!1,"columns"),v=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.leftIndex!==ae(o,0,!0,"columns");this.clearCFResult(o),e.cells.forEach(function(g,b){i=ee(b),(i[1]===e.indexes[1]||!r)&&(i[1]===e.indexes[1]&&(n=t.rowRenderer.render(i[0],!0)),p&&i[1]<p?(d.appendChild(n),r=n):(i[1]===e.indexes[1]&&d.appendChild(n),r=t.rowRenderer.render(i[0]),u.appendChild(r)),i[1]===e.indexes[1]&&(t.cellRenderer.renderRowHeader(i[0],n),a=GA(i[0]+1))),p&&(n=d.lastElementChild||n),l=t.cellRenderer.render({rowIdx:i[0],colIdx:i[1],cell:g,address:b,lastCell:i[1]===e.indexes[3],row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isHeightCheckNeeded:!0,first:!e.skipUpdateOnFirst&&i[0]===e.indexes[0]?"Row":v&&i[1]===e.indexes[1]?"Column":"",isRefreshing:!0}),t.checkRowMerge(i,e.indexes,l,g),p&&i[1]===f&&(r=null)}),this.colGroupWidth!==a&&this.updateLeftColGroup(a),this.contentPanel.querySelector(".e-row-header tbody")&&(ne(this.contentPanel.querySelector(".e-row-header tbody")),this.getRowHeaderTable().appendChild(c)),this.contentPanel.querySelector(".e-sheet-content tbody")&&(ne(this.contentPanel.querySelector(".e-sheet-content tbody")),this.getContentTable().appendChild(h)),this.parent.notify(wa,{refresh:"Row",prevRowColCnt:e.prevRowColCnt}),o.conditionalFormats&&o.conditionalFormats.length&&this.parent.notify(er,{indexes:e.indexes,isRender:!0}),this.parent.allowChart&&this.parent.notify(Tc,{}),this.parent.isEdit&&this.parent.notify(Ec,null),this.parent.isOpen||this.parent.hideSpinner(),ic(this.parent.getMainContent(),{busy:!1})},s.prototype.updateCol=function(e,t,i){var r=this.col.cloneNode();if(r.style.width=qe(tr(e,t,null,!0)),i){var n=i.querySelector(".e-empty");return n?i.insertBefore(r,n):i.appendChild(r)}else return r},s.prototype.updateColContent=function(e){var t=this;Vi(function(){var i,r,n,a,o=0,l,h=t.parent.getActiveSheet(),u=t.parent.element.querySelector(".e-column-header .e-header-row"),c=u.firstElementChild,d=t.parent.element.querySelector(".e-sheet-content colgroup"),p=t.parent.element.querySelector(".e-column-header colgroup"),f=d.firstElementChild,v,g=p.firstElementChild,b=t.parent.element.querySelector(".e-sheet-content tbody"),y=t.parent.element.querySelector(".e-column-header tbody"),C=t.parent.frozenRowCount(h),x=t.parent.frozenColCount(h),w=ae(h,C-1,!1),M=ae(h,e.indexes[0],!0),E;t.clearCFResult(h),e.cells.forEach(function(T,D){if(!v){if(i=ee(D),e.direction==="first"&&i[1]===e.indexes[1]&&t.checkColMerge([i[0],t.parent.viewport.leftIndex+x],e.indexes,((i[0]<C?y:b).rows[o]||{cells:[]}).cells[e.indexes[3]-e.indexes[1]+1],Y(i[0],t.parent.viewport.leftIndex+x,h)||{}),i[0]===M&&(e.direction==="last"?(l=t.col.cloneNode(),l.style.width=qe(tr(h,i[1],null,!0)),d.insertBefore(l,f),p.insertBefore(l.cloneNode(),g),t.cellRenderer.renderColHeader(i[1],u,c)):(l=t.updateCol(h,i[1],d),p.appendChild(l.cloneNode()),t.cellRenderer.renderColHeader(i[1],u)),t.parent.scrollSettings.enableVirtualization&&e.direction&&(ne(d[e.direction+"ElementChild"]),ne(p[e.direction+"ElementChild"]),ne(u[e.direction+"ElementChild"]))),i[1]===e.indexes[1]){if(i[0]<C)r=y.children[o];else if(r=b.children[o],!r){v=!0;return}o++,n=r.firstElementChild}E={colIdx:i[1],rowIdx:i[0],cell:T,address:D,row:r,lastCell:i[1]===e.indexes[3],isHeightCheckNeeded:e.direction==="first",first:e.direction==="last"&&!e.skipUpdateOnFirst&&i[1]===e.indexes[1]?"Column":"",checkNextBorder:e.direction==="last"&&i[3]===e.indexes[3]?"Column":"",isRefreshing:e.direction==="first"},e.direction==="last"?(E.refChild=n,a=t.cellRenderer.render(E),t.checkColMerge(i,e.indexes,a,T,((i[0]<C?y:b).rows[o-1]||{cells:[]}).cells[1])):a=t.cellRenderer.render(E),t.parent.scrollSettings.enableVirtualization&&e.direction&&ne(r[e.direction+"ElementChild"]),C&&i[0]===w&&(o=0)}}),t.parent.notify(wa,{refresh:"Column",prevRowColCnt:e.prevRowColCnt}),h.conditionalFormats&&h.conditionalFormats.length&&t.parent.notify(er,{indexes:e.indexes,isRender:!0}),t.parent.allowChart&&t.parent.notify(Tc,null),t.parent.isEdit&&t.parent.notify(Ec,{}),t.parent.isOpen||t.parent.hideSpinner(),ic(t.parent.getMainContent(),{busy:!1})})},s.prototype.updateRowContent=function(e){var t=this,i=this.parent.getMainContent();if(!(e.direction===""&&!i.children.length)){var r=this.colGroupWidth,n,a,o,l=this.parent.getActiveSheet(),h=0,u=i.querySelector("tbody"),c=this.parent.getRowHeaderContent().querySelector("tbody"),d=document.createDocumentFragment(),p,f=document.createDocumentFragment();this.parent.showSpinner();var v=this.parent.frozenColCount(l),g=this.parent.frozenRowCount(l),b,y=ae(l,e.indexes[1],!0,"columns"),C=ae(l,v-1,!1,"columns");this.clearCFResult(l),e.cells.forEach(function(x,w){p=ee(w),e.direction==="first"&&p[0]===e.indexes[0]&&(b===void 0&&(b=(p[1]<v?c:u).rows[e.indexes[2]-e.indexes[0]+1]||null),t.checkRowMerge([t.parent.viewport.topIndex+g,p[1]],e.indexes,(b||{cells:[]}).cells[p[1]<v?h+1:h],Y(t.parent.viewport.topIndex+g,p[1],l)||{})),(p[1]===y||!n)&&(p[1]===y&&(a=t.rowRenderer.render(p[0],!0)),v&&p[1]<v?(d.appendChild(a),n=a):(n=t.rowRenderer.render(p[0]),f.appendChild(n),p[1]===y&&d.appendChild(a),t.parent.scrollSettings.enableVirtualization&&e.direction&&ne(u[e.direction+"ElementChild"])),p[1]===y&&(t.cellRenderer.renderRowHeader(p[0],a),r=GA(p[0]+1),t.parent.scrollSettings.enableVirtualization&&e.direction&&ne(c[e.direction+"ElementChild"]))),v&&(a=d.lastElementChild||a),o=t.cellRenderer.render({colIdx:p[1],rowIdx:p[2],cell:x,address:w,row:n,lastCell:p[1]===e.indexes[3],pHRow:a.previousSibling,checkNextBorder:e.direction==="last"&&p[2]===e.indexes[2]?"Row":"",pRow:n.previousSibling,isHeightCheckNeeded:e.direction==="first"||e.direction==="",hRow:a,first:e.direction==="last"&&!e.skipUpdateOnFirst&&p[0]===e.indexes[0]?"Row":"",isRefreshing:e.direction==="first"}),e.direction==="last"&&u.rows.length&&t.checkRowMerge(p,e.indexes,o,x,(p[1]<v?c:u).rows[0].cells[p[1]<v?h+1:h]),h++,v&&p[1]===C&&(n=null,b=void 0,h=0)}),this.colGroupWidth!==r&&this.updateLeftColGroup(r),e.direction==="last"?(c.insertBefore(d,c.firstElementChild),u.insertBefore(f,u.firstElementChild)):(c.appendChild(d),u.appendChild(f)),this.parent.scrollSettings.enableVirtualization&&this.parent.notify(wa,{refresh:"Row",prevRowColCnt:e.prevRowColCnt}),l.conditionalFormats&&l.conditionalFormats.length&&this.parent.notify(er,{indexes:e.indexes,isRender:!0}),this.parent.isEdit&&this.parent.notify(Ec,null),this.parent.allowChart&&this.parent.notify(Tc,{}),this.parent.isOpen||this.parent.hideSpinner(),ic(this.parent.getMainContent(),{busy:!1})}},s.prototype.checkRowMerge=function(e,t,i,r,n){if(this.parent.scrollSettings.enableVirtualization&&i&&(!m(r.rowSpan)||!m(r.colSpan))){var a=this.parent.frozenRowCount(this.parent.getActiveSheet());if(e[0]===this.parent.viewport.topIndex+a){if(r.rowSpan<0){var o={td:i,rowIdx:e[0],colIdx:e[1],isRow:!0,isFreezePane:!0};if(this.parent.notify(o0,o),o.insideFreezePane)return;this.parent.viewport.topIndex+a>=t[0]&&this.refreshPrevMerge(t[0]+1,e[1])}n&&(n.colSpan>1||n.rowSpan>1)&&this.cellRenderer.refresh(e[0]+(t[2]-t[0])+1,e[1],null,n)}else if(r.rowSpan>1){var l=t[2]+1;e[0]+r.rowSpan-1>=l&&e[0]<l&&this.refreshPrevMerge(l,e[1],this.parent.viewport.topIndex+a)}}},s.prototype.refreshPrevMerge=function(e,t,i){var r=this.parent.getCell(e,t,this.parent.getRow(i||0,null,t));r&&this.cellRenderer.refresh(e,t,null,r)},s.prototype.checkColMerge=function(e,t,i,r,n){if(this.parent.scrollSettings.enableVirtualization&&i&&e[1]===this.parent.viewport.leftIndex+this.parent.frozenColCount(this.parent.getActiveSheet())&&(!m(r.rowSpan)||!m(r.colSpan))){if(r.colSpan<0){var a={td:i,colIdx:e[1],rowIdx:e[0],isFreezePane:!0};if(this.parent.notify(o0,a),a.insideFreezePane)return}n&&(n.colSpan>=1||n.rowSpan>=1)&&this.cellRenderer.refresh(e[0],e[1]+(t[3]-t[1])+1,null,n)}},s.prototype.toggleGridlines=function(){var e=document.getElementById(this.parent.element.id+"_sheet");this.parent.getActiveSheet().showGridLines?e.classList.remove("e-hide-gridlines"):e.classList.add("e-hide-gridlines")},s.prototype.showHideHeaders=function(){var e=this,t=this.parent.getActiveSheet();Vi(function(){if(t.showHeaders){var i=e.getContentPanel();e.setPanelWidth(t,e.getRowHeaderPanel()),e.setPanelHeight(t),document.getElementById(e.parent.element.id+"_sheet").classList.remove("e-hide-headers"),e.getColHeaderPanel().scrollLeft=i.scrollLeft,e.parent.selectRange(t.selectedRange)}else e.updateHideHeaders(t,document.getElementById(e.parent.element.id+"_sheet")),e.setPanelHeight(t),e.parent.frozenColCount(t)||e.parent.frozenRowCount(t)?(e.setPanelWidth(t,e.getRowHeaderPanel()),e.parent.selectRange(t.selectedRange)):(e.getContentPanel().style.width="",e.getContentPanel().style[e.parent.enableRtl?"right":"left"]=""),e.getScrollElement().style.left=e.getRowHeaderWidth(t)+"px"})},s.prototype.updateHideHeaders=function(e,t){e.showHeaders||t.classList.add("e-hide-headers")},s.prototype.rowHeightChanged=function(e){if(e.threshold||e.isHideShow){var t=this.parent.getActiveSheet();e.rowIdx<this.parent.frozenRowCount(t)&&this.setPanelHeight(t)}},s.prototype.colWidthChanged=function(e){if(e.threshold||e.isHideShow){var t=this.parent.getActiveSheet();e.colIdx<this.parent.frozenColCount(t)&&this.setPanelWidth(t,this.getRowHeaderPanel()),this.checkTableWidth(t)}},s.prototype.getRowHeaderWidth=function(e,t){var i=0;if(!t&&e.frozenColumns){var r=xe(e.topLeftCell)[1];i=ci(e,r,r+e.frozenColumns-1,!0)}return i+=e.showHeaders?Mr(this.colGroupWidth):0,i},s.prototype.getColHeaderHeight=function(e,t){var i=xe(e.topLeftCell)[0];return(e.showHeaders&&!t?Mr(31):0)+Ei(e,i,i+e.frozenRows-1,!0)},s.prototype.getSelectAllContent=function(){return this.headerPanel.getElementsByClassName("e-selectall-container")[0]},s.prototype.getScrollElement=function(){var e=this.contentPanel.parentElement||this.contentPanel.nextElementSibling;return e&&e.querySelector(".e-scroller")},s.prototype.getSelectAllTable=function(){return this.headerPanel.getElementsByClassName("e-selectall-table")[0]},s.prototype.getColHeaderTable=function(){return this.headerPanel.getElementsByClassName("e-colhdr-table")[0]},s.prototype.getRowHeaderTable=function(){return this.contentPanel.getElementsByClassName("e-rowhdr-table")[0]},s.prototype.getContentTable=function(){return this.contentPanel.getElementsByClassName("e-content-table")[0]},s.prototype.getRowHeaderPanel=function(){return this.contentPanel.getElementsByClassName("e-row-header")[0]},s.prototype.getColHeaderPanel=function(){return this.headerPanel.getElementsByClassName("e-column-header")[0]},s.prototype.getContentPanel=function(){return this.contentPanel.getElementsByClassName("e-sheet-content")[0]},s.prototype.addEventListener=function(){this.parent.on(VC,this.triggerCreatedEvent,this),this.parent.on(an,this.rowHeightChanged,this),this.parent.on(wn,this.colWidthChanged,this),this.parent.on(Dn,this.removeEventListener,this)},s.prototype.destroy=function(){this.headerPanel=null,this.contentPanel=null,this.col=null,this.rowRenderer=null,this.cellRenderer=null,this.colGroupWidth=null,this.parent=null},s.prototype.removeEventListener=function(){this.parent.off(VC,this.triggerCreatedEvent),this.parent.off(an,this.rowHeightChanged),this.parent.off(wn,this.colWidthChanged),this.parent.off(Dn,this.removeEventListener)},s}(),G$=function(){function s(e){this.parent=e,this.element=this.parent.createElement("tr"),this.cellRenderer=e.serviceLocator.getService("cell"),this.parent.on(Sd,this.initProps,this)}return s.prototype.render=function(e,t,i){var r=this.element.cloneNode();if(e===void 0)return r.classList.add("e-header-row"),r;r.classList.add("e-row");var n=this.parent.getActiveSheet();De(r,{"aria-rowindex":(e+1).toString()});var a=Wt(n,e,!0);r.style.height=a+"px";var o=Wt(n,e);if(!this.bottomBorderWidth){var l=1;if(window.devicePixelRatio%1>0){var h=1*window.devicePixelRatio%1;l=1+(h?(h>.5?1-h:-1*h)/window.devicePixelRatio:0)}this.bottomBorderWidth=l}if(o<20&&(r.style.lineHeight=a>this.bottomBorderWidth?a-this.bottomBorderWidth+"px":"0px"),t&&!i){if(o<20){var l=4+(this.bottomBorderWidth-1);r.style.lineHeight=a>=l?a-l+"px":a>this.bottomBorderWidth?a-this.bottomBorderWidth+"px":"0px",r.classList.contains("e-reach-fntsize")||r.classList.add("e-reach-fntsize")}ct(n,e+1)&&!ct(n,e-1)&&r.classList.add("e-hide-start"),e!==0&&ct(n,e-1)&&!ct(n,e+1)&&r.classList.add("e-hide-end")}return r},s.prototype.refresh=function(e,t,i,r,n){var a=this,o=this.parent.getActiveSheet(),l;if(r)l=this.render(e,r,n),this.cellRenderer.renderRowHeader(e,l);else{var h,u,c=function(){for(;h<=u;)Yt(o,h)||a.cellRenderer.render({colIdx:h,rowIdx:e,cell:Y(e,h,o),address:Je(e,h),lastCell:h===u,row:l,hRow:i,isHeightCheckNeeded:!0,pRow:t,first:e===a.parent.viewport.topIndex&&ae(o,e,!0)!==ae(o,0,!0)?"Row":"",skipFormatCheck:ea(a.parent),checkCF:!0}),h++},d=this.parent.frozenColCount(o);d&&(l=i,h=xe(o.topLeftCell)[0],u=d-1,c()),l=this.render(e,r,n),h=this.parent.viewport.leftIndex+d,u=this.parent.viewport.rightIndex,c()}return l},s.prototype.initProps=function(){this.bottomBorderWidth=null},s.prototype.destroy=function(){this.parent.off(Sd,this.initProps),this.parent=null,this.element=null},s}(),$$=function(){function s(e){this.parent=e,this.element=this.parent.createElement("td"),this.th=this.parent.createElement("th",{className:"e-header-cell"}),this.tableRow=e.createElement("tr",{className:"e-row"}),this.parent.on(_y,this.updateView,this),this.parent.on("calculateFormula",this.calculateFormula,this)}return s.prototype.renderColHeader=function(e,t,i){var r=this.th.cloneNode(),n=Ur(e+1);r.innerText=n;var a=this.parent.getActiveSheet();Yt(a,e+1)&&r.classList.add("e-hide-start"),e!==0&&Yt(a,e-1)&&r.classList.add("e-hide-end"),i?t.insertBefore(r,i):t.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:n,colIndex:e}),De(r,{"aria-colindex":(e+1).toString(),tabindex:"-1"})},s.prototype.renderRowHeader=function(e,t,i){var r=this.element.cloneNode();Q([r],"e-header-cell"),De(r,{role:"rowheader",tabindex:"-1"}),r.innerText=(e+1).toString(),i?t.insertBefore(r,i):t.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:""+(e+1),rowIndex:e})},s.prototype.render=function(e){var t=this.parent.getActiveSheet();if(e.td=this.element.cloneNode(),e.td.className="e-cell",De(e.td,{"aria-colindex":(e.colIdx+1).toString(),tabindex:"-1"}),this.checkMerged(e))return this.createImageAndChart(e),e.refChild?e.row.insertBefore(e.td,e.refChild):e.row.appendChild(e.td),e.td;e.isRefresh=!1,e.skipFormatCheck=ea(this.parent),this.update(e),e.checkCF&&e.cell&&t.conditionalFormats&&t.conditionalFormats.length&&this.parent.notify(er,{indexes:[e.rowIdx,e.colIdx],cell:e.cell,ele:e.td,isRender:!0}),e.td.classList.contains("e-cell-template")||this.parent.notify(Kp,{td:e.td,rowIndex:e.rowIdx,colIndex:e.colIdx}),e.refChild?e.row.insertBefore(e.td,e.refChild):e.row.appendChild(e.td);var i={cell:e.cell,element:e.td,address:e.address,rowIndex:e.rowIdx,colIndex:e.colIdx,needHeightCheck:!1,row:e.row};if(this.parent.trigger("beforeCellRender",i),!t.rows[e.rowIdx]||!t.rows[e.rowIdx].customHeight){if(i.element&&i.element.children.length||i.needHeightCheck){var r=i.element.cloneNode(!0);r.style.width=tr(t,e.colIdx,!0)+"px",this.tableRow.appendChild(r)}if(e.lastCell&&this.tableRow.childElementCount||i.needHeightCheck){var n=e.row||this.parent.getRow(e.rowIdx),a=Wt(t,e.rowIdx),o=this.getRowHeightOnInit();if(o>a){var l=Mr(o);n.style.height=l+"px",(e.hRow||this.parent.getRow(e.rowIdx,this.parent.getRowHeaderTable())).style.height=l+"px",Id(t,e.rowIdx,o)}this.tableRow.innerText=""}}return this.setWrapByValue(t,e),i.element},s.prototype.setWrapByValue=function(e,t){t.cell&&!t.cell.wrap&&t.cell.value&&t.cell.value.toString().includes(`
`)&&(Ht(t.rowIdx,t.colIdx,e,{wrap:!0},!0),this.parent.notify(eh,{range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx],wrap:!0,initial:!0,sheet:e,td:t.td,row:t.row,hRow:t.hRow}))},s.prototype.update=function(e){var t=this.parent.getActiveSheet();if(!e.isRefresh||e.cell&&e.cell.template){var i=this.processTemplates(e.cell,e.rowIdx,e.colIdx);i&&(typeof i=="string"?e.td.innerHTML=i:(b0(e.td),Ut(i,e.td)),e.td.classList.add("e-cell-template"))}if(e.isRefresh){if(e.td.rowSpan&&(this.mergeFreezeRow(t,e.rowIdx,e.colIdx,e.td.rowSpan,e.row,!0),e.td.removeAttribute("rowSpan")),e.td.colSpan&&(this.mergeFreezeCol(t,e.rowIdx,e.colIdx,e.td.colSpan,!0),e.td.removeAttribute("colSpan")),this.checkMerged(e))return;if(e.cell&&!e.cell.hyperlink){var r=e.td.querySelector(".e-hyperlink");r&&ne(r)}!e.cell&&e.td.classList.contains("e-wraptext")&&e.td.classList.remove("e-wraptext")}e.cell&&e.cell.formula&&!e.isRandomFormula&&this.calculateFormula(e);var n={value:e.cell&&e.cell.value,type:e.cell&&rh(e.cell.format),format:e.cell&&e.cell.format,formattedText:e.cell&&e.cell.value,isRightAlign:!1,cell:e.cell,rowIndex:e.rowIdx,colIndex:e.colIdx,td:e.td,skipFormatCheck:e.skipFormatCheck,refresh:!0};e.cell&&this.parent.notify(jn,n),this.parent.refreshNode(e.td,{type:n.type,result:n.formattedText,curSymbol:n.curSymbol,isRightAlign:n.isRightAlign,value:n.value||n.value===0?n.value:"",isRowFill:n.isRowFill,rowIndex:e.rowIdx,colIndex:e.colIdx});var a={};if(e.cell){if(e.cell.style&&(e.cell.style.properties?a=EI(e.cell.style,!0):a=e.cell.style),n.color!==void 0&&(a.color=n.color),this.createImageAndChart(e),e.cell.hyperlink&&this.parent.notify(G1,{cell:e.cell,style:a,td:e.td,rowIdx:e.rowIdx,colIdx:e.colIdx}),e.cell.rowSpan>1){var o=e.rowSpan||e.cell.rowSpan-this.parent.hiddenCount(e.rowIdx,e.rowIdx+(e.cell.rowSpan-1));o>1&&(e.td.rowSpan=o,this.mergeFreezeRow(t,e.rowIdx,e.colIdx,o,e.row))}if(e.cell.colSpan>1){var l=e.colSpan||e.cell.colSpan-this.parent.hiddenCount(e.colIdx,e.colIdx+(e.cell.colSpan-1),"columns");l>1&&(e.td.colSpan=l,this.mergeFreezeCol(t,e.rowIdx,e.colIdx,l))}}if(e.isRefresh&&this.removeStyle(e.td,e.rowIdx,e.colIdx),e.lastCell&&this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(lu,{cell:e.cell,rIdx:e.rowIdx,cIdx:e.colIdx,sheetIdx:this.parent.activeSheetIndex}),this.applyStyle(e,a),e.checkNextBorder==="Row"){var h=this.parent.getCellStyleValue(["borderTop"],[Number(this.parent.getContentTable().rows[0].getAttribute("aria-rowindex"))-1,e.colIdx]).borderTop;h!==""&&(!e.cell||!e.cell.style||!e.cell.style.bottomPriority)&&(e.style={borderBottom:h},this.parent.notify(dr,e))}if(e.checkNextBorder==="Column"){var u=this.parent.getCellStyleValue(["borderLeft"],[e.rowIdx,e.colIdx+1]).borderLeft;u!==""&&(!e.cell||!e.cell.style||!e.cell.style.borderRight&&!e.cell.style.border)&&(e.style={borderRight:u},this.parent.notify(dr,e))}e.cell&&e.cell.wrap&&this.parent.notify(eh,{range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx],wrap:!0,sheet:t,initial:!0,td:e.td,row:e.row,hRow:e.hRow,isCustomHgt:!e.isRefresh&&Wt(t,e.rowIdx)>20});var c=e.cell&&e.cell.validation||t.columns&&t.columns[e.colIdx]&&t.columns[e.colIdx].validation;c&&c.isHighlighted&&this.parent.notify(pd,{range:je([e.rowIdx,e.colIdx]),td:e.td}),e.cell&&e.cell.validation&&e.cell.validation.isHighlighted&&this.parent.notify(pd,{range:je([e.rowIdx,e.colIdx]),td:e.td})},s.prototype.applyStyle=function(e,t){(Object.keys(t).length||Object.keys(this.parent.commonCellStyle).length||e.lastCell)&&(e.style=me({},this.parent.commonCellStyle,t),this.parent.notify(dr,e))},s.prototype.createImageAndChart=function(e){if(e.cell.chart&&e.cell.chart.length>0&&this.parent.notify(th,{chart:e.cell.chart,isInitCell:!0,range:Je(e.rowIdx,e.colIdx),isUndoRedo:!1}),e.cell.image&&e.cell.image.length>0)for(var t=0;t<e.cell.image.length;t++)e.cell.image[t]&&this.parent.notify(Da,{options:{src:e.cell.image[t].src,imageId:e.cell.image[t].id,height:e.cell.image[t].height,width:e.cell.image[t].width,top:e.cell.image[t].top,left:e.cell.image[t].left},range:je([e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]),isPublic:!1})},s.prototype.calculateFormula=function(e){if(e.cell.value!==void 0&&e.cell.value!==null){var t={action:"checkFormulaAdded",added:!0,address:e.address,sheetId:(e.sheetIndex===void 0?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex)).id.toString()};if(this.parent.notify(xt,t),t.added)return}else e.formulaRefresh&&(e.cell.value="");var i=Bt(e.cell.formula),r={action:"refreshCalculate",value:e.cell.formula,rowIndex:e.rowIdx,colIndex:e.colIdx,isFormula:i,sheetIndex:e.sheetIndex,isRefreshing:e.isRefreshing,isDependentRefresh:e.isDependentRefresh,isRandomFormula:e.isRandomFormula};this.parent.notify(xt,r),e.cell.value=Y(e.rowIdx,e.colIdx,m(e.sheetIndex)?this.parent.getActiveSheet():Pe(this.parent,e.sheetIndex)).value,e.cell.formula=e.cell.formula.indexOf("^+")>-1||e.cell.formula.indexOf("&+")>-1?r.value:e.cell.formula},s.prototype.checkMerged=function(e){if(e.cell&&(e.cell.colSpan<0||e.cell.rowSpan<0)){var t=this.parent.getActiveSheet();if(t.frozenRows||t.frozenColumns){var i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(cr,i);var r=this.parent.frozenRowCount(t),n=this.parent.frozenColCount(t),a=void 0;i.range=i.range,t.frozenRows&&t.frozenColumns?i.range[0]<r&&i.range[1]<n?a=e.rowIdx<r&&e.colIdx<n:i.range[0]<r?a=e.rowIdx<r:i.range[1]<n?a=e.colIdx<n:a=!0:a=r?i.range[0]>=r||e.rowIdx<r:i.range[1]>=n||e.colIdx<n,a&&(e.td.style.display="none")}else e.td.style.display="none";e.isMerged=!0;var o=e.cell.rowSpan,l=e.cell.colSpan;return(l<0||o<0)&&(this.parent.notify(nM,e),l<0&&e.cell.style&&e.cell.style.borderTop&&this.applyStyle(e,{borderTop:e.cell.style.borderTop}),o<0&&e.cell.style&&e.cell.style.borderLeft&&this.applyStyle(e,{borderLeft:e.cell.style.borderLeft})),e.isMerged}return!1},s.prototype.mergeFreezeRow=function(e,t,i,r,n,a){var o=this.parent.frozenRowCount(e);if(o&&t<o&&t+(r-1)>=o){var l=void 0,h=0,u=void 0,c=this.parent.frozenColCount(e),d=n||this.parent.getRow(t,null,i),p=[].slice.call(d.parentElement.querySelectorAll(".e-empty"));if(a){var f=t+r-o;if(f<p.length)return;var v=0;if(f===p.length){var g=void 0,b=void 0,y=void 0;for(c&&i<c?(b=xe(e.topLeftCell)[1],y=c):(b=this.parent.viewport.leftIndex+c,y=this.parent.viewport.rightIndex),b;b<y;b++)b!==i&&(g=Y(t,b,e,!1,!0),g.rowSpan&&t+g.rowSpan-o>v&&(v=t+g.rowSpan-o));if(v===f)return}else v=f;for(var C=t+(r-1),b=v,y=p.length;b<y;b++)h+=Wt(e,C),C--,ne(p.pop());this.updateSpanTop(i,c,h,!0),p.length||this.updateColZIndex(i,c,!0);return}this.updateColZIndex(i,c);for(var b=o,y=t+(r-1);b<=y;b++)u=Wt(e,ae(e,b,!0),!0),h+=-u,!(o+p.length>b)&&(l=d.cloneNode(),l.classList.add("e-empty"),l.style.visibility="hidden",l.style.height=u+"px",d.parentElement.appendChild(l));this.updateSpanTop(i,c,h)}},s.prototype.updateSpanTop=function(e,t,i,r){var n=this.parent.serviceLocator.getService("sheet").contentPanel;if(r){if(!parseInt(n.style.top,10))return;i=parseInt(n.style.top,10)+i}if(t&&e<t&&(r||!parseInt(n.style.top,10)||i<parseInt(n.style.top,10))){n.style.top=i+"px";var a=n.nextElementSibling;a&&(a.style.top=i+"px")}},s.prototype.mergeFreezeCol=function(e,t,i,r,n){var a=this.parent.frozenColCount(e);if(a&&i<a&&i+(r-1)>=a){var o=void 0,l=void 0,h=this.parent.frozenRowCount(e),u=(t<h?this.parent.getSelectAllContent():this.parent.getRowHeaderContent()).querySelector("colgroup"),c=[].slice.call(u.querySelectorAll(".e-empty"));if(n){var d=i+r-a;if(d<c.length)return;var p=0;if(d===c.length){var f=void 0,v=void 0,g=void 0;for(h&&t<a?(v=h,g=xe(e.topLeftCell)[0]):(v=this.parent.viewport.bottomIndex,g=this.parent.viewport.topIndex+h),g;g<v;g++)g!==t&&(f=Y(g,i,e,!1,!0),f.colSpan&&i+f.colSpan-a>p&&(p=i+f.colSpan-a));if(p===d)return}else p=d;for(var g=p,v=c.length;g<v;g++)ne(c.pop());this.parent.serviceLocator.getService("sheet").setPanelWidth(e,this.parent.getRowHeaderContent()),c.length||this.updateRowZIndex(t,h,!0);return}this.updateRowZIndex(t,h);for(var g=a,v=i+(r-1);g<=v;g++)a+c.length>g||(o=u.childNodes[0].cloneNode(),o.classList.add("e-empty"),o.style.visibility="hidden",l=tr(e,ae(e,g,!0,"columns"),null,!0),o.style.width=l+"px",u.appendChild(o),g===v&&this.parent.serviceLocator.getService("sheet").setPanelWidth(e,this.parent.getRowHeaderContent()))}},s.prototype.updateColZIndex=function(e,t,i){e<t?this.updateSelectAllZIndex(i):(this.parent.getColumnHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},s.prototype.updateSelectAllZIndex=function(e){var t=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");e?(this.parent.getSelectAllContent().style.zIndex="",t&&(t.style.zIndex=""),i&&(i.style.zIndex="")):this.parent.getRowHeaderContent().style.zIndex||this.parent.getColumnHeaderContent().style.zIndex?(this.parent.getSelectAllContent().style.zIndex="3",t&&(t.style.zIndex="4"),i&&(i.style.zIndex="4")):this.parent.getSelectAllContent().style.zIndex="2"},s.prototype.updatedHeaderZIndex=function(e){if(!e&&this.parent.getSelectAllContent().style.zIndex==="2"){this.parent.getSelectAllContent().style.zIndex="3";var t=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");i&&(i.style.zIndex="4"),t&&(t.style.zIndex="4")}},s.prototype.updateRowZIndex=function(e,t,i){e<t?this.updateSelectAllZIndex(i):(this.parent.getRowHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},s.prototype.processTemplates=function(e,t,i){for(var r=this.parent.getActiveSheet(),n=r.ranges,a,o=0,l=n.length;o<l;o++)if(n[o].template&&(a=ee(n[o].address.length?n[o].address:n[o].startCell),a[0]<=t&&a[1]<=i&&a[2]>=t&&a[3]>=i)){if(e)return this.compileCellTemplate(n[o].template,Object.assign({rowIndex:t,colIndex:i},e));if(!Y(t,i,r,!0))return this.compileCellTemplate(n[o].template,Object.assign({rowIndex:t,colIndex:i},Y(t,i,r,null,!0)))}return""},s.prototype.compileCellTemplate=function(e,t){var i;if(typeof e=="string"){var r=void 0;return e.trim().indexOf("#")===0?r=document.querySelector(e).innerHTML.trim():r=e,i=pi(r),!this.parent.isVue||this.isSelector(e)?i(t,this.parent,"ranges","",!0)[0].outerHTML:i(t,this.parent,"ranges","")}else{i=pi(e);var n=i(t,this.parent,"ranges","");return n[0]?n:[n]}},s.prototype.isSelector=function(e){try{return!!document.querySelector(e)}catch{return!1}},s.prototype.getRowHeightOnInit=function(){var e=this.parent.createElement("table",{className:"e-table e-test-table"}),t=e.appendChild(this.parent.createElement("tbody"));t.appendChild(this.tableRow),this.parent.element.appendChild(e);var i=Math.round(this.tableRow.getBoundingClientRect().height);return this.parent.element.removeChild(e),i<20?20:i},s.prototype.removeStyle=function(e,t,i){var r;if(e.style.length){r=this.parent.getCellStyleValue(["borderLeft","border"],[t,i+1]);var n=r.borderLeft||r.border;r=this.parent.getCellStyleValue(["borderTop","border"],[t+1,i]);var a=r.borderTop||r.border;n||a?[].slice.call(e.style).forEach(function(u){n&&a?!u.includes("border-right")&&!u.includes("border-bottom")&&e.style.removeProperty(u):(n&&!(u.indexOf("border-right")>-1)&&(!a||a==="none")||a&&!(u.indexOf("border-bottom")>-1)&&(!n||n==="none"))&&e.style.removeProperty(u)}):e.removeAttribute("style")}var o=this.parent.getCell(t-1,i);if(o&&o.style.borderBottom){var l=Number(o.parentElement.getAttribute("aria-rowindex"))-1;r=this.parent.getCellStyleValue(["borderBottom","border"],[l,i]),r.borderBottom||r.border||(o.style.borderBottom="")}var h=e.previousElementSibling;h&&h.style.borderRight&&(i=Number(h.getAttribute("aria-colindex"))-1,r=this.parent.getCellStyleValue(["borderRight","border"],[t,i]),r.borderRight||r.border||(h.style.borderRight=""))},s.prototype.refreshRange=function(e,t,i,r,n,a){var o=this.parent.getActiveSheet(),l=e.slice(),h,u;if(hz(this.parent,l,!0)){for(var c=l[0];c<=l[2];c++)if(!ct(o,c))for(var d=l[1];d<=l[3];d++)Yt(o,d)||(u=this.parent.getCell(c,d),u&&(h={rowIdx:c,colIdx:d,td:u,cell:Y(c,d,o),isRefreshing:t,lastCell:d===l[3],isRefresh:!0,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",onActionUpdate:r,skipFormatCheck:a},this.update(h),n&&o.conditionalFormats&&o.conditionalFormats.length&&this.parent.notify(er,{indexes:[c,d],isAction:!0}),this.parent.notify(Kp,{td:u,rowIndex:c,colIndex:d}),i&&this.setWrapByValue(o,h)))}},s.prototype.refresh=function(e,t,i,r,n,a,o,l){var h=this.parent.getActiveSheet();if(!(!r&&(ct(h,e)||Yt(h,t)))&&(r||!this.parent.scrollSettings.enableVirtualization||this.parent.insideViewport(e,t))){var u=r||this.parent.getCell(e,t);if(!u)return;var c={rowIdx:e,colIdx:t,td:u,cell:Y(e,t,h),isRefresh:!0,lastCell:i,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",skipFormatCheck:o,isRandomFormula:l};this.update(c),n&&h.conditionalFormats&&h.conditionalFormats.length&&this.parent.notify(er,{indexes:[e,t],isAction:!0}),this.parent.notify(Kp,{td:u,rowIndex:e,colIndex:t}),a&&this.setWrapByValue(h,c)}},s.prototype.updateView=function(e){if(m(e.sheetIndex)||e.sheetIndex===this.parent.activeSheetIndex){if(!e.indexes){var t=this.parent.getActiveSheet(),i=this.parent.frozenRowCount(t),r=this.parent.frozenColCount(t),n=ee(t.topLeftCell);i&&r&&this.refreshRange([n[0],n[1],i-1,r-1],e.refreshing,e.checkWrap,!1,e.checkCF),i&&this.refreshRange([n[0],this.parent.viewport.leftIndex+r,i-1,this.parent.viewport.rightIndex],e.refreshing,e.checkWrap,!1,e.checkCF),r&&this.refreshRange([this.parent.viewport.topIndex+i,n[1],this.parent.viewport.bottomIndex,r-1],e.refreshing,e.checkWrap,!1,e.checkCF),e.indexes=[this.parent.viewport.topIndex+i,this.parent.viewport.leftIndex+r,this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex]}this.refreshRange(e.indexes,e.refreshing,e.checkWrap,!1,e.checkCF)}else e.refreshing&&this.calculateFormula({cell:Y(e.indexes[0],e.indexes[1],Pe(this.parent,e.sheetIndex),!0,!0),rowIdx:e.indexes[0],colIdx:e.indexes[1],sheetIndex:e.sheetIndex})},s.prototype.destroy=function(){this.parent.off(_y,this.updateView),this.parent.off("calculateFormula",this.calculateFormula),this.element=null,this.th=null,this.tableRow=null,this.parent=null},s}(),X$=function(){function s(e){this.parent=e,this.addEventListener(),this.instantiateRenderer()}return s.prototype.render=function(){this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),this.parent.isMobileView()||(this.parent.notify(Wh,null),this.parent.notify(Wf,null));var e=this.parent.createElement("div",{id:this.parent.element.id+"_sheet_panel",className:"e-sheet-panel"});this.parent.enableRtl&&e.classList.add("e-rtl"),this.parent.element.appendChild(e),this.parent.showSheetTabs?this.parent.notify(Gy,null):(this.parent.notify(xt,{action:"initSheetInfo"}),this.parent.notify(xt,{action:"initiateDefinedNames"})),this.parent.isMobileView()&&(this.parent.notify(Wf,null),this.parent.notify(Wh,null)),(this.parent.password.length>0||this.parent.isProtected)&&(this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"))),this.parent.selectionSettings.mode==="None"&&(this.parent.allowAutoFill=!1),this.setSheetPanelSize(),this.renderSheet(e),this.checkTopLeftCell(!this.parent.refreshing)},s.prototype.checkTopLeftCell=function(e,t,i,r,n,a){var o=this.parent.getActiveSheet();this.parent.showSpinner();var l=o.topLeftCell==="A1",h=xe(o.topLeftCell),u;if(o.topLeftCell!==o.paneTopLeftCell&&(o.frozenRows||o.frozenColumns)){var c=xe(o.paneTopLeftCell);u=this.parent.scrollSettings.enableVirtualization,l=o.frozenRows&&o.frozenColumns?h[0]+o.frozenRows===c[0]&&h[1]+o.frozenColumns===c[1]:o.frozenRows?h[0]+o.frozenRows===c[0]&&h[1]===0:h[1]+o.frozenColumns===c[1]&&h[0]===0,h[0]&&c[0]>h[0]?this.parent.viewport.beforeFreezeHeight=Ei(o,0,h[0]-1,!0):this.parent.viewport.beforeFreezeHeight=0,h[1]&&c[1]>h[1]?this.parent.viewport.beforeFreezeWidth=ci(o,0,h[1]-1,!0):this.parent.viewport.beforeFreezeWidth=0}else this.parent.viewport.beforeFreezeHeight=this.parent.viewport.beforeFreezeWidth=0;var d=this.parent.frozenRowCount(o),p=this.parent.frozenColCount(o);if(!this.parent.scrollSettings.enableVirtualization||l)this.refreshUI({rowIndex:h[0],colIndex:h[1],refresh:"All"},null,e,t,n,a),u&&(this.parent.viewport.topIndex=ae(o,d,!0)-d,this.parent.viewport.leftIndex=ae(o,p,!0,"columns")-p);else{var f=o.paneTopLeftCell===o.topLeftCell?h:xe(o.paneTopLeftCell),v={preventScroll:!0};v.scrollTop=i||(f[0]>d?Ei(o,d,f[0]-1,!0):0),v.scrollLeft=r||(f[1]>p?ci(o,p,f[1]-1,!0):0),this.parent.notify(q1,v);var g=this.parent.getThreshold("row"),b=o.frozenRows?h[0]:h[0]>g?ae(o,h[0]-g,!0):0,y=[];o.frozenRows&&y.push(f[0]-g>d?f[0]-g:d),g=this.parent.getThreshold("col");var C=o.frozenColumns?h[1]:h[1]>g?ae(o,h[1]-g,!0,"columns"):0;o.frozenColumns?(y.length||y.push(d),y.push(f[1]-g>p?f[1]-g:p)):y.length&&y.push(p),this.refreshUI({rowIndex:b,colIndex:C,refresh:"All",top:v.scrollTop,left:v.scrollLeft,frozenIndexes:y},null,e,t,n,a),u&&(d&&y[0]>=d&&(this.parent.viewport.topIndex=ae(o,y[0],!0)-d),p&&y[1]>=p&&(this.parent.viewport.leftIndex=ae(o,y[1],!0,"columns")-p))}},s.prototype.renderSheet=function(e){e===void 0&&(e=document.getElementById(this.parent.element.id+"_sheet_panel")),e.appendChild(this.parent.createElement("div",{className:"e-sheet",id:this.parent.element.id+"_sheet",styles:"background-color: #fff"})),this.parent.serviceLocator.getService("sheet").renderPanel()},s.prototype.refreshUI=function(e,t,i,r,n,a){var o=this;e.refresh!=="All"&&this.parent.showSpinner();var l=this.parent.serviceLocator.getService("sheet"),h=this.parent.getActiveSheet(),u=Ns(this.parent),c={rowCount:h.rowCount,colCount:h.colCount};if(e.frozenIndexes=e.frozenIndexes?e.frozenIndexes:[],!t)if(this.parent.scrollSettings.enableVirtualization){var d=e.rowIndex+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,p=e.colIndex+this.parent.viewport.colCount+this.parent.getThreshold("col")*2,f=this.parent.frozenRowCount(h),v=this.parent.frozenColCount(h);e.frozenIndexes.length&&(d+=e.frozenIndexes[0]-f,p+=e.frozenIndexes[1]-v),e.refresh==="Row"?d+=f:d+=h.frozenRows,e.refresh==="Column"?p+=v:p+=h.frozenColumns;var g=e.frozenIndexes[0]>f?e.frozenIndexes[0]:e.rowIndex+(e.refresh==="Row"?f:h.frozenRows),b=this.parent.skipHidden(g,d,"rows",!1);if(d=b[1],g!==b[0]){var y=xe(h.paneTopLeftCell);y[0]===g&&this.parent.updateTopLeftCell(b[0]-f,y[1],"col")}b[0]-=f;var C=h.rowCount-1,x=0,w=e.rowIndex;if(this.parent.scrollSettings.isFinite&&d>C&&(x=d-C,d=ae(h,C,!1),b[0]+f>ae(h,f,!0))){var M=e.rowIndex-x;M=M<0?0:M,M=this.decreaseHidden(M,e.rowIndex-1,f),e.top&&M<e.rowIndex&&this.parent.notify(Qh,{height:Ei(h,M+f,e.rowIndex-1+f,!0),isRender:!0}),this.parent.viewport.topIndex=b[0]=M,w=e.refresh==="Row"?M:w}e.refresh==="Row"?e.rowIndex=ae(h,w+f,!0)-f:w=e.rowIndex=f?ae(h,w,!0):b[0];var E=e.frozenIndexes[1]>v?e.frozenIndexes[1]:e.colIndex+(e.refresh==="Column"?v:h.frozenColumns);if(b=this.parent.skipHidden(E,p,"columns",!1),p=b[1],E!==b[0]){var y=xe(h.paneTopLeftCell);y[1]===E&&this.parent.updateTopLeftCell(y[0],b[0]-v,"row")}b[0]-=v,C=h.colCount-1,x=0;var T=e.colIndex;if(this.parent.scrollSettings.isFinite&&p>C&&(x=p-C,p=ae(h,C,!1,"columns"),b[0]+v>ae(h,v,!0,"columns"))){var M=e.colIndex-x;M=M>-1?M:0,M=this.decreaseHidden(M,e.colIndex-1,v,"columns"),e.left&&M<e.colIndex&&this.parent.notify(Qh,{width:ci(h,M+v,e.colIndex-1+v,!0),isRender:!0}),this.parent.viewport.leftIndex=b[0]=M,T=e.refresh==="Column"?M:T}e.refresh==="Column"?e.colIndex=ae(h,T+v,!0,"columns")-v:T=e.colIndex=v?ae(h,T,!0,"columns"):b[0],e.refresh==="Row"&&(w+=f,f&&(d+=xe(h.topLeftCell)[0]),p=this.parent.viewport.rightIndex),e.refresh==="Column"&&(T+=v,v&&(p+=xe(h.topLeftCell)[1]),d=this.parent.viewport.bottomIndex),this.parent.viewport.topIndex=e.rowIndex,this.parent.viewport.bottomIndex=d,this.parent.viewport.leftIndex=e.colIndex,this.parent.viewport.rightIndex=p,t=Je(w,T)+":"+Je(d,p)}else e.refresh==="All"&&this.updateTopLeftScrollPosition(me(e,{sheet:h})),this.parent.viewport.bottomIndex=h.rowCount-1,this.parent.viewport.rightIndex=h.colCount-1,t=Je(e.rowIndex,e.colIndex)+":"+Je(this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex);e.refresh==="All"&&this.parent.trigger(W6,{});var D=this.parent.isOpen||this.parent.refreshing;ic(this.parent.getMainContent(),{busy:!0});var N=this.parent.sheets.length;$s(this.parent,u+"!"+t,null,null,e.frozenIndexes).then(function(A){if(!(!o.parent||N<o.parent.sheets.length)){var L=o.parent.sheets.indexOf(h);if(!n&&(L===-1||L!==o.parent.activeSheetIndex)){L>-1&&o.checkTopLeftCell();return}var k=[e.rowIndex,e.colIndex].concat(xe(t.split(":")[1])),O,R;switch(e.refresh){case"All":l.renderTable({cells:A,indexes:k,top:e.top,left:e.left,initLoad:i,isRefreshing:r,isOpen:D,openOptions:a});break;case"Row":l.refreshRowContent({cells:A,indexes:k,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c}),O=!1,R={isEdit:O},o.parent.notify(bd,R),R.isEdit&&o.parent.notify(Jt,{action:"startEdit",refreshCurPos:!1});break;case"Column":l.refreshColumnContent({cells:A,indexes:k,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c,insertDelete:e.insertDelete});break;case"RowPart":l.updateRowContent({cells:A,indexes:k,direction:e.direction,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c});break;case"ColumnPart":l.updateColContent({cells:A,indexes:k,direction:e.direction,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c});break}o.parent&&o.parent.isReact&&o.parent.renderReactTemplates()}}),this.parent.notify(T1,{refresh:e.refresh,skipTranslate:e.skipTranslate})},s.prototype.updateTopLeftScrollPosition=function(e){var t=xe(e.sheet.topLeftCell),i=xe(e.sheet.paneTopLeftCell);if(e.sheet.frozenRows){var r=this.parent.frozenRowCount(e.sheet);i[0]>r&&(e.top=Ei(e.sheet,r,i[0]-1,!0))}else e.rowIndex&&(e.rowIndex=0),t[0]!==0&&(e.top=Ei(e.sheet,0,t[0]-1,!0));if(e.sheet.frozenColumns){var n=this.parent.frozenColCount(e.sheet);i[1]>n&&(e.left=ci(e.sheet,n,i[1]-1,!0))}else e.colIndex&&(e.colIndex=0),t[1]!==0&&(e.left=ci(e.sheet,0,t[1]-1,!0))},s.prototype.removeSheet=function(){pt(document.getElementById(this.parent.element.id+"_sheet"))},s.prototype.refreshSheet=function(e,t,i,r,n){var a=0,o=0;if(t){var l=this.parent.element.getElementsByClassName("e-main-panel")[0];l&&(a=l.scrollTop);var h=this.parent.getMainContent();h&&(o=h.scrollLeft)}this.removeSheet(),this.renderSheet(),this.parent.notify(Sd,{}),this.checkTopLeftCell(!1,e,a,o,r,n),i&&Fe(this.parent.element)},s.prototype.setSheetPanelSize=function(e){var t=document.getElementById(this.parent.element.id+"_sheet_panel"),i=this.parent.element.getBoundingClientRect(),r;this.parent.height==="auto"?(t.style.height="260px",r=230):(r=i.height-lz(t),t.style.height=r+"px",r-=32),e!==void 0&&(this.colMinWidth=e),this.parent.viewport.height=r,this.parent.viewport.width=i.width-32,this.parent.viewport.rowCount=this.roundValue(r,20),this.parent.viewport.colCount=this.roundValue(i.width,this.colMinWidth||64)},s.prototype.roundValue=function(e,t){var i=e/t,r=Math.round(i);return Math.abs(i-r)<.5?r:r-1},s.prototype.moveOrDuplicateSheetHandler=function(e){this.parent.notify(Wl,null),e.refresh&&this.refreshSheet(e.isDuplicate)},s.prototype.decreaseHidden=function(e,t,i,r){r===void 0&&(r="rows"),e+=i,t+=i;for(var n=this.parent.getActiveSheet(),a=t;a>=e;a--)if(n[""+r][a]&&n[""+r][a].hidden&&(e--,e<i)){e=ae(n,i,!0,r);break}return e-i},s.prototype.instantiateRenderer=function(){this.parent.serviceLocator.register("cell",new $$(this.parent)),this.parent.serviceLocator.register("row",new G$(this.parent)),this.parent.serviceLocator.register("sheet",new Q$(this.parent))},s.prototype.destroy=function(){this.removeEventListener(),this.parent.serviceLocator.getService("row").destroy(),this.parent.serviceLocator.getService("cell").destroy(),this.parent=null,this.colMinWidth=null},s.prototype.addEventListener=function(){this.parent.on(Dn,this.destroy,this),this.parent.on(jy,this.moveOrDuplicateSheetHandler,this),this.parent.on(xM,this.updateTopLeftScrollPosition,this)},s.prototype.removeEventListener=function(){this.parent.off(Dn,this.destroy),this.parent.off(jy,this.moveOrDuplicateSheetHandler),this.parent.off(xM,this.updateTopLeftScrollPosition)},s}(),K$=function(){function s(e){this.parent=e}return s.prototype.show=function(e,t){var i=this,r;t=!!m(t);var n=e.close||null,a={header:"Spreadsheet",cssClass:this.parent.cssClass,target:this.parent.element,buttons:[],allowDragging:!0};e.close=function(){i.destroyDialog(),n&&n()},me(a,e),t&&(r=this.parent.serviceLocator.getService(de).getConstant(a.buttons.length?"Cancel":"Ok"),a.buttons.push({buttonModel:{content:r,isPrimary:a.buttons.length===0},click:this.hide.bind(this)}));var o=this.parent.createElement("div");document.body.appendChild(o),this.dialogInstance=new Tv(a),this.dialogInstance.createElement=this.parent.createElement,this.dialogInstance.appendTo(o),this.dialogInstance.refreshPosition()},s.prototype.destroyDialog=function(){this.dialogInstance.destroy(),pt(this.dialogInstance.element),this.dialogInstance=null},s.prototype.hide=function(e){this.dialogInstance&&(e&&(this.dialogInstance.animationSettings.effect="None",this.dialogInstance.dataBind()),this.dialogInstance.hide())},s.prototype.destroy=function(){this.parent=null},s}(),Z$=function(){function s(e){this.parent=e,this.addEventListener()}return s.prototype.initializeActionBegin=function(){var e=this,t=this.parent.beforeCellFormat;this.parent.beforeCellFormat=function(a){e.actionEventHandler({evtArgs:a,evtFunc:t,actionType:"begin",eventType:"format"})};var i=this.parent.beforeOpen;this.parent.beforeOpen=function(a){e.actionEventHandler({evtArgs:a,evtFunc:i,actionType:"begin",eventType:"beforeOpen"})};var r=this.parent.beforeSave;this.parent.beforeSave=function(a){e.actionEventHandler({evtArgs:a,evtFunc:r,actionType:"begin",eventType:"beforeSave"})};var n=this.parent.beforeSort;this.parent.beforeSort=function(a){e.actionEventHandler({evtArgs:a,evtFunc:n,actionType:"begin",eventType:"beforeSort"})}},s.prototype.initializeActionComplete=function(){var e=this,t=this.parent.sortComplete;this.parent.sortComplete=function(r){e.actionEventHandler({evtArgs:r,evtFunc:t,actionType:"complete",eventType:"sorting"})};var i=this.parent.cellSave;this.parent.cellSave=function(r){e.actionEventHandler({evtArgs:r,evtFunc:i,actionType:"complete",eventType:"cellSave"})}},s.prototype.actionEventHandler=function(e){e.evtFunc&&e.evtFunc.apply(this,[e]),e.actionType==="begin"?this.actionBeginHandler({eventArgs:e.evtArgs,action:e.eventType}):this.actionCompleteHandler({eventArgs:e.evtArgs,action:e.eventType})},s.prototype.actionBeginHandler=function(e){var t=e.preventAction;delete e.preventAction;var i={action:e.action};e.isUndo&&(i.isUndo=!0,delete e.isUndo),e.isRedo&&(i.isUndo=!1,delete e.isRedo),i.args=e,this.parent.trigger("actionBegin",i),!t&&(e.action==="clipboard"||e.action==="format"||e.action==="cellSave"||e.action==="beforeWrap"||e.action==="beforeReplace"||e.action==="filter"||e.action==="beforeClear"||e.action==="beforeInsertImage"||e.action==="beforeInsertChart"||e.action==="chartDesign"||e.action==="cellDelete"||e.action==="autofill"||e.action==="removeValidation"||e.action==="hyperlink"||e.action==="removeHyperlink"||e.action==="deleteImage")&&this.parent.notify(t0,{args:e}),t&&(e.preventAction=!0),i.isUndo&&(e.isUndo=!0),i.isUndo===!1&&(e.isRedo=!0)},s.prototype.actionCompleteHandler=function(e){var t=e.preventAction;delete e.preventAction,this.parent.notify(Nf,e),e.preventEventTrigger||this.parent.trigger("actionComplete",e),!t&&e.action!=="undoRedo"&&e.action!=="gotoSheet"&&this.parent.notify(e0,{args:e}),this.parent.notify(Pa,null)},s.prototype.addEventListener=function(){this.parent.on(yt,this.actionCompleteHandler,this),this.parent.on(li,this.actionBeginHandler,this),this.parent.on(Dn,this.removeEventListener,this)},s.prototype.removeEventListener=function(){this.parent.off(yt,this.actionCompleteHandler),this.parent.off(li,this.actionBeginHandler),this.parent.off(Dn,this.removeEventListener)},s}(),J$=function(){function s(e){this.minHeight="300px",this.minWidth="400px",this.isOverlayClicked=!1,this.isResizerClicked=!1,this.currentWidth=400,this.currenHeight=300,this.parent=e,this.parent.on(tv,this.isOverlaySelected,this),this.parent.on(cM,this.refreshOverlayElem,this),this.parent.on(Dn,this.destroy,this)}return s.prototype.insertOverlayElement=function(e,t,i){var r=this.parent.createElement("div",{id:e,attrs:{class:"e-ss-overlay e-ss-overlay-active"},styles:"width: "+this.minWidth+";  height: "+this.minHeight}),n=ee(t),a=this.parent.sheets[i],o=this.parent.frozenRowCount(a),l=this.parent.frozenColCount(a),h=Cb(a,n,o,l,this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth,!0);if(n[0]>=o&&n[1]<l){var u=this.parent.sheetModule.contentPanel;u.scrollTop&&(h.top-=u.scrollTop,h.top+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height)}if(n[1]>=l&&n[0]<o){var c=this.parent.getScrollElement();c.scrollLeft&&(h.left-=c.scrollLeft,h.left+=this.parent.sheetModule.getRowHeaderWidth(a))}var d;return n[0]<o||n[1]<l?(d=this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),o&&(n[0]>=o?h.top+=(a.showHeaders?31:0)+Ei(a,xe(a.topLeftCell)[0],o-1):l||(h.left+=this.parent.sheetModule.getRowHeaderWidth(a,!0))),l&&(n[1]>=l?h.left+=this.parent.sheetModule.getRowHeaderWidth(a):o||(h.left+=a.showHeaders?31:0))):d=this.parent.getMainContent(),r.style.top=Number(oh(h.top).toFixed(2))+"px",r.style.left=Number(oh(h.left).toFixed(2))+"px",i===this.parent.activeSheetIndex&&(d.appendChild(r),this.renderResizeHandles(r),this.addEventListener(r)),this.originalWidth=parseFloat(getComputedStyle(r,null).getPropertyValue("width").replace("px","")),this.originalHeight=parseFloat(getComputedStyle(r,null).getPropertyValue("height").replace("px","")),{element:r,top:h.top,left:h.left}},s.prototype.adjustFreezePaneSize=function(e,t,i){var r=ee(i),n=this.parent.getActiveSheet(),a=this.parent.frozenRowCount(n),o=this.parent.frozenColCount(n);if(r[0]<a||r[1]<o?(m(e.top)||(t.style.top=e.top+(n.showHeaders?31:0)-this.parent.viewport.beforeFreezeHeight+"px"),m(e.left)||(t.style.left=e.left+this.parent.sheetModule.getRowHeaderWidth(n,!0)-this.parent.viewport.beforeFreezeWidth+"px")):(m(e.top)||(t.style.top=e.top-this.parent.viewport.beforeFreezeHeight-(a?Ei(n,xe(n.topLeftCell)[0],a-1):0)+"px"),m(e.left)||(t.style.left=e.left-this.parent.viewport.beforeFreezeWidth-(o?ci(n,xe(n.topLeftCell)[1],o-1):0)+"px")),m(e.top)){var l=xe(n.topLeftCell)[0];e.top=this.parent.viewport.beforeFreezeHeight+(a&&l===r[0]?0:Ei(n,a?l:0,r[0]-1))}if(m(e.left)){var h=xe(n.topLeftCell)[1];e.left=this.parent.viewport.beforeFreezeWidth+(o&&h===r[1]?0:ci(n,o?h:0,r[1]-1))}},s.prototype.addEventListener=function(e){var t=e;I.add(t,Dd(),this.overlayClickHandler,this),I.add(t,kl(),this.overlayMouseMoveHandler,this),I.add(this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),kl(),this.overlayMouseMoveHandler,this),I.add(document,C0(),this.overlayMouseUpHandler,this),this.parent.on(bM,this.setOriginalSize,this)},s.prototype.setOriginalSize=function(e){this.originalHeight=e.height,this.originalWidth=e.width},s.prototype.overlayMouseMoveHandler=function(e){var t=e.target,i=document.getElementsByClassName("e-ss-overlay-active")[0],r=this.parent.getActiveSheet(),n=r.frozenRows||r.frozenColumns?[29,this.parent.sheetModule.getRowHeaderWidth(r,!0)]:[-1,-1],a,o,l,h,u,c;if(this.isOverlayClicked&&this.isResizerClicked)switch(S0(e)&&e.preventDefault(),this.resizer){case"e-ss-overlay-t":a=Math.max(this.originalMouseY-Za(e)+this.originalHeight,20),o=Za(e)-(this.originalMouseY-this.originalResizeTop),a>20&&o>n[0]&&(i.style.height=a+"px",i.style.top=o+"px",this.resizedReorderTop=o,this.currenHeight=a,this.parent.notify(Al,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-r":l=this.originalWidth+(r7(e)-this.originalMouseX),l>20&&(i.style.width=l+"px",this.currentWidth=l,this.parent.notify(Al,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-b":h=this.originalHeight+(n7(e)-this.originalMouseY),h>20&&(i.style.height=h+"px",this.currenHeight=h,this.parent.notify(Al,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-l":u=Math.max(this.originalMouseX-Ka(e)+this.originalWidth,20),c=Ka(e)-(this.originalMouseX-this.originalResizeLeft),u>20&&c>n[1]&&(i.style.width=u+"px",i.style.left=c+"px",this.resizedReorderLeft=c,this.currentWidth=u,this.parent.notify(Al,{height:i.style.height,width:i.style.width,overlayEle:i}));break}else if(this.isOverlayClicked)if(S0(e)&&e.preventDefault(),U(t,".e-sheet")&&!t.classList.contains("e-sheet-content")||t.classList.contains("e-cell")){if(!i)return;var d=Ka(e)-this.diffX,p=Za(e)-this.diffY;d>n[1]&&(i.style.left=d+"px"),p>n[0]&&(i.style.top=p+"px"),this.resizedReorderLeft=d<0?0:d,this.resizedReorderTop=p<0?0:p}else this.overlayMouseUpHandler(e,!0)},s.prototype.overlayMouseUpHandler=function(e,t){if(!(!this.parent||this.parent.getActiveSheet().isProtected)){this.isResizerClicked=!1;var i=e.target,r=document.getElementsByClassName("e-datavisualization-chart e-ss-overlay-active");i.classList.contains("e-ss-overlay")||(i=U(e.target,".e-datavisualization-chart")?U(e.target,".e-datavisualization-chart"):i);var n=this.parent.getActiveSheet(),a={prevTop:n.frozenRows||n.frozenColumns?this.prevY:this.originalReorderTop,prevLeft:n.frozenRows||n.frozenColumns?this.prevX:this.originalReorderLeft,currentTop:this.resizedReorderTop>=0?parseInt(this.resizedReorderTop.toString(),10):this.originalReorderTop,currentLeft:this.resizedReorderLeft>=0?parseInt(this.resizedReorderLeft.toString(),10):this.originalReorderLeft,id:i.id,currentHeight:this.currenHeight,currentWidth:this.currentWidth,requestType:"imageRefresh",prevHeight:this.originalHeight,prevWidth:this.originalWidth};if(this.isOverlayClicked||t){var o=void 0,l=void 0,h={clientY:a.prevTop,isImage:!0},u={clientX:a.prevLeft,isImage:!0},c=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0];if(n.frozenRows||n.frozenColumns){if(!c)return;h.isImage=!1,u.isImage=!1,h.target=c,u.target=c,a.prevTop<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(h.target=this.parent.getColumnHeaderContent()),a.prevLeft<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(u.target=this.parent.getRowHeaderTable());var d=c.getBoundingClientRect();o={clientY:d.top},l={clientX:d.left},d.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(o.target=this.parent.getColumnHeaderContent()),d.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else o={clientY:a.currentTop,isImage:!0},l={clientX:a.currentLeft,isImage:!0};if(this.parent.notify(lo,h),this.parent.notify(lo,o),this.parent.notify(ho,u),this.parent.notify(ho,l),o.size&&(a.currentTop=o.size),l.size&&(a.currentLeft=l.size),a.prevRowIdx=h.clientY,a.prevColIdx=u.clientX,a.currentRowIdx=o.clientY,a.currentColIdx=l.clientX,(n.frozenColumns||n.frozenRows)&&!U(c,".e-sheet-content")){var p=this.parent.frozenColCount(n),f=this.parent.frozenRowCount(n);if(a.currentRowIdx>=f&&a.currentColIdx>=p){var v=parseInt(c.style.top,10),g=parseInt(c.style.left,10),b=this.parent.sheetModule.contentPanel;v+=b.scrollTop,v-=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var y=this.parent.getScrollElement();g+=y.scrollLeft,g-=this.parent.sheetModule.getRowHeaderWidth(n),c.style.top=v+"px",c.style.left=g+"px",this.parent.getMainContent().appendChild(c)}}r&&r[0]&&r[0].querySelector(".e-control")&&(a.id=r[0].id),this.originalReorderTop!==this.resizedReorderTop||this.originalReorderLeft!==this.resizedReorderLeft?(a.id=c.id,r&&r[0]?(a.requestType="chartRefresh",this.parent.notify(Ed,a)):this.parent.notify(Md,a),this.resizedReorderTop=this.originalReorderTop,this.resizedReorderLeft=this.originalReorderLeft):(this.currenHeight!==this.originalHeight||this.originalWidth!==this.currentWidth)&&(a.id=i.id.indexOf("overlay")>0?i.id:i.parentElement&&i.parentElement.classList.contains("e-ss-overlay")?i.parentElement.id:c.id,r&&r[0]?(a.requestType="chartRefresh",this.parent.notify(Ed,a)):this.parent.notify(Md,a),this.originalHeight=this.currenHeight,this.originalWidth=this.currentWidth)}this.isOverlayClicked=!1}},s.prototype.isOverlaySelected=function(e){e.isOverlayClicked=this.isOverlayClicked},s.prototype.refreshOverlayElem=function(){var e=document.getElementsByClassName("e-ss-overlay-active")[0];e&&te([e],"e-ss-overlay-active")},s.prototype.overlayClickHandler=function(e){if(!this.parent.getActiveSheet().isProtected){this.isOverlayClicked=!0;var t=e.target,i=e.target;t.classList.contains("e-ss-overlay")||(i=t.parentElement,U(e.target,".e-datavisualization-chart")&&(i=U(e.target,".e-datavisualization-chart")));var r=this.parent.getActiveSheet();if((r.frozenColumns||r.frozenRows)&&U(i,".e-sheet-content")){var n=parseInt(i.style.top,10),a=parseInt(i.style.left,10),o=this.parent.sheetModule.contentPanel;n-=o.scrollTop,n+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var l=this.parent.getScrollElement();a-=l.scrollLeft,a+=this.parent.sheetModule.getRowHeaderWidth(r),i.style.top=n+"px",i.style.left=a+"px",this.parent.element.querySelector("#"+this.parent.element.id+"_sheet").appendChild(i)}this.originalWidth=this.currentWidth=parseFloat(i.style.width),this.originalHeight=this.currenHeight=parseFloat(i.style.height),this.originalReorderLeft=parseFloat(i.style.left),this.originalReorderTop=parseFloat(i.style.top),this.resizedReorderLeft=parseFloat(i.style.left),this.resizedReorderTop=parseFloat(i.style.top),this.originalResizeTop=this.originalReorderTop,this.originalResizeLeft=this.originalReorderLeft,this.originalMouseX=Ka(e),this.originalMouseY=Za(e),this.diffX=this.originalMouseX-this.originalReorderLeft,this.diffY=this.originalMouseY-this.originalReorderTop;var h=document.getElementsByClassName("e-ss-overlay-active")[0];h&&te([h],"e-ss-overlay-active"),this.parent.element.querySelector("#"+i.id).classList.add("e-ss-overlay-active"),t.classList.contains("e-ss-resizer")&&(this.resizer=t.classList[0],this.isResizerClicked=!0),i.classList.contains("e-datavisualization-chart")&&(this.parent.notify(p1,{id:i.id}),h||this.parent.notify(c0,{id:i.id}));var u=i.getBoundingClientRect();this.prevX=u.left,this.prevY=u.top}},s.prototype.renderResizeHandles=function(e){for(var t=["e-ss-overlay-t","e-ss-overlay-r","e-ss-overlay-b","e-ss-overlay-l"],i=0,r,n=e;t.length>i;)r=this.parent.createElement("div",{className:t[i]+" e-ss-resizer"+(B.isDevice?" e-ss-resizer-touch":""),styles:"width: 8px; height: 8px; border-radius: 4px;"}),n.appendChild(r),i++},s.prototype.removeEventListener=function(){var e=this.parent.element.querySelectorAll(".e-ss-overlay");if(e.length)for(var t=0;t<e.length;t++)I.remove(e[t],Dd(),this.overlayClickHandler),I.remove(e[t],kl(),this.overlayMouseMoveHandler);I.remove(this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),kl(),this.overlayMouseMoveHandler),I.remove(document,C0(),this.overlayMouseUpHandler),this.parent.off(bM,this.setOriginalSize),this.parent.off(tv,this.isOverlaySelected),this.parent.off(cM,this.refreshOverlayElem),this.parent.off(Dn,this.destroy)},s.prototype.destroy=function(){this.removeEventListener(),this.parent=null},s}(),eX=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jt=function(s,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,e,t,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(e,t,n):a(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},tX=function(s){eX(e,s);function e(i,r){var n=s.call(this,i)||this;return n.viewport={rowCount:0,colCount:0,height:0,topIndex:0,leftIndex:0,width:0,bottomIndex:0,rightIndex:0,beforeFreezeHeight:0,beforeFreezeWidth:0},n.needsID=!0,t.Inject(WY,qY,QY,d7,c7,v7,m7,u7,AP,GY,XY,$Y,KY,g7,YY,uY,VP,NP,LP,HP,FP,OP,ZY,PP,B9,hY,zP,TQ,lY,UP,cY,dY,_P,m6,FY,WP,PY,YP,zY,qP,jY,QP,DQ,BY,jP,GP,W$,BP,HY,$P),r&&n.appendTo(r),n}t=e,e.prototype.getCell=function(i,r,n){var a;return this.insideViewport(i,r)&&(n||(n=this.getRow(i,null,r)),r=this.getViewportIndex(r,!0),a=n&&n.cells[r]),a},e.prototype.getRow=function(i,r,n){if(!r){var a=this.getActiveSheet(),o=this.frozenRowCount(a),l=this.frozenColCount(a);m(n)||i>o-1&&n>l-1?r=this.getContentTable():r=i<o&&n<l?this.sheetModule.getSelectAllTable():i<o?this.getColHeaderTable():this.getRowHeaderTable()}return i=this.getViewportIndex(i),r?r.rows[i]:null},e.prototype.hiddenCount=function(i,r,n,a){n===void 0&&(n="rows"),a===void 0&&(a=this.getActiveSheet());for(var o=0,l,h=i;h<=r;h++)l=a[""+n][h],l&&l.hidden&&o++;return o},e.prototype.getViewportIndex=function(i,r){var n=this.getActiveSheet(),a=this.frozenColCount(n),o=this.frozenRowCount(n);if(r)if(a){var l=xe(n.topLeftCell)[1];return i<a?(i-=this.hiddenCount(l,i,"columns"),i-=l,i+1):(i-=this.hiddenCount(this.viewport.leftIndex+a,i,"columns"),i-=this.viewport.leftIndex+a,i)}else i-=this.hiddenCount(this.viewport.leftIndex,i,"columns"),i-=this.viewport.leftIndex;else if(o){var h=xe(n.topLeftCell)[0];return i<o?(i-=this.hiddenCount(h,i),i-=h,i+1):(i-=this.hiddenCount(this.viewport.topIndex+o,i),i-=this.viewport.topIndex+o,i)}else i-=this.hiddenCount(this.viewport.topIndex,i),i-=this.viewport.topIndex;return i},e.prototype.preRender=function(){s.prototype.preRender.call(this),this.serviceLocator=new sz,this.initServices()},e.prototype.initServices=function(){this.serviceLocator.register(de,new In(this.getModuleName(),e7,this.locale)),this.serviceLocator.register(At,new K$(this)),this.serviceLocator.register(K6,new Z$(this)),this.serviceLocator.register(II,new J$(this))},e.prototype.render=function(){if(s.prototype.render.call(this),this.element.setAttribute("tabindex","0"),this.renderModule=new X$(this),this.renderSpreadsheet(),this.wireEvents(),this.created)if(this.created.observers){if(this.created.observers.length>0){var i={observers:this.created.observers};this.isAngular&&(i={observers:this.created.observers,currentObservers:this.created.observers},this.created.currentObservers=[]),this.createdHandler=i,this.created.observers=[]}}else this.createdHandler=this.created,this.setProperties({created:void 0},!0)},e.prototype.renderSpreadsheet=function(){this.cssClass&&Q([this.element],this.cssClass.split(" ")),this.setHeight(),this.setWidth(),Nd({target:this.element},this.createElement),this.isMobileView()&&this.cssClass.indexOf("e-mobile-view")===-1&&this.element.classList.add("e-mobile-view"),B.isDevice&&this.element.classList.add("e-device"),this.sheetModule=this.serviceLocator.getService("sheet"),this.allowScrolling&&(this.scrollModule=new p7(this)),this.scrollSettings.enableVirtualization&&new f7(this),this.renderModule.render(),new H9(this)},e.prototype.showSpinner=function(){Ol(this.element)},e.prototype.hideSpinner=function(){kd(this.element)},e.prototype.protectSheet=function(i,r,n){s.prototype.protectSheet.call(this,i,r,n)},e.prototype.unprotectSheet=function(i){s.prototype.unprotectSheet.call(this,i)},e.prototype.find=function(i){var r=this.getActiveSheet().activeCell;if(s.prototype.findHandler.call(this,i),!i.isAction)return r!==this.getActiveSheet().activeCell?this.getActiveSheet().name+"!"+this.getActiveSheet().activeCell:null},e.prototype.replace=function(i){i={value:i.value,mode:i.mode?i.mode:"Sheet",isCSen:i.isCSen?i.isCSen:!1,isEMatch:i.isEMatch?i.isEMatch:!1,searchBy:i.searchBy?i.searchBy:"By Row",replaceValue:i.replaceValue,replaceBy:i.replaceBy,sheetIndex:Re(i.sheetIndex)?this.activeSheetIndex:i.sheetIndex,findOpt:i.findOpt?i.findOpt:""},s.prototype.replaceHandler.call(this,i)},e.prototype.findAll=function(i,r,n,a,o){r=r||"Sheet",o=o||this.activeSheetIndex,n=n||!1,a=a||!1;var l=[],h={value:i,mode:r,sheetIndex:o,isCSen:n,isEMatch:a,findCollection:l};return this.notify(Jw,h),l},e.prototype.goTo=function(i){if(i.includes("!")){var r=gt(this,Ms(i));if(r===void 0)return;if(r!==this.activeSheetIndex){var n=i.split("!")[1],a=n.split(":")[0],o=this.sheets[r];this.setSheetPropertyOnMute(o,"activeCell",a),this.setSheetPropertyOnMute(o,"selectedRange",n);var l=xe(a);if(o.frozenColumns||o.frozenRows){var h=xe(o.topLeftCell);if(!(o.frozenRows&&l[0]<h[0]||o.frozenColumns&&l[1]<h[1])){var u=this.frozenRowCount(o),c=this.frozenColCount(o),d=[],p=[],f=xe(o.paneTopLeftCell);u?(d.push(h[0]),l[0]>=u?p.push(l[0]):p.push(f[0])):(d.push(l[0]),p.push(l[0])),c?(d.push(h[1]),l[1]>=c?p.push(l[1]):p.push(f[1])):(d.push(l[1]),p.push(l[1])),this.setSheetPropertyOnMute(o,"topLeftCell",Je(d[0],d[1])),this.setSheetPropertyOnMute(o,"paneTopLeftCell",Je(p[0],p[1]))}}else l[0]<this.viewport.rowCount&&(l[0]=0),l[1]<this.viewport.colCount&&(l[1]=0),this.updateTopLeftCell(l[0],l[1],null,o);this.activeSheetIndex=r,this.dataBind();return}}var v=ee(i),g=this.getActiveSheet(),b=this.frozenRowCount(g),y=this.frozenColCount(g),C=this.insideViewport(v[0],v[1]);if(C){this.selectRange(i);var x=xe(g.paneTopLeftCell),w=this.viewport.height-this.getScrollElement().parentElement.getBoundingClientRect().height,M=0,E=0;if(b){for(var T=xe(g.topLeftCell),D=T[0];D<b;D++)if(M+=Wt(g,D),M>w){E=D;break}}if(E===0)for(var D=x[0];D<=this.viewport.bottomIndex;D++)if(M+=Wt(g,D),M>w){E=D;break}else D===this.viewport.bottomIndex&&(E=this.viewport.bottomIndex);x[2]=E;var N=0;if(M=0,w=this.viewport.width-this.sheetModule.getScrollSize(),y){for(var T=xe(g.topLeftCell),D=T[1];D<y;D++)if(M+=tr(g,D),M>w){N=D;break}}if(N===0)for(var D=x[1];D<=this.viewport.rightIndex;D++)if(M+=tr(g,D),M>w){N=D;break}else D===this.viewport.rightIndex&&(N=this.viewport.rightIndex);if(x[3]=N,v[0]>=x[0]&&v[0]<x[2]&&v[1]>=x[1]&&v[1]<x[3]||(b||y)&&(x=[].concat(xe(g.topLeftCell),[b,x[3]]),v[0]>=x[0]&&v[0]<x[2]&&v[1]>=x[1]&&v[1]<x[3]||(x[2]=E,x[3]=y,v[0]>=x[0]&&v[0]<x[2]&&v[1]>=x[1]&&v[1]<x[3])))return}var A=this.getMainContent().parentElement,L,k,O,R,j,P;v[0]===b?O=0:(O=Ei(g,b,v[0]-1,!0),this.scrollSettings.enableVirtualization&&(P=O+this.getContentTable().getBoundingClientRect().height,j=parseFloat(A.querySelector(".e-virtualtrack").style.height),P>j&&(P+=10,L=A.querySelector(".e-virtualtrack"),L.style.height=P+"px",Vi(function(){L.style.height=j+"px"})))),A.scrollTop=O,A=this.element.getElementsByClassName("e-scroller")[0],v[1]===y?O=0:(O=ci(g,y,v[1]-1,!0),this.scrollSettings.enableVirtualization&&(P=O+this.getContentTable().getBoundingClientRect().width,R=parseFloat(A.querySelector(".e-virtualtrack").style.width),P>R&&(P+=10,L=A.querySelector(".e-virtualtrack"),L.style.width=P+"px",k=this.getColumnHeaderContent().querySelector(".e-virtualtrack"),k.style.width=P+"px",L=this.getMainContent().querySelector(".e-virtualtrack"),L.style.width=P+"px",Vi(function(){L.style.width=R+"px",k.style.width=R+"px"})))),A.scrollLeft=O,C||this.selectRange(i)},e.prototype.insideViewport=function(i,r){var n=this.getActiveSheet();if(n.frozenRows||n.frozenColumns){var a=this.frozenRowCount(n),o=this.frozenColCount(n),l=xe(n.topLeftCell);return(i>=l[0]&&i<a||i>=this.viewport.topIndex+a&&i<=this.viewport.bottomIndex)&&(r>=l[1]&&r<o||r>=this.viewport.leftIndex+o&&r<=this.viewport.rightIndex)}else return i>=this.viewport.topIndex&&i<=this.viewport.bottomIndex&&r>=this.viewport.leftIndex&&r<=this.viewport.rightIndex},e.prototype.resize=function(){this.renderModule.setSheetPanelSize(),this.scrollSettings.enableVirtualization&&this.renderModule.refreshSheet(!1,!0)},e.prototype.cut=function(i){var r=new Promise(function(n,a){n(function(){}())});return this.notify(du,i?{range:ir(i),sId:this.sheets[gt(this,Ms(i))]?this.sheets[gt(this,Ms(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},e.prototype.copy=function(i){var r=new Promise(function(n,a){n(function(){}())});return this.notify(pu,i?{range:ir(i),sId:this.sheets[gt(this,Ms(i))]?this.sheets[gt(this,Ms(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},e.prototype.paste=function(i,r){this.notify(Ia,{range:i&&ir(i),sIdx:i&&gt(this,Ms(i)),type:r,isAction:!0,isInternal:!0})},e.prototype.updateAction=function(i){kr(i,this)},e.prototype.setHeight=function(){this.height.toString().indexOf("%")>-1&&(this.element.style.minHeight="400px"),this.element.style.height=qe(this.height)},e.prototype.setWidth=function(){(this.width.toString().indexOf("%")>-1||this.width==="auto")&&(this.element.style.minWidth="300px"),this.element.style.width=qe(this.width)},e.prototype.setColWidth=function(i,r,n){i===void 0&&(i=64),r===void 0&&(r=0);var a=m(n)?this.getActiveSheet():this.sheets[n];if(a){var o=r,l=typeof i=="number"?i+"px":i;r=m(r)?xe(a.activeCell)[1]:r;var h=function(){oi(a,o).width=parseInt(l,10)>0?parseInt(l,10):0,a.columns[o].customWidth=!0},u=this.frozenColCount(a);if(a.id===this.getActiveSheet().id){if(r>=this.viewport.leftIndex+u&&r<=this.viewport.rightIndex||u&&r<u){r=this.getViewportIndex(r,!0);var c=tr(a,o,null,!0),d=Mr(parseInt(l,10))-c;d<0&&c<-d&&(d=-c),h(),this.notify(wn,{threshold:d,colIdx:o,checkWrapCell:!0}),EM(o,r,l,!0,this)}else{var p=tr(a,r),d=void 0;parseInt(l,10)>0?d=-(p-parseInt(l,10)):d=-p,h(),this.notify(wn,{threshold:d,colIdx:r})}this.notify(Pa,null)}else h()}},e.prototype.setRowHeight=function(i,r,n,a){i===void 0&&(i=20),r===void 0&&(r=0);var o=m(n)?this.getActiveSheet():this.sheets[n];if(o){var l=r,h=typeof i=="number"?i+"px":i;r=m(r)?xe(o.activeCell)[0]:r;var u=function(){Id(o,l,parseInt(h,10)>0?parseInt(h,10):0),o.rows[l].customHeight=!0};if(o.id===this.getActiveSheet().id){var c=this.frozenRowCount(o);if(r>=this.viewport.topIndex+c&&r<=this.viewport.bottomIndex||c&&r<c){r=this.getViewportIndex(l);var d=Wt(o,l,!0),p=Mr(parseInt(h,10))-d;p<0&&d<-p&&(p=-d),u(),this.notify(an,{threshold:p,rowIdx:l,isCustomHgt:!0}),m(a)&&(a=!1),a||(EM(l,r,h,!1,this),a=!1)}else{var f=Wt(o,r),p=void 0;parseInt(h,10)>0?p=-(f-parseInt(h,10)):p=-f,u(),this.notify(an,{threshold:p,rowIdx:l})}this.notify(Pa,null)}else u()}},e.prototype.setRowsHeight=function(i,r){i===void 0&&(i=20),r||(r=["1:"+(this.getActiveSheet().usedRange.rowIndex+1)]),this.setSize(i,r,function(n){return Number(n)-1},this.setRowHeight.bind(this))},e.prototype.setColumnsWidth=function(i,r){i===void 0&&(i=64),r||(r=["A:"+Ur(this.getActiveSheet().usedRange.colIndex+1)]),this.setSize(i,r,function(n){return Rn(n)},this.setColWidth.bind(this))},e.prototype.setSize=function(i,r,n,a){var o=this,l,h,u,c;r.forEach(function(d){d.includes("!")?(h=d.split("!"),l=gt(o,h[0]),d=h[1]):l=o.activeSheetIndex,d.includes(":")?(h=d.split(":"),u=n(h[0]),c=n(h[1])):u=c=n(d);for(var p=u;p<=c;p++)a(i,p,l)})},e.prototype.autoFit=function(i){var r=this.getIndexes(i),n=r.startIdx,a=r.endIdx,o=r.isCol,l=o?Rn("XFD"):1048576;if(n<=l)a>l&&(a=l);else return;for(n;n<=a;n++)this.notify(X1,{idx:n,isCol:o})},e.prototype.getIndexes=function(i){var r,n,a,o;if(i.indexOf(":")!==-1){var l=i.split(":");a=l[0],o=l[1]}else a=i,o=i;if(!m(a)){var h=this.getAddress(a);a=h.address,r=h.isCol}if(!m(o)){var u=this.getAddress(o);o=u.address,n=u.isCol}var c=r===!0&&n===!0,d=c?Rn(a.toUpperCase()):parseInt(a,10),p=c?Rn(o.toUpperCase()):parseInt(o,10);return{startIdx:d,endIdx:p,isCol:c}},e.prototype.getAddress=function(i){var r;return i.substring(0,1).match(/\D/g)?(r=!0,i=i.replace(/[0-9]/g,""),{address:i,isCol:r}):i.substring(0,1).match(/[0-9]/g)&&i.match(/\D/g)?{address:"",isCol:!1}:(i=(parseInt(i,10)-1).toString(),{address:i,isCol:r})},e.prototype.addHyperlink=function(i,r,n){this.insertHyperlink(i,r,n,!0)},e.prototype.removeHyperlink=function(i){this.notify(Xf,{range:i,preventEventTrigger:!0})},e.prototype.insertHyperlink=function(i,r,n,a){if(this.allowHyperlink){var o=void 0,l=void 0,h=void 0,u=this.getActiveSheet();r=r||u.name+"!"+u.activeCell,h=ee(r);for(var c=this.getCell(h[0],h[1]),d=[],p=0;c&&p<c.classList.length;p++)d.push(c.classList[p]);var f={hyperlink:i,address:r,displayText:n,cancel:!1},v={hyperlink:i,address:r,displayText:n};if(a||(this.trigger(KW,f),this.notify(li,{action:"hyperlink",eventArgs:f})),!f.cancel){i=f.hyperlink,r=f.address;var g={hyperlink:i,cell:r,displayText:n,triggerEvt:!a};if(this.notify(dd,g),r&&r.indexOf("!")!==-1){o=r.split("!");for(var b=this.sheets,y=0;y<b.length;y++)b[y].name===o[0]&&(l=y);u=this.sheets[l],r=o[1]}if(!u)return;if(r=r||this.getActiveSheet().activeCell,h=ee(r),a||(this.trigger(ZW,v),this.notify(yt,{action:"hyperlink",eventArgs:f})),u===this.getActiveSheet()){this.serviceLocator.getService("cell").refreshRange(h,!1,!1,!1,!0,ea(this));for(var p=0;p<d.length;p++)this.getCell(h[0],h[1]).classList.contains(d[p])||this.getCell(h[0],h[1]).classList.add(d[p]);this.notify(Oa,null)}}}},e.prototype.addDataValidation=function(i,r){s.prototype.addDataValidation.call(this,i,r)},e.prototype.removeDataValidation=function(i){this.notify(Yo,{range:i,isRemoveValidation:!0,viewport:this.viewport})},e.prototype.addInvalidHighlight=function(i){var r=i||this.dataValidationRange;if(r.indexOf(",")>-1){var n="";r.includes("!")&&(n=r.split("!")[0]+"!",r=r.split("!")[1]);for(var a=r.split(","),o=0;o<a.length-1;o++)s.prototype.addInvalidHighlight.call(this,n+a[o])}else s.prototype.addInvalidHighlight.call(this,r)},e.prototype.removeInvalidHighlight=function(i){var r=i||this.dataValidationRange;if(r.indexOf(",")>-1){var n="";r.includes("!")&&(n=r.split("!")[0]+"!",r=r.split("!")[1]);for(var a=r.split(","),o=0;o<a.length-1;o++)s.prototype.removeInvalidHighlight.call(this,n+a[o])}else s.prototype.removeInvalidHighlight.call(this,r)},e.prototype.conditionalFormat=function(i){s.prototype.conditionalFormat.call(this,i)},e.prototype.clearConditionalFormat=function(i){i=i||this.getActiveSheet().selectedRange,s.prototype.clearConditionalFormat.call(this,i)},e.prototype.setPanelSize=function(){if(this.height!=="auto"){var i=document.getElementById(this.element.id+"_sheet_panel");i.style.height=this.element.getBoundingClientRect().height-lz(i)+"px"}},e.prototype.open=function(i){this.isOpen=!0,s.prototype.open.call(this,i),this.isOpen&&this.showSpinner()},e.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(nn,{startIndex:i,endIndex:r,hide:n}):s.prototype.hideRow.call(this,i,r,n)},e.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(nn,{startIndex:i,endIndex:r,hide:n,isCol:!0}):s.prototype.hideColumn.call(this,i,r,n)},e.prototype.clear=function(i){this.notify(ev,{options:i})},e.prototype.refresh=function(i){this.isReact&&this.clearTemplate(),i?(this.notify(Cd,null),this.sheets.length=0,this.sheetNameCount=1,this.notify(Jl,{}),this.notify(mu,null),this.createSheet(),this.activeSheetIndex=this.sheets.length-1,this.notify(Wl,null),this.notify(xt,{action:"initSheetInfo"}),this.renderModule.refreshSheet(),this.openModule.isImportedFile=this.openModule.preventFormatCheck=!1,this.openModule.unProtectSheetIdx=[]):s.prototype.refresh.call(this)},e.prototype.insertImage=function(i,r){var n;for(n=0;n<i.length;n++)this.notify(Da,{options:i[n],range:r||this.getActiveSheet().selectedRange,isPublic:!0})},e.prototype.deleteImage=function(i,r){this.notify(Xs,{id:i,range:r||this.getActiveSheet().selectedRange})},e.prototype.getRowHeaderContent=function(){return this.sheetModule.getRowHeaderPanel()},e.prototype.getColumnHeaderContent=function(){return this.sheetModule.getColHeaderPanel()},e.prototype.getMainContent=function(){return this.sheetModule.getContentPanel()},e.prototype.getSelectAllContent=function(){return this.sheetModule.getSelectAllContent()},e.prototype.getScrollElement=function(){return this.sheetModule.getScrollElement()},e.prototype.getContentTable=function(){return this.sheetModule.getContentTable()},e.prototype.getRowHeaderTable=function(){return this.sheetModule.getRowHeaderTable()},e.prototype.getColHeaderTable=function(){return this.sheetModule.getColHeaderTable()},e.prototype.getThreshold=function(i){var r=Math.round((this.viewport[i+"Count"]+1)/2);return r<15?15:r},e.prototype.isMobileView=function(){return(this.cssClass.indexOf("e-mobile-view")>-1||B.isDevice)&&this.cssClass.indexOf("e-desktop-view")===-1&&!1},e.prototype.getValueRowCol=function(i,r,n,a,o,l,h){return s.prototype.getValueRowCol.call(this,i,r,n,a,o,l,h)},e.prototype.updateCell=function(i,r){r=r||this.getActiveSheet().activeCell,s.prototype.updateCell.call(this,i,r)},e.prototype.getRowData=function(i,r){return s.prototype.getRowData.call(this,i,r)},e.prototype.sort=function(i,r){var n=this;return this.allowSorting?s.prototype.sort.call(this,i,r).then(function(a){return n.notify($p,a),Promise.resolve(a)}):Promise.reject()},e.prototype.setValueRowCol=function(i,r,n,a,o,l){if(r==="circular reference: "){var h={action:"isCircularReference",argValue:r};this.notify(Ho,h),r=h.argValue}if(s.prototype.setValueRowCol.call(this,i,r,n,a,o,l),this.allowEditing)this.notify(Jt,{action:"refreshDependentCellValue",rowIdx:n,colIdx:a,sheetIdx:Qn(this,i)});else{var u=Qn(this,i);if(n--,a--,this.activeSheetIndex===u){var c=Pe(this,u),d=void 0;if(!ct(c,n)&&!Yt(c,a)&&(d=this.getCell(n,a)),d){if(d.parentElement){var p=d.parentElement.getAttribute("aria-rowindex");if(p&&Number(p)-1!==n)return}var f=Y(n,a,c),v={value:f.value,format:f.format,onLoad:!0,formattedText:"",isRightAlign:!1,type:"General",cell:f,rowIndex:n,colIndex:a,isRowFill:!1};this.notify(jn,v),v.formattedText=this.allowNumberFormatting?v.formattedText:v.value;var g={isRightAlign:v.isRightAlign,result:v.formattedText,type:v.type,value:v.value,curSymbol:v.curSymbol,isRowFill:v.isRowFill};this.refreshNode(d,g)}}}},e.prototype.getModuleName=function(){return"spreadsheet"},e.prototype.refreshNode=function(i,r){var n;if(i){if(r){if(r.result=m(r.result)?"":r.result.toString(),!r.isRowFill){var a=$(".e-fill",i);a&&(ne(a),i.style.display="table-cell");var o=$(".e-fill-sec",i);o&&ne(o)}var l=$("#"+this.element.id+"_currency",i);if(l&&ne(l),r.type==="Accounting"&&He(r.value)&&r.result.includes(r.curSymbol)){var h=void 0,u=void 0,c=void 0;r.result.trim().endsWith(r.curSymbol)?u=r.result:(h=r.result.includes(" "+r.curSymbol)?" "+r.curSymbol:r.curSymbol,u=r.result.split(h).join(""));var d=i.querySelector(".e-databar-value"),p=i;if(d?(this.refreshNode(d,{result:u}),p=i.querySelector(".e-cf-databar")||i):i.querySelector("a")?i.querySelector("a").textContent=u:(c=!0,i.innerText=""),h){var f=this.createElement("span",{id:this.element.id+"_currency",styles:"float: left"});f.innerText=h,p.appendChild(f)}c&&(i.innerHTML+=u),i.classList.add("e-right-align");return}else{var v=void 0;r.result&&(r.result.toLowerCase()==="true"||r.result.toLowerCase()==="false")?(r.result=r.result.toUpperCase(),v="e-center-align",r.isRightAlign=!0):v="e-right-align",n=r.result,r.isRightAlign?i.classList.add(v):i.classList.remove(v)}}n=m(n)?"":n,!m(r.rowIndex)&&!m(r.colIndex)&&De(i,{"aria-label":(n?n+" ":"")+Je(r.rowIndex,r.colIndex)});var g=i.lastChild;i.querySelector(".e-databar-value")&&(g=i.querySelector(".e-databar-value").lastChild),i.querySelector(".e-hyperlink")&&(g=i.querySelector(".e-hyperlink").lastChild);var b=i.querySelector(".e-wrap-content");if(b&&(b.lastChild||b.appendChild(document.createTextNode("")),g=b.lastChild),(this.isAngular||this.isVue)&&i.classList.contains("e-cell-template")&&g&&(g.nodeType===8||g.nodeType===3)){if(g.nodeType===3||n!==""){var y=function(){i.childElementCount||(g.nodeType===3?r.isRowFill||(g.nodeValue=n):i.appendChild(document.createTextNode(n)))};this.isAngular?Vi(y):y()}}else g&&(g.nodeType===3||g.nodeType===1)?r.isRowFill||(g.nodeValue=n):i.appendChild(document.createTextNode(n))}},e.prototype.calculateHeight=function(i,r,n){r===void 0&&(r=1),n===void 0&&(n=1);var a=i&&i.fontSize||this.cellStyle.fontSize,o=i.fontFamily==="Arial Black"?1.44:1.24;return(a.indexOf("pt")>-1?parseInt(a,10)*1.33:parseInt(a,10))*o*r+n*o},e.prototype.skipHidden=function(i,r,n,a){n===void 0&&(n="rows"),a===void 0&&(a=this.scrollSettings.isFinite);var o=this.getActiveSheet(),l;this.scrollSettings.isFinite&&(l=(n==="rows"?o.rowCount:o.colCount)-1);for(var h=i;h<=r;h++)if(o[""+n][h]&&o[""+n][h].hidden){if(i===h&&i++,r++,a&&r>l){r=l;break}}else if(!a&&this.scrollSettings.isFinite&&r>l&&o[""+n][h-1]&&o[""+n][h-1].hidden){r--;break}return[i,r]},e.prototype.updateActiveBorder=function(i,r){r===void 0&&(r=".e-ribbon");var n=$(r+" .e-tab-header .e-indicator",this.element);n.style.display="none",tt(n,{left:"",right:""}),tt(n,{left:i.offsetLeft+"px",right:i.parentElement.offsetWidth-(i.offsetLeft+i.offsetWidth)+"px"}),n.style.display=""},e.prototype.undo=function(){this.notify(Fa,{isUndo:!0,isPublic:!0})},e.prototype.redo=function(){this.notify(Fa,{isUndo:!1,isPublic:!0})},e.prototype.updateUndoRedoCollection=function(i){this.notify(e0,{args:i,isPublic:!0})},e.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(Ho,r),r.isAdded},e.prototype.removeDefinedName=function(i,r){return s.prototype.removeDefinedName.call(this,i,r)},e.prototype.mouseClickHandler=function(i){this.notify(hu,i)},e.prototype.mouseDownHandler=function(i){this.notify(Qo,i)},e.prototype.keyUpHandler=function(i){U(i.target,".e-find-dlg")?this.notify(l1,i):this.notify(Xn,i)},e.prototype.keyDownHandler=function(i){var r=U(i.target,".e-findtool-dlg");if(r){if(i.keyCode===9){var n=i.target;if(i.shiftKey){if(n.classList.contains("e-text-findNext-short")){var a=r.querySelector(".e-findRib-close .e-tbar-btn");a&&(i.preventDefault(),a.focus())}}else n.classList.contains("e-tbar-btn")&&n.parentElement.classList.contains("e-findRib-close")&&Fe(r)}}else this.notify(Ra,i),!this.enableKeyboardNavigation&&document.activeElement.classList.contains("e-cell")&&[38,40,33,34,35,36].indexOf(i.keyCode)>-1&&i.preventDefault()},e.prototype.freeze=function(i){if(!(!this.allowFreezePane||i.row<0||i.column<0)){if(i.triggerEvent){var r={row:i.row,column:i.column,cancel:!1,sheetIndex:this.activeSheetIndex};if(this.notify(li,{eventArgs:r,action:"freezePanes"}),r.cancel)return}this.on(tn,this.freezePaneUpdated,this),this.freezePanes(i.row,i.column),this.notify(Oa,null)}},e.prototype.freezePaneUpdated=function(){this.off(tn,this.freezePaneUpdated);var i=this.getActiveSheet();Fe(this.element),this.notify(yt,{eventArgs:{row:i.frozenRows,column:i.frozenColumns,sheetIndex:this.activeSheetIndex},action:"freezePanes"})},e.prototype.wireEvents=function(){I.add(this.element,"click",this.mouseClickHandler,this),I.add(this.element,Dd(),this.mouseDownHandler,this),I.add(this.element,"keyup",this.keyUpHandler,this),I.add(this.element,"keydown",this.keyDownHandler,this),I.add(this.element,"noderefresh",this.refreshNode,this),this.on(Zp,this.freeze,this),this.on(ih,this.refreshInsertDelete,this)},e.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unwireEvents(),this.notify(Dn,null),s.prototype.destroy.call(this),this.element.innerHTML="",this.element.removeAttribute("tabindex"),this.element.removeAttribute("role"),this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("min-height"),this.element.style.removeProperty("min-width"),this.sheetModule&&this.sheetModule.destroy()},e.prototype.unwireEvents=function(){I.remove(this.element,"click",this.mouseClickHandler),I.remove(this.element,Dd(),this.mouseDownHandler),I.remove(this.element,"keyup",this.keyUpHandler),I.remove(this.element,"keydown",this.keyDownHandler),I.remove(this.element,"noderefresh",this.refreshNode),this.off(Zp,this.freeze),this.off(ih,this.refreshInsertDelete)},e.prototype.refreshInsertDelete=function(i){var r=this,n,a;i.sheet.ranges.forEach(function(o){o.template&&o.address&&(a=ee(o.address),n=r.updateRangeOnInsertDelete(i,a),n&&(o.address=je(a)))}),this.setSheetPropertyOnMute(i.sheet,"ranges",i.sheet.ranges)},e.prototype.addContextMenuItems=function(i,r,n,a){n===void 0&&(n=!0),this.notify(O1,{items:i,text:r,insertAfter:n,isUniqueId:a})},e.prototype.removeContextMenuItems=function(i,r){this.notify(R1,{items:i,isUniqueId:r})},e.prototype.enableContextMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(F1,{items:i,enable:r,isUniqueId:n})},e.prototype.enableFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(P1,{items:i,enable:r,isUniqueId:n})},e.prototype.hideFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(z1,{items:i,hide:r,isUniqueId:n})},e.prototype.addFileMenuItems=function(i,r,n,a){n===void 0&&(n=!0),this.notify(j1,{items:i,text:r,insertAfter:n,isUniqueId:a})},e.prototype.hideRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(B1,{tabs:i,hide:r})},e.prototype.enableRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(H1,{tabs:i,enable:r})},e.prototype.addRibbonTabs=function(i,r){this.notify(V1,{items:i,insertBefore:r})},e.prototype.enableToolbarItems=function(i,r,n){this.notify(nh,[{tab:i,items:r,enable:n===void 0?!0:n}])},e.prototype.hideToolbarItems=function(i,r,n){n===void 0&&(n=!0),this.notify(_1,{tab:i,indexes:r,hide:n})},e.prototype.addToolbarItems=function(i,r,n){this.notify(U1,{tab:i,items:r,index:n})},e.prototype.selectRange=function(i){this.isEdit&&this.notify(Jt,{action:"endEdit"}),this.notify(cu,{address:i})},e.prototype.startEdit=function(){this.notify(Jt,{action:"startEdit",isNewValueEdit:!1})},e.prototype.closeEdit=function(){this.notify(Jt,{action:"cancelEdit"})},e.prototype.endEdit=function(){this.notify(Jt,{action:"endEdit",isPublic:!0})},e.prototype.onPropertyChanged=function(i,r){var n=this;s.prototype.onPropertyChanged.call(this,i,r);for(var a,o=0,l=Object.keys(i);o<l.length;o++){var h=l[o],u=void 0,c=void 0;switch(h){case"enableRtl":if(i.locale||(u=this.getColumnHeaderContent(),u&&(u=u.parentElement),!u))break;if(i.enableRtl?(u.style.marginRight="",document.getElementById(this.element.id+"_sheet_panel").classList.add("e-rtl")):(u.style.marginLeft="",document.getElementById(this.element.id+"_sheet_panel").classList.remove("e-rtl")),this.allowScrolling&&this.scrollModule.setPadding(!0),this.allowAutoFill){var d=this.element.querySelector(".e-dragfill-ddb");if(d){var p=Ct(d,"dropdown-btn");p&&(p.enableRtl=i.enableRtl,p.dataBind())}}var f=this.getActiveSheet();if(this.sheetModule.setPanelWidth(f,this.getRowHeaderContent(),!0),this.allowImage||this.allowChart)for(var v=this.element.getElementsByClassName("e-ss-overlay"),g=void 0,b=void 0,y=void 0,C=0,x=v.length-1;C<=x;C++)b=v[0],b.classList.contains("e-datavisualization-chart")&&(y=b.querySelector(".e-accumulationchart"),y?g=Ct(y,"accumulationchart"):(y=b.querySelector(".e-chart"),g=y&&Ct(y,"chart")),g&&g.destroy()),ne(b),C===x&&this.notify(_y,{});var w=this.getScrollElement();w&&(w.scrollLeft=0),this.selectRange(f.selectedRange);break;case"cssClass":r.cssClass&&te([this.element],r.cssClass.split(" ")),i.cssClass&&Q([this.element],i.cssClass.split(" "));break;case"activeSheetIndex":this.renderModule.refreshSheet(),this.notify(fu,{idx:i.activeSheetIndex});break;case"width":this.setWidth(),this.resize();break;case"height":this.setHeight(),this.resize();break;case"showRibbon":this.notify(Wh,{prop:"showRibbon",onPropertyChange:!0});break;case"showFormulaBar":this.notify(Wf,{uiUpdate:!0});break;case"showSheetTabs":this.notify(Gy,null);break;case"cellStyle":this.renderModule.refreshSheet();break;case"allowEditing":if(this.allowEditing&&(this.notify(Jt,{action:"renderEditor"}),this.enableKeyboardNavigation)){this.enableKeyboardNavigation=!1,this.dataBind(),this.enableKeyboardNavigation=!0,this.dataBind();var M=this.selectionSettings.mode;M!=="None"&&(this.selectionSettings.mode="None",this.dataBind(),this.selectionSettings.mode=M,this.dataBind())}break;case"allowInsert":c=this.element.getElementsByClassName("e-add-sheet-tab")[0],c&&(c.disabled=!this.allowInsert,this.allowInsert?c.classList.contains("e-disabled")&&c.classList.remove("e-disabled"):c.classList.contains("e-disabled")||c.classList.add("e-disabled"));break;case"sheets":if(i.sheets===this.sheets){this.renderModule.refreshSheet(),this.notify(Wl,null),this.notify(xt,{action:"initSheetInfo"});break}Object.keys(i.sheets).forEach(function(T,D){var N=i.sheets[""+T];if(N.ranges&&Object.keys(N.ranges).length){var A=Object.keys(N.ranges),L;A.forEach(function(X,G){N.ranges[""+X].info||(L=G)}),A.forEach(function(X,G){N.ranges[""+X].dataSource&&(Re(L)||!Re(L)&&L===G)&&n.notify(Kw,{sheetIdx:T,rangeIdx:X,isLastRange:A.length-1===G,changedData:N.ranges[""+X].dataSource})})}else if(N.paneTopLeftCell&&r.sheets&&r.sheets[""+T]&&r.sheets[""+T].paneTopLeftCell){if(n.activeSheetIndex!==Number(T))return;var k=xe(N.paneTopLeftCell),O=xe(r.sheets[""+T].paneTopLeftCell);if(k[0]!==O[0]){var R=n.frozenRowCount(n.getActiveSheet()),j=k[0]>R?Ei(n.getActiveSheet(),R,k[0]-1):0;n.notify(f0,{top:j})}if(k[1]!==O[1]){var P=n.frozenColCount(n.getActiveSheet()),F=k[1]>P?ci(n.getActiveSheet(),P,k[1]-1):0;n.notify(f0,{left:F})}}else if(D===0&&n.renderModule.refreshSheet(),n.showSheetTabs&&N.name&&!a){var z=$(".e-sheet-tabs-items",n.element),q=Number(T);z.children[q+1]?n.notify(Zy,{items:z,value:N.name,idx:q}):(n.notify(Wl,null),a=!0)}});break;case"locale":this.refresh();break;case"currencyCode":i.locale||this.notify(_y,{});break;case"password":this.password.length>0&&this.showSheetTabs&&(this.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"));break;case"isProtected":if(this.isProtected){var E=this.element.getElementsByClassName("e-add-sheet-tab")[0];E&&(E.disabled=this.isProtected,this.isProtected?E.classList.contains("e-disabled")&&E.classList.add("e-disabled"):E.classList.contains("e-disabled")||E.classList.remove("e-disabled"))}break;case"allowFreezePane":this.notify(Wh,{prop:"allowFreezePane",onPropertyChange:!0});break;case"allowImage":case"allowChart":this.renderModule.refreshSheet(),this.notify(Wh,{prop:h,onPropertyChange:!0});break}}},e.prototype.requiredModules=function(){return $6(this)},e.prototype.appendTo=function(i){s.prototype.appendTo.call(this,i)},e.prototype.filter=function(i,r){return this.allowFiltering?(r=r||this.getActiveSheet().selectedRange,s.prototype.filter.call(this,i,r)):Promise.reject()},e.prototype.clearFilter=function(i){this.notify(Kf,{field:i})},e.prototype.applyFilter=function(i,r){if(!this.allowFiltering)return Promise.reject();var n=new Promise(function(o,l){o(function(){}())}),a={predicates:i,range:r,isInternal:!0,promise:n};return this.notify(so,a),a.promise},e.prototype.addCustomFunction=function(i,r,n){s.prototype.addCustomFunction.call(this,i,r,n),this.notify(K1,null)};var t;return jt([S("")],e.prototype,"cssClass",void 0),jt([S(!0)],e.prototype,"allowScrolling",void 0),jt([S(!0)],e.prototype,"allowResizing",void 0),jt([S(!0)],e.prototype,"showAggregate",void 0),jt([S(!0)],e.prototype,"enableClipboard",void 0),jt([S(!0)],e.prototype,"enableContextMenu",void 0),jt([S(!0)],e.prototype,"enableKeyboardNavigation",void 0),jt([S(!0)],e.prototype,"enableKeyboardShortcut",void 0),jt([S(!0)],e.prototype,"allowUndoRedo",void 0),jt([S(!0)],e.prototype,"allowWrap",void 0),jt([Ee({},Y$)],e.prototype,"selectionSettings",void 0),jt([Ee({},q$)],e.prototype,"scrollSettings",void 0),jt([_()],e.prototype,"beforeCellRender",void 0),jt([_()],e.prototype,"beforeSelect",void 0),jt([_()],e.prototype,"select",void 0),jt([_()],e.prototype,"contextMenuBeforeOpen",void 0),jt([_()],e.prototype,"fileMenuBeforeOpen",void 0),jt([_()],e.prototype,"contextMenuBeforeClose",void 0),jt([_()],e.prototype,"dialogBeforeOpen",void 0),jt([_()],e.prototype,"fileMenuBeforeClose",void 0),jt([_()],e.prototype,"contextMenuItemSelect",void 0),jt([_()],e.prototype,"fileMenuItemSelect",void 0),jt([_()],e.prototype,"beforeDataBound",void 0),jt([_()],e.prototype,"dataBound",void 0),jt([_()],e.prototype,"dataSourceChanged",void 0),jt([_()],e.prototype,"cellEdit",void 0),jt([_()],e.prototype,"cellEditing",void 0),jt([_()],e.prototype,"cellSave",void 0),jt([_()],e.prototype,"beforeCellSave",void 0),jt([_()],e.prototype,"created",void 0),jt([_()],e.prototype,"beforeSort",void 0),jt([_()],e.prototype,"beforeHyperlinkCreate",void 0),jt([_()],e.prototype,"afterHyperlinkCreate",void 0),jt([_()],e.prototype,"beforeHyperlinkClick",void 0),jt([_()],e.prototype,"afterHyperlinkClick",void 0),jt([_()],e.prototype,"beforeConditionalFormat",void 0),jt([_()],e.prototype,"actionBegin",void 0),jt([_()],e.prototype,"actionComplete",void 0),jt([_()],e.prototype,"openComplete",void 0),jt([_()],e.prototype,"sortComplete",void 0),jt([S("USD")],e.prototype,"currencyCode",void 0),e=t=jt([Ot],e),e}(Y6),iX=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),G2=function(s){iX(e,s);function e(t){var i=s.call(this,t)||this;return i.initRenderCalled=!1,i.checkInjectedModules=!0,i.directivekeys={sheets:{sheet:{rows:{row:{cells:{cell:{images:"image",charts:"chart"}}}},columns:"column",ranges:"range",conditionalFormats:"conditionalFormat"}},definedNames:"definedName"},i.statelessTemplateProps=null,i.templateProps=null,i.immediateRender=!1,i.portals=[],i}return e.prototype.render=function(){if((this.element&&!this.initRenderCalled||this.refreshing)&&!this.isReactForeceUpdate)s.prototype.render.call(this),this.initRenderCalled=!0;else return le.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals))},e}(tX);jW(G2,[zW,le.Component]);const rX="/assets/exportImgTop-7qQy_MLb.png",nX=[{name:"All",value:"all",type:"all"}],sX=[{name:"All",value:"all"},{name:"Managers",value:"manager"},{name:"Chief Engineers",value:"cheng"},{name:"Maintenance Crew",value:"mm"},{name:"Reviewer",value:"view"}],aX=()=>{const s=Iu(),e=cP(),t=r_(),i=t_(),[r,n]=le.useState(),[a,o]=le.useState([{name:"Select Facility first",value:"none"}]),[l,h]=le.useState([{name:"Select Facility first",value:"none"}]),[u,c]=le.useState(),[d,p]=le.useState(!0),[f,v]=le.useState(""),[g,b]=le.useState(""),[y,C]=le.useState("");le.useState("");const[x,w]=le.useState(""),[M,E]=le.useState(null),[T,D]=le.useState(null),[N,A]=le.useState([]);le.useState([]),le.useState([]);const[L,k]=le.useState([]),[O,R]=le.useState([]),j=Lt.useRef(null),P=[{id:1,name:"Leslie Alexander"}],F=async()=>{p(!0);const V=await t.getDivisionNameAndId();V.forEach(Ie=>{Ie.type="division"}),console.log("Divs",V);const re=nX.concat(V),he=await e.getFacilityNameAndId();n(re.concat(he)),p(!1)};function z(...V){return V.filter(Boolean).join(" ")}const q=g===""?r:r.filter(V=>V.name.toLowerCase().includes(g.toLowerCase())),X=y===""?a:a.filter(V=>V.name.toLowerCase().includes(y.toLowerCase())),G=f===""?P:P.filter(V=>V.name.toLowerCase().includes(f.toLowerCase()));le.useEffect(()=>{s.checkAuthentication(),F()},[]);const Z=async(V,re)=>{try{return await Zs.files.getUrl(V,re,{thumb:"100x250"})}catch(he){console.log(he)}},se={src:rX,height:230,width:980,top:0,left:0,id:"exportImgTop"},oe=async V=>{console.log("here"),p(!0),L.facilities={},k(L);let re=[];if(D(V),V.value==="all")re=await e.getLocalFacilities();else if(V.type==="division")re=await e.getFacilityByDivisions(V.value);else{const he=await e.getFacility(V.value);re.push(he)}re.forEach(async he=>{const Ie=await Z(he,he.image[0]);he.imgSrc={src:Ie,height:330,width:680,top:660,left:70,id:he.image[0]}}),L.facilities=re,k(L),u&&be(u),A(re),fe(),o(sX),p(!1)},fe=async V=>{const re=await i.getFacilitySystems(V);R(re);const he=[{name:"All",value:"all",type:"all"}];re.forEach(Ie=>{he.push({name:Ie.type,value:Ie.type,type:"sys"})}),h(he)},be=async V=>{p(!0),c(V),L.facilities.forEach(async re=>{re.user=await e.getFacilityUsers(re.id,V.value)}),console.log("stagedData",L),p(!1)},Ne=V=>(console.log("image",se),[{cells:[{image:se},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{},{}]},{cells:[{},{},{value:V.name}]},{cells:[{},{},{},{}]},{cells:[{},{image:V.imgSrc},{value:"Address:"},{value:V.address}]},{cells:[{},{},{value:"City:"},{value:V.city}]},{cells:[{},{},{value:"State:"},{value:V.state}]},{cells:[{},{},{value:"Zip:"},{value:V.zipcode+" "}]},{cells:[{},{},{value:"Division:"},{value:V.division_name}]},{cells:[{},{},{value:"Usage:"},{value:V.fac_type}]},{cells:[{},{},{value:"Units:"},{value:V.num_of_units}]}]),we=()=>{N.map(re=>{});let V=j.current;V&&(p(!0),N.map((re,he)=>{V.insertSheet([{index:he,name:re.name,showGridLines:!1,columns:[{width:20},{width:780},{width:172},{width:160}]}]),setTimeout(()=>{V.goTo(re.name+"!B2")}),setTimeout(()=>{V.insertRow(Ne(re)),V.insertImage([se],"A1"),V.merge("B32:I32"),V.cellFormat({fontWeight:"bold",textAlign:"center",verticalAlign:"middle",backgroundColor:"#80c157",color:"#ffffff"},"B32"),V.cellFormat({fontWeight:"bold"},"C34"),V.cellFormat({fontWeight:"bold"},"C35"),V.cellFormat({fontWeight:"bold"},"C36"),V.cellFormat({fontWeight:"bold"},"C37"),V.cellFormat({fontWeight:"bold"},"C38"),V.cellFormat({fontWeight:"bold"},"C39"),V.cellFormat({fontWeight:"bold"},"C40"),V.cellFormat({textAlign:"left"},"D37"),V.cellFormat({textAlign:"left"},"D40"),V.setBorder({border:"1px solid #0093d0"},"B32:I50","Outer"),V.goTo(re.name+"!B34"),V.insertImage([re.imgSrc],"B34")})}),p(!1))},H=()=>{A(L.facilities)};return J.jsx(J.Fragment,{children:d?J.jsx("div",{children:" Loading...."}):J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"bg-white ",children:J.jsx("div",{className:"mx-auto px-3 lg:px-5",children:J.jsxs("div",{className:"grid gap-x-8 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-4",children:[J.jsxs(Qr,{as:"div",value:T,onChange:oe,children:[J.jsx(Qr.Label,{className:"block text-sm font-medium leading-6 text-gray-900",children:"Facilities"}),J.jsxs("div",{className:"relative mt-2",children:[J.jsx(Qr.Input,{className:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:V=>b(V.target.value),displayValue:V=>V==null?void 0:V.name}),J.jsx(Qr.Button,{className:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none",children:J.jsx(TC,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),(q==null?void 0:q.length)>0&&J.jsx(Qr.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:q==null?void 0:q.map(V=>J.jsx(Qr.Option,{value:V,className:({active:re})=>z("relative cursor-default select-none py-2 pl-3 pr-9",re?"bg-indigo-600 text-white":"text-gray-900"),children:({active:re,selected:he})=>J.jsxs(J.Fragment,{children:[J.jsx("span",{className:z("block truncate",he&&"font-semibold"),children:V.name}),he&&J.jsx("span",{className:z("absolute inset-y-0 right-0 flex items-center pr-4",re?"text-white":"text-indigo-600"),children:J.jsx(IC,{className:"h-5 w-5","aria-hidden":"true"})})]})},V.value))})]})]}),J.jsxs(Qr,{as:"div",value:u,onChange:be,children:[J.jsx(Qr.Label,{className:"block text-sm font-medium leading-6 text-gray-900",children:"Users"}),J.jsxs("div",{className:"relative mt-2",children:[J.jsx(Qr.Input,{className:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:V=>C(V.target.value),displayValue:V=>V==null?void 0:V.name}),J.jsx(Qr.Button,{className:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none",children:J.jsx(TC,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),(X==null?void 0:X.length)>0&&J.jsx(Qr.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:X.map(V=>J.jsx(Qr.Option,{value:V,className:({active:re})=>z("relative cursor-default select-none py-2 pl-3 pr-9",re?"bg-indigo-600 text-white":"text-gray-900"),children:({active:re,selected:he})=>J.jsxs(J.Fragment,{children:[J.jsx("span",{className:z("block truncate",he&&"font-semibold"),children:V.name}),he&&J.jsx("span",{className:z("absolute inset-y-0 right-0 flex items-center pr-4",re?"text-white":"text-indigo-600"),children:J.jsx(IC,{className:"h-5 w-5","aria-hidden":"true"})})]})},V.value))})]})]}),J.jsxs(Qr,{as:"div",value:M,onChange:E,children:[J.jsx(Qr.Label,{className:"block text-sm font-medium leading-6 text-gray-900",children:"Exceptions"}),J.jsxs("div",{className:"relative mt-2",children:[J.jsx(Qr.Input,{className:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:V=>w(V.target.value),displayValue:V=>V==null?void 0:V.name}),J.jsx(Qr.Button,{className:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none",children:J.jsx(TC,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),G.length>0&&J.jsx(Qr.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:G.map(V=>J.jsx(Qr.Option,{value:V,className:({active:re})=>z("relative cursor-default select-none py-2 pl-3 pr-9",re?"bg-indigo-600 text-white":"text-gray-900"),children:({active:re,selected:he})=>J.jsxs(J.Fragment,{children:[J.jsx("span",{className:z("block truncate",he&&"font-semibold"),children:V.name}),he&&J.jsx("span",{className:z("absolute inset-y-0 right-0 flex items-center pr-4",re?"text-white":"text-indigo-600"),children:J.jsx(IC,{className:"h-5 w-5","aria-hidden":"true"})})]})},V.id))})]})]}),J.jsx("div",{className:"my-8",children:J.jsx("button",{onClick:H,type:"submit",className:"h-9 flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Generate Export"})})]},N.name)})}),J.jsx("div",{className:"App",children:J.jsx(G2,{ref:j,height:700,created:we.bind(void 0),allowImage:!0,allowSave:!0,saveUrl:"http://localhost:5000/uploads",allowCellFormatting:!0,showFormulaBar:!1})})]})})},oX=()=>{const[s,e]=Lt.useState(!1),t=Iu(),i=()=>{console.log("Logout",!s),e(!s)};return Lt.useEffect(()=>{t.checkAuthentication(),Kl.init({offset:100,duration:800,easing:"ease-in-sine",delay:100}),Kl.refresh()},[]),J.jsxs("div",{className:"bg-white dark:bg-gray-900 dark:text-white duration-200",children:[J.jsx(hb,{handleLogoutPopup:i}),J.jsx(aX,{handleLogoutPopup:i}),J.jsx(mb,{logoutPopup:s,setLogoutPopup:e})]})},lX="/assets/andriod-EVnsN7Wf.svg",hX="/assets/ios-5lldzYXo.svg",uX=()=>J.jsx("div",{className:"relative overflow-hidden min-h-[550px] sm:min-h-[650px] bg-gray-100 flex justify-center items-center dark:bg-gray-950 dark:text-white duration-200 ",children:J.jsxs("div",{className:"columns-2 ",children:[J.jsxs("div",{className:"p-11",children:[J.jsx("div",{className:"text-center underline font-bold ",children:"iOS"}),J.jsx("div",{children:J.jsx("img",{src:hX,alt:"",className:"h-[400px] object-cover rounded-md"})})]}),J.jsxs("div",{className:"p-11",children:[J.jsx("div",{className:"text-center underline font-bold",children:"Android"}),J.jsx("div",{children:J.jsx("img",{src:lX,alt:"",className:"h-[400px] object-cover rounded-md"})})]})]})}),cX=()=>{const[s,e]=Lt.useState(!1),t=Iu(),i=()=>{console.log("Logout",!s),e(!s)};return Lt.useEffect(()=>{t.checkAuthentication(),Kl.init({offset:100,duration:800,easing:"ease-in-sine",delay:100}),Kl.refresh()},[]),J.jsxs("div",{className:"bg-white dark:bg-gray-900 dark:text-white duration-200",children:[J.jsx(hb,{handleLogoutPopup:i}),J.jsx(uX,{}),J.jsx(eI,{}),J.jsx(mb,{logoutPopup:s,setLogoutPopup:e})]})},dX=()=>{const[s,e]=le.useState();return MP("Ngo9BigBOggjHTQxAR8/V1NAaF5cWWRCfEx0Rnxbf1x0ZF1MZFxbRXJPIiBoS35RckViW3tccXRTQmhVVExx"),J.jsx("div",{className:"bg-white dark:bg-gray-900 dark:text-white duration-200",children:J.jsx(YF.Provider,{value:{user:s,setUser:e},children:J.jsx(yB,{children:J.jsxs(dB,{children:[J.jsx(Th,{path:"/auth",element:J.jsx(KD,{})}),J.jsx(Th,{path:"home",element:J.jsx(u5,{})}),J.jsx(Th,{path:"/exports",element:J.jsx(oX,{})}),J.jsx(Th,{path:"/users",element:J.jsx(c5,{})}),J.jsx(Th,{path:"*",element:J.jsx(KD,{})}),J.jsx(Th,{path:"qr",element:J.jsx(cX,{})})]})})})})};kx.createRoot(document.getElementById("root")).render(J.jsx(Lt.StrictMode,{children:J.jsx(dX,{})}));
